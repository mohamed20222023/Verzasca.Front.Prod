"use strict";(self.webpackChunkvelzon=self.webpackChunkvelzon||[]).push([[811],{56701:(be,se,m)=>{m.d(se,{g:()=>ae});var d=m(54438),c=m(62984),h=m(51188),j=m(3888);let ae=(()=>{class A{constructor(X,ee,p){this.authservice=X,this.router=ee,this.alertService=p}canActivate(X){return!!this.authservice.permissionMatch(X.data.permission)||(this.alertService.error("general.notAllow.notAllowPageMessage"),this.router.navigate(["/"]),!1)}static{this.\u0275fac=function(ee){return new(ee||A)(d.KVO(c.J),d.KVO(h.Ix),d.KVO(j.u))}}static{this.\u0275prov=d.jDH({token:A,factory:A.\u0275fac,providedIn:"root"})}}return A})()},56131:(be,se,m)=>{m.d(se,{E:()=>h});var d=m(7673),c=m(99437);class h{constructor(ae,A,Z){this.router=ae,this.BaseService=A,this.alertService=Z,this.pagination={pageNumber:1,pageSize:10}}resolve(ae,A){return this.BaseService.get(this.pagination).pipe((0,c.W)(Z=>(this.router.navigate([""]),this.alertService.error(Z),(0,d.of)(null))))}}},5811:(be,se,m)=>{m.r(se),m.d(se,{OrderModule:()=>hd});var d=m(60177),c=m(89417),h=m(69005),j=m(91022),ae=m(70255),A=m(63789),Z=m(98982),X=m.n(Z),ee=m(53978),p=m(8147),x=m(45286),ue=m(65430),ve=m(41631),C=m(1530),U=m(72510),_=m(51188),e=m(54438);let V=(()=>{class r{constructor(){}ngOnInit(){}static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-order-map"]],decls:0,vars:0,template:function(i,n){},encapsulation:2})}}return r})();var D=m(75622),k=m(33826),O=m(3888),g=m(62984),v=m(94575),u=m(56977),J=m(70053),le=m(79284),z=m(91426),Q=m(12260),te=m(16229),ne=m(12822),q=m(40724),ge=m(50204),Ce=m(15084),ie=m(88148),re=m(91580),Pe=m(14221),K=m(5779),W=m(29935);function He(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",24),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.dismissFn())}),e.k0s()}}function ze(r,o){}function Je(r,o){if(1&r&&(e.qex(0),e.j41(1,"h2",9)(2,"button",10)(3,"div",11)(4,"div",12)(5,"div",13),e.nrm(6,"i",14),e.k0s()(),e.j41(7,"div",15)(8,"span",16),e.nrm(9,"span",25),e.k0s(),e.j41(10,"bdi")(11,"span",16),e.nrm(12,"span",18),e.j41(13,"span",19),e.EFF(14),e.nI1(15,"date"),e.k0s()()()(),e.j41(16,"div",15)(17,"h6",16)(18,"span",19)(19,"span",26),e.EFF(20),e.k0s()()()()()()(),e.bVm()),2&r){const t=e.XpG();e.R7$(14),e.JRh(e.i5U(15,2,t.orderSelected.assignDate,"yyyy-MM-dd HH:mm:sss")),e.R7$(6),e.SpI("",t.orderSelected.assignUser," ")}}function qe(r,o){if(1&r&&(e.qex(0),e.j41(1,"h2",9)(2,"button",10)(3,"div",11)(4,"div",12)(5,"div",13),e.nrm(6,"i",14),e.k0s()(),e.j41(7,"div",15)(8,"span",16),e.nrm(9,"span",27),e.k0s(),e.j41(10,"bdi")(11,"span",16),e.nrm(12,"span",18),e.j41(13,"span",19),e.EFF(14),e.nI1(15,"date"),e.k0s()()()(),e.j41(16,"div",15)(17,"h6",16)(18,"span",19)(19,"span",26),e.EFF(20),e.k0s()()()()()()(),e.bVm()),2&r){const t=e.XpG();e.R7$(14),e.JRh(e.i5U(15,2,t.orderSelected.confirmedDate,"yyyy-MM-dd HH:mm:sss")),e.R7$(6),e.SpI("",t.orderSelected.confirmedUser," ")}}function We(r,o){if(1&r&&(e.qex(0),e.j41(1,"h2",9)(2,"button",10)(3,"div",11)(4,"div",12)(5,"div",13),e.nrm(6,"i",14),e.k0s()(),e.j41(7,"div",15)(8,"span",16),e.nrm(9,"span",28),e.k0s(),e.j41(10,"bdi")(11,"span",16),e.nrm(12,"span",18),e.j41(13,"span",19),e.EFF(14),e.nI1(15,"date"),e.k0s()()()(),e.j41(16,"div",15)(17,"h6",16)(18,"span",19)(19,"span",26),e.EFF(20),e.k0s()()()()()()(),e.bVm()),2&r){const t=e.XpG();e.R7$(14),e.JRh(e.i5U(15,2,t.orderSelected.finishDate,"yyyy-MM-dd HH:mm:sss")),e.R7$(6),e.SpI("",t.orderSelected.finishUser," ")}}let me=(()=>{class r{constructor(){this.orderSelected={},this.hideCloseIcon=!1,this.dismiss=new e.bkB}ngOnInit(){}dismissFn(){this.dismiss.emit(!0)}getTeam(t){return""!=t||null!=t||null!=t?[]:t.split(",")}static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["order-timeline"]],inputs:{orderSelected:"orderSelected",hideCloseIcon:"hideCloseIcon"},outputs:{dismiss:"dismiss"},decls:36,vars:10,consts:[["accordion","ngbAccordion"],[1,"modal-header","p-1","bg-success-subtle"],["id","createTaskLabel","translate","orderManagement.order.trackOrder",1,"modal-title"],["type","button","class","btn-close","data-bs-dismiss","modal","id","createTaskBtn-close","aria-label","Close",3,"click",4,"ngIf"],[1,"modal-body"],[1,"card-body"],[1,"profile-timeline","order-status"],["ngbAccordion",""],["ngbAccordionItem","",3,"collapsed"],["ngbAccordionHeader",""],["ngbAccordionButton","","aria-expanded","true",1,"accordion-button","p-2","shadow-none"],[1,"d-flex","align-items-center"],[1,"flex-shrink-0","avatar-xs"],[1,"avatar-title","rounded-circle"],[1,"ri-arrow-down-fill"],[1,"flex-grow-1","ms-3"],[1,"fs-14","mb-0"],["translate","orderManagement.order.creation"],[1,"fw-normal","mx-4"],[1,"mx-2"],[1,"badge","bg-success-subtle","text-success"],["ngbAccordionCollapse",""],["ngbAccordionBody","",1,"ms-2","ps-5","pt-0"],[4,"ngIf"],["type","button","data-bs-dismiss","modal","id","createTaskBtn-close","aria-label","Close",1,"btn-close",3,"click"],["translate","orderManagement.order.assignDate"],[1,"badge","bg-warning-subtle","text-warning"],["translate","orderManagement.order.sureDate"],["translate","orderManagement.order.finishDate"]],template:function(i,n){1&i&&(e.j41(0,"div",1),e.nrm(1,"h5",2),e.DNE(2,He,1,0,"button",3),e.k0s(),e.j41(3,"div",4)(4,"div",5)(5,"div",6)(6,"div",7,0)(8,"div",8),e.qex(9),e.j41(10,"h2",9)(11,"button",10)(12,"div",11)(13,"div",12)(14,"div",13),e.nrm(15,"i",14),e.k0s()(),e.j41(16,"div",15)(17,"span",16),e.nrm(18,"span",17),e.k0s(),e.j41(19,"bdi")(20,"span",16),e.nrm(21,"span",18),e.j41(22,"span",19),e.EFF(23),e.nI1(24,"date"),e.k0s()()()(),e.j41(25,"div",15)(26,"h6",16)(27,"span",19)(28,"span",20),e.EFF(29),e.k0s()()()()()()(),e.j41(30,"div",21)(31,"div",22),e.DNE(32,ze,0,0,"ng-template"),e.k0s()(),e.bVm(),e.DNE(33,Je,21,5,"ng-container",23)(34,qe,21,5,"ng-container",23)(35,We,21,5,"ng-container",23),e.k0s()()()()()),2&i&&(e.R7$(2),e.Y8G("ngIf",!n.hideCloseIcon),e.R7$(6),e.Y8G("collapsed",!1),e.R7$(15),e.JRh(e.i5U(24,7,n.orderSelected.createdDate,"yyyy-MM-dd HH:mm:sss")),e.R7$(6),e.SpI("",n.orderSelected.creationUser," "),e.R7$(4),e.Y8G("ngIf",null!=n.orderSelected.assignDate),e.R7$(),e.Y8G("ngIf",null!=n.orderSelected.confirmedDate),e.R7$(),e.Y8G("ngIf",null!=n.orderSelected.finishDate))},dependencies:[d.bT,p.Mm,h.WP,h.r6,h.tW,h.x7,h.UA,h.$R,d.vh],encapsulation:2})}}return r})();function Qe(r,o){if(1&r&&(e.j41(0,"div",41)(1,"div",42)(2,"div",6)(3,"div",17)(4,"div",43),e.nrm(5,"img",44),e.k0s(),e.j41(6,"div",21)(7,"h5",45)(8,"a",46),e.EFF(9),e.k0s()()()()()()()),2&r){const t=o.$implicit;e.R7$(9),e.JRh(t)}}function Ke(r,o){1&r&&e.nrm(0,"span",47)}function Ze(r,o){if(1&r&&(e.j41(0,"span",48),e.EFF(1),e.k0s()),2&r){const t=e.XpG();e.R7$(),e.SpI("",t.orderDetails.districtName," ")}}function et(r,o){1&r&&e.nrm(0,"span",49)}function tt(r,o){if(1&r&&(e.j41(0,"a",50),e.nrm(1,"i",51),e.k0s()),2&r){const t=e.XpG();e.Y8G("href",t.mapUrl(null==t.orderDetails?null:t.orderDetails.map),e.B4B)}}function nt(r,o){if(1&r&&(e.j41(0,"li",31)(1,"span",52),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.k0s()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t)}}function it(r,o){if(1&r&&(e.j41(0,"li",31)(1,"span",52),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.k0s()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t)}}let rt=(()=>{class r{constructor(t){this.alertService=t,this.dismiss=new e.bkB}ngOnChanges(t){console.log(this.orderDetails)}getServices(t){return t.split("#")}copyText(t){navigator.clipboard.writeText(t),this.alertService.info(t)}mapUrl(t){if(!t)return"";const[i,n]=t.split(",").map(Number);return`https://www.google.com/maps/dir//${i},${n}/@${i},${n},17z?hl=en-US`}getTimes(t){return t.split(",")}dismissFn(){this.dismiss.emit(!0)}getNet(t){return console.log(t),null==t||""==t?0:t.split("#")[0]}getTax(t){return console.log(t),null==t||""==t?0:t.split("#")[1]}getTotal(t){return console.log(t),null==t||""==t?0:t.split("#")[2]}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(O.u))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-all-orders-details"]],inputs:{orderDetails:"orderDetails"},outputs:{dismiss:"dismiss"},features:[e.OA$],decls:99,vars:59,consts:[[1,"row"],[1,"col-xl-8"],[1,"card","mb-3"],[1,"card-header"],[1,"d-flex","align-items-center"],[1,"card-title","flex-grow-1","mb-0"],[1,"card-body"],[1,"row","mb-1"],["class","col-12 col-md-6",4,"ngFor","ngForOf"],[1,"table-responsive","table-card","d-flex","justify-content-end","border-top","border-top-dashed"],[1,"table","table-borderless","mb-0",2,"max-width","20rem"],[1,"text-end"],[1,"border-top","border-top-dashed"],["scope","row"],[3,"orderSelected","hideCloseIcon"],[1,"col-xl-4"],[1,"card"],[1,"d-flex"],[1,"list-unstyled","mb-0","vstack","gap-3"],[1,"flex-shrink-0"],["src","assets/images/users/user-dummy-img.jpg","alt","",1,"avatar-sm","rounded"],[1,"flex-grow-1","ms-3"],[1,"fs-14","mb-1"],[1,"text-muted","mb-0"],[1,"ri-phone-line","me-2","align-middle","text-info","fs-16"],[1,"cursor-pointer","badge","bg-info-subtle","text-info","fs-6",3,"click"],[1,"ri-clipboard-line"],[1,"card-title","mb-0"],[1,"ri-map-pin-line","align-middle","me-1","text-muted"],[1,"list-unstyled","vstack","gap-2","fs-13","mb-0"],[1,"fw-medium","fs-14","text-muted"],[1,"text-muted"],["class","badge bg-danger-subtle text-danger","translate","orderManagement.order.nothing",4,"ngIf"],["class","badge bg-success-subtle text-success",4,"ngIf"],["class","badge bg-danger-subtle text-danger mx-1","translate","orderManagement.order.noMap",4,"ngIf"],["target","_blank","class","badge bg-success-subtle text-success mx-1","translate","orderManagement.order.viewMap",3,"href",4,"ngIf"],[1,"ri-history-fill","align-middle","me-1","text-muted"],[1,"card-body","d-flex","card-scroll-xl"],["class","text-muted",4,"ngFor","ngForOf"],[1,"col-xl-12","d-flex","gap-2","justify-content-end"],["type","button","data-bs-dismiss","modal",1,"btn","w-sm","btn-danger","m-3",3,"click"],[1,"col-12","col-md-6"],[1,"card",2,"box-shadow","0 0 6px rgb(56 65 74 / 64%)"],[1,"flex-shrink-0","avatar-md","bg-light","rounded","p-1"],["src","assets/images/products/img-8.png","alt","",1,"img-fluid","d-block"],[1,"fs-15",2,"min-height","38px"],["routerLink","/ecommerce/product-detail/",1,"link-primary"],["translate","orderManagement.order.nothing",1,"badge","bg-danger-subtle","text-danger"],[1,"badge","bg-success-subtle","text-success"],["translate","orderManagement.order.noMap",1,"badge","bg-danger-subtle","text-danger","mx-1"],["target","_blank","translate","orderManagement.order.viewMap",1,"badge","bg-success-subtle","text-success","mx-1",3,"href"],[1,"ri-map-pin-line"],[1,"badge","bg-primary-subtle","text-primary","mx-1"]],template:function(i,n){1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h5",5),e.EFF(6),e.k0s()()(),e.j41(7,"div",6)(8,"div",7),e.DNE(9,Qe,10,1,"div",8),e.k0s(),e.j41(10,"div",9)(11,"table",10)(12,"tbody")(13,"tr")(14,"td"),e.EFF(15),e.nI1(16,"translate"),e.k0s(),e.j41(17,"td",11),e.EFF(18),e.k0s()(),e.j41(19,"tr")(20,"td"),e.EFF(21),e.nI1(22,"translate"),e.k0s(),e.j41(23,"td",11),e.EFF(24),e.k0s()(),e.j41(25,"tr",12)(26,"th",13),e.EFF(27),e.nI1(28,"translate"),e.k0s(),e.j41(29,"th",11),e.EFF(30),e.k0s()()()()()()(),e.nrm(31,"order-timeline",14),e.k0s(),e.j41(32,"div",15)(33,"div",16)(34,"div",3)(35,"div",17)(36,"h5",5),e.EFF(37),e.nI1(38,"translate"),e.k0s()()(),e.j41(39,"div",6)(40,"ul",18)(41,"li")(42,"div",4)(43,"div",19),e.nrm(44,"img",20),e.k0s(),e.j41(45,"div",21)(46,"h6",22),e.EFF(47),e.k0s(),e.j41(48,"p",23),e.EFF(49),e.nI1(50,"translate"),e.nI1(51,"date"),e.k0s()()()(),e.j41(52,"li"),e.nrm(53,"i",24),e.j41(54,"span",25),e.bIt("click",function(){return n.copyText(n.orderDetails.mobile)}),e.EFF(55),e.nrm(56,"i",26),e.k0s()()()()(),e.j41(57,"div",16)(58,"div",3)(59,"h5",27),e.nrm(60,"i",28),e.EFF(61),e.nI1(62,"translate"),e.k0s()(),e.j41(63,"div",6)(64,"ul",29)(65,"li",30),e.EFF(66),e.nI1(67,"translate"),e.k0s(),e.j41(68,"li",31),e.EFF(69),e.nI1(70,"translate"),e.DNE(71,Ke,1,0,"span",32)(72,Ze,2,1,"span",33),e.k0s(),e.j41(73,"li",31),e.EFF(74),e.nI1(75,"translate"),e.DNE(76,et,1,0,"span",34)(77,tt,2,1,"a",35),e.k0s()()()(),e.j41(78,"div",16)(79,"div",3)(80,"h5",27),e.nrm(81,"i",36),e.EFF(82),e.nI1(83,"translate"),e.k0s()(),e.j41(84,"div",37)(85,"ul",29)(86,"li",30),e.EFF(87),e.nI1(88,"translate"),e.k0s(),e.DNE(89,nt,4,1,"li",38),e.k0s(),e.j41(90,"ul",29)(91,"li",30),e.EFF(92),e.nI1(93,"translate"),e.k0s(),e.DNE(94,it,4,1,"li",38),e.k0s()()()(),e.j41(95,"div",39)(96,"button",40),e.bIt("click",function(){return n.dismissFn()}),e.EFF(97),e.nI1(98,"translate"),e.k0s()()()),2&i&&(e.R7$(6),e.SpI("#SO#",n.orderDetails.orderCode,""),e.R7$(3),e.Y8G("ngForOf",n.getServices(n.orderDetails.services)),e.R7$(6),e.SpI("",e.bMT(16,30,"orderManagement.order.net")," :"),e.R7$(3),e.JRh(n.getNet(n.orderDetails.totalTaxNet)),e.R7$(3),e.SpI("",e.bMT(22,32,"orderManagement.order.tax")," :"),e.R7$(3),e.JRh(n.getTax(n.orderDetails.totalTaxNet)),e.R7$(3),e.SpI("",e.bMT(28,34,"orderManagement.order.total")," :"),e.R7$(3),e.JRh(n.getTotal(n.orderDetails.totalTaxNet)),e.R7$(),e.Y8G("orderSelected",n.orderDetails)("hideCloseIcon",!0),e.R7$(6),e.JRh(e.bMT(38,36,"orderManagement.order.customerDetails")),e.R7$(10),e.JRh(n.orderDetails.agentName),e.R7$(2),e.Lme(" ",e.bMT(50,38,"orderManagement.order.visitDate")," : ",e.i5U(51,40,n.orderDetails.visitDate,"yyyy-MM-dd")," "),e.R7$(6),e.SpI("",n.orderDetails.mobile," "),e.R7$(6),e.SpI(" ",e.bMT(62,43,"orderManagement.order.customerAddress")," "),e.R7$(5),e.Lme(" ",e.bMT(67,45,"orderManagement.order.cityName"),": ",n.orderDetails.cityName," "),e.R7$(3),e.SpI(" ",e.bMT(70,47,"orderManagement.order.districtName"),": "),e.R7$(2),e.Y8G("ngIf",null==n.orderDetails.districtName),e.R7$(),e.Y8G("ngIf",null!==n.orderDetails.districtName),e.R7$(2),e.SpI(" ",e.bMT(75,49,"orderManagement.order.location"),": "),e.R7$(2),e.Y8G("ngIf",""==n.orderDetails.map),e.R7$(),e.Y8G("ngIf",null==n.orderDetails?null:n.orderDetails.map),e.R7$(5),e.SpI(" ",e.bMT(83,51,"orderManagement.order.workTimes")," "),e.R7$(5),e.SpI(" ",e.bMT(88,53,"orderManagement.order.assignTo"),": "),e.R7$(2),e.Y8G("ngForOf",n.getTimes(n.orderDetails.teamNames)),e.R7$(3),e.SpI(" ",e.bMT(93,55,"orderManagement.order.workTimes"),": "),e.R7$(2),e.Y8G("ngForOf",n.getTimes(n.orderDetails.workTimes)),e.R7$(3),e.SpI(" ",e.bMT(98,57,"general.action.close")," "))},dependencies:[d.Sq,d.bT,_.Wk,p.Mm,me,d.vh,p.D9],styles:["td[_ngcontent-%COMP%]{padding:3px 4px!important}"]})}}return r})();function at(r,o){1&r&&(e.j41(0,"tr",31)(1,"th",32),e.EFF(2,"#"),e.k0s(),e.j41(3,"th",33),e.nrm(4,"i",34),e.EFF(5," orderManagement.order.orderCode "),e.k0s(),e.j41(6,"th",35),e.nrm(7,"i",34),e.EFF(8," orderManagement.order.creation "),e.k0s(),e.j41(9,"th",36),e.nrm(10,"i",34),e.EFF(11," orderManagement.order.cityName "),e.k0s(),e.j41(12,"th",37),e.EFF(13," orderManagement.order.status "),e.k0s(),e.j41(14,"th",38),e.nrm(15,"i",34),e.EFF(16," orderManagement.order.agentName "),e.k0s(),e.j41(17,"th",39),e.nrm(18,"i",34),e.EFF(19," orderManagement.order.channelName "),e.k0s(),e.j41(20,"th",40),e.EFF(21," orderManagement.order.assignTo "),e.k0s(),e.j41(22,"th",41),e.EFF(23," orderManagement.order.workTimes "),e.k0s(),e.j41(24,"th",42),e.nrm(25,"i",34),e.EFF(26," orderManagement.order.visitDate "),e.k0s(),e.j41(27,"th",43),e.EFF(28," orderManagement.order.services "),e.k0s(),e.nrm(29,"th",44),e.k0s())}function st(r,o){1&r&&e.nrm(0,"span",58)}function ot(r,o){if(1&r&&(e.j41(0,"span",48),e.EFF(1),e.k0s()),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI("",t.districtName," ")}}function lt(r,o){if(1&r&&(e.qex(0),e.j41(1,"span",59),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.bVm()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t)}}function dt(r,o){if(1&r&&(e.qex(0),e.j41(1,"span",59),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.bVm()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t)}}function ct(r,o){if(1&r&&(e.qex(0),e.j41(1,"span",59),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.bVm()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t)}}function mt(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",60),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,a=e.XpG(),l=e.sdS(66);return e.Njj(a.openEditOrderModal(n.orderCode,l,"xxl"))}),e.nrm(1,"i",61)(2,"span",62),e.k0s()}}function pt(r,o){if(1&r){const t=e.RV6();e.j41(0,"tr",45)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td",46),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),l=e.sdS(64);return e.Njj(a.openModalClient(n,l,"lg"))}),e.j41(4,"bdi",47),e.EFF(5),e.k0s()(),e.j41(6,"td"),e.EFF(7),e.nI1(8,"date"),e.j41(9,"span",48),e.EFF(10),e.k0s()(),e.j41(11,"td"),e.EFF(12),e.DNE(13,st,1,0,"span",49)(14,ot,2,1,"span",50),e.k0s(),e.j41(15,"td")(16,"span"),e.nrm(17,"span",51),e.k0s()(),e.j41(18,"td",46),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),l=e.sdS(62);return e.Njj(a.openModalClient(n,l))}),e.j41(19,"span",52),e.EFF(20),e.k0s(),e.nrm(21,"br"),e.j41(22,"span",53),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.copytext(n.mobile))}),e.EFF(23),e.nrm(24,"i",54),e.k0s()(),e.j41(25,"td"),e.EFF(26),e.k0s(),e.j41(27,"td"),e.DNE(28,lt,4,1,"ng-container",55),e.k0s(),e.j41(29,"td"),e.DNE(30,dt,4,1,"ng-container",55),e.k0s(),e.j41(31,"td"),e.EFF(32),e.nI1(33,"date"),e.k0s(),e.j41(34,"td"),e.DNE(35,ct,4,1,"ng-container",55),e.k0s(),e.j41(36,"td")(37,"i",56),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),l=e.sdS(68);return e.Njj(a.OpenOrderTimeLineModel(n,l,"lg"))}),e.k0s(),e.DNE(38,mt,3,0,"button",57),e.k0s()()}if(2&r){const t=o.$implicit,i=o.rowIndex,n=e.XpG();e.R7$(2),e.JRh(i+1),e.R7$(3),e.SpI("#SO#",t.orderCode,""),e.R7$(2),e.SpI("",e.i5U(8,19,t.createdDate,"yyyy-MM-dd")," "),e.R7$(3),e.SpI("",t.creationUser," "),e.R7$(2),e.SpI("",t.cityName," "),e.R7$(),e.Y8G("ngIf",null==t.districtName),e.R7$(),e.Y8G("ngIf",null!==t.districtName),e.R7$(2),e.ZvI("badge ",n.getStatus(t),""),e.R7$(),e.FS9("translate",n.getTrnslate(t)),e.R7$(3),e.SpI("",t.agentName," "),e.R7$(3),e.SpI("",t.mobile," "),e.R7$(3),e.SpI(" ",t.channelName,""),e.R7$(2),e.Y8G("ngForOf",n.getTimes(t.teamNames)),e.R7$(2),e.Y8G("ngForOf",n.getTimes(t.workTimes)),e.R7$(2),e.SpI(" ",e.i5U(33,22,t.visitDate,"yyyy-MM-dd"),""),e.R7$(3),e.Y8G("ngForOf",n.getServices(t.services)),e.R7$(3),e.Y8G("ngIf",n.checkEdit(t))}}function gt(r,o){1&r&&(e.j41(0,"div",63),e.EFF(1," general.table.noData "),e.k0s())}function ht(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",64)(1,"div",65),e.nrm(2,"ngb-pagination-info",66),e.j41(3,"table-length",67),e.bIt("lengthChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",68)(5,"ngb-pagination",69),e.bIt("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.pagination.pageNumber,n)||(a.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function ut(r,o){if(1&r){const t=e.RV6();e.j41(0,"delete-modal",70),e.bIt("deleteConfirm",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.DeleteConfirm())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}}function _t(r,o){1&r&&e.nrm(0,"client-profile-main",71)}function ft(r,o){if(1&r){const t=e.RV6();e.j41(0,"app-all-orders-details",72),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderDetails",t.orderSelected)}}function bt(r,o){if(1&r&&e.nrm(0,"order-operation",73),2&r){const t=e.XpG();e.Y8G("isOrderEdit",t.isOrderEdit)("isInner",!0)("orderCode",t.clientSelected)}}function vt(r,o){if(1&r){const t=e.RV6();e.j41(0,"order-timeline",74),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderSelected",t.orderSelected)}}let Ct=(()=>{class r extends D.w{constructor(t,i,n,a,l,s,I,b,T,S,y,R,M,w,N){super(t,i,I,n,a,l,s),this.baseService=n,this.authDaamService=b,this.teamService=T,this.workTimeService=S,this.excelService=y,this.cityService=R,this.districtService=M,this.channelService=w,this.router=N,this.title="orderManagement.order.title",this.titleOperation="orderManagement.order.titleOperation",this.keySelected="",this.assignUsers=[],this.times=[],this.employees=[],this.searchForm={},this.isResolveList=!0,this.employeeTypes=[{id:1,name:"employeeTeam"},{id:2,name:"managment"},{id:3,name:"customerService"}],this.employeeGroups=[],this.activeindex="2",this.active=2,this.formPassword={},this.roles=[],this.teams=[],this.workTimes=[],this.userTypes=[],this.actives=[{id:!0,name:"active"},{id:!1,name:"noActive"}],this.clientSelected=0,this.cities=[],this.districts=[],this.channels=[],this.status=[],this.countLoad=2,this.isOrderEdit=!1,this.orderSelected={},this.users=[],this.setDates=(F,E,$)=>{if(F?.from||F?.to){const G=F.to||F.from;this.pagination[E]=this.datePipe.transform(F.from||F.to,"yyyy-MM-ddT00:00:00"),this.pagination[$]=this.datePipe.transform(G,"yyyy-MM-ddT23:59:59.999")}else this.pagination[E]=null,this.pagination[$]=null},this.configRoute(),this.GetCities(),this.GetChannels(),this.GetTeams(),this.GetTimes(),this.GetOrderLookUp(),this.status=[{name:"None",nameAr:"\u0644\u0627 \u0634\u0626",id:0},{name:"Is Review",nameAr:"\u062a\u0645\u062a \u0627\u0644\u0645\u0631\u0627\u062c\u0639\u0629",id:1},{name:"Is Confirmed",nameAr:"\u062a\u0645 \u0627\u0644\u062a\u0623\u0643\u064a\u062f",id:2},{name:"Is Free",nameAr:"\u0645\u062c\u0627\u0646\u064a",id:3},{name:"Is Reopen",nameAr:"\u062a\u0645\u062a \u0625\u0639\u0627\u062f\u0629 \u0641\u062a\u062d\u0647",id:4},{name:"Is Finish",nameAr:"\u0627\u0646\u062a\u0647\u0649",id:5},{name:"Is Cancel",nameAr:"\u062a\u0645 \u0627\u0644\u0625\u0644\u063a\u0627\u0621",id:6},{name:"Is Assign",nameAr:"\u062a\u0645 \u062a\u0639\u064a\u064a\u0646\u0647",id:7},{name:"Is Urgent",nameAr:"\u0639\u0627\u062c\u0644",id:8},{name:"New",nameAr:"\u062c\u062f\u064a\u062f",id:9}]}GetOrderLookUp(){this.baseService.GetOrderLookUp().subscribe(t=>{this.users=t.data.users},t=>{console.log(t)})}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetDistricts(t){this.districtService.getByCityId(t).subscribe(i=>{this.districts=i.data},i=>{console.log(i)})}GetChannels(){this.channelService.getDropDown().subscribe(t=>{this.channels=t.data},t=>{console.log(t)})}GetTeams(){this.teamService.getDropDown().subscribe(t=>{this.teams=t.data},t=>{console.log(t)})}GetTimes(){this.workTimeService.getDropDown().subscribe(t=>{this.workTimes=t.data},t=>{console.log(t)})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,u.Q)(this.notifier)).subscribe(i=>{i?this.alertService.success():this.alertService.error("general.message."+i)},i=>{this.alertService.error()})}mapRegisterForm(t){let i={...t};return i.employeeCode=0,i}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader("allLoader"),this.setDates(t.dates,"visitDateFrom","visitDateTo"),this.setDates(t.creationDates,"creationDateFrom","creationDateTo"),this.loadentities()}LoadSuccess(){this.ngxLoader.stopLoader("allLoader")}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems}}configRoute(){this.routerActive.data.pipe((0,u.Q)(this.notifier)).subscribe(t=>{this.entities=t.data,this.pagination.totalItems=t.data?.totalItems},()=>{this.alertService.error()})}mapExcel(){let t=[];return this.entities.forEach(i=>{t.push({"Order Code":i.orderCode,"Created Date":i.createdDate,"City Name":i.cityName,"District Name":i.districtName?i.districtName:"--",Status:this.translateService.instant(this.getTrnslate(i)),"Agent Name":i.agentName,Mobile:i.mobile,"Channel Name":i.channelName,"Assigned To":i.teamNames,Times:i.workTimes,"Visit Date":i.visitDate,Services:i.services})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}goRegister(){this.router.navigateByUrl("/managment/order/new")}goEdit(t){this.router.navigateByUrl("/managment/order/new")}getStatus(t){return t.isCancel?"bg-danger-subtle text-danger":t.isFinish?"requestFinished":t.isAssign||t.isConfirmed?"startWork":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen||t.isFree?"bg-warning-subtle text-warning":"bg-success-subtle text-success"}checkEdit(t){return!t.isCancel&&!t.isFinish}getTrnslate(t){return t.isCancel?"orderManagement.order.cancel":t.isFinish?"orderManagement.order.finish":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen?"orderManagement.order.reopen":t.isAssign?"orderManagement.order.assign":t.isConfirmed?"orderManagement.order.confirmed":t.isFree?"orderManagement.order.free":"orderManagement.order.new"}openModalClient(t,i,n="xl"){this.clientSelected=t.orderCode,this.orderSelected=t,this.isOrderEdit=!1,this.modalService.open(i,{centered:!0,size:n})}oncityChange(t){this.GetDistricts(t.code)}getTimes(t){return t?.split(",")}getServices(t){return t.split("#")}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}openEditOrderModal(t,i,n="md"){this.form={},this.isOrderEdit=!0,this.clientSelected=t,this.modalService.open(i,{centered:!0,size:n})}OpenOrderTimeLineModel(t,i,n="md"){this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(_.nX),e.rXU(p.c$),e.rXU(k.Q),e.rXU(O.u),e.rXU(d.vh),e.rXU(C.eD),e.rXU(h.Bq),e.rXU(g.J),e.rXU(J.n),e.rXU(le.G),e.rXU(z.V),e.rXU(Q.h),e.rXU(te.m),e.rXU(ne.l),e.rXU(_.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-all-order"]],features:[e.Vt3],decls:69,vars:71,consts:[["tableMaster",""],["deleteModal",""],["clientProfile",""],["orderViewModel",""],["orderModel",""],["OrderTimeLineModel",""],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"reset","search","exportXlsx","addNew","showAdd","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","search","id","agentName","name","agentName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["InputTirmFilter","","type","search","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","id",3,"ngModelChange","placeholder","items","multiple","bindLabel","ngModel"],["name","name","bindValue","code","bindLabel","name",3,"change","ngModelChange","placeholder","items","multiple","ngModel"],["name","districtId","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["name","employeeCode","bindValue","name","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["name","createdBy","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["translate","",2,"width",".5%"],["pSortableColumn","orderCode","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["pSortableColumn","createdDate","translate","",2,"width","13%"],["pSortableColumn","cityName","translate","",2,"width","10%"],["pSortableColumn","status","translate","",2,"width","6%"],["pSortableColumn","agentName","translate","",2,"width","12%"],["pSortableColumn","channelName","translate","",2,"width","7%"],["pSortableColumn","assignTo","translate","",2,"width","8%"],["pSortableColumn","workTimes","translate","",2,"width","8%"],["pSortableColumn","visitDate","translate","",2,"width","8%"],["translate","",2,"width","10%"],["translate","",2,"width","25%"],[1,"fs-5"],[3,"click"],[1,"code-pointer"],[1,"badge","bg-success-subtle","text-success"],["class","badge bg-danger-subtle text-danger","translate","orderManagement.order.nothing",4,"ngIf"],["class","badge bg-success-subtle text-success",4,"ngIf"],[3,"translate"],[1,"badge","bg-primary-subtle","text-primary","my-1"],[1,"cursor-pointer","badge","bg-danger-subtle","text-danger","fs-6",3,"click"],[1,"ri-clipboard-line"],[4,"ngFor","ngForOf"],[1,"ri-history-fill","d-inline","text-primary","fs-16","align-middle","me-1",3,"click"],["type","button","class","btn px-4 w-auto btn-sm btn-primary btn-label  waves-effect waves-light rounded-pill",3,"click",4,"ngIf"],["translate","orderManagement.order.nothing",1,"badge","bg-danger-subtle","text-danger"],[1,"badge","bg-primary-subtle","text-primary","mx-1"],["type","button",1,"btn","px-4","w-auto","btn-sm","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"click"],[1,"ri-edit-2-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.edit"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"deleteConfirm","dismiss"],["","clientSelected"],[3,"dismiss","orderDetails"],[3,"isOrderEdit","isInner","orderCode"],[3,"dismiss","orderSelected"]],template:function(i,n){if(1&i){const a=e.RV6();e.j41(0,"div",6)(1,"div",7)(2,"div",8),e.nrm(3,"ngx-ui-loader",9),e.j41(4,"base-filter",10),e.bIt("reset",function(){return e.eBV(a),e.Njj(n.onReset())})("search",function(){return e.eBV(a),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(a),e.Njj(n.onExportXlsx())})("addNew",function(){return e.eBV(a),e.Njj(n.goRegister())}),e.qex(5,11),e.j41(6,"div",12)(7,"div",13)(8,"input",14),e.nI1(9,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.orderCode,s)||(n.pagination.orderCode=s),e.Njj(s)}),e.k0s(),e.nrm(10,"i",15),e.k0s()(),e.j41(11,"div",12)(12,"div",13)(13,"input",16),e.nI1(14,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.agentName,s)||(n.pagination.agentName=s),e.Njj(s)}),e.k0s(),e.nrm(15,"i",15),e.k0s()(),e.j41(16,"div",12)(17,"div",13)(18,"input",17),e.nI1(19,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.mobile,s)||(n.pagination.mobile=s),e.Njj(s)}),e.k0s(),e.nrm(20,"i",15),e.k0s()(),e.j41(21,"div",12)(22,"div",13)(23,"ng-select",18),e.nI1(24,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.statusFilter,s)||(n.pagination.statusFilter=s),e.Njj(s)}),e.k0s()()(),e.j41(25,"div",12)(26,"div",13)(27,"ng-select",19),e.nI1(28,"translate"),e.bIt("change",function(s){return e.eBV(a),e.Njj(n.oncityChange(s))}),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.cityCode,s)||(n.pagination.cityCode=s),e.Njj(s)}),e.k0s()()(),e.j41(29,"div",12)(30,"div",13)(31,"ng-select",20),e.nI1(32,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.districtId,s)||(n.pagination.districtId=s),e.Njj(s)}),e.k0s()()(),e.j41(33,"div",12)(34,"div",13)(35,"ng-select",21),e.nI1(36,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.teamName,s)||(n.pagination.teamName=s),e.Njj(s)}),e.k0s()()(),e.j41(37,"div",12)(38,"div",13)(39,"ng-select",21),e.nI1(40,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.workTimes,s)||(n.pagination.workTimes=s),e.Njj(s)}),e.k0s()()(),e.j41(41,"div",12)(42,"div",13)(43,"ng-select",22),e.nI1(44,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.createdBy,s)||(n.pagination.createdBy=s),e.Njj(s)}),e.k0s()()(),e.j41(45,"div",12)(46,"input",23),e.nI1(47,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.dates,s)||(n.searchForm.dates=s),e.Njj(s)}),e.k0s()(),e.j41(48,"div",12)(49,"input",23),e.nI1(50,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.creationDates,s)||(n.searchForm.creationDates=s),e.Njj(s)}),e.k0s()(),e.bVm(),e.k0s(),e.j41(51,"div",24)(52,"div",25)(53,"p-table",26,0),e.bIt("onLazyLoad",function(s){return e.eBV(a),e.Njj(n.tableChange(s))})("selectionChange",function(s){return e.eBV(a),e.Njj(n.onSelectionChange(s))}),e.DNE(55,at,30,0,"ng-template",27)(56,pt,39,25,"ng-template",28),e.k0s()(),e.DNE(57,gt,2,0,"div",29)(58,ht,6,8,"div",30),e.k0s()()()(),e.DNE(59,ut,1,0,"ng-template",null,1,e.C5r)(61,_t,1,0,"ng-template",null,2,e.C5r)(63,ft,1,1,"ng-template",null,3,e.C5r)(65,bt,1,3,"ng-template",null,4,e.C5r)(67,vt,1,1,"ng-template",null,5,e.C5r)}2&i&&(e.R7$(3),e.Y8G("loaderId","allLoader"),e.R7$(),e.Y8G("showAdd",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(9,49,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.orderCode),e.R7$(5),e.FS9("placeholder",e.bMT(14,51,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.agentName),e.R7$(5),e.FS9("placeholder",e.bMT(19,53,"orderManagement.order.mobile")),e.R50("ngModel",n.pagination.mobile),e.R7$(5),e.FS9("placeholder",e.bMT(24,55,"orderManagement.order.status")),e.FS9("bindLabel","en"==n.lang?"name":"nameAr"),e.Y8G("items",n.status)("multiple",!1),e.R50("ngModel",n.pagination.statusFilter),e.R7$(4),e.FS9("placeholder",e.bMT(28,57,"orderManagement.order.cityName")),e.Y8G("items",n.cities)("multiple",!1),e.R50("ngModel",n.pagination.cityCode),e.R7$(4),e.FS9("placeholder",e.bMT(32,59,"orderManagement.order.districtName")),e.Y8G("items",n.districts)("multiple",!1),e.R50("ngModel",n.pagination.districtId),e.R7$(4),e.FS9("placeholder",e.bMT(36,61,"orderManagement.order.teams")),e.Y8G("items",n.teams)("multiple",!1),e.R50("ngModel",n.pagination.teamName),e.R7$(4),e.FS9("placeholder",e.bMT(40,63,"orderManagement.order.workTimes")),e.Y8G("items",n.workTimes)("multiple",!1),e.R50("ngModel",n.pagination.workTimes),e.R7$(4),e.FS9("placeholder",e.bMT(44,65,"orderManagement.order.creation")),e.Y8G("items",n.users)("multiple",!1),e.R50("ngModel",n.pagination.createdBy),e.R7$(3),e.FS9("placeholder",e.bMT(47,67,"orderManagement.order.visitDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.dates),e.R7$(3),e.FS9("placeholder",e.bMT(50,69,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(4),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[d.Sq,d.bT,c.me,c.Q0,c.BC,c.vS,h.s5,j.kL,q.b,ge.L,Ce.w,ie.p,re.g,Pe.t,p.Mm,x.XI,K.Ei,x.Tg,C.Cv,U.vr,W.m,me,rt,d.vh,p.D9],encapsulation:2})}}return r})();var B=m(70980),f=m(36158),Y=m(37021),P=m(35335),H=m(45236),pe=function(r){return r[r.None=0]="None",r[r.Reviewed=1]="Reviewed",r[r.Confirmed=2]="Confirmed",r[r.Free=3]="Free",r[r.Reopened=4]="Reopened",r[r.Finished=5]="Finished",r[r.Canceled=6]="Canceled",r[r.Assigned=7]="Assigned",r[r.Urgent=8]="Urgent",r[r.New=9]="New",r}(pe||{}),_e=m(91020),de=m(38542),Be=m(21413);let Se=(()=>{class r{constructor(t,i,n,a){this.cancelReasonService=t,this.orderService=i,this.ngxLoader=n,this.alertService=a,this.cancelReasons=[],this.form={},this.orderId=0,this.loaderOperationShap=f.$$,this.operationLoader=f.ZW,this.notifier=new Be.B,this.success=new e.bkB,this.dismiss=new e.bkB}ngOnInit(){this.GetReturnReasons()}GetReturnReasons(){this.cancelReasonService.getDropDown().subscribe(t=>{this.cancelReasons=t.data},t=>{console.log(t)})}onCancelOrder(){let t={cancelReasonCode:this.form.cancelReasonCode,orderId:this.orderId};this.ngxLoader.startLoader(this.operationLoader),this.orderService.CancelOrder(t).pipe((0,u.Q)(this.notifier)).subscribe(i=>{this.ngxLoader.stopLoader(this.operationLoader),i.success?(this.alertService.success(),this.success.emit(!0),this.dismiss.emit(!0)):this.alertService.error()},()=>{this.alertService.error(),this.ngxLoader.stopLoader(this.operationLoader)})}dismissFn(){this.dismiss.emit(!0)}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(_e.e),e.rXU(k.Q),e.rXU(C.eD),e.rXU(O.u))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["cancel-order-model"]],inputs:{orderId:"orderId"},outputs:{success:"success",dismiss:"dismiss"},decls:19,vars:10,consts:[["formEntity","ngForm"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["translate","orderManagement.order.cancelReasonName",1,"fw-bold","fs-4"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"hasProgressBar","fgsType","loaderId"],[3,"ngSubmit"],[1,"row"],[1,"mb-3"],["for","actionMismatch","translate","",1,"required","fw-bold","form-label"],["name","name","bindValue","code","bindLabel","name","required","",3,"ngModelChange","placeholder","items","multiple","ngModel"],[1,"text-center"],["type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"]],template:function(i,n){if(1&i){const a=e.RV6();e.j41(0,"div",1)(1,"div",2)(2,"h4",3),e.nrm(3,"span",4),e.k0s(),e.j41(4,"button",5),e.bIt("click",function(){return e.eBV(a),e.Njj(n.dismissFn())}),e.k0s()(),e.j41(5,"div",6),e.nrm(6,"ngx-ui-loader",7),e.j41(7,"form",8,0),e.bIt("ngSubmit",function(){return e.eBV(a),e.Njj(n.onCancelOrder())}),e.j41(9,"div",9)(10,"div",10)(11,"label",11),e.EFF(12,"orderManagement.order.cancelReasonName"),e.k0s(),e.j41(13,"ng-select",12),e.nI1(14,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.form.cancelReasonCode,s)||(n.form.cancelReasonCode=s),e.Njj(s)}),e.k0s()()(),e.j41(15,"div",13)(16,"button",14),e.nrm(17,"i",15)(18,"span",16),e.k0s()()()()()}if(2&i){const a=e.sdS(8);e.R7$(6),e.Y8G("hasProgressBar",!1)("fgsType",n.loaderOperationShap)("loaderId",n.operationLoader),e.R7$(7),e.FS9("placeholder",e.bMT(14,8,"orderManagement.order.cancelReasonName")),e.Y8G("items",n.cancelReasons)("multiple",!1),e.R50("ngModel",n.form.cancelReasonCode),e.R7$(3),e.Y8G("disabled",!a.valid)}},dependencies:[c.qT,c.BC,c.cb,c.YS,c.vS,c.cV,p.Mm,C.Cv,U.vr,p.D9],encapsulation:2})}}return r})();const xt=()=>["newOrder.edit"],It=()=>["newOrder.confirmed"],Ft=()=>["newOrder.cancel"];function Mt(r,o){1&r&&(e.j41(0,"tr",31)(1,"th",32),e.nrm(2,"i",33),e.EFF(3," orderManagement.order.orderCode "),e.k0s(),e.j41(4,"th",34),e.nrm(5,"i",33),e.EFF(6," orderManagement.order.createdDate "),e.k0s(),e.j41(7,"th",35),e.nrm(8,"i",33),e.EFF(9," orderManagement.order.creationUser "),e.k0s(),e.j41(10,"th",36),e.nrm(11,"i",33),e.EFF(12," orderManagement.order.cityName "),e.k0s(),e.j41(13,"th",37),e.nrm(14,"i",33),e.EFF(15," orderManagement.order.agentName "),e.k0s(),e.j41(16,"th",38),e.EFF(17," orderManagement.order.assignTo "),e.k0s(),e.j41(18,"th",39),e.EFF(19," orderManagement.order.workTimes "),e.k0s(),e.j41(20,"th",40),e.nrm(21,"i",33),e.EFF(22," orderManagement.order.visitDate "),e.k0s(),e.j41(23,"th",41),e.EFF(24," orderManagement.order.services "),e.k0s(),e.nrm(25,"th",42),e.k0s())}function jt(r,o){1&r&&e.nrm(0,"span",56)}function Tt(r,o){if(1&r&&(e.j41(0,"span",57),e.EFF(1),e.k0s()),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI("",t.districtName," ")}}function St(r,o){if(1&r&&(e.qex(0),e.j41(1,"span",58),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.bVm()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t)}}function kt(r,o){if(1&r&&(e.qex(0),e.j41(1,"span",58),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.bVm()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t)}}function yt(r,o){if(1&r&&(e.qex(0),e.j41(1,"span",58),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.bVm()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t)}}function Rt(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",59),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,a=e.XpG(),l=e.sdS(65);return e.Njj(a.openEditOrderModal(n.orderCode,l,"xxl"))}),e.nrm(2,"i",60),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"orderManagement.order.editOrders"))}function Et(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",61),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,a=e.XpG(),l=e.sdS(61);return e.Njj(a.openModal(n.orderCode,l))}),e.nrm(2,"i",62),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"orderManagement.order.confirmOrder"))}function wt(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",63),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,a=e.XpG(),l=e.sdS(63);return e.Njj(a.openModal(n.orderCode,l))}),e.nrm(2,"i",64),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"orderManagement.order.cancelOrder"))}function Nt(r,o){if(1&r){const t=e.RV6();e.j41(0,"tr",43)(1,"td",44),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),l=e.sdS(65);return e.Njj(a.openModal(n.orderCode,l,"xxl"))}),e.j41(2,"bdi",45),e.EFF(3),e.k0s()(),e.j41(4,"td"),e.EFF(5),e.nI1(6,"date"),e.k0s(),e.j41(7,"td")(8,"span",46),e.EFF(9),e.k0s()(),e.j41(10,"td"),e.EFF(11),e.DNE(12,jt,1,0,"span",47)(13,Tt,2,1,"span",48),e.k0s(),e.j41(14,"td")(15,"span",46),e.EFF(16),e.k0s(),e.nrm(17,"br"),e.j41(18,"span",49),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.copytext(n.mobile))}),e.EFF(19),e.nrm(20,"i",50),e.k0s()(),e.j41(21,"td"),e.DNE(22,St,4,1,"ng-container",51),e.k0s(),e.j41(23,"td"),e.DNE(24,kt,4,1,"ng-container",51),e.k0s(),e.j41(25,"td"),e.EFF(26),e.nI1(27,"date"),e.k0s(),e.j41(28,"td"),e.DNE(29,yt,4,1,"ng-container",51),e.k0s(),e.j41(30,"td")(31,"div",52),e.DNE(32,Rt,3,3,"button",53)(33,Et,3,3,"button",54)(34,wt,3,3,"button",55),e.k0s()()()}if(2&r){const t=o.$implicit,i=e.XpG();e.R7$(3),e.SpI("#SO#",t.orderCode,""),e.R7$(2),e.JRh(e.i5U(6,15,t.createdDate,"yyyy-MM-dd")),e.R7$(4),e.SpI("",t.creationUser," "),e.R7$(2),e.SpI("",t.cityName," "),e.R7$(),e.Y8G("ngIf",null==t.districtName),e.R7$(),e.Y8G("ngIf",null!==t.districtName),e.R7$(3),e.SpI("",t.agentName," "),e.R7$(3),e.SpI("",t.mobile," "),e.R7$(3),e.Y8G("ngForOf",i.getTimes(t.teamNames)),e.R7$(2),e.Y8G("ngForOf",i.getTimes(t.workTimes)),e.R7$(2),e.SpI(" ",e.i5U(27,18,t.visitDate,"yyyy-MM-dd"),""),e.R7$(3),e.Y8G("ngForOf",i.getServices(t.services)),e.R7$(3),e.Y8G("hasPermission",e.lJ4(21,xt)),e.R7$(),e.Y8G("hasPermission",e.lJ4(22,It)),e.R7$(),e.Y8G("hasPermission",e.lJ4(23,Ft))}}function Dt(r,o){1&r&&(e.j41(0,"div",65),e.EFF(1," general.table.noData "),e.k0s())}function Ot(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",66)(1,"div",67),e.nrm(2,"ngb-pagination-info",68),e.j41(3,"table-length",69),e.bIt("lengthChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",70)(5,"ngb-pagination",71),e.bIt("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.pagination.pageNumber,n)||(a.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function Vt(r,o){if(1&r){const t=e.RV6();e.j41(0,"form",72,5),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.SubmitOrder())}),e.nrm(2,"ngx-ui-loader",73),e.j41(3,"div",74)(4,"div",75)(5,"button",76),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"div",77)(7,"div",78),e.nrm(8,"lord-icon",79),e.j41(9,"div",80),e.nrm(10,"h3",81)(11,"p",82),e.k0s()(),e.j41(12,"div",83),e.nrm(13,"button",84),e.j41(14,"button",85),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}function Gt(r,o){if(1&r){const t=e.RV6();e.j41(0,"cancel-order-model",86),e.bIt("success",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.loadentities())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderId",t.orderSelected)}}function At(r,o){if(1&r&&e.nrm(0,"order-operation",87),2&r){const t=e.XpG();e.Y8G("isOrderEdit",t.isOrderEdit)("isInner",!0)("orderCode",t.orderSelected)}}function Lt(r,o){if(1&r){const t=e.RV6();e.j41(0,"order-timeline",88),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderSelected",t.orderSelected)}}let Bt=(()=>{class r extends D.w{constructor(t,i,n,a,l,s,I,b,T,S,y,R,M,w,N,F){super(t,i,I,n,a,l,s),this.baseService=n,this.authDaamService=b,this.excelService=T,this.cityService=S,this.teamService=y,this.workTimeService=R,this.districtService=M,this.channelService=w,this.router=N,this.cancelReasonService=F,this.title="orderManagement.order.newOrders.title",this.titleOperation="orderManagement.order.newOrders.titleOperation",this.language=localStorage.getItem("language"),this.keySelected="",this.assignUsers=[],this.times=[],this.employees=[],this.searchForm={},this.isResolveList=!0,this.employeeTypes=[{id:1,name:"employeeTeam"},{id:2,name:"managment"},{id:3,name:"customerService"}],this.employeeGroups=[],this.activeindex="1",this.active=1,this.formPassword={},this.roles=[],this.userTypes=[],this.actives=[{id:!0,name:"active"},{id:!1,name:"noActive"}],this.OrderStatusEnum=pe,this.countLoad=2,this.orderSelected=0,this.cities=[],this.districts=[],this.channels=[],this.cancelReasons=[],this.isOrderEdit=!1,this.teams=[],this.workTimes=[],this.setDates=(E,$,L)=>{if(E?.from||E?.to){const oe=E.to||E.from;this.pagination[$]=this.datePipe.transform(E.from||E.to,"yyyy-MM-ddT00:00:00"),this.pagination[L]=this.datePipe.transform(oe,"yyyy-MM-ddT23:59:59.999")}else this.pagination[$]=null,this.pagination[L]=null},this.GetCities(),this.GetChannels(),this.GetChannels(),this.GetTeams(),this.GetTimes()}GetTeams(){this.teamService.getDropDown().subscribe(t=>{this.teams=t.data},t=>{console.log(t)})}GetTimes(){this.workTimeService.getDropDown().subscribe(t=>{this.workTimes=t.data},t=>{console.log(t)})}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetDistricts(t){this.districtService.getByCityId(t).subscribe(i=>{this.districts=i.data},i=>{console.log(i)})}GetChannels(){this.channelService.getDropDown().subscribe(t=>{this.channels=t.data},t=>{console.log(t)})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,u.Q)(this.notifier)).subscribe(i=>{i?this.alertService.success():this.alertService.error("general.message."+i)},i=>{this.alertService.error()})}mapRegisterForm(t){let i={...t};return i.employeeCode=0,i}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader(f.a7),this.setDates(t.dates,"visitDateFrom","visitDateTo"),this.setDates(t.creationDates,"creationDateFrom","creationDateTo"),this.loadentities()}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems}}loadentities(){this.countLoad=this.countLoad+1,this.pagination.statusFilter=this.OrderStatusEnum.New,(!this.isResolveList||1!==this.countLoad)&&(this.ngxLoader.startLoader("newOrder"),this.baseService.get(this.pagination).pipe((0,u.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader("newOrder"),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader("newOrder"),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}LoadSuccess(){this.ngxLoader.stopLoader("newOrder")}mapExcel(){let t=[];return this.entities.forEach(i=>{t.push({"Order Code":i.orderCode,"Created Date":i.createdDate,"City Name":i.cityName,"District Name":i.districtName?i.districtName:"--","Agent Name":i.agentName,Mobile:i.mobile,"Assigned To":i.teamNames,Times:i.workTimes,"Visit Date":i.visitDate,Services:i.services})}),t}SubmitOrder(){this.ngxLoader.startLoader(f.Fq),this.baseService.SubmitOrder(this.orderSelected).pipe((0,Y.O)(),(0,P.c)(this.mainDelay),(0,H.Z)(),(0,u.Q)(this.notifier),(0,B.j)(()=>this.ngxLoader.stopLoader(f.Fq))).subscribe({next:t=>{this.modalService.dismissAll(),this.loadentities(),this.alertService.success()}})}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}goRegister(){this.router.navigateByUrl("/managment/order/new")}goEdit(t){this.router.navigateByUrl("/managment/order/new")}getStatus(t){return t.isCancel?"bg-warning-subtle text-warning":t.isFinish?"bg-success-subtle text-success":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen||t.isFree?"bg-warning-subtle text-warning":"bg-success-subtle text-success"}getTrnslate(t){return t.isCancel?"orderManagement.order.cancel":t.isFinish?"orderManagement.order.finish":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen?"orderManagement.order.reopen":t.isFree?"orderManagement.order.free":"orderManagement.order.finished"}openModal(t,i,n="md"){this.isOrderEdit=!1,this.form={},this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}openEditOrderModal(t,i,n="md"){this.form={},this.isOrderEdit=!0,this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}oncityChange(t){this.GetDistricts(t.code)}getTimes(t){return t.split(",")}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}getServices(t){return t.split("#")}OpenOrderTimeLineModel(t,i,n="md"){this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(_.nX),e.rXU(p.c$),e.rXU(k.Q),e.rXU(O.u),e.rXU(d.vh),e.rXU(C.eD),e.rXU(h.Bq),e.rXU(g.J),e.rXU(z.V),e.rXU(Q.h),e.rXU(J.n),e.rXU(le.G),e.rXU(te.m),e.rXU(ne.l),e.rXU(_.Ix),e.rXU(_e.e))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-new-orders"]],features:[e.Vt3],decls:68,vars:68,consts:[["tableMaster",""],["SubmitOrderModal",""],["deleteModal",""],["orderModel",""],["OrderTimeLineModel",""],["formEntity","ngForm"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"reset","search","exportXlsx","showAdd","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","search","id","agentName","name","agentName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["InputTirmFilter","","type","search","id","creationUser","name","creationUser",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["InputTirmFilter","","type","search","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","code","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["name","name","bindValue","code","bindLabel","name",3,"change","ngModelChange","placeholder","items","multiple","ngModel"],["name","districtId","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["name","employeeCode","bindValue","name","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["pSortableColumn","orderCode","translate","",2,"width","5%"],[1,"ri-expand-up-down-line"],["pSortableColumn","createdDate","translate","",2,"width","8%"],["pSortableColumn","creationUser","translate","",2,"width","10%"],["pSortableColumn","cityName","translate","",2,"width","8%"],["pSortableColumn","agentName","translate","",2,"width","5%"],["translate","",2,"width","8%"],["translate","",2,"width","5%"],["pSortableColumn","visitDate","translate","",2,"width","7%"],["translate","",2,"width","10%"],[2,"width","10%"],[1,"fs-5"],[3,"click"],[1,"code-pointer"],[1,"badge","bg-primary-subtle","text-primary","my-1"],["class","badge bg-danger-subtle text-danger","translate","orderManagement.order.nothing",4,"ngIf"],["class","badge bg-success-subtle text-success",4,"ngIf"],[1,"cursor-pointer","badge","bg-danger-subtle","text-danger","fs-6",3,"click"],[1,"ri-clipboard-line"],[4,"ngFor","ngForOf"],[1,"d-inline"],["tooltipPosition","top","class","btn btn-sm btn-soft-info edit-list ",3,"pTooltip","click",4,"hasPermission"],["class","btn btn-sm btn-success edit-list mx-1","tooltipPosition","top",3,"pTooltip","click",4,"hasPermission"],["tooltipPosition","top","class","btn btn-sm btn-soft-danger remove-list  ",3,"pTooltip","click",4,"hasPermission"],["translate","orderManagement.order.nothing",1,"badge","bg-danger-subtle","text-danger"],[1,"badge","bg-success-subtle","text-success"],[1,"badge","bg-primary-subtle","text-primary","mx-1"],["tooltipPosition","top",1,"btn","btn-sm","btn-soft-info","edit-list",3,"click","pTooltip"],[1,"ri-pencil-fill","align-bottom"],["tooltipPosition","top",1,"btn","btn-sm","btn-success","edit-list","mx-1",3,"click","pTooltip"],[1,"ri-check-fill","align-bottom"],["tooltipPosition","top",1,"btn","btn-sm","btn-soft-danger","remove-list",3,"click","pTooltip"],[1,"ri-delete-bin-5-fill","align-bottom"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"ngSubmit"],[3,"hasProgressBar","fgsType","loaderId"],[1,"modal-content"],[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mt-2","text-center"],["src","https://cdn.lordicon.com/gdfrsvpt.json","stroke","bold","state","hover-oscillate","trigger","loop","colors","primary:#f7b84b,secondary:#f06548",2,"width","130px","height","130px"],[1,"pt-2","fs-15","mx-4","mx-sm-5"],["translate","orderManagement.order.AreYouSureMessage"],[1,"text-muted","mx-4","mb-0"],[1,"d-flex","gap-2","justify-content-center","mt-4","mb-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],[3,"success","dismiss","orderId"],[3,"isOrderEdit","isInner","orderCode"],[3,"dismiss","orderSelected"]],template:function(i,n){if(1&i){const a=e.RV6();e.j41(0,"div",6)(1,"div",7)(2,"div",8),e.nrm(3,"ngx-ui-loader",9),e.j41(4,"base-filter",10),e.bIt("reset",function(){return e.eBV(a),e.Njj(n.onReset())})("search",function(){return e.eBV(a),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(a),e.Njj(n.onExportXlsx())}),e.qex(5,11),e.j41(6,"div",12)(7,"div",13)(8,"input",14),e.nI1(9,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.orderCode,s)||(n.pagination.orderCode=s),e.Njj(s)}),e.k0s(),e.nrm(10,"i",15),e.k0s()(),e.j41(11,"div",12)(12,"div",13)(13,"input",16),e.nI1(14,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.agentName,s)||(n.pagination.agentName=s),e.Njj(s)}),e.k0s(),e.nrm(15,"i",15),e.k0s()(),e.j41(16,"div",12)(17,"div",13)(18,"input",17),e.nI1(19,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.creationUser,s)||(n.pagination.creationUser=s),e.Njj(s)}),e.k0s(),e.nrm(20,"i",15),e.k0s()(),e.j41(21,"div",12)(22,"div",13)(23,"input",18),e.nI1(24,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.mobile,s)||(n.pagination.mobile=s),e.Njj(s)}),e.k0s(),e.nrm(25,"i",15),e.k0s()(),e.j41(26,"div",12)(27,"div",13)(28,"ng-select",19),e.nI1(29,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.channelCode,s)||(n.pagination.channelCode=s),e.Njj(s)}),e.k0s()()(),e.j41(30,"div",12)(31,"div",13)(32,"ng-select",20),e.nI1(33,"translate"),e.bIt("change",function(s){return e.eBV(a),e.Njj(n.oncityChange(s))}),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.cityCode,s)||(n.pagination.cityCode=s),e.Njj(s)}),e.k0s()()(),e.j41(34,"div",12)(35,"div",13)(36,"ng-select",21),e.nI1(37,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.districtId,s)||(n.pagination.districtId=s),e.Njj(s)}),e.k0s()()(),e.j41(38,"div",12)(39,"div",13)(40,"ng-select",22),e.nI1(41,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.teamName,s)||(n.pagination.teamName=s),e.Njj(s)}),e.k0s()()(),e.j41(42,"div",12)(43,"div",13)(44,"ng-select",22),e.nI1(45,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.workTimes,s)||(n.pagination.workTimes=s),e.Njj(s)}),e.k0s()()(),e.j41(46,"div",12)(47,"input",23),e.nI1(48,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.dates,s)||(n.searchForm.dates=s),e.Njj(s)}),e.k0s()(),e.j41(49,"div",12)(50,"input",23),e.nI1(51,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.creationDates,s)||(n.searchForm.creationDates=s),e.Njj(s)}),e.k0s()(),e.bVm(),e.k0s(),e.j41(52,"div",24)(53,"div",25)(54,"p-table",26,0),e.bIt("onLazyLoad",function(s){return e.eBV(a),e.Njj(n.tableChange(s))})("selectionChange",function(s){return e.eBV(a),e.Njj(n.onSelectionChange(s))}),e.DNE(56,Mt,26,0,"ng-template",27)(57,Nt,35,24,"ng-template",28),e.k0s()(),e.DNE(58,Dt,2,0,"div",29)(59,Ot,6,8,"div",30),e.k0s()()()(),e.DNE(60,Vt,15,3,"ng-template",null,1,e.C5r)(62,Gt,1,1,"ng-template",null,2,e.C5r)(64,At,1,3,"ng-template",null,3,e.C5r)(66,Lt,1,1,"ng-template",null,4,e.C5r)}2&i&&(e.R7$(3),e.Y8G("loaderId","newOrder"),e.R7$(),e.Y8G("showAdd",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(9,46,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.orderCode),e.R7$(5),e.FS9("placeholder",e.bMT(14,48,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.agentName),e.R7$(5),e.FS9("placeholder",e.bMT(19,50,"orderManagement.order.creationUser")),e.R50("ngModel",n.pagination.creationUser),e.R7$(5),e.FS9("placeholder",e.bMT(24,52,"orderManagement.order.mobile")),e.R50("ngModel",n.pagination.mobile),e.R7$(5),e.FS9("placeholder",e.bMT(29,54,"orderManagement.order.channelName")),e.Y8G("items",n.channels)("multiple",!1),e.R50("ngModel",n.pagination.channelCode),e.R7$(4),e.FS9("placeholder",e.bMT(33,56,"orderManagement.order.cityName")),e.Y8G("items",n.cities)("multiple",!1),e.R50("ngModel",n.pagination.cityCode),e.R7$(4),e.FS9("placeholder",e.bMT(37,58,"orderManagement.order.districtName")),e.Y8G("items",n.districts)("multiple",!1),e.R50("ngModel",n.pagination.districtId),e.R7$(4),e.FS9("placeholder",e.bMT(41,60,"orderManagement.order.teams")),e.Y8G("items",n.teams)("multiple",!1),e.R50("ngModel",n.pagination.teamName),e.R7$(4),e.FS9("placeholder",e.bMT(45,62,"orderManagement.order.workTimes")),e.Y8G("items",n.workTimes)("multiple",!1),e.R50("ngModel",n.pagination.workTimes),e.R7$(3),e.FS9("placeholder",e.bMT(48,64,"orderManagement.order.visitDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.dates),e.R7$(3),e.FS9("placeholder",e.bMT(51,66,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(4),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[d.Sq,d.bT,c.qT,c.me,c.Q0,c.BC,c.cb,c.vS,c.cV,h.s5,j.kL,q.b,ge.L,ie.p,re.g,p.Mm,x.XI,K.Ei,x.Tg,C.Cv,U.vr,W.m,v.p,de.m,Se,me,d.vh,p.D9],encapsulation:2})}}return r})();const $t=r=>({"bg-warning-subtle":r}),Xt=()=>["urgented.assignTeam"],Ut=()=>["urgented.edit"],Yt=()=>["urgented.cancel"];function Pt(r,o){1&r&&(e.j41(0,"tr",31)(1,"th",32),e.nrm(2,"i",33),e.EFF(3," orderManagement.order.orderCode "),e.k0s(),e.j41(4,"th",34),e.nrm(5,"i",33),e.EFF(6," orderManagement.order.createdDate "),e.k0s(),e.j41(7,"th",35),e.nrm(8,"i",33),e.EFF(9," orderManagement.order.creationUser "),e.k0s(),e.j41(10,"th",36),e.nrm(11,"i",33),e.EFF(12," orderManagement.order.cityName "),e.k0s(),e.j41(13,"th",37),e.nrm(14,"i",33),e.EFF(15," orderManagement.order.agentName "),e.k0s(),e.j41(16,"th",38),e.EFF(17," orderManagement.order.assignTo "),e.k0s(),e.j41(18,"th",38),e.EFF(19," orderManagement.order.workTimes "),e.k0s(),e.j41(20,"th",39),e.nrm(21,"i",33),e.EFF(22," orderManagement.order.visitDate "),e.k0s(),e.j41(23,"th",40),e.EFF(24," orderManagement.order.location "),e.k0s(),e.nrm(25,"th",41),e.k0s())}function Ht(r,o){1&r&&e.nrm(0,"span",58)}function zt(r,o){if(1&r&&(e.j41(0,"span",59),e.EFF(1),e.k0s()),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI("",t.districtName," ")}}function Jt(r,o){if(1&r&&(e.qex(0),e.j41(1,"span",60),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.bVm()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t)}}function qt(r,o){if(1&r&&(e.qex(0),e.j41(1,"span",60),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.bVm()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t)}}function Wt(r,o){1&r&&e.nrm(0,"span",61)}function Qt(r,o){if(1&r&&(e.j41(0,"a",62),e.nrm(1,"i",63),e.k0s()),2&r){const t=e.XpG().$implicit,i=e.XpG();e.Y8G("href",i.mapUrl(null==t?null:t.map),e.B4B)}}function Kt(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",64),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,a=e.XpG(),l=e.sdS(58);return e.Njj(a.openAssignOrderModalModal(n,l,"lg"))}),e.nrm(2,"i",65),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"orderManagement.order.confirmOrder"))}function Zt(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",66),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,a=e.XpG(),l=e.sdS(62);return e.Njj(a.openEditOrderModal(n.orderCode,l,"xxl"))}),e.nrm(2,"i",67),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"orderManagement.order.orderEdit"))}function en(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",68),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,a=e.XpG(),l=e.sdS(56);return e.Njj(a.openModal(n.orderCode,l))}),e.nrm(2,"i",69),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"orderManagement.order.cancelOrder"))}function tn(r,o){if(1&r){const t=e.RV6();e.j41(0,"tr",42)(1,"td",43),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),l=e.sdS(62);return e.Njj(a.openModal(n.orderCode,l,"xxl"))}),e.j41(2,"bdi",44),e.EFF(3),e.k0s()(),e.j41(4,"td"),e.EFF(5),e.nI1(6,"date"),e.k0s(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td"),e.EFF(10),e.DNE(11,Ht,1,0,"span",45)(12,zt,2,1,"span",46),e.k0s(),e.j41(13,"td")(14,"span",47),e.EFF(15),e.k0s(),e.nrm(16,"br"),e.j41(17,"span",48),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.copytext(n.mobile))}),e.EFF(18),e.nrm(19,"i",49),e.k0s()(),e.j41(20,"td"),e.DNE(21,Jt,4,1,"ng-container",50),e.k0s(),e.j41(22,"td"),e.DNE(23,qt,4,1,"ng-container",50),e.k0s(),e.j41(24,"td"),e.EFF(25),e.nI1(26,"date"),e.k0s(),e.j41(27,"td"),e.DNE(28,Wt,1,0,"span",51)(29,Qt,2,1,"a",52),e.k0s(),e.j41(30,"td",53)(31,"div",54),e.DNE(32,Kt,3,3,"button",55)(33,Zt,3,3,"button",56)(34,en,3,3,"button",57),e.k0s()()()}if(2&r){const t=o.$implicit,i=e.XpG();e.R7$(3),e.SpI("#SO#",t.orderCode,""),e.R7$(2),e.JRh(e.i5U(6,17,t.createdDate,"yyyy-MM-dd")),e.R7$(3),e.JRh(t.creationUser),e.R7$(2),e.SpI("",t.cityName," "),e.R7$(),e.Y8G("ngIf",null==t.districtName),e.R7$(),e.Y8G("ngIf",null!==t.districtName),e.R7$(3),e.SpI("",t.agentName," "),e.R7$(3),e.SpI("",t.mobile," "),e.R7$(3),e.Y8G("ngForOf",i.getTimes(t.teamNames)),e.R7$(2),e.Y8G("ngForOf",i.getTimes(t.workTimes)),e.R7$(2),e.SpI(" ",e.i5U(26,20,t.visitDate,"yyyy-MM-dd"),""),e.R7$(3),e.Y8G("ngIf",""==t.map),e.R7$(),e.Y8G("ngIf",null==t?null:t.map),e.R7$(),e.Y8G("ngClass",e.eq3(23,$t,t.isFree)),e.R7$(2),e.Y8G("hasPermission",e.lJ4(25,Xt)),e.R7$(),e.Y8G("hasPermission",e.lJ4(26,Ut)),e.R7$(),e.Y8G("hasPermission",e.lJ4(27,Yt))}}function nn(r,o){1&r&&(e.j41(0,"div",70),e.EFF(1," general.table.noData "),e.k0s())}function rn(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",71)(1,"div",72),e.nrm(2,"ngb-pagination-info",73),e.j41(3,"table-length",74),e.bIt("lengthChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",75)(5,"ngb-pagination",76),e.bIt("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.pagination.pageNumber,n)||(a.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function an(r,o){if(1&r){const t=e.RV6();e.j41(0,"cancel-order-model",77),e.bIt("success",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.loadentities())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderId",t.orderSelected)}}function sn(r,o){if(1&r&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s()()),2&r){const t=o.$implicit,i=o.index,n=e.XpG(2);e.R7$(2),e.JRh(t),e.R7$(2),e.JRh(n.orderSelectedData.workTimes[i])}}function on(r,o){if(1&r){const t=e.RV6();e.j41(0,"form",78,6),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.assignOrder())}),e.nrm(2,"ngx-ui-loader",79),e.j41(3,"div",80)(4,"div",81)(5,"button",82),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"div",83)(7,"div",84)(8,"h4",85),e.nrm(9,"i",86),e.EFF(10),e.nI1(11,"translate"),e.k0s(),e.j41(12,"div",87)(13,"div",88)(14,"label",89),e.EFF(15,"orderManagement.order.agentName"),e.k0s(),e.j41(16,"div",90),e.EFF(17),e.k0s()(),e.j41(18,"div",88)(19,"label",89),e.EFF(20,"orderManagement.order.visitDate"),e.k0s(),e.j41(21,"div",90),e.EFF(22),e.nI1(23,"date"),e.k0s()(),e.j41(24,"div",91)(25,"table",92)(26,"thead")(27,"tr")(28,"th",89),e.EFF(29," orderManagement.order.assignTo "),e.k0s(),e.j41(30,"th",89),e.EFF(31," orderManagement.order.workTimes "),e.k0s()()(),e.j41(32,"tbody"),e.DNE(33,sn,5,2,"tr",50),e.k0s()()()(),e.j41(34,"div",93),e.nrm(35,"button",94),e.j41(36,"button",95),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader),e.R7$(8),e.SpI(" ",e.bMT(11,7,"orderManagement.order.AssignMessage")," "),e.R7$(7),e.SpI(" ",t.orderSelectedData.agentName," "),e.R7$(5),e.SpI(" ",e.i5U(23,9,t.orderSelectedData.visitDate,"yyyy-MM-dd")," "),e.R7$(11),e.Y8G("ngForOf",t.orderSelectedData.teamNames)}}function ln(r,o){if(1&r){const t=e.RV6();e.j41(0,"form",78,6),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.SureOrderRollBack())}),e.nrm(2,"ngx-ui-loader",79),e.j41(3,"div",80)(4,"div",81)(5,"button",82),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"div",83)(7,"div",96),e.nrm(8,"lord-icon",97),e.j41(9,"div",98),e.nrm(10,"h3",99)(11,"p",100),e.k0s()(),e.j41(12,"div",101),e.nrm(13,"button",94),e.j41(14,"button",95),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}function dn(r,o){if(1&r&&e.nrm(0,"order-operation",102),2&r){const t=e.XpG();e.Y8G("isOrderEdit",t.isOrderEdit)("isInner",!0)("orderCode",t.orderSelected)}}function cn(r,o){if(1&r){const t=e.RV6();e.j41(0,"order-timeline",103),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderSelected",t.orderSelected)}}let mn=(()=>{class r extends D.w{constructor(t,i,n,a,l,s,I,b,T,S,y,R,M,w,N){super(t,i,I,n,a,l,s),this.baseService=n,this.authDaamService=b,this.excelService=T,this.cityService=S,this.teamService=y,this.workTimeService=R,this.districtService=M,this.channelService=w,this.router=N,this.title="orderManagement.order.urgentOrders.title",this.titleOperation="orderManagement.order.urgentOrders.titleOperation",this.language=localStorage.getItem("language"),this.keySelected="",this.assignUsers=[],this.times=[],this.employees=[],this.searchForm={},this.isResolveList=!0,this.employeeTypes=[{id:1,name:"employeeTeam"},{id:2,name:"managment"},{id:3,name:"customerService"}],this.teams=[],this.workTimes=[],this.OrderStatusEnum=pe,this.employeeGroups=[],this.activeindex="1",this.active=1,this.formPassword={},this.roles=[],this.userTypes=[],this.actives=[{id:!0,name:"active"},{id:!1,name:"noActive"}],this.countLoad=3,this.orderSelected=0,this.orderSelectedData={},this.cities=[],this.districts=[],this.channels=[],this.isOrderEdit=!1,this.GetCities(),this.GetChannels(),this.GetTeams(),this.GetTimes()}GetTeams(){this.teamService.getDropDown().subscribe(t=>{this.teams=t.data},t=>{console.log(t)})}GetTimes(){this.workTimeService.getDropDown().subscribe(t=>{this.workTimes=t.data},t=>{console.log(t)})}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetDistricts(t){this.districtService.getByCityId(t).subscribe(i=>{this.districts=i.data},i=>{console.log(i)})}GetChannels(){this.channelService.getDropDown().subscribe(t=>{this.channels=t.data},t=>{console.log(t)})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,u.Q)(this.notifier)).subscribe(i=>{i?this.alertService.success():this.alertService.error("general.message."+i)},i=>{this.alertService.error()})}mapRegisterForm(t){let i={...t};return i.employeeCode=0,i}onSearch(){var t;if(this.ngxLoader.startLoader(f.a7),null!=(t=this.searchForm.dates)&&"to"in t){const i=[t.from,t.to].map(n=>n);this.pagination.visitDateFrom=this.datePipe.transform(i[0],"yyyy-MM-ddT00:00:00"),this.pagination.visitDateTo=this.datePipe.transform(i[1],"yyyy-MM-ddT23:59:59.999")}else this.pagination.visitDateFrom=null,this.pagination.visitDateTo=null;if(null!=(t=this.searchForm.creationDates)&&"to"in t){const i=[t.from,t.to].map(n=>n);this.pagination.creationDateFrom=this.datePipe.transform(i[0],"yyyy-MM-ddT00:00:00"),this.pagination.creationDateTo=this.datePipe.transform(i[1],"yyyy-MM-ddT23:59:59.999")}else this.pagination.creationDateFrom=null,this.pagination.creationDateTo=null;this.pagination.subject=this.searchForm.name,null!=this.searchForm.status&&(this.pagination.status=Number.parseInt(this.searchForm.status)),null!=this.searchForm.priority&&(this.pagination.priority=Number.parseInt(this.searchForm.priority)),this.loadentities()}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems}}loadentities(){this.countLoad=this.countLoad+1,(!this.isResolveList||1!==this.countLoad)&&(this.pagination.statusFilter=this.OrderStatusEnum.Urgent,this.ngxLoader.startLoader("urgentOrder"),this.baseService.get(this.pagination).pipe((0,u.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader("urgentOrder"),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader("urgentOrder"),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}mapExcel(){let t=[];return this.entities.forEach(i=>{t.push({"Order Code":i.orderCode,"Created Date":i.createdDate,"Creation user":i.creationUser,"City Name":i.cityName,"District Name":i.districtName?i.districtName:"--","Agent Name":i.agentName,Mobile:i.mobile,"Assigned To":i.teamNames,Times:i.workTimes,"Visit Date":i.visitDate,Location:i.map?this.mapUrl(i?.map):this.translateService.instant("orderManagement.order.noMap")})}),t}assignOrder(){this.ngxLoader.startLoader(f.Fq),this.baseService.assignOrder(this.orderSelected).pipe((0,Y.O)(),(0,P.c)(this.mainDelay),(0,H.Z)(),(0,u.Q)(this.notifier),(0,B.j)(()=>this.ngxLoader.stopLoader(f.Fq))).subscribe({next:t=>{this.modalService.dismissAll(),this.loadentities(),this.alertService.success()}})}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}goRegister(){this.router.navigateByUrl("/managment/order/new")}goEdit(t){this.router.navigateByUrl("/managment/order/new")}getStatus(t){return t.isCancel?"bg-warning-subtle text-warning":t.isFinish?"bg-success-subtle text-success":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen||t.isFree?"bg-warning-subtle text-warning":"bg-success-subtle text-success"}getTrnslate(t){return t.isCancel?"orderManagement.order.cancel":t.isFinish?"orderManagement.order.finish":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen?"orderManagement.order.reopen":t.isFree?"orderManagement.order.free":"orderManagement.order.finished"}openModal(t,i,n="md"){this.form={},this.isOrderEdit=!1,this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}oncityChange(t){this.GetDistricts(t.code)}SureOrderRollBack(){this.ngxLoader.startLoader(f.Fq),this.baseService.SureOrderRollBack(this.orderSelected).pipe((0,Y.O)(),(0,P.c)(this.mainDelay),(0,H.Z)(),(0,u.Q)(this.notifier),(0,B.j)(()=>this.ngxLoader.stopLoader(f.Fq))).subscribe({next:t=>{this.modalService.dismissAll(),this.loadentities(),this.alertService.success()}})}getTimes(t){return""==t?[]:t.split(",")}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}mapUrl(t){if(!t)return"";const[i,n]=t.split(",").map(Number);return`https://www.google.com/maps/dir//${i},${n}/@${i},${n},17z?hl=en-US`}openAssignOrderModalModal(t,i,n="md"){this.form={},this.orderSelected=t.orderCode,this.orderSelectedData={},this.orderSelectedData.agentName=t.agentName,this.orderSelectedData.visitDate=t.visitDate,this.orderSelectedData.workTimes=this.getTimes(t.workTimes),this.orderSelectedData.teamNames=this.getTimes(t.teamNames),this.modalService.open(i,{centered:!0,size:n})}openEditOrderModal(t,i,n="md"){this.form={},this.isOrderEdit=!0,this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}openOrderModal(t,i,n="md"){this.form={},this.isOrderEdit=!1,this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}getServices(t){return t.split("#")}OpenOrderTimeLineModel(t,i,n="md"){this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(_.nX),e.rXU(p.c$),e.rXU(k.Q),e.rXU(O.u),e.rXU(d.vh),e.rXU(C.eD),e.rXU(h.Bq),e.rXU(g.J),e.rXU(z.V),e.rXU(Q.h),e.rXU(J.n),e.rXU(le.G),e.rXU(te.m),e.rXU(ne.l),e.rXU(_.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-urgent-orders"]],features:[e.Vt3],decls:65,vars:64,consts:[["tableMaster",""],["deleteModal",""],["SubmitOrderModal",""],["SureOrderRollBackModal",""],["orderModel",""],["OrderTimeLineModel",""],["formEntity","ngForm"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"reset","search","exportXlsx","showAdd","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","search","id","agentName","name","agentName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["InputTirmFilter","","type","search","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","code","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["name","name","bindValue","code","bindLabel","name",3,"change","ngModelChange","placeholder","items","multiple","ngModel"],["name","districtId","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["name","employeeCode","bindValue","name","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["pSortableColumn","orderCode","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["pSortableColumn","createdDate","translate","",2,"width","10%"],["pSortableColumn","creationUser","translate","",2,"width","8%"],["pSortableColumn","cityName","translate","",2,"width","8%"],["pSortableColumn","agentName","translate","",2,"width","8%"],["translate","",2,"width","8%"],["pSortableColumn","visitDate","translate","",2,"width","8%"],["translate","",2,"width","6%"],[2,"width","15%"],[1,"fs-5"],[3,"click"],[1,"code-pointer"],["class","badge bg-danger-subtle text-danger","translate","orderManagement.order.nothing",4,"ngIf"],["class","badge bg-success-subtle text-success",4,"ngIf"],[1,"badge","bg-primary-subtle","text-primary","my-1"],[1,"cursor-pointer","badge","bg-danger-subtle","text-danger","fs-6",3,"click"],[1,"ri-clipboard-line"],[4,"ngFor","ngForOf"],["class","badge bg-danger-subtle text-danger mx-1","translate","orderManagement.order.noMap",4,"ngIf"],["target","_blank","class","badge bg-success-subtle text-success mx-1","translate","orderManagement.order.viewMap",3,"href",4,"ngIf"],[3,"ngClass"],[1,"d-inline"],["class","  btn btn-sm btn-primary edit-list","tooltipPosition","top",3,"pTooltip","click",4,"hasPermission"],["tooltipPosition","top","class","btn btn-sm btn-soft-info edit-list  mx-1",3,"pTooltip","click",4,"hasPermission"],["tooltipPosition","top","class","  btn btn-sm btn-soft-danger remove-list ",3,"pTooltip","click",4,"hasPermission"],["translate","orderManagement.order.nothing",1,"badge","bg-danger-subtle","text-danger"],[1,"badge","bg-success-subtle","text-success"],[1,"badge","bg-primary-subtle","text-primary","mx-1"],["translate","orderManagement.order.noMap",1,"badge","bg-danger-subtle","text-danger","mx-1"],["target","_blank","translate","orderManagement.order.viewMap",1,"badge","bg-success-subtle","text-success","mx-1",3,"href"],[1,"ri-map-pin-line"],["tooltipPosition","top",1,"btn","btn-sm","btn-primary","edit-list",3,"click","pTooltip"],[1,"ri-check-fill","align-bottom"],["tooltipPosition","top",1,"btn","btn-sm","btn-soft-info","edit-list","mx-1",3,"click","pTooltip"],[1,"ri-pencil-fill","align-bottom"],["tooltipPosition","top",1,"btn","btn-sm","btn-soft-danger","remove-list",3,"click","pTooltip"],[1,"ri-delete-bin-5-fill","align-bottom"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"success","dismiss","orderId"],[3,"ngSubmit"],[3,"hasProgressBar","fgsType","loaderId"],[1,"modal-content"],[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mx-4"],[1,"mb-0","mt-2","text-center"],[1,"ri-alert-fill","me-2",2,"font-size","1.3rem"],[1,"mt-5","row"],[1,"col-6"],["translate",""],[1,"form-control"],[1,"col-12","text-center","mt-4"],[1,"table","table-bordered"],[1,"d-flex","gap-2","justify-content-end","mt-4","mb-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],[1,"mt-2","text-center"],["src","https://cdn.lordicon.com/gdfrsvpt.json","stroke","bold","state","hover-oscillate","trigger","loop","colors","primary:#f7b84b,secondary:#f06548",2,"width","130px","height","130px"],[1,"pt-2","fs-15","mx-4","mx-sm-5"],["translate","orderManagement.order.AreYouSureMessage"],[1,"text-muted","mx-4","mb-0"],[1,"d-flex","gap-2","justify-content-center","mt-4","mb-2"],[3,"isOrderEdit","isInner","orderCode"],[3,"dismiss","orderSelected"]],template:function(i,n){if(1&i){const a=e.RV6();e.j41(0,"div",7)(1,"div",8)(2,"div",9),e.nrm(3,"ngx-ui-loader",10),e.j41(4,"base-filter",11),e.bIt("reset",function(){return e.eBV(a),e.Njj(n.onReset())})("search",function(){return e.eBV(a),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(a),e.Njj(n.onExportXlsx())}),e.qex(5,12),e.j41(6,"div",13)(7,"div",14)(8,"input",15),e.nI1(9,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.orderCode,s)||(n.pagination.orderCode=s),e.Njj(s)}),e.k0s(),e.nrm(10,"i",16),e.k0s()(),e.j41(11,"div",13)(12,"div",14)(13,"input",17),e.nI1(14,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.agentName,s)||(n.pagination.agentName=s),e.Njj(s)}),e.k0s(),e.nrm(15,"i",16),e.k0s()(),e.j41(16,"div",13)(17,"div",14)(18,"input",18),e.nI1(19,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.mobile,s)||(n.pagination.mobile=s),e.Njj(s)}),e.k0s(),e.nrm(20,"i",16),e.k0s()(),e.j41(21,"div",13)(22,"div",14)(23,"ng-select",19),e.nI1(24,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.channelCode,s)||(n.pagination.channelCode=s),e.Njj(s)}),e.k0s()()(),e.j41(25,"div",13)(26,"div",14)(27,"ng-select",20),e.nI1(28,"translate"),e.bIt("change",function(s){return e.eBV(a),e.Njj(n.oncityChange(s))}),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.cityCode,s)||(n.pagination.cityCode=s),e.Njj(s)}),e.k0s()()(),e.j41(29,"div",13)(30,"div",14)(31,"ng-select",21),e.nI1(32,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.districtId,s)||(n.pagination.districtId=s),e.Njj(s)}),e.k0s()()(),e.j41(33,"div",13)(34,"div",14)(35,"ng-select",22),e.nI1(36,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.teamName,s)||(n.pagination.teamName=s),e.Njj(s)}),e.k0s()()(),e.j41(37,"div",13)(38,"div",14)(39,"ng-select",22),e.nI1(40,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.workTimes,s)||(n.pagination.workTimes=s),e.Njj(s)}),e.k0s()()(),e.j41(41,"div",13)(42,"input",23),e.nI1(43,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.dates,s)||(n.searchForm.dates=s),e.Njj(s)}),e.k0s()(),e.j41(44,"div",13)(45,"input",23),e.nI1(46,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.creationDates,s)||(n.searchForm.creationDates=s),e.Njj(s)}),e.k0s()(),e.bVm(),e.k0s(),e.j41(47,"div",24)(48,"div",25)(49,"p-table",26,0),e.bIt("onLazyLoad",function(s){return e.eBV(a),e.Njj(n.tableChange(s))})("selectionChange",function(s){return e.eBV(a),e.Njj(n.onSelectionChange(s))}),e.DNE(51,Pt,26,0,"ng-template",27)(52,tn,35,28,"ng-template",28),e.k0s()(),e.DNE(53,nn,2,0,"div",29)(54,rn,6,8,"div",30),e.k0s()()()(),e.DNE(55,an,1,1,"ng-template",null,1,e.C5r)(57,on,37,12,"ng-template",null,2,e.C5r)(59,ln,15,3,"ng-template",null,3,e.C5r)(61,dn,1,3,"ng-template",null,4,e.C5r)(63,cn,1,1,"ng-template",null,5,e.C5r)}2&i&&(e.R7$(3),e.Y8G("loaderId","urgentOrder"),e.R7$(),e.Y8G("showAdd",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(9,44,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.orderCode),e.R7$(5),e.FS9("placeholder",e.bMT(14,46,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.agentName),e.R7$(5),e.FS9("placeholder",e.bMT(19,48,"orderManagement.order.mobile")),e.R50("ngModel",n.pagination.mobile),e.R7$(5),e.FS9("placeholder",e.bMT(24,50,"orderManagement.order.channelName")),e.Y8G("items",n.channels)("multiple",!1),e.R50("ngModel",n.pagination.channelCode),e.R7$(4),e.FS9("placeholder",e.bMT(28,52,"orderManagement.order.cityName")),e.Y8G("items",n.cities)("multiple",!1),e.R50("ngModel",n.pagination.cityCode),e.R7$(4),e.FS9("placeholder",e.bMT(32,54,"orderManagement.order.districtName")),e.Y8G("items",n.districts)("multiple",!1),e.R50("ngModel",n.pagination.districtId),e.R7$(4),e.FS9("placeholder",e.bMT(36,56,"orderManagement.order.teams")),e.Y8G("items",n.teams)("multiple",!1),e.R50("ngModel",n.pagination.teamName),e.R7$(4),e.FS9("placeholder",e.bMT(40,58,"orderManagement.order.workTimes")),e.Y8G("items",n.workTimes)("multiple",!1),e.R50("ngModel",n.pagination.workTimes),e.R7$(3),e.FS9("placeholder",e.bMT(43,60,"orderManagement.order.visitDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.dates),e.R7$(3),e.FS9("placeholder",e.bMT(46,62,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(4),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[d.YU,d.Sq,d.bT,c.qT,c.me,c.Q0,c.BC,c.cb,c.vS,c.cV,h.s5,j.kL,q.b,ge.L,ie.p,re.g,p.Mm,x.XI,K.Ei,x.Tg,C.Cv,U.vr,W.m,v.p,de.m,Se,me,d.vh,p.D9],encapsulation:2})}}return r})();const pn=()=>["confirmed.assignTeam"],gn=()=>["confirmed.undoOrder"],hn=()=>["confirmed.edit"],un=()=>["confirmed.cancel"];function _n(r,o){1&r&&(e.j41(0,"tr",31)(1,"th",32),e.nrm(2,"i",33),e.EFF(3," orderManagement.order.orderCode "),e.k0s(),e.j41(4,"th",34),e.nrm(5,"i",33),e.EFF(6," orderManagement.order.createdDate "),e.k0s(),e.j41(7,"th",35),e.nrm(8,"i",33),e.EFF(9," orderManagement.order.creationUser "),e.k0s(),e.j41(10,"th",36),e.nrm(11,"i",33),e.EFF(12," orderManagement.order.cityName "),e.k0s(),e.j41(13,"th",37),e.nrm(14,"i",33),e.EFF(15," orderManagement.order.agentName "),e.k0s(),e.j41(16,"th",38),e.EFF(17," orderManagement.order.assignTo "),e.k0s(),e.j41(18,"th",38),e.EFF(19," orderManagement.order.workTimes "),e.k0s(),e.j41(20,"th",39),e.nrm(21,"i",33),e.EFF(22," orderManagement.order.visitDate "),e.k0s(),e.j41(23,"th",40),e.EFF(24," orderManagement.order.location "),e.k0s(),e.nrm(25,"th",41),e.k0s())}function fn(r,o){1&r&&e.nrm(0,"span",59)}function bn(r,o){if(1&r&&(e.j41(0,"span",60),e.EFF(1),e.k0s()),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI("",t.districtName," ")}}function vn(r,o){if(1&r&&(e.qex(0),e.j41(1,"span",61),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.bVm()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t)}}function Cn(r,o){if(1&r&&(e.qex(0),e.j41(1,"span",61),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.bVm()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t)}}function xn(r,o){1&r&&e.nrm(0,"span",62)}function In(r,o){if(1&r&&(e.j41(0,"a",63),e.nrm(1,"i",64),e.k0s()),2&r){const t=e.XpG().$implicit,i=e.XpG();e.Y8G("href",i.mapUrl(null==t?null:t.map),e.B4B)}}function Fn(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",65),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,a=e.XpG(),l=e.sdS(58);return e.Njj(a.openAssignOrderModalModal(n,l,"lg"))}),e.nrm(2,"i",66),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"orderManagement.order.assignOrder"))}function Mn(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",67),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,a=e.XpG(),l=e.sdS(60);return e.Njj(a.openModal(n.orderCode,l,"md"))}),e.nrm(2,"i",68),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"orderManagement.order.undoOrder"))}function jn(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",69),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,a=e.XpG(),l=e.sdS(62);return e.Njj(a.openEditOrderModal(n.orderCode,l,"xxl"))}),e.nrm(2,"i",70),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"orderManagement.order.editOrder"))}function Tn(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",71),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,a=e.XpG(),l=e.sdS(56);return e.Njj(a.openModal(n.orderCode,l))}),e.nrm(2,"i",72),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"orderManagement.order.cancelOrder"))}function Sn(r,o){if(1&r){const t=e.RV6();e.j41(0,"tr",42)(1,"td",43),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),l=e.sdS(62);return e.Njj(a.openModal(n.orderCode,l,"xxl"))}),e.j41(2,"bdi",44),e.EFF(3),e.k0s()(),e.j41(4,"td"),e.EFF(5),e.nI1(6,"date"),e.k0s(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td"),e.EFF(10),e.DNE(11,fn,1,0,"span",45)(12,bn,2,1,"span",46),e.k0s(),e.j41(13,"td")(14,"span",47),e.EFF(15),e.k0s(),e.nrm(16,"br"),e.j41(17,"span",48),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.copytext(n.mobile))}),e.EFF(18),e.nrm(19,"i",49),e.k0s()(),e.j41(20,"td"),e.DNE(21,vn,4,1,"ng-container",50),e.k0s(),e.j41(22,"td"),e.DNE(23,Cn,4,1,"ng-container",50),e.k0s(),e.j41(24,"td"),e.EFF(25),e.nI1(26,"date"),e.k0s(),e.j41(27,"td"),e.DNE(28,xn,1,0,"span",51)(29,In,2,1,"a",52),e.k0s(),e.j41(30,"td")(31,"div",53)(32,"i",54),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),l=e.sdS(64);return e.Njj(a.OpenOrderTimeLineModel(n,l,"lg"))}),e.k0s(),e.DNE(33,Fn,3,3,"button",55)(34,Mn,3,3,"button",56)(35,jn,3,3,"button",57)(36,Tn,3,3,"button",58),e.k0s()()()}if(2&r){const t=o.$implicit,i=e.XpG();e.R7$(3),e.SpI("#SO#",t.orderCode,""),e.R7$(2),e.JRh(e.i5U(6,17,t.createdDate,"yyyy-MM-dd")),e.R7$(3),e.JRh(t.creationUser),e.R7$(2),e.SpI("",t.cityName," "),e.R7$(),e.Y8G("ngIf",null==t.districtName),e.R7$(),e.Y8G("ngIf",null!==t.districtName),e.R7$(3),e.SpI("",t.agentName," "),e.R7$(3),e.SpI("",t.mobile," "),e.R7$(3),e.Y8G("ngForOf",i.getTimes(t.teamNames)),e.R7$(2),e.Y8G("ngForOf",i.getTimes(t.workTimes)),e.R7$(2),e.SpI(" ",e.i5U(26,20,t.visitDate,"yyyy-MM-dd"),""),e.R7$(3),e.Y8G("ngIf",""==t.map),e.R7$(),e.Y8G("ngIf",null==t?null:t.map),e.R7$(4),e.Y8G("hasPermission",e.lJ4(23,pn)),e.R7$(),e.Y8G("hasPermission",e.lJ4(24,gn)),e.R7$(),e.Y8G("hasPermission",e.lJ4(25,hn)),e.R7$(),e.Y8G("hasPermission",e.lJ4(26,un))}}function kn(r,o){1&r&&(e.j41(0,"div",73),e.EFF(1," general.table.noData "),e.k0s())}function yn(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",74)(1,"div",75),e.nrm(2,"ngb-pagination-info",76),e.j41(3,"table-length",77),e.bIt("lengthChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",78)(5,"ngb-pagination",79),e.bIt("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.pagination.pageNumber,n)||(a.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function Rn(r,o){if(1&r){const t=e.RV6();e.j41(0,"cancel-order-model",80),e.bIt("success",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.loadentities())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderId",t.orderSelected)}}function En(r,o){if(1&r&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s()()),2&r){const t=o.$implicit,i=o.index,n=e.XpG(2);e.R7$(2),e.JRh(t),e.R7$(2),e.JRh(n.orderSelectedData.workTimes[i])}}function wn(r,o){if(1&r){const t=e.RV6();e.j41(0,"form",81,6),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.AssignOrder())}),e.nrm(2,"ngx-ui-loader",82),e.j41(3,"div",83)(4,"div",84)(5,"button",85),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"div",86)(7,"div",87)(8,"h4",88),e.nrm(9,"i",89),e.EFF(10),e.nI1(11,"translate"),e.k0s(),e.j41(12,"div",90)(13,"div",91)(14,"label",92),e.EFF(15,"orderManagement.order.agentName"),e.k0s(),e.j41(16,"div",93),e.EFF(17),e.k0s()(),e.j41(18,"div",91)(19,"label",92),e.EFF(20,"orderManagement.order.visitDate"),e.k0s(),e.j41(21,"div",93),e.EFF(22),e.nI1(23,"date"),e.k0s()(),e.j41(24,"div",94)(25,"table",95)(26,"thead")(27,"tr")(28,"th",92),e.EFF(29," orderManagement.order.assignTo "),e.k0s(),e.j41(30,"th",92),e.EFF(31," orderManagement.order.workTimes "),e.k0s()()(),e.j41(32,"tbody"),e.DNE(33,En,5,2,"tr",50),e.k0s()()()(),e.j41(34,"div",96),e.nrm(35,"button",97),e.j41(36,"button",98),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader),e.R7$(8),e.SpI(" ",e.bMT(11,7,"orderManagement.order.AssignMessage")," "),e.R7$(7),e.SpI(" ",t.orderSelectedData.agentName," "),e.R7$(5),e.SpI(" ",e.i5U(23,9,t.orderSelectedData.visitDate,"yyyy-MM-dd")," "),e.R7$(11),e.Y8G("ngForOf",t.orderSelectedData.teamNames)}}function Nn(r,o){if(1&r){const t=e.RV6();e.j41(0,"form",81,6),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.SureOrderRollBack())}),e.nrm(2,"ngx-ui-loader",82),e.j41(3,"div",83)(4,"div",84)(5,"button",85),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"div",86)(7,"div",99),e.nrm(8,"lord-icon",100),e.j41(9,"div",101),e.nrm(10,"h3",102)(11,"p",103),e.k0s()(),e.j41(12,"div",104),e.nrm(13,"button",97),e.j41(14,"button",98),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}function Dn(r,o){if(1&r&&e.nrm(0,"order-operation",105),2&r){const t=e.XpG();e.Y8G("isOrderEdit",t.isOrderEdit)("isInner",!0)("orderCode",t.orderSelected)}}function On(r,o){if(1&r){const t=e.RV6();e.j41(0,"order-timeline",106),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderSelected",t.orderSelected)}}let Vn=(()=>{class r extends D.w{constructor(t,i,n,a,l,s,I,b,T,S,y,R,M,w,N){super(t,i,I,n,a,l,s),this.baseService=n,this.authDaamService=b,this.excelService=T,this.cityService=S,this.teamService=y,this.workTimeService=R,this.districtService=M,this.channelService=w,this.router=N,this.title="orderManagement.order.sureOrders.title",this.titleOperation="orderManagement.order.sureOrders.titleOperation",this.language=localStorage.getItem("language"),this.keySelected="",this.assignUsers=[],this.times=[],this.employees=[],this.searchForm={},this.OrderStatusEnum=pe,this.isResolveList=!0,this.employeeTypes=[{id:1,name:"employeeTeam"},{id:2,name:"managment"},{id:3,name:"customerService"}],this.status=[{name:"None",nameAr:"\u0644\u0627 \u0634\u0626",id:0},{name:"Is Review",nameAr:"\u062a\u0645\u062a \u0627\u0644\u0645\u0631\u0627\u062c\u0639\u0629",id:1},{name:"Is Confirmed",nameAr:"\u062a\u0645 \u0627\u0644\u062a\u0623\u0643\u064a\u062f",id:2},{name:"Is Free",nameAr:"\u0645\u062c\u0627\u0646\u064a",id:3},{name:"Is Reopen",nameAr:"\u062a\u0645\u062a \u0625\u0639\u0627\u062f\u0629 \u0641\u062a\u062d\u0647",id:4},{name:"Is Finish",nameAr:"\u0627\u0646\u062a\u0647\u0649",id:5},{name:"Is Cancel",nameAr:"\u062a\u0645 \u0627\u0644\u0625\u0644\u063a\u0627\u0621",id:6},{name:"Is Assign",nameAr:"\u062a\u0645 \u062a\u0639\u064a\u064a\u0646\u0647",id:7},{name:"Is Urgent",nameAr:"\u0639\u0627\u062c\u0644",id:8},{name:"New",nameAr:"\u062c\u062f\u064a\u062f",id:9}],this.teams=[],this.workTimes=[],this.employeeGroups=[],this.activeindex="1",this.active=1,this.formPassword={},this.orderSelectedData={},this.roles=[],this.userTypes=[],this.actives=[{id:!0,name:"active"},{id:!1,name:"noActive"}],this.countLoad=2,this.orderSelected=0,this.cities=[],this.districts=[],this.channels=[],this.isOrderEdit=!1,this.setDates=(F,E,$)=>{if(F?.from||F?.to){const G=F.to||F.from;this.pagination[E]=this.datePipe.transform(F.from||F.to,"yyyy-MM-ddT00:00:00"),this.pagination[$]=this.datePipe.transform(G,"yyyy-MM-ddT23:59:59.999")}else this.pagination[E]=null,this.pagination[$]=null},this.GetCities(),this.GetChannels(),this.GetTeams(),this.GetTimes()}GetTeams(){this.teamService.getDropDown().subscribe(t=>{this.teams=t.data},t=>{console.log(t)})}GetTimes(){this.workTimeService.getDropDown().subscribe(t=>{this.workTimes=t.data},t=>{console.log(t)})}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetDistricts(t){this.districtService.getByCityId(t).subscribe(i=>{this.districts=i.data},i=>{console.log(i)})}GetChannels(){this.channelService.getDropDown().subscribe(t=>{this.channels=t.data},t=>{console.log(t)})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,u.Q)(this.notifier)).subscribe(i=>{i?this.alertService.success():this.alertService.error("general.message."+i)},i=>{this.alertService.error()})}mapRegisterForm(t){let i={...t};return i.employeeCode=0,i}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader(f.a7),this.setDates(t.dates,"visitDateFrom","visitDateTo"),this.setDates(t.creationDates,"creationDateFrom","creationDateTo"),this.loadentities()}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems}}loadentities(){this.countLoad=this.countLoad+1,(!this.isResolveList||1!==this.countLoad)&&(this.pagination.statusFilter=this.OrderStatusEnum.Confirmed,this.ngxLoader.startLoader("sureOrder"),this.baseService.get(this.pagination).pipe((0,u.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader("sureOrder"),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader("sureOrder"),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}mapExcel(){let t=[];return this.entities.forEach(i=>{t.push({"Order Code":i.orderCode,"Created Date":i.createdDate,"Creation user":i.creationUser,"City Name":i.cityName,"District Name":i.districtName?i.districtName:"--","Agent Name":i.agentName,Mobile:i.mobile,"Assigned To":i.teamNames,Times:i.workTimes,"Visit Date":i.visitDate,Location:i.map?this.mapUrl(i?.map):this.translateService.instant("orderManagement.order.noMap")})}),t}AssignOrder(){this.ngxLoader.startLoader(f.Fq),this.baseService.assignOrder(this.orderSelected).pipe((0,Y.O)(),(0,P.c)(this.mainDelay),(0,H.Z)(),(0,u.Q)(this.notifier),(0,B.j)(()=>this.ngxLoader.stopLoader(f.Fq))).subscribe({next:t=>{this.modalService.dismissAll(),this.loadentities(),this.alertService.success()}})}SureOrderRollBack(){this.ngxLoader.startLoader(f.Fq),this.baseService.SureOrderRollBack(this.orderSelected).pipe((0,Y.O)(),(0,P.c)(this.mainDelay),(0,H.Z)(),(0,u.Q)(this.notifier),(0,B.j)(()=>this.ngxLoader.stopLoader(f.Fq))).subscribe({next:t=>{this.modalService.dismissAll(),this.loadentities(),this.alertService.success()}})}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}goRegister(){this.router.navigateByUrl("/managment/order/new")}goEdit(t){this.router.navigateByUrl("/managment/order/new")}getStatus(t){return t.isCancel?"bg-warning-subtle text-warning":t.isFinish?"bg-success-subtle text-success":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen||t.isFree?"bg-warning-subtle text-warning":"bg-success-subtle text-success"}getTrnslate(t){return t.isCancel?"orderManagement.order.cancel":t.isFinish?"orderManagement.order.finish":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen?"orderManagement.order.reopen":t.isFree?"orderManagement.order.free":"orderManagement.order.finished"}openModal(t,i,n="md"){this.form={},this.isOrderEdit=!1,this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}getTimes(t){return t.split(",")}oncityChange(t){this.GetDistricts(t.code)}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}mapUrl(t){if(!t)return"";const[i,n]=t.split(",").map(Number);return`https://www.google.com/maps/dir//${i},${n}/@${i},${n},17z?hl=en-US`}openAssignOrderModalModal(t,i,n="md"){this.form={},this.orderSelected=t.orderCode,this.orderSelectedData={},this.orderSelectedData.agentName=t.agentName,this.orderSelectedData.visitDate=t.visitDate,this.orderSelectedData.workTimes=this.getTimes(t.workTimes),this.orderSelectedData.teamNames=this.getTimes(t.teamNames),this.modalService.open(i,{centered:!0,size:n})}openEditOrderModal(t,i,n="md"){this.form={},this.isOrderEdit=!0,this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}getServices(t){return t.split("#")}OpenOrderTimeLineModel(t,i,n="md"){this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(_.nX),e.rXU(p.c$),e.rXU(k.Q),e.rXU(O.u),e.rXU(d.vh),e.rXU(C.eD),e.rXU(h.Bq),e.rXU(g.J),e.rXU(z.V),e.rXU(Q.h),e.rXU(J.n),e.rXU(le.G),e.rXU(te.m),e.rXU(ne.l),e.rXU(_.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-sure-orders"]],features:[e.Vt3],decls:65,vars:64,consts:[["tableMaster",""],["deleteModal",""],["AssignOrderModal",""],["SureOrderRollBackModal",""],["orderModel",""],["OrderTimeLineModel",""],["formEntity","ngForm"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"reset","search","exportXlsx","showAdd","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","search","id","agentName","name","agentName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["InputTirmFilter","","type","search","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","code","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["name","name","bindValue","code","bindLabel","name",3,"change","ngModelChange","placeholder","items","multiple","ngModel"],["name","districtId","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["name","employeeCode","bindValue","name","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["pSortableColumn","orderCode","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["pSortableColumn","createdDate","translate","",2,"width","10%"],["pSortableColumn","creationUser","translate","",2,"width","8%"],["pSortableColumn","cityName","translate","",2,"width","8%"],["pSortableColumn","agentName","translate","",2,"width","8%"],["translate","",2,"width","8%"],["pSortableColumn","visitDate","translate","",2,"width","8%"],["translate","",2,"width","6%"],[2,"width","15%"],[1,"fs-5"],[3,"click"],[1,"code-pointer"],["class","badge bg-danger-subtle text-danger","translate","orderManagement.order.nothing",4,"ngIf"],["class","badge bg-success-subtle text-success",4,"ngIf"],[1,"badge","bg-primary-subtle","text-primary","my-1"],[1,"cursor-pointer","badge","bg-danger-subtle","text-danger","fs-6",3,"click"],[1,"ri-clipboard-line"],[4,"ngFor","ngForOf"],["class","badge bg-danger-subtle text-danger mx-1","translate","orderManagement.order.noMap",4,"ngIf"],["target","_blank","class","badge bg-success-subtle text-success mx-1","translate","orderManagement.order.viewMap",3,"href",4,"ngIf"],[1,"d-inline"],[1,"ri-history-fill","d-inline","text-primary","fs-16","align-middle","me-1",3,"click"],["tooltipPosition","top","class","mt-2  btn btn-sm btn-primary edit-list",3,"pTooltip","click",4,"hasPermission"],["class","mt-2 btn btn-sm mx-1 btn-warning edit-list","tooltipPosition","top",3,"pTooltip","click",4,"hasPermission"],["tooltipPosition","top","class","mt-2 btn btn-sm btn-soft-info edit-list  ",3,"pTooltip","click",4,"hasPermission"],["tooltipPosition","top","class","mt-2 btn btn-sm btn-soft-danger remove-list  mx-1",3,"pTooltip","click",4,"hasPermission"],["translate","orderManagement.order.nothing",1,"badge","bg-danger-subtle","text-danger"],[1,"badge","bg-success-subtle","text-success"],[1,"badge","bg-primary-subtle","text-primary","mx-1"],["translate","orderManagement.order.noMap",1,"badge","bg-danger-subtle","text-danger","mx-1"],["target","_blank","translate","orderManagement.order.viewMap",1,"badge","bg-success-subtle","text-success","mx-1",3,"href"],[1,"ri-map-pin-line"],["tooltipPosition","top",1,"mt-2","btn","btn-sm","btn-primary","edit-list",3,"click","pTooltip"],[1,"ri-check-fill","align-bottom"],["tooltipPosition","top",1,"mt-2","btn","btn-sm","mx-1","btn-warning","edit-list",3,"click","pTooltip"],[1,"ri-arrow-go-back-fill","align-bottom"],["tooltipPosition","top",1,"mt-2","btn","btn-sm","btn-soft-info","edit-list",3,"click","pTooltip"],[1,"ri-pencil-fill","align-bottom"],["tooltipPosition","top",1,"mt-2","btn","btn-sm","btn-soft-danger","remove-list","mx-1",3,"click","pTooltip"],[1,"ri-delete-bin-5-fill","align-bottom"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"success","dismiss","orderId"],[3,"ngSubmit"],[3,"hasProgressBar","fgsType","loaderId"],[1,"modal-content"],[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mx-4"],[1,"mb-0","mt-2","text-center"],[1,"ri-alert-fill","text-info","me-2",2,"font-size","1.3rem"],[1,"mt-5","row"],[1,"col-6"],["translate",""],[1,"form-control"],[1,"col-12","text-center","mt-4"],[1,"table","table-bordered"],[1,"d-flex","gap-2","justify-content-end","mt-4","mb-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],[1,"mt-2","text-center"],["src","https://cdn.lordicon.com/gdfrsvpt.json","stroke","bold","state","hover-oscillate","trigger","loop","colors","primary:#f7b84b,secondary:#f06548",2,"width","130px","height","130px"],[1,"pt-2","fs-15","mx-4","mx-sm-5"],["translate","orderManagement.order.AreYouSureMessage"],[1,"text-muted","mx-4","mb-0"],[1,"d-flex","gap-2","justify-content-center","mt-4","mb-2"],[3,"isOrderEdit","isInner","orderCode"],[3,"dismiss","orderSelected"]],template:function(i,n){if(1&i){const a=e.RV6();e.j41(0,"div",7)(1,"div",8)(2,"div",9),e.nrm(3,"ngx-ui-loader",10),e.j41(4,"base-filter",11),e.bIt("reset",function(){return e.eBV(a),e.Njj(n.onReset())})("search",function(){return e.eBV(a),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(a),e.Njj(n.onExportXlsx())}),e.qex(5,12),e.j41(6,"div",13)(7,"div",14)(8,"input",15),e.nI1(9,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.orderCode,s)||(n.pagination.orderCode=s),e.Njj(s)}),e.k0s(),e.nrm(10,"i",16),e.k0s()(),e.j41(11,"div",13)(12,"div",14)(13,"input",17),e.nI1(14,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.agentName,s)||(n.pagination.agentName=s),e.Njj(s)}),e.k0s(),e.nrm(15,"i",16),e.k0s()(),e.j41(16,"div",13)(17,"div",14)(18,"input",18),e.nI1(19,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.mobile,s)||(n.pagination.mobile=s),e.Njj(s)}),e.k0s(),e.nrm(20,"i",16),e.k0s()(),e.j41(21,"div",13)(22,"div",14)(23,"ng-select",19),e.nI1(24,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.channelCode,s)||(n.pagination.channelCode=s),e.Njj(s)}),e.k0s()()(),e.j41(25,"div",13)(26,"div",14)(27,"ng-select",20),e.nI1(28,"translate"),e.bIt("change",function(s){return e.eBV(a),e.Njj(n.oncityChange(s))}),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.cityCode,s)||(n.pagination.cityCode=s),e.Njj(s)}),e.k0s()()(),e.j41(29,"div",13)(30,"div",14)(31,"ng-select",21),e.nI1(32,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.districtId,s)||(n.pagination.districtId=s),e.Njj(s)}),e.k0s()()(),e.j41(33,"div",13)(34,"div",14)(35,"ng-select",22),e.nI1(36,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.teamName,s)||(n.pagination.teamName=s),e.Njj(s)}),e.k0s()()(),e.j41(37,"div",13)(38,"div",14)(39,"ng-select",22),e.nI1(40,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.workTimes,s)||(n.pagination.workTimes=s),e.Njj(s)}),e.k0s()()(),e.j41(41,"div",13)(42,"input",23),e.nI1(43,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.dates,s)||(n.searchForm.dates=s),e.Njj(s)}),e.k0s()(),e.j41(44,"div",13)(45,"input",23),e.nI1(46,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.creationDates,s)||(n.searchForm.creationDates=s),e.Njj(s)}),e.k0s()(),e.bVm(),e.k0s(),e.j41(47,"div",24)(48,"div",25)(49,"p-table",26,0),e.bIt("onLazyLoad",function(s){return e.eBV(a),e.Njj(n.tableChange(s))})("selectionChange",function(s){return e.eBV(a),e.Njj(n.onSelectionChange(s))}),e.DNE(51,_n,26,0,"ng-template",27)(52,Sn,37,27,"ng-template",28),e.k0s()(),e.DNE(53,kn,2,0,"div",29)(54,yn,6,8,"div",30),e.k0s()()()(),e.DNE(55,Rn,1,1,"ng-template",null,1,e.C5r)(57,wn,37,12,"ng-template",null,2,e.C5r)(59,Nn,15,3,"ng-template",null,3,e.C5r)(61,Dn,1,3,"ng-template",null,4,e.C5r)(63,On,1,1,"ng-template",null,5,e.C5r)}2&i&&(e.R7$(3),e.Y8G("loaderId","sureOrder"),e.R7$(),e.Y8G("showAdd",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(9,44,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.orderCode),e.R7$(5),e.FS9("placeholder",e.bMT(14,46,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.agentName),e.R7$(5),e.FS9("placeholder",e.bMT(19,48,"orderManagement.order.mobile")),e.R50("ngModel",n.pagination.mobile),e.R7$(5),e.FS9("placeholder",e.bMT(24,50,"orderManagement.order.channelName")),e.Y8G("items",n.channels)("multiple",!1),e.R50("ngModel",n.pagination.channelCode),e.R7$(4),e.FS9("placeholder",e.bMT(28,52,"orderManagement.order.cityName")),e.Y8G("items",n.cities)("multiple",!1),e.R50("ngModel",n.pagination.cityCode),e.R7$(4),e.FS9("placeholder",e.bMT(32,54,"orderManagement.order.districtName")),e.Y8G("items",n.districts)("multiple",!1),e.R50("ngModel",n.pagination.districtId),e.R7$(4),e.FS9("placeholder",e.bMT(36,56,"orderManagement.order.teams")),e.Y8G("items",n.teams)("multiple",!1),e.R50("ngModel",n.pagination.teamName),e.R7$(4),e.FS9("placeholder",e.bMT(40,58,"orderManagement.order.workTimes")),e.Y8G("items",n.workTimes)("multiple",!1),e.R50("ngModel",n.pagination.workTimes),e.R7$(3),e.FS9("placeholder",e.bMT(43,60,"orderManagement.order.visitDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.dates),e.R7$(3),e.FS9("placeholder",e.bMT(46,62,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(4),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[d.Sq,d.bT,c.qT,c.me,c.Q0,c.BC,c.cb,c.vS,c.cV,h.s5,j.kL,q.b,ge.L,ie.p,re.g,p.Mm,x.XI,K.Ei,x.Tg,C.Cv,U.vr,W.m,v.p,de.m,Se,me,d.vh,p.D9],encapsulation:2})}}return r})();var ce=m(45312),Ie=m(63022),ye=m(96402),Fe=m(99902);const Gn=["FileInput"],An=()=>["assigned.changeStatus"],Ln=()=>["assigned.undoAssign"],Bn=()=>["assigned.finishedOrder"];function $n(r,o){1&r&&(e.j41(0,"tr",40)(1,"th",41),e.nrm(2,"i",42),e.EFF(3," orderManagement.order.orderCode "),e.k0s(),e.j41(4,"th",43),e.nrm(5,"i",42),e.EFF(6," orderManagement.order.cityName "),e.k0s(),e.j41(7,"th",44),e.nrm(8,"i",42),e.EFF(9," orderManagement.order.creationUser "),e.k0s(),e.j41(10,"th",45),e.nrm(11,"i",42),e.EFF(12," orderManagement.order.agentName "),e.k0s(),e.j41(13,"th",46),e.EFF(14," orderManagement.order.assignTo "),e.k0s(),e.j41(15,"th",47),e.EFF(16," orderManagement.order.workTimes "),e.k0s(),e.j41(17,"th",48),e.nrm(18,"i",42),e.EFF(19," orderManagement.order.visitDate "),e.k0s(),e.j41(20,"th",49),e.EFF(21," orderManagement.order.services "),e.k0s(),e.j41(22,"th",50),e.nrm(23,"i",42),e.EFF(24," orderManagement.order.teamStatus "),e.k0s(),e.nrm(25,"th",51),e.k0s())}function Xn(r,o){1&r&&e.nrm(0,"span",71)}function Un(r,o){if(1&r&&(e.j41(0,"span",72),e.EFF(1),e.k0s()),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI("",t.districtName," ")}}function Yn(r,o){if(1&r&&(e.qex(0),e.j41(1,"span",73),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.bVm()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t)}}function Pn(r,o){if(1&r&&(e.qex(0),e.j41(1,"span",73),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.bVm()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t)}}function Hn(r,o){if(1&r&&(e.qex(0),e.j41(1,"span",73),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.bVm()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t)}}function zn(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",74),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,a=e.XpG(),l=e.sdS(61);return e.Njj(a.openChangeStatusModal(n,l))}),e.nrm(1,"i",75)(2,"span",76),e.k0s()}}function Jn(r,o){if(1&r){const t=e.RV6();e.j41(0,"li")(1,"a",77),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,a=e.XpG(),l=e.sdS(69);return e.Njj(a.OpenOrderTimeLineModel(n.orderCode,l,"md"))}),e.nrm(2,"i",78)(3,"span",79),e.k0s()()}}function qn(r,o){if(1&r){const t=e.RV6();e.j41(0,"li",53),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,a=e.XpG(),l=e.sdS(63);return a.GetOrderServiceAndPayment(n),e.Njj(a.openChangeStatusModal(n,l,"xl"))}),e.j41(1,"a",80),e.nrm(2,"i",81)(3,"span",82),e.k0s()()}}function Wn(r,o){if(1&r){const t=e.RV6();e.j41(0,"tr",52)(1,"td",53),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),l=e.sdS(65);return e.Njj(a.openModal(n.orderCode,l,"xxl"))}),e.j41(2,"bdi",54),e.EFF(3),e.k0s()(),e.j41(4,"td"),e.EFF(5),e.DNE(6,Xn,1,0,"span",55)(7,Un,2,1,"span",56),e.k0s(),e.j41(8,"td")(9,"span",57),e.EFF(10),e.k0s()(),e.j41(11,"td")(12,"span",57),e.EFF(13),e.k0s(),e.nrm(14,"br"),e.j41(15,"span",58),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.copytext(n.mobile))}),e.EFF(16),e.nrm(17,"i",59),e.k0s()(),e.j41(18,"td"),e.DNE(19,Yn,4,1,"ng-container",60),e.k0s(),e.j41(20,"td"),e.DNE(21,Pn,4,1,"ng-container",60),e.k0s(),e.j41(22,"td"),e.EFF(23),e.nI1(24,"date"),e.k0s(),e.j41(25,"td"),e.DNE(26,Hn,4,1,"ng-container",60),e.k0s(),e.j41(27,"td")(28,"span"),e.nrm(29,"i",61),e.EFF(30),e.nI1(31,"translate"),e.k0s()(),e.j41(32,"td")(33,"i",62),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),l=e.sdS(67);return e.Njj(a.OpenOrderTimeLineModel(n,l,"lg"))}),e.k0s(),e.DNE(34,zn,3,0,"button",63),e.j41(35,"div",64)(36,"div",65)(37,"button",66),e.nI1(38,"translate"),e.nrm(39,"i",67),e.k0s(),e.j41(40,"ul",68),e.DNE(41,Jn,4,0,"li",69)(42,qn,4,0,"li",70),e.k0s()()()()()}if(2&r){const t=o.$implicit,i=e.XpG();e.R7$(3),e.SpI("#SO#",t.orderCode,""),e.R7$(2),e.SpI(" ",t.cityName," "),e.R7$(),e.Y8G("ngIf",null==t.districtName),e.R7$(),e.Y8G("ngIf",null!==t.districtName),e.R7$(3),e.SpI("",t.creationUser," "),e.R7$(3),e.SpI("",t.agentName," "),e.R7$(3),e.SpI("",t.mobile," "),e.R7$(3),e.Y8G("ngForOf",i.getTimes(t.teamNames)),e.R7$(2),e.Y8G("ngForOf",i.getTimes(t.workTimes)),e.R7$(2),e.JRh(e.i5U(24,19,t.visitDate,"yyyy-MM-dd")),e.R7$(3),e.Y8G("ngForOf",i.getServices(t.services)),e.R7$(2),e.ZvI("  badge ",i.getTeamStatus(t.teamStatus)," "),e.R7$(2),e.SpI(" ",e.bMT(31,22,"orderManagement.order."+t.teamStatusName),""),e.R7$(4),e.Y8G("hasPermission",e.lJ4(26,An)),e.R7$(3),e.FS9("pTooltip",e.bMT(38,24,"general.actions")),e.R7$(4),e.Y8G("hasPermission",e.lJ4(27,Ln)),e.R7$(),e.Y8G("hasPermission",e.lJ4(28,Bn))}}function Qn(r,o){1&r&&(e.j41(0,"div",83),e.EFF(1," general.table.noData "),e.k0s())}function Kn(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",84)(1,"div",85),e.nrm(2,"ngb-pagination-info",86),e.j41(3,"table-length",87),e.bIt("lengthChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",88)(5,"ngb-pagination",89),e.bIt("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.pagination.pageNumber,n)||(a.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function Zn(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",98)(1,"label",107),e.EFF(2,"orderManagement.order.cancelReasonName"),e.k0s(),e.j41(3,"ng-select",108),e.nI1(4,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG(2);return e.DH7(a.form.cancelReasonCode,n)||(a.form.cancelReasonCode=n),e.Njj(n)}),e.k0s()()}if(2&r){const t=e.XpG(2);e.R7$(3),e.FS9("placeholder",e.bMT(4,4,"orderManagement.order.cancelReasonName")),e.Y8G("items",t.cancelReasons)("multiple",!1),e.R50("ngModel",t.form.cancelReasonCode)}}function ei(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",90)(1,"div",91)(2,"h4",92),e.nrm(3,"span",93),e.k0s(),e.j41(4,"button",94),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(5,"div",95),e.nrm(6,"ngx-ui-loader",96),e.j41(7,"form",97,6),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.changeStatus())}),e.j41(9,"div",15)(10,"div",98)(11,"label",99),e.EFF(12,"orderManagement.order.changeTeamStatus"),e.k0s(),e.j41(13,"ng-select",100),e.nI1(14,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.form.teamStatus,n)||(a.form.teamStatus=n),e.Njj(n)}),e.k0s()(),e.DNE(15,Zn,5,6,"div",101),e.j41(16,"div",98)(17,"label",99),e.EFF(18,"orderManagement.order.teamStatusNotes"),e.k0s(),e.j41(19,"textarea",102),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.form.teamStatusNotes,n)||(a.form.teamStatusNotes=n),e.Njj(n)}),e.k0s()()(),e.j41(20,"div",103)(21,"button",104),e.nrm(22,"i",105)(23,"span",106),e.k0s()()()()()}if(2&r){const t=e.sdS(8),i=e.XpG();e.R7$(6),e.Y8G("hasProgressBar",!1)("fgsType",i.loaderOperationShap)("loaderId",i.operationLoader),e.R7$(7),e.FS9("placeholder",e.bMT(14,10,"orderManagement.order.changeTeamStatus")),e.Y8G("items",i.statusList)("multiple",!1),e.R50("ngModel",i.form.teamStatus),e.R7$(2),e.Y8G("ngIf",3==i.form.teamStatus),e.R7$(4),e.R50("ngModel",i.form.teamStatusNotes),e.R7$(2),e.Y8G("disabled",!t.valid)}}function ti(r,o){if(1&r){const t=e.RV6();e.j41(0,"span",155)(1,"input",156),e.nI1(2,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG().$implicit;return e.DH7(a.price,n)||(a.price=n),e.Njj(n)}),e.k0s(),e.j41(3,"button",157),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,a=e.XpG(2);return n.isEdit=!n.isEdit,e.Njj(a.calculatePrices())}),e.nrm(4,"i",158),e.k0s()()}if(2&r){const t=e.XpG(),i=t.$implicit,n=t.index;e.R7$(),e.Mz_("name","editPrice",n,""),e.FS9("placeholder",e.bMT(2,6,"orderManagement.order.notes")),e.Mz_("id","editPrice",n,""),e.R50("ngModel",i.price)}}function ni(r,o){if(1&r&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",t.quantity," ")}}function ii(r,o){if(1&r){const t=e.RV6();e.j41(0,"span",155)(1,"input",156),e.nI1(2,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG().$implicit;return e.DH7(a.quantity,n)||(a.quantity=n),e.Njj(n)}),e.k0s(),e.j41(3,"button",157),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,a=e.XpG(2);return n.isEdit=!n.isEdit,e.Njj(a.calculatePrices())}),e.nrm(4,"i",158),e.k0s()()}if(2&r){const t=e.XpG(),i=t.$implicit,n=t.index;e.R7$(),e.Mz_("name","editQuantity",n,""),e.FS9("placeholder",e.bMT(2,6,"orderManagement.order.quantity")),e.Mz_("id","editPrice",n,""),e.R50("ngModel",i.quantity)}}function ri(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",159),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit;return e.Njj(n.isEdit=!n.isEdit)}),e.nrm(1,"i",158),e.k0s()}}function ai(r,o){if(1&r){const t=e.RV6();e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td")(4,"span"),e.EFF(5),e.k0s(),e.DNE(6,ti,5,8,"span",151),e.k0s(),e.j41(7,"td"),e.DNE(8,ni,2,1,"span",126)(9,ii,5,8,"span",151),e.k0s(),e.j41(10,"td"),e.EFF(11),e.k0s(),e.j41(12,"td")(13,"button",152),e.bIt("click",function(){const n=e.eBV(t).index,a=e.XpG(2);return e.Njj(a.deleteService(n))}),e.nrm(14,"i",153),e.k0s(),e.DNE(15,ri,2,0,"button",154),e.k0s()()}if(2&r){const t=o.$implicit;e.R7$(2),e.JRh(t.service),e.R7$(3),e.SpI(" ",t.price," "),e.R7$(),e.Y8G("ngIf",!1),e.R7$(2),e.Y8G("ngIf",!t.isEdit),e.R7$(),e.Y8G("ngIf",t.isEdit),e.R7$(2),e.JRh(t.notes),e.R7$(4),e.Y8G("ngIf",!t.isEdit)}}function si(r,o){1&r&&(e.j41(0,"tr")(1,"td",160),e.EFF(2),e.nI1(3,"translate"),e.k0s()()),2&r&&(e.R7$(2),e.JRh(e.bMT(3,1,"orderManagement.order.noData")))}function oi(r,o){if(1&r&&(e.j41(0,"div",128)(1,"div",161)(2,"label",162),e.EFF(3,"orderManagement.order.assignedOrders.usedShow"),e.k0s(),e.j41(4,"div",163),e.EFF(5),e.k0s()()()),2&r){const t=e.XpG(2);e.R7$(5),e.SpI(" ",t.finishOrderForm.usedShow||"--"," ")}}function li(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",164)(1,"i",165),e.bIt("click",function(){const n=e.eBV(t),a=n.$implicit,l=n.index,s=e.XpG(2);return e.Njj(s.removeImage(a.id,l))}),e.k0s(),e.j41(2,"div",166),e.nrm(3,"img",167),e.k0s()()}if(2&r){const t=o.$implicit,i=e.XpG(2);e.R7$(3),e.Y8G("src",0==t.id?t.path:i.serverPath+t.path,e.B4B)}}function di(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",91)(1,"h4",92),e.nrm(2,"span",109),e.k0s(),e.j41(3,"button",94),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(4,"div",95)(5,"form",null,6),e.nrm(7,"ngx-ui-loader",96),e.j41(8,"div",110)(9,"div",95)(10,"div",40)(11,"div",111)(12,"div",112)(13,"label",113),e.EFF(14,"orderManagement.order.services"),e.k0s()(),e.j41(15,"div",114)(16,"ng-select",115,7),e.nI1(18,"translate"),e.bIt("change",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.setService(n))}),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.addForm.serviceCode,n)||(a.addForm.serviceCode=n),e.Njj(n)}),e.k0s()(),e.j41(19,"div",114)(20,"div",116)(21,"input",117,8),e.nI1(23,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.addForm.price,n)||(a.addForm.price=n),e.Njj(n)}),e.k0s()()(),e.j41(24,"div",114)(25,"div",116)(26,"input",118,9),e.nI1(28,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.addForm.quantity,n)||(a.addForm.quantity=n),e.Njj(n)}),e.k0s()()(),e.j41(29,"div",114)(30,"div",116)(31,"input",119,10),e.nI1(33,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.addForm.note,n)||(a.addForm.note=n),e.Njj(n)}),e.k0s()()(),e.j41(34,"div",120)(35,"button",121),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.addService())}),e.nrm(36,"i",122),e.k0s()(),e.j41(37,"div",123)(38,"table",124)(39,"thead")(40,"tr")(41,"th",125),e.EFF(42," orderManagement.order.service "),e.k0s(),e.j41(43,"th",46),e.EFF(44," orderManagement.order.price "),e.k0s(),e.j41(45,"th",46),e.EFF(46," orderManagement.order.quantity "),e.k0s(),e.j41(47,"th",125),e.EFF(48," orderManagement.order.notes "),e.k0s(),e.j41(49,"th",46),e.EFF(50," orderManagement.order.actions "),e.k0s()()(),e.j41(51,"tbody"),e.DNE(52,ai,16,7,"tr",60)(53,si,4,3,"tr",126),e.k0s()()()(),e.DNE(54,oi,6,1,"div",127),e.j41(55,"div",128)(56,"div",129)(57,"label",130),e.EFF(58,"orderManagement.order.assignedOrders.total"),e.k0s(),e.j41(59,"div",131),e.EFF(60),e.k0s()(),e.j41(61,"div",129)(62,"label",130),e.EFF(63,"orderManagement.order.assignedOrders.extraDiscount"),e.k0s(),e.j41(64,"div",132)(65,"button",133),e.EFF(66),e.nI1(67,"translate"),e.k0s(),e.j41(68,"div",134),e.nI1(69,"translate"),e.j41(70,"input",135),e.bIt("change",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.checkPrecentageChange(n))}),e.k0s(),e.j41(71,"span",136),e.EFF(72,"%"),e.k0s()(),e.j41(73,"input",137,11),e.bIt("change",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.calculatePrices())}),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.finishOrderForm.discountAdd,n)||(a.finishOrderForm.discountAdd=n),e.Njj(n)}),e.k0s()()(),e.j41(75,"div",129)(76,"label",130),e.EFF(77,"orderManagement.order.assignedOrders.tax"),e.k0s(),e.j41(78,"div",131),e.EFF(79),e.k0s()(),e.j41(80,"div",129)(81,"label",130),e.EFF(82,"orderManagement.order.assignedOrders.promotionDiscount"),e.k0s(),e.j41(83,"div",131),e.EFF(84),e.k0s()(),e.j41(85,"div",129)(86,"label",130),e.EFF(87,"orderManagement.order.assignedOrders.net"),e.k0s(),e.j41(88,"div",131),e.EFF(89),e.k0s()(),e.j41(90,"div",129)(91,"label",130),e.EFF(92,"orderManagement.order.assignedOrders.paid"),e.k0s(),e.j41(93,"div",131),e.EFF(94),e.k0s()(),e.j41(95,"div",129)(96,"label",138),e.EFF(97,"orderManagement.order.assignedOrders.paymentMethod"),e.k0s(),e.j41(98,"div",139)(99,"ng-select",140,12),e.nI1(101,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.finishOrderForm.paymentTypeCode,n)||(a.finishOrderForm.paymentTypeCode=n),e.Njj(n)}),e.k0s()()(),e.j41(102,"div",129)(103,"label",130),e.EFF(104,"orderManagement.order.assignedOrders.remain"),e.k0s(),e.j41(105,"div",131),e.EFF(106),e.k0s()(),e.j41(107,"div",141)(108,"label",130),e.EFF(109,"orderManagement.order.assignedOrders.notes"),e.k0s(),e.j41(110,"textarea",142,13),e.nI1(112,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.finishOrderForm.notes,n)||(a.finishOrderForm.notes=n),e.Njj(n)}),e.EFF(113,"                                "),e.k0s()(),e.j41(114,"div",143)(115,"label",130),e.EFF(116,"orderManagement.order.assignedOrders.notes"),e.k0s(),e.j41(117,"div",139)(118,"button",144),e.bIt("click",function(){e.eBV(t);const n=e.sdS(123);return e.Njj(n.click())}),e.EFF(119," orderManagement.order.assignedOrders.select "),e.k0s(),e.j41(120,"div",145),e.DNE(121,li,4,1,"div",146),e.k0s()(),e.j41(122,"input",147,14),e.bIt("change",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.onFileChanged(n))}),e.k0s()()(),e.j41(124,"div",148)(125,"button",149),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.finishOrder())}),e.k0s(),e.j41(126,"button",150),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()()()}if(2&r){let t;const i=e.sdS(6),n=e.XpG();e.R7$(7),e.Y8G("hasProgressBar",!1)("fgsType",n.loaderOperationShap)("loaderId",n.deleteLoader),e.R7$(9),e.FS9("placeholder",e.bMT(18,35,"orderManagement.order.services")),e.Y8G("items",n.services)("multiple",!1),e.R50("ngModel",n.addForm.serviceCode),e.R7$(5),e.FS9("placeholder",e.bMT(23,37,"orderManagement.order.price")),e.R50("ngModel",n.addForm.price),e.R7$(5),e.FS9("placeholder",e.bMT(28,39,"orderManagement.order.quantity")),e.R50("ngModel",n.addForm.quantity),e.R7$(5),e.FS9("placeholder",e.bMT(33,41,"orderManagement.order.notes")),e.R50("ngModel",n.addForm.note),e.R7$(4),e.Y8G("disabled",!i.valid),e.R7$(17),e.Y8G("ngForOf",n.finishOrderForm.invoiceService),e.R7$(),e.Y8G("ngIf",0==n.finishOrderForm.invoiceService.length),e.R7$(),e.Y8G("ngIf",!1),e.R7$(6),e.SpI(" ",(null!==(t=null==n.finishOrderForm?null:n.finishOrderForm.total)&&void 0!==t?t:0).toFixed(2)," "),e.R7$(6),e.SpI(" ",e.bMT(67,43,"orderManagement.order.Discount")," "),e.R7$(2),e.FS9("pTooltip",e.bMT(69,45,"orderManagement.order.discount")),e.R7$(2),e.Y8G("checked",n.finishOrderForm.isPrecentage),e.R7$(3),e.R50("ngModel",n.finishOrderForm.discountAdd),e.R7$(6),e.SpI(" ",((null==n.finishOrderForm?null:n.finishOrderForm.tax)||0).toFixed(2)," "),e.R7$(5),e.SpI(" ",((null==n.finishOrderForm?null:n.finishOrderForm.promotionDiscount)||0).toFixed(2)," "),e.R7$(5),e.SpI(" ",((null==n.finishOrderForm?null:n.finishOrderForm.net)||0).toFixed(2)," "),e.R7$(5),e.SpI(" ",((null==n.finishOrderForm?null:n.finishOrderForm.paid)||0).toFixed(2)," "),e.R7$(5),e.FS9("placeholder",e.bMT(101,47,"orderManagement.order.assignedOrders.paymentMethod")),e.Y8G("items",n.paymentTypes)("multiple",!1),e.R50("ngModel",n.finishOrderForm.paymentTypeCode),e.R7$(7),e.SpI(" ",((null==n.finishOrderForm?null:n.finishOrderForm.remain)||0).toFixed(2)," "),e.R7$(4),e.FS9("placeholder",e.bMT(112,49,"orderManagement.order.notes")),e.R50("ngModel",n.finishOrderForm.notes),e.R7$(11),e.Y8G("ngForOf",n.images),e.R7$(4),e.Y8G("disabled",!n.finishOrderForm.paymentTypeCode)}}function ci(r,o){if(1&r&&e.nrm(0,"order-operation",168),2&r){const t=e.XpG();e.Y8G("isOrderEdit",!1)("isInner",!0)("orderCode",t.orderSelected)}}function mi(r,o){if(1&r){const t=e.RV6();e.j41(0,"order-timeline",169),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderSelected",t.orderSelected)}}function pi(r,o){if(1&r){const t=e.RV6();e.j41(0,"form",97,6),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.RollBack())}),e.nrm(2,"ngx-ui-loader",96),e.j41(3,"div",110)(4,"div",170)(5,"button",171),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"div",95)(7,"div",172),e.nrm(8,"lord-icon",173),e.j41(9,"div",174),e.nrm(10,"h3",175)(11,"p",176),e.k0s()(),e.j41(12,"div",177),e.nrm(13,"button",178),e.j41(14,"button",150),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}let gi=(()=>{class r extends D.w{constructor(t,i,n,a,l,s,I,b,T,S,y,R,M,w,N,F,E,$,L){super(t,i,I,n,a,l,s),this.baseService=n,this.authDaamService=b,this.invoicesService=T,this._servicesService=S,this.excelService=y,this._formDataService=R,this.cityService=M,this.districtService=w,this.channelService=N,this.teamService=F,this.workTimeService=E,this.cancelReasonService=$,this.router=L,this.title="orderManagement.order.urgentOrders.title",this.titleOperation="orderManagement.order.urgentOrders.titleOperation",this.language=localStorage.getItem("language"),this.keySelected="",this.assignUsers=[],this.times=[],this.images=[],this.employees=[],this.teams=[],this.workTimes=[],this.searchForm={},this.finishOrderForm={invoiceService:[],invoiceAttachImages:[],usedShow:"",promotionDiscount:""},this.addForm={},this.status=[{name:"None",nameAr:"\u0644\u0627 \u0634\u0626",id:0},{name:"Is Review",nameAr:"\u062a\u0645\u062a \u0627\u0644\u0645\u0631\u0627\u062c\u0639\u0629",id:1},{name:"Is Confirmed",nameAr:"\u062a\u0645 \u0627\u0644\u062a\u0623\u0643\u064a\u062f",id:2},{name:"Is Free",nameAr:"\u0645\u062c\u0627\u0646\u064a",id:3},{name:"Is Reopen",nameAr:"\u062a\u0645\u062a \u0625\u0639\u0627\u062f\u0629 \u0641\u062a\u062d\u0647",id:4},{name:"Is Finish",nameAr:"\u0627\u0646\u062a\u0647\u0649",id:5},{name:"Is Cancel",nameAr:"\u062a\u0645 \u0627\u0644\u0625\u0644\u063a\u0627\u0621",id:6},{name:"Is Assign",nameAr:"\u062a\u0645 \u062a\u0639\u064a\u064a\u0646\u0647",id:7},{name:"Is Urgent",nameAr:"\u0639\u0627\u062c\u0644",id:8},{name:"New",nameAr:"\u062c\u062f\u064a\u062f",id:9}],this.isResolveList=!0,this.editPrice=0,this.isEditPrice=!1,this.formPassword={},this.OrderStatusEnum=pe,this.roles=[],this.userTypes=[],this.actives=[{id:!0,name:"active"},{id:!1,name:"noActive"}],this.serverPath=ce.c.mediaUrl,this.countLoad=2,this.orderSelected=0,this.cities=[],this.districts=[],this.channels=[],this.services=[],this.statusList=[],this.cancelReasons=[],this.setDates=(G,oe,fe)=>{if(G?.from||G?.to){const Le=G.to||G.from;this.pagination[oe]=this.datePipe.transform(G.from||G.to,"yyyy-MM-ddT00:00:00"),this.pagination[fe]=this.datePipe.transform(Le,"yyyy-MM-ddT23:59:59.999")}else this.pagination[oe]=null,this.pagination[fe]=null},this.statusList=this.baseService.getTeamStatus(),this.GetCities(),this.GetServicesDropDown(),this.GetPaymentTypesDropDown(),this.GetChannels(),this.translateStatus(),this.GetReturnReasons(),this.GetTeams(),this.GetTimes()}GetTeams(){this.teamService.getDropDown().subscribe(t=>{this.teams=t.data},t=>{console.log(t)})}GetTimes(){this.workTimeService.getDropDown().subscribe(t=>{this.workTimes=t.data},t=>{console.log(t)})}GetReturnReasons(){this.cancelReasonService.getDropDown().subscribe(t=>{this.cancelReasons=t.data},t=>{console.log(t)})}translateStatus(){this.statusList.forEach(t=>{t.name=this.getTranslationText("orderManagement.order."+t.name)})}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetDistricts(t){this.finishOrderForm.districtCode=null,this.districtService.getByCityId(t).subscribe(i=>{this.districts=i.data},i=>{console.log(i)})}GetChannels(){this.channelService.getDropDown().subscribe(t=>{this.channels=t.data},t=>{console.log(t)})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,u.Q)(this.notifier)).subscribe(i=>{i?this.alertService.success():this.alertService.error("general.message."+i)},i=>{this.alertService.error()})}mapRegisterForm(t){let i={...t};return i.employeeCode=0,i}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader(f.a7),this.setDates(t.dates,"visitDateFrom","visitDateTo"),this.setDates(t.creationDates,"creationDateFrom","creationDateTo"),this.loadentities()}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems}}loadentities(){this.countLoad=this.countLoad+1,(!this.isResolveList||1!==this.countLoad)&&(this.ngxLoader.startLoader("assignLoader"),this.pagination.statusFilter=this.OrderStatusEnum.Assigned,this.baseService.get(this.pagination).pipe((0,u.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader("assignLoader"),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader("assignLoader"),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}mapExcel(){let t=[];return this.entities.forEach(i=>{t.push({"Order Code":i.orderCode,"City Name":i.cityName,"District Name":i.districtName?i.districtName:"--","Agent Name":i.agentName,Mobile:i.mobile,"Assigned To":i.teamNames,Times:i.workTimes,Services:this.getServices(i.services),Status:this.translateService.instant(`orderManagement.order.${i.teamStatusName}`)})}),t}reCallOrder(){this.ngxLoader.startLoader(f.Fq),this.baseService.UpdateCallCounter(this.orderSelected).pipe((0,Y.O)(),(0,P.c)(this.mainDelay),(0,H.Z)(),(0,u.Q)(this.notifier),(0,B.j)(()=>this.ngxLoader.stopLoader(f.Fq))).subscribe({next:t=>{this.modalService.dismissAll(),this.loadentities(),this.alertService.success()}})}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}goEdit(t){this.router.navigateByUrl("/managment/order/new")}getStatus(t){return t.isCancel?"bg-warning-subtle text-warning":t.isFinish?"bg-success-subtle text-success":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen||t.isFree?"bg-warning-subtle text-warning":"bg-success-subtle text-success"}getTrnslate(t){return t.isCancel?"orderManagement.order.cancel":t.isFinish?"orderManagement.order.finish":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen?"orderManagement.order.reopen":t.isFree?"orderManagement.order.free":"orderManagement.order.finished"}openModal(t,i,n="md"){this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}oncityChange(t){this.GetDistricts(t.code)}getTimes(t){return t.split(",")}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}getTeamStatus(t){return 0==t||1==t||2==t||3==t?"bg-info":4==t?"bg-success":5==t?"bg-danger":6==t?"bg-danger ":7==t?"bg-success":""}openChangeStatusModal(t,i,n="md"){this.form={},this.form.teamStatus=t.teamStatus,this.finishOrderForm.orderCode=t.orderCode,this.finishOrderForm.invoiceAttachImages=[],this.orderSelected=t.orderCode,this.modalService.open(i,{centered:!0,size:n})}changeStatus(){this.ngxLoader.startLoader(this.operationLoader),this.baseService.ChangeTeamStatus({OrderCode:this.orderSelected,teamStatus:this.form.teamStatus,cancelReasonCode:this.form.cancelReasonCode,teamStatusNotes:this.form.teamStatusNotes}).pipe((0,u.Q)(this.notifier),(0,B.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(i=>{this.loadentities(),this.alertService.success(),this.modalService.dismissAll()},()=>{this.alertService.error()})}finishOrder(){this.ngxLoader.startLoader(f.Fq);let t=this._formDataService.formatFormData(this.finishOrderForm);this.invoicesService.SaveInvoice(t).subscribe(i=>{this.ngxLoader.stopLoader(f.Fq),this.loadentities(),this.modalService.dismissAll()},i=>{console.log(i),this.ngxLoader.stopLoader(f.Fq)})}GetServicesDropDown(){this._servicesService.getDropDown().subscribe(t=>{this.services=t.data},t=>{console.log(t)})}GetOrderServiceAndPayment(t){this.images=[],this.finishOrderDetails=t,this.finishOrderForm=[],this.finishOrderForm={...this.finishOrderForm,orderCode:t.orderCode,discountAdd:t.discountAmountAdd},this.invoicesService.GetOrderServiceAndPayment(t.orderCode).subscribe(n=>{this.finishOrderForm.invoiceService=[],this.finishOrderForm.invoiceAttachImages=[],this.OrderServiceAndPayment=n.data,n.data.forEach(a=>{this.finishOrderForm.discountAdd=a.discountAdd,this.finishOrderForm.isPrecentage=a.isPrecentage,this.finishOrderForm.invoiceService.push({serviceCode:a.serviceCode,service:a.serviceName,notes:a.notes,price:a.price,quantity:a.quantity,paidValue:a.paidValue,isEdit:!1})}),this.calculatePrices()},n=>{console.log(n)})}GetPaymentTypesDropDown(){this.baseService.GetOrderLookUp().subscribe(t=>{this.paymentTypes=t.data.paymentTypes},t=>{console.log(t)})}setService(t){this.finishOrderForm.service=t.name,this.finishOrderForm.price=t.price,this.addForm.price=t.price,this.addForm.quantity=1}checkPrecentageChange(t){this.finishOrderForm.isPrecentage=t.target.checked,this.calculatePrices()}addService(){let t=this.services.find(i=>i.code==this.addForm.serviceCode);this.finishOrderForm.invoiceService.push({service:t.name,serviceCode:this.addForm.serviceCode,price:this.addForm.price,quantity:this.addForm.quantity,notes:this.addForm.note,paidValue:0,isEdit:!1}),this.addForm={},this.calculatePrices()}calculatePrices(){const t=this.finishOrderForm.discountAdd||0;let i=0,n=0;this.finishOrderForm.invoiceService.forEach(b=>{i+=b.quantity?+b.price*+b.quantity:+b.price,n=b.paidValue});let a=0,l=0,s=0;a=.15*i,l=this.finishOrderForm.isPrecentage?i+a-(i+a)*t*.01:i+a-t,s=l-n,this.finishOrderForm={...this.finishOrderForm,net:l,tax:a,total:i,remain:s,paid:n}}editEachPrice(t){this.finishOrderForm.invoiceService[t].price=this.editPrice,this.isEditPrice=!1,this.calculatePrices()}deleteService(t){console.log(t),this.finishOrderForm.invoiceService.splice(t,1),this.calculatePrices()}onFileChanged(t){if(t.target.files&&t.target.files[0]){let i=t.target.files.length;for(let n=0;n<i;n++){let a=new FileReader;this.finishOrderForm.invoiceAttachImages.push({attachImage:t.target.files.item(n),type:"file"}),console.log(this.finishOrderForm.invoiceAttachImages),a.onload=l=>{this.images.push({id:0,path:l.target.result,completePath:l.target.result})},a.readAsDataURL(t.target.files[n])}}}removeImage(t,i){this.finishOrderForm.invoiceAttachImages.splice(i,1),this.images.splice(i,1)}getServices(t){return t.split("#")}OpenOrderTimeLineModel(t,i,n="md"){this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}RollBack(){this.ngxLoader.startLoader(f.Fq),this.baseService.RemoveAssign(this.orderSelected).pipe((0,Y.O)(),(0,P.c)(this.mainDelay),(0,H.Z)(),(0,u.Q)(this.notifier),(0,B.j)(()=>this.ngxLoader.stopLoader(f.Fq))).subscribe({next:t=>{this.modalService.dismissAll(),this.loadentities(),this.alertService.success()}})}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(_.nX),e.rXU(p.c$),e.rXU(k.Q),e.rXU(O.u),e.rXU(d.vh),e.rXU(C.eD),e.rXU(h.Bq),e.rXU(g.J),e.rXU(Ie.U),e.rXU(ye.N),e.rXU(z.V),e.rXU(Fe.Q),e.rXU(Q.h),e.rXU(te.m),e.rXU(ne.l),e.rXU(J.n),e.rXU(le.G),e.rXU(_e.e),e.rXU(_.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-assigned-orders"]],viewQuery:function(i,n){if(1&i&&e.GBs(Gn,5),2&i){let a;e.mGM(a=e.lsd())&&(n.FileInput=a.first)}},features:[e.Vt3],decls:70,vars:68,consts:[["tableMaster",""],["changeStatusModal",""],["finishOrderModal",""],["orderModel",""],["OrderTimeLineModel",""],["RollBackModal",""],["formEntity","ngForm"],["serviceCode","ngModel"],["price","ngModel"],["quantity","ngModel"],["note","ngModel"],["discountAdd","ngModel"],["paymentTypeCode","ngModel"],["notes","ngModel"],["FileInput",""],[1,"row"],[1,"col-lg-12"],[1,"card","grid","table-grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"reset","search","exportXlsx","showAdd","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","search","id","agentName","name","agentName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["InputTirmFilter","","type","search","id","creationUser","name","creationUser",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["InputTirmFilter","","type","search","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","code","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["name","name","bindValue","code","bindLabel","name",3,"change","ngModelChange","placeholder","items","multiple","ngModel"],["name","districtId","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["name","employeeCode","bindValue","name","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["pSortableColumn","orderCode","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["pSortableColumn","cityName","translate","",2,"width","10%"],["pSortableColumn","creationUser","translate","",2,"width","10%"],["pSortableColumn","agentName","translate","",2,"width","10%"],["translate","",2,"width","10%"],["translate","",2,"width","6%"],["pSortableColumn","visitDate","translate","",2,"width","8%"],["translate","",2,"width","12%"],["pSortableColumn","teamStatus","translate","",2,"width","10%"],[2,"width","20%"],[1,"fs-5"],[3,"click"],[1,"code-pointer"],["class","badge bg-danger-subtle text-danger","translate","orderManagement.order.nothing",4,"ngIf"],["class","badge bg-success-subtle text-success",4,"ngIf"],[1,"badge","bg-primary-subtle","text-primary","my-1"],[1,"cursor-pointer","badge","bg-danger-subtle","text-danger","fs-6",3,"click"],[1,"ri-clipboard-line"],[4,"ngFor","ngForOf"],[1,"mdi","mdi-circle-medium"],[1,"ri-history-fill","d-inline","text-primary","fs-16","align-middle","me-1",3,"click"],["type","button","class","d-inline btn btn-sm px-4 btn-primary   btn-label waves-effect waves-light rounded-pill mx-1",3,"click",4,"hasPermission"],[1,"d-inline"],[1,"dropdown-custom","d-inline"],["tooltipPosition","top","type","button",1,"btn","dropbtn","btn-soft-secondary","btn-sm","dropdown-custom","arrow-none",3,"pTooltip"],[1,"ri-more-fill"],[1,"dropdown-menu","dropdown-menu-end","dropdown-content",2,"left","0"],[4,"hasPermission"],[3,"click",4,"hasPermission"],["translate","orderManagement.order.nothing",1,"badge","bg-danger-subtle","text-danger"],[1,"badge","bg-success-subtle","text-success"],[1,"badge","bg-primary-subtle","text-primary","mx-1"],["type","button",1,"d-inline","btn","btn-sm","px-4","btn-primary","btn-label","waves-effect","waves-light","rounded-pill","mx-1",3,"click"],[1,"ri-swap-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","orderManagement.order.changeTeamStatus"],["href","javascript:void(0);",1,"dropdown-item",3,"click"],[1,"ri-exchange-box-fill","align-bottom","me-2","text-muted"],["translate","orderManagement.order.rollBackAssign"],["href","javascript:void(0);",1,"dropdown-item"],[1,"ri-checkbox-circle-fill","align-bottom","me-2","text-muted"],["translate","orderManagement.order.finishOrder"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["translate","orderManagement.order.changeTeamStatus",1,"fw-bold","fs-4"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"hasProgressBar","fgsType","loaderId"],[3,"ngSubmit"],[1,"mb-3"],["for","actionMismatch","translate","",1,"fw-bold","form-label"],["name","teamStatus","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["class","mb-3",4,"ngIf"],["rows","2","InputTirmFilter","","name","teamStatusNotes","type","text","id","teamStatusNotes",1,"form-control","fs-6",3,"ngModelChange","ngModel"],[1,"text-center"],["type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],["for","cancelReasonName","translate","",1,"required","fw-bold","form-label"],["name","name","bindValue","code","bindLabel","name","required","",3,"ngModelChange","placeholder","items","multiple","ngModel"],["translate","orderManagement.order.assignedOrders.finishOrder",1,"fw-bold","fs-4"],[1,"modal-content"],[1,"mt-2","row"],[1,"col-lg-2","mb-3"],["translate","",1,"fw-bold","form-label","required","w-100"],[1,"col-12","col-lg-2","mb-2"],["name","serviceCode","bindValue","code","bindLabel","name","required","",3,"change","ngModelChange","items","multiple","placeholder","ngModel"],[1,"input-group"],["InputTirmFilter","","name","note","type","number","id","price",1,"form-control","required","fs-6",2,"pointer-events","none",3,"ngModelChange","placeholder","ngModel"],["InputTirmFilter","","name","quantity","type","number","id","quantity","required","",1,"form-control","required","fs-6",3,"ngModelChange","placeholder","ngModel"],["InputTirmFilter","","name","note","type","text","id","notes",1,"form-control","fs-6",3,"ngModelChange","placeholder","ngModel"],[1,"col-lg-2","mb-2"],[1,"btn","btn-success","py-1","px-2",3,"click","disabled"],[1,"ri-add-fill",2,"font-size","1.2rem"],[1,"col-12","text-center","mt-2"],[1,"table","table-bordered"],["translate","",2,"width","20%"],[4,"ngIf"],["class","pt-2 row",4,"ngIf"],[1,"pt-2","row"],[1,"col-12","col-lg-6","mb-3","d-flex"],["translate","",1,"fw-bold","form-label","w-25"],[1,"form-control","w-75","custom-form-input"],[1,"input-group","custom-form-input","w-75"],["type","button",1,"btn","btn-danger"],["tooltipPosition","top",1,"input-group-text","d-inline",3,"pTooltip"],["type","checkbox","aria-label","Checkbox for following text input",1,"form-check-input",3,"change","checked"],[1,"p-1"],["InputTirmFilter","","name","discountAdd","type","text","id","discountAdd",1,"form-control","text-right",3,"change","ngModelChange","ngModel"],["translate","",1,"fw-bold","form-label","required","w-25"],[1,"w-75"],["name","paymentTypeCode","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],[1,"col-12","col-lg-12","mb-3","d-flex"],["InputTirmFilter","","name","note","rows","1",1,"form-control","fs-6","w-75",3,"ngModelChange","placeholder","ngModel"],[1,"col-12","col-lg-12","mt-3","d-flex"],["translate","",1,"btn","btn-warning","px-5",3,"click"],[1,"my-3","d-flex"],["class","avatar-lg mx-2 position-relative",4,"ngFor","ngForOf"],["multiple","","value","","type","file","accept","image/png, image/gif, image/jpeg",1,"form-control","d-none",3,"change"],[1,"d-flex","gap-2","justify-content-end","my-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger",3,"click","disabled"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],["class","d-flex",4,"ngIf"],[1,"btn","btn-sm","btn-danger","py-0","px-2","me-1",3,"click"],[1,"ri-delete-bin-3-fill",2,"font-size","1.2rem"],["class","btn btn-sm  btn-success py-0 px-2",3,"click",4,"ngIf"],[1,"d-flex"],["InputTirmFilter","","type","text",1,"form-control","fs-6",3,"ngModelChange","name","placeholder","ngModel","id"],[1,"btn","btn-success","py-1","px-2",3,"click"],[1,"ri-edit-2-fill",2,"font-size","1.2rem"],[1,"btn","btn-sm","btn-success","py-0","px-2",3,"click"],["colspan","4"],[1,"col-12","col-lg-12","mb-3"],["translate","",1,"fw-bold","form-label"],[1,"form-control","custom-form-textArea"],[1,"avatar-lg","mx-2","position-relative"],[1,"position-absolute","bx","bx-x-circle","text-white",2,"background","red","top","1px","right","-4px","font-size","1rem","border-radius","50%",3,"click"],[1,"avatar-title","bg-light","rounded"],["id","product-img1","alt","",1,"avatar-md","h-auto",3,"src"],[3,"isOrderEdit","isInner","orderCode"],[3,"dismiss","orderSelected"],[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"mt-2","text-center"],["src","https://cdn.lordicon.com/gdfrsvpt.json","stroke","bold","state","hover-oscillate","trigger","loop","colors","primary:#f7b84b,secondary:#f06548",2,"width","130px","height","130px"],[1,"pt-2","fs-15","mx-4","mx-sm-5"],["translate","orderManagement.order.AreYouSureMessage"],[1,"text-muted","mx-4","mb-0"],[1,"d-flex","gap-2","justify-content-center","mt-4","mb-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger"]],template:function(i,n){if(1&i){const a=e.RV6();e.j41(0,"div",15)(1,"div",16)(2,"div",17),e.nrm(3,"ngx-ui-loader",18),e.j41(4,"base-filter",19),e.bIt("reset",function(){return e.eBV(a),e.Njj(n.onReset())})("search",function(){return e.eBV(a),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(a),e.Njj(n.onExportXlsx())}),e.qex(5,20),e.j41(6,"div",21)(7,"div",22)(8,"input",23),e.nI1(9,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.orderCode,s)||(n.pagination.orderCode=s),e.Njj(s)}),e.k0s(),e.nrm(10,"i",24),e.k0s()(),e.j41(11,"div",21)(12,"div",22)(13,"input",25),e.nI1(14,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.agentName,s)||(n.pagination.agentName=s),e.Njj(s)}),e.k0s(),e.nrm(15,"i",24),e.k0s()(),e.j41(16,"div",21)(17,"div",22)(18,"input",26),e.nI1(19,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.creationUser,s)||(n.pagination.creationUser=s),e.Njj(s)}),e.k0s(),e.nrm(20,"i",24),e.k0s()(),e.j41(21,"div",21)(22,"div",22)(23,"input",27),e.nI1(24,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.mobile,s)||(n.pagination.mobile=s),e.Njj(s)}),e.k0s(),e.nrm(25,"i",24),e.k0s()(),e.j41(26,"div",21)(27,"div",22)(28,"ng-select",28),e.nI1(29,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.channelCode,s)||(n.pagination.channelCode=s),e.Njj(s)}),e.k0s()()(),e.j41(30,"div",21)(31,"div",22)(32,"ng-select",29),e.nI1(33,"translate"),e.bIt("change",function(s){return e.eBV(a),e.Njj(n.oncityChange(s))}),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.cityCode,s)||(n.pagination.cityCode=s),e.Njj(s)}),e.k0s()()(),e.j41(34,"div",21)(35,"div",22)(36,"ng-select",30),e.nI1(37,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.districtId,s)||(n.pagination.districtId=s),e.Njj(s)}),e.k0s()()(),e.j41(38,"div",21)(39,"div",22)(40,"ng-select",31),e.nI1(41,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.teamName,s)||(n.pagination.teamName=s),e.Njj(s)}),e.k0s()()(),e.j41(42,"div",21)(43,"div",22)(44,"ng-select",31),e.nI1(45,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.workTimes,s)||(n.pagination.workTimes=s),e.Njj(s)}),e.k0s()()(),e.j41(46,"div",21)(47,"input",32),e.nI1(48,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.dates,s)||(n.searchForm.dates=s),e.Njj(s)}),e.k0s()(),e.j41(49,"div",21)(50,"input",32),e.nI1(51,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.creationDates,s)||(n.searchForm.creationDates=s),e.Njj(s)}),e.k0s()(),e.bVm(),e.k0s(),e.j41(52,"div",33)(53,"div",34)(54,"p-table",35,0),e.bIt("onLazyLoad",function(s){return e.eBV(a),e.Njj(n.tableChange(s))})("selectionChange",function(s){return e.eBV(a),e.Njj(n.onSelectionChange(s))}),e.DNE(56,$n,26,0,"ng-template",36)(57,Wn,43,29,"ng-template",37),e.k0s()(),e.DNE(58,Qn,2,0,"div",38)(59,Kn,6,8,"div",39),e.k0s()()()(),e.DNE(60,ei,24,12,"ng-template",null,1,e.C5r)(62,di,127,51,"ng-template",null,2,e.C5r)(64,ci,1,3,"ng-template",null,3,e.C5r)(66,mi,1,1,"ng-template",null,4,e.C5r)(68,pi,15,3,"ng-template",null,5,e.C5r)}2&i&&(e.R7$(3),e.Y8G("loaderId","assignLoader"),e.R7$(),e.Y8G("showAdd",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(9,46,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.orderCode),e.R7$(5),e.FS9("placeholder",e.bMT(14,48,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.agentName),e.R7$(5),e.FS9("placeholder",e.bMT(19,50,"orderManagement.order.creationUser")),e.R50("ngModel",n.pagination.creationUser),e.R7$(5),e.FS9("placeholder",e.bMT(24,52,"orderManagement.order.mobile")),e.R50("ngModel",n.pagination.mobile),e.R7$(5),e.FS9("placeholder",e.bMT(29,54,"orderManagement.order.channelName")),e.Y8G("items",n.channels)("multiple",!1),e.R50("ngModel",n.pagination.channelCode),e.R7$(4),e.FS9("placeholder",e.bMT(33,56,"orderManagement.order.cityName")),e.Y8G("items",n.cities)("multiple",!1),e.R50("ngModel",n.pagination.cityCode),e.R7$(4),e.FS9("placeholder",e.bMT(37,58,"orderManagement.order.districtName")),e.Y8G("items",n.districts)("multiple",!1),e.R50("ngModel",n.pagination.districtId),e.R7$(4),e.FS9("placeholder",e.bMT(41,60,"orderManagement.order.teams")),e.Y8G("items",n.teams)("multiple",!1),e.R50("ngModel",n.pagination.teamName),e.R7$(4),e.FS9("placeholder",e.bMT(45,62,"orderManagement.order.workTimes")),e.Y8G("items",n.workTimes)("multiple",!1),e.R50("ngModel",n.pagination.workTimes),e.R7$(3),e.FS9("placeholder",e.bMT(48,64,"orderManagement.order.visitDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.dates),e.R7$(3),e.FS9("placeholder",e.bMT(51,66,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(4),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[d.Sq,d.bT,c.qT,c.me,c.Q0,c.BC,c.cb,c.YS,c.vS,c.cV,h.s5,j.kL,q.b,ge.L,ie.p,re.g,p.Mm,x.XI,K.Ei,x.Tg,C.Cv,U.vr,W.m,v.p,de.m,me,d.vh,p.D9],encapsulation:2})}}return r})();var hi=m(75312),Re=m(3200);function ui(r,o){if(1&r&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.nI1(5,"translate"),e.k0s(),e.j41(6,"td"),e.EFF(7),e.k0s(),e.j41(8,"td"),e.EFF(9),e.nI1(10,"translate"),e.k0s()()),2&r){const t=o.$implicit;e.R7$(2),e.SpI(" ",t.serviceName,""),e.R7$(2),e.Lme("",t.itemPrice," ",e.bMT(5,6,"orderManagement.order.currancy"),""),e.R7$(3),e.JRh(t.quantity),e.R7$(2),e.Lme("",t.price," ",e.bMT(10,8,"orderManagement.order.currancy"),"")}}function _i(r,o){1&r&&(e.j41(0,"span",53),e.EFF(1," % "),e.k0s())}function fi(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",54)(1,"p-image",55),e.bIt("error",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.setDefaultImage(n,"assets/images/custom/no-img.jpg"))}),e.k0s()()}if(2&r){const t=o.$implicit,i=e.XpG();e.R7$(),e.Y8G("src",i.serverImage+t)("preview",!0)}}function bi(r,o){1&r&&e.nrm(0,"span",56)}function vi(r,o){if(1&r&&(e.j41(0,"span",57),e.EFF(1),e.k0s()),2&r){const t=e.XpG();e.R7$(),e.SpI("",t.orderDetails.districtName," ")}}function Ci(r,o){if(1&r&&(e.j41(0,"li",45)(1,"span",58),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.k0s()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t.teamName)}}function xi(r,o){if(1&r&&(e.j41(0,"li",45)(1,"span",58),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.k0s()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t.workTime)}}let Ii=(()=>{class r{constructor(t){this.alertService=t,this.dismiss=new e.bkB,this.serverImage=ce.c.mediaUrl,this.displayBasic=!1,this.responsiveOptions=[{breakpoint:"1300px",numVisible:4},{breakpoint:"575px",numVisible:1}]}ngOnChanges(t){console.log(this.orderDetails)}getServices(t){return t.split("#")}copyText(t){navigator.clipboard.writeText(t),this.alertService.info(t)}mapUrl(t){if(!t)return"";const[i,n]=t.split(",").map(Number);return`https://www.google.com/maps/dir//${i},${n}/@${i},${n},17z?hl=en-US`}getTimes(t){return t.split(",")}dismissFn(){this.dismiss.emit(!0)}getNet(t){return console.log(t),null==t||""==t?0:t.split("#")[0]}getTax(t){return console.log(t),null==t||""==t?0:t.split("#")[1]}getTotal(t){return console.log(t),null==t||""==t?0:t.split("#")[2]}setDefaultImage(t,i){t.target.src=i}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(O.u))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["finished-order-view"]],inputs:{orderDetails:"orderDetails"},outputs:{dismiss:"dismiss"},features:[e.OA$],decls:142,vars:81,consts:[[1,"row"],[1,"col-xl-8"],[1,"card","mb-3","ribbon-box","material-shadow","cardInvoice"],[1,"card-header"],[1,"col-3"],[1,"badge","bg-primary-subtle","text-primary","my-1"],[1,"card-body"],[1,"ribbon-three","ribbon-three-success"],[1,"card"],[1,"table-responsive","table-card"],[1,"table","table-service","table-borderless","table-centered","align-middle","table-nowrap","mb-0"],[1,"text-muted","table-light"],["translate","orderManagement.order.service",2,"width","50%"],["translate","orderManagement.order.itemPrice",2,"width","15%"],["translate","orderManagement.order.quantity",2,"width","15%"],["translate","orderManagement.order.price",2,"width","15%"],[4,"ngFor","ngForOf"],["colspan","4"],["colspan","3",1,"text-end"],[1,"badge","bg-danger-subtle","text-danger","my-1","fs-6"],["class","mx-1",4,"ngIf"],[1,"badge","bg-success-subtle","text-success","my-1","fs-5"],[1,"card","card-invoice","ribbon-box"],[1,"ribbon","ribbon-success","round-shape"],[1,"row","mt-4"],["class","col-12 col-md-6",4,"ngFor","ngForOf"],[1,"col-xl-4"],[1,"card","card-invoice"],[1,"card-header","bg-light","p-1"],[1,"d-flex"],[1,"card-title","flex-grow-1","mb-0","text-center"],[1,"list-unstyled","mb-0","vstack","gap-3"],[1,"d-flex","align-items-center"],[1,"flex-shrink-0"],[1,"ri-shield-user-line"],[1,"flex-grow-1","ms-3"],[1,"fs-14","mb-1","text-success","fs-6"],[1,"text-muted","mb-0"],[1,"ri-phone-line","me-2","align-middle","text-info","fs-16"],[1,"cursor-pointer","badge","bg-info-subtle","text-info","fs-6",3,"click"],[1,"ri-clipboard-line"],[1,"card-title","mb-0","text-center"],[1,"ri-map-pin-line","align-middle","me-1","text-muted"],[1,"list-unstyled","vstack","gap-2","fs-13","mb-0"],[1,"fw-medium","fs-14","text-muted"],[1,"text-muted"],["class","badge bg-danger-subtle text-danger","translate","orderManagement.order.nothing",4,"ngIf"],["class","badge bg-success-subtle text-success",4,"ngIf"],[1,"ri-history-fill","align-middle","me-1","text-muted"],[1,"card-body","d-flex","card-scroll-xl"],["class","text-muted",4,"ngFor","ngForOf"],[1,"col-xl-12","d-flex","p-1","justify-content-center"],["type","button","data-bs-dismiss","modal",1,"btn","w-sm","btn-danger",3,"click"],[1,"mx-1"],[1,"col-12","col-md-6"],["width","80","height","50",3,"error","src","preview"],["translate","orderManagement.order.nothing",1,"badge","bg-danger-subtle","text-danger"],[1,"badge","bg-success-subtle","text-success"],[1,"badge","bg-primary-subtle","text-primary","mx-1"]],template:function(i,n){1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",0),e.nrm(5,"div",4),e.j41(6,"div",4)(7,"bdi"),e.EFF(8),e.k0s()(),e.j41(9,"div",4)(10,"span",5),e.EFF(11),e.nI1(12,"date"),e.k0s()(),e.j41(13,"div",4)(14,"span",5),e.EFF(15),e.k0s()()()(),e.j41(16,"div",6)(17,"span",7)(18,"span"),e.EFF(19),e.nI1(20,"translate"),e.k0s()(),e.j41(21,"div",0)(22,"div",8)(23,"div",6)(24,"div",9)(25,"app-recent-orders")(26,"table",10)(27,"thead",11)(28,"tr"),e.nrm(29,"th",12)(30,"th",13)(31,"th",14)(32,"th",15),e.k0s()(),e.j41(33,"tbody"),e.DNE(34,ui,11,10,"tr",16),e.j41(35,"tr")(36,"td",17),e.nrm(37,"hr"),e.k0s()(),e.j41(38,"tr")(39,"td"),e.EFF(40),e.nI1(41,"translate"),e.k0s(),e.j41(42,"td",18),e.EFF(43),e.nI1(44,"translate"),e.k0s()(),e.j41(45,"tr")(46,"td"),e.EFF(47),e.nI1(48,"translate"),e.k0s(),e.j41(49,"td",18)(50,"span",19),e.EFF(51),e.DNE(52,_i,2,0,"span",20),e.EFF(53),e.nI1(54,"translate"),e.k0s()()(),e.j41(55,"tr")(56,"td"),e.EFF(57),e.nI1(58,"translate"),e.k0s(),e.j41(59,"td",18),e.EFF(60),e.nI1(61,"translate"),e.k0s()(),e.j41(62,"tr")(63,"td"),e.EFF(64),e.nI1(65,"translate"),e.k0s(),e.j41(66,"td",18)(67,"span",21),e.EFF(68),e.nI1(69,"translate"),e.k0s()()()()()()()()()(),e.j41(70,"div",0)(71,"div",22)(72,"div",6)(73,"bdi")(74,"span",23)(75,"span"),e.EFF(76),e.nI1(77,"translate"),e.k0s()()(),e.j41(78,"div",24),e.DNE(79,fi,2,2,"div",25),e.k0s()()()()()()(),e.j41(80,"div",26)(81,"div",27)(82,"div",28)(83,"div",29)(84,"h5",30),e.EFF(85),e.nI1(86,"translate"),e.k0s()()(),e.j41(87,"div",6)(88,"ul",31)(89,"li")(90,"div",32)(91,"div",33),e.nrm(92,"i",34),e.k0s(),e.j41(93,"div",35)(94,"h6",36),e.EFF(95),e.k0s(),e.j41(96,"p",37),e.EFF(97),e.nI1(98,"translate"),e.nI1(99,"date"),e.k0s()()()(),e.j41(100,"li"),e.nrm(101,"i",38),e.j41(102,"span",39),e.bIt("click",function(){return n.copyText(n.orderDetails.agentMobile)}),e.EFF(103),e.nrm(104,"i",40),e.k0s()()()()(),e.j41(105,"div",27)(106,"div",28)(107,"h5",41),e.nrm(108,"i",42),e.EFF(109),e.nI1(110,"translate"),e.k0s()(),e.j41(111,"div",6)(112,"ul",43)(113,"li",44),e.EFF(114),e.nI1(115,"translate"),e.k0s(),e.j41(116,"li",45),e.EFF(117),e.nI1(118,"translate"),e.DNE(119,bi,1,0,"span",46)(120,vi,2,1,"span",47),e.k0s()()()(),e.j41(121,"div",27)(122,"div",28)(123,"h5",41),e.nrm(124,"i",48),e.EFF(125),e.nI1(126,"translate"),e.k0s()(),e.j41(127,"div",49)(128,"ul",43)(129,"li",44),e.EFF(130),e.nI1(131,"translate"),e.k0s(),e.DNE(132,Ci,4,1,"li",50),e.k0s(),e.j41(133,"ul",43)(134,"li",44),e.EFF(135),e.nI1(136,"translate"),e.k0s(),e.DNE(137,xi,4,1,"li",50),e.k0s()()()(),e.j41(138,"div",51)(139,"button",52),e.bIt("click",function(){return n.dismissFn()}),e.EFF(140),e.nI1(141,"translate"),e.k0s()()()),2&i&&(e.R7$(8),e.SpI(" #SO#",n.orderDetails.ordercode," "),e.R7$(3),e.SpI("",e.i5U(12,37,n.orderDetails.invoice.createdDate,"yyyy-MM-dd HH:mm")," "),e.R7$(4),e.SpI("",n.orderDetails.invoice.createdName," "),e.R7$(4),e.JRh(e.bMT(20,40,"orderManagement.order.invoice")),e.R7$(15),e.Y8G("ngForOf",n.orderDetails.orderServices),e.R7$(6),e.SpI("",e.bMT(41,42,"orderManagement.order.total")," "),e.R7$(3),e.Lme(" ",n.orderDetails.invoice.total," ",e.bMT(44,44,"orderManagement.order.currancy"),""),e.R7$(4),e.SpI("",e.bMT(48,46,"orderManagement.order.Discount")," "),e.R7$(4),e.SpI(" ",n.orderDetails.discountAmount," "),e.R7$(),e.Y8G("ngIf",2==n.orderDetails.discountType),e.R7$(),e.SpI(" ",e.bMT(54,48,"orderManagement.order.currancy")," "),e.R7$(4),e.SpI("",e.bMT(58,50,"orderManagement.order.tax")," "),e.R7$(3),e.Lme(" ",n.orderDetails.invoice.tax," ",e.bMT(61,52,"orderManagement.order.currancy")," "),e.R7$(4),e.SpI("",e.bMT(65,54,"orderManagement.order.net")," "),e.R7$(4),e.Lme(" ",n.orderDetails.invoice.net," ",e.bMT(69,56,"orderManagement.order.currancy")," "),e.R7$(8),e.SpI("",e.bMT(77,58,"orderManagement.order.attchment")," "),e.R7$(3),e.Y8G("ngForOf",n.orderDetails.invoice.attachImagePaths),e.R7$(6),e.SpI("",e.bMT(86,60,"orderManagement.order.customerDetails")," "),e.R7$(10),e.JRh(n.orderDetails.agentName),e.R7$(2),e.Lme(" ",e.bMT(98,62,"orderManagement.order.visitDate")," : ",e.i5U(99,64,n.orderDetails.visitDate,"yyyy-MM-dd")," "),e.R7$(6),e.SpI("",n.orderDetails.agentMobile," "),e.R7$(6),e.SpI(" ",e.bMT(110,67,"orderManagement.order.customerAddress")," "),e.R7$(5),e.Lme(" ",e.bMT(115,69,"orderManagement.order.cityName"),": ",n.orderDetails.cityName," "),e.R7$(3),e.SpI(" ",e.bMT(118,71,"orderManagement.order.districtName"),": "),e.R7$(2),e.Y8G("ngIf",null==n.orderDetails.districtName),e.R7$(),e.Y8G("ngIf",null!==n.orderDetails.districtName),e.R7$(5),e.SpI(" ",e.bMT(126,73,"orderManagement.order.workTimes")," "),e.R7$(5),e.SpI(" ",e.bMT(131,75,"orderManagement.order.assignTo"),": "),e.R7$(2),e.Y8G("ngForOf",n.orderDetails.orderTeams),e.R7$(3),e.SpI(" ",e.bMT(136,77,"orderManagement.order.workTimes"),": "),e.R7$(2),e.Y8G("ngForOf",n.orderDetails.orderTeams),e.R7$(3),e.SpI(" ",e.bMT(141,79,"general.action.close")," "))},dependencies:[d.Sq,d.bT,p.Mm,Re._,d.vh,p.D9],encapsulation:2})}}return r})();const Fi=()=>["completed.print"],Mi=()=>["completed.reOpenOrder"];function ji(r,o){1&r&&(e.j41(0,"tr",32)(1,"th",33),e.nrm(2,"i",34),e.EFF(3," orderManagement.order.orderCode "),e.k0s(),e.j41(4,"th",35),e.nrm(5,"i",34),e.EFF(6," orderManagement.order.creation "),e.k0s(),e.j41(7,"th",36),e.nrm(8,"i",34),e.EFF(9," orderManagement.order.cityName "),e.k0s(),e.j41(10,"th",37),e.nrm(11,"i",34),e.EFF(12," orderManagement.order.agentName "),e.k0s(),e.j41(13,"th",38),e.EFF(14," orderManagement.order.assignTo "),e.k0s(),e.j41(15,"th",38),e.EFF(16," orderManagement.order.workTimes "),e.k0s(),e.j41(17,"th",39),e.nrm(18,"i",34),e.EFF(19," orderManagement.order.visitDate "),e.k0s(),e.j41(20,"th",40),e.EFF(21," orderManagement.order.services "),e.k0s(),e.j41(22,"th",41),e.EFF(23," orderManagement.order.paymentTypeName "),e.k0s(),e.j41(24,"th",38),e.EFF(25," orderManagement.order.finishUser "),e.k0s(),e.j41(26,"th",41),e.EFF(27," orderManagement.order.cost "),e.k0s(),e.j41(28,"th",41),e.EFF(29," orderManagement.order.costAfterDiscount "),e.k0s(),e.j41(30,"th",41),e.EFF(31," orderManagement.order.OrderVAT "),e.k0s(),e.j41(32,"th",41),e.EFF(33," orderManagement.order.total "),e.k0s(),e.nrm(34,"th",42),e.k0s())}function Ti(r,o){1&r&&e.nrm(0,"span",64)}function Si(r,o){if(1&r&&(e.j41(0,"span",46),e.EFF(1),e.k0s()),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI("",t.districtName," ")}}function ki(r,o){if(1&r&&(e.qex(0),e.j41(1,"span",65),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.bVm()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t)}}function yi(r,o){if(1&r&&(e.qex(0),e.j41(1,"span",65),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.bVm()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t)}}function Ri(r,o){if(1&r&&(e.qex(0),e.j41(1,"span",65),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.bVm()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t)}}function Ei(r,o){if(1&r&&(e.nrm(0,"i",66),e.EFF(1),e.nI1(2,"date"),e.nrm(3,"br")(4,"i",67),e.EFF(5),e.nI1(6,"date"),e.nrm(7,"br")(8,"i",68),e.EFF(9)),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",e.i5U(2,3,t.createdDate,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",e.i5U(6,6,t.updatedDate,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",t.creatorName," ")}}function wi(r,o){if(1&r){const t=e.RV6();e.j41(0,"li",60),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,a=e.XpG();return e.Njj(a.openInNewTab(n.orderCode))}),e.j41(1,"span",61),e.nrm(2,"i",69)(3,"span",70),e.k0s()()}}function Ni(r,o){if(1&r){const t=e.RV6();e.j41(0,"li",60),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,a=e.XpG(),l=e.sdS(63);return e.Njj(a.openModalRepon(n.orderCode,l))}),e.j41(1,"span",61),e.nrm(2,"i",71)(3,"span",72),e.k0s()()}}function Di(r,o){if(1&r){const t=e.RV6();e.j41(0,"tr",43)(1,"td",44),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),l=e.sdS(65);return e.Njj(a.openModal(n.orderCode,l,"lg"))}),e.j41(2,"bdi",45),e.EFF(3),e.k0s()(),e.j41(4,"td"),e.EFF(5),e.nI1(6,"date"),e.j41(7,"span",46),e.EFF(8),e.k0s()(),e.j41(9,"td"),e.EFF(10),e.DNE(11,Ti,1,0,"span",47)(12,Si,2,1,"span",48),e.k0s(),e.j41(13,"td")(14,"span",49),e.EFF(15),e.k0s(),e.nrm(16,"br"),e.j41(17,"span",50),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.copytext(n.mobile))}),e.EFF(18),e.nrm(19,"i",51),e.k0s()(),e.j41(20,"td"),e.DNE(21,ki,4,1,"ng-container",52),e.k0s(),e.j41(22,"td"),e.DNE(23,yi,4,1,"ng-container",52),e.k0s(),e.j41(24,"td"),e.EFF(25),e.nI1(26,"date"),e.k0s(),e.j41(27,"td"),e.DNE(28,Ri,4,1,"ng-container",52),e.k0s(),e.j41(29,"td"),e.EFF(30),e.k0s(),e.j41(31,"td"),e.EFF(32),e.k0s(),e.j41(33,"td"),e.EFF(34),e.k0s(),e.j41(35,"td"),e.EFF(36),e.k0s(),e.j41(37,"td"),e.EFF(38),e.k0s(),e.j41(39,"td")(40,"span",53),e.EFF(41),e.k0s()(),e.j41(42,"td"),e.DNE(43,Ei,10,9,"ng-template",null,4,e.C5r),e.j41(45,"span",54)(46,"div",55)(47,"button",56),e.nrm(48,"i",57),e.k0s(),e.j41(49,"ul",58),e.DNE(50,wi,4,0,"li",59)(51,Ni,4,0,"li",59),e.j41(52,"li",60),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),l=e.sdS(65);return e.Njj(a.openModal(n.orderCode,l,"lg"))}),e.j41(53,"span",61),e.nrm(54,"i",62)(55,"span",63),e.k0s()()()()()()()}if(2&r){const t=o.$implicit,i=e.XpG();e.R7$(3),e.SpI("#SO#",t.orderCode,""),e.R7$(2),e.SpI("",e.i5U(6,20,t.createdDate,"yyyy-MM-dd")," "),e.R7$(3),e.SpI("",t.creationUser," "),e.R7$(2),e.SpI("",t.cityName," "),e.R7$(),e.Y8G("ngIf",null==t.districtName),e.R7$(),e.Y8G("ngIf",null!==t.districtName),e.R7$(3),e.SpI("",t.agentName," "),e.R7$(3),e.SpI("",t.mobile," "),e.R7$(3),e.Y8G("ngForOf",i.getTimes(t.teamNames)),e.R7$(2),e.Y8G("ngForOf",i.getTimes(t.workTimes)),e.R7$(2),e.SpI(" ",e.i5U(26,23,t.visitDate,"yyyy-MM-dd"),""),e.R7$(3),e.Y8G("ngForOf",i.getServices(t.services)),e.R7$(2),e.SpI(" ",t.paymentTypeName,""),e.R7$(2),e.SpI(" ",t.finishUser,""),e.R7$(2),e.SpI(" ",i.getCost(t.totalTaxNet,0)," "),e.R7$(2),e.SpI(" ",t.priceAfterDiscount," "),e.R7$(2),e.SpI(" ",i.getCost(t.totalTaxNet,1)," "),e.R7$(3),e.JRh(i.getCost(t.totalTaxNet,2)),e.R7$(9),e.Y8G("hasPermission",e.lJ4(26,Fi)),e.R7$(),e.Y8G("hasPermission",e.lJ4(27,Mi))}}function Oi(r,o){if(1&r&&(e.j41(0,"tr",74)(1,"td",75),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.j41(4,"td",76),e.EFF(5),e.k0s(),e.j41(6,"td",76),e.EFF(7),e.k0s(),e.j41(8,"td",76),e.EFF(9),e.k0s(),e.j41(10,"td",76),e.EFF(11),e.k0s(),e.j41(12,"td"),e.EFF(13),e.nI1(14,"translate"),e.k0s()()),2&r){const t=e.XpG(2);e.R7$(2),e.JRh(e.bMT(3,6,"orderManagement.order.total")),e.R7$(3),e.JRh(null==t.sumResult?null:t.sumResult.total.toFixed(2)),e.R7$(2),e.JRh(null==t.sumResult?null:t.sumResult.priceAfterDiscount),e.R7$(2),e.JRh(null==t.sumResult?null:t.sumResult.tax.toFixed(2)),e.R7$(2),e.JRh(null==t.sumResult?null:t.sumResult.net.toFixed(2)),e.R7$(2),e.JRh(e.bMT(14,8,"orderManagement.order.currancy"))}}function Vi(r,o){if(1&r&&e.DNE(0,Oi,15,10,"tr",73),2&r){const t=e.XpG();e.Y8G("ngIf",t.sumResult)}}function Gi(r,o){1&r&&(e.j41(0,"div",77),e.EFF(1," general.table.noData "),e.k0s())}function Ai(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",78)(1,"div",79),e.nrm(2,"ngb-pagination-info",80),e.j41(3,"table-length",81),e.bIt("lengthChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",82)(5,"ngb-pagination",83),e.bIt("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.pagination.pageNumber,n)||(a.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function Li(r,o){if(1&r){const t=e.RV6();e.j41(0,"delete-modal",84),e.bIt("deleteConfirm",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.DeleteConfirm())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}}function Bi(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",85)(1,"div",86)(2,"h4",87)(3,"span",88),e.EFF(4,"orderManagement.order.completeOrders.title"),e.k0s()(),e.j41(5,"button",89),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"div",90),e.nrm(7,"ngx-ui-loader",91),e.j41(8,"form",92,5),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onReopenOrder())}),e.j41(10,"div",6)(11,"div",93)(12,"label",94),e.EFF(13,"orderManagement.order.reopenOrder"),e.k0s(),e.j41(14,"ng-select",18),e.nI1(15,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.form.returnReasonCode,n)||(a.form.returnReasonCode=n),e.Njj(n)}),e.k0s()(),e.j41(16,"div",93)(17,"label",94),e.EFF(18,"orderManagement.order.reopenNotes"),e.k0s(),e.j41(19,"textarea",95),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.form.reopenNotes,n)||(a.form.reopenNotes=n),e.Njj(n)}),e.k0s()()(),e.j41(20,"div",96)(21,"button",97),e.nrm(22,"i",98)(23,"span",99),e.k0s()()()()()}if(2&r){const t=e.sdS(9),i=e.XpG();e.R7$(7),e.Y8G("hasProgressBar",!1)("fgsType",i.loaderOperationShap)("loaderId",i.operationLoader),e.R7$(7),e.FS9("placeholder",e.bMT(15,9,"orderManagement.order.returnReason")),e.Y8G("items",i.returnReasons)("multiple",!1),e.R50("ngModel",i.form.returnReasonCode),e.R7$(5),e.R50("ngModel",i.form.reopenNotes),e.R7$(2),e.Y8G("disabled",!t.valid)}}function $i(r,o){if(1&r){const t=e.RV6();e.j41(0,"finished-order-view",100),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderDetails",t.orderSelected)}}let Xi=(()=>{class r extends D.w{constructor(t,i,n,a,l,s,I,b,T,S,y,R,M,w,N,F){super(t,i,I,n,a,l,s),this.baseService=n,this.authDaamService=b,this.excelService=T,this.cityService=S,this.districtService=y,this.channelService=R,this.teamService=M,this.workTimeService=w,this.returnReasonService=N,this.router=F,this.title="orderManagement.order.completeOrders.title",this.titleOperation="orderManagement.order.urgentOrders.titleOperation",this.language=localStorage.getItem("language"),this.keySelected="",this.assignUsers=[],this.times=[],this.employees=[],this.searchForm={},this.isResolveList=!0,this.teams=[],this.workTimes=[],this.employeeGroups=[],this.formPassword={},this.OrderStatusEnum=pe,this.roles=[],this.userTypes=[],this.actives=[{id:!0,name:"active"},{id:!1,name:"noActive"}],this.countLoad=2,this.orderSelected=0,this.cities=[],this.districts=[],this.channels=[],this.returnReasons=[],this.isOpen=!0,this.users=[],this.sumResult={total:0,tax:0,net:0},this.setDates=(E,$,L)=>{if(E?.from||E?.to){const oe=E.to||E.from;this.pagination[$]=this.datePipe.transform(E.from||E.to,"yyyy-MM-ddT00:00:00"),this.pagination[L]=this.datePipe.transform(oe,"yyyy-MM-ddT23:59:59.999")}else this.pagination[$]=null,this.pagination[L]=null},this.GetCities(),this.GetReturnReasons(),this.GetTeams(),this.GetTimes(),this.GetOrderLookUp()}GetOrderLookUp(){this.baseService.GetOrderLookUp().subscribe(t=>{this.users=t.data.users},t=>{console.log(t)})}GetTeams(){this.teamService.getDropDown().subscribe(t=>{this.teams=t.data},t=>{console.log(t)})}GetTimes(){this.workTimeService.getDropDown().subscribe(t=>{this.workTimes=t.data},t=>{console.log(t)})}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetDistricts(t){this.districtService.getByCityId(t).subscribe(i=>{this.districts=i.data},i=>{console.log(i)})}GetReturnReasons(){this.returnReasonService.getDropDown().subscribe(t=>{this.returnReasons=t.data},t=>{console.log(t)})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,u.Q)(this.notifier)).subscribe(i=>{i?this.alertService.success():this.alertService.error("general.message."+i)},i=>{this.alertService.error()})}openInNewTab(t){this.router.navigateByUrl("/orders-invoices",{state:{id:t}})}mapRegisterForm(t){let i={...t};return i.employeeCode=0,i}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader(f.a7),this.setDates(t.dates,"visitDateFrom","visitDateTo"),this.setDates(t.creationDates,"creationDateFrom","creationDateTo"),this.loadentities()}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems}}loadentities(){this.countLoad=this.countLoad+1,(!this.isResolveList||1!==this.countLoad)&&(this.ngxLoader.startLoader("completeLoader"),this.pagination.statusFilter=this.OrderStatusEnum.Finished,this.baseService.get(this.pagination).pipe((0,u.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader("completeLoader"),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.getTotal(t.data),this.LoadSuccess()},t=>{this.ngxLoader.stopLoader("completeLoader"),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}getTotal(t){this.sumResult=t.reduce((i,n)=>{const[a=0,l=0,s=0]=(n.totalTaxNet||"0#0#0").split("#").map(Number);return{priceAfterDiscount:(i.priceAfterDiscount||0)+(n.priceAfterDiscount||0),total:i.total+a,tax:i.tax+l,net:i.net+s}},{priceAfterDiscount:0,total:0,tax:0,net:0})}mapExcel(){let t=[];return this.entities.forEach(i=>{t.push({"Order Code":i.orderCode,"Created Date":i.createdDate,"Creation user":i.creationUser,"City Name":i.cityName,"District Name":i.districtName?i.districtName:"--","Agent Name":i.agentName,Mobile:i.mobile,"Assigned To":i.teamNames,Times:i.workTimes,"Visit Date":i.visitDate,Services:i.services,Payment:i.paymentTypeName,"Finished By":i.finishUser,Cost:this.getCost(i.totalTaxNet,0),Vat:this.getCost(i.totalTaxNet,1),Total:this.getCost(i.totalTaxNet,2)})}),t}reCallOrder(){this.ngxLoader.startLoader(f.Fq),this.baseService.UpdateCallCounter(this.orderSelected).pipe((0,Y.O)(),(0,P.c)(this.mainDelay),(0,H.Z)(),(0,u.Q)(this.notifier),(0,B.j)(()=>this.ngxLoader.stopLoader(f.Fq))).subscribe({next:t=>{this.modalService.dismissAll(),this.loadentities(),this.alertService.success()}})}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}goEdit(t){this.router.navigateByUrl("/managment/order/new")}getStatus(t){return t.isCancel?"bg-warning-subtle text-warning":t.isFinish?"bg-success-subtle text-success":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen||t.isFree?"bg-warning-subtle text-warning":"bg-success-subtle text-success"}getTrnslate(t){return t.isCancel?"orderManagement.order.cancel":t.isFinish?"orderManagement.order.finish":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen?"orderManagement.order.reopen":t.isFree?"orderManagement.order.free":"orderManagement.order.finished"}openModal(t,i,n="md"){0!=this.isOpen&&(this.isOpen=!1,this.baseService.GetOrderDetailInvoice(t).pipe((0,u.Q)(this.notifier)).subscribe(a=>{a.success?(this.isOpen=!0,this.form={},this.orderSelected=a.data,this.modalService.open(i,{centered:!0,size:n})):(this.isOpen=!0,this.alertService.error("general.message."+a))},a=>{this.alertService.error()}))}openModalRepon(t,i,n="md"){0!=this.isOpen&&(this.isOpen=!1,this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n}))}oncityChange(t){this.GetDistricts(t.code)}getTimes(t){return t.split(",")}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}getCost(t,i){return t.split("#")[i]}onReopenOrder(){let t={returnReasonCode:this.form.returnReasonCode,orderId:this.orderSelected,reopenNotes:this.form.reopenNotes};this.ngxLoader.startLoader(this.operationLoader),this.baseService.ReopenOrder(t).pipe((0,u.Q)(this.notifier)).subscribe(i=>{this.ngxLoader.stopLoader(this.operationLoader),i.success?(this.alertService.success(),this.modalService.dismissAll(),this.loadentities()):this.alertService.error()},()=>{this.alertService.error(),this.ngxLoader.stopLoader(this.operationLoader)})}getServices(t){return t.split("#")}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(_.nX),e.rXU(p.c$),e.rXU(k.Q),e.rXU(O.u),e.rXU(d.vh),e.rXU(C.eD),e.rXU(h.Bq),e.rXU(g.J),e.rXU(z.V),e.rXU(Q.h),e.rXU(te.m),e.rXU(ne.l),e.rXU(J.n),e.rXU(le.G),e.rXU(hi.Y),e.rXU(_.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-complete-orders"]],features:[e.Vt3],decls:66,vars:70,consts:[["tableMaster",""],["deleteModal",""],["reopenOrder",""],["orderViewModel",""],["tooltipContent",""],["formEntity","ngForm"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"reset","search","exportXlsx","showAdd","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","search","id","agentName","name","agentName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["InputTirmFilter","","type","search","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","code","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["name","name","bindValue","code","bindLabel","name",3,"change","ngModelChange","placeholder","items","multiple","ngModel"],["name","districtId","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["name","employeeCode","bindValue","name","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["name","createdBy","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["pSortableColumn","orderCode","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["pSortableColumn","createdDate","translate","",2,"width","15%"],["pSortableColumn","cityName","translate","",2,"width","10%"],["pSortableColumn","agentName","translate","",2,"width","8%"],["translate","",2,"width","6%"],["pSortableColumn","visitDate","translate","",2,"width","9%"],["translate","",2,"width","10%"],["translate","",2,"width","5%"],[2,"width","15%"],[1,"fs-5"],[1,"text-muted","text-decoration-underline",3,"click"],[1,"code-pointer"],[1,"badge","bg-success-subtle","text-success"],["class","badge bg-danger-subtle text-danger","translate","orderManagement.order.nothing",4,"ngIf"],["class","badge bg-success-subtle text-success",4,"ngIf"],[1,"badge","bg-primary-subtle","text-primary","my-1"],[1,"cursor-pointer","badge","bg-danger-subtle","text-danger","fs-6",3,"click"],[1,"ri-clipboard-line"],[4,"ngFor","ngForOf"],[1,"badge","bg-primary-subtle","text-primary","fs-5"],[1,"d-inline"],[1,"dropdown-custom"],["type","button",1,"btn","dropbtn","btn-soft-secondary","btn-sm","dropdown-custom","arrow-none"],[1,"ri-more-fill"],[1,"dropdown-menu","dropdown-menu-end","dropdown-content",2,"left","0"],[3,"click",4,"hasPermission"],[3,"click"],[1,"dropdown-item"],[1,"ri-eye-fill","align-bottom","me-2","text-muted"],["translate","general.action.view"],["translate","orderManagement.order.nothing",1,"badge","bg-danger-subtle","text-danger"],[1,"badge","bg-primary-subtle","text-primary","mx-1"],[1,"ri-history-fill","text-warning"],[1,"ri-history-fill","text-danger"],[1,"ri-user-location-fill","text-primary"],[1,"ri-printer-line","align-bottom","me-2","text-muted"],["translate","orderManagement.order.printPill"],[1,"ri-exchange-fill","align-bottom","me-2","text-muted"],["translate","orderManagement.order.reopenOrder"],["class","table-footer",4,"ngIf"],[1,"table-footer"],["colspan","9",1,"text-center","fs-4"],[1,"text-primary","fs-5"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"deleteConfirm","dismiss"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["translate","",1,"fw-bold","fs-4"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"hasProgressBar","fgsType","loaderId"],[3,"ngSubmit"],[1,"mb-3"],["for","actionMismatch","translate","",1,"fw-bold","form-label"],["rows","2","InputTirmFilter","","name","reopenNotes","type","text","id","reopenNotes",1,"form-control","fs-6",3,"ngModelChange","ngModel"],[1,"text-center"],["type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],[3,"dismiss","orderDetails"]],template:function(i,n){if(1&i){const a=e.RV6();e.j41(0,"div",6)(1,"div",7)(2,"div",8),e.nrm(3,"ngx-ui-loader",9),e.j41(4,"base-filter",10),e.bIt("reset",function(){return e.eBV(a),e.Njj(n.onReset())})("search",function(){return e.eBV(a),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(a),e.Njj(n.onExportXlsx())}),e.qex(5,11),e.j41(6,"div",12)(7,"div",13)(8,"input",14),e.nI1(9,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.orderCode,s)||(n.pagination.orderCode=s),e.Njj(s)}),e.k0s(),e.nrm(10,"i",15),e.k0s()(),e.j41(11,"div",12)(12,"div",13)(13,"input",16),e.nI1(14,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.agentName,s)||(n.pagination.agentName=s),e.Njj(s)}),e.k0s(),e.nrm(15,"i",15),e.k0s()(),e.j41(16,"div",12)(17,"div",13)(18,"input",17),e.nI1(19,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.mobile,s)||(n.pagination.mobile=s),e.Njj(s)}),e.k0s(),e.nrm(20,"i",15),e.k0s()(),e.j41(21,"div",12)(22,"div",13)(23,"ng-select",18),e.nI1(24,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.channelCode,s)||(n.pagination.channelCode=s),e.Njj(s)}),e.k0s()()(),e.j41(25,"div",12)(26,"div",13)(27,"ng-select",19),e.nI1(28,"translate"),e.bIt("change",function(s){return e.eBV(a),e.Njj(n.oncityChange(s))}),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.cityCode,s)||(n.pagination.cityCode=s),e.Njj(s)}),e.k0s()()(),e.j41(29,"div",12)(30,"div",13)(31,"ng-select",20),e.nI1(32,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.districtId,s)||(n.pagination.districtId=s),e.Njj(s)}),e.k0s()()(),e.j41(33,"div",12)(34,"div",13)(35,"ng-select",21),e.nI1(36,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.teamName,s)||(n.pagination.teamName=s),e.Njj(s)}),e.k0s()()(),e.j41(37,"div",12)(38,"div",13)(39,"ng-select",21),e.nI1(40,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.workTimes,s)||(n.pagination.workTimes=s),e.Njj(s)}),e.k0s()()(),e.j41(41,"div",12)(42,"div",13)(43,"ng-select",22),e.nI1(44,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.createdBy,s)||(n.pagination.createdBy=s),e.Njj(s)}),e.k0s()()(),e.j41(45,"div",12)(46,"input",23),e.nI1(47,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.dates,s)||(n.searchForm.dates=s),e.Njj(s)}),e.k0s()(),e.j41(48,"div",12)(49,"input",23),e.nI1(50,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.creationDates,s)||(n.searchForm.creationDates=s),e.Njj(s)}),e.k0s()(),e.bVm(),e.k0s(),e.j41(51,"div",24)(52,"div",25)(53,"p-table",26,0),e.bIt("onLazyLoad",function(s){return e.eBV(a),e.Njj(n.tableChange(s))})("selectionChange",function(s){return e.eBV(a),e.Njj(n.onSelectionChange(s))}),e.DNE(55,ji,35,0,"ng-template",27)(56,Di,56,28,"ng-template",28)(57,Vi,1,1,"ng-template",29),e.k0s()(),e.DNE(58,Gi,2,0,"div",30)(59,Ai,6,8,"div",31),e.k0s()()()(),e.DNE(60,Li,1,0,"ng-template",null,1,e.C5r)(62,Bi,24,11,"ng-template",null,2,e.C5r)(64,$i,1,1,"ng-template",null,3,e.C5r)}2&i&&(e.R7$(3),e.Y8G("loaderId","completeLoader"),e.R7$(),e.Y8G("showAdd",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(9,48,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.orderCode),e.R7$(5),e.FS9("placeholder",e.bMT(14,50,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.agentName),e.R7$(5),e.FS9("placeholder",e.bMT(19,52,"orderManagement.order.mobile")),e.R50("ngModel",n.pagination.mobile),e.R7$(5),e.FS9("placeholder",e.bMT(24,54,"orderManagement.order.channelName")),e.Y8G("items",n.channels)("multiple",!1),e.R50("ngModel",n.pagination.channelCode),e.R7$(4),e.FS9("placeholder",e.bMT(28,56,"orderManagement.order.cityName")),e.Y8G("items",n.cities)("multiple",!1),e.R50("ngModel",n.pagination.cityCode),e.R7$(4),e.FS9("placeholder",e.bMT(32,58,"orderManagement.order.districtName")),e.Y8G("items",n.districts)("multiple",!1),e.R50("ngModel",n.pagination.districtId),e.R7$(4),e.FS9("placeholder",e.bMT(36,60,"orderManagement.order.teams")),e.Y8G("items",n.teams)("multiple",!1),e.R50("ngModel",n.pagination.teamName),e.R7$(4),e.FS9("placeholder",e.bMT(40,62,"orderManagement.order.workTimes")),e.Y8G("items",n.workTimes)("multiple",!1),e.R50("ngModel",n.pagination.workTimes),e.R7$(4),e.FS9("placeholder",e.bMT(44,64,"orderManagement.order.creation")),e.Y8G("items",n.users)("multiple",!1),e.R50("ngModel",n.pagination.createdBy),e.R7$(3),e.FS9("placeholder",e.bMT(47,66,"orderManagement.order.visitDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.dates),e.R7$(3),e.FS9("placeholder",e.bMT(50,68,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(4),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(5),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[d.Sq,d.bT,c.qT,c.me,c.Q0,c.BC,c.cb,c.vS,c.cV,h.s5,j.kL,q.b,Ce.w,ie.p,re.g,p.Mm,x.XI,K.Ei,x.Tg,C.Cv,U.vr,W.m,v.p,Ii,d.vh,p.D9],encapsulation:2})}}return r})();function Ui(r,o){1&r&&(e.j41(0,"tr",27)(1,"th",28),e.nrm(2,"i",29),e.EFF(3," orderManagement.order.orderCode "),e.k0s(),e.j41(4,"th",30),e.nrm(5,"i",29),e.EFF(6," orderManagement.order.creation "),e.k0s(),e.j41(7,"th",31),e.nrm(8,"i",29),e.EFF(9," orderManagement.order.cityName "),e.k0s(),e.j41(10,"th",32),e.nrm(11,"i",29),e.EFF(12," orderManagement.order.agentName "),e.k0s(),e.j41(13,"th",33),e.EFF(14," orderManagement.order.assignTo "),e.k0s(),e.j41(15,"th",33),e.EFF(16," orderManagement.order.workTimes "),e.k0s(),e.j41(17,"th",34),e.nrm(18,"i",29),e.EFF(19," orderManagement.order.visitDate "),e.k0s(),e.j41(20,"th",35),e.EFF(21," orderManagement.order.services "),e.k0s(),e.j41(22,"th",36),e.EFF(23," orderManagement.order.cancelReasonName "),e.k0s(),e.nrm(24,"th",37),e.k0s())}function Yi(r,o){1&r&&e.nrm(0,"span",49)}function Pi(r,o){if(1&r&&(e.j41(0,"span",40),e.EFF(1),e.k0s()),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI("",t.districtName," ")}}function Hi(r,o){if(1&r&&(e.qex(0),e.j41(1,"span",50),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.bVm()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t)}}function zi(r,o){if(1&r&&(e.qex(0),e.j41(1,"span",50),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.bVm()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t)}}function Ji(r,o){if(1&r&&(e.qex(0),e.j41(1,"span",50),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.bVm()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t)}}function qi(r,o){if(1&r){const t=e.RV6();e.j41(0,"tr",38)(1,"td")(2,"bdi",39),e.EFF(3),e.k0s()(),e.j41(4,"td"),e.EFF(5),e.nI1(6,"date"),e.j41(7,"span",40),e.EFF(8),e.k0s()(),e.j41(9,"td"),e.EFF(10),e.DNE(11,Yi,1,0,"span",41)(12,Pi,2,1,"span",42),e.k0s(),e.j41(13,"td")(14,"span",43),e.EFF(15),e.k0s(),e.nrm(16,"br"),e.j41(17,"span",44),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.copytext(n.mobile))}),e.EFF(18),e.nrm(19,"i",45),e.k0s()(),e.j41(20,"td"),e.DNE(21,Hi,4,1,"ng-container",46),e.k0s(),e.j41(22,"td"),e.DNE(23,zi,4,1,"ng-container",46),e.k0s(),e.j41(24,"td"),e.EFF(25),e.nI1(26,"date"),e.k0s(),e.j41(27,"td"),e.DNE(28,Ji,4,1,"ng-container",46),e.k0s(),e.j41(29,"td"),e.EFF(30),e.k0s(),e.j41(31,"td")(32,"div",47)(33,"i",48),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),l=e.sdS(58);return e.Njj(a.OpenOrderTimeLineModel(n,l,"lg"))}),e.k0s()()()()}if(2&r){const t=o.$implicit,i=e.XpG();e.R7$(3),e.SpI("#SO#",t.orderCode,""),e.R7$(2),e.SpI("",e.i5U(6,13,t.createdDate,"yyyy-MM-dd HH:mm")," "),e.R7$(3),e.SpI("",t.creationUser," "),e.R7$(2),e.SpI("",t.cityName," "),e.R7$(),e.Y8G("ngIf",null==t.districtName),e.R7$(),e.Y8G("ngIf",null!==t.districtName),e.R7$(3),e.SpI("",t.agentName," "),e.R7$(3),e.SpI("",t.mobile," "),e.R7$(3),e.Y8G("ngForOf",i.getTimes(t.teamNames)),e.R7$(2),e.Y8G("ngForOf",i.getTimes(t.workTimes)),e.R7$(2),e.SpI(" ",e.i5U(26,16,t.visitDate,"yyyy-MM-dd"),""),e.R7$(3),e.Y8G("ngForOf",i.getServices(t.services)),e.R7$(2),e.SpI(" ",t.cancelReasonName,"")}}function Wi(r,o){1&r&&(e.j41(0,"div",51),e.EFF(1," general.table.noData "),e.k0s())}function Qi(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",52)(1,"div",53),e.nrm(2,"ngb-pagination-info",54),e.j41(3,"table-length",55),e.bIt("lengthChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",56)(5,"ngb-pagination",57),e.bIt("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.pagination.pageNumber,n)||(a.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function Ki(r,o){if(1&r){const t=e.RV6();e.j41(0,"delete-modal",58),e.bIt("deleteConfirm",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.DeleteConfirm())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}}function Zi(r,o){if(1&r){const t=e.RV6();e.j41(0,"order-timeline",59),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderSelected",t.orderSelected)}}let er=(()=>{class r extends D.w{constructor(t,i,n,a,l,s,I,b,T,S,y,R,M,w,N){super(t,i,I,n,a,l,s),this.baseService=n,this.authDaamService=b,this.excelService=T,this.cityService=S,this.districtService=y,this.channelService=R,this.teamService=M,this.workTimeService=w,this.router=N,this.title="orderManagement.order.refundable",this.titleOperation="orderManagement.order.refundable",this.language=localStorage.getItem("language"),this.keySelected="",this.assignUsers=[],this.times=[],this.employees=[],this.searchForm={},this.isResolveList=!0,this.formPassword={},this.OrderStatusEnum=pe,this.roles=[],this.userTypes=[],this.teams=[],this.workTimes=[],this.actives=[{id:!0,name:"active"},{id:!1,name:"noActive"}],this.countLoad=2,this.orderSelected=0,this.cities=[],this.districts=[],this.channels=[],this.GetCities(),this.GetChannels(),this.GetTeams(),this.GetTimes()}GetTeams(){this.teamService.getDropDown().subscribe(t=>{this.teams=t.data},t=>{console.log(t)})}GetTimes(){this.workTimeService.getDropDown().subscribe(t=>{this.workTimes=t.data},t=>{console.log(t)})}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetDistricts(t){this.districtService.getByCityId(t).subscribe(i=>{this.districts=i.data},i=>{console.log(i)})}GetChannels(){this.channelService.getDropDown().subscribe(t=>{this.channels=t.data},t=>{console.log(t)})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,u.Q)(this.notifier)).subscribe(i=>{i?this.alertService.success():this.alertService.error("general.message."+i)},i=>{this.alertService.error()})}mapRegisterForm(t){let i={...t};return i.employeeCode=0,i}onSearch(){var t;if(this.ngxLoader.startLoader(f.a7),console.log(this.searchForm),null!=(t=this.searchForm.dates)&&"to"in t){const i=[t.from,t.to].map(n=>n);this.pagination.visitDateFrom=this.datePipe.transform(i[0],"yyyy-MM-ddT00:00:00"),this.pagination.visitDateTo=this.datePipe.transform(i[1],"yyyy-MM-ddT23:59:59.999")}else this.pagination.visitDateFrom=null,this.pagination.visitDateTo=null;if(null!=(t=this.searchForm.creationDates)&&"to"in t){const i=[t.from,t.to].map(n=>n);this.pagination.creationDateFrom=this.datePipe.transform(i[0],"yyyy-MM-ddT00:00:00"),this.pagination.creationDateTo=this.datePipe.transform(i[1],"yyyy-MM-ddT23:59:59.999")}else this.pagination.creationDateFrom=null,this.pagination.creationDateTo=null;this.pagination.subject=this.searchForm.name,null!=this.searchForm.status&&(this.pagination.status=Number.parseInt(this.searchForm.status)),null!=this.searchForm.priority&&(this.pagination.priority=Number.parseInt(this.searchForm.priority)),this.loadentities()}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems}}loadentities(){this.countLoad=this.countLoad+1,(!this.isResolveList||1!==this.countLoad)&&(this.ngxLoader.startLoader("cancalLoader"),this.pagination.statusFilter=this.OrderStatusEnum.Canceled,this.baseService.get(this.pagination).pipe((0,u.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader("cancalLoader"),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader("cancalLoader"),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}mapExcel(){let t=[];return this.entities.forEach(i=>{t.push({"Order Code":i.orderCode,"Created Date":i.createdDate,"Creation user":i.creationUser,"City Name":i.cityName,"District Name":i.districtName?i.districtName:"--",Status:this.translateService.instant(this.getTrnslate(i)),"Agent Name":i.agentName,Mobile:i.mobile,"Assigned To":i.teamNames,Times:i.workTimes,"Visit Date":i.visitDate,Services:i.services})}),t}reCallOrder(){this.ngxLoader.startLoader(f.Fq),this.baseService.UpdateCallCounter(this.orderSelected).pipe((0,Y.O)(),(0,P.c)(this.mainDelay),(0,H.Z)(),(0,u.Q)(this.notifier),(0,B.j)(()=>this.ngxLoader.stopLoader(f.Fq))).subscribe({next:t=>{this.modalService.dismissAll(),this.loadentities(),this.alertService.success()}})}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}goEdit(t){this.router.navigateByUrl("/managment/order/new")}getStatus(t){return t.isCancel?"bg-warning-subtle text-warning":t.isFinish?"bg-success-subtle text-success":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen||t.isFree?"bg-warning-subtle text-warning":"bg-success-subtle text-success"}getTrnslate(t){return t.isCancel?"orderManagement.order.cancel":t.isFinish?"orderManagement.order.finish":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen?"orderManagement.order.reopen":t.isFree?"orderManagement.order.free":"orderManagement.order.finished"}openModal(t,i,n="md"){this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}oncityChange(t){this.GetDistricts(t.code)}getTimes(t){return t.split(",")}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}getServices(t){return t.split("#")}OpenOrderTimeLineModel(t,i,n="md"){this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(_.nX),e.rXU(p.c$),e.rXU(k.Q),e.rXU(O.u),e.rXU(d.vh),e.rXU(C.eD),e.rXU(h.Bq),e.rXU(g.J),e.rXU(z.V),e.rXU(Q.h),e.rXU(te.m),e.rXU(ne.l),e.rXU(J.n),e.rXU(le.G),e.rXU(_.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-refundable-orders"]],features:[e.Vt3],decls:59,vars:64,consts:[["tableMaster",""],["deleteModal",""],["OrderTimeLineModel",""],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"reset","search","exportXlsx","showAdd","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","search","id","agentName","name","agentName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["InputTirmFilter","","type","search","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","code","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["name","name","bindValue","code","bindLabel","name",3,"change","ngModelChange","placeholder","items","multiple","ngModel"],["name","districtId","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["name","employeeCode","bindValue","name","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["pSortableColumn","orderCode","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["pSortableColumn","createdDate","translate","",2,"width","15%"],["pSortableColumn","cityName","translate","",2,"width","10%"],["pSortableColumn","agentName","translate","",2,"width","10%"],["translate","",2,"width","10%"],["pSortableColumn","visitDate","translate","",2,"width","8%"],["translate","",2,"width","20%"],["translate","",2,"width","15%"],[2,"width","10%"],[1,"fs-5"],[1,"code-pointer"],[1,"badge","bg-success-subtle","text-success"],["class","badge bg-danger-subtle text-danger","translate","orderManagement.order.nothing",4,"ngIf"],["class","badge bg-success-subtle text-success",4,"ngIf"],[1,"badge","bg-primary-subtle","text-primary","my-1"],[1,"cursor-pointer","badge","bg-danger-subtle","text-danger","fs-6",3,"click"],[1,"ri-clipboard-line"],[4,"ngFor","ngForOf"],[1,"d-inline"],[1,"ri-history-fill","d-inline","text-primary","fs-16","align-middle","me-1",3,"click"],["translate","orderManagement.order.nothing",1,"badge","bg-danger-subtle","text-danger"],[1,"badge","bg-primary-subtle","text-primary","mx-1"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"deleteConfirm","dismiss"],[3,"dismiss","orderSelected"]],template:function(i,n){if(1&i){const a=e.RV6();e.j41(0,"div",3)(1,"div",4)(2,"div",5),e.nrm(3,"ngx-ui-loader",6),e.j41(4,"base-filter",7),e.bIt("reset",function(){return e.eBV(a),e.Njj(n.onReset())})("search",function(){return e.eBV(a),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(a),e.Njj(n.onExportXlsx())}),e.qex(5,8),e.j41(6,"div",9)(7,"div",10)(8,"input",11),e.nI1(9,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.orderCode,s)||(n.pagination.orderCode=s),e.Njj(s)}),e.k0s(),e.nrm(10,"i",12),e.k0s()(),e.j41(11,"div",9)(12,"div",10)(13,"input",13),e.nI1(14,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.agentName,s)||(n.pagination.agentName=s),e.Njj(s)}),e.k0s(),e.nrm(15,"i",12),e.k0s()(),e.j41(16,"div",9)(17,"div",10)(18,"input",14),e.nI1(19,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.mobile,s)||(n.pagination.mobile=s),e.Njj(s)}),e.k0s(),e.nrm(20,"i",12),e.k0s()(),e.j41(21,"div",9)(22,"div",10)(23,"ng-select",15),e.nI1(24,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.channelCode,s)||(n.pagination.channelCode=s),e.Njj(s)}),e.k0s()()(),e.j41(25,"div",9)(26,"div",10)(27,"ng-select",16),e.nI1(28,"translate"),e.bIt("change",function(s){return e.eBV(a),e.Njj(n.oncityChange(s))}),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.cityCode,s)||(n.pagination.cityCode=s),e.Njj(s)}),e.k0s()()(),e.j41(29,"div",9)(30,"div",10)(31,"ng-select",17),e.nI1(32,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.districtId,s)||(n.pagination.districtId=s),e.Njj(s)}),e.k0s()()(),e.j41(33,"div",9)(34,"div",10)(35,"ng-select",18),e.nI1(36,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.teamName,s)||(n.pagination.teamName=s),e.Njj(s)}),e.k0s()()(),e.j41(37,"div",9)(38,"div",10)(39,"ng-select",18),e.nI1(40,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.workTimes,s)||(n.pagination.workTimes=s),e.Njj(s)}),e.k0s()()(),e.j41(41,"div",9)(42,"input",19),e.nI1(43,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.dates,s)||(n.searchForm.dates=s),e.Njj(s)}),e.k0s()(),e.j41(44,"div",9)(45,"input",19),e.nI1(46,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.creationDates,s)||(n.searchForm.creationDates=s),e.Njj(s)}),e.k0s()(),e.bVm(),e.k0s(),e.j41(47,"div",20)(48,"div",21)(49,"p-table",22,0),e.bIt("onLazyLoad",function(s){return e.eBV(a),e.Njj(n.tableChange(s))})("selectionChange",function(s){return e.eBV(a),e.Njj(n.onSelectionChange(s))}),e.DNE(51,Ui,25,0,"ng-template",23)(52,qi,34,19,"ng-template",24),e.k0s()(),e.DNE(53,Wi,2,0,"div",25)(54,Qi,6,8,"div",26),e.k0s()()()(),e.DNE(55,Ki,1,0,"ng-template",null,1,e.C5r)(57,Zi,1,1,"ng-template",null,2,e.C5r)}2&i&&(e.R7$(3),e.Y8G("loaderId","cancalLoader"),e.R7$(),e.Y8G("showAdd",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(9,44,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.orderCode),e.R7$(5),e.FS9("placeholder",e.bMT(14,46,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.agentName),e.R7$(5),e.FS9("placeholder",e.bMT(19,48,"orderManagement.order.mobile")),e.R50("ngModel",n.pagination.mobile),e.R7$(5),e.FS9("placeholder",e.bMT(24,50,"orderManagement.order.channelName")),e.Y8G("items",n.channels)("multiple",!1),e.R50("ngModel",n.pagination.channelCode),e.R7$(4),e.FS9("placeholder",e.bMT(28,52,"orderManagement.order.cityName")),e.Y8G("items",n.cities)("multiple",!1),e.R50("ngModel",n.pagination.cityCode),e.R7$(4),e.FS9("placeholder",e.bMT(32,54,"orderManagement.order.districtName")),e.Y8G("items",n.districts)("multiple",!1),e.R50("ngModel",n.pagination.districtId),e.R7$(4),e.FS9("placeholder",e.bMT(36,56,"orderManagement.order.teams")),e.Y8G("items",n.teams)("multiple",!1),e.R50("ngModel",n.pagination.teamName),e.R7$(4),e.FS9("placeholder",e.bMT(40,58,"orderManagement.order.workTimes")),e.Y8G("items",n.workTimes)("multiple",!1),e.R50("ngModel",n.pagination.workTimes),e.R7$(3),e.FS9("placeholder",e.bMT(43,60,"orderManagement.order.visitDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.dates),e.R7$(3),e.FS9("placeholder",e.bMT(46,62,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(4),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[d.Sq,d.bT,c.me,c.Q0,c.BC,c.vS,h.s5,j.kL,q.b,Ce.w,ie.p,re.g,p.Mm,x.XI,K.Ei,x.Tg,C.Cv,U.vr,W.m,me,d.vh,p.D9],encapsulation:2})}}return r})();const tr=()=>["reopen.assignTeam"],nr=()=>["reopen.cancel"];function ir(r,o){1&r&&(e.j41(0,"tr",28)(1,"th",29),e.nrm(2,"i",30),e.EFF(3," orderManagement.order.orderCode "),e.k0s(),e.j41(4,"th",31),e.nrm(5,"i",30),e.EFF(6," orderManagement.order.creation "),e.k0s(),e.j41(7,"th",32),e.nrm(8,"i",30),e.EFF(9," orderManagement.order.cityName "),e.k0s(),e.j41(10,"th",33),e.nrm(11,"i",30),e.EFF(12," orderManagement.order.agentName "),e.k0s(),e.j41(13,"th",34),e.EFF(14," orderManagement.order.assignTo "),e.k0s(),e.j41(15,"th",34),e.EFF(16," orderManagement.order.workTimes "),e.k0s(),e.j41(17,"th",35),e.nrm(18,"i",30),e.EFF(19," orderManagement.order.visitDate "),e.k0s(),e.j41(20,"th",36),e.EFF(21," orderManagement.order.services "),e.k0s(),e.j41(22,"th",36),e.EFF(23," orderManagement.order.returnReasonName "),e.k0s(),e.nrm(24,"th",37),e.k0s())}function rr(r,o){1&r&&e.nrm(0,"span",52)}function ar(r,o){if(1&r&&(e.j41(0,"span",41),e.EFF(1),e.k0s()),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI("",t.districtName," ")}}function sr(r,o){if(1&r&&(e.qex(0),e.j41(1,"span",53),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.bVm()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t)}}function or(r,o){if(1&r&&(e.qex(0),e.j41(1,"span",53),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.bVm()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t)}}function lr(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",54),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,a=e.XpG();return e.Njj(a.goEdit(n.orderCode))}),e.nrm(2,"i",55),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"orderManagement.order.reAssign"))}function dr(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",56),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,a=e.XpG(),l=e.sdS(56);return e.Njj(a.openModal(n.orderCode,l))}),e.nrm(2,"i",57),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"orderManagement.order.cancelOrder"))}function cr(r,o){if(1&r){const t=e.RV6();e.j41(0,"tr",38)(1,"td",39),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),l=e.sdS(58);return e.Njj(a.openModal(n.orderCode,l,"xxl"))}),e.j41(2,"bdi",40),e.EFF(3),e.k0s()(),e.j41(4,"td"),e.EFF(5),e.nI1(6,"date"),e.j41(7,"span",41),e.EFF(8),e.k0s()(),e.j41(9,"td"),e.EFF(10),e.DNE(11,rr,1,0,"span",42)(12,ar,2,1,"span",43),e.k0s(),e.j41(13,"td")(14,"span",44),e.EFF(15),e.k0s(),e.nrm(16,"br"),e.j41(17,"span",45),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.copytext(n.mobile))}),e.EFF(18),e.nrm(19,"i",46),e.k0s()(),e.j41(20,"td"),e.DNE(21,sr,4,1,"ng-container",47),e.k0s(),e.j41(22,"td"),e.DNE(23,or,4,1,"ng-container",47),e.k0s(),e.j41(24,"td"),e.EFF(25),e.nI1(26,"date"),e.k0s(),e.j41(27,"td"),e.EFF(28),e.k0s(),e.j41(29,"td"),e.EFF(30),e.k0s(),e.j41(31,"td")(32,"div",48)(33,"i",49),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),l=e.sdS(60);return e.Njj(a.OpenOrderTimeLineModel(n,l,"lg"))}),e.k0s(),e.DNE(34,lr,3,3,"button",50)(35,dr,3,3,"button",51),e.k0s()()()}if(2&r){const t=o.$implicit,i=e.XpG();e.R7$(3),e.SpI("#SO#",t.orderCode,""),e.R7$(2),e.SpI("",e.i5U(6,15,t.createdDate,"yyyy-MM-dd")," "),e.R7$(3),e.SpI("",t.creationUser," "),e.R7$(2),e.SpI("",t.cityName," "),e.R7$(),e.Y8G("ngIf",null==t.districtName),e.R7$(),e.Y8G("ngIf",null!==t.districtName),e.R7$(3),e.SpI("",t.agentName," "),e.R7$(3),e.SpI("",t.mobile," "),e.R7$(3),e.Y8G("ngForOf",i.getTimes(t.teamNames)),e.R7$(2),e.Y8G("ngForOf",i.getTimes(t.workTimes)),e.R7$(2),e.SpI(" ",e.i5U(26,18,t.visitDate,"yyyy-MM-dd"),""),e.R7$(3),e.SpI(" ",t.services,""),e.R7$(2),e.SpI(" ",t.returnReasonName,""),e.R7$(4),e.Y8G("hasPermission",e.lJ4(21,tr)),e.R7$(),e.Y8G("hasPermission",e.lJ4(22,nr))}}function mr(r,o){1&r&&(e.j41(0,"div",58),e.EFF(1," general.table.noData "),e.k0s())}function pr(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",59)(1,"div",60),e.nrm(2,"ngb-pagination-info",61),e.j41(3,"table-length",62),e.bIt("lengthChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",63)(5,"ngb-pagination",64),e.bIt("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.pagination.pageNumber,n)||(a.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function gr(r,o){if(1&r){const t=e.RV6();e.j41(0,"cancel-order-model",65),e.bIt("success",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.loadentities())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderId",t.orderSelected)}}function hr(r,o){if(1&r&&e.nrm(0,"order-operation",66),2&r){const t=e.XpG();e.Y8G("isReopen",!0)("isOrderEdit",!0)("isInner",!0)("orderCode",t.orderSelected)}}function ur(r,o){if(1&r){const t=e.RV6();e.j41(0,"order-timeline",67),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderSelected",t.orderSelected)}}let _r=(()=>{class r extends D.w{constructor(t,i,n,a,l,s,I,b,T,S,y,R,M,w,N){super(t,i,I,n,a,l,s),this.baseService=n,this.authDaamService=b,this.excelService=T,this.cityService=S,this.districtService=y,this.teamService=R,this.workTimeService=M,this.channelService=w,this.router=N,this.title="orderManagement.order.reopenTitle",this.titleOperation="orderManagement.order.reopenTitle",this.language=localStorage.getItem("language"),this.keySelected="",this.assignUsers=[],this.times=[],this.employees=[],this.searchForm={},this.isResolveList=!0,this.formPassword={},this.OrderStatusEnum=pe,this.roles=[],this.userTypes=[],this.teams=[],this.workTimes=[],this.actives=[{id:!0,name:"active"},{id:!1,name:"noActive"}],this.countLoad=2,this.orderSelected=0,this.cities=[],this.districts=[],this.channels=[],this.isOrderEdit=!0,this.setDates=(F,E,$)=>{if(F?.from||F?.to){const G=F.to||F.from;this.pagination[E]=this.datePipe.transform(F.from||F.to,"yyyy-MM-ddT00:00:00"),this.pagination[$]=this.datePipe.transform(G,"yyyy-MM-ddT23:59:59.999")}else this.pagination[E]=null,this.pagination[$]=null},this.GetCities(),this.GetChannels(),this.GetTeams(),this.GetTimes()}GetTeams(){this.teamService.getDropDown().subscribe(t=>{this.teams=t.data},t=>{console.log(t)})}GetTimes(){this.workTimeService.getDropDown().subscribe(t=>{this.workTimes=t.data},t=>{console.log(t)})}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetDistricts(t){this.districtService.getByCityId(t).subscribe(i=>{this.districts=i.data},i=>{console.log(i)})}GetChannels(){this.channelService.getDropDown().subscribe(t=>{this.channels=t.data},t=>{console.log(t)})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,u.Q)(this.notifier)).subscribe(i=>{i?this.alertService.success():this.alertService.error("general.message."+i)},i=>{this.alertService.error()})}mapRegisterForm(t){let i={...t};return i.employeeCode=0,i}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader(f.a7),this.setDates(t.dates,"visitDateFrom","visitDateTo"),this.setDates(t.creationDates,"creationDateFrom","creationDateTo"),this.loadentities()}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems}}loadentities(){this.countLoad=this.countLoad+1,(!this.isResolveList||1!==this.countLoad)&&(this.ngxLoader.startLoader("reopenLoader"),this.pagination.statusFilter=this.OrderStatusEnum.Reopened,this.baseService.get(this.pagination).pipe((0,u.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader("reopenLoader"),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader("reopenLoader"),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}mapExcel(){let t=[];return this.entities.forEach(i=>{t.push({"Order Code":i.orderCode,"Created Date":i.createdDate,"Creation user":i.creationUser,"City Name":i.cityName,"District Name":i.districtName?i.districtName:"--","Agent Name":i.agentName,Mobile:i.mobile,"Assigned To":i.teamNames,Times:i.workTimes,"Visit Date":i.visitDate,Services:i.services,Reason:i.returnReasonName})}),t}reCallOrder(){this.ngxLoader.startLoader(f.Fq),this.baseService.UpdateCallCounter(this.orderSelected).pipe((0,Y.O)(),(0,P.c)(this.mainDelay),(0,H.Z)(),(0,u.Q)(this.notifier),(0,B.j)(()=>this.ngxLoader.stopLoader(f.Fq))).subscribe({next:t=>{this.modalService.dismissAll(),this.loadentities(),this.alertService.success()}})}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}getStatus(t){return t.isCancel?"bg-warning-subtle text-warning":t.isFinish?"bg-success-subtle text-success":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen||t.isFree?"bg-warning-subtle text-warning":"bg-success-subtle text-success"}getTrnslate(t){return t.isCancel?"orderManagement.order.cancel":t.isFinish?"orderManagement.order.finish":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen?"orderManagement.order.reopen":t.isFree?"orderManagement.order.free":"orderManagement.order.finished"}openModal(t,i,n="md"){this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}oncityChange(t){this.GetDistricts(t.code)}getTimes(t){return t.split(",")}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}openEditOrderModal(t,i,n="md"){this.form={},this.isOrderEdit=!0,this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}OpenOrderTimeLineModel(t,i,n="md"){this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}goEdit(t){localStorage.setItem("orderCode",t),localStorage.setItem("isReopen","true");const i=this.router.serializeUrl(this.router.createUrlTree(["/order/new",t]));window.open(i,"_blank")}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(_.nX),e.rXU(p.c$),e.rXU(k.Q),e.rXU(O.u),e.rXU(d.vh),e.rXU(C.eD),e.rXU(h.Bq),e.rXU(g.J),e.rXU(z.V),e.rXU(Q.h),e.rXU(te.m),e.rXU(J.n),e.rXU(le.G),e.rXU(ne.l),e.rXU(_.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["reopen-order"]],features:[e.Vt3],decls:61,vars:64,consts:[["tableMaster",""],["deleteModal",""],["orderModel",""],["OrderTimeLineModel",""],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"reset","search","exportXlsx","showAdd","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","search","id","agentName","name","agentName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["InputTirmFilter","","type","search","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","code","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["name","name","bindValue","code","bindLabel","name",3,"change","ngModelChange","placeholder","items","multiple","ngModel"],["name","districtId","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["name","employeeCode","bindValue","name","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["pSortableColumn","orderCode","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["pSortableColumn","createdDate","translate","",2,"width","15%"],["pSortableColumn","cityName","translate","",2,"width","10%"],["pSortableColumn","agentName","translate","",2,"width","8%"],["translate","",2,"width","6%"],["pSortableColumn","visitDate","translate","",2,"width","8%"],["translate","",2,"width","15%"],[2,"width","10%"],[1,"fs-5"],[3,"click"],[1,"code-pointer"],[1,"badge","bg-success-subtle","text-success"],["class","badge bg-danger-subtle text-danger","translate","orderManagement.order.nothing",4,"ngIf"],["class","badge bg-success-subtle text-success",4,"ngIf"],[1,"badge","bg-primary-subtle","text-primary","my-1"],[1,"cursor-pointer","badge","bg-danger-subtle","text-danger","fs-6",3,"click"],[1,"ri-clipboard-line"],[4,"ngFor","ngForOf"],[1,"d-inline"],[1,"ri-history-fill","d-inline","text-primary","fs-16","align-middle","me-1",3,"click"],["tooltipPosition","top","class","mt-1 btn btn-sm btn-primary  mx-1","data-bs-toggle","modal",3,"pTooltip","click",4,"hasPermission"],["tooltipPosition","top","class","mt-1 btn btn-sm btn-soft-danger remove-list  mx-1",3,"pTooltip","click",4,"hasPermission"],["translate","orderManagement.order.nothing",1,"badge","bg-danger-subtle","text-danger"],[1,"badge","bg-primary-subtle","text-primary","mx-1"],["tooltipPosition","top","data-bs-toggle","modal",1,"mt-1","btn","btn-sm","btn-primary","mx-1",3,"click","pTooltip"],[1,"ri-checkbox-circle-line","align-bottom"],["tooltipPosition","top",1,"mt-1","btn","btn-sm","btn-soft-danger","remove-list","mx-1",3,"click","pTooltip"],[1,"ri-delete-bin-5-fill","align-bottom"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"success","dismiss","orderId"],[3,"isReopen","isOrderEdit","isInner","orderCode"],[3,"dismiss","orderSelected"]],template:function(i,n){if(1&i){const a=e.RV6();e.j41(0,"div",4)(1,"div",5)(2,"div",6),e.nrm(3,"ngx-ui-loader",7),e.j41(4,"base-filter",8),e.bIt("reset",function(){return e.eBV(a),e.Njj(n.onReset())})("search",function(){return e.eBV(a),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(a),e.Njj(n.onExportXlsx())}),e.qex(5,9),e.j41(6,"div",10)(7,"div",11)(8,"input",12),e.nI1(9,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.orderCode,s)||(n.pagination.orderCode=s),e.Njj(s)}),e.k0s(),e.nrm(10,"i",13),e.k0s()(),e.j41(11,"div",10)(12,"div",11)(13,"input",14),e.nI1(14,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.agentName,s)||(n.pagination.agentName=s),e.Njj(s)}),e.k0s(),e.nrm(15,"i",13),e.k0s()(),e.j41(16,"div",10)(17,"div",11)(18,"input",15),e.nI1(19,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.mobile,s)||(n.pagination.mobile=s),e.Njj(s)}),e.k0s(),e.nrm(20,"i",13),e.k0s()(),e.j41(21,"div",10)(22,"div",11)(23,"ng-select",16),e.nI1(24,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.channelCode,s)||(n.pagination.channelCode=s),e.Njj(s)}),e.k0s()()(),e.j41(25,"div",10)(26,"div",11)(27,"ng-select",17),e.nI1(28,"translate"),e.bIt("change",function(s){return e.eBV(a),e.Njj(n.oncityChange(s))}),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.cityCode,s)||(n.pagination.cityCode=s),e.Njj(s)}),e.k0s()()(),e.j41(29,"div",10)(30,"div",11)(31,"ng-select",18),e.nI1(32,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.districtId,s)||(n.pagination.districtId=s),e.Njj(s)}),e.k0s()()(),e.j41(33,"div",10)(34,"div",11)(35,"ng-select",19),e.nI1(36,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.teamName,s)||(n.pagination.teamName=s),e.Njj(s)}),e.k0s()()(),e.j41(37,"div",10)(38,"div",11)(39,"ng-select",19),e.nI1(40,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.workTimes,s)||(n.pagination.workTimes=s),e.Njj(s)}),e.k0s()()(),e.j41(41,"div",10)(42,"input",20),e.nI1(43,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.dates,s)||(n.searchForm.dates=s),e.Njj(s)}),e.k0s()(),e.j41(44,"div",10)(45,"input",20),e.nI1(46,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.creationDates,s)||(n.searchForm.creationDates=s),e.Njj(s)}),e.k0s()(),e.bVm(),e.k0s(),e.j41(47,"div",21)(48,"div",22)(49,"p-table",23,0),e.bIt("onLazyLoad",function(s){return e.eBV(a),e.Njj(n.tableChange(s))})("selectionChange",function(s){return e.eBV(a),e.Njj(n.onSelectionChange(s))}),e.DNE(51,ir,25,0,"ng-template",24)(52,cr,36,23,"ng-template",25),e.k0s()(),e.DNE(53,mr,2,0,"div",26)(54,pr,6,8,"div",27),e.k0s()()()(),e.DNE(55,gr,1,1,"ng-template",null,1,e.C5r)(57,hr,1,4,"ng-template",null,2,e.C5r)(59,ur,1,1,"ng-template",null,3,e.C5r)}2&i&&(e.R7$(3),e.Y8G("loaderId","reopenLoader"),e.R7$(),e.Y8G("showAdd",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(9,44,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.orderCode),e.R7$(5),e.FS9("placeholder",e.bMT(14,46,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.agentName),e.R7$(5),e.FS9("placeholder",e.bMT(19,48,"orderManagement.order.mobile")),e.R50("ngModel",n.pagination.mobile),e.R7$(5),e.FS9("placeholder",e.bMT(24,50,"orderManagement.order.channelName")),e.Y8G("items",n.channels)("multiple",!1),e.R50("ngModel",n.pagination.channelCode),e.R7$(4),e.FS9("placeholder",e.bMT(28,52,"orderManagement.order.cityName")),e.Y8G("items",n.cities)("multiple",!1),e.R50("ngModel",n.pagination.cityCode),e.R7$(4),e.FS9("placeholder",e.bMT(32,54,"orderManagement.order.districtName")),e.Y8G("items",n.districts)("multiple",!1),e.R50("ngModel",n.pagination.districtId),e.R7$(4),e.FS9("placeholder",e.bMT(36,56,"orderManagement.order.teams")),e.Y8G("items",n.teams)("multiple",!1),e.R50("ngModel",n.pagination.teamName),e.R7$(4),e.FS9("placeholder",e.bMT(40,58,"orderManagement.order.workTimes")),e.Y8G("items",n.workTimes)("multiple",!1),e.R50("ngModel",n.pagination.workTimes),e.R7$(3),e.FS9("placeholder",e.bMT(43,60,"orderManagement.order.visitDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.dates),e.R7$(3),e.FS9("placeholder",e.bMT(46,62,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(4),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[d.Sq,d.bT,c.me,c.Q0,c.BC,c.vS,h.s5,j.kL,q.b,ge.L,ie.p,re.g,p.Mm,x.XI,K.Ei,x.Tg,C.Cv,U.vr,W.m,v.p,de.m,Se,me,d.vh,p.D9]})}}return r})();const fr=()=>["order.view"],br=()=>["newOrder.view"],vr=()=>["urgented.view"],Cr=()=>["confirmed.view"],xr=()=>["assigned.view"],Ir=()=>["completed.view"],Fr=()=>["reopen.view"],Mr=()=>["canceled.view"];function jr(r,o){1&r&&e.nrm(0,"app-all-order")}function Tr(r,o){1&r&&(e.j41(0,"li",6)(1,"a",7),e.nrm(2,"span",8),e.k0s(),e.DNE(3,jr,1,0,"ng-template",9),e.k0s()),2&r&&e.Y8G("ngbNavItem",1)}function Sr(r,o){if(1&r&&(e.j41(0,"span",12),e.EFF(1),e.k0s()),2&r){const t=e.XpG(2);e.R7$(),e.JRh(null==t.count?null:t.count.orderNew)}}function kr(r,o){1&r&&e.nrm(0,"app-new-orders")}function yr(r,o){if(1&r&&(e.j41(0,"li",6)(1,"a",7),e.nrm(2,"span",10),e.DNE(3,Sr,2,1,"span",11),e.k0s(),e.DNE(4,kr,1,0,"ng-template",9),e.k0s()),2&r){const t=e.XpG();e.Y8G("ngbNavItem",2),e.R7$(3),e.Y8G("ngIf",0!=(null==t.count?null:t.count.orderNew))}}function Rr(r,o){if(1&r&&(e.j41(0,"span",12),e.EFF(1),e.k0s()),2&r){const t=e.XpG(2);e.R7$(),e.JRh(null==t.count?null:t.count.orderUrgent)}}function Er(r,o){1&r&&e.nrm(0,"app-urgent-orders")}function wr(r,o){if(1&r&&(e.j41(0,"li",6)(1,"a",7),e.nrm(2,"span",13),e.DNE(3,Rr,2,1,"span",11),e.k0s(),e.DNE(4,Er,1,0,"ng-template",9),e.k0s()),2&r){const t=e.XpG();e.Y8G("ngbNavItem",3),e.R7$(3),e.Y8G("ngIf",0!=(null==t.count?null:t.count.orderUrgent))}}function Nr(r,o){if(1&r&&(e.j41(0,"span",12),e.EFF(1),e.k0s()),2&r){const t=e.XpG(2);e.R7$(),e.JRh(null==t.count?null:t.count.orderConfirmed)}}function Dr(r,o){1&r&&e.nrm(0,"app-sure-orders")}function Or(r,o){if(1&r&&(e.j41(0,"li",6)(1,"a",7),e.nrm(2,"span",14),e.DNE(3,Nr,2,1,"span",11),e.k0s(),e.DNE(4,Dr,1,0,"ng-template",9),e.k0s()),2&r){const t=e.XpG();e.Y8G("ngbNavItem",4),e.R7$(3),e.Y8G("ngIf",0!=(null==t.count?null:t.count.orderConfirmed))}}function Vr(r,o){if(1&r&&(e.j41(0,"span",12),e.EFF(1),e.k0s()),2&r){const t=e.XpG(2);e.R7$(),e.JRh(null==t.count?null:t.count.orderAssign)}}function Gr(r,o){1&r&&e.nrm(0,"app-assigned-orders")}function Ar(r,o){if(1&r&&(e.j41(0,"li",6)(1,"a",7),e.nrm(2,"span",15),e.DNE(3,Vr,2,1,"span",11),e.k0s(),e.DNE(4,Gr,1,0,"ng-template",9),e.k0s()),2&r){const t=e.XpG();e.Y8G("ngbNavItem",5),e.R7$(3),e.Y8G("ngIf",0!=(null==t.count?null:t.count.orderAssign))}}function Lr(r,o){1&r&&e.nrm(0,"app-complete-orders")}function Br(r,o){1&r&&(e.j41(0,"li",6)(1,"a",7),e.nrm(2,"span",16),e.k0s(),e.DNE(3,Lr,1,0,"ng-template",9),e.k0s()),2&r&&e.Y8G("ngbNavItem",6)}function $r(r,o){if(1&r&&(e.j41(0,"span",12),e.EFF(1),e.k0s()),2&r){const t=e.XpG(2);e.R7$(),e.JRh(null==t.count?null:t.count.orderReopen)}}function Xr(r,o){1&r&&e.nrm(0,"reopen-order")}function Ur(r,o){if(1&r&&(e.j41(0,"li",6)(1,"a",7),e.nrm(2,"span",17),e.DNE(3,$r,2,1,"span",11),e.k0s(),e.DNE(4,Xr,1,0,"ng-template",9),e.k0s()),2&r){const t=e.XpG();e.Y8G("ngbNavItem",7),e.R7$(3),e.Y8G("ngIf",0!=(null==t.count?null:t.count.orderReopen))}}function Yr(r,o){1&r&&e.nrm(0,"app-refundable-orders")}function Pr(r,o){1&r&&(e.j41(0,"li",6)(1,"a",7),e.nrm(2,"span",18),e.k0s(),e.DNE(3,Yr,1,0,"ng-template",9),e.k0s()),2&r&&e.Y8G("ngbNavItem",8)}let Hr=(()=>{class r extends D.w{constructor(t,i,n,a,l,s,I,b){super(t,i,I,n,a,l,s),this.baseService=n,this.authDaamService=b,this.title="orderManagement.order.title",this.titleOperation="orderManagement.order.titleOperation",this.active=1,this.activeindex="1",this.count={},this.OrderCount()}OrderCount(){this.baseService.OrderCount().subscribe(t=>{this.count=t.data},t=>{console.log(t)})}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(_.nX),e.rXU(p.c$),e.rXU(k.Q),e.rXU(O.u),e.rXU(d.vh),e.rXU(C.eD),e.rXU(h.Bq),e.rXU(g.J))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-all-order-types"]],features:[e.Vt3],decls:13,vars:18,consts:[["nav","ngbNav"],[1,"row"],[1,"col-lg-12"],["ngbNav","",1,"nav","nav-tabs-custom","card-header-tabs","border-bottom-0",3,"activeIdChange","navChange","activeId"],[3,"ngbNavItem",4,"hasPermission"],[1,"mt-2",3,"ngbNavOutlet"],[3,"ngbNavItem"],["ngbNavLink",""],["translate","orderManagement.order.all"],["ngbNavContent",""],["translate","orderManagement.order.newOrders.title"],["class","ms-2 badge bg-success",4,"ngIf"],[1,"ms-2","badge","bg-success"],["translate","orderManagement.order.urgentOrders.title"],["translate","orderManagement.order.sureOrders.title"],["translate","orderManagement.order.assignedOrders.title"],["translate","orderManagement.order.completeOrders.title"],["translate","orderManagement.order.reopenTitle"],["translate","orderManagement.order.refundableOrders.title"]],template:function(i,n){if(1&i){const a=e.RV6();e.j41(0,"div",1)(1,"div",2)(2,"ul",3,0),e.mxI("activeIdChange",function(s){return e.eBV(a),e.DH7(n.active,s)||(n.active=s),e.Njj(s)}),e.bIt("navChange",function(s){return e.eBV(a),e.Njj(n.onNavChange(s))}),e.DNE(4,Tr,4,1,"li",4)(5,yr,5,2,"li",4)(6,wr,5,2,"li",4)(7,Or,5,2,"li",4)(8,Ar,5,2,"li",4)(9,Br,4,1,"li",4)(10,Ur,5,2,"li",4)(11,Pr,4,1,"li",4),e.k0s(),e.nrm(12,"div",5),e.k0s()()}if(2&i){const a=e.sdS(3);e.R7$(2),e.R50("activeId",n.active),e.R7$(2),e.Y8G("hasPermission",e.lJ4(10,fr)),e.R7$(),e.Y8G("hasPermission",e.lJ4(11,br)),e.R7$(),e.Y8G("hasPermission",e.lJ4(12,vr)),e.R7$(),e.Y8G("hasPermission",e.lJ4(13,Cr)),e.R7$(),e.Y8G("hasPermission",e.lJ4(14,xr)),e.R7$(),e.Y8G("hasPermission",e.lJ4(15,Ir)),e.R7$(),e.Y8G("hasPermission",e.lJ4(16,Fr)),e.R7$(),e.Y8G("hasPermission",e.lJ4(17,Mr)),e.R7$(),e.Y8G("ngbNavOutlet",a)}},dependencies:[d.bT,h.Um,h.X9,h.sy,h.Gx,h.Ri,h.WA,h.m_,p.Mm,v.p,Ct,Bt,mn,Vn,gi,Xi,er,_r],encapsulation:2})}}return r})();var Ee=m(26364),zr=m(80388);let Jr=(()=>{class r{constructor(){this.title="orderManagement.timeAvailable.title"}ngOnInit(){}onTimeSelected(t){console.log(t)}static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-timeAvailable"]],decls:3,vars:4,consts:[[3,"title","breadcrumbItems"],[3,"onTimeSelected"]],template:function(i,n){1&i&&(e.nrm(0,"app-breadcrumbs",0),e.nI1(1,"translate"),e.j41(2,"time-available",1),e.bIt("onTimeSelected",function(l){return n.onTimeSelected(l)}),e.k0s()),2&i&&(e.FS9("title",e.bMT(1,2,n.title)),e.Y8G("breadcrumbItems",n.breadCrumbItems))},dependencies:[Ee.m,zr.h,p.D9]})}}return r})();var xe=m(71100),Me=m(50949);let je=(()=>{class r{constructor(t,i,n,a){this.cancelReasonService=t,this.orderService=i,this.ngxLoader=n,this.alertService=a,this.cancelReasons=[],this.form={},this.orderId=0,this.loaderOperationShap=f.$$,this.operationLoader=f.ZW,this.notifier=new Be.B,this.success=new e.bkB,this.dismiss=new e.bkB}ngOnInit(){this.GetReturnReasons()}GetReturnReasons(){this.cancelReasonService.getDropDown().subscribe(t=>{this.cancelReasons=t.data},t=>{console.log(t)})}onCancelOrder(){let t={cancelReasonCode:this.form.cancelReasonCode,id:this.orderId};this.ngxLoader.startLoader(this.operationLoader),this.orderService.RemoveEvaluateOrder(t).pipe((0,u.Q)(this.notifier)).subscribe(i=>{this.ngxLoader.stopLoader(this.operationLoader),i.success?(this.alertService.success(),this.success.emit(!0),this.dismiss.emit(!0)):this.alertService.error()},()=>{this.alertService.error(),this.ngxLoader.stopLoader(this.operationLoader)})}dismissFn(){this.dismiss.emit(!0)}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(_e.e),e.rXU(xe.W),e.rXU(C.eD),e.rXU(O.u))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["cancel-evaluation-model"]],inputs:{orderId:"orderId"},outputs:{success:"success",dismiss:"dismiss"},decls:19,vars:10,consts:[["formEntity","ngForm"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["translate","orderManagement.order.cancelReasonName",1,"fw-bold","fs-4"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"hasProgressBar","fgsType","loaderId"],[3,"ngSubmit"],[1,"row"],[1,"mb-3"],["for","actionMismatch","translate","",1,"fw-bold","form-label"],["name","name","bindValue","code","bindLabel","name","required","",3,"ngModelChange","placeholder","items","multiple","ngModel"],[1,"text-center"],["type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"]],template:function(i,n){if(1&i){const a=e.RV6();e.j41(0,"div",1)(1,"div",2)(2,"h4",3),e.nrm(3,"span",4),e.k0s(),e.j41(4,"button",5),e.bIt("click",function(){return e.eBV(a),e.Njj(n.dismissFn())}),e.k0s()(),e.j41(5,"div",6),e.nrm(6,"ngx-ui-loader",7),e.j41(7,"form",8,0),e.bIt("ngSubmit",function(){return e.eBV(a),e.Njj(n.onCancelOrder())}),e.j41(9,"div",9)(10,"div",10)(11,"label",11),e.EFF(12,"orderManagement.order.cancelReasonName"),e.k0s(),e.j41(13,"ng-select",12),e.nI1(14,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.form.cancelReasonCode,s)||(n.form.cancelReasonCode=s),e.Njj(s)}),e.k0s()()(),e.j41(15,"div",13)(16,"button",14),e.nrm(17,"i",15)(18,"span",16),e.k0s()()()()()}if(2&i){const a=e.sdS(8);e.R7$(6),e.Y8G("hasProgressBar",!1)("fgsType",n.loaderOperationShap)("loaderId",n.operationLoader),e.R7$(7),e.FS9("placeholder",e.bMT(14,8,"orderManagement.order.cancelReasonName")),e.Y8G("items",n.cancelReasons)("multiple",!1),e.R50("ngModel",n.form.cancelReasonCode),e.R7$(3),e.Y8G("disabled",!a.valid)}},dependencies:[c.qT,c.BC,c.cb,c.YS,c.vS,c.cV,p.Mm,C.Cv,U.vr,p.D9],encapsulation:2})}}return r})();function qr(r,o){1&r&&(e.j41(0,"tr",30)(1,"th",31),e.EFF(2,"#"),e.k0s(),e.j41(3,"th",32),e.nrm(4,"i",33),e.EFF(5," orderManagement.order.orderCode "),e.k0s(),e.j41(6,"th",34),e.nrm(7,"i",33),e.EFF(8," general.table.creationTime "),e.k0s(),e.j41(9,"th",35),e.nrm(10,"i",33),e.EFF(11," orderManagement.order.agentName "),e.k0s(),e.j41(12,"th",36),e.nrm(13,"i",33),e.EFF(14," orderManagement.order.mobile "),e.k0s(),e.j41(15,"th",37),e.nrm(16,"i",33),e.EFF(17," orderManagement.order.cityName "),e.k0s(),e.j41(18,"th",38),e.nrm(19,"i",33),e.EFF(20," orderManagement.order.districtName "),e.k0s(),e.j41(21,"th",39),e.nrm(22,"i",33),e.EFF(23," orderManagement.priceEvaluation.status "),e.k0s(),e.nrm(24,"th",40),e.k0s())}function Wr(r,o){1&r&&e.nrm(0,"span",56)}function Qr(r,o){if(1&r&&(e.j41(0,"span",57),e.EFF(1),e.k0s()),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI("",t.districtName," ")}}function Kr(r,o){1&r&&e.nrm(0,"span",58)}function Zr(r,o){1&r&&e.nrm(0,"span",59)}function ea(r,o){if(1&r&&(e.nrm(0,"i",60),e.EFF(1),e.nI1(2,"date"),e.nrm(3,"br")(4,"i",61),e.EFF(5)),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",e.i5U(2,2,t.createdDate,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",t.name," ")}}function ta(r,o){if(1&r){const t=e.RV6();e.j41(0,"tr",41)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.nI1(7,"date"),e.j41(8,"span",42),e.EFF(9),e.k0s()(),e.j41(10,"td"),e.EFF(11),e.k0s(),e.j41(12,"td")(13,"span",43),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.copytext(n.mobile))}),e.EFF(14),e.nrm(15,"i",44),e.k0s()(),e.j41(16,"td"),e.EFF(17),e.k0s(),e.j41(18,"td"),e.DNE(19,Wr,1,0,"span",45)(20,Qr,2,1,"span",46),e.k0s(),e.j41(21,"td"),e.DNE(22,Kr,1,0,"span",47)(23,Zr,1,0,"span",48),e.k0s(),e.j41(24,"td"),e.DNE(25,ea,6,5,"ng-template",null,3,e.C5r),e.nrm(27,"i",49),e.j41(28,"button",50),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),l=e.sdS(43);return a.getEvalById(n.evaluationCode),e.Njj(a.openModal(n.evaluationCode,l,"lg"))}),e.nrm(29,"i",51)(30,"span",52),e.k0s(),e.j41(31,"button",53),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),l=e.sdS(41);return e.Njj(a.openModal(n.evaluationCode,l))}),e.nrm(32,"i",54)(33,"span",55),e.k0s()()()}if(2&r){const t=o.$implicit,i=o.rowIndex,n=e.sdS(26);e.R7$(2),e.JRh(i+1),e.R7$(2),e.SpI(" ",t.evaluationCode,""),e.R7$(2),e.SpI("",e.i5U(7,12,t.createdDate,"yyyy-MM-dd HH:mm")," "),e.R7$(3),e.SpI("",t.createdBy," "),e.R7$(2),e.JRh(t.agentName),e.R7$(3),e.SpI("",t.mobile," "),e.R7$(3),e.JRh(t.cityName),e.R7$(2),e.Y8G("ngIf",""==t.districtName),e.R7$(),e.Y8G("ngIf",""!==t.districtName),e.R7$(2),e.Y8G("ngIf",t.isUrgent),e.R7$(),e.Y8G("ngIf",!t.isUrgent),e.R7$(4),e.Y8G("ngbTooltip",n)}}function na(r,o){1&r&&(e.j41(0,"div",62),e.EFF(1," general.table.noData "),e.k0s())}function ia(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",63)(1,"div",64),e.nrm(2,"ngb-pagination-info",65),e.j41(3,"table-length",66),e.bIt("lengthChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",67)(5,"ngb-pagination",68),e.bIt("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.pagination.pageNumber,n)||(a.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function ra(r,o){if(1&r){const t=e.RV6();e.j41(0,"cancel-evaluation-model",69),e.bIt("success",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.loadentities())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderId",t.orderSelected)}}function aa(r,o){if(1&r&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s()()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t.serviceCode),e.R7$(2),e.JRh(t.price),e.R7$(2),e.JRh(t.notes)}}function sa(r,o){1&r&&(e.j41(0,"tr")(1,"td",103),e.EFF(2),e.nI1(3,"translate"),e.k0s()()),2&r&&(e.R7$(2),e.JRh(e.bMT(3,1,"orderManagement.order.noData")))}function oa(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",70)(1,"h4",71),e.nrm(2,"span",72),e.k0s(),e.j41(3,"button",73),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(4,"form",null,4),e.nrm(6,"ngx-ui-loader",74),e.j41(7,"div",75)(8,"div",76)(9,"div",77)(10,"div",7)(11,"div",78)(12,"label",79),e.EFF(13,"orderManagement.order.cityName"),e.k0s(),e.j41(14,"div",80),e.EFF(15),e.k0s()(),e.j41(16,"div",78)(17,"label",79),e.EFF(18,"orderManagement.order.districtName"),e.k0s(),e.j41(19,"div",80),e.EFF(20),e.k0s()(),e.j41(21,"div",78)(22,"label",81),e.EFF(23,"orderManagement.order.date"),e.k0s(),e.j41(24,"div",80),e.EFF(25),e.nI1(26,"date"),e.k0s()()(),e.j41(27,"div",82)(28,"div",83)(29,"table",84)(30,"thead")(31,"tr")(32,"th",85),e.EFF(33," orderManagement.order.service "),e.k0s(),e.j41(34,"th",85),e.EFF(35," orderManagement.order.price "),e.k0s(),e.j41(36,"th",85),e.EFF(37," orderManagement.order.notes "),e.k0s()()(),e.j41(38,"tbody"),e.DNE(39,aa,7,3,"tr",86)(40,sa,4,3,"tr",87),e.k0s()()()(),e.j41(41,"div",88)(42,"div",89)(43,"label",90),e.EFF(44),e.nI1(45,"translate"),e.k0s(),e.j41(46,"span",91),e.EFF(47),e.nI1(48,"translate"),e.nI1(49,"translate"),e.k0s()(),e.j41(50,"div",92)(51,"label",93),e.EFF(52,"orderManagement.order.notes"),e.k0s(),e.j41(53,"span",94),e.EFF(54),e.k0s()(),e.j41(55,"div",95)(56,"label",96),e.EFF(57,"orderManagement.order.assignDate"),e.k0s(),e.j41(58,"div",97)(59,"input",98,5),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.assignForm.assignDate,n)||(a.assignForm.assignDate=n),e.Njj(n)}),e.k0s()()(),e.j41(61,"div",95)(62,"label",96),e.EFF(63,"orderManagement.order.team"),e.k0s(),e.j41(64,"ng-select",99,6),e.nI1(66,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.assignForm.teamCode,n)||(a.assignForm.teamCode=n),e.Njj(n)}),e.k0s()()(),e.j41(67,"div",100)(68,"button",101),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.ChangeAssignTeam())}),e.k0s(),e.j41(69,"button",102),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()()}if(2&r){const t=e.XpG();e.R7$(6),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader),e.R7$(9),e.SpI(" ",t.evaluationDetails.cityName||"--"," "),e.R7$(5),e.SpI(" ",t.evaluationDetails.districtName||"--"," "),e.R7$(5),e.SpI(" ",e.i5U(26,16,t.evaluationDetails.visitDate,"yyyy-MM-dd")||"--"," "),e.R7$(14),e.Y8G("ngForOf",t.evaluationDetails.evaluationservices),e.R7$(),e.Y8G("ngIf",!t.evaluationDetails.evaluationservices),e.R7$(4),e.SpI(" ",e.bMT(45,19,"orderManagement.order.isUrgent")," "),e.R7$(3),e.SpI(" ",t.evaluationDetails.isUrgent?e.bMT(48,21,"orderManagement.order.yes"):e.bMT(49,23,"orderManagement.order.no")," "),e.R7$(7),e.SpI(" ",t.evaluationDetails.notes||"--"," "),e.R7$(5),e.R50("ngModel",t.assignForm.assignDate),e.R7$(5),e.FS9("placeholder",e.bMT(66,25,"orderManagement.order.team")),e.Y8G("items",t.teams)("multiple",!1),e.R50("ngModel",t.assignForm.teamCode)}}let la=(()=>{class r extends D.w{constructor(t,i,n,a,l,s,I,b,T,S,y,R,M,w){super(t,i,b,n,l,s,I),this.baseService=n,this.orderPendingService=a,this.authDaamService=T,this.excelService=S,this.cityService=y,this.districtService=R,this.channelService=M,this.router=w,this.title="orderManagement.priceEvaluation.title",this.titleOperation="orderManagement.priceEvaluation.titleOperation",this.keySelected="",this.assignUsers=[],this.times=[],this.teams=[],this.employees=[],this.searchForm={},this.assignForm={},this.isResolveList=!1,this.activeindex="1",this.active=1,this.formPassword={},this.roles=[],this.userTypes=[],this.actives=[{id:!0,name:"active"},{id:!1,name:"noActive"}],this.countLoad=3,this.orderSelected=0,this.selectedCallCounter=0,this.cities=[],this.districts=[],this.channels=[],this.callHistory={},this.GetCities(),this.getEvalTeams()}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetDistricts(t){this.districtService.getByCityId(t).subscribe(i=>{this.districts=i.data},i=>{console.log(i)})}GetChannels(){this.channelService.getDropDown().subscribe(t=>{this.channels=t.data},t=>{console.log(t)})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,u.Q)(this.notifier)).subscribe(i=>{i?this.alertService.success():this.alertService.error("general.message."+i)},i=>{this.alertService.error()})}mapRegisterForm(t){let i={...t};return i.employeeCode=0,i}onSearch(){var t;if(this.ngxLoader.startLoader(f.a7),console.log(this.searchForm),null!=(t=this.searchForm.dates)&&"to"in t){const i=[t.from,t.to].map(n=>n);this.pagination.visitDateFrom=this.datePipe.transform(i[0],"yyyy-MM-ddT00:00:00"),this.pagination.visitDateTo=this.datePipe.transform(i[1],"yyyy-MM-ddT23:59:59.999")}else this.pagination.visitDateFrom=null,this.pagination.visitDateTo=null;if(null!=(t=this.searchForm.creationDates)&&"to"in t){const i=[t.from,t.to].map(n=>n);this.pagination.creationDateFrom=this.datePipe.transform(i[0],"yyyy-MM-ddT00:00:00"),this.pagination.creationDateTo=this.datePipe.transform(i[1],"yyyy-MM-ddT23:59:59.999")}else this.pagination.creationDateFrom=null,this.pagination.creationDateTo=null;this.pagination.subject=this.searchForm.name,null!=this.searchForm.status&&(this.pagination.status=Number.parseInt(this.searchForm.status)),null!=this.searchForm.priority&&(this.pagination.priority=Number.parseInt(this.searchForm.priority)),this.loadentities()}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems}}loadentities(){this.countLoad=this.countLoad+1,(!this.isResolveList||1!==this.countLoad)&&(this.ngxLoader.startLoader("priceEvalLoader"),this.pagination.isEvaluationPrice=!0,this.baseService.get(this.pagination).pipe((0,u.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader("priceEvalLoader"),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader("priceEvalLoader"),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}mapExcel(){let t=[];return this.entities.forEach(i=>{t.push({orderCode:i.orderCode,visitDate:i.visitDate,notes:i.notes,createdDate:i.createdDate,assignDate:i.assignDate,finishDate:i.finishDate,districtName:i.districtName,cityName:i.cityName,agentName:i.agentName,mobile:i.mobile,email:i.email,creationUser:i.creationUser,channelName:i.channelName,teamNames:i.teamNames,services:i.services,workTimes:i.workTimes,paymentTypeName:i.paymentTypeName,finishUser:i.finishUser,isCancel:i.isCancel,isReopen:i.isReopen,isFree:i.isFree,isFinish:i.isFinish})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,"User",[])}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}goRegister(){this.router.navigateByUrl("/managment/order/new")}goEdit(t){this.router.navigateByUrl("/managment/order/new")}getStatus(t){return t.isCancel?"bg-warning-subtle text-warning":t.isFinish?"bg-success-subtle text-success":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen||t.isFree?"bg-warning-subtle text-warning":"bg-success-subtle text-success"}getTrnslate(t){return t.isCancel?"orderManagement.order.cancel":t.isFinish?"orderManagement.order.finish":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen?"orderManagement.order.reopen":t.isFree?"orderManagement.order.free":"orderManagement.order.finished"}openModal(t,i,n="md"){this.orderSelected=t,this.assignForm.code=t,this.modalService.open(i,{centered:!0,size:n})}oncityChange(t){this.GetDistricts(t.code)}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}getEvalById(t){this.baseService.getById(t).subscribe(i=>{this.evaluationDetails=i.data},()=>{this.alertService.error()})}getEvalTeams(){this.baseService.EvaluationLookUp().subscribe(t=>{this.teams=t.data.teams},()=>{this.alertService.error()})}ChangeAssignTeam(){this.ngxLoader.startLoader(f.Fq),this.baseService.ChangeAssignTeam(this.assignForm).subscribe(t=>{this.ngxLoader.stopLoader(f.Fq),this.loadentities(),this.modalService.dismissAll(),t.success?this.alertService.success():this.alertService.error("general.message."+t.message)},()=>{this.alertService.error()})}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(_.nX),e.rXU(p.c$),e.rXU(xe.W),e.rXU(Me.H),e.rXU(O.u),e.rXU(d.vh),e.rXU(C.eD),e.rXU(h.Bq),e.rXU(g.J),e.rXU(z.V),e.rXU(Q.h),e.rXU(te.m),e.rXU(ne.l),e.rXU(_.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["priceEvaluation"]],features:[e.Vt3],decls:44,vars:41,consts:[["tableMaster",""],["deleteModal",""],["evaluateModal",""],["tooltipContent",""],["formEntity","ngForm"],["assignDate","ngModel"],["teamCode","ngModel"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"reset","search","exportXlsx","addNew","showAllStr","showAdd","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","search","id","agentName","name","agentName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["InputTirmFilter","","type","tel","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","name","bindLabel","name",3,"change","ngModelChange","placeholder","items","multiple","ngModel"],["name","employeeCode","bindValue","name","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],[1,"col-12","col-md-4","mb-2"],["type","text","mwlFlatpickr","","id","isDate","mode","range",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["translate","",2,"width",".5%"],["pSortableColumn","evaluationCode","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["pSortableColumn","createdDate","translate","",2,"width","12%"],["pSortableColumn","agentCode","translate","",2,"width","10%"],["pSortableColumn","mobile","translate","",2,"width","10%"],["pSortableColumn","cityCode","translate","",2,"width","8%"],["pSortableColumn","districtCode","translate","",2,"width","8%"],["pSortableColumn","isUrgent","translate","",2,"width","8%"],["translate","",2,"width","15%"],[1,"fs-5"],[1,"badge","bg-primary-subtle","text-primary"],[1,"cursor-pointer","badge","bg-danger-subtle","text-danger","fs-6",3,"click"],[1,"ri-clipboard-line"],["class","badge bg-danger-subtle text-danger","translate","orderManagement.order.nothing",4,"ngIf"],["class","badge bg-success-subtle text-success",4,"ngIf"],["class","badge bg-danger-subtle text-danger","translate","orderManagement.priceEvaluation.isUrgent",4,"ngIf"],["class","badge bg-success-subtle text-success","translate","orderManagement.priceEvaluation.normal",4,"ngIf"],["tooltipPosition","top",1,"d-inline","text-primary","fs-10",3,"ngbTooltip"],["type","button",1,"btn","btn-sm","btn-success","w-sm","btn-label","waves-effect","waves-light","rounded-pill","p-0","py-1",3,"click"],[1,"ri-user-follow-fill","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","orderManagement.priceEvaluation.assign"],["type","button",1,"btn","btn-sm","btn-danger","w-sm","btn-label","waves-effect","waves-light","rounded-pill","p-0","mx-1","py-1",3,"click"],[1,"ri-chat-delete-fill","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","orderManagement.priceEvaluation.cancel"],["translate","orderManagement.order.nothing",1,"badge","bg-danger-subtle","text-danger"],[1,"badge","bg-success-subtle","text-success"],["translate","orderManagement.priceEvaluation.isUrgent",1,"badge","bg-danger-subtle","text-danger"],["translate","orderManagement.priceEvaluation.normal",1,"badge","bg-success-subtle","text-success"],[1,"ri-history-fill","text-warning"],[1,"ri-user-location-fill","text-primary"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"success","dismiss","orderId"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["translate","orderManagement.priceEvaluation.title",1,"fw-bold","fs-4"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[3,"hasProgressBar","fgsType","loaderId"],[1,"modal-content"],[1,"modal-body"],[1,"mx-4"],[1,"col-12","col-md-4","mb-3"],["translate","",1,"fw-bold","form-label","w-100"],[1,"form-control","w-100"],["for","visitDate","translate","",1,"fw-bold","form-label"],[1,"mt-4","row",2,"border-top","1px solid rgba(128,128,128,0.29)"],[1,"col-12","text-center","mt-4"],[1,"table","table-bordered"],["translate",""],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"mt-4","pt-3","row",2,"border-top","1px solid rgba(128,128,128,0.29)"],[1,"col-md-12","mb-3","d-flex"],[1,"fw-bold","form-label","w-25"],[1,"fw-bold","form-label","w-75"],[1,"col-12","col-md-12","mb-3","d-flex"],["translate","",1,"fw-bold","form-label","w-25"],[1,"fw-bold","form-label","w-75","form-control","py-3"],[1,"col-12","col-md-6","mb-3"],["for","assignDate","translate","",1,"fw-bold","form-label"],[1,"input-group"],["InputTirmFilter","","name","mobile","type","date","id","assignDate",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["name","teamCode","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],[1,"d-flex","gap-2","justify-content-end","mt-4","mb-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger",3,"click"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],["colspan","4"]],template:function(i,n){if(1&i){const a=e.RV6();e.j41(0,"div",7)(1,"div",8)(2,"div",9),e.nrm(3,"ngx-ui-loader",10),e.j41(4,"base-filter",11),e.bIt("reset",function(){return e.eBV(a),e.Njj(n.onReset())})("search",function(){return e.eBV(a),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(a),e.Njj(n.onExportXlsx())})("addNew",function(){return e.eBV(a),e.Njj(n.goRegister())}),e.qex(5,12),e.j41(6,"div",13)(7,"div",14)(8,"input",15),e.nI1(9,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.evaluationCode,s)||(n.pagination.evaluationCode=s),e.Njj(s)}),e.k0s(),e.nrm(10,"i",16),e.k0s()(),e.j41(11,"div",13)(12,"div",14)(13,"input",17),e.nI1(14,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.agentName,s)||(n.pagination.agentName=s),e.Njj(s)}),e.k0s(),e.nrm(15,"i",16),e.k0s()(),e.j41(16,"div",13)(17,"div",14)(18,"input",18),e.nI1(19,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.mobile,s)||(n.pagination.mobile=s),e.Njj(s)}),e.k0s(),e.nrm(20,"i",16),e.k0s()(),e.j41(21,"div",13)(22,"div",14)(23,"ng-select",19),e.nI1(24,"translate"),e.bIt("change",function(s){return e.eBV(a),e.Njj(n.oncityChange(s))}),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.cityName,s)||(n.pagination.cityName=s),e.Njj(s)}),e.k0s()()(),e.j41(25,"div",13)(26,"div",14)(27,"ng-select",20),e.nI1(28,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.districtName,s)||(n.pagination.districtName=s),e.Njj(s)}),e.k0s()()(),e.j41(29,"div",21)(30,"input",22),e.nI1(31,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.creationDates,s)||(n.searchForm.creationDates=s),e.Njj(s)}),e.k0s()(),e.bVm(),e.k0s(),e.j41(32,"div",23)(33,"div",24)(34,"p-table",25,0),e.bIt("onLazyLoad",function(s){return e.eBV(a),e.Njj(n.tableChange(s))})("selectionChange",function(s){return e.eBV(a),e.Njj(n.onSelectionChange(s))}),e.DNE(36,qr,25,0,"ng-template",26)(37,ta,34,15,"ng-template",27),e.k0s()(),e.DNE(38,na,2,0,"div",28)(39,ia,6,8,"div",29),e.k0s()()()(),e.DNE(40,ra,1,1,"ng-template",null,1,e.C5r)(42,oa,70,27,"ng-template",null,2,e.C5r)}2&i&&(e.R7$(3),e.Y8G("loaderId","priceEvalLoader"),e.R7$(),e.Y8G("showAllStr",!1)("showAdd",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(9,29,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.evaluationCode),e.R7$(5),e.FS9("placeholder",e.bMT(14,31,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.agentName),e.R7$(5),e.FS9("placeholder",e.bMT(19,33,"orderManagement.order.mobile")),e.R50("ngModel",n.pagination.mobile),e.R7$(5),e.FS9("placeholder",e.bMT(24,35,"orderManagement.order.cityName")),e.Y8G("items",n.cities)("multiple",!1),e.R50("ngModel",n.pagination.cityName),e.R7$(4),e.FS9("placeholder",e.bMT(28,37,"orderManagement.order.districtName")),e.Y8G("items",n.districts)("multiple",!1),e.R50("ngModel",n.pagination.districtName),e.R7$(3),e.FS9("placeholder",e.bMT(31,39,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(4),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[d.Sq,d.bT,c.qT,c.me,c.Q0,c.BC,c.cb,c.vS,c.cV,h.s5,j.kL,q.b,ie.p,re.g,p.Mm,x.XI,K.Ei,x.Tg,C.Cv,U.vr,h.md,W.m,je,d.vh,p.D9]})}}return r})();var we=m(67569),Ne=m(21626);let De=(()=>{class r extends we.d{constructor(t){super(t,ce.c.apiUrl+"OrderAssign/")}static{this.\u0275fac=function(i){return new(i||r)(e.KVO(Ne.Qq))}}static{this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();function da(r,o){1&r&&(e.j41(0,"tr",32)(1,"th",33),e.EFF(2,"#"),e.k0s(),e.j41(3,"th",34),e.nrm(4,"i",35),e.EFF(5," orderManagement.order.orderCode "),e.k0s(),e.j41(6,"th",36),e.nrm(7,"i",35),e.EFF(8," general.table.creationTime "),e.k0s(),e.j41(9,"th",37),e.nrm(10,"i",35),e.EFF(11," orderManagement.order.agentName "),e.k0s(),e.j41(12,"th",38),e.nrm(13,"i",35),e.EFF(14," orderManagement.order.mobile "),e.k0s(),e.j41(15,"th",39),e.nrm(16,"i",35),e.EFF(17," orderManagement.order.cityName "),e.k0s(),e.j41(18,"th",40),e.nrm(19,"i",35),e.EFF(20," orderManagement.order.districtName "),e.k0s(),e.j41(21,"th",41),e.nrm(22,"i",35),e.EFF(23," orderManagement.priceEvaluation.status "),e.k0s(),e.j41(24,"th",42),e.nrm(25,"i",35),e.EFF(26," orderManagement.order.teamName "),e.k0s(),e.j41(27,"th",43),e.nrm(28,"i",35),e.EFF(29," orderManagement.order.visitDate "),e.k0s(),e.nrm(30,"th",44),e.k0s())}function ca(r,o){1&r&&e.nrm(0,"span",68)}function ma(r,o){if(1&r&&(e.j41(0,"span",69),e.EFF(1),e.k0s()),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI("",t.districtName," ")}}function pa(r,o){1&r&&e.nrm(0,"span",70)}function ga(r,o){1&r&&e.nrm(0,"span",71)}function ha(r,o){if(1&r&&(e.nrm(0,"i",72),e.EFF(1),e.nI1(2,"date"),e.nrm(3,"br")(4,"i",73),e.EFF(5)),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",e.i5U(2,2,t.createdDate,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",t.name," ")}}function ua(r,o){if(1&r){const t=e.RV6();e.j41(0,"tr",45)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td")(4,"bdi"),e.EFF(5),e.k0s()(),e.j41(6,"td"),e.EFF(7),e.nI1(8,"date"),e.j41(9,"span",46),e.EFF(10),e.k0s()(),e.j41(11,"td"),e.EFF(12),e.k0s(),e.j41(13,"td")(14,"span",47),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.copytext(n.mobile))}),e.EFF(15),e.nrm(16,"i",48),e.k0s()(),e.j41(17,"td"),e.EFF(18),e.k0s(),e.j41(19,"td"),e.DNE(20,ca,1,0,"span",49)(21,ma,2,1,"span",50),e.k0s(),e.j41(22,"td"),e.DNE(23,pa,1,0,"span",51)(24,ga,1,0,"span",52),e.k0s(),e.j41(25,"td"),e.EFF(26),e.k0s(),e.j41(27,"td"),e.EFF(28),e.nI1(29,"date"),e.k0s(),e.j41(30,"td"),e.DNE(31,ha,6,5,"ng-template",null,5,e.C5r),e.nrm(33,"i",53),e.j41(34,"div",54)(35,"div",55)(36,"button",56),e.nrm(37,"i",57),e.k0s(),e.j41(38,"ul",58)(39,"li",59),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),l=e.sdS(45);return a.getEvalById(n.evaluationCode),e.Njj(a.openModal(n.evaluationCode,l,"lg"))}),e.j41(40,"a",60),e.nrm(41,"i",61)(42,"span",62),e.k0s()(),e.j41(43,"li",59),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),l=e.sdS(43);return a.getEvalById(n.evaluationCode),e.Njj(a.openModal(n.evaluationCode,l,"lg"))}),e.j41(44,"a",60),e.nrm(45,"i",63)(46,"span",64),e.k0s()(),e.j41(47,"li",59),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),l=e.sdS(41);return e.Njj(a.openModal(n.evaluationCode,l))}),e.j41(48,"a",60),e.nrm(49,"i",65)(50,"span",66),e.k0s()(),e.j41(51,"li",59),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),l=e.sdS(47);return e.Njj(a.openModal(n.evaluationCode,l))}),e.j41(52,"a",60),e.nrm(53,"i",65)(54,"span",67),e.k0s()()()()()()()}if(2&r){const t=o.$implicit,i=o.rowIndex,n=e.sdS(32);e.R7$(2),e.JRh(i+1),e.R7$(3),e.SpI("#SO#",t.evaluationCode,""),e.R7$(2),e.SpI("",e.i5U(8,14,t.createdDate,"yyyy-MM-dd HH:mm")," "),e.R7$(3),e.JRh(t.createdBy),e.R7$(2),e.JRh(t.agentName),e.R7$(3),e.SpI("",t.mobile," "),e.R7$(3),e.JRh(t.cityName),e.R7$(2),e.Y8G("ngIf",""==t.districtName),e.R7$(),e.Y8G("ngIf",""!==t.districtName),e.R7$(2),e.Y8G("ngIf",t.isUrgent),e.R7$(),e.Y8G("ngIf",!t.isUrgent),e.R7$(2),e.JRh(t.teamName),e.R7$(2),e.JRh(e.i5U(29,17,t.visitDate,"yyyy-MM-dd ")),e.R7$(5),e.Y8G("ngbTooltip",n)}}function _a(r,o){1&r&&(e.j41(0,"div",74),e.EFF(1," general.table.noData "),e.k0s())}function fa(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",75)(1,"div",76),e.nrm(2,"ngb-pagination-info",77),e.j41(3,"table-length",78),e.bIt("lengthChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",79)(5,"ngb-pagination",80),e.bIt("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.pagination.pageNumber,n)||(a.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function ba(r,o){if(1&r){const t=e.RV6();e.j41(0,"cancel-evaluation-model",81),e.bIt("success",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.loadentities())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderId",t.orderSelected)}}function va(r,o){if(1&r&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s()()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t.serviceCode),e.R7$(2),e.JRh(t.price),e.R7$(2),e.JRh(t.notes)}}function Ca(r,o){1&r&&(e.j41(0,"tr")(1,"td",115),e.EFF(2),e.nI1(3,"translate"),e.k0s()()),2&r&&(e.R7$(2),e.JRh(e.bMT(3,1,"orderManagement.order.noData")))}function xa(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",82)(1,"h4",83),e.nrm(2,"span",84),e.k0s(),e.j41(3,"button",85),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(4,"form",null,6),e.nrm(6,"ngx-ui-loader",86),e.j41(7,"div",87)(8,"div",88)(9,"div",89)(10,"div",9)(11,"div",90)(12,"label",91),e.EFF(13,"orderManagement.order.cityName"),e.k0s(),e.j41(14,"div",92),e.EFF(15),e.k0s()(),e.j41(16,"div",90)(17,"label",91),e.EFF(18,"orderManagement.order.districtName"),e.k0s(),e.j41(19,"div",92),e.EFF(20),e.k0s()(),e.j41(21,"div",90)(22,"label",93),e.EFF(23,"orderManagement.order.date"),e.k0s(),e.j41(24,"div",92),e.EFF(25),e.nI1(26,"date"),e.k0s()()(),e.j41(27,"div",94)(28,"div",95)(29,"table",96)(30,"thead")(31,"tr")(32,"th",97),e.EFF(33," orderManagement.order.service "),e.k0s(),e.j41(34,"th",97),e.EFF(35," orderManagement.order.price "),e.k0s(),e.j41(36,"th",97),e.EFF(37," orderManagement.order.notes "),e.k0s()()(),e.j41(38,"tbody"),e.DNE(39,va,7,3,"tr",98)(40,Ca,4,3,"tr",99),e.k0s()()()(),e.j41(41,"div",100)(42,"div",101)(43,"label",102),e.EFF(44),e.nI1(45,"translate"),e.k0s(),e.j41(46,"span",103),e.EFF(47),e.nI1(48,"translate"),e.nI1(49,"translate"),e.k0s()(),e.j41(50,"div",104)(51,"label",105),e.EFF(52,"orderManagement.order.notes"),e.k0s(),e.j41(53,"span",106),e.EFF(54),e.k0s()(),e.j41(55,"div",107)(56,"label",108),e.EFF(57,"orderManagement.order.assignDate"),e.k0s(),e.j41(58,"div",109)(59,"input",110,7),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.assignForm.assignDate,n)||(a.assignForm.assignDate=n),e.Njj(n)}),e.k0s()()(),e.j41(61,"div",107)(62,"label",108),e.EFF(63,"orderManagement.order.team"),e.k0s(),e.j41(64,"ng-select",111,8),e.nI1(66,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.assignForm.teamCode,n)||(a.assignForm.teamCode=n),e.Njj(n)}),e.k0s()()(),e.j41(67,"div",112)(68,"button",113),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.ChangeAssignTeam())}),e.k0s(),e.j41(69,"button",114),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()()}if(2&r){const t=e.XpG();e.R7$(6),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader),e.R7$(9),e.SpI(" ",t.evaluationDetails.cityName," "),e.R7$(5),e.SpI(" ",t.evaluationDetails.districtName," "),e.R7$(5),e.SpI(" ",e.i5U(26,16,t.evaluationDetails.visitDate,"yyyy-MM-dd")," "),e.R7$(14),e.Y8G("ngForOf",t.evaluationDetails.evaluationservices),e.R7$(),e.Y8G("ngIf",!t.evaluationDetails.evaluationservices),e.R7$(4),e.SpI(" ",e.bMT(45,19,"orderManagement.order.isUrgent")," "),e.R7$(3),e.SpI(" ",t.evaluationDetails.isUrgent?e.bMT(48,21,"orderManagement.order.yes"):e.bMT(49,23,"orderManagement.order.no")," "),e.R7$(7),e.SpI(" ",t.evaluationDetails.notes||"--"," "),e.R7$(5),e.R50("ngModel",t.assignForm.assignDate),e.R7$(5),e.FS9("placeholder",e.bMT(66,25,"orderManagement.order.team")),e.Y8G("items",t.teams)("multiple",!1),e.R50("ngModel",t.assignForm.teamCode)}}function Ia(r,o){if(1&r&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s()()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t.serviceCode),e.R7$(2),e.JRh(t.price),e.R7$(2),e.JRh(t.notes)}}function Fa(r,o){1&r&&(e.j41(0,"tr")(1,"td",115),e.EFF(2),e.nI1(3,"translate"),e.k0s()()),2&r&&(e.R7$(2),e.JRh(e.bMT(3,1,"orderManagement.order.noData")))}function Ma(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",82)(1,"h4",83),e.nrm(2,"span",116),e.k0s(),e.j41(3,"button",85),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(4,"form",null,6),e.nrm(6,"ngx-ui-loader",86),e.j41(7,"div",87)(8,"div",88)(9,"div",89)(10,"div",9)(11,"div",90)(12,"label",91),e.EFF(13,"orderManagement.order.cityName"),e.k0s(),e.j41(14,"div",92),e.EFF(15),e.k0s()(),e.j41(16,"div",90)(17,"label",91),e.EFF(18,"orderManagement.order.districtName"),e.k0s(),e.j41(19,"div",92),e.EFF(20),e.k0s()(),e.j41(21,"div",90)(22,"label",93),e.EFF(23,"orderManagement.order.date"),e.k0s(),e.j41(24,"div",92),e.EFF(25),e.nI1(26,"date"),e.k0s()()(),e.j41(27,"div",94)(28,"div",95)(29,"table",96)(30,"thead")(31,"tr")(32,"th",97),e.EFF(33," orderManagement.order.service "),e.k0s(),e.j41(34,"th",97),e.EFF(35," orderManagement.order.price "),e.k0s(),e.j41(36,"th",97),e.EFF(37," orderManagement.order.notes "),e.k0s()()(),e.j41(38,"tbody"),e.DNE(39,Ia,7,3,"tr",98)(40,Fa,4,3,"tr",99),e.k0s()()()(),e.j41(41,"div",100)(42,"div",101)(43,"label",102),e.EFF(44),e.nI1(45,"translate"),e.k0s(),e.j41(46,"span",103),e.EFF(47),e.nI1(48,"translate"),e.nI1(49,"translate"),e.k0s()(),e.j41(50,"div",104)(51,"label",105),e.EFF(52,"orderManagement.order.notes"),e.k0s(),e.j41(53,"span",106),e.EFF(54),e.k0s()()(),e.j41(55,"div",112)(56,"button",114),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()()}if(2&r){const t=e.XpG();e.R7$(6),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader),e.R7$(9),e.SpI(" ",t.evaluationDetails.cityName," "),e.R7$(5),e.SpI(" ",t.evaluationDetails.districtName," "),e.R7$(5),e.SpI(" ",e.i5U(26,11,t.evaluationDetails.visitDate,"yyyy-MM-dd")," "),e.R7$(14),e.Y8G("ngForOf",t.evaluationDetails.evaluationservices),e.R7$(),e.Y8G("ngIf",!t.evaluationDetails.evaluationservices),e.R7$(4),e.SpI(" ",e.bMT(45,14,"orderManagement.order.isUrgent")," "),e.R7$(3),e.SpI(" ",t.evaluationDetails.isUrgent?e.bMT(48,16,"orderManagement.order.yes"):e.bMT(49,18,"orderManagement.order.no")," "),e.R7$(7),e.SpI(" ",t.evaluationDetails.notes||"--"," ")}}function ja(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",82)(1,"h4",83),e.nrm(2,"span",117),e.k0s(),e.j41(3,"button",85),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(4,"form",null,6),e.nrm(6,"ngx-ui-loader",86),e.j41(7,"div",87)(8,"div",88)(9,"div",118),e.nrm(10,"lord-icon",119),e.j41(11,"div",120),e.nrm(12,"h3",121)(13,"p",122),e.k0s()(),e.j41(14,"div",123)(15,"button",113),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.FinishEvaluation())}),e.k0s(),e.j41(16,"button",114),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()}if(2&r){const t=e.XpG();e.R7$(6),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}let Ta=(()=>{class r extends D.w{constructor(t,i,n,a,l,s,I,b,T,S,y,R,M,w,N,F){super(t,i,T,n,s,I,b),this.baseService=n,this.orderPendingService=a,this.orderAssignService=l,this.authDaamService=S,this.excelService=y,this.cityService=R,this.districtService=M,this.channelService=w,this.cancelReasonService=N,this.router=F,this.title="orderManagement.assignEvaluation.title",this.titleOperation="orderManagement.assignEvaluation.titleOperation",this.keySelected="",this.assignUsers=[],this.times=[],this.teams=[],this.employees=[],this.searchForm={},this.assignForm={},this.isResolveList=!1,this.employeeGroups=[],this.activeindex="1",this.active=1,this.formPassword={},this.roles=[],this.userTypes=[],this.actives=[{id:!0,name:"active"},{id:!1,name:"noActive"}],this.countLoad=2,this.orderSelected=0,this.selectedCallCounter=0,this.cities=[],this.districts=[],this.channels=[],this.callHistory={},this.cancelReasons=[],this.GetCities(),this.getEvalTeams(),this.GetReturnReasons()}GetReturnReasons(){this.cancelReasonService.getDropDown().subscribe(t=>{this.cancelReasons=t.data},t=>{console.log(t)})}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetDistricts(t){this.districtService.getByCityId(t).subscribe(i=>{this.districts=i.data},i=>{console.log(i)})}GetChannels(){this.channelService.getDropDown().subscribe(t=>{this.channels=t.data},t=>{console.log(t)})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,u.Q)(this.notifier)).subscribe(i=>{i?this.alertService.success():this.alertService.error("general.message."+i)},i=>{this.alertService.error()})}mapRegisterForm(t){let i={...t};return i.employeeCode=0,i}onSearch(){var i;if(this.ngxLoader.startLoader(f.a7),console.log(this.searchForm),(i=this.searchForm.dates)+void 0&&i.includes("to")){var t=i.split("to").map(n=>n.trim());this.pagination.visitDateFrom=t[0]+"T00:00:00.000",this.pagination.visitDateTo=t[1]+"T23:59:59.999"}else this.pagination.visitDateFrom=null,this.pagination.visitDateTo=null;(i=this.searchForm.creationDates)+void 0&&i.includes("to")?(t=i.split("to").map(a=>a.trim()),this.pagination.creationDateFrom=t[0]+"T00:00:00.000",this.pagination.creationDateTo=t[1]+"T23:59:59.999"):(this.pagination.creationDateFrom=null,this.pagination.creationDateTo=null),this.pagination.subject=this.searchForm.name,null!=this.searchForm.status&&(this.pagination.status=Number.parseInt(this.searchForm.status)),null!=this.searchForm.priority&&(this.pagination.priority=Number.parseInt(this.searchForm.priority)),this.loadentities()}loadentities(){this.countLoad=this.countLoad+1,(!this.isResolveList||1!==this.countLoad)&&(this.ngxLoader.startLoader("assignEvalLoader"),this.pagination.isEvaluationAssign=!0,this.baseService.get(this.pagination).pipe((0,u.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader("assignEvalLoader"),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader("assignEvalLoader"),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}mapExcel(){let t=[];return this.entities.forEach(i=>{t.push({orderCode:i.orderCode,visitDate:i.visitDate,notes:i.notes,createdDate:i.createdDate,assignDate:i.assignDate,finishDate:i.finishDate,districtName:i.districtName,cityName:i.cityName,agentName:i.agentName,mobile:i.mobile,email:i.email,creationUser:i.creationUser,channelName:i.channelName,teamNames:i.teamNames,services:i.services,workTimes:i.workTimes,paymentTypeName:i.paymentTypeName,finishUser:i.finishUser,isCancel:i.isCancel,isReopen:i.isReopen,isFree:i.isFree,isFinish:i.isFinish})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,"User",[])}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}goRegister(){this.router.navigateByUrl("/managment/order/new")}goEdit(t){this.router.navigateByUrl("/managment/order/new")}getStatus(t){return t.isCancel?"bg-warning-subtle text-warning":t.isFinish?"bg-success-subtle text-success":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen||t.isFree?"bg-warning-subtle text-warning":"bg-success-subtle text-success"}getTrnslate(t){return t.isCancel?"orderManagement.order.cancel":t.isFinish?"orderManagement.order.finish":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen?"orderManagement.order.reopen":t.isFree?"orderManagement.order.free":"orderManagement.order.finished"}openModal(t,i,n="md"){this.orderSelected=t,this.assignForm.code=t,this.modalService.open(i,{centered:!0,size:n})}oncityChange(t){this.GetDistricts(t.code)}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}getEvalById(t){this.baseService.getById(t).subscribe(i=>{this.evaluationDetails=i.data,this.assignForm.teamCode=i.date.teamCode,this.assignForm.assignDate=i.date.assignDate},()=>{this.alertService.error()})}getEvalTeams(){this.baseService.EvaluationLookUp().subscribe(t=>{this.teams=t.data.teams},()=>{this.alertService.error()})}ChangeAssignTeam(){this.ngxLoader.startLoader(f.Fq),this.baseService.ChangeAssignTeam(this.assignForm).subscribe(t=>{this.ngxLoader.stopLoader(f.Fq),this.loadentities(),this.modalService.dismissAll(),t.success?this.alertService.success():this.alertService.error("general.message."+t.message)},()=>{this.alertService.error(),this.ngxLoader.stopLoader(f.Fq)})}FinishEvaluation(){this.ngxLoader.startLoader(f.Fq),this.baseService.SaveEvaluationFinish({}).subscribe(t=>{this.ngxLoader.stopLoader(f.Fq),this.loadentities(),this.modalService.dismissAll(),t.success?this.alertService.success():this.alertService.error("general.message."+t.message)},()=>{this.alertService.error(),this.ngxLoader.stopLoader(f.Fq)})}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(_.nX),e.rXU(p.c$),e.rXU(xe.W),e.rXU(Me.H),e.rXU(De),e.rXU(O.u),e.rXU(d.vh),e.rXU(C.eD),e.rXU(h.Bq),e.rXU(g.J),e.rXU(z.V),e.rXU(Q.h),e.rXU(te.m),e.rXU(ne.l),e.rXU(_e.e),e.rXU(_.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-assign-evaluation"]],features:[e.Vt3],decls:48,vars:41,consts:[["tableMaster",""],["deleteModal",""],["evaluateModal",""],["showModal",""],["finishModal",""],["tooltipContent",""],["formEntity","ngForm"],["assignDate","ngModel"],["teamCode","ngModel"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"reset","search","exportXlsx","addNew","showAllStr","showAdd","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","search","id","agentName","name","agentName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["InputTirmFilter","","type","tel","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","name","bindLabel","name",3,"change","ngModelChange","placeholder","items","multiple","ngModel"],["name","employeeCode","bindValue","name","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],[1,"col-12","col-md-4","mb-2"],["type","text","mwlFlatpickr","","id","isDate","mode","range",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["translate","",2,"width",".5%"],["pSortableColumn","evaluationCode","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["pSortableColumn","createdDate","translate","",2,"width","15%"],["pSortableColumn","agentCode","translate","",2,"width","10%"],["pSortableColumn","mobile","translate","",2,"width","10%"],["pSortableColumn","cityCode","translate","",2,"width","8%"],["pSortableColumn","districtCode","translate","",2,"width","8%"],["pSortableColumn","isUrgent","translate","",2,"width","8%"],["pSortableColumn","teamCode","translate","",2,"width","8%"],["pSortableColumn","visitDate","translate","",2,"width","8%"],["translate","",2,"width","15%"],[1,"fs-5"],[1,"badge","bg-primary-subtle","text-primary"],[1,"cursor-pointer","badge","bg-danger-subtle","text-danger","fs-6",3,"click"],[1,"ri-clipboard-line"],["class","badge bg-danger-subtle text-danger","translate","orderManagement.order.nothing",4,"ngIf"],["class","badge bg-success-subtle text-success",4,"ngIf"],["class","badge bg-danger-subtle text-danger","translate","orderManagement.priceEvaluation.isUrgent",4,"ngIf"],["class","badge bg-success-subtle text-success","translate","orderManagement.priceEvaluation.normal",4,"ngIf"],["tooltipPosition","top",1,"ri-history-fill","d-inline","text-primary","fs-16","align-middle","me-1",3,"ngbTooltip"],[1,"d-inline"],[1,"dropdown-custom"],["type","button",1,"btn","dropbtn","btn-soft-secondary","btn-sm","dropdown-custom","arrow-none"],[1,"ri-more-fill"],[1,"dropdown-menu","dropdown-menu-end","dropdown-content",2,"left","0"],[3,"click"],["href","javascript:void(0);",1,"dropdown-item"],[1,"ri-eye-fill","align-bottom","me-2","text-muted"],["translate","general.action.view"],[1,"ri-user-follow-fill","align-bottom","me-2","text-muted"],["translate","orderManagement.priceEvaluation.reassign"],[1,"ri-chat-delete-fill","align-bottom","me-2","text-muted"],["translate","orderManagement.priceEvaluation.cancel"],["translate","orderManagement.finishedEvaluation.finish"],["translate","orderManagement.order.nothing",1,"badge","bg-danger-subtle","text-danger"],[1,"badge","bg-success-subtle","text-success"],["translate","orderManagement.priceEvaluation.isUrgent",1,"badge","bg-danger-subtle","text-danger"],["translate","orderManagement.priceEvaluation.normal",1,"badge","bg-success-subtle","text-success"],[1,"ri-history-fill","text-warning"],[1,"ri-user-location-fill","text-primary"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"success","dismiss","orderId"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["translate","orderManagement.assignEvaluation.reassignEval",1,"fw-bold","fs-4"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[3,"hasProgressBar","fgsType","loaderId"],[1,"modal-content"],[1,"modal-body"],[1,"mx-4"],[1,"col-12","col-md-4","mb-3"],["translate","",1,"fw-bold","form-label","w-100"],[1,"form-control","w-100"],["for","visitDate","translate","",1,"fw-bold","form-label"],[1,"mt-4","row",2,"border-top","1px solid rgba(128,128,128,0.29)"],[1,"col-12","text-center","mt-4"],[1,"table","table-bordered"],["translate",""],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"mt-4","pt-3","row",2,"border-top","1px solid rgba(128,128,128,0.29)"],[1,"col-md-12","mb-3","d-flex"],[1,"fw-bold","form-label","w-25"],[1,"fw-bold","form-label","w-75"],[1,"col-12","col-md-12","mb-3","d-flex"],["translate","",1,"fw-bold","form-label","w-25"],[1,"fw-bold","form-label","w-75","form-control","py-3"],[1,"col-12","col-md-6","mb-3"],["for","assignDate","translate","",1,"fw-bold","form-label"],[1,"input-group"],["InputTirmFilter","","name","mobile","type","date","id","assignDate",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["name","teamCode","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],[1,"d-flex","gap-2","justify-content-end","mt-4","mb-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger",3,"click"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],["colspan","4"],["translate","orderManagement.assignEvaluation.title",1,"fw-bold","fs-4"],["translate","orderManagement.finishedEvaluation.title",1,"fw-bold","fs-4"],[1,"mt-2","text-center"],["src","https://cdn.lordicon.com/gdfrsvpt.json","stroke","bold","state","hover-oscillate","trigger","loop","colors","primary:#f7b84b,secondary:#f06548",2,"width","130px","height","130px"],[1,"pt-2","fs-15","mx-4","mx-sm-5"],["translate","orderManagement.order.AreYouSureMessage"],[1,"text-muted","mx-4","mb-0"],[1,"d-flex","gap-2","justify-content-center","mt-4","mb-2"]],template:function(i,n){if(1&i){const a=e.RV6();e.j41(0,"div",9)(1,"div",10)(2,"div",11),e.nrm(3,"ngx-ui-loader",12),e.j41(4,"base-filter",13),e.bIt("reset",function(){return e.eBV(a),e.Njj(n.onReset())})("search",function(){return e.eBV(a),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(a),e.Njj(n.onExportXlsx())})("addNew",function(){return e.eBV(a),e.Njj(n.goRegister())}),e.qex(5,14),e.j41(6,"div",15)(7,"div",16)(8,"input",17),e.nI1(9,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.evaluationCode,s)||(n.pagination.evaluationCode=s),e.Njj(s)}),e.k0s(),e.nrm(10,"i",18),e.k0s()(),e.j41(11,"div",15)(12,"div",16)(13,"input",19),e.nI1(14,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.agentName,s)||(n.pagination.agentName=s),e.Njj(s)}),e.k0s(),e.nrm(15,"i",18),e.k0s()(),e.j41(16,"div",15)(17,"div",16)(18,"input",20),e.nI1(19,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.mobile,s)||(n.pagination.mobile=s),e.Njj(s)}),e.k0s(),e.nrm(20,"i",18),e.k0s()(),e.j41(21,"div",15)(22,"div",16)(23,"ng-select",21),e.nI1(24,"translate"),e.bIt("change",function(s){return e.eBV(a),e.Njj(n.oncityChange(s))}),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.cityName,s)||(n.pagination.cityName=s),e.Njj(s)}),e.k0s()()(),e.j41(25,"div",15)(26,"div",16)(27,"ng-select",22),e.nI1(28,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.districtName,s)||(n.pagination.districtName=s),e.Njj(s)}),e.k0s()()(),e.j41(29,"div",23)(30,"input",24),e.nI1(31,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.creationDates,s)||(n.searchForm.creationDates=s),e.Njj(s)}),e.k0s()(),e.bVm(),e.k0s(),e.j41(32,"div",25)(33,"div",26)(34,"p-table",27,0),e.bIt("onLazyLoad",function(s){return e.eBV(a),e.Njj(n.tableChange(s))})("selectionChange",function(s){return e.eBV(a),e.Njj(n.onSelectionChange(s))}),e.DNE(36,da,31,0,"ng-template",28)(37,ua,55,20,"ng-template",29),e.k0s()(),e.DNE(38,_a,2,0,"div",30)(39,fa,6,8,"div",31),e.k0s()()()(),e.DNE(40,ba,1,1,"ng-template",null,1,e.C5r)(42,xa,70,27,"ng-template",null,2,e.C5r)(44,Ma,57,20,"ng-template",null,3,e.C5r)(46,ja,17,3,"ng-template",null,4,e.C5r)}2&i&&(e.R7$(3),e.Y8G("loaderId","assignEvalLoader"),e.R7$(),e.Y8G("showAllStr",!1)("showAdd",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(9,29,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.evaluationCode),e.R7$(5),e.FS9("placeholder",e.bMT(14,31,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.agentName),e.R7$(5),e.FS9("placeholder",e.bMT(19,33,"orderManagement.order.mobile")),e.R50("ngModel",n.pagination.mobile),e.R7$(5),e.FS9("placeholder",e.bMT(24,35,"orderManagement.order.cityName")),e.Y8G("items",n.cities)("multiple",!1),e.R50("ngModel",n.pagination.cityName),e.R7$(4),e.FS9("placeholder",e.bMT(28,37,"orderManagement.order.districtName")),e.Y8G("items",n.districts)("multiple",!1),e.R50("ngModel",n.pagination.districtName),e.R7$(3),e.FS9("placeholder",e.bMT(31,39,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(4),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[d.Sq,d.bT,c.qT,c.me,c.Q0,c.BC,c.cb,c.vS,c.cV,h.s5,j.kL,q.b,ie.p,re.g,p.Mm,x.XI,K.Ei,x.Tg,C.Cv,U.vr,h.md,W.m,je,d.vh,p.D9]})}}return r})();function Sa(r,o){1&r&&(e.j41(0,"tr",29)(1,"th",30),e.EFF(2,"#"),e.k0s(),e.j41(3,"th",31),e.nrm(4,"i",32),e.EFF(5," orderManagement.order.orderCode "),e.k0s(),e.j41(6,"th",33),e.nrm(7,"i",32),e.EFF(8," general.table.creationTime "),e.k0s(),e.j41(9,"th",34),e.nrm(10,"i",32),e.EFF(11," orderManagement.order.agentName "),e.k0s(),e.j41(12,"th",35),e.nrm(13,"i",32),e.EFF(14," orderManagement.order.mobile "),e.k0s(),e.j41(15,"th",36),e.nrm(16,"i",32),e.EFF(17," orderManagement.order.cityName "),e.k0s(),e.j41(18,"th",37),e.nrm(19,"i",32),e.EFF(20," orderManagement.order.districtName "),e.k0s(),e.j41(21,"th",38),e.nrm(22,"i",32),e.EFF(23," orderManagement.priceEvaluation.status "),e.k0s(),e.j41(24,"th",39),e.nrm(25,"i",32),e.EFF(26," orderManagement.order.teamName "),e.k0s(),e.j41(27,"th",40),e.nrm(28,"i",32),e.EFF(29," orderManagement.order.visitDate "),e.k0s(),e.j41(30,"th",41),e.nrm(31,"i",32),e.EFF(32," orderManagement.order.notes "),e.k0s(),e.nrm(33,"th",42),e.k0s())}function ka(r,o){1&r&&e.nrm(0,"span",51)}function ya(r,o){if(1&r&&(e.j41(0,"span",52),e.EFF(1),e.k0s()),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI("",t.districtName," ")}}function Ra(r,o){1&r&&e.nrm(0,"span",53)}function Ea(r,o){1&r&&e.nrm(0,"span",54)}function wa(r,o){if(1&r){const t=e.RV6();e.j41(0,"tr",43)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td")(4,"bdi"),e.EFF(5),e.k0s()(),e.j41(6,"td"),e.EFF(7),e.nI1(8,"date"),e.j41(9,"span",44),e.EFF(10),e.k0s()(),e.j41(11,"td"),e.EFF(12),e.k0s(),e.j41(13,"td")(14,"span",45),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.copytext(n.mobile))}),e.EFF(15),e.nrm(16,"i",46),e.k0s()(),e.j41(17,"td"),e.EFF(18),e.k0s(),e.j41(19,"td"),e.DNE(20,ka,1,0,"span",47)(21,ya,2,1,"span",48),e.k0s(),e.j41(22,"td"),e.DNE(23,Ra,1,0,"span",49)(24,Ea,1,0,"span",50),e.k0s(),e.j41(25,"td"),e.EFF(26),e.nI1(27,"date"),e.k0s(),e.j41(28,"td"),e.EFF(29),e.k0s()()}if(2&r){const t=o.$implicit,i=o.rowIndex;e.R7$(2),e.JRh(i+1),e.R7$(3),e.SpI("#SO#",t.evaluationCode,""),e.R7$(2),e.SpI("",e.i5U(8,13,t.createdDate,"yyyy-MM-dd HH:mm")," "),e.R7$(3),e.SpI("",t.createdBy," "),e.R7$(2),e.JRh(t.agentName),e.R7$(3),e.SpI("",t.mobile," "),e.R7$(3),e.JRh(t.cityName),e.R7$(2),e.Y8G("ngIf",""==t.districtName),e.R7$(),e.Y8G("ngIf",""!==t.districtName),e.R7$(2),e.Y8G("ngIf",t.isUrgent),e.R7$(),e.Y8G("ngIf",!t.isUrgent),e.R7$(2),e.JRh(e.i5U(27,16,t.visitDate,"yyyy-MM-dd HH:mm")),e.R7$(3),e.JRh(t.notes)}}function Na(r,o){1&r&&(e.j41(0,"div",55),e.EFF(1," general.table.noData "),e.k0s())}function Da(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",56)(1,"div",57),e.nrm(2,"ngb-pagination-info",58),e.j41(3,"table-length",59),e.bIt("lengthChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",60)(5,"ngb-pagination",61),e.bIt("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.pagination.pageNumber,n)||(a.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function Oa(r,o){if(1&r){const t=e.RV6();e.j41(0,"cancel-evaluation-model",62),e.bIt("success",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.loadentities())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderId",t.orderSelected)}}function Va(r,o){if(1&r&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s()()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t.serviceCode),e.R7$(2),e.JRh(t.price),e.R7$(2),e.JRh(t.notes)}}function Ga(r,o){1&r&&(e.j41(0,"tr")(1,"td",93),e.EFF(2),e.nI1(3,"translate"),e.k0s()()),2&r&&(e.R7$(2),e.JRh(e.bMT(3,1,"orderManagement.order.noData")))}function Aa(r,o){if(1&r){const t=e.RV6();e.j41(0,"form",null,3),e.nrm(2,"ngx-ui-loader",63),e.j41(3,"div",64)(4,"div",65)(5,"button",66),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"div",67)(7,"div",68)(8,"div",6)(9,"div",69)(10,"label",70),e.EFF(11,"orderManagement.order.cityName"),e.k0s(),e.j41(12,"div",71),e.EFF(13),e.k0s()(),e.j41(14,"div",69)(15,"label",70),e.EFF(16,"orderManagement.order.districtName"),e.k0s(),e.j41(17,"div",71),e.EFF(18),e.k0s()(),e.j41(19,"div",69)(20,"label",72),e.EFF(21,"orderManagement.order.date"),e.k0s(),e.j41(22,"div",71),e.EFF(23),e.nI1(24,"date"),e.k0s()()(),e.j41(25,"div",73)(26,"div",74)(27,"table",75)(28,"thead")(29,"tr")(30,"th",76),e.EFF(31," orderManagement.order.service "),e.k0s(),e.j41(32,"th",76),e.EFF(33," orderManagement.order.price "),e.k0s(),e.j41(34,"th",76),e.EFF(35," orderManagement.order.notes "),e.k0s()()(),e.j41(36,"tbody"),e.DNE(37,Va,7,3,"tr",77)(38,Ga,4,3,"tr",78),e.k0s()()()(),e.j41(39,"div",73)(40,"div",79)(41,"label",80),e.EFF(42),e.nI1(43,"translate"),e.k0s(),e.j41(44,"span",81),e.EFF(45),e.nI1(46,"translate"),e.nI1(47,"translate"),e.k0s()(),e.j41(48,"div",82)(49,"label",83),e.EFF(50,"orderManagement.order.notes"),e.k0s(),e.j41(51,"span",84),e.EFF(52),e.k0s()(),e.j41(53,"div",85)(54,"label",86),e.EFF(55,"orderManagement.order.assignDate"),e.k0s(),e.j41(56,"div",87)(57,"input",88,4),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.assignForm.assignDate,n)||(a.assignForm.assignDate=n),e.Njj(n)}),e.k0s()()(),e.j41(59,"div",85)(60,"label",86),e.EFF(61,"orderManagement.order.team"),e.k0s(),e.j41(62,"ng-select",89,5),e.nI1(64,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.assignForm.teamCode,n)||(a.assignForm.teamCode=n),e.Njj(n)}),e.k0s()()(),e.j41(65,"div",90)(66,"button",91),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.ChangeAssignTeam())}),e.k0s(),e.j41(67,"button",92),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader),e.R7$(11),e.SpI(" ",t.evaluationDetails.cityName," "),e.R7$(5),e.SpI(" ",t.evaluationDetails.districtName," "),e.R7$(5),e.SpI(" ",e.i5U(24,16,t.evaluationDetails.visitDate,"mediumDate")," "),e.R7$(14),e.Y8G("ngForOf",t.evaluationDetails.evaluationservices),e.R7$(),e.Y8G("ngIf",!t.evaluationDetails.evaluationservices),e.R7$(4),e.SpI(" ",e.bMT(43,19,"orderManagement.order.isUrgent")," "),e.R7$(3),e.SpI(" ",t.evaluationDetails.isUrgent?e.bMT(46,21,"orderManagement.order.yes"):e.bMT(47,23,"orderManagement.order.no")," "),e.R7$(7),e.SpI(" ",t.evaluationDetails.notes," "),e.R7$(5),e.R50("ngModel",t.assignForm.assignDate),e.R7$(5),e.FS9("placeholder",e.bMT(64,25,"orderManagement.order.team")),e.Y8G("items",t.teams)("multiple",!1),e.R50("ngModel",t.assignForm.teamCode)}}let La=(()=>{class r extends D.w{constructor(t,i,n,a,l,s,I,b,T,S,y,R,M,w){super(t,i,b,n,l,s,I),this.baseService=n,this.orderPendingService=a,this.authDaamService=T,this.excelService=S,this.cityService=y,this.districtService=R,this.channelService=M,this.router=w,this.title="orderManagement.finishedEvaluation.title",this.titleOperation="orderManagement.finishedEvaluation.titleOperation",this.keySelected="",this.assignUsers=[],this.times=[],this.teams=[],this.employees=[],this.searchForm={},this.assignForm={},this.isResolveList=!0,this.employeeGroups=[],this.activeindex="1",this.active=1,this.formPassword={},this.roles=[],this.userTypes=[],this.actives=[{id:!0,name:"active"},{id:!1,name:"noActive"}],this.countLoad=2,this.orderSelected=0,this.selectedCallCounter=0,this.cities=[],this.districts=[],this.channels=[],this.callHistory={},this.GetCities(),this.getEvalTeams()}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetDistricts(t){this.districtService.getByCityId(t).subscribe(i=>{this.districts=i.data},i=>{console.log(i)})}GetChannels(){this.channelService.getDropDown().subscribe(t=>{this.channels=t.data},t=>{console.log(t)})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,u.Q)(this.notifier)).subscribe(i=>{i?this.alertService.success():this.alertService.error("general.message."+i)},i=>{this.alertService.error()})}mapRegisterForm(t){let i={...t};return i.employeeCode=0,i}onSearch(){var i;if(this.ngxLoader.startLoader(f.a7),console.log(this.searchForm),(i=this.searchForm.dates)+void 0&&i.includes("to")){var t=i.split("to").map(n=>n.trim());this.pagination.visitDateFrom=t[0]+"T00:00:00.000",this.pagination.visitDateTo=t[1]+"T23:59:59.999",this.loadentities()}else this.pagination.visitDateFrom=null,this.pagination.visitDateTo=null;(i=this.searchForm.creationDates)+void 0&&i.includes("to")?(t=i.split("to").map(a=>a.trim()),this.pagination.creationDateFrom=t[0]+"T00:00:00.000",this.pagination.creationDateTo=t[1]+"T23:59:59.999",this.loadentities()):(this.pagination.creationDateFrom=null,this.pagination.creationDateTo=null),this.pagination.subject=this.searchForm.name,null!=this.searchForm.status&&(this.pagination.status=Number.parseInt(this.searchForm.status)),null!=this.searchForm.priority&&(this.pagination.priority=Number.parseInt(this.searchForm.priority)),this.loadentities(),this.loadentities()}loadentities(){this.countLoad=this.countLoad+1,(!this.isResolveList||1!==this.countLoad)&&(this.ngxLoader.startLoader("finishEvalLoader"),this.pagination.isEvaluationFinish=!0,this.baseService.get(this.pagination).pipe((0,u.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader("finishEvalLoader"),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader("finishEvalLoader"),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}mapExcel(){let t=[];return this.entities.forEach(i=>{t.push({orderCode:i.orderCode,visitDate:i.visitDate,notes:i.notes,createdDate:i.createdDate,assignDate:i.assignDate,finishDate:i.finishDate,districtName:i.districtName,cityName:i.cityName,agentName:i.agentName,mobile:i.mobile,email:i.email,creationUser:i.creationUser,channelName:i.channelName,teamNames:i.teamNames,services:i.services,workTimes:i.workTimes,paymentTypeName:i.paymentTypeName,finishUser:i.finishUser,isCancel:i.isCancel,isReopen:i.isReopen,isFree:i.isFree,isFinish:i.isFinish})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,"User",[])}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}goRegister(){this.router.navigateByUrl("/managment/order/new")}goEdit(t){this.router.navigateByUrl("/managment/order/new")}getStatus(t){return t.isCancel?"bg-warning-subtle text-warning":t.isFinish?"bg-success-subtle text-success":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen||t.isFree?"bg-warning-subtle text-warning":"bg-success-subtle text-success"}getTrnslate(t){return t.isCancel?"orderManagement.order.cancel":t.isFinish?"orderManagement.order.finish":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen?"orderManagement.order.reopen":t.isFree?"orderManagement.order.free":"orderManagement.order.finished"}openModal(t,i,n="md"){this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}oncityChange(t){this.GetDistricts(t.code)}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}getEvalById(t){this.baseService.getById(t).subscribe(i=>{this.evaluationDetails=i.data},()=>{this.alertService.error()})}getEvalTeams(){this.baseService.EvaluationLookUp().subscribe(t=>{this.teams=t.data.teams},()=>{this.alertService.error()})}ChangeAssignTeam(){this.baseService.ChangeAssignTeam(this.assignForm).subscribe(t=>{this.modalService.dismissAll(),t.success?this.alertService.success():this.alertService.error("general.message."+t.message)},()=>{this.alertService.error()})}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(_.nX),e.rXU(p.c$),e.rXU(xe.W),e.rXU(Me.H),e.rXU(O.u),e.rXU(d.vh),e.rXU(C.eD),e.rXU(h.Bq),e.rXU(g.J),e.rXU(z.V),e.rXU(Q.h),e.rXU(te.m),e.rXU(ne.l),e.rXU(_.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-all-finished-evaluation"]],features:[e.Vt3],decls:44,vars:41,consts:[["tableMaster",""],["deleteModal",""],["evaluateModal",""],["formEntity","ngForm"],["assignDate","ngModel"],["teamCode","ngModel"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"reset","search","exportXlsx","addNew","showAllStr","showAdd","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","search","id","agentName","name","agentName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["InputTirmFilter","","type","tel","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","name","bindLabel","name",3,"change","ngModelChange","placeholder","items","multiple","ngModel"],["name","employeeCode","bindValue","name","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],[1,"col-12","col-md-4","mb-2"],["type","text","mwlFlatpickr","","id","isDate","mode","range",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["translate","",2,"width",".5%"],["pSortableColumn","evaluationCode","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["pSortableColumn","createdDate","translate","",2,"width","15%"],["pSortableColumn","agentCode","translate","",2,"width","10%"],["pSortableColumn","mobile","translate","",2,"width","10%"],["pSortableColumn","cityCode","translate","",2,"width","8%"],["pSortableColumn","districtCode","translate","",2,"width","8%"],["pSortableColumn","isUrgent","translate","",2,"width","8%"],["pSortableColumn","teamCode","translate","",2,"width","8%"],["pSortableColumn","visitDate","translate","",2,"width","8%"],["pSortableColumn","notes","translate","",2,"width","8%"],["translate","",2,"width","15%"],[1,"fs-5"],[1,"badge","bg-primary-subtle","text-primary"],[1,"cursor-pointer","badge","bg-danger-subtle","text-danger","fs-6",3,"click"],[1,"ri-clipboard-line"],["class","badge bg-danger-subtle text-danger","translate","orderManagement.order.nothing",4,"ngIf"],["class","badge bg-success-subtle text-success",4,"ngIf"],["class","badge bg-danger-subtle text-danger","translate","orderManagement.priceEvaluation.isUrgent",4,"ngIf"],["class","badge bg-success-subtle text-success","translate","orderManagement.priceEvaluation.normal",4,"ngIf"],["translate","orderManagement.order.nothing",1,"badge","bg-danger-subtle","text-danger"],[1,"badge","bg-success-subtle","text-success"],["translate","orderManagement.priceEvaluation.isUrgent",1,"badge","bg-danger-subtle","text-danger"],["translate","orderManagement.priceEvaluation.normal",1,"badge","bg-success-subtle","text-success"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"success","dismiss","orderId"],[3,"hasProgressBar","fgsType","loaderId"],[1,"modal-content"],[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mx-4"],[1,"col-12","col-md-4","mb-3"],["translate","",1,"fw-bold","form-label","w-100"],[1,"form-control","w-100"],["for","visitDate","translate","",1,"fw-bold","form-label"],[1,"mt-5","row"],[1,"col-12","text-center","mt-4"],[1,"table","table-bordered"],["translate",""],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"col-md-12","mb-3","d-flex"],[1,"fw-bold","form-label","w-25"],[1,"fw-bold","form-label","w-75"],[1,"col-12","col-md-12","mb-3","d-flex"],["translate","",1,"fw-bold","form-label","w-25"],[1,"fw-bold","form-label","w-75","form-control","py-3"],[1,"col-12","col-md-6","mb-3"],["for","assignDate","translate","",1,"fw-bold","form-label"],[1,"input-group"],["InputTirmFilter","","name","mobile","type","date","id","assignDate",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["name","teamCode","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],[1,"d-flex","gap-2","justify-content-end","mt-4","mb-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger",3,"click"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],["colspan","4"]],template:function(i,n){if(1&i){const a=e.RV6();e.j41(0,"div",6)(1,"div",7)(2,"div",8),e.nrm(3,"ngx-ui-loader",9),e.j41(4,"base-filter",10),e.bIt("reset",function(){return e.eBV(a),e.Njj(n.onReset())})("search",function(){return e.eBV(a),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(a),e.Njj(n.onExportXlsx())})("addNew",function(){return e.eBV(a),e.Njj(n.goRegister())}),e.qex(5,11),e.j41(6,"div",12)(7,"div",13)(8,"input",14),e.nI1(9,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.evaluationCode,s)||(n.pagination.evaluationCode=s),e.Njj(s)}),e.k0s(),e.nrm(10,"i",15),e.k0s()(),e.j41(11,"div",12)(12,"div",13)(13,"input",16),e.nI1(14,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.agentName,s)||(n.pagination.agentName=s),e.Njj(s)}),e.k0s(),e.nrm(15,"i",15),e.k0s()(),e.j41(16,"div",12)(17,"div",13)(18,"input",17),e.nI1(19,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.mobile,s)||(n.pagination.mobile=s),e.Njj(s)}),e.k0s(),e.nrm(20,"i",15),e.k0s()(),e.j41(21,"div",12)(22,"div",13)(23,"ng-select",18),e.nI1(24,"translate"),e.bIt("change",function(s){return e.eBV(a),e.Njj(n.oncityChange(s))}),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.cityName,s)||(n.pagination.cityName=s),e.Njj(s)}),e.k0s()()(),e.j41(25,"div",12)(26,"div",13)(27,"ng-select",19),e.nI1(28,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.districtName,s)||(n.pagination.districtName=s),e.Njj(s)}),e.k0s()()(),e.j41(29,"div",20)(30,"input",21),e.nI1(31,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.creationDates,s)||(n.searchForm.creationDates=s),e.Njj(s)}),e.k0s()(),e.bVm(),e.k0s(),e.j41(32,"div",22)(33,"div",23)(34,"p-table",24,0),e.bIt("onLazyLoad",function(s){return e.eBV(a),e.Njj(n.tableChange(s))})("selectionChange",function(s){return e.eBV(a),e.Njj(n.onSelectionChange(s))}),e.DNE(36,Sa,34,0,"ng-template",25)(37,wa,30,19,"ng-template",26),e.k0s()(),e.DNE(38,Na,2,0,"div",27)(39,Da,6,8,"div",28),e.k0s()()()(),e.DNE(40,Oa,1,1,"ng-template",null,1,e.C5r)(42,Aa,68,27,"ng-template",null,2,e.C5r)}2&i&&(e.R7$(3),e.Y8G("loaderId","finishEvalLoader"),e.R7$(),e.Y8G("showAllStr",!1)("showAdd",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(9,29,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.evaluationCode),e.R7$(5),e.FS9("placeholder",e.bMT(14,31,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.agentName),e.R7$(5),e.FS9("placeholder",e.bMT(19,33,"orderManagement.order.mobile")),e.R50("ngModel",n.pagination.mobile),e.R7$(5),e.FS9("placeholder",e.bMT(24,35,"orderManagement.order.cityName")),e.Y8G("items",n.cities)("multiple",!1),e.R50("ngModel",n.pagination.cityName),e.R7$(4),e.FS9("placeholder",e.bMT(28,37,"orderManagement.order.districtName")),e.Y8G("items",n.districts)("multiple",!1),e.R50("ngModel",n.pagination.districtName),e.R7$(3),e.FS9("placeholder",e.bMT(31,39,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(4),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[d.Sq,d.bT,c.qT,c.me,c.Q0,c.BC,c.cb,c.vS,c.cV,h.s5,j.kL,q.b,ie.p,re.g,p.Mm,x.XI,K.Ei,x.Tg,C.Cv,U.vr,W.m,je,d.vh,p.D9]})}}return r})();function Ba(r,o){1&r&&(e.j41(0,"tr",29)(1,"th",30),e.EFF(2,"#"),e.k0s(),e.j41(3,"th",31),e.nrm(4,"i",32),e.EFF(5," orderManagement.order.orderCode "),e.k0s(),e.j41(6,"th",33),e.EFF(7," general.table.creationTime "),e.k0s(),e.j41(8,"th",34),e.EFF(9," orderManagement.order.agentName "),e.k0s(),e.j41(10,"th",34),e.EFF(11," orderManagement.order.mobile "),e.k0s(),e.j41(12,"th",35),e.EFF(13," orderManagement.order.cityName "),e.k0s(),e.j41(14,"th",35),e.EFF(15," orderManagement.order.districtName "),e.k0s(),e.j41(16,"th",35),e.EFF(17," orderManagement.priceEvaluation.status "),e.k0s(),e.j41(18,"th",34),e.EFF(19," orderManagement.order.cancelReasonName "),e.k0s()())}function $a(r,o){1&r&&e.nrm(0,"span",44)}function Xa(r,o){if(1&r&&(e.j41(0,"span",45),e.EFF(1),e.k0s()),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI("",t.districtName," ")}}function Ua(r,o){1&r&&e.nrm(0,"span",46)}function Ya(r,o){1&r&&e.nrm(0,"span",47)}function Pa(r,o){if(1&r){const t=e.RV6();e.j41(0,"tr",36)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td")(4,"bdi"),e.EFF(5),e.k0s()(),e.j41(6,"td"),e.EFF(7),e.nI1(8,"date"),e.j41(9,"span",37),e.EFF(10),e.k0s()(),e.j41(11,"td"),e.EFF(12),e.k0s(),e.j41(13,"td")(14,"span",38),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.copytext(n.mobile))}),e.EFF(15),e.nrm(16,"i",39),e.k0s()(),e.j41(17,"td"),e.EFF(18),e.k0s(),e.j41(19,"td"),e.DNE(20,$a,1,0,"span",40)(21,Xa,2,1,"span",41),e.k0s(),e.j41(22,"td"),e.DNE(23,Ua,1,0,"span",42)(24,Ya,1,0,"span",43),e.k0s(),e.j41(25,"td"),e.EFF(26),e.k0s()()}if(2&r){const t=o.$implicit,i=o.rowIndex;e.R7$(2),e.JRh(i+1),e.R7$(3),e.SpI("#SO#",t.evaluationCode,""),e.R7$(2),e.SpI("",e.i5U(8,12,t.createdDate,"yyyy-MM-dd HH:mm")," "),e.R7$(3),e.SpI("",t.createdBy," "),e.R7$(2),e.JRh(t.agentName),e.R7$(3),e.SpI("",t.mobile," "),e.R7$(3),e.JRh(t.cityName),e.R7$(2),e.Y8G("ngIf",""==t.districtName),e.R7$(),e.Y8G("ngIf",""!==t.districtName),e.R7$(2),e.Y8G("ngIf",t.isUrgent),e.R7$(),e.Y8G("ngIf",!t.isUrgent),e.R7$(2),e.JRh(t.cancelReasonName)}}function Ha(r,o){1&r&&(e.j41(0,"div",48),e.EFF(1," general.table.noData "),e.k0s())}function za(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",49)(1,"div",50),e.nrm(2,"ngb-pagination-info",51),e.j41(3,"table-length",52),e.bIt("lengthChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",53)(5,"ngb-pagination",54),e.bIt("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.pagination.pageNumber,n)||(a.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function Ja(r,o){if(1&r){const t=e.RV6();e.j41(0,"cancel-evaluation-model",55),e.bIt("success",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.loadentities())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderId",t.orderSelected)}}function qa(r,o){if(1&r&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s()()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t.serviceCode),e.R7$(2),e.JRh(t.price),e.R7$(2),e.JRh(t.notes)}}function Wa(r,o){1&r&&(e.j41(0,"tr")(1,"td",86),e.EFF(2),e.nI1(3,"translate"),e.k0s()()),2&r&&(e.R7$(2),e.JRh(e.bMT(3,1,"orderManagement.order.noData")))}function Qa(r,o){if(1&r){const t=e.RV6();e.j41(0,"form",null,3),e.nrm(2,"ngx-ui-loader",56),e.j41(3,"div",57)(4,"div",58)(5,"button",59),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"div",60)(7,"div",61)(8,"div",6)(9,"div",62)(10,"label",63),e.EFF(11,"orderManagement.order.cityName"),e.k0s(),e.j41(12,"div",64),e.EFF(13),e.k0s()(),e.j41(14,"div",62)(15,"label",63),e.EFF(16,"orderManagement.order.districtName"),e.k0s(),e.j41(17,"div",64),e.EFF(18),e.k0s()(),e.j41(19,"div",62)(20,"label",65),e.EFF(21,"orderManagement.order.date"),e.k0s(),e.j41(22,"div",64),e.EFF(23),e.nI1(24,"date"),e.k0s()()(),e.j41(25,"div",66)(26,"div",67)(27,"table",68)(28,"thead")(29,"tr")(30,"th",69),e.EFF(31," orderManagement.order.service "),e.k0s(),e.j41(32,"th",69),e.EFF(33," orderManagement.order.price "),e.k0s(),e.j41(34,"th",69),e.EFF(35," orderManagement.order.notes "),e.k0s()()(),e.j41(36,"tbody"),e.DNE(37,qa,7,3,"tr",70)(38,Wa,4,3,"tr",71),e.k0s()()()(),e.j41(39,"div",66)(40,"div",72)(41,"label",73),e.EFF(42),e.nI1(43,"translate"),e.k0s(),e.j41(44,"span",74),e.EFF(45),e.nI1(46,"translate"),e.nI1(47,"translate"),e.k0s()(),e.j41(48,"div",75)(49,"label",76),e.EFF(50,"orderManagement.order.notes"),e.k0s(),e.j41(51,"span",77),e.EFF(52),e.k0s()(),e.j41(53,"div",78)(54,"label",79),e.EFF(55,"orderManagement.order.assignDate"),e.k0s(),e.j41(56,"div",80)(57,"input",81,4),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.assignForm.assignDate,n)||(a.assignForm.assignDate=n),e.Njj(n)}),e.k0s()()(),e.j41(59,"div",78)(60,"label",79),e.EFF(61,"orderManagement.order.team"),e.k0s(),e.j41(62,"ng-select",82,5),e.nI1(64,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.assignForm.teamCode,n)||(a.assignForm.teamCode=n),e.Njj(n)}),e.k0s()()(),e.j41(65,"div",83)(66,"button",84),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.ChangeAssignTeam())}),e.k0s(),e.j41(67,"button",85),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader),e.R7$(11),e.SpI(" ",t.evaluationDetails.cityName," "),e.R7$(5),e.SpI(" ",t.evaluationDetails.districtName," "),e.R7$(5),e.SpI(" ",e.i5U(24,16,t.evaluationDetails.visitDate,"mediumDate")," "),e.R7$(14),e.Y8G("ngForOf",t.evaluationDetails.evaluationservices),e.R7$(),e.Y8G("ngIf",!t.evaluationDetails.evaluationservices),e.R7$(4),e.SpI(" ",e.bMT(43,19,"orderManagement.order.isUrgent")," "),e.R7$(3),e.SpI(" ",t.evaluationDetails.isUrgent?e.bMT(46,21,"orderManagement.order.yes"):e.bMT(47,23,"orderManagement.order.no")," "),e.R7$(7),e.SpI(" ",t.evaluationDetails.notes," "),e.R7$(5),e.R50("ngModel",t.assignForm.assignDate),e.R7$(5),e.FS9("placeholder",e.bMT(64,25,"orderManagement.order.team")),e.Y8G("items",t.teams)("multiple",!1),e.R50("ngModel",t.assignForm.teamCode)}}let Ka=(()=>{class r extends D.w{constructor(t,i,n,a,l,s,I,b,T,S,y,R,M,w){super(t,i,b,n,l,s,I),this.baseService=n,this.orderPendingService=a,this.authDaamService=T,this.excelService=S,this.cityService=y,this.districtService=R,this.channelService=M,this.router=w,this.title="orderManagement.canceledEvaluation.title",this.titleOperation="orderManagement.canceledEvaluation.titleOperation",this.keySelected="",this.assignUsers=[],this.times=[],this.teams=[],this.employees=[],this.searchForm={},this.assignForm={},this.isResolveList=!0,this.employeeGroups=[],this.activeindex="1",this.active=1,this.formPassword={},this.roles=[],this.userTypes=[],this.actives=[{id:!0,name:"active"},{id:!1,name:"noActive"}],this.countLoad=2,this.orderSelected=0,this.selectedCallCounter=0,this.cities=[],this.districts=[],this.channels=[],this.callHistory={},this.GetCities(),this.getEvalTeams()}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetDistricts(t){this.districtService.getByCityId(t).subscribe(i=>{this.districts=i.data},i=>{console.log(i)})}GetChannels(){this.channelService.getDropDown().subscribe(t=>{this.channels=t.data},t=>{console.log(t)})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,u.Q)(this.notifier)).subscribe(i=>{i?this.alertService.success():this.alertService.error("general.message."+i)},i=>{this.alertService.error()})}mapRegisterForm(t){let i={...t};return i.employeeCode=0,i}onSearch(){var i;if(this.ngxLoader.startLoader(f.a7),console.log(this.searchForm),(i=this.searchForm.dates)+void 0&&i.includes("to")){var t=i.split("to").map(n=>n.trim());this.pagination.visitDateFrom=t[0]+"T00:00:00.000",this.pagination.visitDateTo=t[1]+"T23:59:59.999",this.loadentities()}else this.pagination.visitDateFrom=null,this.pagination.visitDateTo=null;(i=this.searchForm.creationDates)+void 0&&i.includes("to")?(t=i.split("to").map(a=>a.trim()),this.pagination.creationDateFrom=t[0]+"T00:00:00.000",this.pagination.creationDateTo=t[1]+"T23:59:59.999",this.loadentities()):(this.pagination.creationDateFrom=null,this.pagination.creationDateTo=null),this.pagination.subject=this.searchForm.name,null!=this.searchForm.status&&(this.pagination.status=Number.parseInt(this.searchForm.status)),null!=this.searchForm.priority&&(this.pagination.priority=Number.parseInt(this.searchForm.priority)),this.loadentities(),this.loadentities()}loadentities(){this.countLoad=this.countLoad+1,(!this.isResolveList||1!==this.countLoad)&&(this.ngxLoader.startLoader("canceledLoader"),this.pagination.isEvaluationCancele=!0,this.baseService.get(this.pagination).pipe((0,u.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader("canceledLoader"),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader("canceledLoader"),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}mapExcel(){let t=[];return this.entities.forEach(i=>{t.push({orderCode:i.orderCode,visitDate:i.visitDate,notes:i.notes,createdDate:i.createdDate,assignDate:i.assignDate,finishDate:i.finishDate,districtName:i.districtName,cityName:i.cityName,agentName:i.agentName,mobile:i.mobile,email:i.email,creationUser:i.creationUser,channelName:i.channelName,teamNames:i.teamNames,services:i.services,workTimes:i.workTimes,paymentTypeName:i.paymentTypeName,finishUser:i.finishUser,isCancel:i.isCancel,isReopen:i.isReopen,isFree:i.isFree,isFinish:i.isFinish})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,"User",[])}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}goRegister(){this.router.navigateByUrl("/managment/order/new")}goEdit(t){this.router.navigateByUrl("/managment/order/new")}getStatus(t){return t.isCancel?"bg-warning-subtle text-warning":t.isFinish?"bg-success-subtle text-success":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen||t.isFree?"bg-warning-subtle text-warning":"bg-success-subtle text-success"}getTrnslate(t){return t.isCancel?"orderManagement.order.cancel":t.isFinish?"orderManagement.order.finish":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen?"orderManagement.order.reopen":t.isFree?"orderManagement.order.free":"orderManagement.order.finished"}openModal(t,i,n="md"){this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}oncityChange(t){this.GetDistricts(t.code)}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}getEvalById(t){this.baseService.getById(t).subscribe(i=>{this.evaluationDetails=i.data},()=>{this.alertService.error()})}getEvalTeams(){this.baseService.EvaluationLookUp().subscribe(t=>{this.teams=t.data.teams},()=>{this.alertService.error()})}ChangeAssignTeam(){this.baseService.ChangeAssignTeam(this.assignForm).subscribe(t=>{this.modalService.dismissAll(),t.success?this.alertService.success():this.alertService.error("general.message."+t.message)},()=>{this.alertService.error()})}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(_.nX),e.rXU(p.c$),e.rXU(xe.W),e.rXU(Me.H),e.rXU(O.u),e.rXU(d.vh),e.rXU(C.eD),e.rXU(h.Bq),e.rXU(g.J),e.rXU(z.V),e.rXU(Q.h),e.rXU(te.m),e.rXU(ne.l),e.rXU(_.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-canceled-evaluation"]],features:[e.Vt3],decls:44,vars:41,consts:[["tableMaster",""],["deleteModal",""],["evaluateModal",""],["formEntity","ngForm"],["assignDate","ngModel"],["teamCode","ngModel"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"reset","search","exportXlsx","addNew","showAllStr","showAdd","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","search","id","agentName","name","agentName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["InputTirmFilter","","type","tel","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","name","bindLabel","name",3,"change","ngModelChange","placeholder","items","multiple","ngModel"],["name","employeeCode","bindValue","name","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],[1,"col-12","col-md-4","mb-2"],["type","text","mwlFlatpickr","","id","isDate","mode","range",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["translate","",2,"width",".5%"],["pSortableColumn","orderCode","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["translate","",2,"width","12%"],["translate","",2,"width","10%"],["translate","",2,"width","8%"],[1,"fs-5"],[1,"badge","bg-primary-subtle","text-primary"],[1,"cursor-pointer","badge","bg-danger-subtle","text-danger","fs-6",3,"click"],[1,"ri-clipboard-line"],["class","badge bg-danger-subtle text-danger","translate","orderManagement.order.nothing",4,"ngIf"],["class","badge bg-success-subtle text-success",4,"ngIf"],["class","badge bg-danger-subtle text-danger","translate","orderManagement.priceEvaluation.isUrgent",4,"ngIf"],["class","badge bg-success-subtle text-success","translate","orderManagement.priceEvaluation.normal",4,"ngIf"],["translate","orderManagement.order.nothing",1,"badge","bg-danger-subtle","text-danger"],[1,"badge","bg-success-subtle","text-success"],["translate","orderManagement.priceEvaluation.isUrgent",1,"badge","bg-danger-subtle","text-danger"],["translate","orderManagement.priceEvaluation.normal",1,"badge","bg-success-subtle","text-success"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"success","dismiss","orderId"],[3,"hasProgressBar","fgsType","loaderId"],[1,"modal-content"],[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mx-4"],[1,"col-12","col-md-4","mb-3"],["translate","",1,"fw-bold","form-label","w-100"],[1,"form-control","w-100"],["for","visitDate","translate","",1,"fw-bold","form-label"],[1,"mt-5","row"],[1,"col-12","text-center","mt-4"],[1,"table","table-bordered"],["translate",""],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"col-md-12","mb-3","d-flex"],[1,"fw-bold","form-label","w-25"],[1,"fw-bold","form-label","w-75"],[1,"col-12","col-md-12","mb-3","d-flex"],["translate","",1,"fw-bold","form-label","w-25"],[1,"fw-bold","form-label","w-75","form-control","py-3"],[1,"col-12","col-md-6","mb-3"],["for","assignDate","translate","",1,"fw-bold","form-label"],[1,"input-group"],["InputTirmFilter","","name","mobile","type","date","id","assignDate",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["name","teamCode","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],[1,"d-flex","gap-2","justify-content-end","mt-4","mb-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger",3,"click"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],["colspan","4"]],template:function(i,n){if(1&i){const a=e.RV6();e.j41(0,"div",6)(1,"div",7)(2,"div",8),e.nrm(3,"ngx-ui-loader",9),e.j41(4,"base-filter",10),e.bIt("reset",function(){return e.eBV(a),e.Njj(n.onReset())})("search",function(){return e.eBV(a),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(a),e.Njj(n.onExportXlsx())})("addNew",function(){return e.eBV(a),e.Njj(n.goRegister())}),e.qex(5,11),e.j41(6,"div",12)(7,"div",13)(8,"input",14),e.nI1(9,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.evaluationCode,s)||(n.pagination.evaluationCode=s),e.Njj(s)}),e.k0s(),e.nrm(10,"i",15),e.k0s()(),e.j41(11,"div",12)(12,"div",13)(13,"input",16),e.nI1(14,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.agentName,s)||(n.pagination.agentName=s),e.Njj(s)}),e.k0s(),e.nrm(15,"i",15),e.k0s()(),e.j41(16,"div",12)(17,"div",13)(18,"input",17),e.nI1(19,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.mobile,s)||(n.pagination.mobile=s),e.Njj(s)}),e.k0s(),e.nrm(20,"i",15),e.k0s()(),e.j41(21,"div",12)(22,"div",13)(23,"ng-select",18),e.nI1(24,"translate"),e.bIt("change",function(s){return e.eBV(a),e.Njj(n.oncityChange(s))}),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.cityName,s)||(n.pagination.cityName=s),e.Njj(s)}),e.k0s()()(),e.j41(25,"div",12)(26,"div",13)(27,"ng-select",19),e.nI1(28,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.districtName,s)||(n.pagination.districtName=s),e.Njj(s)}),e.k0s()()(),e.j41(29,"div",20)(30,"input",21),e.nI1(31,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.creationDates,s)||(n.searchForm.creationDates=s),e.Njj(s)}),e.k0s()(),e.bVm(),e.k0s(),e.j41(32,"div",22)(33,"div",23)(34,"p-table",24,0),e.bIt("onLazyLoad",function(s){return e.eBV(a),e.Njj(n.tableChange(s))})("selectionChange",function(s){return e.eBV(a),e.Njj(n.onSelectionChange(s))}),e.DNE(36,Ba,20,0,"ng-template",25)(37,Pa,27,15,"ng-template",26),e.k0s()(),e.DNE(38,Ha,2,0,"div",27)(39,za,6,8,"div",28),e.k0s()()()(),e.DNE(40,Ja,1,1,"ng-template",null,1,e.C5r)(42,Qa,68,27,"ng-template",null,2,e.C5r)}2&i&&(e.R7$(3),e.Y8G("loaderId","canceledLoader"),e.R7$(),e.Y8G("showAllStr",!1)("showAdd",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(9,29,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.evaluationCode),e.R7$(5),e.FS9("placeholder",e.bMT(14,31,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.agentName),e.R7$(5),e.FS9("placeholder",e.bMT(19,33,"orderManagement.order.mobile")),e.R50("ngModel",n.pagination.mobile),e.R7$(5),e.FS9("placeholder",e.bMT(24,35,"orderManagement.order.cityName")),e.Y8G("items",n.cities)("multiple",!1),e.R50("ngModel",n.pagination.cityName),e.R7$(4),e.FS9("placeholder",e.bMT(28,37,"orderManagement.order.districtName")),e.Y8G("items",n.districts)("multiple",!1),e.R50("ngModel",n.pagination.districtName),e.R7$(3),e.FS9("placeholder",e.bMT(31,39,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(4),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[d.Sq,d.bT,c.qT,c.me,c.Q0,c.BC,c.cb,c.vS,c.cV,h.s5,j.kL,q.b,ie.p,re.g,p.Mm,x.XI,K.Ei,x.Tg,C.Cv,U.vr,W.m,je,d.vh,p.D9]})}}return r})();function Za(r,o){1&r&&e.nrm(0,"priceEvaluation")}function es(r,o){1&r&&e.nrm(0,"app-assign-evaluation")}function ts(r,o){1&r&&e.nrm(0,"app-all-finished-evaluation")}function ns(r,o){1&r&&e.nrm(0,"app-canceled-evaluation")}let is=(()=>{class r extends D.w{constructor(t,i,n,a,l,s,I,b){super(t,i,I,n,a,l,s),this.baseService=n,this.authDaamService=b,this.title="orderManagement.order.title",this.titleOperation="orderManagement.order.titleOperation",this.active=1,this.activeindex="2"}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(_.nX),e.rXU(p.c$),e.rXU(k.Q),e.rXU(O.u),e.rXU(d.vh),e.rXU(C.eD),e.rXU(h.Bq),e.rXU(g.J))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-all-eval-order"]],features:[e.Vt3],decls:21,vars:6,consts:[["nav","ngbNav"],[1,"row"],[1,"col-lg-12"],["ngbNav","",1,"nav","nav-tabs-custom","card-header-tabs","border-bottom-0",3,"activeIdChange","navChange","activeId"],[3,"ngbNavItem"],["ngbNavLink",""],["translate","orderManagement.order.priceEvaluation"],["ngbNavContent",""],["translate","orderManagement.order.assignEvaluation"],["translate","orderManagement.order.finishEvaluation"],["translate","orderManagement.order.canceledEvaluation"],[1,"mt-2",3,"ngbNavOutlet"]],template:function(i,n){if(1&i){const a=e.RV6();e.j41(0,"div",1)(1,"div",2)(2,"ul",3,0),e.mxI("activeIdChange",function(s){return e.eBV(a),e.DH7(n.active,s)||(n.active=s),e.Njj(s)}),e.bIt("navChange",function(s){return e.eBV(a),e.Njj(n.onNavChange(s))}),e.j41(4,"li",4)(5,"a",5),e.nrm(6,"span",6),e.k0s(),e.DNE(7,Za,1,0,"ng-template",7),e.k0s(),e.j41(8,"li",4)(9,"a",5),e.nrm(10,"span",8),e.k0s(),e.DNE(11,es,1,0,"ng-template",7),e.k0s(),e.j41(12,"li",4)(13,"a",5),e.nrm(14,"span",9),e.k0s(),e.DNE(15,ts,1,0,"ng-template",7),e.k0s(),e.j41(16,"li",4)(17,"a",5),e.nrm(18,"span",10),e.k0s(),e.DNE(19,ns,1,0,"ng-template",7),e.k0s()(),e.nrm(20,"div",11),e.k0s()()}if(2&i){const a=e.sdS(3);e.R7$(2),e.R50("activeId",n.active),e.R7$(2),e.Y8G("ngbNavItem",1),e.R7$(4),e.Y8G("ngbNavItem",2),e.R7$(4),e.Y8G("ngbNavItem",3),e.R7$(4),e.Y8G("ngbNavItem",4),e.R7$(4),e.Y8G("ngbNavOutlet",a)}},dependencies:[h.Um,h.X9,h.sy,h.Gx,h.Ri,h.WA,h.m_,p.Mm,la,Ta,La,Ka],encapsulation:2})}}return r})(),$e=(()=>{class r{constructor(){this.breadCrumbItems=[],this.addOrders="orderManagement.order.addOrders"}ngOnInit(){}static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["order-register"]],decls:1,vars:0,template:function(i,n){1&i&&e.nrm(0,"order-operation")},dependencies:[ge.L],encapsulation:2})}}return r})();var he=m(56701);let ke=(()=>{class r extends we.d{constructor(t){super(t,ce.c.apiUrl+"ExpensesItem/")}Delete(t){return this.http.delete(`${this.baseUrl}Delete/${t}`)}editExpensesItems(t,i){return this.http.put(this.baseUrl+"Edit/"+t,i)}static{this.\u0275fac=function(i){return new(i||r)(e.KVO(Ne.Qq))}}static{this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var Oe=m(54384);function rs(r,o){1&r&&(e.j41(0,"tr",24)(1,"th",25),e.EFF(2,"#"),e.k0s(),e.j41(3,"th",26),e.nrm(4,"i",27),e.EFF(5," orderManagement.expensesItems.name "),e.k0s(),e.j41(6,"th",28),e.nrm(7,"i",27),e.EFF(8," orderManagement.expensesItems.notes "),e.k0s(),e.j41(9,"th",28),e.nrm(10,"i",27),e.EFF(11," orderManagement.expensesItems.isActive "),e.k0s(),e.nrm(12,"th",29),e.k0s())}function as(r,o){1&r&&e.nrm(0,"span",37)}function ss(r,o){1&r&&e.nrm(0,"span",38)}function os(r,o){if(1&r){const t=e.RV6();e.j41(0,"tr",30)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.DNE(8,as,1,0,"span",31)(9,ss,1,0,"span",32),e.k0s(),e.j41(10,"td")(11,"button",33),e.nI1(12,"translate"),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),l=e.sdS(22);return e.Njj(a.editModal(n,l))}),e.nrm(13,"i",34),e.k0s(),e.j41(14,"button",35),e.nI1(15,"translate"),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),l=e.sdS(24);return e.Njj(a.openModal(n.expensesItemCode,l))}),e.nrm(16,"i",36),e.k0s()()()}if(2&r){const t=o.$implicit,i=o.rowIndex;e.R7$(2),e.JRh(i+1),e.R7$(2),e.JRh(t.expensesItemName),e.R7$(2),e.JRh(t.notes?t.notes:"--"),e.R7$(2),e.Y8G("ngIf",t.isActive),e.R7$(),e.Y8G("ngIf",!t.isActive),e.R7$(2),e.FS9("pTooltip",e.bMT(12,7,"general.edit")),e.R7$(3),e.FS9("pTooltip",e.bMT(15,9,"general.delete"))}}function ls(r,o){1&r&&(e.j41(0,"div",39),e.EFF(1," general.table.noData"),e.k0s())}function ds(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",40)(1,"div",41),e.nrm(2,"ngb-pagination-info",42),e.j41(3,"table-length",43),e.bIt("lengthChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",44)(5,"ngb-pagination",45),e.bIt("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.pagination.pageNumber,n)||(a.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function cs(r,o){1&r&&(e.j41(0,"span",67),e.EFF(1,"general.action.register "),e.k0s())}function ms(r,o){1&r&&(e.j41(0,"span",67),e.EFF(1,"general.action.edit "),e.k0s())}function ps(r,o){1&r&&(e.j41(0,"div",68),e.EFF(1," general.message.filedIdRequired"),e.k0s())}function gs(r,o){1&r&&(e.j41(0,"div",68),e.EFF(1," general.message.filedIdRequired"),e.k0s())}function hs(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",46)(1,"h4",47),e.DNE(2,cs,2,0,"span",48)(3,ms,2,0,"span",48),e.nrm(4,"span",49),e.k0s(),e.j41(5,"button",50),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"form",51,3),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onSubmit())}),e.nrm(8,"ngx-ui-loader",17),e.j41(9,"div",52)(10,"div",53)(11,"div",54)(12,"div",7)(13,"div",55)(14,"label",56),e.EFF(15,"orderManagement.expensesItems.name"),e.k0s(),e.j41(16,"div",57)(17,"input",58,4),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.form.expensesItemName,n)||(a.form.expensesItemName=n),e.Njj(n)}),e.k0s(),e.DNE(19,ps,2,0,"div",59),e.k0s()(),e.j41(20,"div",55)(21,"label",60),e.EFF(22,"orderManagement.expensesItems.notes"),e.k0s(),e.j41(23,"div",57)(24,"textarea",61,5),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.form.notes,n)||(a.form.notes=n),e.Njj(n)}),e.EFF(26,"                                "),e.k0s(),e.DNE(27,gs,2,0,"div",59),e.k0s()(),e.j41(28,"div",55)(29,"label",62),e.EFF(30,"orderManagement.expensesItems.isActive"),e.k0s(),e.j41(31,"p-inputSwitch",63),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.form.isActive,n)||(a.form.isActive=n),e.Njj(n)}),e.k0s()()(),e.j41(32,"div",64),e.nrm(33,"button",65),e.j41(34,"button",66),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()()}if(2&r){const t=e.sdS(7),i=e.sdS(18),n=e.sdS(25),a=e.XpG();e.R7$(2),e.Y8G("ngIf",!a.isEditForm),e.R7$(),e.Y8G("ngIf",a.isEditForm),e.R7$(5),e.Y8G("hasProgressBar",!1)("fgsType",a.loaderOperationShap)("loaderId",a.operationLoader),e.R7$(9),e.R50("ngModel",a.form.expensesItemName),e.R7$(2),e.Y8G("ngIf",i.invalid&&i.touched),e.R7$(5),e.R50("ngModel",a.form.notes),e.R7$(3),e.Y8G("ngIf",n.invalid&&n.touched),e.R7$(4),e.R50("ngModel",a.form.isActive),e.R7$(2),e.Y8G("disabled",!t.valid)}}function us(r,o){if(1&r){const t=e.RV6();e.j41(0,"delete-modal",69),e.bIt("deleteConfirm",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.DeleteConfirm())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}}let _s=(()=>{class r extends D.w{constructor(t,i,n,a,l,s,I,b,T,S){super(t,i,I,l,n,a,s),this.baseService=l,this.service=b,this.excelService=T,this.router=S,this.title="orderManagement.expensesItems.title",this.submitted=!1,this.cities={},this.channels={},this.leadTypes={},this.isResolveList=!0,this.configRoute()}configRoute(){this.routerActive.data.pipe((0,u.Q)(this.notifier)).subscribe(t=>{this.entities=t.data.data,this.pagination.totalItems=t.data.totalItems},()=>{this.alertService.error()})}onSubmit(){this.ngxLoader.startLoader(this.operationLoader),!0===this.isEditForm?this.editEntity():this.registerEntity()}onSearch(){this.ngxLoader.startLoader(this.searchLoader),this.loadentities()}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,"Service Type",[])}mapExcel(){let t=[];return this.entities?.forEach(i=>{t.push({title:i.title,body:i.body,type:i.type,isActive:this.getTranslationText("general.table.active")})}),t}editModal(t,i,n="md"){this.isEditForm=!0,this.form=t,this.modalService.open(i,{centered:!0,size:n})}editEntity(){let t=this.mapForm(this.form);this.baseService.editExpensesItems(t.expensesItemCode,t).pipe((0,Y.O)(),(0,P.c)(this.mainDelay),(0,H.Z)(),(0,u.Q)(this.notifier),(0,B.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(i=>{i.success?this.submitFunished():this.alertService.error("general.message."+i.message)},i=>{this.alertService.error("general.message."+i)})}DeleteConfirm(){console.log(this.selectedRow),this.ngxLoader.startLoader(this.deleteLoader),this.baseService.Delete(this.selectedRow[0].id).pipe((0,Y.O)(),(0,P.c)(this.mainDelay),(0,H.Z)(),(0,u.Q)(this.notifier),(0,B.j)(()=>this.ngxLoader.stopLoader(this.deleteLoader))).subscribe(i=>{i.success?(this.alertService.success(),this.loadentities(),this.modalService.dismissAll(),this.resetSelected()):this.alertService.error("general.message."+i)},()=>{this.alertService.error()})}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(_.nX),e.rXU(p.c$),e.rXU(O.u),e.rXU(d.vh),e.rXU(ke),e.rXU(C.eD),e.rXU(h.Bq),e.rXU(Oe.m),e.rXU(z.V),e.rXU(_.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-expenses-categories"]],features:[e.Vt3],decls:25,vars:19,consts:[["tableMaster",""],["whatsappModal",""],["deleteModal",""],["formEntity","ngForm"],["expensesItemName","ngModel"],["notes","ngModel"],[3,"title","breadcrumbItems"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],[3,"reset","search","exportXlsx","addNew","totalItems","title"],["control",""],[1,"col-12","col-md-6","mb-2"],[1,"search-box"],["InputTirmFilter","","type","search","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],[1,"card-body"],[3,"hasProgressBar","fgsType","loaderId"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["translate","",2,"width",".5%"],["pSortableColumn","name","translate","",2,"width","10%"],[1,"ri-expand-up-down-line"],["pSortableColumn","mobile","translate","",2,"width","10%"],["translate","",2,"width","20%"],[1,"fs-5"],["class","badge bg-success-subtle text-success p-2","translate","general.table.active",4,"ngIf"],["class","badge bg-danger-subtle text-danger p-2","translate","general.table.noActive",4,"ngIf"],["tooltipPosition","top",1,"btn","btn-sm","btn-soft-info","edit-list","mx-2",3,"click","pTooltip"],[1,"ri-pencil-fill","align-bottom","mx-1"],["tooltipPosition","top",1,"btn","btn-sm","btn-soft-danger","remove-list",3,"click","pTooltip"],[1,"ri-delete-bin-5-fill","align-bottom"],["translate","general.table.active",1,"badge","bg-success-subtle","text-success","p-2"],["translate","general.table.noActive",1,"badge","bg-danger-subtle","text-danger","p-2"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["class","fw-bold fs-4","translate","",4,"ngIf"],["translate","orderManagement.expensesItems.title",1,"fw-bold","fs-4"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[3,"ngSubmit"],[1,"modal-content"],[1,"modal-body"],[1,"mx-2"],[1,"col-12","col-md-12","mb-3"],["for","expensesItemName","translate","",1,"fw-bold","form-label","required"],[1,"input-group"],["InputTirmFilter","","name","expensesItemName","type","text","required","","id","expensesItemName",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["class","text-danger text-center  ","translate","",4,"ngIf"],["for","notes","translate","",1,"fw-bold","form-label","required"],["InputTirmFilter","","name","notes","rows","3","id","notes",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["for","isActive","translate","",1,"fw-bold","form-label","d-block"],["id","isActive","name","isActive","inputId","isActive",3,"ngModelChange","ngModel"],[1,"d-flex","gap-2","justify-content-end","mt-4","mb-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger",3,"disabled"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],["translate","",1,"fw-bold","fs-4"],["translate","",1,"text-danger","text-center"],[3,"deleteConfirm","dismiss"]],template:function(i,n){if(1&i){const a=e.RV6();e.nrm(0,"app-breadcrumbs",6),e.nI1(1,"translate"),e.j41(2,"div",7)(3,"div",8)(4,"div",9)(5,"base-filter",10),e.bIt("reset",function(){return e.eBV(a),e.Njj(n.onReset())})("search",function(){return e.eBV(a),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(a),e.Njj(n.onExportXlsx())})("addNew",function(){e.eBV(a);const s=e.sdS(22);return e.Njj(n.openModalTitle(s))}),e.qex(6,11),e.j41(7,"div",12)(8,"div",13)(9,"input",14),e.nI1(10,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.filterValue,s)||(n.pagination.filterValue=s),e.Njj(s)}),e.k0s(),e.nrm(11,"i",15),e.k0s()(),e.bVm(),e.k0s(),e.j41(12,"div",16),e.nrm(13,"ngx-ui-loader",17),e.j41(14,"div",18)(15,"p-table",19,0),e.bIt("onLazyLoad",function(s){return e.eBV(a),e.Njj(n.tableChange(s))})("selectionChange",function(s){return e.eBV(a),e.Njj(n.onSelectionChange(s))}),e.DNE(17,rs,13,0,"ng-template",20)(18,os,17,11,"ng-template",21),e.k0s()(),e.DNE(19,ls,2,0,"div",22)(20,ds,6,8,"div",23),e.k0s()()()(),e.DNE(21,hs,35,11,"ng-template",null,1,e.C5r)(23,us,1,0,"ng-template",null,2,e.C5r)}2&i&&(e.FS9("title",e.bMT(1,15,n.title)),e.Y8G("breadcrumbItems",n.breadCrumbItems),e.R7$(5),e.Y8G("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(10,17,"task.tasklist.subject")),e.R50("ngModel",n.pagination.filterValue),e.R7$(4),e.Y8G("hasProgressBar",!1)("fgsType",n.loaderSearchShap)("loaderId",n.searchLoader),e.R7$(2),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[d.bT,c.qT,c.me,c.BC,c.cb,c.YS,c.vS,c.cV,h.s5,Ee.m,q.b,Ce.w,ie.p,re.g,p.Mm,x.XI,K.Ei,x.Tg,ve.HW,C.Cv,W.m,de.m,p.D9],encapsulation:2})}}return r})();var Ve=m(56131);let fs=(()=>{class r extends Ve.E{constructor(t,i,n){super(t,i,n)}static{this.\u0275fac=function(i){return new(i||r)(e.KVO(_.Ix),e.KVO(ke),e.KVO(O.u))}}static{this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var Ge=m(99437),Xe=m(18810);let Ae=(()=>{class r extends we.d{constructor(t){super(t,ce.c.apiUrl+"ExpensesOrder/")}Delete(t){return this.http.delete(`${this.baseUrl}Delete/${t}`)}editExpensesItems(t,i){return this.http.put(this.baseUrl+"Edit/"+t,i)}static{this.\u0275fac=function(i){return new(i||r)(e.KVO(Ne.Qq))}}static{this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();function bs(r,o){1&r&&(e.j41(0,"tr",28)(1,"th",29),e.EFF(2,"#"),e.k0s(),e.j41(3,"th",30),e.nrm(4,"i",31),e.EFF(5," orderManagement.expensesOrders.code "),e.k0s(),e.j41(6,"th",32),e.nrm(7,"i",31),e.EFF(8," orderManagement.expensesOrders.expensesItem "),e.k0s(),e.j41(9,"th",32),e.nrm(10,"i",31),e.EFF(11," orderManagement.expensesOrders.date "),e.k0s(),e.j41(12,"th",32),e.nrm(13,"i",31),e.EFF(14," orderManagement.expensesOrders.price "),e.k0s(),e.j41(15,"th",32),e.nrm(16,"i",31),e.EFF(17," orderManagement.expensesOrders.creationUser "),e.k0s(),e.j41(18,"th",32),e.nrm(19,"i",31),e.EFF(20," orderManagement.expensesOrders.creationDate "),e.k0s(),e.j41(21,"th",32),e.nrm(22,"i",31),e.EFF(23," orderManagement.expensesOrders.attachFile "),e.k0s(),e.nrm(24,"th",33),e.k0s())}function vs(r,o){if(1&r&&(e.nrm(0,"i",41),e.EFF(1),e.nI1(2,"date"),e.nrm(3,"br")(4,"i",42),e.EFF(5),e.nI1(6,"date"),e.nrm(7,"br")(8,"i",43),e.EFF(9)),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",e.i5U(2,3,t.creationTime,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",e.i5U(6,6,t.updatedDate,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",t.createdUserName," ")}}function Cs(r,o){if(1&r){const t=e.RV6();e.j41(0,"tr",34)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.nI1(9,"date"),e.k0s(),e.j41(10,"td"),e.EFF(11),e.k0s(),e.j41(12,"td"),e.EFF(13),e.nI1(14,"date"),e.k0s(),e.j41(15,"td"),e.EFF(16),e.k0s(),e.j41(17,"td")(18,"a",35),e.EFF(19," orderManagement.expensesOrders.show "),e.k0s()(),e.j41(20,"td"),e.DNE(21,vs,10,9,"ng-template",null,3,e.C5r),e.nrm(23,"i",36),e.j41(24,"button",37),e.nI1(25,"translate"),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),l=e.sdS(22);return e.Njj(a.editModal(n,l))}),e.nrm(26,"i",38),e.k0s(),e.j41(27,"button",39),e.nI1(28,"translate"),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),l=e.sdS(24);return e.Njj(a.openModal(n.expensesOrderCode,l))}),e.nrm(29,"i",40),e.k0s()()()}if(2&r){const t=o.$implicit,i=o.rowIndex,n=e.sdS(22),a=e.XpG();e.R7$(2),e.JRh(i+1),e.R7$(2),e.JRh(t.expensesOrderCode),e.R7$(2),e.JRh(t.expensesItemName),e.R7$(2),e.JRh(e.i5U(9,11,t.expensesDate,"dd-MM-yyyy")),e.R7$(3),e.JRh(t.expensesValue),e.R7$(2),e.JRh(e.i5U(14,14,t.createdDate,"dd-MM-yyyy")),e.R7$(3),e.JRh(t.createdUserName),e.R7$(2),e.FS9("href",a.serverPath+t.attachFilePath,e.B4B),e.R7$(5),e.Y8G("ngbTooltip",n),e.R7$(),e.FS9("pTooltip",e.bMT(25,17,"general.edit")),e.R7$(3),e.FS9("pTooltip",e.bMT(28,19,"general.delete"))}}function xs(r,o){1&r&&(e.j41(0,"div",44),e.EFF(1," general.table.noData "),e.k0s())}function Is(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",45)(1,"div",46),e.nrm(2,"ngb-pagination-info",47),e.j41(3,"table-length",48),e.bIt("lengthChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",49)(5,"ngb-pagination",50),e.bIt("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.pagination.pageNumber,n)||(a.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function Fs(r,o){1&r&&(e.j41(0,"span",87),e.EFF(1,"general.action.register "),e.k0s())}function Ms(r,o){1&r&&(e.j41(0,"span",87),e.EFF(1,"general.action.edit "),e.k0s())}function js(r,o){1&r&&(e.j41(0,"div",88),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function Ts(r,o){1&r&&(e.j41(0,"div",88),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function Ss(r,o){1&r&&(e.j41(0,"div",88),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function ks(r,o){1&r&&(e.j41(0,"div",88),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function ys(r,o){if(1&r){const t=e.RV6();e.j41(0,"i",89),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.removeImage())}),e.k0s()}}function Rs(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",51)(1,"h4",52),e.DNE(2,Fs,2,0,"span",53)(3,Ms,2,0,"span",53),e.nrm(4,"span",54),e.k0s(),e.j41(5,"button",55),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"form",56,4),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onSubmit())}),e.nrm(8,"ngx-ui-loader",21),e.j41(9,"div",57)(10,"div",58)(11,"div",59)(12,"div",11)(13,"div",60)(14,"div",11)(15,"div",61)(16,"label",62),e.EFF(17,"orderManagement.expensesOrders.expensesItem"),e.k0s(),e.j41(18,"ng-select",63,5),e.nI1(20,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.form.expensesItemCode,n)||(a.form.expensesItemCode=n),e.Njj(n)}),e.k0s(),e.DNE(21,js,2,0,"div",64),e.k0s(),e.j41(22,"div",61)(23,"label",65),e.EFF(24,"orderManagement.expensesOrders.price"),e.k0s(),e.j41(25,"div",66)(26,"input",67,6),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.form.expensesValue,n)||(a.form.expensesValue=n),e.Njj(n)}),e.k0s(),e.DNE(28,Ts,2,0,"div",64),e.k0s()(),e.j41(29,"div",61)(30,"label",68),e.EFF(31,"orderManagement.expensesOrders.date"),e.k0s(),e.j41(32,"div",66)(33,"input",69,7),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.form.expensesDate,n)||(a.form.expensesDate=n),e.Njj(n)}),e.k0s(),e.DNE(35,Ss,2,0,"div",64),e.k0s()(),e.j41(36,"div",61)(37,"label",70),e.EFF(38,"orderManagement.expensesOrders.notes"),e.k0s(),e.j41(39,"div",66)(40,"textarea",71,8),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.form.notes,n)||(a.form.notes=n),e.Njj(n)}),e.EFF(42,"                                "),e.k0s(),e.DNE(43,ks,2,0,"div",64),e.k0s()()()(),e.j41(44,"div",60)(45,"div",72)(46,"label",62),e.EFF(47,"orderManagement.expensesOrders.attachFile"),e.k0s(),e.j41(48,"div",73)(49,"label",74),e.bIt("click",function(){e.eBV(t);const n=e.sdS(54);return e.Njj(n.click())}),e.j41(50,"div",75)(51,"div",76),e.nrm(52,"i",77),e.k0s()()(),e.j41(53,"input",78,9),e.bIt("change",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.onFileChanged(n))}),e.k0s()(),e.j41(55,"div",79)(56,"div",80),e.DNE(57,ys,1,0,"i",81),e.j41(58,"div",82),e.nrm(59,"img",83),e.k0s()()()()()(),e.j41(60,"div",84),e.nrm(61,"button",85),e.j41(62,"button",86),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()()}if(2&r){const t=e.sdS(7),i=e.sdS(19),n=e.sdS(27),a=e.sdS(34),l=e.sdS(41),s=e.XpG();e.R7$(2),e.Y8G("ngIf",!s.isEditForm),e.R7$(),e.Y8G("ngIf",s.isEditForm),e.R7$(5),e.Y8G("hasProgressBar",!1)("fgsType",s.loaderOperationShap)("loaderId",s.operationLoader),e.R7$(10),e.FS9("placeholder",e.bMT(20,18,"orderManagement.expensesOrders.expensesItem")),e.Y8G("items",s.expensesItems),e.R50("ngModel",s.form.expensesItemCode),e.R7$(3),e.Y8G("ngIf",i.invalid&&i.touched),e.R7$(5),e.R50("ngModel",s.form.expensesValue),e.R7$(2),e.Y8G("ngIf",n.invalid&&n.touched),e.R7$(5),e.R50("ngModel",s.form.expensesDate),e.R7$(2),e.Y8G("ngIf",a.invalid&&a.touched),e.R7$(5),e.R50("ngModel",s.form.notes),e.R7$(3),e.Y8G("ngIf",l.invalid&&l.touched),e.R7$(14),e.Y8G("ngIf",s.image.path),e.R7$(2),e.Y8G("src",s.image.isApi?s.serverPath+s.image.path:s.image.path,e.B4B),e.R7$(2),e.Y8G("disabled",!t.valid||!s.image.path)}}function Es(r,o){if(1&r){const t=e.RV6();e.j41(0,"delete-modal",90),e.bIt("deleteConfirm",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.DeleteConfirm())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}}let ws=(()=>{class r extends D.w{constructor(t,i,n,a,l,s,I,b,T,S,y,R){super(t,i,b,l,n,a,I),this.baseService=l,this.expensesCategoriesService=s,this.service=T,this.excelService=S,this._formDataService=y,this.router=R,this.title="orderManagement.expensesOrders.title",this.submitted=!1,this.cities={},this.channels={},this.leadTypes={},this.image={isApi:!1,path:""},this.form={image:""},this.isResolveList=!0,this.serverPath=ce.c.mediaUrl,this.configRoute(),this.getExpensesItems()}configRoute(){this.routerActive.data.pipe((0,u.Q)(this.notifier)).subscribe(t=>{this.entities=t.data.data,this.pagination.totalItems=t.data.totalItems},()=>{this.alertService.error()})}getExpensesItems(){this.expensesCategoriesService.getDropDown().subscribe({next:t=>{this.expensesItems=t.data}})}onSubmit(){this.ngxLoader.startLoader(this.operationLoader),!0===this.isEditForm?this.editEntity():this.registerEntity()}onSearch(){this.ngxLoader.startLoader(this.searchLoader),this.loadentities()}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,"Service Type",[])}mapExcel(){let t=[];return this.entities?.forEach(i=>{t.push({title:i.title,body:i.body,type:i.type,isActive:this.getTranslationText("general.table.active")})}),t}editModal(t,i,n="lg"){this.isEditForm=!0,this.form=t,this.image={isApi:!0,path:t.attachFilePath},this.modalService.open(i,{centered:!0,size:n})}registerEntity(){let t=this._formDataService.formatFormData(this.form);this.baseService.register(t).pipe((0,Y.O)(),(0,P.c)(this.mainDelay),(0,H.Z)(),(0,u.Q)(this.notifier),(0,B.j)(()=>this.ngxLoader.stopLoader(this.operationLoader)),(0,Ge.W)(i=>(0,Xe.$)(i))).subscribe(i=>{i.success?this.submitFunished():this.alertService.error("general.message."+i.message)},i=>{this.alertService.error("general.message."+i)})}editEntity(){let t=this._formDataService.formatFormData(this.form);this.baseService.editExpensesItems(this.form.expensesOrderCode,t).pipe((0,Y.O)(),(0,P.c)(this.mainDelay),(0,H.Z)(),(0,u.Q)(this.notifier),(0,B.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(i=>{i.success?this.submitFunished():this.alertService.error("general.message."+i.message)},i=>{this.alertService.error("general.message."+i)})}DeleteConfirm(){console.log(this.selectedRow),this.ngxLoader.startLoader(this.deleteLoader),this.baseService.Delete(this.selectedRow[0].id).pipe((0,Y.O)(),(0,P.c)(this.mainDelay),(0,H.Z)(),(0,u.Q)(this.notifier),(0,B.j)(()=>this.ngxLoader.stopLoader(this.deleteLoader))).subscribe(i=>{i.success?(this.alertService.success(),this.loadentities(),this.modalService.dismissAll(),this.resetSelected()):this.alertService.error("general.message."+i)},()=>{this.alertService.error()})}onFileChanged(t){if(t.target.files&&t.target.files[0]){let i=t.target.files.length;for(let n=0;n<i;n++){let a=new FileReader;this.form.image=t.target.files.item(n),a.onload=l=>{this.image={isApi:!1,path:l.target.result}},a.readAsDataURL(t.target.files[n])}}}removeImage(){console.log(),this.form.image="",this.image={id:0,path:""}}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(_.nX),e.rXU(p.c$),e.rXU(O.u),e.rXU(d.vh),e.rXU(Ae),e.rXU(ke),e.rXU(C.eD),e.rXU(h.Bq),e.rXU(Oe.m),e.rXU(z.V),e.rXU(Fe.Q),e.rXU(_.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-expenses-orders"]],features:[e.Vt3],decls:25,vars:19,consts:[["tableMaster",""],["whatsappModal",""],["deleteModal",""],["tooltipContent",""],["formEntity","ngForm"],["expensesItemCode","ngModel"],["expensesValue","ngModel"],["expensesDate","ngModel"],["notes","ngModel"],["FileInput",""],[3,"title","breadcrumbItems"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],[3,"reset","search","exportXlsx","addNew","totalItems","title"],["control",""],[1,"col-12","col-md-6","mb-2"],[1,"search-box"],["InputTirmFilter","","type","search","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],[1,"card-body"],[3,"hasProgressBar","fgsType","loaderId"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["translate","",2,"width",".5%"],["pSortableColumn","name","translate","",2,"width","10%"],[1,"ri-expand-up-down-line"],["pSortableColumn","mobile","translate","",2,"width","10%"],["translate","",2,"width","20%"],[1,"fs-5"],["target","_blank","translate","",3,"href"],["tooltipPosition","top",1,"mdi","mdi-cog-outline","d-inline","text-muted","fs-16","align-middle","me-1",3,"ngbTooltip"],["tooltipPosition","top",1,"btn","btn-sm","btn-soft-info","edit-list","mx-2",3,"click","pTooltip"],[1,"ri-pencil-fill","align-bottom","mx-1"],["tooltipPosition","top",1,"btn","btn-sm","btn-soft-danger","remove-list",3,"click","pTooltip"],[1,"ri-delete-bin-5-fill","align-bottom"],[1,"ri-history-fill","text-warning"],[1,"ri-history-fill","text-danger"],[1,"ri-user-location-fill","text-primary"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["class","fw-bold fs-4","translate","",4,"ngIf"],["translate","orderManagement.expensesOrders.title",1,"fw-bold","fs-4"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[3,"ngSubmit"],[1,"modal-content"],[1,"modal-body"],[1,"mx-2"],[1,"col-12","col-lg-6"],[1,"col-12","col-md-12","mb-3"],["for","expensesItemCode","translate","",1,"fw-bold","form-label","required"],["name","expensesItemCode","bindValue","code","bindLabel","name","id","expensesItemCode","required","",3,"ngModelChange","items","placeholder","ngModel"],["class","text-danger text-center  ","translate","",4,"ngIf"],["for","expensesValue","translate","",1,"fw-bold","form-label","required"],[1,"input-group"],["InputTirmFilter","","name","expensesValue","type","number","required","","id","expensesValue",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["for","expensesDate","translate","",1,"fw-bold","form-label","required"],["InputTirmFilter","","name","expensesDate","type","date","required","","id","expensesDate",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["for","notes","translate","",1,"fw-bold","form-label"],["InputTirmFilter","","name","notes","rows","3","id","notes",1,"form-control","fs-6",3,"ngModelChange","ngModel"],[1,"position-relative","d-inline-block"],[1,"position-absolute","top-100","start-100","translate-middle"],["placement","right","ngbTooltip","Select Image",1,"mb-0",3,"click"],[1,"avatar-xs"],[1,"avatar-title","bg-light","border","rounded-circle","text-muted","cursor-pointer"],[1,"ri-image-fill"],["value","","type","file","accept","image/png, image/gif, image/jpeg",1,"form-control","d-none",3,"change"],[1,"d-flex","justify-content-center","w-100"],[1,"avatar-xl-custom","mx-2","position-relative"],["class","position-absolute bx bx-x-circle text-white","style","background: red; top: 1px; right: -4px; font-size: 1rem;\n                                                border-radius: 50% ",3,"click",4,"ngIf"],[1,"avatar-title","bg-light","rounded"],["id","product-img1","alt","",1,"avatar-xl-custom","h-auto",3,"src"],[1,"d-flex","gap-2","justify-content-end","mt-4","mb-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger",3,"disabled"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],["translate","",1,"fw-bold","fs-4"],["translate","",1,"text-danger","text-center"],[1,"position-absolute","bx","bx-x-circle","text-white",2,"background","red","top","1px","right","-4px","font-size","1rem","border-radius","50%",3,"click"],[3,"deleteConfirm","dismiss"]],template:function(i,n){if(1&i){const a=e.RV6();e.nrm(0,"app-breadcrumbs",10),e.nI1(1,"translate"),e.j41(2,"div",11)(3,"div",12)(4,"div",13)(5,"base-filter",14),e.bIt("reset",function(){return e.eBV(a),e.Njj(n.onReset())})("search",function(){return e.eBV(a),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(a),e.Njj(n.onExportXlsx())})("addNew",function(){e.eBV(a);const s=e.sdS(22);return e.Njj(n.openModalTitle(s,"lg"))}),e.qex(6,15),e.j41(7,"div",16)(8,"div",17)(9,"input",18),e.nI1(10,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.filterValue,s)||(n.pagination.filterValue=s),e.Njj(s)}),e.k0s(),e.nrm(11,"i",19),e.k0s()(),e.bVm(),e.k0s(),e.j41(12,"div",20),e.nrm(13,"ngx-ui-loader",21),e.j41(14,"div",22)(15,"p-table",23,0),e.bIt("onLazyLoad",function(s){return e.eBV(a),e.Njj(n.tableChange(s))})("selectionChange",function(s){return e.eBV(a),e.Njj(n.onSelectionChange(s))}),e.DNE(17,bs,25,0,"ng-template",24)(18,Cs,30,21,"ng-template",25),e.k0s()(),e.DNE(19,xs,2,0,"div",26)(20,Is,6,8,"div",27),e.k0s()()()(),e.DNE(21,Rs,63,20,"ng-template",null,1,e.C5r)(23,Es,1,0,"ng-template",null,2,e.C5r)}2&i&&(e.FS9("title",e.bMT(1,15,n.title)),e.Y8G("breadcrumbItems",n.breadCrumbItems),e.R7$(5),e.Y8G("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(10,17,"task.tasklist.subject")),e.R50("ngModel",n.pagination.filterValue),e.R7$(4),e.Y8G("hasProgressBar",!1)("fgsType",n.loaderSearchShap)("loaderId",n.searchLoader),e.R7$(2),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[d.bT,c.qT,c.me,c.Q0,c.BC,c.cb,c.YS,c.vS,c.cV,h.s5,Ee.m,q.b,Ce.w,ie.p,re.g,p.Mm,x.XI,K.Ei,x.Tg,C.Cv,U.vr,h.md,W.m,de.m,d.vh,p.D9],encapsulation:2})}}return r})(),Ns=(()=>{class r extends Ve.E{constructor(t,i,n){super(t,i,n)}static{this.\u0275fac=function(i){return new(i||r)(e.KVO(_.Ix),e.KVO(Ae),e.KVO(O.u))}}static{this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();function Ds(r,o){1&r&&(e.j41(0,"tr",29)(1,"th",30),e.EFF(2,"#"),e.k0s(),e.j41(3,"th",31),e.nrm(4,"i",32),e.EFF(5," orderManagement.expensesOrders.code "),e.k0s(),e.j41(6,"th",33),e.nrm(7,"i",32),e.EFF(8," orderManagement.expensesOrders.expensesItem "),e.k0s(),e.j41(9,"th",34),e.nrm(10,"i",32),e.EFF(11," orderManagement.expensesOrders.date "),e.k0s(),e.j41(12,"th",35),e.nrm(13,"i",32),e.EFF(14," orderManagement.expensesOrders.price "),e.k0s(),e.j41(15,"th",36),e.nrm(16,"i",32),e.EFF(17," orderManagement.expensesOrders.creationUser "),e.k0s(),e.j41(18,"th",37),e.nrm(19,"i",32),e.EFF(20," orderManagement.expensesOrders.creationDate "),e.k0s(),e.j41(21,"th",38),e.EFF(22," orderManagement.expensesOrders.attachFile "),e.k0s(),e.nrm(23,"th",39),e.k0s())}function Os(r,o){if(1&r&&(e.nrm(0,"i",47),e.EFF(1),e.nI1(2,"date"),e.nrm(3,"br")(4,"i",48),e.EFF(5),e.nI1(6,"date"),e.nrm(7,"br")(8,"i",49),e.EFF(9)),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",e.i5U(2,3,t.createdDate,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",e.i5U(6,6,t.updatedDate,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",t.createdUserName," ")}}function Vs(r,o){if(1&r){const t=e.RV6();e.j41(0,"tr",40)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.nI1(9,"date"),e.k0s(),e.j41(10,"td"),e.EFF(11),e.k0s(),e.j41(12,"td"),e.EFF(13),e.k0s(),e.j41(14,"td"),e.EFF(15),e.nI1(16,"date"),e.k0s(),e.j41(17,"td")(18,"a",41),e.EFF(19," orderManagement.expensesOrders.show "),e.k0s()(),e.j41(20,"td"),e.DNE(21,Os,10,9,"ng-template",null,3,e.C5r),e.nrm(23,"i",42),e.j41(24,"button",43),e.nI1(25,"translate"),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),l=e.sdS(23);return e.Njj(a.editModal(n,l))}),e.nrm(26,"i",44),e.k0s(),e.j41(27,"button",45),e.nI1(28,"translate"),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),l=e.sdS(25);return e.Njj(a.openModal(n.expensesOrderCode,l))}),e.nrm(29,"i",46),e.k0s()()()}if(2&r){const t=o.$implicit,i=o.rowIndex,n=e.sdS(22),a=e.XpG();e.R7$(2),e.JRh(i+1),e.R7$(2),e.JRh(t.expensesOrderCode),e.R7$(2),e.JRh(t.expensesItemName),e.R7$(2),e.JRh(e.i5U(9,11,t.expensesDate,"dd-MM-yyyy")),e.R7$(3),e.JRh(t.expensesValue),e.R7$(2),e.JRh(t.createdUserName),e.R7$(2),e.JRh(e.i5U(16,14,t.createdDate,"dd-MM-yyyy")),e.R7$(3),e.FS9("href",a.serverPath+t.attachFilePath,e.B4B),e.R7$(5),e.Y8G("ngbTooltip",n),e.R7$(),e.FS9("pTooltip",e.bMT(25,17,"general.edit")),e.R7$(3),e.FS9("pTooltip",e.bMT(28,19,"general.delete"))}}function Gs(r,o){1&r&&(e.j41(0,"div",50),e.EFF(1," general.table.noData "),e.k0s())}function As(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",51)(1,"div",52),e.nrm(2,"ngb-pagination-info",53),e.j41(3,"table-length",54),e.bIt("lengthChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",55)(5,"ngb-pagination",56),e.bIt("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.pagination.pageNumber,n)||(a.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function Ls(r,o){1&r&&(e.j41(0,"span",94),e.EFF(1,"general.action.register "),e.k0s())}function Bs(r,o){1&r&&(e.j41(0,"span",94),e.EFF(1,"general.action.edit "),e.k0s())}function $s(r,o){1&r&&(e.j41(0,"div",95),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function Xs(r,o){1&r&&(e.j41(0,"div",95),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function Us(r,o){1&r&&(e.j41(0,"div",95),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function Ys(r,o){1&r&&(e.j41(0,"div",95),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function Ps(r,o){if(1&r){const t=e.RV6();e.j41(0,"i",96),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.removeImage())}),e.k0s()}}function Hs(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",57)(1,"h4",58),e.DNE(2,Ls,2,0,"span",59)(3,Bs,2,0,"span",59),e.nrm(4,"span",60),e.k0s(),e.j41(5,"button",61),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"form",62,4),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onSubmit())}),e.nrm(8,"ngx-ui-loader",63),e.j41(9,"div",64)(10,"div",65)(11,"div",66)(12,"div",10)(13,"div",67)(14,"div",10)(15,"div",68)(16,"label",69),e.EFF(17,"orderManagement.expensesOrders.expensesItem"),e.k0s(),e.j41(18,"ng-select",70,5),e.nI1(20,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.form.expensesItemCode,n)||(a.form.expensesItemCode=n),e.Njj(n)}),e.k0s(),e.DNE(21,$s,2,0,"div",71),e.k0s(),e.j41(22,"div",68)(23,"label",72),e.EFF(24,"orderManagement.expensesOrders.price"),e.k0s(),e.j41(25,"div",73)(26,"input",74,6),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.form.expensesValue,n)||(a.form.expensesValue=n),e.Njj(n)}),e.k0s(),e.DNE(28,Xs,2,0,"div",71),e.k0s()(),e.j41(29,"div",68)(30,"label",75),e.EFF(31,"orderManagement.expensesOrders.date"),e.k0s(),e.j41(32,"div",73)(33,"input",76,7),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.form.expensesDate,n)||(a.form.expensesDate=n),e.Njj(n)}),e.k0s(),e.DNE(35,Us,2,0,"div",71),e.k0s()(),e.j41(36,"div",68)(37,"label",77),e.EFF(38,"orderManagement.expensesOrders.notes"),e.k0s(),e.j41(39,"div",73)(40,"textarea",78,8),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.form.notes,n)||(a.form.notes=n),e.Njj(n)}),e.EFF(42,"                                "),e.k0s(),e.DNE(43,Ys,2,0,"div",71),e.k0s()()()(),e.j41(44,"div",67)(45,"div",79)(46,"label",69),e.EFF(47,"orderManagement.expensesOrders.attachFile"),e.k0s(),e.j41(48,"div",80)(49,"label",81),e.bIt("click",function(){e.eBV(t);const n=e.sdS(54);return e.Njj(n.click())}),e.j41(50,"div",82)(51,"div",83),e.nrm(52,"i",84),e.k0s()()(),e.j41(53,"input",85,9),e.bIt("change",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.onFileChanged(n))}),e.k0s()(),e.j41(55,"div",86)(56,"div",87),e.DNE(57,Ps,1,0,"i",88),e.j41(58,"div",89),e.nrm(59,"img",90),e.k0s()()()()()(),e.j41(60,"div",91),e.nrm(61,"button",92),e.j41(62,"button",93),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()()}if(2&r){const t=e.sdS(7),i=e.sdS(19),n=e.sdS(27),a=e.sdS(34),l=e.sdS(41),s=e.XpG();e.R7$(2),e.Y8G("ngIf",!s.isEditForm),e.R7$(),e.Y8G("ngIf",s.isEditForm),e.R7$(5),e.Y8G("hasProgressBar",!1)("fgsType",s.loaderOperationShap)("loaderId",s.operationLoader),e.R7$(10),e.FS9("placeholder",e.bMT(20,20,"orderManagement.expensesOrders.expensesItem")),e.Y8G("items",s.expensesItems),e.R50("ngModel",s.form.expensesItemCode),e.R7$(3),e.Y8G("ngIf",i.invalid&&i.touched),e.R7$(5),e.R50("ngModel",s.form.expensesValue),e.R7$(2),e.Y8G("ngIf",n.invalid&&n.touched),e.R7$(5),e.R50("ngModel",s.form.expensesDate),e.Y8G("altInput",!0)("convertModelValue",!0),e.R7$(2),e.Y8G("ngIf",a.invalid&&a.touched),e.R7$(5),e.R50("ngModel",s.form.notes),e.R7$(3),e.Y8G("ngIf",l.invalid&&l.touched),e.R7$(14),e.Y8G("ngIf",s.image.path),e.R7$(2),e.Y8G("src",s.image.isApi?s.serverPath+s.image.path:s.image.path,e.B4B),e.R7$(2),e.Y8G("disabled",!t.valid||!s.image.path)}}function zs(r,o){if(1&r){const t=e.RV6();e.j41(0,"delete-modal",97),e.bIt("deleteConfirm",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.DeleteConfirm())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}}let Js=(()=>{class r extends D.w{constructor(t,i,n,a,l,s,I,b,T,S,y,R){super(t,i,b,l,n,a,I),this.baseService=l,this.expensesCategoriesService=s,this.service=T,this.excelService=S,this._formDataService=y,this.router=R,this.title="orderManagement.expensesOrders.title",this.submitted=!1,this.cities={},this.channels={},this.leadTypes={},this.image={isApi:!1,path:""},this.form={image:""},this.searchForm={},this.isResolveList=!0,this.serverPath=ce.c.mediaUrl,this.setDates=(M,w,N)=>{if(M?.from||M?.to){const E=M.to||M.from;this.pagination[w]=this.datePipe.transform(M.from||M.to,"yyyy-MM-ddT00:00:00"),this.pagination[N]=this.datePipe.transform(E,"yyyy-MM-ddT23:59:59.999")}else this.pagination[w]=null,this.pagination[N]=null},this.loadentities(),this.getExpensesItems()}getExpensesItems(){this.expensesCategoriesService.getDropDown().subscribe({next:t=>{this.expensesItems=t.data}})}onSubmit(){this.ngxLoader.startLoader(this.operationLoader),!0===this.isEditForm?this.editEntity():this.registerEntity()}onSearch(){this.ngxLoader.startLoader(this.searchLoader),this.setDates(this.searchForm.dates,"expensesDateFrom","expensesDateTo"),this.loadentities()}loadentities(){this.countLoad=this.countLoad+1,(!this.isResolveList||1!==this.countLoad)&&(this.ngxLoader.startLoader(this.searchLoader),this.baseService.get(this.pagination).pipe((0,u.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader(this.searchLoader),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader(this.searchLoader),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,"Service Type",[])}mapExcel(){let t=[];return this.entities?.forEach(i=>{t.push({title:i.title,body:i.body,type:i.type,isActive:this.getTranslationText("general.table.active")})}),t}editModal(t,i,n="lg"){this.isEditForm=!0,this.form=t,this.image={isApi:!0,path:t.attachFilePath},this.modalService.open(i,{centered:!0,size:n})}registerEntity(){let t={...this.form};t.expensesDate=this.datePipe.transform(t.expensesDate,"yyyy-MM-ddT00:00:00");let i=this._formDataService.formatFormData(t);this.baseService.register(i).pipe((0,Y.O)(),(0,P.c)(this.mainDelay),(0,H.Z)(),(0,u.Q)(this.notifier),(0,B.j)(()=>this.ngxLoader.stopLoader(this.operationLoader)),(0,Ge.W)(n=>(0,Xe.$)(n))).subscribe(n=>{n.success?this.submitFunished():this.alertService.error("general.message."+n.message)},n=>{this.alertService.error("general.message."+n)})}editEntity(){let t={...this.form};t.expensesDate=this.datePipe.transform(t.expensesDate,"yyyy-MM-ddT00:00:00");let i=this._formDataService.formatFormData(this.form);this.baseService.editExpensesItems(this.form.expensesOrderCode,i).pipe((0,Y.O)(),(0,P.c)(this.mainDelay),(0,H.Z)(),(0,u.Q)(this.notifier),(0,B.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(n=>{n.success?this.submitFunished():this.alertService.error("general.message."+n.message)},n=>{this.alertService.error("general.message."+n)})}DeleteConfirm(){console.log(this.selectedRow),this.ngxLoader.startLoader(this.deleteLoader),this.baseService.Delete(this.selectedRow[0].id).pipe((0,Y.O)(),(0,P.c)(this.mainDelay),(0,H.Z)(),(0,u.Q)(this.notifier),(0,B.j)(()=>this.ngxLoader.stopLoader(this.deleteLoader))).subscribe(i=>{i.success?(this.alertService.success(),this.loadentities(),this.modalService.dismissAll(),this.resetSelected()):this.alertService.error("general.message."+i)},()=>{this.alertService.error()})}onFileChanged(t){if(t.target.files&&t.target.files[0]){let i=t.target.files.length;for(let n=0;n<i;n++){let a=new FileReader;this.form.image=t.target.files.item(n),a.onload=l=>{this.image={isApi:!1,path:l.target.result}},a.readAsDataURL(t.target.files[n])}}}removeImage(){console.log(),this.form.image="",this.image={id:0,path:""}}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(_.nX),e.rXU(p.c$),e.rXU(O.u),e.rXU(d.vh),e.rXU(Ae),e.rXU(ke),e.rXU(C.eD),e.rXU(h.Bq),e.rXU(Oe.m),e.rXU(z.V),e.rXU(Fe.Q),e.rXU(_.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-team-expenses-orders"]],features:[e.Vt3],decls:26,vars:20,consts:[["tableMaster",""],["whatsappModal",""],["deleteModal",""],["tooltipContent",""],["formEntity","ngForm"],["expensesItemCode","ngModel"],["expensesValue","ngModel"],["expensesDate","ngModel"],["notes","ngModel"],["FileInput",""],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],[3,"reset","search","exportXlsx","addNew","showExport","totalItems","title"],["control",""],[1,"col-12","col-md-4","mb-2"],[1,"search-box"],["InputTirmFilter","","type","search","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],[1,"col-12","col-md-3","mb-2"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"card-body"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["translate","",2,"width",".5%"],["pSortableColumn","expensesOrderCode","translate","",2,"width","10%"],[1,"ri-expand-up-down-line"],["pSortableColumn","expensesItemName","translate","",2,"width","10%"],["pSortableColumn","expensesDate","translate","",2,"width","10%"],["pSortableColumn","expensesValue","translate","",2,"width","10%"],["pSortableColumn","createdUserName","translate","",2,"width","10%"],["pSortableColumn","createdDate","translate","",2,"width","10%"],["translate","",2,"width","10%"],["translate","",2,"width","20%"],[1,"fs-5"],["target","_blank","translate","",3,"href"],["tooltipPosition","top",1,"mdi","mdi-cog-outline","d-inline","text-muted","fs-16","align-middle","me-1",3,"ngbTooltip"],["tooltipPosition","top",1,"btn","btn-sm","btn-soft-info","edit-list","mx-2",3,"click","pTooltip"],[1,"ri-pencil-fill","align-bottom","mx-1"],["tooltipPosition","top",1,"btn","btn-sm","btn-soft-danger","remove-list",3,"click","pTooltip"],[1,"ri-delete-bin-5-fill","align-bottom"],[1,"ri-history-fill","text-warning"],[1,"ri-history-fill","text-danger"],[1,"ri-user-location-fill","text-primary"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["class","fw-bold fs-4","translate","",4,"ngIf"],["translate","orderManagement.expensesOrders.title",1,"fw-bold","fs-4"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[3,"ngSubmit"],[3,"hasProgressBar","fgsType","loaderId"],[1,"modal-content"],[1,"modal-body"],[1,"mx-2"],[1,"col-12","col-lg-6"],[1,"col-12","col-md-12","mb-3"],["for","expensesItemCode","translate","",1,"fw-bold","form-label","required"],["name","expensesItemCode","bindValue","code","bindLabel","name","id","expensesItemCode","required","",3,"ngModelChange","items","placeholder","ngModel"],["class","text-danger text-center  ","translate","",4,"ngIf"],["for","expensesValue","translate","",1,"fw-bold","form-label","required"],[1,"input-group"],["InputTirmFilter","","name","expensesValue","type","number","required","","id","expensesValue",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["for","expensesDate","translate","",1,"fw-bold","form-label","required"],["InputTirmFilter","","name","expensesDate","mwlFlatpickr","","type","date","required","","id","expensesDate",1,"form-control","fs-6",3,"ngModelChange","ngModel","altInput","convertModelValue"],["for","notes","translate","",1,"fw-bold","form-label"],["InputTirmFilter","","name","notes","rows","3","id","notes",1,"form-control","fs-6",3,"ngModelChange","ngModel"],[1,"position-relative","d-inline-block"],[1,"position-absolute","top-100","start-100","translate-middle"],["placement","right","ngbTooltip","Select Image",1,"mb-0",3,"click"],[1,"avatar-xs"],[1,"avatar-title","bg-light","border","rounded-circle","text-muted","cursor-pointer"],[1,"ri-image-fill"],["value","","type","file","accept","image/png, image/gif, image/jpeg",1,"form-control","d-none",3,"change"],[1,"d-flex","justify-content-center","w-100"],[1,"avatar-xl-custom","mx-2","position-relative"],["class","position-absolute bx bx-x-circle text-white","style","background: red; top: 1px; right: -4px; font-size: 1rem;\n                                                border-radius: 50% ",3,"click",4,"ngIf"],[1,"avatar-title","bg-light","rounded"],["id","product-img1","alt","",1,"avatar-xl-custom","h-auto",3,"src"],[1,"d-flex","gap-2","justify-content-end","mt-4","mb-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger",3,"disabled"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],["translate","",1,"fw-bold","fs-4"],["translate","",1,"text-danger","text-center"],[1,"position-absolute","bx","bx-x-circle","text-white",2,"background","red","top","1px","right","-4px","font-size","1rem","border-radius","50%",3,"click"],[3,"deleteConfirm","dismiss"]],template:function(i,n){if(1&i){const a=e.RV6();e.j41(0,"div",10)(1,"div",11)(2,"div",12)(3,"base-filter",13),e.bIt("reset",function(){return e.eBV(a),e.Njj(n.onReset())})("search",function(){return e.eBV(a),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(a),e.Njj(n.onExportXlsx())})("addNew",function(){e.eBV(a);const s=e.sdS(23);return e.Njj(n.openModalTitle(s,"lg"))}),e.qex(4,14),e.j41(5,"div",15)(6,"div",16)(7,"input",17),e.nI1(8,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.filterValue,s)||(n.pagination.filterValue=s),e.Njj(s)}),e.k0s(),e.nrm(9,"i",18),e.k0s()(),e.j41(10,"div",19)(11,"input",20),e.nI1(12,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.dates,s)||(n.searchForm.dates=s),e.Njj(s)}),e.k0s()(),e.bVm(),e.k0s(),e.j41(13,"div",21),e.nrm(14,"ngx-ui-loader",22),e.j41(15,"div",23)(16,"p-table",24,0),e.bIt("onLazyLoad",function(s){return e.eBV(a),e.Njj(n.tableChange(s))})("selectionChange",function(s){return e.eBV(a),e.Njj(n.onSelectionChange(s))}),e.DNE(18,Ds,24,0,"ng-template",25)(19,Vs,30,21,"ng-template",26),e.k0s()(),e.DNE(20,Gs,2,0,"div",27)(21,As,6,8,"div",28),e.k0s()()()(),e.DNE(22,Hs,63,22,"ng-template",null,1,e.C5r)(24,zs,1,0,"ng-template",null,2,e.C5r)}2&i&&(e.R7$(3),e.Y8G("showExport",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(8,16,"task.tasklist.subject")),e.R50("ngModel",n.pagination.filterValue),e.R7$(4),e.FS9("placeholder",e.bMT(12,18,"orderManagement.expensesOrders.date")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.dates),e.R7$(3),e.Y8G("loaderId",n.searchLoader),e.R7$(2),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[d.bT,c.qT,c.me,c.Q0,c.BC,c.cb,c.YS,c.vS,c.cV,h.s5,j.kL,q.b,Ce.w,ie.p,re.g,p.Mm,x.XI,K.Ei,x.Tg,C.Cv,U.vr,h.md,W.m,de.m,d.vh,p.D9],encapsulation:2})}}return r})();var qs=m(82391);let Ws=(()=>{class r{getCurrentLocation(){return new Promise((t,i)=>{"geolocation"in navigator?navigator.geolocation.getCurrentPosition(n=>{t({latitude:n.coords.latitude,longitude:n.coords.longitude})},n=>{i(this.getErrorMessage(n))}):i("Geolocation is not supported by your browser.")})}getErrorMessage(t){switch(t.code){case t.PERMISSION_DENIED:return"Permission denied. Please enable location services.";case t.POSITION_UNAVAILABLE:return"Position unavailable. Please try again later.";case t.TIMEOUT:return"Request timed out. Please try again.";default:return"An unknown error occurred."}}static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();const Qs=["FileInput"],Ks=()=>["assigned.changeStatus"],Zs=()=>["assigned.finishedOrder"];function eo(r,o){1&r&&e.nrm(0,"span",61)}function to(r,o){if(1&r&&(e.j41(0,"span",62),e.EFF(1),e.k0s()),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI("",t.districtName," ")}}function no(r,o){if(1&r&&(e.qex(0),e.j41(1,"span",63),e.EFF(2),e.k0s(),e.bVm()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t)}}function io(r,o){if(1&r&&(e.qex(0),e.j41(1,"span",63),e.EFF(2),e.k0s(),e.bVm()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t)}}function ro(r,o){if(1&r&&(e.qex(0),e.j41(1,"span",63),e.EFF(2),e.k0s(),e.bVm()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t)}}function ao(r,o){if(1&r){const t=e.RV6();e.j41(0,"a",64),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,a=e.XpG(),l=e.sdS(29);return e.Njj(a.openChangeStatusModal(n,l))}),e.nrm(1,"i",65)(2,"span",66),e.k0s()}}function so(r,o){if(1&r){const t=e.RV6();e.j41(0,"a",67),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,a=e.XpG(),l=e.sdS(31);return a.GetOrderServiceAndPayment(n),e.Njj(a.openChangeStatusModal(n,l,"xl"))}),e.nrm(1,"i",68)(2,"span",69),e.k0s()}}function oo(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",31)(1,"div",32)(2,"div",19)(3,"bdi")(4,"span")(5,"span"),e.EFF(6),e.nI1(7,"translate"),e.k0s()()(),e.nrm(8,"div",33),e.j41(9,"div",34)(10,"p",35),e.nrm(11,"i",36),e.EFF(12),e.nI1(13,"date"),e.k0s(),e.j41(14,"p",37),e.EFF(15),e.nI1(16,"translate"),e.k0s()(),e.j41(17,"a",38)(18,"h5",39),e.nrm(19,"i",40),e.EFF(20),e.k0s()(),e.j41(21,"div",41)(22,"div",42),e.nrm(23,"i",43),e.EFF(24),e.DNE(25,eo,1,0,"span",44)(26,to,2,1,"span",45),e.k0s(),e.j41(27,"div"),e.nrm(28,"i",46),e.j41(29,"span",47),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.copytext(n.mobile))}),e.EFF(30),e.nrm(31,"i",48),e.k0s()()(),e.nrm(32,"hr"),e.j41(33,"div",49)(34,"div"),e.nrm(35,"i",50),e.DNE(36,no,3,1,"ng-container",51),e.k0s()(),e.nrm(37,"hr",52),e.j41(38,"div",53)(39,"div",54)(40,"h6"),e.nrm(41,"i",55),e.EFF(42),e.nI1(43,"translate"),e.k0s(),e.DNE(44,io,3,1,"ng-container",51),e.k0s(),e.j41(45,"div",56)(46,"h6"),e.nrm(47,"i",57),e.EFF(48),e.nI1(49,"translate"),e.k0s(),e.DNE(50,ro,3,1,"ng-container",51),e.k0s()(),e.j41(51,"div",58),e.DNE(52,ao,3,0,"a",59)(53,so,3,0,"a",60),e.k0s()()()()}if(2&r){const t=o.$implicit,i=e.XpG();e.R7$(4),e.ZvI("ribbon ",t.teamStatusName," round-shape "),e.R7$(2),e.JRh(e.bMT(7,19,"orderManagement.order."+t.teamStatusName)),e.R7$(6),e.SpI(" ",e.i5U(13,21,t.visitDate,"yyyy-MM-dd")," "),e.R7$(3),e.Lme(" ",e.bMT(16,24,"orderManagement.order.orderCode"),": #SO#",t.orderCode," "),e.R7$(5),e.SpI(" ",t.agentName," "),e.R7$(4),e.SpI(" ",t.cityName," "),e.R7$(),e.Y8G("ngIf",""==t.districtName),e.R7$(),e.Y8G("ngIf",""!==t.districtName),e.R7$(4),e.SpI("",t.mobile," "),e.R7$(6),e.Y8G("ngForOf",i.getServices(t.services)),e.R7$(6),e.SpI(" ",e.bMT(43,26,"orderManagement.order.assignTo"),""),e.R7$(2),e.Y8G("ngForOf",i.getTimes(t.teamNames)),e.R7$(4),e.SpI(" ",e.bMT(49,28,"orderManagement.order.workTimes"),""),e.R7$(2),e.Y8G("ngForOf",i.getTimes(t.workTimes)),e.R7$(2),e.Y8G("hasPermission",e.lJ4(30,Ks)),e.R7$(),e.Y8G("hasPermission",e.lJ4(31,Zs))}}function lo(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",70)(1,"div",71)(2,"h4",72),e.nrm(3,"span",73),e.k0s(),e.j41(4,"button",74),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(5,"div",75),e.nrm(6,"ngx-ui-loader",76),e.j41(7,"form",77,5),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.changeStatus())}),e.j41(9,"div",14)(10,"div",78)(11,"label",79),e.EFF(12,"orderManagement.order.changeTeamStatus"),e.k0s(),e.j41(13,"ng-select",80),e.nI1(14,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.form.teamStatus,n)||(a.form.teamStatus=n),e.Njj(n)}),e.k0s()(),e.j41(15,"div",78)(16,"label",79),e.EFF(17,"orderManagement.order.teamStatusNotes"),e.k0s(),e.j41(18,"textarea",81),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.form.teamStatusNotes,n)||(a.form.teamStatusNotes=n),e.Njj(n)}),e.k0s()()(),e.j41(19,"div",39)(20,"button",82),e.nrm(21,"i",83)(22,"span",84),e.k0s()()()()()}if(2&r){const t=e.sdS(8),i=e.XpG();e.R7$(6),e.Y8G("hasProgressBar",!1)("fgsType",i.loaderOperationShap)("loaderId",i.operationLoader),e.R7$(7),e.FS9("placeholder",e.bMT(14,9,"orderManagement.order.changeTeamStatus")),e.Y8G("items",i.statusList)("multiple",!1),e.R50("ngModel",i.form.teamStatus),e.R7$(5),e.R50("ngModel",i.form.teamStatusNotes),e.R7$(2),e.Y8G("disabled",!t.valid)}}function co(r,o){if(1&r){const t=e.RV6();e.j41(0,"span",133)(1,"input",134),e.nI1(2,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG().$implicit;return e.DH7(a.price,n)||(a.price=n),e.Njj(n)}),e.k0s(),e.j41(3,"button",135),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,a=e.XpG(2);return n.isEdit=!n.isEdit,e.Njj(a.calculatePrices())}),e.nrm(4,"i",136),e.k0s()()}if(2&r){const t=e.XpG(),i=t.$implicit,n=t.index;e.R7$(),e.Mz_("name","editPrice",n,""),e.FS9("placeholder",e.bMT(2,6,"orderManagement.order.notes")),e.Mz_("id","editPrice",n,""),e.R50("ngModel",i.price)}}function mo(r,o){if(1&r&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",t.quantity," ")}}function po(r,o){if(1&r){const t=e.RV6();e.j41(0,"span",133)(1,"input",134),e.nI1(2,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG().$implicit;return e.DH7(a.quantity,n)||(a.quantity=n),e.Njj(n)}),e.k0s(),e.j41(3,"button",135),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,a=e.XpG(2);return n.isEdit=!n.isEdit,e.Njj(a.calculatePrices())}),e.nrm(4,"i",136),e.k0s()()}if(2&r){const t=e.XpG(),i=t.$implicit,n=t.index;e.R7$(),e.Mz_("name","editQuantity",n,""),e.FS9("placeholder",e.bMT(2,6,"orderManagement.order.quantity")),e.Mz_("id","editPrice",n,""),e.R50("ngModel",i.quantity)}}function go(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",137),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit;return e.Njj(n.isEdit=!n.isEdit)}),e.nrm(1,"i",136),e.k0s()}}function ho(r,o){if(1&r){const t=e.RV6();e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td")(4,"span"),e.EFF(5),e.k0s(),e.DNE(6,co,5,8,"span",129),e.k0s(),e.j41(7,"td"),e.DNE(8,mo,2,1,"span",104)(9,po,5,8,"span",129),e.k0s(),e.j41(10,"td"),e.EFF(11),e.k0s(),e.j41(12,"td")(13,"button",130),e.bIt("click",function(){const n=e.eBV(t).index,a=e.XpG(2);return e.Njj(a.deleteService(n))}),e.nrm(14,"i",131),e.k0s(),e.DNE(15,go,2,0,"button",132),e.k0s()()}if(2&r){const t=o.$implicit;e.R7$(2),e.JRh(t.service),e.R7$(3),e.SpI(" ",t.price," "),e.R7$(),e.Y8G("ngIf",!1),e.R7$(2),e.Y8G("ngIf",!t.isEdit),e.R7$(),e.Y8G("ngIf",t.isEdit),e.R7$(2),e.JRh(t.notes),e.R7$(4),e.Y8G("ngIf",!t.isEdit)}}function uo(r,o){1&r&&(e.j41(0,"tr")(1,"td",138),e.EFF(2),e.nI1(3,"translate"),e.k0s()()),2&r&&(e.R7$(2),e.JRh(e.bMT(3,1,"orderManagement.order.noData")))}function _o(r,o){if(1&r&&(e.j41(0,"div",106)(1,"div",139)(2,"label",140),e.EFF(3,"orderManagement.order.assignedOrders.usedShow"),e.k0s(),e.j41(4,"div",141),e.EFF(5),e.k0s()()()),2&r){const t=e.XpG(2);e.R7$(5),e.SpI(" ",t.finishOrderForm.usedShow||"--"," ")}}function fo(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",142)(1,"i",143),e.bIt("click",function(){const n=e.eBV(t),a=n.$implicit,l=n.index,s=e.XpG(2);return e.Njj(s.removeImage(a.id,l))}),e.k0s(),e.j41(2,"div",144),e.nrm(3,"img",145),e.k0s()()}if(2&r){const t=o.$implicit,i=e.XpG(2);e.R7$(3),e.Y8G("src",0==t.id?t.path:i.serverPath+t.path,e.B4B)}}function bo(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",71)(1,"h4",72),e.nrm(2,"span",85),e.k0s(),e.j41(3,"button",74),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(4,"div",75)(5,"form",null,5),e.nrm(7,"ngx-ui-loader",76),e.j41(8,"div",86)(9,"div",75)(10,"div",87)(11,"div",88)(12,"div",89)(13,"label",90),e.EFF(14,"orderManagement.order.services"),e.k0s()(),e.j41(15,"div",91)(16,"ng-select",92,6),e.nI1(18,"translate"),e.bIt("change",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.setService(n))}),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.addForm.serviceCode,n)||(a.addForm.serviceCode=n),e.Njj(n)}),e.k0s()(),e.j41(19,"div",91)(20,"div",93)(21,"input",94,7),e.nI1(23,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.addForm.price,n)||(a.addForm.price=n),e.Njj(n)}),e.k0s()()(),e.j41(24,"div",91)(25,"div",93)(26,"input",95,8),e.nI1(28,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.addForm.quantity,n)||(a.addForm.quantity=n),e.Njj(n)}),e.k0s()()(),e.j41(29,"div",91)(30,"div",93)(31,"input",96,9),e.nI1(33,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.addForm.note,n)||(a.addForm.note=n),e.Njj(n)}),e.k0s()()(),e.j41(34,"div",97)(35,"button",98),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.addService())}),e.nrm(36,"i",99),e.k0s()(),e.j41(37,"div",100)(38,"table",101)(39,"thead")(40,"tr")(41,"th",102),e.EFF(42," orderManagement.order.service "),e.k0s(),e.j41(43,"th",103),e.EFF(44," orderManagement.order.price "),e.k0s(),e.j41(45,"th",103),e.EFF(46," orderManagement.order.quantity "),e.k0s(),e.j41(47,"th",102),e.EFF(48," orderManagement.order.notes "),e.k0s(),e.j41(49,"th",103),e.EFF(50," orderManagement.order.actions "),e.k0s()()(),e.j41(51,"tbody"),e.DNE(52,ho,16,7,"tr",51)(53,uo,4,3,"tr",104),e.k0s()()()(),e.DNE(54,_o,6,1,"div",105),e.j41(55,"div",106)(56,"div",107)(57,"label",108),e.EFF(58,"orderManagement.order.assignedOrders.total"),e.k0s(),e.j41(59,"div",109),e.EFF(60),e.k0s()(),e.j41(61,"div",107)(62,"label",108),e.EFF(63,"orderManagement.order.assignedOrders.extraDiscount"),e.k0s(),e.j41(64,"div",110)(65,"button",111),e.EFF(66),e.nI1(67,"translate"),e.k0s(),e.j41(68,"div",112),e.nI1(69,"translate"),e.j41(70,"input",113),e.bIt("change",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.checkPrecentageChange(n))}),e.k0s(),e.j41(71,"span",114),e.EFF(72,"%"),e.k0s()(),e.j41(73,"input",115,10),e.bIt("change",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.calculatePrices())}),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.finishOrderForm.discountAdd,n)||(a.finishOrderForm.discountAdd=n),e.Njj(n)}),e.k0s()()(),e.j41(75,"div",107)(76,"label",108),e.EFF(77,"orderManagement.order.assignedOrders.tax"),e.k0s(),e.j41(78,"div",109),e.EFF(79),e.k0s()(),e.j41(80,"div",107)(81,"label",108),e.EFF(82,"orderManagement.order.assignedOrders.promotionDiscount"),e.k0s(),e.j41(83,"div",109),e.EFF(84),e.k0s()(),e.j41(85,"div",107)(86,"label",108),e.EFF(87,"orderManagement.order.assignedOrders.net"),e.k0s(),e.j41(88,"div",109),e.EFF(89),e.k0s()(),e.j41(90,"div",107)(91,"label",108),e.EFF(92,"orderManagement.order.assignedOrders.paid"),e.k0s(),e.j41(93,"div",109),e.EFF(94),e.k0s()(),e.j41(95,"div",107)(96,"label",116),e.EFF(97,"orderManagement.order.assignedOrders.paymentMethod"),e.k0s(),e.j41(98,"div",117)(99,"ng-select",118,11),e.nI1(101,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.finishOrderForm.paymentTypeCode,n)||(a.finishOrderForm.paymentTypeCode=n),e.Njj(n)}),e.k0s()()(),e.j41(102,"div",107)(103,"label",108),e.EFF(104,"orderManagement.order.assignedOrders.remain"),e.k0s(),e.j41(105,"div",109),e.EFF(106),e.k0s()(),e.j41(107,"div",119)(108,"label",108),e.EFF(109,"orderManagement.order.assignedOrders.notes"),e.k0s(),e.j41(110,"textarea",120,12),e.nI1(112,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.finishOrderForm.notes,n)||(a.finishOrderForm.notes=n),e.Njj(n)}),e.EFF(113,"                                "),e.k0s()(),e.j41(114,"div",121)(115,"label",108),e.EFF(116,"orderManagement.order.assignedOrders.notes"),e.k0s(),e.j41(117,"div",117)(118,"button",122),e.bIt("click",function(){e.eBV(t);const n=e.sdS(123);return e.Njj(n.click())}),e.EFF(119," orderManagement.order.assignedOrders.select "),e.k0s(),e.j41(120,"div",123),e.DNE(121,fo,4,1,"div",124),e.k0s()(),e.j41(122,"input",125,13),e.bIt("change",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.onFileChanged(n))}),e.k0s()()(),e.j41(124,"div",126)(125,"button",127),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.finishOrder())}),e.k0s(),e.j41(126,"button",128),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()()()}if(2&r){let t;const i=e.sdS(6),n=e.XpG();e.R7$(7),e.Y8G("hasProgressBar",!1)("fgsType",n.loaderOperationShap)("loaderId",n.deleteLoader),e.R7$(9),e.FS9("placeholder",e.bMT(18,35,"orderManagement.order.services")),e.Y8G("items",n.services)("multiple",!1),e.R50("ngModel",n.addForm.serviceCode),e.R7$(5),e.FS9("placeholder",e.bMT(23,37,"orderManagement.order.price")),e.R50("ngModel",n.addForm.price),e.R7$(5),e.FS9("placeholder",e.bMT(28,39,"orderManagement.order.quantity")),e.R50("ngModel",n.addForm.quantity),e.R7$(5),e.FS9("placeholder",e.bMT(33,41,"orderManagement.order.notes")),e.R50("ngModel",n.addForm.note),e.R7$(4),e.Y8G("disabled",!i.valid),e.R7$(17),e.Y8G("ngForOf",n.finishOrderForm.invoiceService),e.R7$(),e.Y8G("ngIf",0==n.finishOrderForm.invoiceService.length),e.R7$(),e.Y8G("ngIf",!1),e.R7$(6),e.SpI(" ",(null!==(t=null==n.finishOrderForm?null:n.finishOrderForm.total)&&void 0!==t?t:0).toFixed(2)," "),e.R7$(6),e.SpI(" ",e.bMT(67,43,"orderManagement.order.Discount")," "),e.R7$(2),e.FS9("pTooltip",e.bMT(69,45,"orderManagement.order.discount")),e.R7$(2),e.Y8G("checked",n.finishOrderForm.isPrecentage),e.R7$(3),e.R50("ngModel",n.finishOrderForm.discountAdd),e.R7$(6),e.SpI(" ",((null==n.finishOrderForm?null:n.finishOrderForm.tax)||0).toFixed(2)," "),e.R7$(5),e.SpI(" ",((null==n.finishOrderForm?null:n.finishOrderForm.promotionDiscount)||0).toFixed(2)," "),e.R7$(5),e.SpI(" ",((null==n.finishOrderForm?null:n.finishOrderForm.net)||0).toFixed(2)," "),e.R7$(5),e.SpI(" ",((null==n.finishOrderForm?null:n.finishOrderForm.paid)||0).toFixed(2)," "),e.R7$(5),e.FS9("placeholder",e.bMT(101,47,"orderManagement.order.assignedOrders.paymentMethod")),e.Y8G("items",n.paymentTypes)("multiple",!1),e.R50("ngModel",n.finishOrderForm.paymentTypeCode),e.R7$(7),e.SpI(" ",((null==n.finishOrderForm?null:n.finishOrderForm.remain)||0).toFixed(2)," "),e.R7$(4),e.FS9("placeholder",e.bMT(112,49,"orderManagement.order.notes")),e.R50("ngModel",n.finishOrderForm.notes),e.R7$(11),e.Y8G("ngForOf",n.images),e.R7$(4),e.Y8G("disabled",!n.finishOrderForm.paymentTypeCode)}}function vo(r,o){if(1&r&&e.nrm(0,"order-operation",146),2&r){const t=e.XpG();e.Y8G("isOrderEdit",!1)("isInner",!0)("orderCode",t.orderSelected)}}function Co(r,o){if(1&r){const t=e.RV6();e.j41(0,"order-timeline",147),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderSelected",t.orderSelected)}}function xo(r,o){if(1&r){const t=e.RV6();e.j41(0,"form",77,5),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.RollBack())}),e.nrm(2,"ngx-ui-loader",76),e.j41(3,"div",86)(4,"div",148)(5,"button",149),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"div",75)(7,"div",150),e.nrm(8,"lord-icon",151),e.j41(9,"div",152),e.nrm(10,"h3",153)(11,"p",154),e.k0s()(),e.j41(12,"div",155),e.nrm(13,"button",156),e.j41(14,"button",128),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}let Io=(()=>{class r extends D.w{constructor(t,i,n,a,l,s,I,b,T,S,y,R,M,w,N,F,E,$,L){super(t,i,I,n,a,l,s),this.baseService=n,this.authDaamService=b,this.invoicesService=T,this._servicesService=S,this.excelService=y,this._formDataService=R,this.cityService=M,this.districtService=w,this.channelService=N,this.orderAssignService=F,this.locationService=E,this.cancelReasonService=$,this.router=L,this.title="orderManagement.order.assignedOrders.title",this.titleOperation="orderManagement.order.assignedOrders.titleOperation",this.language=localStorage.getItem("language"),this.assignUsers=[],this.times=[],this.images=[],this.employees=[],this.searchForm={},this.envDomain=ce.c.url,this.finishOrderForm={invoiceService:[],invoiceAttachImages:[],usedShow:"",promotionDiscount:"",isPrecentage:!1},this.pagination={pageNumber:1,pageSize:100},this.isResolveList=!1,this.editPrice=0,this.isEditPrice=!1,this.formPassword={},this.OrderStatusEnum=pe,this.roles=[],this.userTypes=[],this.actives=[{id:!0,name:"active"},{id:!1,name:"noActive"}],this.serverPath=ce.c.mediaUrl,this.countLoad=2,this.orderSelected=0,this.cities=[],this.districts=[],this.channels=[],this.services=[],this.statusList=[],this.cancelReasons=[],this.addForm={},this.location=null,this.locationsTest=[{lat:30.06979,lng:31.346833},{lat:30.069757,lng:31.346538},{lat:30.069702,lng:31.34613},{lat:30.0697,lng:31.345984},{lat:30.069653,lng:31.345732},{lat:30.069665,lng:31.345533},{lat:30.069655,lng:31.345366},{lat:30.069643,lng:31.344993},{lat:30.06958,lng:31.344451},{lat:30.06955,lng:31.344108},{lat:30.06952,lng:31.343781},{lat:30.069497,lng:31.343435},{lat:30.06946,lng:31.343179},{lat:30.069435,lng:31.342977},{lat:30.069414,lng:31.34277},{lat:30.069377,lng:31.342558},{lat:30.069358,lng:31.342346},{lat:30.069323,lng:31.341997},{lat:30.069314,lng:31.341958},{lat:30.069289,lng:31.341795},{lat:30.069275,lng:31.341691},{lat:30.069251,lng:31.341555},{lat:30.069233,lng:31.341439},{lat:30.069232,lng:31.341325},{lat:30.069226,lng:31.341164},{lat:30.06926,lng:31.340787}],this.setDates=(G,oe,fe)=>{if(G?.from||G?.to){const Le=G.to||G.from;this.pagination[oe]=this.datePipe.transform(G.from||G.to,"yyyy-MM-ddT00:00:00"),this.pagination[fe]=this.datePipe.transform(Le,"yyyy-MM-ddT23:59:59.999")}else this.pagination[oe]=null,this.pagination[fe]=null},this.finishOrderForm.invoiceAttachImages=[],this.statusList=this.baseService.getTeamStatus(),this.loadentities(),this.GetCities(),this.GetServicesDropDown(),this.GetPaymentTypesDropDown(),this.GetChannels(),this.translateStatus(),this.GetReturnReasons(),this.openHub()}GetReturnReasons(){this.cancelReasonService.getDropDown().subscribe(t=>{this.cancelReasons=t.data},t=>{console.log(t)})}translateStatus(){this.statusList.forEach(t=>{t.name=this.getTranslationText("orderManagement.order."+t.name)})}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetDistricts(t){this.finishOrderForm.districtCode=null,this.districtService.getByCityId(t).subscribe(i=>{this.districts=i.data},i=>{console.log(i)})}GetChannels(){this.channelService.getDropDown().subscribe(t=>{this.channels=t.data},t=>{console.log(t)})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,u.Q)(this.notifier)).subscribe(i=>{i?this.alertService.success():this.alertService.error("general.message."+i)},i=>{this.alertService.error()})}mapRegisterForm(t){let i={...t};return i.employeeCode=0,i}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader(f.a7),this.setDates(t.dates,"visitDateFrom","visitDateTo"),this.setDates(t.creationDates,"creationDateFrom","creationDateTo"),this.loadentities()}loadentities(){this.ngxLoader.startLoader("assignLoader"),this.pagination.statusFilter=this.OrderStatusEnum.Assigned,this.orderAssignService.get(this.pagination).pipe((0,u.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader("assignLoader"),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader("assignLoader"),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[]}mapExcel(){let t=[];return this.entities.forEach(i=>{t.push({"Order Code":i.orderCode,"City Name":i.cityName,"District Name":i.districtName?i.districtName:"--","Agent Name":i.agentName,Mobile:i.mobile,"Assigned To":i.teamNames,Times:i.workTimes,Services:this.getServices(i.services),Status:this.translateService.instant(`orderManagement.order.${i.teamStatusName}`)})}),t}reCallOrder(){this.ngxLoader.startLoader(f.Fq),this.baseService.UpdateCallCounter(this.orderSelected).pipe((0,Y.O)(),(0,P.c)(this.mainDelay),(0,H.Z)(),(0,u.Q)(this.notifier),(0,B.j)(()=>this.ngxLoader.stopLoader(f.Fq))).subscribe({next:t=>{this.modalService.dismissAll(),this.loadentities(),this.alertService.success()}})}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}goEdit(t){this.router.navigateByUrl("/managment/order/new")}getStatus(t){return t.isCancel?"bg-warning-subtle text-warning":t.isFinish?"bg-success-subtle text-success":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen||t.isFree?"bg-warning-subtle text-warning":"bg-success-subtle text-success"}getTrnslate(t){return t.isCancel?"orderManagement.order.cancel":t.isFinish?"orderManagement.order.finish":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen?"orderManagement.order.reopen":t.isFree?"orderManagement.order.free":"orderManagement.order.finished"}openModal(t,i,n="md"){this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}oncityChange(t){this.GetDistricts(t.code)}getTimes(t){return t.split(",")}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}openChangeStatusModal(t,i,n="md"){this.form={},this.form.teamStatus=t.teamStatus,this.finishOrderForm.orderCode=t.orderCode,this.orderSelected=t.orderCode,this.modalService.open(i,{centered:!0,size:n})}changeStatus(){this.ngxLoader.startLoader(this.operationLoader),this.baseService.ChangeTeamStatus({OrderCode:this.orderSelected,teamStatus:this.form.teamStatus,cancelReasonCode:this.form.cancelReasonCode,teamStatusNotes:this.form.teamStatusNotes}).pipe((0,u.Q)(this.notifier),(0,B.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(i=>{this.loadentities(),this.alertService.success(),this.modalService.dismissAll()},()=>{this.alertService.error()})}finishOrder(){this.ngxLoader.startLoader(f.Fq),this.finishOrderForm.discountType=this.finishOrderForm.isPrecentage?2:1;let t=this._formDataService.formatFormData(this.finishOrderForm);this.invoicesService.SaveInvoice(t).subscribe(i=>{this.ngxLoader.stopLoader(f.Fq),this.loadentities(),this.modalService.dismissAll()},i=>{console.log(i),this.ngxLoader.stopLoader(f.Fq)})}GetServicesDropDown(){this._servicesService.getDropDown().subscribe(t=>{this.services=t.data},t=>{console.log(t)})}GetOrderServiceAndPayment(t){this.images=[],this.finishOrderDetails=t,this.finishOrderForm=[],this.finishOrderForm={...this.finishOrderForm,orderCode:t.orderCode,discountAdd:t.discountAmountAdd},this.invoicesService.GetOrderServiceAndPayment(t.orderCode).subscribe(n=>{this.finishOrderForm.invoiceService=[],this.finishOrderForm.invoiceAttachImages=[],this.OrderServiceAndPayment=n.data,n.data.forEach(a=>{this.finishOrderForm.discountAdd=a.discountAdd,this.finishOrderForm.isPrecentage=a.isPrecentage,this.finishOrderForm.invoiceService.push({serviceCode:a.serviceCode,service:a.serviceName,notes:a.notes,price:a.price,quantity:a.quantity,paidValue:a.paidValue,isEdit:!1})}),this.calculatePrices()},n=>{console.log(n)})}GetPaymentTypesDropDown(){this.baseService.GetOrderLookUp().subscribe(t=>{this.paymentTypes=t.data.paymentTypes},t=>{console.log(t)})}setService(t){this.finishOrderForm.service=t.name,this.finishOrderForm.price=t.price,this.addForm.price=t.price,this.addForm.quantity=1}checkPrecentageChange(t){this.finishOrderForm.isPrecentage=t.target.checked,this.calculatePrices()}addService(){let t=this.services.find(i=>i.code==this.addForm.serviceCode);this.finishOrderForm.invoiceService.push({service:t.name,serviceCode:this.addForm.serviceCode,price:this.addForm.price,quantity:this.addForm.quantity,notes:this.addForm.note,paidValue:0,isEdit:!1}),this.addForm={},this.calculatePrices()}calculatePrices(){const t=this.finishOrderForm.discountAdd||0;let i=0,n=0;this.finishOrderForm.invoiceService.forEach(b=>{i+=b.quantity?+b.price*+b.quantity:+b.price,n=b.paidValue});let a=0,l=0,s=0;a=.15*i,l=this.finishOrderForm.isPrecentage?i+a-(i+a)*t*.01:i+a-t,s=l-n,this.finishOrderForm={...this.finishOrderForm,net:l,tax:a,total:i,remain:s,paid:n}}editEachPrice(t){this.finishOrderForm.invoiceService[t].price=this.editPrice,this.isEditPrice=!1,this.calculatePrices()}deleteService(t){console.log(t),this.finishOrderForm.invoiceService.splice(t,1),this.calculatePrices()}onFileChanged(t){if(t.target.files&&t.target.files[0]){let i=t.target.files.length;for(let n=0;n<i;n++){let a=new FileReader;this.finishOrderForm.invoiceAttachImages.push({attachImage:t.target.files.item(n),type:"file"}),a.onload=l=>{this.images.push({id:0,path:l.target.result,completePath:l.target.result})},a.readAsDataURL(t.target.files[n])}}}removeImage(t,i){this.finishOrderForm.invoiceAttachImages.splice(i,1),this.images.splice(i,1)}getServices(t){return t.split("#")}OpenOrderTimeLineModel(t,i,n="md"){this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}RollBack(){this.ngxLoader.startLoader(f.Fq),this.baseService.RemoveAssign(this.orderSelected).pipe((0,Y.O)(),(0,P.c)(this.mainDelay),(0,H.Z)(),(0,u.Q)(this.notifier),(0,B.j)(()=>this.ngxLoader.stopLoader(f.Fq))).subscribe({next:t=>{this.modalService.dismissAll(),this.loadentities(),this.alertService.success()}})}openHub(){this.connection=(new qs.$).withUrl(this.envDomain+"orderTrackerHub",{accessTokenFactory:()=>localStorage.getItem("token")}).withAutomaticReconnect().build(),this.connection.start().then(()=>{console.log("SignalR Connected!"),this.checkStatusToStart()}).catch(t=>console.log("err",t?.toString()))}checkStatusToStart(){let i,t=[],n={};for(let a=0;a<this.entities?.length;a++)1==this.entities[a]?.teamStatus&&(t.push(this.entities[a]?.orderCode),i=this.entities[a]?.teamCode);n={orderCodes:t,teamCode:i},t.length>0?this.interval=setInterval(()=>{this.fetchLocation(n)},5e3):clearInterval(this.interval)}fetchLocation(t){this.locationService.getCurrentLocation().then(i=>{this.location=i;let n={orderCode:t.orderCodes,teamCode:t.teamCode,latitude:i.latitude,longitude:i.longitude};console.log(this.location),console.log(n),this.connection.invoke("SendLocationData",n).catch(a=>console.error("Error while sending Location: "+a))},i=>{console.log(i)})}sendTestLocation(){let t=-1;this.interval=setInterval(()=>{let i={orderCodes:[90392],teamCode:26,latitude:this.locationsTest[t+1]?.lat,longitude:this.locationsTest[t+1]?.lng};console.log(i),console.log(t),t+=1,t===this.locationsTest.length-1&&clearInterval(this.interval),this.connection.invoke("SendLocationData",i).catch(n=>console.error("Error while sending Location: "+n))},5e3)}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(_.nX),e.rXU(p.c$),e.rXU(k.Q),e.rXU(O.u),e.rXU(d.vh),e.rXU(C.eD),e.rXU(h.Bq),e.rXU(g.J),e.rXU(Ie.U),e.rXU(ye.N),e.rXU(z.V),e.rXU(Fe.Q),e.rXU(Q.h),e.rXU(te.m),e.rXU(ne.l),e.rXU(De),e.rXU(Ws),e.rXU(_e.e),e.rXU(_.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-team-assigned-orders"]],viewQuery:function(i,n){if(1&i&&e.GBs(Qs,5),2&i){let a;e.mGM(a=e.lsd())&&(n.FileInput=a.first)}},features:[e.Vt3],decls:38,vars:24,consts:[["changeStatusModal",""],["finishOrderModal",""],["orderModel",""],["OrderTimeLineModel",""],["RollBackModal",""],["formEntity","ngForm"],["serviceCode","ngModel"],["price","ngModel"],["quantity","ngModel"],["note","ngModel"],["discountAdd","ngModel"],["paymentTypeCode","ngModel"],["notes","ngModel"],["FileInput",""],[1,"row"],[1,"col-lg-12"],[1,"grid"],[1,"card"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[1,"card-body"],[3,"reset","search","exportXlsx","showAdd","showExport","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","search","id","agentName","name","agentName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["InputTirmFilter","","type","tel","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"col-12","col-md-4","mb-2"],["type","text","mwlFlatpickr","","id","isDate","mode","range",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],["class","col-xxl-3 col-xl-4 col-lg-4 col-md-6 my-2",4,"ngFor","ngForOf"],[1,"col-xxl-3","col-xl-4","col-lg-4","col-md-6","my-2"],[1,"card","ribbon-box","border","shadow-none","mb-lg-0","material-shadow"],[1,"mb-4","d-flex"],[1,"d-flex","justify-content-between","mt-5"],[1,"text-muted"],[1,"ri-calendar-2-fill","text-muted","me-1","align-bottom"],[1,"text-muted","ms-2","text-muted","text-decoration-underline"],["href","javascript:void(0);"],[1,"text-center"],[1,"ri-user-2-fill","text-muted","me-1","align-bottom"],[1,"d-flex","gap-4","mb-1","justify-content-between"],[1,"text-success"],[1,"ri-map-pin-2-line","text-success","me-1","align-bottom"],["class","badge bg-danger-subtle text-danger","translate","orderManagement.order.nothing",4,"ngIf"],["class","badge bg-success-subtle text-success",4,"ngIf"],[1,"ri-phone-fill","text-info","me-1","align-bottom"],[1,"cursor-pointer","badge","bg-info-subtle","text-info","fs-6",3,"click"],[1,"ri-clipboard-line"],[1,"d-flex","gap-4"],[1,"ri-shake-hands-fill","text-primary","me-1","align-bottom"],[4,"ngFor","ngForOf"],[1,"px-5"],[1,"d-flex","justify-content-between",2,"min-height","112px"],[1,"w-50","text-left"],[1,"ri-group-fill","text-primary","me-1","align-bottom"],[1,"w-50","text-right"],[1,"ri-history-fill","text-primary","me-1","align-bottom"],[1,"mt-2","hstack","gap-2"],["class","btn  btn-sm btn-soft-success w-100",3,"click",4,"hasPermission"],["href","javascript:void(0);","class","btn btn-sm btn-soft-primary w-100",3,"click",4,"hasPermission"],["translate","orderManagement.order.nothing",1,"badge","bg-danger-subtle","text-danger"],[1,"badge","bg-success-subtle","text-success"],[1,"badge","bg-primary-subtle","text-primary","mx-1"],[1,"btn","btn-sm","btn-soft-success","w-100",3,"click"],[1,"ri-swap-line","label-icon","align-bottom","rounded-pill","fs-16","me-2"],["translate","orderManagement.order.changeTeamStatus"],["href","javascript:void(0);",1,"btn","btn-sm","btn-soft-primary","w-100",3,"click"],[1,"ri-checkbox-circle-fill","align-bottom"],["translate","orderManagement.order.finishOrder"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["translate","orderManagement.order.changeTeamStatus",1,"fw-bold","fs-4"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"hasProgressBar","fgsType","loaderId"],[3,"ngSubmit"],[1,"mb-3"],["for","actionMismatch","translate","",1,"fw-bold","form-label"],["name","teamStatus","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["rows","2","InputTirmFilter","","name","teamStatusNotes","type","text","id","teamStatusNotes",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],["translate","orderManagement.order.assignedOrders.finishOrder",1,"fw-bold","fs-4"],[1,"modal-content"],[1,""],[1,"mt-2","row"],[1,"col-lg-2","mb-3"],["translate","",1,"fw-bold","form-label","required","w-100"],[1,"col-12","col-lg-2","mb-2"],["name","serviceCode","bindValue","code","bindLabel","name","required","",3,"change","ngModelChange","items","multiple","placeholder","ngModel"],[1,"input-group"],["InputTirmFilter","","name","note","type","number","id","price",1,"form-control","required","fs-6",2,"pointer-events","none",3,"ngModelChange","placeholder","ngModel"],["InputTirmFilter","","name","quantity","type","number","id","quantity","required","",1,"form-control","required","fs-6",3,"ngModelChange","placeholder","ngModel"],["InputTirmFilter","","name","note","type","text","id","notes",1,"form-control","fs-6",3,"ngModelChange","placeholder","ngModel"],[1,"col-lg-2","mb-2"],[1,"btn","btn-success","py-1","px-2",3,"click","disabled"],[1,"ri-add-fill",2,"font-size","1.2rem"],[1,"col-12","text-center","mt-2"],[1,"table","table-bordered"],["translate","",2,"width","20%"],["translate","",2,"width","10%"],[4,"ngIf"],["class","pt-2 row",4,"ngIf"],[1,"pt-2","row"],[1,"col-12","col-lg-6","mb-3","d-flex"],["translate","",1,"fw-bold","form-label","w-25"],[1,"form-control","w-75","custom-form-input"],[1,"input-group","custom-form-input","w-75"],["type","button",1,"btn","btn-danger"],["tooltipPosition","top",1,"input-group-text","d-inline",3,"pTooltip"],["type","checkbox","aria-label","Checkbox for following text input",1,"form-check-input",3,"change","checked"],[1,"p-1"],["InputTirmFilter","","name","discountAdd","type","text","id","discountAdd",1,"form-control","text-right",3,"change","ngModelChange","ngModel"],["translate","",1,"fw-bold","form-label","required","w-25"],[1,"w-75"],["name","paymentTypeCode","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],[1,"col-12","col-lg-12","mb-3","d-flex"],["InputTirmFilter","","name","note","rows","1",1,"form-control","fs-6","w-75",3,"ngModelChange","placeholder","ngModel"],[1,"col-12","col-lg-12","mt-3","d-flex"],["translate","",1,"btn","btn-warning","px-5",3,"click"],[1,"my-3","d-flex"],["class","avatar-lg mx-2 position-relative",4,"ngFor","ngForOf"],["multiple","","value","","type","file","accept","image/png, image/gif, image/jpeg",1,"form-control","d-none",3,"change"],[1,"d-flex","gap-2","justify-content-end","my-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger",3,"click","disabled"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],["class","d-flex",4,"ngIf"],[1,"btn","btn-sm","btn-danger","py-0","px-2","me-1",3,"click"],[1,"ri-delete-bin-3-fill",2,"font-size","1.2rem"],["class","btn btn-sm  btn-success py-0 px-2",3,"click",4,"ngIf"],[1,"d-flex"],["InputTirmFilter","","type","text",1,"form-control","fs-6",3,"ngModelChange","name","placeholder","ngModel","id"],[1,"btn","btn-success","py-1","px-2",3,"click"],[1,"ri-edit-2-fill",2,"font-size","1.2rem"],[1,"btn","btn-sm","btn-success","py-0","px-2",3,"click"],["colspan","4"],[1,"col-12","col-lg-12","mb-3"],["translate","",1,"fw-bold","form-label"],[1,"form-control","custom-form-textArea"],[1,"avatar-lg","mx-2","position-relative"],[1,"position-absolute","bx","bx-x-circle","text-white",2,"background","red","top","1px","right","-4px","font-size","1rem","border-radius","50%",3,"click"],[1,"avatar-title","bg-light","rounded"],["id","product-img1","alt","",1,"avatar-md","h-auto",3,"src"],[3,"isOrderEdit","isInner","orderCode"],[3,"dismiss","orderSelected"],[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"mt-2","text-center"],["src","https://cdn.lordicon.com/gdfrsvpt.json","stroke","bold","state","hover-oscillate","trigger","loop","colors","primary:#f7b84b,secondary:#f06548",2,"width","130px","height","130px"],[1,"pt-2","fs-15","mx-4","mx-sm-5"],["translate","orderManagement.order.AreYouSureMessage"],[1,"text-muted","mx-4","mb-0"],[1,"d-flex","gap-2","justify-content-center","mt-4","mb-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger"]],template:function(i,n){if(1&i){const a=e.RV6();e.j41(0,"div",14)(1,"div",15)(2,"div",16)(3,"div",17),e.nrm(4,"ngx-ui-loader",18),e.j41(5,"div",19)(6,"base-filter",20),e.bIt("reset",function(){return e.eBV(a),e.Njj(n.onReset())})("search",function(){return e.eBV(a),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(a),e.Njj(n.onExportXlsx())}),e.qex(7,21),e.j41(8,"div",22)(9,"div",23)(10,"input",24),e.nI1(11,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.orderCode,s)||(n.pagination.orderCode=s),e.Njj(s)}),e.k0s(),e.nrm(12,"i",25),e.k0s()(),e.j41(13,"div",22)(14,"div",23)(15,"input",26),e.nI1(16,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.agentName,s)||(n.pagination.agentName=s),e.Njj(s)}),e.k0s(),e.nrm(17,"i",25),e.k0s()(),e.j41(18,"div",22)(19,"div",23)(20,"input",27),e.nI1(21,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.mobile,s)||(n.pagination.mobile=s),e.Njj(s)}),e.k0s(),e.nrm(22,"i",25),e.k0s()(),e.j41(23,"div",28)(24,"input",29),e.nI1(25,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.creationDates,s)||(n.searchForm.creationDates=s),e.Njj(s)}),e.k0s()(),e.bVm(),e.k0s()()(),e.j41(26,"div",14),e.DNE(27,oo,54,32,"div",30),e.k0s()()()(),e.DNE(28,lo,23,11,"ng-template",null,0,e.C5r)(30,bo,127,51,"ng-template",null,1,e.C5r)(32,vo,1,3,"ng-template",null,2,e.C5r)(34,Co,1,1,"ng-template",null,3,e.C5r)(36,xo,15,3,"ng-template",null,4,e.C5r)}2&i&&(e.R7$(4),e.Y8G("loaderId","assignLoader"),e.R7$(2),e.Y8G("showAdd",!1)("showExport",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(11,16,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.orderCode),e.R7$(5),e.FS9("placeholder",e.bMT(16,18,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.agentName),e.R7$(5),e.FS9("placeholder",e.bMT(21,20,"orderManagement.order.mobile")),e.R50("ngModel",n.pagination.mobile),e.R7$(4),e.FS9("placeholder",e.bMT(25,22,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(3),e.Y8G("ngForOf",n.entities))},dependencies:[d.Sq,d.bT,c.qT,c.me,c.Q0,c.BC,c.cb,c.YS,c.vS,c.cV,j.kL,q.b,ge.L,p.Mm,C.Cv,U.vr,W.m,v.p,de.m,me,d.vh,p.D9],encapsulation:2})}}return r})();function Fo(r,o){if(1&r&&(e.j41(0,"span",55),e.EFF(1),e.k0s()),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI("",t.districtName," ")}}function Mo(r,o){1&r&&e.nrm(0,"span",56)}function jo(r,o){1&r&&e.nrm(0,"span",57)}function To(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",23)(1,"div",11)(2,"div",12)(3,"div",24)(4,"button",25),e.nI1(5,"translate"),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),l=e.sdS(28);return a.getEvalById(n.evaluationCode),e.Njj(a.openModal(n.evaluationCode,l,"lg"))}),e.nrm(6,"i",26),e.k0s()(),e.j41(7,"div",27)(8,"p",28),e.nrm(9,"i",29),e.EFF(10),e.nI1(11,"date"),e.k0s(),e.j41(12,"p",30),e.EFF(13),e.nI1(14,"translate"),e.k0s()(),e.j41(15,"a",31)(16,"h5",32),e.nrm(17,"i",33),e.EFF(18),e.k0s()(),e.j41(19,"div",34)(20,"div",35),e.nrm(21,"i",36),e.EFF(22),e.DNE(23,Fo,2,1,"span",37),e.k0s(),e.j41(24,"div"),e.nrm(25,"i",38),e.j41(26,"span",39),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.copytext(n.mobile))}),e.EFF(27),e.nrm(28,"i",40),e.k0s()()(),e.nrm(29,"hr"),e.j41(30,"div",41)(31,"div",42),e.qex(32),e.nrm(33,"i",43),e.nI1(34,"translate"),e.j41(35,"span",44),e.EFF(36),e.k0s(),e.bVm(),e.k0s(),e.j41(37,"div",42),e.nrm(38,"i",45),e.nI1(39,"translate"),e.DNE(40,Mo,1,0,"span",46)(41,jo,1,0,"span",47),e.k0s()(),e.j41(42,"div",48)(43,"a",49),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),l=e.sdS(26);return a.getEvalById(n.evaluationCode),e.Njj(a.openModal(n.evaluationCode,l,"lg"))}),e.nrm(44,"i",50)(45,"span",51),e.k0s(),e.j41(46,"a",52),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),l=e.sdS(30);return e.Njj(a.openModal(n.evaluationCode,l))}),e.nrm(47,"i",53)(48,"span",54),e.k0s()()()()()}if(2&r){const t=o.$implicit;e.R7$(4),e.FS9("pTooltip",e.bMT(5,13,"general.action.view")),e.R7$(6),e.SpI(" ",e.i5U(11,15,t.visitDate,"yyyy-MM-dd")," "),e.R7$(3),e.Lme(" ",e.bMT(14,18,"orderManagement.order.orderCode"),": #SO#",t.evaluationCode," "),e.R7$(5),e.SpI(" ",t.agentName," "),e.R7$(4),e.SpI(" ",t.cityName," "),e.R7$(),e.Y8G("ngIf",t.districtName),e.R7$(4),e.SpI("",t.mobile," "),e.R7$(6),e.FS9("pTooltip",e.bMT(34,20,"orderManagement.order.teamName")),e.R7$(3),e.SpI(" ",t.teamName," "),e.R7$(2),e.FS9("pTooltip",e.bMT(39,22,"orderManagement.priceEvaluation.status")),e.R7$(2),e.Y8G("ngIf",t.isUrgent),e.R7$(),e.Y8G("ngIf",!t.isUrgent)}}function So(r,o){if(1&r){const t=e.RV6();e.j41(0,"cancel-evaluation-model",58),e.bIt("success",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.loadentities())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderId",t.orderSelected)}}function ko(r,o){if(1&r&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s()()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t.serviceCode),e.R7$(2),e.JRh(t.price),e.R7$(2),e.JRh(t.notes)}}function yo(r,o){1&r&&(e.j41(0,"tr")(1,"td",92),e.EFF(2),e.nI1(3,"translate"),e.k0s()()),2&r&&(e.R7$(2),e.JRh(e.bMT(3,1,"orderManagement.order.noData")))}function Ro(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",59)(1,"h4",60),e.nrm(2,"span",61),e.k0s(),e.j41(3,"button",62),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(4,"form",null,4),e.nrm(6,"ngx-ui-loader",63),e.j41(7,"div",64)(8,"div",65)(9,"div",66)(10,"div",7)(11,"div",67)(12,"label",68),e.EFF(13,"orderManagement.order.cityName"),e.k0s(),e.j41(14,"div",69),e.EFF(15),e.k0s()(),e.j41(16,"div",67)(17,"label",68),e.EFF(18,"orderManagement.order.districtName"),e.k0s(),e.j41(19,"div",69),e.EFF(20),e.k0s()(),e.j41(21,"div",67)(22,"label",70),e.EFF(23,"orderManagement.order.date"),e.k0s(),e.j41(24,"div",69),e.EFF(25),e.nI1(26,"date"),e.k0s()()(),e.j41(27,"div",71)(28,"div",72)(29,"table",73)(30,"thead")(31,"tr")(32,"th",74),e.EFF(33," orderManagement.order.service "),e.k0s(),e.j41(34,"th",74),e.EFF(35," orderManagement.order.price "),e.k0s(),e.j41(36,"th",74),e.EFF(37," orderManagement.order.notes "),e.k0s()()(),e.j41(38,"tbody"),e.DNE(39,ko,7,3,"tr",75)(40,yo,4,3,"tr",76),e.k0s()()()(),e.j41(41,"div",77)(42,"div",78)(43,"label",79),e.EFF(44),e.nI1(45,"translate"),e.k0s(),e.j41(46,"span",80),e.EFF(47),e.nI1(48,"translate"),e.nI1(49,"translate"),e.k0s()(),e.j41(50,"div",81)(51,"label",82),e.EFF(52,"orderManagement.order.notes"),e.k0s(),e.j41(53,"span",83),e.EFF(54),e.k0s()(),e.j41(55,"div",84)(56,"label",85),e.EFF(57,"orderManagement.order.assignDate"),e.k0s(),e.j41(58,"div",86)(59,"input",87,5),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.assignForm.assignDate,n)||(a.assignForm.assignDate=n),e.Njj(n)}),e.k0s()()(),e.j41(61,"div",84)(62,"label",85),e.EFF(63,"orderManagement.order.team"),e.k0s(),e.j41(64,"ng-select",88,6),e.nI1(66,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.assignForm.teamCode,n)||(a.assignForm.teamCode=n),e.Njj(n)}),e.k0s()()(),e.j41(67,"div",89)(68,"button",90),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.ChangeAssignTeam())}),e.k0s(),e.j41(69,"button",91),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()()}if(2&r){const t=e.XpG();e.R7$(6),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader),e.R7$(9),e.SpI(" ",t.evaluationDetails.cityName||"--"," "),e.R7$(5),e.SpI(" ",t.evaluationDetails.districtName||"--"," "),e.R7$(5),e.SpI(" ",e.i5U(26,16,t.evaluationDetails.visitDate,"yyyy-MM-dd")," "),e.R7$(14),e.Y8G("ngForOf",t.evaluationDetails.evaluationservices),e.R7$(),e.Y8G("ngIf",!t.evaluationDetails.evaluationservices),e.R7$(4),e.SpI(" ",e.bMT(45,19,"orderManagement.order.isUrgent")," "),e.R7$(3),e.SpI(" ",t.evaluationDetails.isUrgent?e.bMT(48,21,"orderManagement.order.yes"):e.bMT(49,23,"orderManagement.order.no")," "),e.R7$(7),e.SpI(" ",t.evaluationDetails.notes||"--"," "),e.R7$(5),e.R50("ngModel",t.assignForm.assignDate),e.R7$(5),e.FS9("placeholder",e.bMT(66,25,"orderManagement.order.team")),e.Y8G("items",t.teams)("multiple",!1),e.R50("ngModel",t.assignForm.teamCode)}}function Eo(r,o){if(1&r&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s()()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t.serviceCode),e.R7$(2),e.JRh(t.price),e.R7$(2),e.JRh(t.notes)}}function wo(r,o){1&r&&(e.j41(0,"tr")(1,"td",92),e.EFF(2),e.nI1(3,"translate"),e.k0s()()),2&r&&(e.R7$(2),e.JRh(e.bMT(3,1,"orderManagement.order.noData")))}function No(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",59)(1,"h4",60),e.nrm(2,"span",93),e.k0s(),e.j41(3,"button",62),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(4,"form",null,4),e.nrm(6,"ngx-ui-loader",63),e.j41(7,"div",64)(8,"div",65)(9,"div",66)(10,"div",7)(11,"div",67)(12,"label",68),e.EFF(13,"orderManagement.order.cityName"),e.k0s(),e.j41(14,"div",69),e.EFF(15),e.k0s()(),e.j41(16,"div",67)(17,"label",68),e.EFF(18,"orderManagement.order.districtName"),e.k0s(),e.j41(19,"div",69),e.EFF(20),e.k0s()(),e.j41(21,"div",67)(22,"label",70),e.EFF(23,"orderManagement.order.date"),e.k0s(),e.j41(24,"div",69),e.EFF(25),e.nI1(26,"date"),e.k0s()()(),e.j41(27,"div",71)(28,"div",72)(29,"table",73)(30,"thead")(31,"tr")(32,"th",74),e.EFF(33," orderManagement.order.service "),e.k0s(),e.j41(34,"th",74),e.EFF(35," orderManagement.order.price "),e.k0s(),e.j41(36,"th",74),e.EFF(37," orderManagement.order.notes "),e.k0s()()(),e.j41(38,"tbody"),e.DNE(39,Eo,7,3,"tr",75)(40,wo,4,3,"tr",76),e.k0s()()()(),e.j41(41,"div",77)(42,"div",78)(43,"label",79),e.EFF(44),e.nI1(45,"translate"),e.k0s(),e.j41(46,"span",80),e.EFF(47),e.nI1(48,"translate"),e.nI1(49,"translate"),e.k0s()(),e.j41(50,"div",81)(51,"label",82),e.EFF(52,"orderManagement.order.notes"),e.k0s(),e.j41(53,"span",83),e.EFF(54),e.k0s()()(),e.j41(55,"div",89)(56,"button",91),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()()}if(2&r){const t=e.XpG();e.R7$(6),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader),e.R7$(9),e.SpI(" ",t.evaluationDetails.cityName||"--"," "),e.R7$(5),e.SpI(" ",t.evaluationDetails.districtName||"--"," "),e.R7$(5),e.SpI(" ",e.i5U(26,11,t.evaluationDetails.visitDate,"yyyy-MM-dd")," "),e.R7$(14),e.Y8G("ngForOf",t.evaluationDetails.evaluationservices),e.R7$(),e.Y8G("ngIf",!t.evaluationDetails.evaluationservices),e.R7$(4),e.SpI(" ",e.bMT(45,14,"orderManagement.order.isUrgent")," "),e.R7$(3),e.SpI(" ",t.evaluationDetails.isUrgent?e.bMT(48,16,"orderManagement.order.yes"):e.bMT(49,18,"orderManagement.order.no")," "),e.R7$(7),e.SpI(" ",t.evaluationDetails.notes||"--"," ")}}function Do(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",59)(1,"h4",60),e.nrm(2,"span",94),e.k0s(),e.j41(3,"button",62),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(4,"form",null,4),e.nrm(6,"ngx-ui-loader",63),e.j41(7,"div",64)(8,"div",65)(9,"div",95),e.nrm(10,"lord-icon",96),e.j41(11,"div",97),e.nrm(12,"h3",98)(13,"p",99),e.k0s()(),e.j41(14,"div",100)(15,"button",90),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.FinishEvaluation())}),e.k0s(),e.j41(16,"button",91),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()}if(2&r){const t=e.XpG();e.R7$(6),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}let Oo=(()=>{class r extends D.w{constructor(t,i,n,a,l,s,I,b,T,S,y,R,M,w){super(t,i,b,n,l,s,I),this.baseService=n,this.orderPendingService=a,this.authDaamService=T,this.excelService=S,this.cityService=y,this.districtService=R,this.channelService=M,this.router=w,this.title="orderManagement.assignEvaluation.title",this.titleOperation="orderManagement.assignEvaluation.titleOperation",this.keySelected="",this.assignUsers=[],this.times=[],this.teams=[],this.employees=[],this.searchForm={},this.assignForm={},this.isResolveList=!1,this.employeeGroups=[],this.activeindex="1",this.active=1,this.formPassword={},this.roles=[],this.userTypes=[],this.actives=[{id:!0,name:"active"},{id:!1,name:"noActive"}],this.countLoad=2,this.orderSelected=0,this.selectedCallCounter=0,this.cities=[],this.districts=[],this.channels=[],this.callHistory={},this.setDates=(N,F,E)=>{if(N?.from||N?.to){const L=N.to||N.from;this.pagination[F]=this.datePipe.transform(N.from||N.to,"yyyy-MM-ddT00:00:00"),this.pagination[E]=this.datePipe.transform(L,"yyyy-MM-ddT23:59:59.999")}else this.pagination[F]=null,this.pagination[E]=null},this.loadentities(),this.GetCities(),this.getEvalTeams()}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetDistricts(t){this.districtService.getByCityId(t).subscribe(i=>{this.districts=i.data},i=>{console.log(i)})}GetChannels(){this.channelService.getDropDown().subscribe(t=>{this.channels=t.data},t=>{console.log(t)})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,u.Q)(this.notifier)).subscribe(i=>{i?this.alertService.success():this.alertService.error("general.message."+i)},i=>{this.alertService.error()})}mapRegisterForm(t){let i={...t};return i.employeeCode=0,i}onSearch(){this.ngxLoader.startLoader(f.a7);let t={...this.searchForm};this.setDates(t.dates,"creationDateFrom","creationDateTo"),this.loadentities()}loadentities(){this.countLoad=this.countLoad+1,(!this.isResolveList||1!==this.countLoad)&&(this.ngxLoader.startLoader("assignEvalLoader"),this.pagination.isEvaluationAssign=!0,this.baseService.get(this.pagination).pipe((0,u.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader("assignEvalLoader"),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader("assignEvalLoader"),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}mapExcel(){let t=[];return this.entities.forEach(i=>{t.push({orderCode:i.orderCode,visitDate:i.visitDate,notes:i.notes,createdDate:i.createdDate,assignDate:i.assignDate,finishDate:i.finishDate,districtName:i.districtName,cityName:i.cityName,agentName:i.agentName,mobile:i.mobile,email:i.email,creationUser:i.creationUser,channelName:i.channelName,teamNames:i.teamNames,services:i.services,workTimes:i.workTimes,paymentTypeName:i.paymentTypeName,finishUser:i.finishUser,isCancel:i.isCancel,isReopen:i.isReopen,isFree:i.isFree,isFinish:i.isFinish})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,"User",[])}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}goRegister(){this.router.navigateByUrl("/managment/order/new")}goEdit(t){this.router.navigateByUrl("/managment/order/new")}getStatus(t){return t.isCancel?"bg-warning-subtle text-warning":t.isFinish?"bg-success-subtle text-success":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen||t.isFree?"bg-warning-subtle text-warning":"bg-success-subtle text-success"}getTrnslate(t){return t.isCancel?"orderManagement.order.cancel":t.isFinish?"orderManagement.order.finish":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen?"orderManagement.order.reopen":t.isFree?"orderManagement.order.free":"orderManagement.order.finished"}openModal(t,i,n="md"){this.orderSelected=t,this.assignForm.code=t,this.modalService.open(i,{centered:!0,size:n})}oncityChange(t){this.GetDistricts(t.code)}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}getEvalById(t){this.baseService.getById(t).subscribe(i=>{this.evaluationDetails=i.data,this.assignForm.teamCode=i.date.teamCode,this.assignForm.assignDate=i.date.assignDate},()=>{this.alertService.error()})}getEvalTeams(){this.baseService.EvaluationLookUp().subscribe(t=>{this.teams=t.data.teams},()=>{this.alertService.error()})}ChangeAssignTeam(){this.ngxLoader.startLoader(f.Fq),this.baseService.ChangeAssignTeam(this.assignForm).subscribe(t=>{this.ngxLoader.stopLoader(f.Fq),this.loadentities(),this.modalService.dismissAll(),t.success?this.alertService.success():this.alertService.error("general.message."+t.message)},()=>{this.alertService.error(),this.ngxLoader.stopLoader(f.Fq)})}FinishEvaluation(){this.ngxLoader.startLoader(f.Fq),this.baseService.SaveEvaluationFinish({}).subscribe(t=>{this.ngxLoader.stopLoader(f.Fq),this.loadentities(),this.modalService.dismissAll(),t.success?this.alertService.success():this.alertService.error("general.message."+t.message)},()=>{this.alertService.error(),this.ngxLoader.stopLoader(f.Fq)})}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(_.nX),e.rXU(p.c$),e.rXU(xe.W),e.rXU(Me.H),e.rXU(O.u),e.rXU(d.vh),e.rXU(C.eD),e.rXU(h.Bq),e.rXU(g.J),e.rXU(z.V),e.rXU(Q.h),e.rXU(te.m),e.rXU(ne.l),e.rXU(_.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-team-assign-evaluation"]],features:[e.Vt3],decls:31,vars:20,consts:[["deleteModal",""],["evaluateModal",""],["showModal",""],["finishModal",""],["formEntity","ngForm"],["assignDate","ngModel"],["teamCode","ngModel"],[1,"row"],[1,"col-lg-12"],[1,"grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[1,"card"],[1,"card-body"],[3,"reset","search","exportXlsx","showAdd","showExport","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","search","id","agentName","name","agentName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","tel","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"col-12","col-md-4","mb-2"],["type","text","mwlFlatpickr","","id","isDate","mode","range",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],["class","col-xxl-3 col-xl-4 col-lg-4 col-md-6",4,"ngFor","ngForOf"],[1,"col-xxl-3","col-xl-4","col-lg-4","col-md-6"],[1,"mb-4","d-flex","justify-content-between"],["tooltipPosition","top","type","button","data-bs-toggle","button","aria-pressed","true",1,"btn","btn-icon","btn-soft-primary","float-end",3,"click","pTooltip"],[1,"ri-eye-fill","fs-16"],[1,"d-flex","justify-content-between","mt-3"],[1,"text-muted"],[1,"ri-calendar-2-fill","text-muted","me-1","align-bottom"],[1,"text-muted","ms-2"],["href","javascript:void(0);"],[1,"text-center"],[1,"ri-user-2-fill","text-muted","me-1","align-bottom"],[1,"d-flex","gap-4","mb-1","justify-content-between"],[1,"text-success"],[1,"ri-map-pin-2-line","text-success","me-1","align-bottom"],["class","badge bg-success-subtle text-success",4,"ngIf"],[1,"ri-phone-fill","text-info","me-1","align-bottom"],[1,"cursor-pointer","badge","bg-info-subtle","text-info","fs-6",3,"click"],[1,"ri-clipboard-line"],[1,"d-flex","gap-4"],[1,"w-50"],["tooltipPosition","top",1,"ri-user-2-fill","text-primary","me-1","align-bottom","fs-6",3,"pTooltip"],[1,"badge","bg-primary-subtle","text-primary","mx-1"],["tooltipPosition","top",1,"ri-flag-2-fill","text-primary","me-1","align-bottom","fs-6",3,"pTooltip"],["class","badge bg-danger-subtle text-danger","translate","orderManagement.priceEvaluation.isUrgent",4,"ngIf"],["class","badge bg-success-subtle text-success","translate","orderManagement.priceEvaluation.normal",4,"ngIf"],[1,"mt-2","hstack","gap-2"],[1,"btn","btn-soft-success","w-100",3,"click"],[1,"ri-user-follow-fill","label-icon","align-bottom","rounded-pill","fs-16","me-2"],["translate","orderManagement.priceEvaluation.reassign"],["href","javascript:void(0);",1,"btn","btn-soft-primary","w-100",3,"click"],[1,"ri-checkbox-circle-fill","align-bottom","me-2"],["translate","orderManagement.finishedEvaluation.finish"],[1,"badge","bg-success-subtle","text-success"],["translate","orderManagement.priceEvaluation.isUrgent",1,"badge","bg-danger-subtle","text-danger"],["translate","orderManagement.priceEvaluation.normal",1,"badge","bg-success-subtle","text-success"],[3,"success","dismiss","orderId"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["translate","orderManagement.assignEvaluation.reassignEval",1,"fw-bold","fs-4"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[3,"hasProgressBar","fgsType","loaderId"],[1,"modal-content"],[1,"modal-body"],[1,"mx-4"],[1,"col-12","col-md-4","mb-3"],["translate","",1,"fw-bold","form-label","w-100"],[1,"form-control","w-100"],["for","visitDate","translate","",1,"fw-bold","form-label"],[1,"mt-4","row",2,"border-top","1px solid rgba(128,128,128,0.29)"],[1,"col-12","text-center","mt-4"],[1,"table","table-bordered"],["translate",""],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"mt-4","pt-3","row",2,"border-top","1px solid rgba(128,128,128,0.29)"],[1,"col-md-12","mb-3","d-flex"],[1,"fw-bold","form-label","w-25"],[1,"fw-bold","form-label","w-75"],[1,"col-12","col-md-12","mb-3","d-flex"],["translate","",1,"fw-bold","form-label","w-25"],[1,"fw-bold","form-label","w-75","form-control","py-3"],[1,"col-12","col-md-6","mb-3"],["for","assignDate","translate","",1,"fw-bold","form-label"],[1,"input-group"],["InputTirmFilter","","name","mobile","type","date","id","assignDate",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["name","teamCode","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],[1,"d-flex","gap-2","justify-content-end","mt-4","mb-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger",3,"click"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],["colspan","4"],["translate","orderManagement.assignEvaluation.title",1,"fw-bold","fs-4"],["translate","orderManagement.finishedEvaluation.title",1,"fw-bold","fs-4"],[1,"mt-2","text-center"],["src","https://cdn.lordicon.com/gdfrsvpt.json","stroke","bold","state","hover-oscillate","trigger","loop","colors","primary:#f7b84b,secondary:#f06548",2,"width","130px","height","130px"],[1,"pt-2","fs-15","mx-4","mx-sm-5"],["translate","orderManagement.order.AreYouSureMessage"],[1,"text-muted","mx-4","mb-0"],[1,"d-flex","gap-2","justify-content-center","mt-4","mb-2"]],template:function(i,n){if(1&i){const a=e.RV6();e.j41(0,"div",7)(1,"div",8)(2,"div",9),e.nrm(3,"ngx-ui-loader",10),e.j41(4,"div",11)(5,"div",12)(6,"base-filter",13),e.bIt("reset",function(){return e.eBV(a),e.Njj(n.onReset())})("search",function(){return e.eBV(a),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(a),e.Njj(n.onExportXlsx())}),e.qex(7,14),e.j41(8,"div",15)(9,"div",16)(10,"input",17),e.nI1(11,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.agentName,s)||(n.pagination.agentName=s),e.Njj(s)}),e.k0s(),e.nrm(12,"i",18),e.k0s()(),e.j41(13,"div",15)(14,"div",16)(15,"input",19),e.nI1(16,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.mobile,s)||(n.pagination.mobile=s),e.Njj(s)}),e.k0s(),e.nrm(17,"i",18),e.k0s()(),e.j41(18,"div",20)(19,"input",21),e.nI1(20,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.dates,s)||(n.searchForm.dates=s),e.Njj(s)}),e.k0s()(),e.bVm(),e.k0s()()(),e.j41(21,"div",7),e.DNE(22,To,49,24,"div",22),e.k0s()()()(),e.DNE(23,So,1,1,"ng-template",null,0,e.C5r)(25,Ro,70,27,"ng-template",null,1,e.C5r)(27,No,57,20,"ng-template",null,2,e.C5r)(29,Do,17,3,"ng-template",null,3,e.C5r)}2&i&&(e.R7$(3),e.Y8G("loaderId","assignedEvaluationLoader"),e.R7$(3),e.Y8G("showAdd",!1)("showExport",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(11,14,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.agentName),e.R7$(5),e.FS9("placeholder",e.bMT(16,16,"orderManagement.order.mobile")),e.R50("ngModel",n.pagination.mobile),e.R7$(4),e.FS9("placeholder",e.bMT(20,18,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.dates),e.R7$(3),e.Y8G("ngForOf",n.entities))},dependencies:[d.Sq,d.bT,c.qT,c.me,c.BC,c.cb,c.vS,c.cV,j.kL,q.b,p.Mm,C.Cv,U.vr,W.m,de.m,je,d.vh,p.D9]})}}return r})();const Vo=["FileInput"];function Go(r,o){1&r&&e.nrm(0,"span",55)}function Ao(r,o){if(1&r&&(e.j41(0,"span",56),e.EFF(1),e.k0s()),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI("",t.districtName," ")}}function Lo(r,o){if(1&r&&(e.qex(0),e.j41(1,"span",57),e.EFF(2),e.k0s(),e.bVm()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t)}}function Bo(r,o){if(1&r&&(e.qex(0),e.j41(1,"span",57),e.EFF(2),e.k0s(),e.bVm()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t)}}function $o(r,o){if(1&r&&(e.qex(0),e.j41(1,"span",57),e.EFF(2),e.k0s(),e.bVm()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t)}}function Xo(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",29)(1,"div",30)(2,"div",17)(3,"bdi")(4,"span")(5,"span"),e.EFF(6),e.nI1(7,"translate"),e.k0s()()(),e.nrm(8,"div",31),e.j41(9,"div",32)(10,"p",33),e.nrm(11,"i",34),e.EFF(12),e.nI1(13,"date"),e.k0s(),e.j41(14,"p",35),e.EFF(15),e.nI1(16,"translate"),e.k0s()(),e.j41(17,"a",36)(18,"h5",37),e.nrm(19,"i",38),e.EFF(20),e.k0s()(),e.j41(21,"div",39)(22,"div",40),e.nrm(23,"i",41),e.EFF(24),e.DNE(25,Go,1,0,"span",42)(26,Ao,2,1,"span",43),e.k0s(),e.j41(27,"div"),e.nrm(28,"i",44),e.j41(29,"span",45),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.copytext(n.mobile))}),e.EFF(30),e.nrm(31,"i",46),e.k0s()()(),e.nrm(32,"hr"),e.j41(33,"div",47)(34,"div"),e.nrm(35,"i",48),e.DNE(36,Lo,3,1,"ng-container",49),e.k0s()(),e.j41(37,"div",50)(38,"div",51)(39,"h6"),e.nrm(40,"i",52),e.EFF(41),e.nI1(42,"translate"),e.k0s(),e.DNE(43,Bo,3,1,"ng-container",49),e.k0s(),e.j41(44,"div",53)(45,"h6"),e.nrm(46,"i",54),e.EFF(47),e.nI1(48,"translate"),e.k0s(),e.DNE(49,$o,3,1,"ng-container",49),e.k0s()()()()()}if(2&r){const t=o.$implicit,i=e.XpG();e.R7$(4),e.ZvI("ribbon ",t.teamStatusName," round-shape "),e.R7$(2),e.JRh(e.bMT(7,17,"orderManagement.order."+t.teamStatusName)),e.R7$(6),e.SpI(" ",e.i5U(13,19,t.visitDate,"yyyy-MM-dd")," "),e.R7$(3),e.Lme(" ",e.bMT(16,22,"orderManagement.order.orderCode"),": #SO#",t.orderCode," "),e.R7$(5),e.SpI(" ",t.agentName," "),e.R7$(4),e.SpI(" ",t.cityName," "),e.R7$(),e.Y8G("ngIf",""==t.districtName),e.R7$(),e.Y8G("ngIf",""!==t.districtName),e.R7$(4),e.SpI("",t.mobile," "),e.R7$(6),e.Y8G("ngForOf",i.getServices(t.services)),e.R7$(5),e.SpI(" ",e.bMT(42,24,"orderManagement.order.assignTo"),""),e.R7$(2),e.Y8G("ngForOf",i.getTimes(t.teamNames)),e.R7$(4),e.SpI(" ",e.bMT(48,26,"orderManagement.order.workTimes"),""),e.R7$(2),e.Y8G("ngForOf",i.getTimes(t.workTimes))}}function Uo(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",66)(1,"label",74),e.EFF(2,"orderManagement.order.cancelReasonName"),e.k0s(),e.j41(3,"ng-select",75),e.nI1(4,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG(2);return e.DH7(a.form.cancelReasonCode,n)||(a.form.cancelReasonCode=n),e.Njj(n)}),e.k0s()()}if(2&r){const t=e.XpG(2);e.R7$(3),e.FS9("placeholder",e.bMT(4,4,"orderManagement.order.cancelReasonName")),e.Y8G("items",t.cancelReasons)("multiple",!1),e.R50("ngModel",t.form.cancelReasonCode)}}function Yo(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",58)(1,"div",59)(2,"h4",60),e.nrm(3,"span",61),e.k0s(),e.j41(4,"button",62),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(5,"div",63),e.nrm(6,"ngx-ui-loader",64),e.j41(7,"form",65,5),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.changeStatus())}),e.j41(9,"div",12)(10,"div",66)(11,"label",67),e.EFF(12,"orderManagement.order.changeTeamStatus"),e.k0s(),e.j41(13,"ng-select",68),e.nI1(14,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.form.teamStatus,n)||(a.form.teamStatus=n),e.Njj(n)}),e.k0s()(),e.DNE(15,Uo,5,6,"div",69),e.j41(16,"div",66)(17,"label",67),e.EFF(18,"orderManagement.order.teamStatusNotes"),e.k0s(),e.j41(19,"textarea",70),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.form.teamStatusNotes,n)||(a.form.teamStatusNotes=n),e.Njj(n)}),e.k0s()()(),e.j41(20,"div",37)(21,"button",71),e.nrm(22,"i",72)(23,"span",73),e.k0s()()()()()}if(2&r){const t=e.sdS(8),i=e.XpG();e.R7$(6),e.Y8G("hasProgressBar",!1)("fgsType",i.loaderOperationShap)("loaderId",i.operationLoader),e.R7$(7),e.FS9("placeholder",e.bMT(14,10,"orderManagement.order.changeTeamStatus")),e.Y8G("items",i.statusList)("multiple",!1),e.R50("ngModel",i.form.teamStatus),e.R7$(2),e.Y8G("ngIf",5==i.form.teamStatus),e.R7$(4),e.R50("ngModel",i.form.teamStatusNotes),e.R7$(2),e.Y8G("disabled",!t.valid)}}function Po(r,o){if(1&r&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",t.price," ")}}function Ho(r,o){if(1&r){const t=e.RV6();e.j41(0,"span",118)(1,"input",119),e.nI1(2,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG().$implicit;return e.DH7(a.price,n)||(a.price=n),e.Njj(n)}),e.k0s(),e.j41(3,"button",120),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,a=e.XpG(2);return n.isEdit=!n.isEdit,e.Njj(a.calculatePrices())}),e.nrm(4,"i",121),e.k0s()()}if(2&r){const t=e.XpG(),i=t.$implicit,n=t.index;e.R7$(),e.Mz_("name","editPrice",n,""),e.FS9("placeholder",e.bMT(2,6,"orderManagement.order.notes")),e.Mz_("id","editPrice",n,""),e.R50("ngModel",i.price)}}function zo(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",122),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit;return e.Njj(n.isEdit=!n.isEdit)}),e.nrm(1,"i",121),e.k0s()}}function Jo(r,o){if(1&r){const t=e.RV6();e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.DNE(4,Po,2,1,"span",95)(5,Ho,5,8,"span",114),e.k0s(),e.j41(6,"td"),e.EFF(7),e.k0s(),e.j41(8,"td")(9,"button",115),e.bIt("click",function(){const n=e.eBV(t).index,a=e.XpG(2);return e.Njj(a.deleteService(n))}),e.nrm(10,"i",116),e.k0s(),e.DNE(11,zo,2,0,"button",117),e.k0s()()}if(2&r){const t=o.$implicit;e.R7$(2),e.JRh(t.service),e.R7$(2),e.Y8G("ngIf",!t.isEdit),e.R7$(),e.Y8G("ngIf",t.isEdit),e.R7$(2),e.JRh(t.notes),e.R7$(4),e.Y8G("ngIf",!t.isEdit)}}function qo(r,o){1&r&&(e.j41(0,"tr")(1,"td",123),e.EFF(2),e.nI1(3,"translate"),e.k0s()()),2&r&&(e.R7$(2),e.JRh(e.bMT(3,1,"orderManagement.order.noData")))}function Wo(r,o){if(1&r&&(e.j41(0,"div",97)(1,"div",124)(2,"label",125),e.EFF(3,"orderManagement.order.assignedOrders.usedShow"),e.k0s(),e.j41(4,"div",126),e.EFF(5),e.k0s()()()),2&r){const t=e.XpG(2);e.R7$(5),e.SpI(" ",t.finishOrderForm.usedShow||"--"," ")}}function Qo(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",127)(1,"i",128),e.bIt("click",function(){const n=e.eBV(t),a=n.$implicit,l=n.index,s=e.XpG(2);return e.Njj(s.removeImage(a.id,l))}),e.k0s(),e.j41(2,"div",129),e.nrm(3,"img",130),e.k0s()()}if(2&r){const t=o.$implicit,i=e.XpG(2);e.R7$(3),e.Y8G("src",0==t.id?t.path:i.serverPath+t.path,e.B4B)}}function Ko(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",59)(1,"h4",60),e.nrm(2,"span",76),e.k0s(),e.j41(3,"button",62),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(4,"div",63)(5,"form",null,5),e.nrm(7,"ngx-ui-loader",64),e.j41(8,"div",77)(9,"div",63)(10,"div",78)(11,"div",79)(12,"div",80)(13,"label",81),e.EFF(14,"orderManagement.order.services"),e.k0s()(),e.j41(15,"div",82)(16,"ng-select",83,6),e.nI1(18,"translate"),e.bIt("change",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.setService(n))}),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.addForm.serviceCode,n)||(a.addForm.serviceCode=n),e.Njj(n)}),e.k0s()(),e.j41(19,"div",84)(20,"div",85)(21,"input",86,7),e.nI1(23,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.addForm.price,n)||(a.addForm.price=n),e.Njj(n)}),e.k0s()()(),e.j41(24,"div",84)(25,"div",85)(26,"input",87,8),e.nI1(28,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.addForm.note,n)||(a.addForm.note=n),e.Njj(n)}),e.k0s()()(),e.j41(29,"div",88)(30,"button",89),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.addService())}),e.nrm(31,"i",90),e.k0s()(),e.j41(32,"div",91)(33,"table",92)(34,"thead")(35,"tr")(36,"th",93),e.EFF(37," orderManagement.order.service "),e.k0s(),e.j41(38,"th",94),e.EFF(39," orderManagement.order.price "),e.k0s(),e.j41(40,"th",93),e.EFF(41," orderManagement.order.notes "),e.k0s(),e.j41(42,"th",94),e.EFF(43," orderManagement.order.actions "),e.k0s()()(),e.j41(44,"tbody"),e.DNE(45,Jo,12,5,"tr",49)(46,qo,4,3,"tr",95),e.k0s()()()(),e.DNE(47,Wo,6,1,"div",96),e.j41(48,"div",97)(49,"div",98)(50,"label",99),e.EFF(51,"orderManagement.order.assignedOrders.total"),e.k0s(),e.j41(52,"div",100),e.EFF(53),e.k0s()(),e.j41(54,"div",98)(55,"label",99),e.EFF(56,"orderManagement.order.assignedOrders.extraDiscount"),e.k0s(),e.j41(57,"div",100),e.EFF(58),e.k0s()(),e.j41(59,"div",98)(60,"label",99),e.EFF(61,"orderManagement.order.assignedOrders.tax"),e.k0s(),e.j41(62,"div",100),e.EFF(63),e.k0s()(),e.j41(64,"div",98)(65,"label",99),e.EFF(66,"orderManagement.order.assignedOrders.promotionDiscount"),e.k0s(),e.j41(67,"div",100),e.EFF(68),e.k0s()(),e.j41(69,"div",98)(70,"label",99),e.EFF(71,"orderManagement.order.assignedOrders.net"),e.k0s(),e.j41(72,"div",100),e.EFF(73),e.k0s()(),e.j41(74,"div",98)(75,"label",99),e.EFF(76,"orderManagement.order.assignedOrders.paid"),e.k0s(),e.j41(77,"div",100),e.EFF(78),e.k0s()(),e.j41(79,"div",98)(80,"label",101),e.EFF(81,"orderManagement.order.assignedOrders.paymentMethod"),e.k0s(),e.j41(82,"div",102)(83,"ng-select",103,9),e.nI1(85,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.finishOrderForm.paymentTypeCode,n)||(a.finishOrderForm.paymentTypeCode=n),e.Njj(n)}),e.k0s()()(),e.j41(86,"div",98)(87,"label",99),e.EFF(88,"orderManagement.order.assignedOrders.remain"),e.k0s(),e.j41(89,"div",100),e.EFF(90),e.k0s()(),e.j41(91,"div",104)(92,"label",99),e.EFF(93,"orderManagement.order.assignedOrders.notes"),e.k0s(),e.j41(94,"textarea",105,10),e.nI1(96,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.finishOrderForm.notes,n)||(a.finishOrderForm.notes=n),e.Njj(n)}),e.EFF(97,"                                "),e.k0s()(),e.j41(98,"div",106)(99,"label",99),e.EFF(100,"orderManagement.order.assignedOrders.notes"),e.k0s(),e.j41(101,"div",102)(102,"button",107),e.bIt("click",function(){e.eBV(t);const n=e.sdS(107);return e.Njj(n.click())}),e.EFF(103," orderManagement.order.assignedOrders.select "),e.k0s(),e.j41(104,"div",108),e.DNE(105,Qo,4,1,"div",109),e.k0s()(),e.j41(106,"input",110,11),e.bIt("change",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.onFileChanged(n))}),e.k0s()()(),e.j41(108,"div",111)(109,"button",112),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.finishOrder())}),e.k0s(),e.j41(110,"button",113),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()()()}if(2&r){const t=e.sdS(6),i=e.XpG();e.R7$(7),e.Y8G("hasProgressBar",!1)("fgsType",i.loaderOperationShap)("loaderId",i.deleteLoader),e.R7$(9),e.FS9("placeholder",e.bMT(18,30,"orderManagement.order.services")),e.Y8G("items",i.services)("multiple",!1),e.R50("ngModel",i.addForm.serviceCode),e.R7$(5),e.FS9("placeholder",e.bMT(23,32,"orderManagement.order.price")),e.R50("ngModel",i.addForm.price),e.R7$(5),e.FS9("placeholder",e.bMT(28,34,"orderManagement.order.notes")),e.R50("ngModel",i.addForm.note),e.R7$(4),e.Y8G("disabled",!t.valid),e.R7$(15),e.Y8G("ngForOf",i.finishOrderForm.invoiceService),e.R7$(),e.Y8G("ngIf",0==i.finishOrderForm.invoiceService.length),e.R7$(),e.Y8G("ngIf",!1),e.R7$(6),e.SpI(" ",i.finishOrderForm.total||"0"," "),e.R7$(5),e.SpI(" ",i.finishOrderForm.discountAdd||"0"," "),e.R7$(5),e.SpI(" ",i.finishOrderForm.tax||"0"," "),e.R7$(5),e.SpI(" ",i.finishOrderForm.promotionDiscount||"0"," "),e.R7$(5),e.SpI(" ",i.finishOrderForm.net||"0"," "),e.R7$(5),e.SpI(" ",i.finishOrderForm.paid||"0"," "),e.R7$(5),e.FS9("placeholder",e.bMT(85,36,"orderManagement.order.assignedOrders.paymentMethod")),e.Y8G("items",i.paymentTypes)("multiple",!1),e.R50("ngModel",i.finishOrderForm.paymentTypeCode),e.R7$(7),e.SpI(" ",i.finishOrderForm.remain||"--"," "),e.R7$(4),e.FS9("placeholder",e.bMT(96,38,"orderManagement.order.notes")),e.R50("ngModel",i.finishOrderForm.notes),e.R7$(11),e.Y8G("ngForOf",i.images),e.R7$(4),e.Y8G("disabled",!i.finishOrderForm.paymentTypeCode)}}function Zo(r,o){if(1&r&&e.nrm(0,"order-operation",131),2&r){const t=e.XpG();e.Y8G("isOrderEdit",!1)("isInner",!0)("orderCode",t.orderSelected)}}function el(r,o){if(1&r){const t=e.RV6();e.j41(0,"order-timeline",132),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderSelected",t.orderSelected)}}function tl(r,o){if(1&r){const t=e.RV6();e.j41(0,"form",65,5),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.RollBack())}),e.nrm(2,"ngx-ui-loader",64),e.j41(3,"div",77)(4,"div",133)(5,"button",134),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"div",63)(7,"div",135),e.nrm(8,"lord-icon",136),e.j41(9,"div",137),e.nrm(10,"h3",138)(11,"p",139),e.k0s()(),e.j41(12,"div",140),e.nrm(13,"button",141),e.j41(14,"button",113),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}let nl=(()=>{class r extends D.w{constructor(t,i,n,a,l,s,I,b,T,S,y,R,M,w,N,F,E,$){super(t,i,I,n,a,l,s),this.baseService=n,this.authDaamService=b,this.invoicesService=T,this._servicesService=S,this.excelService=y,this._formDataService=R,this.cityService=M,this.districtService=w,this.channelService=N,this.orderAssignService=F,this.cancelReasonService=E,this.router=$,this.title="orderManagement.order.teamAssignedWeekOrders",this.titleOperation="orderManagement.order.assignedOrders.titleOperation",this.language=localStorage.getItem("language"),this.assignUsers=[],this.times=[],this.images=[],this.employees=[],this.searchForm={},this.finishOrderForm={invoiceService:[],invoiceAttachImages:[],usedShow:"",promotionDiscount:""},this.pagination={pageNumber:1,pageSize:100},this.isResolveList=!1,this.editPrice=0,this.isEditPrice=!1,this.formPassword={},this.OrderStatusEnum=pe,this.roles=[],this.userTypes=[],this.actives=[{id:!0,name:"active"},{id:!1,name:"noActive"}],this.serverPath=ce.c.mediaUrl,this.countLoad=2,this.orderSelected=0,this.cities=[],this.districts=[],this.channels=[],this.services=[],this.statusList=[],this.cancelReasons=[],this.addForm={},this.setDates=(L,G,oe)=>{if(L?.from||L?.to){const Te=L.to||L.from;this.pagination[G]=this.datePipe.transform(L.from||L.to,"yyyy-MM-ddT00:00:00"),this.pagination[oe]=this.datePipe.transform(Te,"yyyy-MM-ddT23:59:59.999")}else this.pagination[G]=null,this.pagination[oe]=null},this.statusList=this.baseService.getTeamStatus(),this.loadentities(),this.GetCities(),this.GetServicesDropDown(),this.GetPaymentTypesDropDown(),this.GetChannels(),this.translateStatus(),this.GetReturnReasons()}GetReturnReasons(){this.cancelReasonService.getDropDown().subscribe(t=>{this.cancelReasons=t.data},t=>{console.log(t)})}translateStatus(){this.statusList.forEach(t=>{t.name=this.getTranslationText("orderManagement.order."+t.name)})}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetDistricts(t){this.finishOrderForm.districtCode=null,this.districtService.getByCityId(t).subscribe(i=>{this.districts=i.data},i=>{console.log(i)})}GetChannels(){this.channelService.getDropDown().subscribe(t=>{this.channels=t.data},t=>{console.log(t)})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,u.Q)(this.notifier)).subscribe(i=>{i?this.alertService.success():this.alertService.error("general.message."+i)},i=>{this.alertService.error()})}mapRegisterForm(t){let i={...t};return i.employeeCode=0,i}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader(f.a7),this.setDates(t.dates,"visitDateFrom","visitDateTo"),this.setDates(t.creationDates,"creationDateFrom","creationDateTo"),this.loadentities()}loadentities(){this.ngxLoader.startLoader("assignWeekLoader"),this.pagination.statusFilter=this.OrderStatusEnum.Assigned,this.pagination.isNextWeekAssign=!0,this.orderAssignService.get(this.pagination).pipe((0,u.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader("assignWeekLoader"),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader("assignWeekLoader"),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[]}mapExcel(){let t=[];return this.entities.forEach(i=>{t.push({"Order Code":i.orderCode,"City Name":i.cityName,"District Name":i.districtName?i.districtName:"--","Agent Name":i.agentName,Mobile:i.mobile,"Assigned To":i.teamNames,Times:i.workTimes,Services:this.getServices(i.services),Status:this.translateService.instant(`orderManagement.order.${i.teamStatusName}`)})}),t}reCallOrder(){this.ngxLoader.startLoader(f.Fq),this.baseService.UpdateCallCounter(this.orderSelected).pipe((0,Y.O)(),(0,P.c)(this.mainDelay),(0,H.Z)(),(0,u.Q)(this.notifier),(0,B.j)(()=>this.ngxLoader.stopLoader(f.Fq))).subscribe({next:t=>{this.modalService.dismissAll(),this.loadentities(),this.alertService.success()}})}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}goEdit(t){this.router.navigateByUrl("/managment/order/new")}getStatus(t){return t.isCancel?"bg-warning-subtle text-warning":t.isFinish?"bg-success-subtle text-success":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen||t.isFree?"bg-warning-subtle text-warning":"bg-success-subtle text-success"}getTrnslate(t){return t.isCancel?"orderManagement.order.cancel":t.isFinish?"orderManagement.order.finish":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen?"orderManagement.order.reopen":t.isFree?"orderManagement.order.free":"orderManagement.order.finished"}openModal(t,i,n="md"){this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}oncityChange(t){this.GetDistricts(t.code)}getTimes(t){return t.split(",")}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}getTeamStatus(t){return 0==t||1==t||2==t?"ribbon-info":3==t?"ribbon-success":4==t||5==t?"ribbon-danger":6==t?"ribbon-danger ":7==t?"ribbon-success":""}openChangeStatusModal(t,i,n="md"){this.form={},this.form.teamStatus=t.teamStatus,this.finishOrderForm.orderCode=t.orderCode,this.orderSelected=t.orderCode,this.modalService.open(i,{centered:!0,size:n})}changeStatus(){this.ngxLoader.startLoader(this.operationLoader),this.baseService.ChangeTeamStatus({OrderCode:this.orderSelected,teamStatus:this.form.teamStatus,cancelReasonCode:this.form.cancelReasonCode,teamStatusNotes:this.form.teamStatusNotes}).pipe((0,u.Q)(this.notifier),(0,B.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(i=>{this.loadentities(),this.alertService.success(),this.modalService.dismissAll()},()=>{this.alertService.error()})}finishOrder(){this.ngxLoader.startLoader(f.Fq);let t=this._formDataService.formatFormData(this.finishOrderForm);this.invoicesService.SaveInvoice(t).subscribe(i=>{this.ngxLoader.stopLoader(f.Fq),this.loadentities(),this.modalService.dismissAll()},i=>{console.log(i),this.ngxLoader.stopLoader(f.Fq)})}GetServicesDropDown(){this._servicesService.getDropDown().subscribe(t=>{this.services=t.data},t=>{console.log(t)})}GetOrderServiceAndPayment(t){this.images=[],this.finishOrderDetails=t,this.finishOrderForm={...this.finishOrderForm,orderCode:t.orderCode,discountAdd:t.discountAmountAdd},this.invoicesService.GetOrderServiceAndPayment(t.orderCode).subscribe(n=>{this.finishOrderForm.invoiceService=[],this.OrderServiceAndPayment=n.data,n.data.forEach(a=>{this.finishOrderForm.invoiceService.push({serviceCode:a.serviceCode,service:a.serviceName,notes:a.notes,price:a.price,paidValue:a.paidValue,isEdit:!1})}),this.calculatePrices()},n=>{console.log(n)})}GetPaymentTypesDropDown(){this.baseService.GetOrderLookUp().subscribe(t=>{this.paymentTypes=t.data.paymentTypes},t=>{console.log(t)})}setService(t){this.finishOrderForm.service=t.name,this.finishOrderForm.price=t.price}addService(){let t=this.services.find(i=>i.code==this.addForm.serviceCode);this.finishOrderForm.invoiceService.push({service:t.name,serviceCode:this.addForm.serviceCode,price:this.addForm.price,notes:this.addForm.note,paidValue:0,isEdit:!1}),this.addForm={},this.calculatePrices()}calculatePrices(){const t=this.finishOrderForm.discountAdd||0;let i=0,n=0;this.finishOrderForm.invoiceService.forEach(b=>{i+=+b.price,n+=+b.paidValue});let a=0,l=0,s=0;a=.15*(i-t),l=i-t+a,s=l-n,this.finishOrderForm={...this.finishOrderForm,net:l,tax:a,total:i,remain:s,paid:n}}editEachPrice(t){this.finishOrderForm.invoiceService[t].price=this.editPrice,this.isEditPrice=!1,this.calculatePrices()}deleteService(t){console.log(t),this.finishOrderForm.invoiceService.splice(t,1),this.calculatePrices()}onFileChanged(t){if(t.target.files&&t.target.files[0]){let i=t.target.files.length;for(let n=0;n<i;n++){let a=new FileReader;this.finishOrderForm.invoiceAttachImages.push({attachImage:t.target.files.item(n),type:"file"}),console.log(this.finishOrderForm.invoiceAttachImages),a.onload=l=>{this.images.push({id:0,path:l.target.result,completePath:l.target.result})},a.readAsDataURL(t.target.files[n])}}}removeImage(t,i){this.finishOrderForm.invoiceAttachImages.splice(i,1),this.images.splice(i,1)}getServices(t){return t.split("#")}OpenOrderTimeLineModel(t,i,n="md"){this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}RollBack(){this.ngxLoader.startLoader(f.Fq),this.baseService.RemoveAssign(this.orderSelected).pipe((0,Y.O)(),(0,P.c)(this.mainDelay),(0,H.Z)(),(0,u.Q)(this.notifier),(0,B.j)(()=>this.ngxLoader.stopLoader(f.Fq))).subscribe({next:t=>{this.modalService.dismissAll(),this.loadentities(),this.alertService.success()}})}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(_.nX),e.rXU(p.c$),e.rXU(k.Q),e.rXU(O.u),e.rXU(d.vh),e.rXU(C.eD),e.rXU(h.Bq),e.rXU(g.J),e.rXU(Ie.U),e.rXU(ye.N),e.rXU(z.V),e.rXU(Fe.Q),e.rXU(Q.h),e.rXU(te.m),e.rXU(ne.l),e.rXU(De),e.rXU(_e.e),e.rXU(_.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["team-assigned-week-orders"]],viewQuery:function(i,n){if(1&i&&e.GBs(Vo,5),2&i){let a;e.mGM(a=e.lsd())&&(n.FileInput=a.first)}},features:[e.Vt3],decls:38,vars:24,consts:[["changeStatusModal",""],["finishOrderModal",""],["orderModel",""],["OrderTimeLineModel",""],["RollBackModal",""],["formEntity","ngForm"],["serviceCode","ngModel"],["price","ngModel"],["note","ngModel"],["paymentTypeCode","ngModel"],["notes","ngModel"],["FileInput",""],[1,"row"],[1,"col-lg-12"],[1,"grid"],[1,"card"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[1,"card-body"],[3,"reset","search","exportXlsx","showAdd","showExport","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","search","id","agentName","name","agentName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["InputTirmFilter","","type","tel","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"col-12","col-md-4","mb-2"],["type","text","mwlFlatpickr","","id","isDate","mode","range",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],["class","col-xxl-3 col-xl-4 col-lg-4 col-md-6 my-2",4,"ngFor","ngForOf"],[1,"col-xxl-3","col-xl-4","col-lg-4","col-md-6","my-2"],[1,"card","ribbon-box","border","shadow-none","mb-lg-0","material-shadow"],[1,"mb-4","d-flex"],[1,"d-flex","justify-content-between","mt-5"],[1,"text-muted"],[1,"ri-calendar-2-fill","text-muted","me-1","align-bottom"],[1,"text-muted","ms-2"],["href","javascript:void(0);"],[1,"text-center"],[1,"ri-user-2-fill","text-muted","me-1","align-bottom"],[1,"d-flex","gap-4","mb-1","justify-content-between"],[1,"text-success"],[1,"ri-map-pin-2-line","text-success","me-1","align-bottom"],["class","badge bg-danger-subtle text-danger","translate","orderManagement.order.nothing",4,"ngIf"],["class","badge bg-success-subtle text-success",4,"ngIf"],[1,"ri-phone-fill","text-info","me-1","align-bottom"],[1,"cursor-pointer","badge","bg-info-subtle","text-info","fs-6",3,"click"],[1,"ri-clipboard-line"],[1,"d-flex","gap-4"],[1,"ri-shake-hands-fill","text-primary","me-1","align-bottom"],[4,"ngFor","ngForOf"],[1,"d-flex","justify-content-between",2,"min-height","112px"],[1,"w-50","text-left"],[1,"ri-group-fill","text-primary","me-1","align-bottom"],[1,"w-50","text-right"],[1,"ri-history-fill","text-primary","me-1","align-bottom"],["translate","orderManagement.order.nothing",1,"badge","bg-danger-subtle","text-danger"],[1,"badge","bg-success-subtle","text-success"],[1,"badge","bg-primary-subtle","text-primary","mx-1"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["translate","orderManagement.order.changeTeamStatus",1,"fw-bold","fs-4"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"hasProgressBar","fgsType","loaderId"],[3,"ngSubmit"],[1,"mb-3"],["for","actionMismatch","translate","",1,"fw-bold","form-label"],["name","teamStatus","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["class","mb-3",4,"ngIf"],["rows","2","InputTirmFilter","","name","teamStatusNotes","type","text","id","teamStatusNotes",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],["for","cancelReasonName","translate","",1,"required","fw-bold","form-label"],["name","name","bindValue","code","bindLabel","name","required","",3,"ngModelChange","placeholder","items","multiple","ngModel"],["translate","orderManagement.order.assignedOrders.finishOrder",1,"fw-bold","fs-4"],[1,"modal-content"],[1,""],[1,"mt-2","row"],[1,"col-lg-2","mb-3"],["translate","",1,"fw-bold","form-label","required","w-100"],[1,"col-12","col-lg-3","mb-2"],["name","serviceCode","bindValue","code","bindLabel","name","required","",3,"change","ngModelChange","items","multiple","placeholder","ngModel"],[1,"col-12","col-lg-2","mb-2"],[1,"input-group"],["InputTirmFilter","","name","note","type","number","id","price","required","",1,"form-control","required","fs-6",3,"ngModelChange","placeholder","ngModel"],["InputTirmFilter","","name","note","type","text","id","notes",1,"form-control","fs-6",3,"ngModelChange","placeholder","ngModel"],[1,"col-lg-2","mb-2"],[1,"btn","btn-success","py-1","px-2",3,"click","disabled"],[1,"ri-add-fill",2,"font-size","1.2rem"],[1,"col-12","text-center","mt-2"],[1,"table","table-bordered"],["translate","",2,"width","20%"],["translate","",2,"width","10%"],[4,"ngIf"],["class","pt-2 row",4,"ngIf"],[1,"pt-2","row"],[1,"col-12","col-lg-6","mb-3","d-flex"],["translate","",1,"fw-bold","form-label","w-25"],[1,"form-control","w-75","custom-form-input"],["translate","",1,"fw-bold","form-label","required","w-25"],[1,"w-75"],["name","paymentTypeCode","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],[1,"col-12","col-lg-12","mb-3","d-flex"],["InputTirmFilter","","name","note","rows","1",1,"form-control","fs-6","w-75",3,"ngModelChange","placeholder","ngModel"],[1,"col-12","col-lg-12","mt-3","d-flex"],["translate","",1,"btn","btn-warning","px-5",3,"click"],[1,"my-3","d-flex"],["class","avatar-lg mx-2 position-relative",4,"ngFor","ngForOf"],["multiple","","value","","type","file","accept","image/png, image/gif, image/jpeg",1,"form-control","d-none",3,"change"],[1,"d-flex","gap-2","justify-content-end","my-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger",3,"click","disabled"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],["class","d-flex",4,"ngIf"],[1,"btn","btn-sm","btn-danger","py-1","px-2","me-1",3,"click"],[1,"ri-delete-bin-3-fill",2,"font-size","1.2rem"],["class","btn btn-sm  btn-success py-1 px-2",3,"click",4,"ngIf"],[1,"d-flex"],["InputTirmFilter","","type","text",1,"form-control","fs-6",3,"ngModelChange","name","placeholder","ngModel","id"],[1,"btn","btn-success","py-1","px-2",3,"click"],[1,"ri-edit-2-fill",2,"font-size","1.2rem"],[1,"btn","btn-sm","btn-success","py-1","px-2",3,"click"],["colspan","4"],[1,"col-12","col-lg-12","mb-3"],["translate","",1,"fw-bold","form-label"],[1,"form-control","custom-form-textArea"],[1,"avatar-lg","mx-2","position-relative"],[1,"position-absolute","bx","bx-x-circle","text-white",2,"background","red","top","1px","right","-4px","font-size","1rem","border-radius","50%",3,"click"],[1,"avatar-title","bg-light","rounded"],["id","product-img1","alt","",1,"avatar-md","h-auto",3,"src"],[3,"isOrderEdit","isInner","orderCode"],[3,"dismiss","orderSelected"],[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"mt-2","text-center"],["src","https://cdn.lordicon.com/gdfrsvpt.json","stroke","bold","state","hover-oscillate","trigger","loop","colors","primary:#f7b84b,secondary:#f06548",2,"width","130px","height","130px"],[1,"pt-2","fs-15","mx-4","mx-sm-5"],["translate","orderManagement.order.AreYouSureMessage"],[1,"text-muted","mx-4","mb-0"],[1,"d-flex","gap-2","justify-content-center","mt-4","mb-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger"]],template:function(i,n){if(1&i){const a=e.RV6();e.j41(0,"div",12)(1,"div",13)(2,"div",14)(3,"div",15),e.nrm(4,"ngx-ui-loader",16),e.j41(5,"div",17)(6,"base-filter",18),e.bIt("reset",function(){return e.eBV(a),e.Njj(n.onReset())})("search",function(){return e.eBV(a),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(a),e.Njj(n.onExportXlsx())}),e.qex(7,19),e.j41(8,"div",20)(9,"div",21)(10,"input",22),e.nI1(11,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.orderCode,s)||(n.pagination.orderCode=s),e.Njj(s)}),e.k0s(),e.nrm(12,"i",23),e.k0s()(),e.j41(13,"div",20)(14,"div",21)(15,"input",24),e.nI1(16,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.agentName,s)||(n.pagination.agentName=s),e.Njj(s)}),e.k0s(),e.nrm(17,"i",23),e.k0s()(),e.j41(18,"div",20)(19,"div",21)(20,"input",25),e.nI1(21,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.mobile,s)||(n.pagination.mobile=s),e.Njj(s)}),e.k0s(),e.nrm(22,"i",23),e.k0s()(),e.j41(23,"div",26)(24,"input",27),e.nI1(25,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.creationDates,s)||(n.searchForm.creationDates=s),e.Njj(s)}),e.k0s()(),e.bVm(),e.k0s()()(),e.j41(26,"div",12),e.DNE(27,Xo,50,28,"div",28),e.k0s()()()(),e.DNE(28,Yo,24,12,"ng-template",null,0,e.C5r)(30,Ko,111,40,"ng-template",null,1,e.C5r)(32,Zo,1,3,"ng-template",null,2,e.C5r)(34,el,1,1,"ng-template",null,3,e.C5r)(36,tl,15,3,"ng-template",null,4,e.C5r)}2&i&&(e.R7$(4),e.Y8G("loaderId","assignWeekLoader"),e.R7$(2),e.Y8G("showAdd",!1)("showExport",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(11,16,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.orderCode),e.R7$(5),e.FS9("placeholder",e.bMT(16,18,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.agentName),e.R7$(5),e.FS9("placeholder",e.bMT(21,20,"orderManagement.order.mobile")),e.R50("ngModel",n.pagination.mobile),e.R7$(4),e.FS9("placeholder",e.bMT(25,22,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(3),e.Y8G("ngForOf",n.entities))},dependencies:[d.Sq,d.bT,c.qT,c.me,c.Q0,c.BC,c.cb,c.YS,c.vS,c.cV,j.kL,q.b,ge.L,p.Mm,C.Cv,U.vr,W.m,me,d.vh,p.D9],encapsulation:2})}}return r})();function il(r,o){1&r&&e.nrm(0,"app-team-assigned-orders")}function rl(r,o){1&r&&e.nrm(0,"team-assigned-week-orders")}function al(r,o){1&r&&e.nrm(0,"app-team-assign-evaluation")}function sl(r,o){1&r&&e.nrm(0,"app-team-expenses-orders")}let ol=(()=>{class r{constructor(){this.active=1,this.activeindex="1"}static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-Team-container"]],decls:21,vars:6,consts:[["nav","ngbNav"],[1,"row"],[1,"col-lg-12"],["ngbNav","",1,"nav","nav-tabs-custom","card-header-tabs","border-bottom-0",3,"activeIdChange","activeId"],[3,"ngbNavItem"],["ngbNavLink",""],["translate","orderManagement.order.assignedOrders.title"],["ngbNavContent",""],["translate","orderManagement.order.teamAssignedWeekOrders"],["translate","orderManagement.assignEvaluation.title"],["translate","orderManagement.expensesOrders.title"],[1,"mt-2",3,"ngbNavOutlet"]],template:function(i,n){if(1&i){const a=e.RV6();e.j41(0,"div",1)(1,"div",2)(2,"ul",3,0),e.mxI("activeIdChange",function(s){return e.eBV(a),e.DH7(n.active,s)||(n.active=s),e.Njj(s)}),e.j41(4,"li",4)(5,"a",5),e.nrm(6,"span",6),e.k0s(),e.DNE(7,il,1,0,"ng-template",7),e.k0s(),e.j41(8,"li",4)(9,"a",5),e.nrm(10,"span",8),e.k0s(),e.DNE(11,rl,1,0,"ng-template",7),e.k0s(),e.j41(12,"li",4)(13,"a",5),e.nrm(14,"span",9),e.k0s(),e.DNE(15,al,1,0,"ng-template",7),e.k0s(),e.j41(16,"li",4)(17,"a",5),e.nrm(18,"span",10),e.k0s(),e.DNE(19,sl,1,0,"ng-template",7),e.k0s()(),e.nrm(20,"div",11),e.k0s()()}if(2&i){const a=e.sdS(3);e.R7$(2),e.R50("activeId",n.active),e.R7$(2),e.Y8G("ngbNavItem",1),e.R7$(4),e.Y8G("ngbNavItem",2),e.R7$(4),e.Y8G("ngbNavItem",3),e.R7$(4),e.Y8G("ngbNavItem",4),e.R7$(4),e.Y8G("ngbNavOutlet",a)}},dependencies:[h.Um,h.X9,h.sy,h.Gx,h.Ri,h.WA,h.m_,p.Mm,Js,Io,Oo,nl],encapsulation:2})}}return r})();function ll(r,o){1&r&&(e.j41(0,"tr",21)(1,"th",22),e.EFF(2,"#"),e.k0s(),e.j41(3,"th",23),e.nrm(4,"i",24),e.EFF(5," orderManagement.order.orderCode "),e.k0s(),e.j41(6,"th",25),e.nrm(7,"i",24),e.EFF(8," orderManagement.order.creation "),e.k0s(),e.j41(9,"th",26),e.EFF(10," orderManagement.order.agentName "),e.k0s(),e.j41(11,"th",26),e.EFF(12," orderManagement.order.paymentTypeName "),e.k0s(),e.j41(13,"th",27),e.nrm(14,"i",24),e.EFF(15," orderManagement.invoices.value "),e.k0s(),e.j41(16,"th",26),e.EFF(17," orderManagement.order.attchment "),e.k0s()())}function dl(r,o){if(1&r){const t=e.RV6();e.j41(0,"p-image",36),e.bIt("onImageError",function(n){e.eBV(t);const a=e.XpG(3);return e.Njj(a.setDefaultImage(n,"assets/images/custom/no-img.jpg"))}),e.k0s()}if(2&r){const t=e.XpG(2).$implicit;e.Y8G("src","assets/images/PDF.png")("preview",!1)("alt",t.name)}}function cl(r,o){if(1&r&&(e.j41(0,"a",35),e.DNE(1,dl,1,3,"p-image",34),e.k0s()),2&r){const t=e.XpG().$implicit,i=e.XpG();e.FS9("href",i.serverUrl+i.checkUrl(t.attachReceiptPath),e.B4B),e.R7$(),e.Y8G("ngIf","pdf"===i.checkExtension(i.serverUrl+i.checkUrl(t.attachReceiptPath)))}}function ml(r,o){if(1&r){const t=e.RV6();e.j41(0,"p-image",36),e.bIt("onImageError",function(n){e.eBV(t);const a=e.XpG(2);return e.Njj(a.setDefaultImage(n,"assets/images/custom/no-img.jpg"))}),e.k0s()}if(2&r){const t=e.XpG().$implicit,i=e.XpG();e.Y8G("src",i.serverUrl+i.checkUrl(t.attachReceiptPath))("preview",!0)("alt",t.name)}}function pl(r,o){if(1&r){const t=e.RV6();e.j41(0,"tr",28)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td")(4,"bdi",29),e.EFF(5),e.k0s()(),e.j41(6,"td"),e.EFF(7),e.nI1(8,"date"),e.k0s(),e.j41(9,"td")(10,"span",30),e.EFF(11),e.k0s(),e.nrm(12,"br"),e.j41(13,"span",31),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.copytext(n.mobile))}),e.EFF(14),e.nrm(15,"i",32),e.k0s()(),e.j41(16,"td"),e.EFF(17),e.k0s(),e.j41(18,"td"),e.EFF(19),e.k0s(),e.j41(20,"td"),e.DNE(21,cl,2,2,"a",33)(22,ml,1,3,"p-image",34),e.k0s()()}if(2&r){const t=o.$implicit,i=o.rowIndex,n=e.XpG();e.R7$(2),e.JRh(i+1),e.R7$(3),e.SpI("#SO#",t.orderCode,""),e.R7$(2),e.SpI(" ",e.i5U(8,9,t.createdDate,"yyyy-MM-dd")," "),e.R7$(4),e.SpI("",t.agentName," "),e.R7$(3),e.SpI("",t.agentMobile," "),e.R7$(3),e.SpI(" ",t.paymentTypeName," "),e.R7$(2),e.SpI(" ",t.value," "),e.R7$(2),e.Y8G("ngIf","pdf"===n.checkExtension(n.serverUrl+n.checkUrl(t.attachReceiptPath))),e.R7$(),e.Y8G("ngIf","pdf"!==n.checkExtension(n.serverUrl+n.checkUrl(t.attachReceiptPath)))}}function gl(r,o){1&r&&(e.j41(0,"div",37),e.EFF(1," general.table.noData "),e.k0s())}function hl(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",38)(1,"div",39),e.nrm(2,"ngb-pagination-info",40),e.j41(3,"table-length",41),e.bIt("lengthChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",42)(5,"ngb-pagination",43),e.bIt("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.pagination.pageNumber,n)||(a.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}let ul=(()=>{class r extends D.w{constructor(t,i,n,a,l,s,I,b,T,S,y,R,M,w,N){super(t,i,I,n,a,l,s),this.baseService=n,this.authDaamService=b,this.teamService=T,this.workTimeService=S,this.excelService=y,this.cityService=R,this.districtService=M,this.channelService=w,this.router=N,this.title="orderManagement.invoices.title",this.titleOperation="orderManagement.invoices.titleOperation",this.serverUrl=ce.c.mediaUrl,this.keySelected="",this.assignUsers=[],this.times=[],this.employees=[],this.searchForm={},this.isResolveList=!0,this.employeeTypes=[{id:1,name:"employeeTeam"},{id:2,name:"managment"},{id:3,name:"customerService"}],this.employeeGroups=[],this.activeindex="2",this.active=2,this.formPassword={},this.roles=[],this.teams=[],this.workTimes=[],this.userTypes=[],this.actives=[{id:!0,name:"active"},{id:!1,name:"noActive"}],this.clientSelected=0,this.cities=[],this.districts=[],this.channels=[],this.status=[],this.countLoad=2,this.isOrderEdit=!1,this.orderSelected={},this.users=[],this.setDates=(F,E,$)=>{if(F?.from||F?.to){const G=F.to||F.from;this.pagination[E]=this.datePipe.transform(F.from||F.to,"yyyy-MM-ddT00:00:00"),this.pagination[$]=this.datePipe.transform(G,"yyyy-MM-ddT23:59:59.999")}else this.pagination[E]=null,this.pagination[$]=null},this.configRoute(),this.GetCities(),this.GetChannels(),this.GetTeams(),this.GetTimes(),this.status=[{name:"None",nameAr:"\u0644\u0627 \u0634\u0626",id:0},{name:"Is Review",nameAr:"\u062a\u0645\u062a \u0627\u0644\u0645\u0631\u0627\u062c\u0639\u0629",id:1},{name:"Is Confirmed",nameAr:"\u062a\u0645 \u0627\u0644\u062a\u0623\u0643\u064a\u062f",id:2},{name:"Is Free",nameAr:"\u0645\u062c\u0627\u0646\u064a",id:3},{name:"Is Reopen",nameAr:"\u062a\u0645\u062a \u0625\u0639\u0627\u062f\u0629 \u0641\u062a\u062d\u0647",id:4},{name:"Is Finish",nameAr:"\u0627\u0646\u062a\u0647\u0649",id:5},{name:"Is Cancel",nameAr:"\u062a\u0645 \u0627\u0644\u0625\u0644\u063a\u0627\u0621",id:6},{name:"Is Assign",nameAr:"\u062a\u0645 \u062a\u0639\u064a\u064a\u0646\u0647",id:7},{name:"Is Urgent",nameAr:"\u0639\u0627\u062c\u0644",id:8},{name:"New",nameAr:"\u062c\u062f\u064a\u062f",id:9}]}checkUrl(t){return null==t||""==t?"":t.startsWith("/upload")?t.replace("/upload","upload"):t}checkExtension(t){const n=t.split("/").pop().split(".").pop();return console.log(),n}setDefaultImage(t,i){t.target.src=i}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetDistricts(t){this.districtService.getByCityId(t).subscribe(i=>{this.districts=i.data},i=>{console.log(i)})}GetChannels(){this.channelService.getDropDown().subscribe(t=>{this.channels=t.data},t=>{console.log(t)})}GetTeams(){this.teamService.getDropDown().subscribe(t=>{this.teams=t.data},t=>{console.log(t)})}GetTimes(){this.workTimeService.getDropDown().subscribe(t=>{this.workTimes=t.data},t=>{console.log(t)})}mapForm(t){return{...t}}loadentities(){this.countLoad=this.countLoad+1,(!this.isResolveList||1!==this.countLoad)&&(this.baseService.GetInvoicesPayments(this.pagination).pipe((0,u.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader(f.a7),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader(f.a7),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}mapRegisterForm(t){let i={...t};return i.employeeCode=0,i}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader("allLoader"),this.setDates(t.creationDates,"startDate","endDate"),this.loadentities()}LoadSuccess(){this.ngxLoader.stopLoader("allLoader")}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems}}configRoute(){this.routerActive.data.pipe((0,u.Q)(this.notifier)).subscribe(t=>{this.entities=t.data.data,console.log(this.entities),this.pagination.totalItems=t.data?.totalItems},()=>{this.alertService.error()})}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(_.nX),e.rXU(p.c$),e.rXU(Ie.U),e.rXU(O.u),e.rXU(d.vh),e.rXU(C.eD),e.rXU(h.Bq),e.rXU(g.J),e.rXU(J.n),e.rXU(le.G),e.rXU(z.V),e.rXU(Q.h),e.rXU(te.m),e.rXU(ne.l),e.rXU(_.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-all-invoices"]],features:[e.Vt3],decls:32,vars:29,consts:[["tableMaster",""],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"reset","search","showAdd","showExport","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","search","id","agentName","name","agentName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["InputTirmFilter","","type","search","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["translate","",2,"width",".5%"],["pSortableColumn","orderCode","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["pSortableColumn","createdDate","translate","",2,"width","13%"],["translate","",2,"width","12%"],["pSortableColumn","value","translate","",2,"width","12%"],[1,"fs-5"],[1,"code-pointer"],[1,"badge","bg-primary-subtle","text-primary","my-1"],[1,"cursor-pointer","badge","bg-danger-subtle","text-danger","fs-6",3,"click"],[1,"ri-clipboard-line"],["target","_blank",3,"href",4,"ngIf"],["width","50","height","50",3,"src","preview","alt","onImageError",4,"ngIf"],["target","_blank",3,"href"],["width","50","height","50",3,"onImageError","src","preview","alt"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"]],template:function(i,n){if(1&i){const a=e.RV6();e.j41(0,"div",1)(1,"div",2)(2,"div",3),e.nrm(3,"ngx-ui-loader",4),e.j41(4,"base-filter",5),e.bIt("reset",function(){return e.eBV(a),e.Njj(n.onReset())})("search",function(){return e.eBV(a),e.Njj(n.onSearch())}),e.qex(5,6),e.j41(6,"div",7)(7,"div",8)(8,"input",9),e.nI1(9,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.orderCode,s)||(n.pagination.orderCode=s),e.Njj(s)}),e.k0s(),e.nrm(10,"i",10),e.k0s()(),e.j41(11,"div",7)(12,"div",8)(13,"input",11),e.nI1(14,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.agentName,s)||(n.pagination.agentName=s),e.Njj(s)}),e.k0s(),e.nrm(15,"i",10),e.k0s()(),e.j41(16,"div",7)(17,"div",8)(18,"input",12),e.nI1(19,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.agentMobile,s)||(n.pagination.agentMobile=s),e.Njj(s)}),e.k0s(),e.nrm(20,"i",10),e.k0s()(),e.j41(21,"div",7)(22,"input",13),e.nI1(23,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.creationDates,s)||(n.searchForm.creationDates=s),e.Njj(s)}),e.k0s()(),e.bVm(),e.k0s(),e.j41(24,"div",14)(25,"div",15)(26,"p-table",16,0),e.bIt("onLazyLoad",function(s){return e.eBV(a),e.Njj(n.tableChange(s))})("selectionChange",function(s){return e.eBV(a),e.Njj(n.onSelectionChange(s))}),e.DNE(28,ll,18,0,"ng-template",17)(29,pl,23,12,"ng-template",18),e.k0s()(),e.DNE(30,gl,2,0,"div",19)(31,hl,6,8,"div",20),e.k0s()()()()}2&i&&(e.R7$(3),e.Y8G("loaderId","allLoader"),e.R7$(),e.Y8G("showAdd",!1)("showExport",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(9,21,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.orderCode),e.R7$(5),e.FS9("placeholder",e.bMT(14,23,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.agentName),e.R7$(5),e.FS9("placeholder",e.bMT(19,25,"orderManagement.order.mobile")),e.R50("ngModel",n.pagination.agentMobile),e.R7$(4),e.FS9("placeholder",e.bMT(23,27,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(4),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[d.bT,c.me,c.Q0,c.BC,c.vS,h.s5,j.kL,q.b,ie.p,re.g,p.Mm,x.XI,K.Ei,x.Tg,C.Cv,W.m,Re._,d.vh,p.D9],encapsulation:2})}}return r})();var _l=m(7673);const bl=[{path:"list",component:Hr,canActivate:[he.g],data:{permission:["order.view"]}},{path:"invoices",component:ul,resolve:{data:(()=>{class r extends Ve.E{constructor(t,i,n){super(t,i,n)}resolve(t,i){return this.pagination={pageNumber:1,pageSize:10},this.BaseService.GetInvoicesPayments(this.pagination).pipe((0,Ge.W)(n=>(this.router.navigate([""]),this.alertService.error(n),(0,_l.of)(null))))}static{this.\u0275fac=function(i){return new(i||r)(e.KVO(_.Ix),e.KVO(Ie.U),e.KVO(O.u))}}static{this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})()},canActivate:[he.g],data:{permission:["order.view"]}},{path:"eval-list",component:is,canActivate:[he.g],data:{permission:["priceEval.view"]}},{path:"map",component:V,canActivate:[he.g],data:{permission:["leads.register"]}},{path:"new",component:$e,canActivate:[he.g],data:{permission:["order.register"]}},{path:"new/:id",component:$e,canActivate:[he.g],data:{permission:["order.edit"]}},{path:"timeAvailable",component:Jr,data:{roles:[]}},{path:"expenses-items",component:_s,resolve:{data:fs},canActivate:[he.g],data:{permission:["expensesItems.view"]}},{path:"expenses-orders",component:ws,resolve:{data:Ns},canActivate:[he.g],data:{permission:["expensesOrders.view"]}},{path:"team-assign",component:ol,canActivate:[he.g],data:{permission:["assigned.view"]}}];let vl=(()=>{class r{static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275mod=e.$C({type:r})}static{this.\u0275inj=e.G2t({imports:[_.iI.forChild(bl),_.iI]})}}return r})();var Cl=m(71144),xl=m(68148),Il=m(18807),Fl=m(1512),Ue=m(461),Ye=m(54420);let Ml=(()=>{class r extends Ue.h{pathId;ngOnInit(){this.pathId="url(#"+(0,Ye._Y)()+")"}static \u0275fac=(()=>{let t;return function(n){return(t||(t=e.xGo(r)))(n||r)}})();static \u0275cmp=e.VBU({type:r,selectors:[["WindowMaximizeIcon"]],standalone:!0,features:[e.Vt3,e.aNF],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M7 14H11.8C12.3835 14 12.9431 13.7682 13.3556 13.3556C13.7682 12.9431 14 12.3835 14 11.8V2.2C14 1.61652 13.7682 1.05694 13.3556 0.644365C12.9431 0.231785 12.3835 0 11.8 0H2.2C1.61652 0 1.05694 0.231785 0.644365 0.644365C0.231785 1.05694 0 1.61652 0 2.2V7C0 7.15913 0.063214 7.31174 0.175736 7.42426C0.288258 7.53679 0.44087 7.6 0.6 7.6C0.75913 7.6 0.911742 7.53679 1.02426 7.42426C1.13679 7.31174 1.2 7.15913 1.2 7V2.2C1.2 1.93478 1.30536 1.68043 1.49289 1.49289C1.68043 1.30536 1.93478 1.2 2.2 1.2H11.8C12.0652 1.2 12.3196 1.30536 12.5071 1.49289C12.6946 1.68043 12.8 1.93478 12.8 2.2V11.8C12.8 12.0652 12.6946 12.3196 12.5071 12.5071C12.3196 12.6946 12.0652 12.8 11.8 12.8H7C6.84087 12.8 6.68826 12.8632 6.57574 12.9757C6.46321 13.0883 6.4 13.2409 6.4 13.4C6.4 13.5591 6.46321 13.7117 6.57574 13.8243C6.68826 13.9368 6.84087 14 7 14ZM9.77805 7.42192C9.89013 7.534 10.0415 7.59788 10.2 7.59995C10.3585 7.59788 10.5099 7.534 10.622 7.42192C10.7341 7.30985 10.798 7.15844 10.8 6.99995V3.94242C10.8066 3.90505 10.8096 3.86689 10.8089 3.82843C10.8079 3.77159 10.7988 3.7157 10.7824 3.6623C10.756 3.55552 10.701 3.45698 10.622 3.37798C10.5099 3.2659 10.3585 3.20202 10.2 3.19995H7.00002C6.84089 3.19995 6.68828 3.26317 6.57576 3.37569C6.46324 3.48821 6.40002 3.64082 6.40002 3.79995C6.40002 3.95908 6.46324 4.11169 6.57576 4.22422C6.68828 4.33674 6.84089 4.39995 7.00002 4.39995H8.80006L6.19997 7.00005C6.10158 7.11005 6.04718 7.25246 6.04718 7.40005C6.04718 7.54763 6.10158 7.69004 6.19997 7.80005C6.30202 7.91645 6.44561 7.98824 6.59997 8.00005C6.75432 7.98824 6.89791 7.91645 6.99997 7.80005L9.60002 5.26841V6.99995C9.6021 7.15844 9.66598 7.30985 9.77805 7.42192ZM1.4 14H3.8C4.17066 13.9979 4.52553 13.8498 4.78763 13.5877C5.04973 13.3256 5.1979 12.9707 5.2 12.6V10.2C5.1979 9.82939 5.04973 9.47452 4.78763 9.21242C4.52553 8.95032 4.17066 8.80215 3.8 8.80005H1.4C1.02934 8.80215 0.674468 8.95032 0.412371 9.21242C0.150274 9.47452 0.00210008 9.82939 0 10.2V12.6C0.00210008 12.9707 0.150274 13.3256 0.412371 13.5877C0.674468 13.8498 1.02934 13.9979 1.4 14ZM1.25858 10.0586C1.29609 10.0211 1.34696 10 1.4 10H3.8C3.85304 10 3.90391 10.0211 3.94142 10.0586C3.97893 10.0961 4 10.147 4 10.2V12.6C4 12.6531 3.97893 12.704 3.94142 12.7415C3.90391 12.779 3.85304 12.8 3.8 12.8H1.4C1.34696 12.8 1.29609 12.779 1.25858 12.7415C1.22107 12.704 1.2 12.6531 1.2 12.6V10.2C1.2 10.147 1.22107 10.0961 1.25858 10.0586Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(i,n){1&i&&(e.qSk(),e.j41(0,"svg",0)(1,"g"),e.nrm(2,"path",1),e.k0s(),e.j41(3,"defs")(4,"clipPath",2),e.nrm(5,"rect",3),e.k0s()()()),2&i&&(e.HbH(n.getClassNames()),e.BMQ("aria-label",n.ariaLabel)("aria-hidden",n.ariaHidden)("role",n.role),e.R7$(),e.BMQ("clip-path",n.pathId),e.R7$(3),e.Y8G("id",n.pathId))},encapsulation:2})}return r})(),jl=(()=>{class r extends Ue.h{pathId;ngOnInit(){this.pathId="url(#"+(0,Ye._Y)()+")"}static \u0275fac=(()=>{let t;return function(n){return(t||(t=e.xGo(r)))(n||r)}})();static \u0275cmp=e.VBU({type:r,selectors:[["WindowMinimizeIcon"]],standalone:!0,features:[e.Vt3,e.aNF],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M11.8 0H2.2C1.61652 0 1.05694 0.231785 0.644365 0.644365C0.231785 1.05694 0 1.61652 0 2.2V7C0 7.15913 0.063214 7.31174 0.175736 7.42426C0.288258 7.53679 0.44087 7.6 0.6 7.6C0.75913 7.6 0.911742 7.53679 1.02426 7.42426C1.13679 7.31174 1.2 7.15913 1.2 7V2.2C1.2 1.93478 1.30536 1.68043 1.49289 1.49289C1.68043 1.30536 1.93478 1.2 2.2 1.2H11.8C12.0652 1.2 12.3196 1.30536 12.5071 1.49289C12.6946 1.68043 12.8 1.93478 12.8 2.2V11.8C12.8 12.0652 12.6946 12.3196 12.5071 12.5071C12.3196 12.6946 12.0652 12.8 11.8 12.8H7C6.84087 12.8 6.68826 12.8632 6.57574 12.9757C6.46321 13.0883 6.4 13.2409 6.4 13.4C6.4 13.5591 6.46321 13.7117 6.57574 13.8243C6.68826 13.9368 6.84087 14 7 14H11.8C12.3835 14 12.9431 13.7682 13.3556 13.3556C13.7682 12.9431 14 12.3835 14 11.8V2.2C14 1.61652 13.7682 1.05694 13.3556 0.644365C12.9431 0.231785 12.3835 0 11.8 0ZM6.368 7.952C6.44137 7.98326 6.52025 7.99958 6.6 8H9.8C9.95913 8 10.1117 7.93678 10.2243 7.82426C10.3368 7.71174 10.4 7.55913 10.4 7.4C10.4 7.24087 10.3368 7.08826 10.2243 6.97574C10.1117 6.86321 9.95913 6.8 9.8 6.8H8.048L10.624 4.224C10.73 4.11026 10.7877 3.95982 10.7849 3.80438C10.7822 3.64894 10.7192 3.50063 10.6093 3.3907C10.4994 3.28077 10.3511 3.2178 10.1956 3.21506C10.0402 3.21232 9.88974 3.27002 9.776 3.376L7.2 5.952V4.2C7.2 4.04087 7.13679 3.88826 7.02426 3.77574C6.91174 3.66321 6.75913 3.6 6.6 3.6C6.44087 3.6 6.28826 3.66321 6.17574 3.77574C6.06321 3.88826 6 4.04087 6 4.2V7.4C6.00042 7.47975 6.01674 7.55862 6.048 7.632C6.07656 7.70442 6.11971 7.7702 6.17475 7.82524C6.2298 7.88029 6.29558 7.92344 6.368 7.952ZM1.4 8.80005H3.8C4.17066 8.80215 4.52553 8.95032 4.78763 9.21242C5.04973 9.47452 5.1979 9.82939 5.2 10.2V12.6C5.1979 12.9707 5.04973 13.3256 4.78763 13.5877C4.52553 13.8498 4.17066 13.9979 3.8 14H1.4C1.02934 13.9979 0.674468 13.8498 0.412371 13.5877C0.150274 13.3256 0.00210008 12.9707 0 12.6V10.2C0.00210008 9.82939 0.150274 9.47452 0.412371 9.21242C0.674468 8.95032 1.02934 8.80215 1.4 8.80005ZM3.94142 12.7415C3.97893 12.704 4 12.6531 4 12.6V10.2C4 10.147 3.97893 10.0961 3.94142 10.0586C3.90391 10.0211 3.85304 10 3.8 10H1.4C1.34696 10 1.29609 10.0211 1.25858 10.0586C1.22107 10.0961 1.2 10.147 1.2 10.2V12.6C1.2 12.6531 1.22107 12.704 1.25858 12.7415C1.29609 12.779 1.34696 12.8 1.4 12.8H3.8C3.85304 12.8 3.90391 12.779 3.94142 12.7415Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(i,n){1&i&&(e.qSk(),e.j41(0,"svg",0)(1,"g"),e.nrm(2,"path",1),e.k0s(),e.j41(3,"defs")(4,"clipPath",2),e.nrm(5,"rect",3),e.k0s()()()),2&i&&(e.HbH(n.getClassNames()),e.BMQ("aria-label",n.ariaLabel)("aria-hidden",n.ariaHidden)("role",n.role),e.R7$(),e.BMQ("clip-path",n.pathId),e.R7$(3),e.Y8G("id",n.pathId))},encapsulation:2})}return r})();var Tl=m(10563),Sl=m(24282);let gd=(()=>{class r{static \u0275fac=function(i){return new(i||r)};static \u0275mod=e.$C({type:r});static \u0275inj=e.G2t({imports:[d.MD,K.Gg,Tl.Z,Fl.A,Il.v,xl.Y,Ml,jl,Sl.A,d.MD,K.Gg]})}return r})(),hd=(()=>{class r{constructor(){(0,A.eV)(X().loadAnimation)}static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275mod=e.$C({type:r})}static{this.\u0275inj=e.G2t({imports:[d.MD,c.YN,c.X1,h.zH,h.Pv,h.c9,j.ND,ae.r,vl,ee.G,p.h,x.bG,ue.q4,ve.H_,h.c9,C.th,U.MQ,h.n8,Cl.j,h._f,de.S,Re.U,gd]})}}return r})()},40724:(be,se,m)=>{m.d(se,{b:()=>U});var d=m(54438),c=m(8147),h=m(60177),j=m(69005),ae=m(94575);const A=[[["","menuBtn",""]],[["","control",""]]],Z=["[menuBtn]","[control]"];function X(_,e){1&_&&(d.j41(0,"span"),d.EFF(1),d.nI1(2,"translate"),d.k0s()),2&_&&(d.R7$(),d.JRh(d.bMT(2,1,"general.table.all")))}function ee(_,e){if(1&_){const V=d.RV6();d.j41(0,"a",17),d.bIt("click",function(){d.eBV(V),d.XpG(2);const k=d.sdS(11);return d.Njj(k.toggle())}),d.nrm(1,"i",18)(2,"span",19),d.k0s()}if(2&_){const V=d.XpG(2);d.BMQ("aria-expanded",!V.isCollapsed)}}function p(_,e){if(1&_){const V=d.RV6();d.j41(0,"div",21)(1,"button",22),d.nrm(2,"i",23)(3,"span",24),d.k0s(),d.j41(4,"ul",25)(5,"li",26),d.bIt("click",function(){d.eBV(V);const k=d.XpG(3);return d.Njj(k.onExportXlsx())}),d.j41(6,"a",27),d.nrm(7,"span",28),d.k0s()(),d.j41(8,"li",26),d.bIt("click",function(){d.eBV(V);const k=d.XpG(3);return d.Njj(k.onExportPDF())}),d.j41(9,"a",27),d.nrm(10,"span",29),d.k0s()()()()}if(2&_){const V=d.XpG(3);d.FS9("placement","en"===V.lang?"bottom-start":"bottom-end"),d.R7$(),d.Y8G("disabled",V.totalItems<=0)}}function x(_,e){if(1&_&&(d.qex(0),d.DNE(1,p,11,2,"div",20),d.bVm()),2&_){const V=d.XpG(2);d.R7$(),d.Y8G("hasPermission",V.exportPermission)}}function ue(_,e){if(1&_){const V=d.RV6();d.j41(0,"a",31),d.bIt("click",function(){d.eBV(V);const k=d.XpG(3);return d.Njj(k.onAddNew())}),d.nrm(1,"i",32),d.j41(2,"span"),d.EFF(3),d.nI1(4,"translate"),d.k0s()()}if(2&_){const V=d.XpG(3);d.R7$(3),d.JRh(d.bMT(4,1,V.newLocal))}}function ve(_,e){if(1&_&&(d.qex(0),d.DNE(1,ue,5,3,"a",30),d.bVm()),2&_){const V=d.XpG(2);d.R7$(),d.Y8G("hasPermission",V.addPermission)}}function C(_,e){if(1&_&&(d.j41(0,"div",15),d.DNE(1,ee,3,1,"a",16)(2,x,2,1,"ng-container",4)(3,ve,2,1,"ng-container",4),d.k0s()),2&_){const V=d.XpG();d.R7$(),d.Y8G("ngIf",V.showSearch),d.R7$(),d.Y8G("ngIf",V.showExport),d.R7$(),d.Y8G("ngIf",V.showAdd)}}let U=(()=>{class _{constructor(V){this.translateService=V,this.totalItems=0,this.title="",this.titleMore="",this.newLocal="general.action.addNew",this.data=[],this.addPermission=[],this.exportPermission=[],this.showSearch=!0,this.showExport=!0,this.showAdd=!0,this.showAllStr=!0,this.addNew=new d.bkB,this.exportXlsx=new d.bkB,this.exportPDF=new d.bkB,this.search=new d.bkB,this.reset=new d.bkB,this.showAction=!0,this.isCollapsed=!0,this.lang=this.translateService.currentLang}ngOnInit(){}onAddNew(){this.addNew.emit(!0)}onSearch(){this.search.emit(!0)}onExportXlsx(){this.exportXlsx.emit(!0)}onExportPDF(){this.exportPDF.emit(!0)}onReset(){this.reset.emit(!0)}static{this.\u0275fac=function(D){return new(D||_)(d.rXU(c.c$))}}static{this.\u0275cmp=d.VBU({type:_,selectors:[["base-filter"]],inputs:{totalItems:"totalItems",title:"title",titleMore:"titleMore",newLocal:"newLocal",data:"data",addPermission:"addPermission",exportPermission:"exportPermission",showSearch:"showSearch",showExport:"showExport",showAdd:"showAdd",showAllStr:"showAllStr",showAction:"showAction"},outputs:{addNew:"addNew",exportXlsx:"exportXlsx",exportPDF:"exportPDF",search:"search",reset:"reset"},ngContentSelectors:Z,decls:21,vars:7,consts:[["collapse","ngbCollapse"],[1,"card-header","border-0"],[1,"row","align-items-center","mb-2","justify-content-between"],[1,"col-12","col-md-3","card-title","mb-0","flex-grow-1"],[4,"ngIf"],["class","col-12 col-md-6 text-right",4,"ngIf"],["id","collapseExample",1,"collaps","show",3,"ngbCollapseChange","ngbCollapse"],[1,"row"],[1,"col-12","col-md-2","text-center","mb-2","d-flex","text-sm-center","text-md-left"],["type","button",1,"btn","w-sm-100","w-md-auto","btn-primary","btn-sm",3,"click"],[1,"ri-file-search-fill","me-1","align-bottom"],["translate","general.action.search"],["type","button",1,"btn","btn-danger","w-sm-100","w-md-auto","mx-1","btn-sm",3,"click"],[1,"ri-equalizer-fill","me-1","align-bottom"],["translate","general.action.clear"],[1,"col-12","col-md-6","text-right"],["class","btn btn-success  mx-1","data-bs-toggle","collapse","href","javascript:void(0);",3,"click",4,"ngIf"],["data-bs-toggle","collapse","href","javascript:void(0);",1,"btn","btn-success","mx-1",3,"click"],[1,"ri-filter-2-line","align-bottom"],["translate","general.action.filter"],["class","dropdown d-inline","ngbDropdown","",3,"placement",4,"hasPermission"],["ngbDropdown","",1,"dropdown","d-inline",3,"placement"],["ngbDropdownToggle","","type","button",1,"btn","btn-info","mx-2","me-4",3,"disabled"],[1,"ri-chat-download-line","me-1","align-bottom"],["translate","general.action.export"],["aria-labelledby","dropdownMenuButton1","ngbDropdownMenu","",1,"dropdown-menu"],[3,"click"],["href","javascript:void(0);",1,"dropdown-item"],["translate","general.action.xlxs"],["translate","general.action.pdf"],["class","btn btn-danger","href","javascript:void(0);",3,"click",4,"hasPermission"],["href","javascript:void(0);",1,"btn","btn-danger",3,"click"],[1,"ri-add-line","align-bottom"]],template:function(D,k){if(1&D){const O=d.RV6();d.NAR(A),d.j41(0,"div",1)(1,"div",2)(2,"h5",3)(3,"span"),d.SdG(4),d.k0s(),d.j41(5,"span"),d.DNE(6,X,3,3,"span",4),d.EFF(7),d.nI1(8,"translate"),d.k0s()(),d.DNE(9,C,4,3,"div",5),d.k0s(),d.j41(10,"div",6,0),d.mxI("ngbCollapseChange",function(v){return d.eBV(O),d.DH7(k.isCollapsed,v)||(k.isCollapsed=v),d.Njj(v)}),d.j41(12,"div",7),d.SdG(13,1),d.j41(14,"div",8)(15,"button",9),d.bIt("click",function(){return d.eBV(O),d.Njj(k.onSearch())}),d.nrm(16,"i",10)(17,"span",11),d.k0s(),d.j41(18,"button",12),d.bIt("click",function(){return d.eBV(O),d.Njj(k.onReset())}),d.nrm(19,"i",13)(20,"span",14),d.k0s()()()()()}2&D&&(d.R7$(6),d.Y8G("ngIf",k.showAllStr),d.R7$(),d.Lme(" ",d.bMT(8,5,k.title)," ",k.titleMore,""),d.R7$(2),d.Y8G("ngIf",k.showAction),d.R7$(),d.R50("ngbCollapse",k.isCollapsed))},dependencies:[h.bT,j.tg,j.do,j.U0,c.Mm,j.$G,ae.p,c.D9],encapsulation:2})}}return _})()},75622:(be,se,m)=>{m.d(se,{w:()=>D});var d=m(21413),c=m(56977),h=m(37021),j=m(35335),ae=m(45236),A=m(70980),Z=m(99437),X=m(18810),ee=m(45286),p=m(36158),x=m(54438),ue=m(51188),ve=m(8147),C=m(69005),U=m(67569),_=m(3888),e=m(60177),V=m(1530);let D=(()=>{class k{constructor(g,v,u,J,le,z,Q){this.routerActive=g,this.translateService=v,this.modalService=u,this.baseService=J,this.alertService=le,this.datePipe=z,this.ngxLoader=Q,this.title="",this.mainDelay=50,this.operationId=0,this.entities=[],this.selectedRow=[],this.pagination={pageNumber:1,pageSize:10},this.notifier=new d.B,this.checkAll=!1,this.checkOne=!1,this.checkMore=!1,this.loader=!1,this.form={},this.isEditForm=!1,this.draw=1,this.index=0,this.lengthSelect=0,this.screenName="",this.filterToggle=!0,this.start=1,this.startFirstLoad=!0,this.btnDisabled=!0,this.loaderSearchShap=p.cX,this.loaderOperationShap=p.$$,this.operationLoader=p.ZW,this.loaderDeleteShap=p.jg,this.mainTable=p.uG,this.searchLoader=p.a7,this.deleteLoader=p.Fq,this.langArabic="ar",this.paymentTypes=[],this.tableLengthSelect=[10,20,30,50,100,500,1e3],this.maxSizePagination=10,this.isResolveList=!1,this.countLoad=0,this.activeList=[{id:1,name:"active"},{id:2,name:"noActive"}],this.pagination.pageSize=10,this.pagination.pageNumber=1}ngOnInit(){this.activeList.forEach(g=>{g.name=this.getTranslationText("general.table."+g.name)}),this.lang=this.translateService.currentLang,this.translateConfig(),this.ngOnInitMore()}ngOnInitMore(){}routeDataConfig(){this.routerActive.data.pipe((0,c.Q)(this.notifier)).subscribe(g=>{this.entities=g.data.result,this.pagination=g.data.pagination,this.pagination.pageNumber=1,this.pagination.pageSize=10,this.ngxLoader.stopLoader(p.a7)},g=>{this.alertService.error()})}translateConfig(){this.translateService.onLangChange.pipe((0,c.Q)(this.notifier)).subscribe(g=>{this.lang=g.lang})}getTranslationText(g){let v="";return this.translateService.get(g).pipe((0,c.Q)(this.notifier)).subscribe(u=>{v=u}),v}ngAfterViewInit(){this.ngAfterViewInitMore()}ngAfterViewInitMore(){}getRenderString(g){return null!=g?g.substring(0,10)+"...":""}getRenderIndex(g){return this.index++,this.index}successDataTable(g){this.ngxLoader.stopLoader(p.a7),this.pagination.totalItems=g.data.pagination.totalItems,this.startFirstLoad=!1}errorDataTable(){this.ngxLoader.stopLoader(p.a7),this.alertService.error()}openModalTitle(g,v="md"){this.isEditForm=!1,this.form={},this.modalService.open(g,{centered:!0,size:v})}openModal(g,v,u="md"){this.isEditForm=!1,this.form={},this.selectedRow=[{id:g}],this.operationId=g,this.modalService.open(v,{centered:!0,size:u})}openModalMoreOperation(g){this.isEditForm=!1,this.moreIdSelected=this.selectedRow.map(v=>v.id)}closeModelDeleted(){this.modalRef?.hide(),this.loader=!1,this.btnDisabled=!0}OnSearch(g){this.ngxLoader.startLoader("allLoader"),this.loadentities()}OnSubmit(){this.ngxLoader.startLoader(this.operationLoader),!0===this.isEditForm?this.editEntity():this.registerEntity()}loadentities(){this.baseService.get(this.pagination).pipe((0,c.Q)(this.notifier)).subscribe(g=>{this.ngxLoader.stopLoader(p.a7),this.entities=g.data,this.pagination.totalItems=g.totalItems,this.LoadSuccess()},g=>{this.ngxLoader.stopLoader(p.a7),this.alertService.error(g)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[]}LoadSuccess(){}tableChange(g){this.pagination.filterType=g.sortField,this.pagination.sortType=1==g.sortOrder?"asc":"desc",this.loadentities()}registerEntity(){let g=this.mapRegisterForm(this.form);this.baseService.register(g).pipe((0,h.O)(),(0,j.c)(this.mainDelay),(0,ae.Z)(),(0,c.Q)(this.notifier),(0,A.j)(()=>this.ngxLoader.stopLoader(this.operationLoader)),(0,Z.W)(v=>(0,X.$)(v))).subscribe(v=>{v.success?this.submitFunished():this.alertService.error("general.message."+v.message)},v=>{this.alertService.error("general.message."+v)})}editEntity(){let g=this.mapForm(this.form);this.baseService.edit(g.id,g).pipe((0,h.O)(),(0,j.c)(this.mainDelay),(0,ae.Z)(),(0,c.Q)(this.notifier),(0,A.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(v=>{v.success?this.submitFunished():this.alertService.error("general.message."+v.message)},v=>{this.alertService.error("general.message."+v)})}mapForm(g){return g}mapRegisterForm(g){return g.id=0,g}submitFunished(){this.loadentities(),this.alertService.success(),this.modalService?.dismissAll(),this.ngxLoader.stop(p.a7),this.btnDisabled=!0}EditModel(g,v,u="md"){this.isEditForm=!0,this.baseService.getById(g).pipe((0,c.Q)(this.notifier)).subscribe(J=>{J.success?this.form=J.data:this.alertService.error("general.message."+J.message),this.modalService.open(v,{centered:!0,size:u})},J=>{this.alertService.error()})}EditModelTilte(g){this.isEditForm=!0,this.baseService.getById(this.selectedRow[0].id).pipe((0,c.Q)(this.notifier)).subscribe(u=>{u?this.form=u:this.alertService.error("general.message."+u)},u=>{this.alertService.error()})}onSelectionChange(g){this.selectedRow=g,this.lengthSelect=g.length}resetSelected(){this.selectedRow=[],this.lengthSelect=0}pageChanged(g){this.pagination.pageNumber=g,this.loadentities()}ListItemChange(g){this.pagination.pageSize=g.target.value,this.loadentities()}searchChange(g){this.pagination.filterValue=g,this.loadentities()}DeleteConfirm(){this.ngxLoader.startLoader(p.Fq);let g=this.selectedRow.map(v=>v.id);this.baseService.deleteRange(g).pipe((0,h.O)(),(0,j.c)(this.mainDelay),(0,ae.Z)(),(0,c.Q)(this.notifier),(0,A.j)(()=>this.ngxLoader.stopLoader(p.Fq))).subscribe(v=>{v.success?(this.alertService.success(),this.loadentities(),this.modalService.dismissAll(),this.resetSelected()):this.alertService.error("general.message."+v)},()=>{this.alertService.error()})}DeleteConfirmSoft(){console.log(this.selectedRow,"selectedRow"),this.ngxLoader.startLoader(p.Fq),this.baseService.softDelete(this.selectedRow[0].id).pipe((0,h.O)(),(0,j.c)(this.mainDelay),(0,ae.Z)(),(0,c.Q)(this.notifier),(0,A.j)(()=>this.ngxLoader.stopLoader(p.Fq))).subscribe(g=>{g.success?(this.alertService.success(),this.loadentities(),this.modalService.dismissAll(),this.resetSelected()):this.alertService.error("general.message."+g)},()=>{this.alertService.error()})}getIds(){return this.selectedRow.map(g=>g.id)}isEmpty(g){return(void 0===g||null==g||g.length)<=0}OnReset(g){this.form={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems}}onReset(){this.form={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems}}closeModel(g){this.modalRef?.hide()}ngOnDestroy(){this.notifier.next(),this.notifier.complete(),this.OnDestroyMore()}OnDestroyMore(){}static{this.\u0275fac=function(v){return new(v||k)(x.rXU(ue.nX),x.rXU(ve.c$),x.rXU(C.Bq),x.rXU(U.d),x.rXU(_.u),x.rXU(e.vh),x.rXU(V.eD))}}static{this.\u0275cmp=x.VBU({type:k,selectors:[["app-base"]],viewQuery:function(v,u){if(1&v&&x.GBs(ee.XI,5),2&v){let J;x.mGM(J=x.lsd())&&(u.tableMaster=J.first)}},decls:0,vars:0,template:function(v,u){},encapsulation:2})}}return k})()},88148:(be,se,m)=>{m.d(se,{p:()=>h});var d=m(54438),c=m(8147);let h=(()=>{class j{static{this.\u0275fac=function(Z){return new(Z||j)}}static{this.\u0275cmp=d.VBU({type:j,selectors:[["ngb-pagination-info"]],inputs:{pagination:"pagination"},decls:6,vars:2,consts:[[1,"d-inline-block","mx-1","text-pInfo"],["translate","general.table.pFrom",1,"text-pInfo"],["translate","general.table.item",1,"text-pInfo"]],template:function(Z,X){1&Z&&(d.j41(0,"span",0),d.EFF(1),d.k0s(),d.nrm(2,"span",1),d.j41(3,"span",0),d.EFF(4),d.k0s(),d.nrm(5,"span",2)),2&Z&&(d.R7$(),d.JRh(X.pagination.totalItems>X.pagination.pageNumber*X.pagination.pageSize?X.pagination.pageNumber*X.pagination.pageSize:X.pagination.totalItems),d.R7$(3),d.JRh(X.pagination.totalItems))},dependencies:[c.Mm],styles:[".text-pInfo[_ngcontent-%COMP%]{font-size:.7rem;color:#8a96a0}"]})}}return j})()},91580:(be,se,m)=>{m.d(se,{g:()=>ae});var d=m(54438),c=m(60177),h=m(89417);function j(A,Z){if(1&A&&(d.j41(0,"option"),d.EFF(1),d.k0s()),2&A){const X=Z.$implicit;d.R7$(),d.JRh(X)}}let ae=(()=>{class A{constructor(){this.lengthChange=new d.bkB}ListItemChange(X){this.lengthChange.emit(X)}static{this.\u0275fac=function(ee){return new(ee||A)}}static{this.\u0275cmp=d.VBU({type:A,selectors:[["table-length"]],inputs:{lengthTable:"lengthTable"},outputs:{lengthChange:"lengthChange"},decls:4,vars:1,consts:[[1,"card-toolbar","mx-2"],[1,"fs-2","text-primary"],[1,"form-select","mx-2","d-inline","form-select-sm","w-auto",3,"change"],[4,"ngFor","ngForOf"]],template:function(ee,p){1&ee&&(d.j41(0,"div",0),d.nrm(1,"span",1),d.j41(2,"select",2),d.bIt("change",function(ue){return p.ListItemChange(ue)}),d.DNE(3,j,2,1,"option",3),d.k0s()()),2&ee&&(d.R7$(3),d.Y8G("ngForOf",p.lengthTable))},dependencies:[c.Sq,h.xH,h.y7],encapsulation:2})}}return A})()}}]);