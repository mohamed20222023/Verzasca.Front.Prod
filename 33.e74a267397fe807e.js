"use strict";(self.webpackChunkvelzon=self.webpackChunkvelzon||[]).push([[33],{12822:(Te,re,c)=>{c.d(re,{l:()=>te});var p=c(67569),d=c(45312),_=c(54438),G=c(21626);let te=(()=>{class N extends p.d{constructor(D){super(D,d.c.apiUrl+"Channel/")}static{this.\u0275fac=function(ie){return new(ie||N)(_.KVO(G.Qq))}}static{this.\u0275prov=_.jDH({token:N,factory:N.\u0275fac,providedIn:"root"})}}return N})()},16229:(Te,re,c)=>{c.d(re,{m:()=>te});var p=c(67569),d=c(45312),_=c(54438),G=c(21626);let te=(()=>{class N extends p.d{constructor(D){super(D,d.c.apiUrl+"District/")}getByCityId(D){return this.http.get(this.baseUrl+"getByCityId/"+D)}static{this.\u0275fac=function(ie){return new(ie||N)(_.KVO(G.Qq))}}static{this.\u0275prov=_.jDH({token:N,factory:N.\u0275fac,providedIn:"root"})}}return N})()},96402:(Te,re,c)=>{c.d(re,{N:()=>te});var p=c(67569),d=c(45312),_=c(54438),G=c(21626);let te=(()=>{class N extends p.d{constructor(D){super(D,d.c.apiUrl+"Service/"),this.ServiceStatus=[{name:"Published",id:1},{name:"NotPublish",id:2},{name:"Draft",id:3}]}deleteImage(D){return this.http.delete(this.baseUrl+"deleteImage/"+D,this.httpOptions)}deleteUnit(D){return this.http.delete(this.baseUrl+"deleteUnit/"+D,this.httpOptions)}getItemDropDown(){return this.http.get(this.baseUrl+"GetItemDropDown")}servicesByCategory(D){return this.http.post(this.baseUrl+"servicesByCategory",D)}GetServiceList(D,ie){return this.http.get(this.baseUrl+"GetServiceList/"+ie+"/"+D)}SyncOdoo(D){return this.http.post(this.baseUrl+"SyncOdoo",D)}static{this.\u0275fac=function(ie){return new(ie||N)(_.KVO(G.Qq))}}static{this.\u0275prov=_.jDH({token:N,factory:N.\u0275fac,providedIn:"root"})}}return N})()},70053:(Te,re,c)=>{c.d(re,{n:()=>te});var p=c(67569),d=c(45312),_=c(54438),G=c(21626);let te=(()=>{class N extends p.d{constructor(D){super(D,d.c.apiUrl+"Team/")}GetTeamLookUp(){return this.http.get(this.baseUrl+"TeamLookUp")}getAllDropDown(){return this.http.get(this.baseUrl+"GetAllDropDown")}static{this.\u0275fac=function(ie){return new(ie||N)(_.KVO(G.Qq))}}static{this.\u0275prov=_.jDH({token:N,factory:N.\u0275fac,providedIn:"root"})}}return N})()},89033:(Te,re,c)=>{c.r(re),c.d(re,{SalesModule:()=>lp});var p=c(60177),d=c(89417),_=c(69005),G=c(91022),te=c(70255),N=c(63789),tt=c(98982),D=c.n(tt),ie=c(53978),g=c(8147),V=c(45286),it=c(65430),me=c(41631),w=c(1530),P=c(72510),M=c(51188),e=c(54438),ne=c(21413),ve=c(70152),Se=c(23294),ae=c(25558),m=c(56977),v=c(37021),R=c(35335),S=c(45236),f=c(70980),pe=c(99437),ue=c(18810),ge=c(7673),u=c(36158),Y=c(45312),U=c(70072),Ve=c(17478),E=c(3888),oe=c(75922),Pe=c(96402),nt=c(45943),rt=c(95279),B=c(29935),A=c(94575),de=c(38542);function at(r,s){1&r&&(e.j41(0,"div")(1,"div",2)(2,"div",3),e.nrm(3,"span",4),e.j41(4,"div",5),e.nrm(5,"span",6)(6,"span",7),e.k0s()(),e.nrm(7,"div",8),e.k0s()())}function st(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",9)(1,"div",10)(2,"div",11)(3,"div",12)(4,"div",13)(5,"img",14),e.bIt("error",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.setDefaultImage(i,"assets/images/custom/no-img.jpg"))}),e.k0s()()(),e.j41(6,"div",15)(7,"div",16)(8,"div",17)(9,"h5",18),e.EFF(10),e.k0s(),e.j41(11,"div",19)(12,"span",20),e.nrm(13,"i",21),e.EFF(14),e.k0s(),e.j41(15,"span",22),e.EFF(16),e.nI1(17,"translate"),e.k0s()()(),e.j41(18,"div",23)(19,"div",24),e.nrm(20,"i",25),e.j41(21,"a",26),e.EFF(22),e.k0s()(),e.j41(23,"div",24),e.nrm(24,"i",27),e.j41(25,"a",26),e.EFF(26),e.k0s()(),e.j41(27,"div",24),e.nrm(28,"i",28),e.j41(29,"span",29),e.EFF(30),e.nI1(31,"translate"),e.k0s()(),e.j41(32,"div",24),e.nrm(33,"i",30),e.j41(34,"span",29),e.EFF(35),e.nI1(36,"translate"),e.k0s()(),e.j41(37,"div",24),e.nrm(38,"i",31),e.j41(39,"span",29),e.EFF(40),e.nI1(41,"translate"),e.k0s()()()()()(),e.j41(42,"div",32)(43,"div",33)(44,"div",34)(45,"div",10)(46,"h6",35),e.nrm(47,"i",36)(48,"span",37),e.k0s(),e.j41(49,"div",38)(50,"div",33)(51,"div",39)(52,"div",40)(53,"div",41)(54,"div",42),e.nrm(55,"i",43),e.k0s()(),e.j41(56,"div",44)(57,"div",45),e.EFF(58,"sales.salesOrder.creditLimit"),e.k0s(),e.j41(59,"div",29),e.EFF(60),e.k0s()()(),e.j41(61,"div",40)(62,"div",41)(63,"div",42),e.nrm(64,"i",46),e.k0s()(),e.j41(65,"div",47),e.nrm(66,"div",48),e.j41(67,"div",29),e.EFF(68),e.k0s()()()()(),e.j41(69,"div",49)(70,"div",50),e.nrm(71,"div",51),e.k0s(),e.j41(72,"div",52)(73,"small",53),e.EFF(74,"sales.salesOrder.CurrentUsage"),e.k0s(),e.j41(75,"small",54),e.EFF(76),e.nI1(77,"number"),e.k0s()()()()()()()()()(),e.j41(78,"div",55)(79,"div",10)(80,"div",56)(81,"h6",57),e.nrm(82,"i",58),e.j41(83,"span",59),e.EFF(84,"sales.salesOrder.terms"),e.k0s()()(),e.j41(85,"textarea",60),e.nI1(86,"translate"),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.terms,i)||(a.form.terms=i),e.Njj(i)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(5),e.Y8G("src",t.mediaUrl+(null==t.clientInfo?null:t.clientInfo.externalPhotoPath),e.B4B),e.R7$(5),e.JRh(null==t.clientInfo?null:t.clientInfo.name),e.R7$(4),e.SpI(" ",(null==t.clientInfo?null:t.clientInfo.vatNumber)||"N/A"," "),e.R7$(2),e.SpI(" ",(null==t.clientInfo?null:t.clientInfo.clientGroupName)||e.bMT(17,26,"sales.salesOrder.clientGroupName")," "),e.R7$(5),e.Mz_("href","tel:",null==t.clientInfo?null:t.clientInfo.mobile,"",e.B4B),e.R7$(),e.SpI(" ",(null==t.clientInfo?null:t.clientInfo.mobile)||"N/A"," "),e.R7$(3),e.Mz_("href","mailto:",null==t.clientInfo?null:t.clientInfo.email,"",e.B4B),e.R7$(),e.SpI(" ",(null==t.clientInfo?null:t.clientInfo.email)||"N/A"," "),e.R7$(4),e.SpI(" ",(null==t.clientInfo?null:t.clientInfo.nationalAddress)||e.bMT(31,28,"sales.salesOrder.Notprovided")," "),e.R7$(5),e.SpI(" ",(null==t.clientInfo?null:t.clientInfo.region)||e.bMT(36,30,"sales.salesOrder.Notspecified")," "),e.R7$(5),e.SpI(" ",(null==t.clientInfo?null:t.clientInfo.priceList)||e.bMT(41,32,"sales.salesOrder.Notspecified")," "),e.R7$(20),e.JRh((null==t.clientInfo?null:t.clientInfo.creditLimit)||"0"),e.R7$(8),e.JRh((null==t.clientInfo?null:t.clientInfo.balance)||"0"),e.R7$(3),e.xc7("width",t.usagePercent+"%"),e.AVh("bg-success",t.usagePercent<=70)("bg-warning",t.usagePercent>70&&t.usagePercent<=90)("bg-danger",t.usagePercent>90),e.R7$(5),e.SpI("",e.i5U(77,34,(null==t.clientInfo?null:t.clientInfo.balance)/(null==t.clientInfo?null:t.clientInfo.creditLimit)*100||0,"1.0-0"),"%"),e.R7$(9),e.Y8G("placeholder",e.bMT(86,37,"sales.salesOrder.termsPlaceholder")),e.R50("ngModel",t.form.terms)}}let ot=(()=>{class r{constructor(t){this.offerOrder=t,this.form={},this.errorMessage="",this.mediaUrl=Y.c.mediaUrl,this.isOrderEdit=!0}ngOnInit(){this.form=this.offerOrder.salesOrderForm}setDefaultImage(t,n){t.target.src=n}ngOnDestroy(){}get usagePercent(){return this.clientInfo?.creditLimit&&this.clientInfo?.balance?this.clientInfo.balance/this.clientInfo.creditLimit*100:0}static{this.\u0275fac=function(n){return new(n||r)(e.rXU(U.A))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-client-info-salse"]],inputs:{form:"form",isOrderEdit:"isOrderEdit",clientInfo:"clientInfo"},decls:3,vars:2,consts:[["clientInfoContent",""],[4,"ngIf","ngIfElse"],[1,"placeholder-glow"],[1,"d-flex","gap-3","align-items-center","mb-3"],[1,"placeholder","rounded-3",2,"width","90px","height","90px"],[1,"flex-grow-1"],[1,"placeholder","col-6","mb-2"],[1,"placeholder","col-4"],[1,"placeholder","col-12","mb-2",2,"height","100px"],[1,"card","border-0","shadow-sm","rounded-3","mb-4","mt-3","overflow-hidden","animate-fade-in-up"],[1,"card-body","p-3"],[1,"row","align-items-center","mb-3"],[1,"col-auto","pe-3"],[1,"position-relative",2,"width","90px","height","90px"],["alt","Client Photo","loading","lazy","decoding","async","width","90","height","90",1,"rounded-3","border","border-2","shadow-sm",2,"width","100%","height","100%","object-fit","cover",3,"error","src"],[1,"col","ps-0"],[1,"d-flex","flex-column","justify-content-between"],[1,"mb-2"],[1,"mb-1","text-primary","fw-bold"],[1,"d-flex","flex-wrap","align-items-center","gap-2"],[1,"badge","bg-light","text-dark"],[1,"ri-hashtag","text-secondary"],[1,"badge","bg-primary-subtle","text-primary","rounded-pill"],[1,"d-flex","flex-wrap","align-items-center","gap-3"],[1,"d-flex","align-items-center","text-muted","small"],[1,"ri-phone-line","text-primary","me-1"],[1,"text-decoration-none","text-break","fw-medium",3,"href"],[1,"ri-mail-line","text-primary","me-1"],[1,"ri-home-line","text-primary","me-1"],[1,"fw-medium"],[1,"ri-map-2-line","text-primary","me-1"],[1,"ri-percent-fill","text-danger","me-1"],[1,"row","g-3"],[1,"col-12"],[1,"card","h-100","shadow","border-0","bg-light","bg-opacity-50","rounded-3"],[1,"card-title","text-primary","mb-3"],[1,"ri-funds-line","me-1"],["translate","sales.salesOrder.financialInfo"],[1,"row","g-2"],[1,"d-flex","justify-content-between","align-items-center"],[1,"d-flex","align-items-center"],[1,"flex-shrink-0"],[1,"avatar","avatar-xs","bg-primary","bg-opacity-10","rounded","p-1"],[1,"ri-money-dollar-circle-line","text-primary"],[1,"flex-grow-1","ms-2","text-start"],["translate","",1,"text-muted","small"],[1,"ri-bank-card-line","text-primary"],[1,"flex-grow-1","ms-2","text-end"],["translate","sales.salesOrder.Balance",1,"text-muted","small"],[1,"col-12","mt-2"],[1,"progress",2,"height","5px"],["role","progressbar","aria-valuenow","usagePercent","aria-valuemin","0","aria-valuemax","100",1,"progress-bar"],[1,"d-flex","justify-content-between","mt-1"],["translate","",1,"text-muted"],[1,"text-success"],[1,"card","border-0","shadow-sm","rounded-3","mb-4"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],[1,"mb-0","fw-semibold"],[1,"ri-file-list-3-line","me-2","text-primary"],["translate",""],["id","terms","rows","4","name","terms","type","text",1,"form-control","border-0","bg-light",3,"ngModelChange","placeholder","ngModel"]],template:function(n,i){if(1&n&&e.DNE(0,at,8,0,"div",1)(1,st,87,39,"ng-template",null,0,e.C5r),2&n){const a=e.sdS(2);e.Y8G("ngIf",!i.clientInfo)("ngIfElse",a)}},dependencies:[p.bT,d.me,d.BC,d.vS,g.Mm,p.QX,g.D9],styles:[".animate-fade-in-up[_ngcontent-%COMP%] {\n        opacity: 0;\n        transform: translateY(20px);\n        animation: _ngcontent-%COMP%_fadeInUp 0.7s ease-out forwards;\n    }\n    \n    @keyframes _ngcontent-%COMP%_fadeInUp {\n        to {\n            opacity: 1;\n            transform: translateY(0);\n        }\n    }"]})}}return r})();var lt=c(25947),dt=c(33121),le=c(12260),z=c(15084);const ct=r=>({"border-primary shadow-sm":r});function mt(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",26)(1,"div",32),e.bIt("click",function(){const i=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.locationChange(i))}),e.j41(2,"input",33),e.bIt("click",function(i){return e.eBV(t),e.Njj(i.stopPropagation())}),e.k0s(),e.j41(3,"label",34)(4,"span",35),e.EFF(5),e.k0s(),e.j41(6,"span",36),e.EFF(7),e.k0s()(),e.j41(8,"div",37)(9,"div",38)(10,"button",39),e.bIt("click",function(i){const a=e.eBV(t).$implicit,o=e.XpG(),l=e.sdS(26);return i.stopPropagation(),e.Njj(o.openEditModal(a,l))}),e.nrm(11,"i",40)(12,"span",41),e.k0s(),e.j41(13,"button",42),e.bIt("click",function(i){const a=e.eBV(t).$implicit,o=e.XpG(),l=e.sdS(28);return i.stopPropagation(),e.Njj(o.confirm(a.id,l))}),e.nrm(14,"i",43)(15,"span",44),e.k0s()()()()()}if(2&r){const t=s.$implicit;e.R7$(),e.Y8G("ngClass",e.eq3(9,ct,t.isSelected)),e.R7$(),e.Mz_("id","S",t.id,""),e.Y8G("checked",t.isSelected),e.R7$(),e.Mz_("for","S",t.id,""),e.R7$(2),e.Lme(" ",t.cityName," - ",t.name," "),e.R7$(2),e.SpI(" ",t.address," ")}}function pt(r,s){1&r&&(e.j41(0,"span",78),e.EFF(1,"general.action.register"),e.k0s())}function ut(r,s){1&r&&(e.j41(0,"span",78),e.EFF(1,"general.action.edit"),e.k0s())}function gt(r,s){1&r&&(e.j41(0,"div",79),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function _t(r,s){1&r&&(e.j41(0,"div",79),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function ht(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",45)(1,"div",46)(2,"h4",47),e.DNE(3,pt,2,0,"span",48)(4,ut,2,0,"span",48),e.k0s(),e.j41(5,"button",49),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss("Cross click"))}),e.k0s()(),e.j41(6,"div",50),e.nrm(7,"ngx-ui-loader",51),e.j41(8,"form",52,2),e.bIt("submit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.OnSubmit())}),e.j41(10,"div",24)(11,"div",53),e.nrm(12,"label",54),e.j41(13,"ng-select",55,3),e.nI1(15,"translate"),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.formEdit.cityCode,i)||(a.formEdit.cityCode=i),e.Njj(i)}),e.k0s()(),e.j41(16,"div",56)(17,"div",57)(18,"label",58),e.EFF(19,"general.table.isMain"),e.k0s(),e.j41(20,"div",59)(21,"p-inputSwitch",60),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.formEdit.isMain,i)||(a.formEdit.isMain=i),e.Njj(i)}),e.k0s()()()(),e.j41(22,"div",61),e.nrm(23,"label",62),e.j41(24,"input",63,4),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.formEdit.name,i)||(a.formEdit.name=i),e.Njj(i)}),e.k0s(),e.DNE(26,gt,2,0,"div",64),e.k0s(),e.j41(27,"div",61),e.nrm(28,"label",65),e.j41(29,"textarea",66,5),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.formEdit.address,i)||(a.formEdit.address=i),e.Njj(i)}),e.k0s(),e.DNE(31,_t,2,0,"div",64),e.k0s(),e.j41(32,"div",61),e.nrm(33,"label",67),e.j41(34,"input",68,6),e.bIt("change",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.onUrlChange(i))}),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.formEdit.mapURL,i)||(a.formEdit.mapURL=i),e.Njj(i)}),e.k0s()(),e.j41(36,"div",69),e.nrm(37,"label",70),e.j41(38,"input",71,7),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.formEdit.lat,i)||(a.formEdit.lat=i),e.Njj(i)}),e.k0s()(),e.j41(40,"div",69),e.nrm(41,"label",72),e.j41(42,"input",73,8),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.formEdit.lng,i)||(a.formEdit.lng=i),e.Njj(i)}),e.k0s()()(),e.j41(44,"div",74)(45,"button",75),e.nrm(46,"i",76)(47,"span",77),e.k0s()()()()()}if(2&r){const t=e.sdS(9),n=e.sdS(25),i=e.sdS(30),a=e.XpG();e.R7$(3),e.Y8G("ngIf",!a.isEditForm),e.R7$(),e.Y8G("ngIf",a.isEditForm),e.R7$(3),e.Y8G("hasProgressBar",!1)("fgsType",a.loaderOperationShap)("loaderId","locationOperation"),e.R7$(6),e.FS9("placeholder",e.bMT(15,18,"orderManagement.order.cityName")),e.R50("ngModel",a.formEdit.cityCode),e.Y8G("items",a.cities)("multiple",!1),e.R7$(8),e.R50("ngModel",a.formEdit.isMain),e.R7$(3),e.R50("ngModel",a.formEdit.name),e.R7$(2),e.Y8G("ngIf",n.invalid&&n.touched),e.R7$(3),e.R50("ngModel",a.formEdit.address),e.R7$(2),e.Y8G("ngIf",i.invalid&&i.touched),e.R7$(3),e.R50("ngModel",a.formEdit.mapURL),e.R7$(4),e.R50("ngModel",a.formEdit.lat),e.R7$(4),e.R50("ngModel",a.formEdit.lng),e.R7$(3),e.Y8G("disabled",!t.valid)}}function ft(r,s){if(1&r){const t=e.RV6();e.j41(0,"delete-modal",80),e.bIt("deleteConfirm",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.DeleteConfirm())})("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}}let vt=(()=>{class r{constructor(t,n,i,a,o,l,h,x){this.modalService=t,this.baseService=n,this.alertService=i,this.ngxLoader=a,this.whatsupService=o,this.whatsAppMessagesService=l,this.cityService=h,this.offerOrder=x,this.submitted=!1,this.form={},this.mainDelay=20,this.notifier=new ne.B,this.operationLoader=u.ZW,this.isEditForm=!1,this.loaderOperationShap=u.$$,this.isLoad=!1,this.formEdit={},this.cities=[],this.idSelected=0,this.isOrderEdit=!0,this.modalRefs={}}ngOnInit(){this.form=this.offerOrder.salesOrderForm,this.form.clientId&&this.checkLocation(),this.form.clientLocationId&&this.checkSelected(this.form.clientLocationId),this.GetCities()}confirm(t,n){this.idSelected=t,this.modalService.open(n,{centered:!0})}openModal(t){this.ngxLoader.stopLoader(this.operationLoader),this.submitted=!1,this.modalRefs=this.modalService.open(t,{size:"md",centered:!0})}openEditModal(t,n){this.submitted=!1,this.formEdit=t,this.isEditForm=!0,this.modalRefs=this.modalService.open(n,{size:"md",centered:!0})}changeActiveTab(t){this.nav.select(t)}GetCities(){this.cityService.GetAllDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}registerEntity(t=!1){this.ngxLoader.startLoader("locationOperation");let n=this.mapRegisterForm(this.formEdit);n.isSend=t,this.baseService.AddLocation(n).pipe((0,v.O)(),(0,R.c)(this.mainDelay),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader("locationOperation")),(0,pe.W)(i=>(0,ue.$)(i))).subscribe(i=>{i.success?(this.alertService.success(),this.modalRefs.dismiss(),this.refresh()):this.alertService.error("general.message."+i.message)},i=>{this.alertService.error("general.message."+i)})}editEntity(t=!1){this.ngxLoader.startLoader("locationOperation");let n=this.mapForm(this.formEdit);n.isSend=t,this.baseService.EditLocation(n).pipe((0,v.O)(),(0,R.c)(this.mainDelay),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader("locationOperation"))).subscribe(i=>{i.success?(this.alertService.success(),this.modalRefs.dismiss(),this.refresh()):this.alertService.error("general.message."+i.message)},i=>{this.alertService.error("general.message."+i)})}mapForm(t){let n={...t};return n.agentCode=this.form.clientId,n.cityCode=n.cityCode,n.agentName="",n.mobile="",n.mapURL=n.mapURL,n.isMain=n.isMain,n.lat=n.lat?n.lat.toString():"",n.lng=n.lng?n.lng.toString():"",n}mapRegisterForm(t){let n={...t};return n.id=0,n.cityCode=n.cityCode,n.agentName="",n.mobile="",n.agentCode=this.form.clientId,n.mapURL=n.mapURL,n.isMain=n.isMain,n.lat=n.lat?n.lat.toString():"",n.lng=n.lng?n.lng.toString():"",n}submitFunished(){this.alertService.success(),this.modalService?.dismissAll()}OnSubmit(t=!1){this.ngxLoader.startLoader(this.operationLoader),!0===this.isEditForm?this.editEntity(t):this.registerEntity(t)}getFromClient(){this.form.agent.mobile||this.alertService.error("orderManagement.order.mustEnterNumber"),this.isLoad=!0,this.whatsupService.GetLocationFromClient(this.form.agent.mobile).pipe((0,m.Q)(this.notifier),(0,f.j)(()=>this.isLoad=!1)).subscribe(t=>{t.success?this.alertService.success("orderManagement.order.successSendLocation"):this.alertService.error("orderManagement.order.failSendLocation")},()=>{this.alertService.error("orderManagement.order.failSendLocation")})}DeleteConfirm(){this.baseService.DeleteLocation(this.idSelected).pipe((0,v.O)(),(0,R.c)(this.mainDelay),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader("deleteLoader"))).subscribe(t=>{if(t.success){const n=this.form.locations.findIndex(i=>i.id===this.idSelected);-1!==n&&this.form.locations.splice(n,1),this.alertService.success(),this.modalService.dismissAll()}else this.alertService.error("general.message."+t)},()=>{this.alertService.error()})}getClientLocations(t){this.baseService.GetClientLocations(t).subscribe(n=>{this.form.locations=n.data,this.offerOrder.salesOrderForm.locations=n.data})}refresh(){this.getClientLocations(this.offerOrder.salesOrderForm.clientId),this.checkLocation()}locationChange(t){this.form.clientLocationId=t.id;let n=this.form.locations.find(i=>i.id==t.id);n.isSelected=!n.isSelected,this.offerOrder.salesOrderForm.clientLocationId=this.form.clientLocationId,this.offerOrder.checkValidationSource.next(!0)}checkSelected(t){this.offerOrder.checkValidationSource.next(!0),this.form.locations.find(i=>i.id==t).isSelected=!0}checkLocation(){this.offerOrder.checkValidationSource.next(!0)}ngOnDestroy(){this.notifier.next(),this.notifier.complete()}onUrlChange(t){let n=t.target.value.trim(),i=null;try{i=new URL(n).searchParams.get("q")}catch{i=n}if(i){let[a,o]=i.split(",").map(l=>Number(l.trim()));!isNaN(a)&&!isNaN(o)&&(this.formEdit.lat=a,this.formEdit.lng=o)}}static{this.\u0275fac=function(n){return new(n||r)(e.rXU(_.Bq),e.rXU(oe.X),e.rXU(E.u),e.rXU(w.eD),e.rXU(lt.A),e.rXU(dt.Q),e.rXU(le.h),e.rXU(U.A))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["client-location-salse"]],viewQuery:function(n,i){if(1&n&&e.GBs(_.X9,5),2&n){let a;e.mGM(a=e.lsd())&&(i.nav=a.first)}},inputs:{form:"form",isOrderEdit:"isOrderEdit"},features:[e.Jv_([_.X9])],decls:29,vars:6,consts:[["content",""],["deleteModal",""],["formEntity","ngForm"],["cityCode","ngModel"],["name","ngModel"],["address","ngModel"],["mapURL","ngModel"],["lat","ngModel"],["lng","ngModel"],[1,"container-fluid","mt-4"],[1,"row","mb-4"],[1,"col-12","col-md-6","col-lg-4"],[1,"form-group"],["for","clientVisitDate",1,"form-label","fw-bold"],[1,"ri-calendar-event-line","me-2"],["translate",""],["name","clientVisitDate","id","clientVisitDate","type","text","mwlFlatpickr","","altFormat","d-m-Y H:i",1,"form-control","flatpickr-input",3,"ngModelChange","ngModel","altInput","enableTime","convertModelValue","dateFormat"],[1,"card","mb-4"],[1,"card-header","bg-light"],[1,"d-flex","justify-content-between","align-items-center"],[1,"card-title","fs-4","fw-bold","mb-0"],[1,"ri-map-pin-line","me-2"],["translate","orderManagement.order.savedAddress"],[1,"card-body"],[1,"row","g-3"],["class","col-lg-4 col-md-6",4,"ngFor","ngForOf"],[1,"col-lg-4","col-md-6"],[1,"card","h-100","border-dashed","border-1","border-primary","add-card",3,"click"],[1,"card-body","d-flex","flex-column","justify-content-center","align-items-center","py-4"],[1,"text-primary","mb-2"],[1,"ri-add-circle-line","fs-1"],["translate","",1,"text-primary","mb-0"],[1,"form-check","card-radio","h-100","location-card",3,"click","ngClass"],["type","radio","name","location",1,"form-check-input",3,"click","id","checked"],[1,"form-check-label",3,"for"],[1,"mb-4","fw-bold","d-block","text-muted","text-uppercase"],[1,"text-muted","fw-normal","text-wrap","mb-1","d-block"],[1,"card-footer","bg-light","p-0"],[1,"d-flex"],[1,"btn","btn-outline-primary","flex-grow-1","rounded-0","border-0",3,"click"],[1,"ri-pencil-fill","me-1"],["translate","general.action.edit"],[1,"btn","btn-outline-danger","flex-grow-1","rounded-0","border-0",3,"click"],[1,"ri-delete-bin-fill","me-1"],["translate","general.action.delete"],[1,"modal-content","border-0"],[1,"modal-header","bg-primary","text-white"],[1,"modal-title"],["class","fw-bold","translate","",4,"ngIf"],["type","button",1,"btn-close","btn-close-white",3,"click"],[1,"modal-body"],[3,"hasProgressBar","fgsType","loaderId"],[1,"needs-validation",3,"submit"],[1,"col-md-8"],["for","cityCode","translate","orderManagement.order.cityName",1,"form-label","fw-bold","required"],["name","cityCode","id","cityCode","bindValue","code","bindLabel","name",1,"form-control","p-0",3,"ngModelChange","ngModel","placeholder","items","multiple"],[1,"col-md-4"],[1,"form-group","h-100","d-flex","flex-column","justify-content-end"],["for","isMain","translate","",1,"form-label","fw-bold"],[1,"form-check","form-switch","mt-2"],["name","isMain","inputId","isMain",3,"ngModelChange","ngModel"],[1,"col-12"],["for","name","translate","orderManagement.order.name",1,"form-label","fw-bold","required"],["InputTirmFilter","","name","name","type","text","id","name","required","",1,"form-control",3,"ngModelChange","ngModel"],["class","invalid-feedback d-block","translate","",4,"ngIf"],["for","address","translate","orderManagement.order.address",1,"form-label","fw-bold"],["rows","2","InputTirmFilter","","name","address","id","address",1,"form-control",3,"ngModelChange","ngModel"],["for","mapURL","translate","orderManagement.order.mapURL",1,"form-label","fw-bold"],["InputTirmFilter","","name","mapURL","type","text","id","mapURL",1,"form-control",3,"change","ngModelChange","ngModel"],[1,"col-md-6"],["for","lat","translate","orderManagement.order.lat",1,"form-label","fw-bold"],["disabled","","InputTirmFilter","","name","lat","type","text","id","lat",1,"form-control","bg-light",3,"ngModelChange","ngModel"],["for","lng","translate","orderManagement.order.lng",1,"form-label","fw-bold"],["disabled","","InputTirmFilter","","name","lng","type","text","id","lng",1,"form-control","bg-light",3,"ngModelChange","ngModel"],[1,"text-center","mt-4"],["type","submit",1,"btn","btn-primary","px-4",3,"disabled"],[1,"ri-check-double-line","me-1"],["translate","general.action.save"],["translate","",1,"fw-bold"],["translate","",1,"invalid-feedback","d-block"],[3,"deleteConfirm","dismiss"]],template:function(n,i){if(1&n){const a=e.RV6();e.j41(0,"div",9)(1,"div",10)(2,"div",11)(3,"div",12)(4,"label",13),e.nrm(5,"i",14),e.j41(6,"span",15),e.EFF(7,"sales.salesOrder.acutalVisitDate"),e.k0s()(),e.j41(8,"input",16),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.form.clientVisitDate,l)||(i.form.clientVisitDate=l),e.Njj(l)}),e.k0s()()()(),e.j41(9,"div",17)(10,"div",18)(11,"div",19)(12,"h3",20),e.nrm(13,"i",21)(14,"span",22),e.k0s()()(),e.j41(15,"div",23)(16,"div",24),e.DNE(17,mt,16,11,"div",25),e.j41(18,"div",26)(19,"div",27),e.bIt("click",function(){e.eBV(a);const l=e.sdS(26);return e.Njj(i.openModal(l))}),e.j41(20,"div",28)(21,"div",29),e.nrm(22,"i",30),e.k0s(),e.j41(23,"h5",31),e.EFF(24," sales.salesOrder.AddNewAddress "),e.k0s()()()()()()()(),e.DNE(25,ht,48,20,"ng-template",null,0,e.C5r)(27,ft,1,0,"ng-template",null,1,e.C5r)}2&n&&(e.R7$(8),e.R50("ngModel",i.form.clientVisitDate),e.Y8G("altInput",!0)("enableTime",!0)("convertModelValue",!0)("dateFormat","d-m-Y H:i"),e.R7$(9),e.Y8G("ngForOf",i.form.locations))},dependencies:[p.YU,p.Sq,p.bT,d.qT,d.me,d.BC,d.cb,d.YS,d.vS,d.cV,g.Mm,B.m,P.vr,G.kL,me.HW,w.Cv,z.w,g.D9],styles:[".border-dashed[_ngcontent-%COMP%] {\n    border-style: dashed !important;\n  }\n\n  .location-card[_ngcontent-%COMP%] {\n    cursor: pointer;\n    transition: all 0.2s ease;\n  }\n\n  .location-card[_ngcontent-%COMP%]:hover {\n    border-color: #dee2e6;\n    box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);\n  }\n\n  .add-card[_ngcontent-%COMP%] {\n    cursor: pointer;\n    transition: all 0.2s ease;\n  }\n\n  .add-card[_ngcontent-%COMP%]:hover {\n    background-color: rgba(13, 110, 253, 0.04);\n  }"]})}}return r})();function St(r,s){if(1&r){const t=e.RV6();e.j41(0,"h3",9),e.nrm(1,"span",10),e.j41(2,"a",11),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.goOrders())}),e.EFF(3),e.k0s()()}if(2&r){const t=e.XpG();e.R7$(3),e.SpI("#SR#",t.orderCode,"")}}let Ct=(()=>{class r{constructor(t){this.router=t,this.form={},this.orderCode=0,this.statusOrder=0,this.newOrder=new e.bkB,this.editOrderActiveTab=new e.bkB}ngOnDestroy(){}ngOnInit(){}newOrderAgain(){this.newOrder.next(!0)}goOrders(){this.router.navigateByUrl("/sales/sales-order")}static{this.\u0275fac=function(n){return new(n||r)(e.rXU(M.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-finish-order-salse"]],inputs:{form:"form",orderCode:"orderCode",statusOrder:"statusOrder"},outputs:{newOrder:"newOrder",editOrderActiveTab:"editOrderActiveTab"},decls:9,vars:1,consts:[[1,"text-center","py-5"],[1,"mb-4"],["src","https://cdn.lordicon.com/lupuorrc.json","trigger","loop","colors","primary:#0ab39c,secondary:#405189",2,"width","120px","height","120px"],["translate","orderManagement.order.orderSaveSuccess"],["class","fw-semibold",4,"ngIf"],[1,"d-flex","align-items-start","gap-3","mt-4"],["type","button","data-nexttab","pills-finish-tab",1,"btn","btn-primary","btn-label","right","ms-auto","nexttab",3,"click"],[1,"ri-chat-new-line","label-icon","align-middle","fs-16","ms-2"],["translate","orderManagement.order.newOrderAgain"],[1,"fw-semibold"],["translate","orderManagement.order.orderCode"],["routerLink","/ecommerce/order-details",1,"text-decoration-underline",3,"click"]],template:function(n,i){1&n&&(e.j41(0,"div",0)(1,"div",1),e.nrm(2,"lord-icon",2),e.k0s(),e.nrm(3,"h5",3),e.DNE(4,St,4,1,"h3",4),e.k0s(),e.j41(5,"div",5)(6,"button",6),e.bIt("click",function(){return i.newOrderAgain()}),e.nrm(7,"i",7)(8,"span",8),e.k0s()()),2&n&&(e.R7$(4),e.Y8G("ngIf",i.orderCode>0))},dependencies:[p.bT,g.Mm,M.Wk],encapsulation:2})}}return r})();const xt=r=>({"border-success border-5":r}),yt=(r,s,t)=>({"text-success":r,"text-warning":s,"text-danger":t}),It=(r,s,t)=>({"bg-success":r,"bg-danger":s,"bg-warning":t});function jt(r,s){if(1&r){const t=e.RV6();e.j41(0,"button",19),e.bIt("click",function(){const i=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.chooseCategory(i))}),e.EFF(1),e.k0s()}if(2&r){const t=s.$implicit;e.AVh("active",t.isSelected),e.R7$(),e.SpI(" ",t.name," ")}}function Tt(r,s){1&r&&(e.j41(0,"div",20),e.nrm(1,"button",21),e.k0s())}function kt(r,s){if(1&r&&(e.j41(0,"span",46)(1,"del"),e.EFF(2),e.nI1(3,"translate"),e.k0s()()),2&r){const t=e.XpG().$implicit;e.R7$(2),e.Lme(" ",t.priceOld," ",e.bMT(3,2,"orderManagement.order.currancy"),"")}}function wt(r,s){if(1&r){const t=e.RV6();e.qex(0),e.j41(1,"div",22)(2,"div",23)(3,"div",24),e.bIt("click",function(i){const a=e.eBV(t).$implicit,o=e.XpG();return e.Njj(o.onServiceChange(a.id,i))}),e.j41(4,"div",25)(5,"div",26),e.nrm(6,"img",27),e.k0s(),e.j41(7,"div",26)(8,"h5",28),e.EFF(9),e.k0s()()(),e.j41(10,"div",29),e.nrm(11,"div",30),e.j41(12,"div",31),e.EFF(13),e.k0s()(),e.j41(14,"div",32),e.nrm(15,"div",33),e.j41(16,"div",31)(17,"span",34),e.EFF(18),e.k0s()()(),e.j41(19,"div",32),e.nrm(20,"div",35),e.j41(21,"div",36)(22,"span",37),e.EFF(23),e.k0s()()(),e.j41(24,"div",32),e.nrm(25,"div",38),e.j41(26,"div",39),e.DNE(27,kt,4,4,"span",40),e.j41(28,"span"),e.EFF(29),e.nI1(30,"translate"),e.k0s()()()(),e.j41(31,"div",41)(32,"div",42),e.nrm(33,"div",43),e.j41(34,"div",44)(35,"ng-select",45),e.bIt("change",function(i){const a=e.eBV(t).$implicit,o=e.XpG();return e.Njj(o.unitChange(a,i))}),e.mxI("ngModelChange",function(i){const a=e.eBV(t).$implicit;return e.DH7(a.unitId,i)||(a.unitId=i),e.Njj(i)}),e.k0s()()()()()(),e.bVm()}if(2&r){const t=s.$implicit,n=e.XpG();e.R7$(2),e.Y8G("ngClass",e.eq3(17,xt,t.isSelected)),e.R7$(4),e.Y8G("src",n.serverImage+t.image,e.B4B)("alt",t.name),e.R7$(3),e.JRh(t.name),e.R7$(4),e.JRh(t.categoryName),e.R7$(4),e.Y8G("ngClass",e.sMw(19,yt,t.stock>10,t.stock<=10&&t.stock>0,t.stock<=0)),e.R7$(),e.SpI(" ",t.stock," "),e.R7$(4),e.Y8G("ngClass",e.sMw(23,It,"Active"===t.status,"Inactive"===t.status,"Active"!==t.status&&"Inactive"!==t.status)),e.R7$(),e.SpI(" ",t.status," "),e.R7$(4),e.Y8G("ngIf",t.price<t.priceOld),e.R7$(2),e.Lme("",t.price," ",e.bMT(30,15,"orderManagement.order.currancy"),""),e.R7$(6),e.Y8G("clearable",!1)("items",t.units),e.R50("ngModel",t.unitId)}}let Mt=(()=>{class r{constructor(t,n){this.translateService=t,this.offerOrder=n,this.form={},this.selectedServices=[],this.notifier=new ne.B,this.mainDelay=100,this.loaderSearchShap=u.cX,this.loaderOperationShap=u.$$,this.operationLoader=u.ZW,this.isEditForm=!1,this.showEdit=!1,this.serviceCategories=[],this.services=[],this.currentLang=this.translateService.currentLang,this.subtotal=0,this.total=0,this.serverImage=Y.c.mediaUrl,this.filteredServices=[],this.seviceCount=0,this.serviceSelected=[],this.allItems=this.getTranslationText("basicData.item.allItems"),this.CalcTotal=new e.bkB,this.isOrderEdit=!0,this.productsLookUp=[],this.init=0,this.responsiveOptions=[{breakpoint:"1400px",numVisible:4,numScroll:3},{breakpoint:"1220px",numVisible:4,numScroll:2},{breakpoint:"1100px",numVisible:4,numScroll:1}]}ngOnDestroy(){this.notifier.next(),this.notifier.complete()}ngOnInit(){this.getCategory(),this.getServicesByCategory(),this.offerOrder.removeServiceQ.pipe((0,m.Q)(this.notifier)).subscribe(t=>{if(0==this.init)return void(this.init=1);const n=this.filteredServices.find(i=>i.id==t);n&&(n.isSelected=!1),this.seviceCount=this.filteredServices.filter(i=>i.isSelected).length})}getCategory(){let t=this.offerOrder.salesOrderForm.serviceCategoryCode;this.serviceCategories=this.productsLookUp.categories,this.serviceCategories=this.serviceCategories.map(n=>({...n,isSelected:n.id===t}))}addService(t){const n=this.form.items.findIndex(i=>i.itemId===t.id&&0==i.isFree);n>-1?this.form.items.splice(n,1):(t.isSelected=!0,this.form.items.push({itemGroup:null,itemName:t.name,itemId:t.id,image:t.image,description:t.description,unitId:t.units[0].id,units:t.units,quantity:t.quantity,isFree:!1,priceUnit:t.units[0].price,discount:0,discountType:1,originalPrice:t.units[0].price,price:t.units[0].price,net:t.price*t.quantity})),this.checkTotal(),this.offerOrder.checkValidationSource.next(!0)}updatePrice(t){const n=this.form.orderServices.find(i=>i.serviceCode===t.code);n.quantity=t.quantity,n.price=t.price}checkTotal(){this.CalcTotal.next(!0)}deleteService(t){this.form.orderServices.splice(t,1)}deletePayment(t){this.form.orderPayments.splice(t,1)}resetServiceForm(){let t=this.form.formServices;t.serviceCode=void 0,t.price=null,t.notes=null}resetPaymentForm(){let t=this.form.formPayment;t.paymentTypeCode=null,t.value=null,t.attachRecietPath=null,t.fileName=null}configRoute(){}getServicesByCategory(){this.services=this.setupUnit(this.productsLookUp.servies),this.filteredServices=this.services}setupUnit(t){return t.forEach(n=>{n.units.length>0&&(n.unitId=n.units[0].id,n.price=n.units[0].price)}),t}unitChange(t,n){if(!t.isSelected)return;let i=this.form.items.find(o=>o.itemId===t.id),a=this.filteredServices.find(o=>o.id===t.id);i.unitId=n.id,i.unitPrice=n.price,i.price=n.price,i.priceOld=n.priceOld,a.unitPrice=n.price,a.price=n.price,a.unitId=n.id,this.checkTotal()}checkSelected(){this.form.items.forEach(t=>{let n=this.filteredServices.find(i=>i.id===t.itemId);n&&(n.isSelected=!0)})}getTranslationText(t){let n="";return this.translateService.get(t).pipe((0,m.Q)(this.notifier)).subscribe(i=>{n=i}),n}onTimeSelected(t){this.form.orderTeams=t}chooseCategory(t){this.serviceCategories=this.serviceCategories.map(n=>({...n,isSelected:n.id===t.id})),this.offerOrder.salesOrderForm.serviceCategoryCode=t.id,this.filteredServices=0==t.id?this.services:this.services?.filter(n=>n?.categoryId===t?.id)??[]}onServiceChange(t,n){n.stopPropagation();let i=this.filteredServices.find(a=>a.id===t);i&&(i.isSelected=!i.isSelected),this.seviceCount=this.filteredServices.filter(a=>a.isSelected).length,this.addService(i)}btnPlus(t,n){n.stopPropagation();const i=this.filteredServices.find(a=>a.code===t);i&&(i.quantity++,this.updatePrice(i),this.checkTotal())}btnMinus(t,n){n.stopPropagation();const i=this.filteredServices.find(a=>a.code===t);i&&i.quantity>1?i.quantity-=1:i.quantity=1,this.updatePrice(i),this.checkTotal()}searchChange(t){const n=t.target.value.toLowerCase();this.filteredServices=""===n?[...this.services]:this.services.filter(i=>i.name.toLowerCase().includes(n)||i.sku.toLowerCase().includes(n))}static{this.\u0275fac=function(n){return new(n||r)(e.rXU(g.c$),e.rXU(U.A))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["order-products"]],inputs:{form:"form",serviceCategories:"serviceCategories",isOrderEdit:"isOrderEdit",productsLookUp:"productsLookUp"},outputs:{CalcTotal:"CalcTotal"},decls:25,vars:12,consts:[["categoriesContainer",""],[1,"service-container"],[1,"mt-2"],[1,"categories-container"],[1,"categories-title"],[1,"categories-slider-container"],[1,"categories-slider"],["class","category-btn",3,"active","click",4,"ngFor","ngForOf"],[1,"row","justify-content-center","align-items-center","border-bottom"],[1,"col-12","col-md-12","mx-5"],[1,"search-box","mb-3"],["type","search","id","filterValue","name","filterValue",1,"form-control","search","bg-light","rounded-pill",3,"keyup","placeholder"],[1,"ri-search-line","search-icon"],[1,"row","justify-content-between","align-items-center"],[1,"col-12","col-md-5"],[1,"mb-0","d-inline-block","position-relative"],["class","d-flex justify-content-center",4,"ngIf"],[1,"mt-3","row","row-cols-3"],[4,"ngFor","ngForOf"],[1,"category-btn",3,"click"],[1,"d-flex","justify-content-center"],["type","button","translate","orderManagement.order.noProduct",1,"btn","btn-sm","my-2","btn-danger","fs-4","mb-3"],[1,"col-12","col-md-4","mb-4"],[1,"card","card-service","h-100","shadow-sm","hover-shadow","transition-all",3,"ngClass"],[1,"card-body","p-3",3,"click"],[1,"row","g-3","align-items-center","mb-3"],[1,"col-12","col-md-6"],["onerror","this.onerror=null;this.src='assets/images/custom/no-img.jpg';",1,"img-fluid","rounded",2,"height","120px","object-fit","cover",3,"src","alt"],[1,"card-title","fw-bold","text-primary","mb-0"],[1,"row","g-2","mb-2","border-top","pt-2"],["translate","sales.salesOrder.category",1,"col-5","text-muted","small"],[1,"col-7","small","fw-medium"],[1,"row","g-2","mb-2"],["translate","sales.salesOrder.stock",1,"col-5","text-muted","small"],[3,"ngClass"],["translate","sales.salesOrder.status",1,"col-5","text-muted","small"],[1,"col-7","small"],[1,"badge",3,"ngClass"],["translate","sales.salesOrder.price",1,"col-5","text-muted","small"],[1,"col-7","small","fw-bold"],["class","text-danger mx-3 ",4,"ngIf"],[1,"card-footer","bg-light","p-3"],[1,"row","g-2","align-items-center"],["translate","sales.salesOrder.unit",1,"col-5","text-muted","small"],[1,"col-7"],["bindValue","id","bindLabel","name",1,"form-control-sm","p-0",3,"change","ngModelChange","clearable","items","ngModel"],[1,"text-danger","mx-3"]],template:function(n,i){if(1&n){const a=e.RV6();e.j41(0,"div",1)(1,"div",2)(2,"bdi")(3,"div",3)(4,"h4",4),e.EFF(5),e.nI1(6,"translate"),e.k0s(),e.j41(7,"div",5,0)(9,"div",6),e.DNE(10,jt,2,3,"button",7),e.k0s()()()()(),e.j41(11,"div",8)(12,"div",9)(13,"div",10)(14,"input",11),e.nI1(15,"translate"),e.bIt("keyup",function(l){return e.eBV(a),e.Njj(i.searchChange(l))}),e.k0s(),e.nrm(16,"i",12),e.k0s()()(),e.j41(17,"div",13)(18,"div",14)(19,"h4",15),e.EFF(20),e.nI1(21,"translate"),e.k0s()()(),e.DNE(22,Tt,2,0,"div",16),e.j41(23,"div",17),e.DNE(24,wt,36,27,"ng-container",18),e.k0s()()}2&n&&(e.R7$(5),e.SpI(" ",e.bMT(6,6,"orderManagement.order.serviceProduct"),""),e.R7$(5),e.Y8G("ngForOf",i.serviceCategories),e.R7$(4),e.FS9("placeholder",e.bMT(15,8,"orderManagement.order.searchProduct")),e.R7$(6),e.SpI(" ",e.bMT(21,10,"orderManagement.order.selectedProducts")," "),e.R7$(2),e.Y8G("ngIf",0==i.filteredServices.length),e.R7$(2),e.Y8G("ngForOf",i.filteredServices))},dependencies:[p.YU,p.Sq,p.bT,d.BC,d.vS,g.Mm,P.vr,g.D9],styles:[".categories-container[_ngcontent-%COMP%]{padding:16px}.categories-title[_ngcontent-%COMP%]{font-weight:700;margin-bottom:12px}.categories-slider-container[_ngcontent-%COMP%]{width:100%;overflow-x:auto;padding-bottom:8px;scroll-behavior:smooth;-ms-overflow-style:none;scrollbar-width:none}.categories-slider-container[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.categories-slider[_ngcontent-%COMP%]{display:flex;gap:8px;padding:4px 0;width:max-content}.category-btn[_ngcontent-%COMP%]{padding:8px 16px;border-radius:20px;border:1px solid #ddd;background:#fff;white-space:nowrap;font-size:14px;cursor:pointer;transition:all .3s ease}.category-btn.active[_ngcontent-%COMP%]{background:#3f51b5;color:#fff;border-color:#3f51b5}.category-btn[_ngcontent-%COMP%]:hover{background:#f5f5f5}.category-btn[_ngcontent-%COMP%]:hover.active{background:#303f9f}"]})}}return r})();var Ot=c(53132);const Rt=r=>({"border-danger border-5":r});function Ft(r,s){if(1&r){const t=e.RV6();e.qex(0),e.j41(1,"button",18),e.bIt("click",function(){const i=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.onOfferChange(i))}),e.j41(2,"span"),e.EFF(3),e.k0s(),e.j41(4,"span",19),e.EFF(5),e.k0s()(),e.bVm()}if(2&r){const t=s.$implicit;e.R7$(),e.AVh("active",t.isSelected),e.R7$(2),e.JRh(t.title),e.R7$(2),e.JRh(t.count)}}function Vt(r,s){1&r&&(e.j41(0,"div",20),e.nrm(1,"button",21),e.k0s())}function Et(r,s){if(1&r&&(e.j41(0,"span",43)(1,"del"),e.EFF(2),e.nI1(3,"translate"),e.k0s()()),2&r){const t=e.XpG().$implicit;e.R7$(2),e.Lme(" ",t.priceOld," ",e.bMT(3,2,"orderManagement.order.currancy"),"")}}function Nt(r,s){if(1&r){const t=e.RV6();e.qex(0),e.j41(1,"div",22)(2,"div",23)(3,"div",24),e.bIt("click",function(i){const a=e.eBV(t).$implicit,o=e.XpG();return e.Njj(o.onServiceOfferChange(a.id,i))}),e.j41(4,"div",25),e.EFF(5),e.k0s(),e.j41(6,"div",26)(7,"div",27),e.nrm(8,"img",28),e.k0s(),e.j41(9,"div",27)(10,"h5",29),e.EFF(11),e.k0s()()(),e.j41(12,"div",30),e.nrm(13,"div",31),e.j41(14,"div",32),e.EFF(15),e.k0s()(),e.j41(16,"div",30),e.nrm(17,"div",33),e.j41(18,"div",32),e.EFF(19),e.k0s()(),e.j41(20,"div",34),e.nrm(21,"div",35),e.j41(22,"div",36),e.DNE(23,Et,4,4,"span",37),e.j41(24,"span"),e.EFF(25),e.nI1(26,"translate"),e.k0s()()()(),e.j41(27,"div",38)(28,"div",39),e.nrm(29,"div",40),e.j41(30,"div",41)(31,"ng-select",42),e.bIt("change",function(i){const a=e.eBV(t).$implicit,o=e.XpG();return e.Njj(o.unitChange(a,i))}),e.mxI("ngModelChange",function(i){const a=e.eBV(t).$implicit;return e.DH7(a.unitId,i)||(a.unitId=i),e.Njj(i)}),e.k0s()()()()()(),e.bVm()}if(2&r){const t=s.$implicit,n=e.XpG();e.R7$(2),e.Y8G("ngClass",e.eq3(15,Rt,t.isSelected)),e.R7$(3),e.JRh(t.quantityY),e.R7$(3),e.Y8G("src",n.serverImage+t.image,e.B4B)("alt",t.name),e.R7$(3),e.JRh(t.name),e.R7$(4),e.JRh(t.categoryName),e.R7$(4),e.JRh(t.offerName),e.R7$(4),e.Y8G("ngIf",t.price<t.priceOld),e.R7$(2),e.Lme("",t.price," ",e.bMT(26,13,"orderManagement.order.currancy"),""),e.R7$(6),e.Y8G("clearable",!1)("items",t.units),e.R50("ngModel",t.unitId)}}let Dt=(()=>{class r{constructor(t,n,i){this.translateService=t,this.offerOrder=n,this.alertService=i,this.form={},this.selectedServices=[],this.notifier=new ne.B,this.mainDelay=100,this.loaderSearchShap=u.cX,this.loaderOperationShap=u.$$,this.operationLoader=u.ZW,this.isEditForm=!1,this.showEdit=!1,this.serviceCategories=[],this.services=[],this.currentLang=this.translateService.currentLang,this.subtotal=0,this.total=0,this.serverImage=Y.c.mediaUrl,this.filteredServices=[],this.seviceCount=0,this.serviceSelected=[],this.allItems=this.getTranslationText("basicData.item.allItems"),this.isOrderEdit=!0,this.init=0,this.offerServices=[],this.responsiveOptions=[{breakpoint:"1400px",numVisible:4,numScroll:3},{breakpoint:"1220px",numVisible:4,numScroll:2},{breakpoint:"1100px",numVisible:4,numScroll:1}]}ngOnDestroy(){this.notifier.next(),this.notifier.complete()}ngOnChanges(t){t.form&&t.form.currentValue?.itemsOffers&&(this.offerServices=structuredClone(this.form.itemsOffers),this.getServicesByCategory(),this.checkSelected())}ngOnInit(){this.offerServices=structuredClone(this.form.itemsOffers),this.getCategory(),this.getServicesByCategory(),this.offerOrder.removeServiceOfferQ.pipe((0,m.Q)(this.notifier)).subscribe(t=>{if(0==this.init)return void(this.init=1);const n=this.filteredServices.find(i=>i.id==t);n&&(n.isSelected=!1),this.seviceCount=this.filteredServices.filter(i=>i.isSelected).length}),this.checkSelected()}getCategory(){let t=this.offerOrder.salesOrderForm.serviceCategoryCode;this.serviceCategories=this.serviceCategories.map(n=>({...n,isSelected:n.id===t}))}addService(t){const n=this.form.items.findIndex(i=>i.itemId===t.id&&1==i.isFree);n>-1?this.form.items.splice(n,1):this.checkOffer(t,1)?this.form.items.push({itemGroup:null,itemName:t.name,itemId:t.id,image:t.image,description:t.description,unitId:t.units[0].id,units:t.units,offerId:t.offerId,quantityY:t.quantityY,quantity:t.quantity,isFree:t.isFree,priceUnit:t.units[0].price,discount:0,discountType:1,originalPrice:t.units[0].price,price:t.units[0].price,net:t.price*t.quantity}):t.isSelected=!1}deleteService(t){this.form.orderServices.splice(t,1)}configRoute(){}getServicesByCategory(){this.services=this.setupUnit(this.offerServices),this.filteredServices=structuredClone(this.services)}setupUnit(t){return t.forEach(n=>{n.units.length>0&&(n.unitId=n.units[0].id,n.price=n.units[0].price)}),t}unitChange(t,n){if(!t.isSelected)return;let i=this.form.items.find(o=>o.itemId===t.id),a=this.filteredServices.find(o=>o.id===t.id);i.unitId=n.id,i.unitPrice=n.price,i.price=n.price,i.priceOld=n.priceOld,a.unitPrice=n.price,a.price=n.price,a.unitId=n.id}checkSelected(){this.form.items.filter(t=>t.isFree).forEach(t=>{let n=this.filteredServices.find(i=>i.id===t.itemId);n&&(n.isSelected=!0)})}getTranslationText(t){let n="";return this.translateService.get(t).pipe((0,m.Q)(this.notifier)).subscribe(i=>{n=i}),n}onTimeSelected(t){this.form.orderTeams=t}onOfferChange(t){this.form.offerNames=this.form.offerNames.map(n=>({...n,isSelected:n.id===t.id})),this.filteredServices=0==t.id?this.services:this.services?.filter(n=>n?.offerId===t?.id)??[],this.checkSelected()}onServiceOfferChange(t,n){n.stopPropagation();const i=this.filteredServices.find(a=>a.id===t);i&&(i.isSelected=!i.isSelected,this.seviceCount=this.filteredServices.filter(a=>a.isSelected).length,this.addService(i))}checkOffer(t,n){return!t.isFree||this.form.itemsOffers.length<=0||!(this.form.items.filter(a=>a.offerId==t.offerId&&1==a.isFree).reduce((a,o)=>a+o.quantity,0)+n>t.quantityY)||(this.alertService.info("\u0627\u0644\u0643\u0645\u064a\u0629 \u0627\u0644\u0645\u0633\u0645\u0648\u062d \u0628\u064a\u0647\u0627 "+t.quantityY),!1)}btnPlus(t,n){n.stopPropagation();const i=this.filteredServices.find(a=>a.code===t);i&&i.quantity++}btnMinus(t,n){n.stopPropagation();const i=this.filteredServices.find(a=>a.code===t);i&&i.quantity>1?i.quantity-=1:i.quantity=1}searchChange(t){const n=t.target.value.toLowerCase();this.filteredServices=""===n?[...this.services]:this.services.filter(i=>i.name.toLowerCase().includes(n)||i.sku.toLowerCase().includes(n))}static{this.\u0275fac=function(n){return new(n||r)(e.rXU(g.c$),e.rXU(U.A),e.rXU(E.u))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["order-offer-products"]],inputs:{form:"form",serviceCategories:"serviceCategories",isOrderEdit:"isOrderEdit"},features:[e.OA$],decls:24,vars:12,consts:[["categoriesContainer",""],[1,"service-container"],[1,"mt-2"],[1,"categories-container"],[1,"categories-title"],[1,"categories-slider-container"],[1,"categories-slider"],[4,"ngFor","ngForOf"],[1,"row","justify-content-center","align-items-center","border-bottom"],[1,"col-12","col-md-12","mx-5"],[1,"search-box","mb-3"],["type","search","id","filterValue","name","filterValue",1,"form-control","search","bg-light","rounded-pill",3,"keyup","placeholder"],[1,"ri-search-line","search-icon"],[1,"row","justify-content-between","align-items-center"],[1,"col-12","col-md-5"],[1,"mb-0","d-inline-block","position-relative"],["class","d-flex justify-content-center",4,"ngIf"],[1,"mt-3","row","row-cols-3"],[1,"category-btn",3,"click"],[1,"badge","bg-danger","ms-1"],[1,"d-flex","justify-content-center"],["type","button","translate","orderManagement.order.noProduct",1,"btn","btn-sm","my-2","btn-danger","fs-4","mb-3"],[1,"col-12","col-md-4","mb-4"],[1,"card","ribbon-box","border","ribbon-fill","shadow-none","right","mb-lg-0","material-shadow","card-service","h-100","shadow-sm","hover-shadow","transition-all",3,"ngClass"],[1,"card-body","p-3",3,"click"],[1,"ribbon","ribbon-success"],[1,"row","g-3","align-items-center","mb-3"],[1,"col-12","col-md-6"],["onerror","this.onerror=null;this.src='assets/images/custom/no-img.jpg';",1,"img-fluid","rounded",2,"height","120px","object-fit","cover",3,"src","alt"],[1,"card-title","fw-bold","text-primary","mb-0"],[1,"row","g-2","mb-2","border-top","pt-2"],["translate","sales.salesOrder.category",1,"col-5","text-muted","small"],[1,"col-7","small","fw-medium"],["translate","sales.salesOrder.offerName",1,"col-5","text-muted","small"],[1,"row","g-2","mb-2"],["translate","sales.salesOrder.price",1,"col-5","text-muted","small"],[1,"col-7","small","fw-bold"],["class","text-danger mx-3 ",4,"ngIf"],[1,"card-footer","bg-light","p-3"],[1,"row","g-2","align-items-center"],["translate","sales.salesOrder.unit",1,"col-5","text-muted","small"],[1,"col-7"],["bindValue","id","bindLabel","name",1,"form-control-sm","p-0",3,"change","ngModelChange","clearable","items","ngModel"],[1,"text-danger","mx-3"]],template:function(n,i){if(1&n){const a=e.RV6();e.j41(0,"div",1)(1,"div",2)(2,"div",3)(3,"h4",4),e.EFF(4),e.nI1(5,"translate"),e.k0s(),e.j41(6,"div",5,0)(8,"div",6),e.DNE(9,Ft,6,4,"ng-container",7),e.k0s()()()(),e.j41(10,"div",8)(11,"div",9)(12,"div",10)(13,"input",11),e.nI1(14,"translate"),e.bIt("keyup",function(l){return e.eBV(a),e.Njj(i.searchChange(l))}),e.k0s(),e.nrm(15,"i",12),e.k0s()()(),e.j41(16,"div",13)(17,"div",14)(18,"h4",15),e.EFF(19),e.nI1(20,"translate"),e.k0s()()(),e.DNE(21,Vt,2,0,"div",16),e.j41(22,"div",17),e.DNE(23,Nt,32,17,"ng-container",7),e.k0s()()}2&n&&(e.R7$(4),e.SpI(" ",e.bMT(5,6,"orderManagement.order.offers"),""),e.R7$(5),e.Y8G("ngForOf",i.form.offerNames),e.R7$(4),e.FS9("placeholder",e.bMT(14,8,"orderManagement.order.searchProduct")),e.R7$(6),e.SpI(" ",e.bMT(20,10,"orderManagement.order.selectedProducts")," "),e.R7$(2),e.Y8G("ngIf",0==i.filteredServices.length),e.R7$(2),e.Y8G("ngForOf",i.filteredServices))},dependencies:[p.YU,p.Sq,p.bT,d.BC,d.vS,g.Mm,P.vr,g.D9],styles:[".categories-container[_ngcontent-%COMP%]{padding:16px}.categories-title[_ngcontent-%COMP%]{font-weight:700;margin-bottom:12px}.categories-slider-container[_ngcontent-%COMP%]{width:100%;overflow-x:auto;padding-bottom:8px;scroll-behavior:smooth;-ms-overflow-style:none;scrollbar-width:none}.categories-slider-container[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.categories-slider[_ngcontent-%COMP%]{display:flex;gap:8px;padding:4px 0;width:max-content}.category-btn[_ngcontent-%COMP%]{padding:8px 16px;border-radius:20px;border:1px solid #ddd;background:#fff;white-space:nowrap;font-size:14px;cursor:pointer;transition:all .3s ease}.category-btn.active[_ngcontent-%COMP%]{background:var(--vz-danger);color:#fff;border-color:var(--vz-danger)}.category-btn[_ngcontent-%COMP%]:hover{background:#f5f5f5}.category-btn[_ngcontent-%COMP%]:hover.active{background:var(--vz-danger)}"]})}}return r})();const Lt=["clientModal"],Gt=()=>["salesOrder.editTotalDiscont"];function Pt(r,s){if(1&r){const t=e.RV6();e.j41(0,"app-client-info-salse",69),e.bIt("calacTotal",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.checkTotal())})("setFormByOrderCode",function(i){e.eBV(t);const a=e.XpG(2);return e.Njj(a.setFormByOrderCode(i))}),e.k0s()}if(2&r){const t=e.XpG(2);e.Y8G("isOrderEdit",t.isOrderEdit)("isInner",t.isInner)("clientInfo",t.clientInfo)("form",t.form)}}function $t(r,s){if(1&r){const t=e.RV6();e.j41(0,"order-products",70),e.bIt("CalcTotal",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.checkTotal())}),e.k0s()}if(2&r){const t=e.XpG(2);e.Y8G("isOrderEdit",t.isOrderEdit)("productsLookUp",t.productsLookUp)("form",t.form)}}function Bt(r,s){if(1&r&&(e.j41(0,"span",73),e.EFF(1),e.k0s()),2&r){const t=e.XpG(3);e.R7$(),e.JRh(t.form.offerNames.length)}}function Xt(r,s){if(1&r&&e.nrm(0,"order-offer-products",74),2&r){const t=e.XpG(3);e.Y8G("serviceCategories",null==t.productsLookUp?null:t.productsLookUp.categories)("form",t.form)}}function At(r,s){if(1&r&&(e.j41(0,"li",23)(1,"a",28),e.nrm(2,"i",71),e.j41(3,"span",26)(4,"span"),e.EFF(5),e.nI1(6,"translate"),e.k0s(),e.DNE(7,Bt,2,1,"span",72),e.k0s()(),e.DNE(8,Xt,1,2,"ng-template",27),e.k0s()),2&r){const t=e.XpG(2);e.Y8G("ngbNavItem",3),e.R7$(5),e.SpI(" ",e.bMT(6,3,"orderManagement.order.offers"),""),e.R7$(2),e.Y8G("ngIf",t.form.offerNames.length)}}function qt(r,s){if(1&r&&e.nrm(0,"client-location-salse",75),2&r){const t=e.XpG(2);e.Y8G("isOrderEdit",t.isOrderEdit)("form",t.form)}}function Yt(r,s){if(1&r){const t=e.RV6();e.j41(0,"app-finish-order-salse",76),e.bIt("editOrderActiveTab",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.editOrder())})("newOrder",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.newOrder())}),e.k0s()}if(2&r){const t=e.XpG(2);e.Y8G("statusOrder",t.statusOrder)("orderCode",t.orderCode)("form",t.form)}}function Ut(r,s){if(1&r){const t=e.RV6();e.j41(0,"button",77),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.back())}),e.nrm(1,"i",78)(2,"span",79),e.k0s()}}function zt(r,s){if(1&r){const t=e.RV6();e.j41(0,"button",80),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.next())}),e.nrm(1,"i",81)(2,"span",82),e.k0s()}}function Qt(r,s){if(1&r){const t=e.RV6();e.j41(0,"li",90),e.bIt("click",function(){e.eBV(t);const i=e.XpG(3);return e.Njj(i.orderFinished())}),e.j41(1,"span",91),e.nrm(2,"i",94)(3,"span",95),e.k0s()()}}function Ht(r,s){if(1&r){const t=e.RV6();e.j41(0,"li",90),e.bIt("click",function(){e.eBV(t);const i=e.XpG(3),a=e.sdS(6);return e.Njj(i.openModalRequest(a))}),e.j41(1,"span",91),e.nrm(2,"i",96)(3,"span",97),e.k0s()()}}function Wt(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",37)(1,"span",83)(2,"div",84)(3,"button",85),e.nrm(4,"i",86)(5,"span",87),e.k0s(),e.j41(6,"ul",88),e.DNE(7,Qt,4,0,"li",89),e.j41(8,"li",90),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.orderFinished(0))}),e.j41(9,"span",91),e.nrm(10,"i",92)(11,"span",93),e.k0s()(),e.DNE(12,Ht,4,0,"li",89),e.k0s()()()()}if(2&r){const t=e.XpG(2);e.R7$(7),e.Y8G("ngIf",+t.form.creditLimit>+t.VATTotal),e.R7$(5),e.Y8G("ngIf",+t.form.creditLimit<+t.VATTotal)}}function Jt(r,s){if(1&r){const t=e.RV6();e.qex(0),e.j41(1,"tr")(2,"td")(3,"div",99),e.nrm(4,"img",100),e.k0s()(),e.j41(5,"td")(6,"h5",101)(7,"a",102),e.bIt("click",function(){const i=e.eBV(t).$implicit,a=e.XpG(3);return e.Njj(a.goEdit(i.itemId))}),e.EFF(8),e.k0s()(),e.j41(9,"p",103)(10,"span",104),e.EFF(11),e.nI1(12,"translate"),e.k0s(),e.j41(13,"span",105),e.EFF(14),e.k0s()(),e.j41(15,"div",106)(16,"div",107)(17,"div",108)(18,"button",109),e.bIt("click",function(){const i=e.eBV(t).index,a=e.XpG(3);return e.Njj(a.decrement(i))}),e.EFF(19," \u2013 "),e.k0s(),e.j41(20,"input",110),e.bIt("keyup",function(i){const a=e.eBV(t).index,o=e.XpG(3);return e.Njj(o.quantityChange(i,a))})("change",function(i){const a=e.eBV(t).index,o=e.XpG(3);return e.Njj(o.quantityChange(i,a))}),e.mxI("ngModelChange",function(i){const a=e.eBV(t).$implicit;return e.DH7(a.quantity,i)||(a.quantity=i),e.Njj(i)}),e.k0s(),e.j41(21,"button",111),e.bIt("click",function(){const i=e.eBV(t).index,a=e.XpG(3);return e.Njj(a.increment(i))}),e.EFF(22," + "),e.k0s()()()()(),e.j41(23,"td"),e.EFF(24),e.nI1(25,"translate"),e.j41(26,"div",112)(27,"i",113),e.bIt("click",function(){const i=e.eBV(t),a=i.$implicit,o=i.index,l=e.XpG(3);return l.removeService(o,a.itemId,a.isFree),e.Njj(l.checkTotal())}),e.k0s()()()(),e.bVm()}if(2&r){const t=s.$implicit,n=e.XpG(3);e.R7$(),e.AVh("bg-danger-subtle",t.isFree),e.R7$(3),e.Y8G("src",n.serverImage+t.image,e.B4B),e.R7$(4),e.JRh(t.itemName),e.R7$(3),e.Lme(" ",t.price," ",e.bMT(12,12,"orderManagement.order.currancy"),""),e.R7$(3),e.SpI(" x",t.quantity,""),e.R7$(6),e.Mz_("id","cart-",t.code,""),e.R50("ngModel",t.quantity),e.R7$(4),e.Lme(" ",(t.price*t.quantity-t.discount).toFixed(2)," ",e.bMT(25,14,"orderManagement.order.currancy")," ")}}function Zt(r,s){if(1&r&&(e.qex(0),e.DNE(1,Jt,28,16,"ng-container",98),e.bVm()),2&r){const t=e.XpG(2);e.R7$(),e.Y8G("ngForOf",t.form.items)}}function Kt(r,s){1&r&&(e.j41(0,"tr")(1,"td",114)(2,"div",115)(3,"div",116)(4,"div",117),e.nrm(5,"i",118),e.k0s()(),e.j41(6,"h5",119),e.EFF(7),e.nI1(8,"translate"),e.k0s()()()()),2&r&&(e.R7$(7),e.SpI(" ",e.bMT(8,1,"orderManagement.order.noProducts")," "))}function ei(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",120)(1,"button",121),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.j41(4,"div",122),e.nI1(5,"translate"),e.j41(6,"input",123),e.bIt("change",function(i){e.eBV(t);const a=e.XpG(2);return e.Njj(a.checkPrecentageChange(i))}),e.k0s(),e.j41(7,"span",124),e.EFF(8,"%"),e.k0s()(),e.j41(9,"input",125,4),e.bIt("change",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.validateDiscount())}),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG(2);return e.DH7(a.form.discountAmount,i)||(a.form.discountAmount=i),e.Njj(i)}),e.k0s()()}if(2&r){const t=e.XpG(2);e.R7$(2),e.SpI(" ",e.bMT(3,5,"orderManagement.order.Discount")," "),e.R7$(2),e.FS9("pTooltip",e.bMT(5,7,"orderManagement.order.discount")),e.R7$(2),e.Y8G("checked",t.form.isPrecentage),e.R7$(3),e.Y8G("max",t.form.isPrecentage?100:t.subtotal),e.R50("ngModel",t.form.discountAmount)}}function ti(r,s){if(1&r&&(e.j41(0,"div",126),e.EFF(1),e.nI1(2,"translate"),e.nI1(3,"translate"),e.k0s()),2&r){const t=e.XpG(2);e.R7$(),e.E5c(" ",e.bMT(2,3,"orderManagement.order.discountValue"),": ",(t.subtotal*t.form.discountAmount/100).toFixed(2)," ",e.bMT(3,5,"orderManagement.order.currancy")," ")}}function ii(r,s){if(1&r&&(e.j41(0,"div",127),e.EFF(1),e.nI1(2,"translate"),e.EFF(3),e.nI1(4,"translate"),e.nI1(5,"translate"),e.k0s()),2&r){const t=e.XpG(2);e.R7$(),e.Lme(" ",e.bMT(2,5,"orderManagement.order.discountValue"),": ",t.form.discountAmount||0," "),e.R7$(2),e.E5c(" ",e.bMT(4,7,"orderManagement.order.currancy")," ",e.bMT(5,9,"orderManagement.order.discountPercentage"),": ",t.getDiscountPercentage()," ")}}function ni(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",12)(1,"div",13)(2,"div",14)(3,"div",15)(4,"div",16)(5,"div",17)(6,"label",18),e.EFF(7,"orderManagement.order.clientSearch"),e.k0s(),e.j41(8,"ng-select",19),e.bIt("scrollToEnd",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.scrollClient())}),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.clientId,i)||(a.form.clientId=i),e.Njj(i)}),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.getClientInfo(i))}),e.k0s()()(),e.nrm(9,"ngx-ui-loader",20),e.j41(10,"form",null,2)(12,"div",21)(13,"ul",22,3),e.bIt("navChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.onNavChange(i))}),e.j41(15,"li",23)(16,"a",24),e.nrm(17,"i",25),e.j41(18,"span",26),e.EFF(19),e.nI1(20,"translate"),e.k0s()(),e.DNE(21,Pt,1,4,"ng-template",27),e.k0s(),e.j41(22,"li",23)(23,"a",28),e.nrm(24,"i",29),e.j41(25,"span",26),e.EFF(26),e.nI1(27,"translate"),e.k0s()(),e.DNE(28,$t,1,3,"ng-template",27),e.k0s(),e.DNE(29,At,9,5,"li",30),e.j41(30,"li",23)(31,"a",28),e.nrm(32,"i",31),e.j41(33,"span",26),e.EFF(34),e.nI1(35,"translate"),e.k0s()(),e.DNE(36,qt,1,2,"ng-template",27),e.k0s(),e.j41(37,"li",23)(38,"a",28),e.nrm(39,"i",32),e.j41(40,"span",26),e.EFF(41),e.nI1(42,"translate"),e.k0s()(),e.DNE(43,Yt,1,3,"ng-template",27),e.k0s()(),e.j41(44,"div",33),e.nrm(45,"div",34),e.k0s()()()(),e.j41(46,"div",35)(47,"div",36)(48,"div",37),e.DNE(49,Ut,3,0,"button",38),e.k0s(),e.j41(50,"div",37),e.DNE(51,zt,3,0,"button",39),e.k0s(),e.DNE(52,Wt,13,2,"div",40),e.k0s()()()(),e.j41(53,"div",41)(54,"div",14)(55,"div",42)(56,"div",43)(57,"div",44)(58,"h5",45),e.EFF(59),e.nI1(60,"translate"),e.k0s()()()(),e.j41(61,"div",46)(62,"div",47)(63,"table",48)(64,"thead",49)(65,"tr")(66,"th",50),e.EFF(67),e.nI1(68,"translate"),e.k0s(),e.j41(69,"th",51),e.EFF(70),e.nI1(71,"translate"),e.k0s(),e.j41(72,"th",52),e.EFF(73),e.nI1(74,"translate"),e.k0s()()(),e.j41(75,"tbody"),e.DNE(76,Zt,2,1,"ng-container",11)(77,Kt,9,3,"tr",11),e.j41(78,"tr",53)(79,"td",54)(80,"div",55)(81,"div",56),e.EFF(82),e.nI1(83,"translate"),e.k0s(),e.j41(84,"div",57),e.EFF(85),e.nI1(86,"translate"),e.k0s()(),e.DNE(87,ei,11,9,"div",58),e.j41(88,"div",59),e.DNE(89,ti,4,7,"div",60)(90,ii,6,11,"div",61),e.k0s()()(),e.j41(91,"tr",53)(92,"td",54)(93,"div",62)(94,"div",63),e.EFF(95),e.nI1(96,"translate"),e.k0s(),e.j41(97,"div",64),e.EFF(98),e.nI1(99,"translate"),e.k0s()(),e.j41(100,"div",62)(101,"div",63),e.EFF(102),e.nI1(103,"translate"),e.k0s(),e.j41(104,"div",64),e.EFF(105),e.nI1(106,"translate"),e.k0s()(),e.j41(107,"div",62)(108,"div",63),e.EFF(109),e.nI1(110,"translate"),e.k0s(),e.j41(111,"div",64),e.EFF(112),e.nI1(113,"translate"),e.k0s()()()(),e.j41(114,"tr",65)(115,"td",54)(116,"div",55)(117,"div",63),e.EFF(118),e.nI1(119,"translate"),e.k0s(),e.j41(120,"div",64),e.EFF(121),e.nI1(122,"translate"),e.k0s()()()(),e.j41(123,"tr",66)(124,"td",67),e.EFF(125),e.nI1(126,"translate"),e.k0s(),e.j41(127,"td",68),e.EFF(128),e.nI1(129,"translate"),e.k0s()()()()()()()()()}if(2&r){const t=e.sdS(14),n=e.XpG();e.R7$(8),e.Y8G("virtualScroll",!0)("items",n.clients)("typeahead",n.searchClient)("loading",n.loading)("multiple",!1),e.R50("ngModel",n.form.clientId),e.Y8G("disabled",!n.isOrderEdit),e.R7$(),e.Y8G("loaderId","order"),e.R7$(4),e.Y8G("activeId",n.active),e.R7$(2),e.Y8G("ngbNavItem",1),e.R7$(4),e.SpI(" ",e.bMT(20,49,"orderManagement.order.clientInfo")," "),e.R7$(3),e.Y8G("ngbNavItem",2),e.R7$(4),e.SpI(" ",e.bMT(27,51,"orderManagement.order.items")," "),e.R7$(3),e.Y8G("ngIf",(null==n.form||null==n.form.itemsOffers?null:n.form.itemsOffers.length)>0),e.R7$(),e.Y8G("ngbNavItem",4),e.R7$(4),e.SpI(" ",e.bMT(35,53,"orderManagement.order.shipping")," "),e.R7$(3),e.Y8G("ngbNavItem",5),e.R7$(4),e.SpI(" ",e.bMT(42,55,"orderManagement.order.finish")," "),e.R7$(4),e.Y8G("ngbNavOutlet",t),e.R7$(4),e.Y8G("ngIf",n.active>1),e.R7$(2),e.Y8G("ngIf",n.active<n.maxNav),e.R7$(),e.Y8G("ngIf",!n.disabledStatus&&n.form.clientId>0),e.R7$(7),e.SpI(" ",e.bMT(60,57,"orderManagement.order.orderSummary")," "),e.R7$(8),e.SpI(" ",e.bMT(68,59,"sales.salesOrder.product")," "),e.R7$(3),e.SpI(" ",e.bMT(71,61,"sales.salesOrder.productInfo")," "),e.R7$(3),e.SpI(" ",e.bMT(74,63,"sales.salesOrder.price")," "),e.R7$(3),e.Y8G("ngIf",n.form.items.length>0),e.R7$(),e.Y8G("ngIf",0==n.form.items.length),e.R7$(5),e.SpI(" ",e.bMT(83,65,"orderManagement.order.SubTotal")," "),e.R7$(3),e.Lme(" ",n.subtotal," ",e.bMT(86,67,"orderManagement.order.currancy")," "),e.R7$(2),e.Y8G("hasPermission",e.lJ4(89,Gt)),e.R7$(2),e.Y8G("ngIf",n.form.isPrecentage),e.R7$(),e.Y8G("ngIf",!n.form.isPrecentage),e.R7$(5),e.SpI(" ",e.bMT(96,69,"orderManagement.order.PriceAfterDisaccount")," "),e.R7$(3),e.Lme(" ",n.beforeVatTotal.toFixed(2)," ",e.bMT(99,71,"orderManagement.order.currancy")," "),e.R7$(4),e.SpI(" ",e.bMT(103,73,"orderManagement.order.PriceBeforeVat")," "),e.R7$(3),e.Lme(" ",n.beforeVatTotal.toFixed(2)," ",e.bMT(106,75,"orderManagement.order.currancy")," "),e.R7$(4),e.SpI(" ",e.bMT(110,77,"orderManagement.order.tax")," (15%) "),e.R7$(3),e.Lme(" ",(n.VATTotal-n.beforeVatTotal).toFixed(2)," ",e.bMT(113,79,"orderManagement.order.currancy")," "),e.R7$(6),e.SpI(" ",e.bMT(119,81,"orderManagement.order.VAT")," "),e.R7$(3),e.Lme(" ",n.VATTotal.toFixed(2)," ",e.bMT(122,83,"orderManagement.order.currancy")," "),e.R7$(4),e.SpI(" ",e.bMT(126,85,"orderManagement.order.creditLimit"),": "),e.R7$(3),e.Lme(" ",n.form.creditLimit," ",e.bMT(129,87,"orderManagement.order.currancy")," ")}}function ri(r,s){if(1&r){const t=e.RV6();e.j41(0,"div")(1,"requestNewCustomer",128),e.bIt("OnStepChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.onStepChange(i))}),e.k0s()()}if(2&r){const t=e.XpG();e.R7$(),e.Y8G("showBreadcrumbs",!1)("form",t.customer)("isEdit",!0)("errors",t.errors)}}function ai(r,s){1&r&&(e.j41(0,"div",145),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function si(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",129)(1,"div",130)(2,"h4",45),e.nrm(3,"span",97),e.k0s(),e.j41(4,"button",131),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss("Cross click"))}),e.k0s()(),e.j41(5,"div",132),e.nrm(6,"ngx-ui-loader",133),e.j41(7,"form",134,2),e.bIt("submit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.OnRequestSubmit())}),e.j41(9,"div",135)(10,"label",136),e.EFF(11,"sales.clientCollection.cost"),e.k0s(),e.j41(12,"input",137,5),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.formRequest.cost,i)||(a.formRequest.cost=i),e.Njj(i)}),e.k0s(),e.DNE(14,ai,2,0,"div",138),e.k0s(),e.j41(15,"div",135)(16,"label",139),e.EFF(17,"sales.clientCollection.notes"),e.k0s(),e.j41(18,"textarea",140,6),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.formRequest.notes,i)||(a.formRequest.notes=i),e.Njj(i)}),e.k0s()(),e.j41(20,"div",141)(21,"button",142),e.nrm(22,"i",143)(23,"span",144),e.k0s()()()()()}if(2&r){const t=e.sdS(8),n=e.sdS(13),i=e.XpG();e.R7$(6),e.Y8G("hasProgressBar",!1)("fgsType",i.loaderOperationShap)("loaderId",i.operationLoader),e.R7$(6),e.R50("ngModel",i.formRequest.cost),e.R7$(2),e.Y8G("ngIf",n.invalid&&n.touched),e.R7$(4),e.R50("ngModel",i.formRequest.notes),e.R7$(3),e.Y8G("disabled",!t.valid)}}function oi(r,s){if(1&r&&(e.j41(0,"span"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&r){const t=s.$implicit;e.R7$(),e.SpI(" ",e.bMT(2,1,"approvals.customerRequest."+t)," , ")}}function li(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",146)(1,"div",147)(2,"button",148),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()(),e.j41(3,"div",132)(4,"div",149),e.nrm(5,"lord-icon",150)(6,"div",151),e.j41(7,"div",152),e.nrm(8,"i",153),e.DNE(9,oi,3,3,"span",98),e.k0s()(),e.j41(10,"div",154)(11,"button",155),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.goUpdate())}),e.k0s(),e.j41(12,"button",156),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()()()()}if(2&r){const t=e.XpG();e.R7$(9),e.Y8G("ngForOf",t.errors)}}let di=(()=>{class r{constructor(t,n,i,a,o,l,h,x,y,I,j,T){this.translateService=t,this.baseService=n,this.requestPersonSalesService=i,this.alertService=a,this.ngxLoader=o,this.datePipe=l,this.modalService=h,this.router=x,this.clientService=y,this.serviceService=I,this.productOfferService=j,this.generalSettingService=T,this.editOrders="orderManagement.order.editOrders",this.addOrders="orderManagement.order.addOrders",this.titleOperation="orderManagement.order.titleOperation",this.keySelected="",this.active=1,this.language=this.translateService.currentLang,this.searchForm="",this.breadCrumbItems=[],this.serverImage=Y.c.mediaUrl,this.disabledStatus=!0,this.form={itemsOffers:[],clientVisitDate:new Date,id:null,cityCode:0,clientLocationId:0,clientId:0,isUrgent:!1,notes:"",items:[],discountAmount:0,discountAmountAdd:0,total:0,agent:{},orderPayments:[],orderLocations:{},discountType:1,discountTypeAdd:1,isPrecentage:!0,isPrecentageAdd:!1,totalAddDiscountType:0,totalAddDiscount:0,creditLimit:0,terms:"",serviceCategoryCode:0},this.orderCode=0,this.mobile=0,this.cityCode=0,this.agentName="",this.pendingCode=0,this.isInner=!1,this.isOrderEdit=!0,this.idForm=0,this.totalPaid=0,this.priceModel=0,this.priceModelIndex=0,this.subtotal=0,this.paidTotal=0,this.VATTotal=0,this.beforeVatTotal=0,this.total=0,this.isResolveList=!0,this.extraDiscountCalc=!1,this.employeeGroups=[],this.notifier=new ne.B,this.mainDelay=100,this.loaderSearchShap=u.cX,this.loaderOperationShap=u.$$,this.operationLoader=u.ZW,this.isEditForm=!1,this.showEdit=!1,this.orderTypes=[],this.serviceCategories=[],this.services=[],this.paymentTypes=[],this.isFinished=!1,this.isUpdate=!1,this.isReopen=!1,this.formRequest={},this.statusOrder=10,this.clients=[],this.searchClient=new ne.B,this.clientParam={pageSize:50,pageNumber:1,search:""},this.loading=!1,this.productsLookUp=[],this.productsOffer=[],this.step=1,this.customer={},this.errors={},this.isCustomerDataValid=!1,this.loaderStart=!1,this.productOffer=[],this.setting={salesOrderApproval:!0},this.maxNav=3,this.form=this.baseService.salesOrderForm}OpenChangInput(t,n){this.showEdit=!0,this.priceModel=n.price,this.priceModelIndex=t}ChangInput(){this.form.orderServices[`${this.priceModelIndex}`].price=this.priceModel,this.showEdit=!1}ngOnDestroy(){this.notifier.next(),this.notifier.complete()}ngOnInit(){localStorage.getItem("isReopen")&&(this.isReopen=!0),this.resetForm(),this.breadCrumbItems=[{label:"layout.sidebar.orders"},{label:"orderManagement.order.title",active:!0,url:"order/list"},{label:this.isEditForm?"general.action.edit":"general.action.register",active:!0}],this.checkTotal(),this.baseService.checkValidation.subscribe(n=>{this.checkdisableForm()}),this.form.clientId&&(this.getClientSearchDropdwon(this.form.clientId),this.getClientInfo(this.form.clientId)),this.searchClient.pipe((0,ve.B)(300),(0,Se.F)(),(0,ae.n)(n=>this.loadClient(n))).subscribe(),this.getProductOffer(),this.GetSetting()}GetSetting(){this.generalSettingService.get().subscribe(t=>{this.setting=t.data},t=>{console.log(t)})}GetServiceList(t,n){this.serviceService.GetServiceList(t,n).subscribe(i=>{i.data.categories.unshift({id:0,name:this.getTranslationText("general.table.all"),isSelected:!0}),this.productsLookUp=i.data,this.productsOffer=i.data})}getTranslationText(t){let n="";return this.translateService.get(t).pipe((0,m.Q)(this.notifier)).subscribe(i=>{n=i}),n}checkTotal(){this.subtotal=this.form.items.filter(n=>!n.isFree).reduce((n,i)=>n+((i.price||0)*(i.quantity||0)-(i.discount||0)),0),this.form.discountAmount<0&&(this.form.discountAmount=0),this.form.discountAmountAdd<0&&(this.form.discountAmountAdd=0);let t=0;if(this.form.isPrecentage?(this.form.discountAmount=this.form.discountAmount>100?100:this.form.discountAmount,t=this.subtotal-this.subtotal*(+this.form.discountAmount||0)*.01):t=this.subtotal-(+this.form.discountAmount||0),this.form.isPrecentageAdd?(this.form.discountAmountAdd=this.form.discountAmountAdd>100?100:this.form.discountAmountAdd,t-=this.subtotal*(+this.form.discountAmount||0)*.01):t-=+this.form.discountAmountAdd||0,this.beforeVatTotal=t,this.VATTotal=0==t?0:t+.15*t,this.form.total=this.total=this.VATTotal,this.productOffer.length>0&&this.form.items.length>0){let n=this.productOfferService.checkItemOffer(this.form,this.productOffer);this.form={...n}}this.maxNav=this.form.itemsOffers&&this.form.itemsOffers.length>0?4:3}setFormByOrderCode(t){this.form=t,this.checkTotal(),this.form.isFree&&(this.form.isPrecentage=!0,this.form.discountAmount=100)}onTimeSelected(t){this.form.visitDate=t.dataVisit,this.form.orderTeams=t.selectedTimes}onNavChange(t){this.baseService.salesOrderForm.isCustomerDataValid?2===t.nextId||t.nextId===this.maxNav?this.baseService.salesOrderForm.clientId?this.active=t.nextId:(this.alertService.error("orderManagement.order.mustSelectClient"),t.preventDefault()):t.nextId===this.maxNav+1?this.isFinished?this.active=t.nextId:t.preventDefault():this.active=t.nextId:(this.alertService.error("orderManagement.order.mustSelectClient"),t.preventDefault())}changeTab(){}finishedOrder(t){this.isFinished=!0,this.orderCode=t,this.active=4,this.resetForm()}finishedUpdateOrder(t){this.isFinished=!0,this.orderCode=t,this.active=6}newOrder(){this.resetForm(),this.active=1,this.total=0,this.subtotal=0,this.isFinished=!1}editOrder(){this.active=1}resetForm(){this.form=this.baseService.salesOrderForm={clientVisitDate:new Date,id:null,clientLocationId:0,clientId:0,notes:"",items:[],discountAmount:0,discountAmountAdd:0,total:0,agent:{},orderLocations:{},discountType:1,discountTypeAdd:1,isPrecentage:!0,isPrecentageAdd:!1,totalAddDiscountType:0,totalAddDiscount:0,creditLimit:0,terms:"",serviceCategoryCode:0,isCustomerDataValid:!1},this.clientInfo={}}removeService(t,n,i=!0){this.form.items.splice(t,1),i?this.baseService.removeServiceOfferQ.next(n):this.baseService.removeServiceQ.next(n)}updatePrice(t,n){this.form.items[n].price=t.price*t.quantity}itemIsFreeChange(t,n){let i=this.form.items[n];i.price=0==t.target.checked?i.originalPrice:0,this.checkTotal()}decrement(t){let n=this.form.items[t];n.quantity<=1||(n&&(n.quantity=n.quantity-1),this.checkTotal())}increment(t){let n=this.form.items[t];n&&this.checkOffer(n,1)&&(n.quantity=n.quantity+1),this.checkTotal()}checkOffer(t,n){return!t.isFree||this.form.itemsOffers.length<=0||!(this.form.items.filter(a=>a.offerId==t.offerId&&1==a.isFree).reduce((a,o)=>a+o.quantity,0)+n>t.quantityY)||(this.alertService.info("\u0627\u0644\u0643\u0645\u064a\u0629 \u0627\u0644\u0645\u0633\u0645\u0648\u062d \u0628\u064a\u0647\u0627 "+t.quantityY),!1)}quantityChange(t,n){let i=parseInt(t.target.value),a=this.form.items[n];if(i<=0||isNaN(i))return a.quantity=1,void this.checkTotal();a.quantity=this.checkOffer(a,i)?i:a.quantity,this.checkTotal()}checkPrecentageChange(t){this.form.isPrecentage=t.target.checked,this.checkTotal()}checkPrecentageAddChange(t){this.form.isPrecentageAdd=t.target.checked,this.checkTotal()}onIsFreeChange(t){t?(this.form.isPrecentage=!0,this.form.discountAmount=100):(this.form.isPrecentage=!1,this.form.discountAmount=0),this.checkTotal()}orderFinished(t=20){if(this.loaderStart)return;this.loaderStart=!0;let n={id:0,clientId:this.form.clientId,clientVisitDate:this.datePipe.transform(this.form.clientVisitDate,"yyyy-MM-ddTHH:mm:ss.000"),offerOrderStatus:t,notes:this.form.notes,terms:this.form.terms,clientLocationId:this.form.clientLocationId,totalAddDiscount:this.form.discountAmount,totalAddDiscountType:this.form.isPrecentage?2:1,offerOrderDetails:this.form.items.map(i=>({discount:i.discount,discountType:i.discountType,itemId:i.itemId,clientQuantity:i.quantity,id:0,price:i.price,unitId:i.unitId,isFree:i.isFree,originalPrice:i.originalPrice}))};this.ngxLoader.startLoader("order"),this.setting.salesOrderApproval?this.registerForApproval(n,t):this.registerForDirectSales(n,t)}registerForApproval(t,n){t.salesRequestDetails=t.offerOrderDetails,t.salesRequestStatus=t.offerOrderStatus,delete t.offerOrderDetails,delete t.offerOrderStatus,this.baseService.registerRequestSales(t).subscribe(i=>{i.success?(this.ngxLoader.stopLoader("order"),this.statusOrder=n,this.orderCode=i.data.id,this.finishedOrder(i.data.id),this.subtotal=0,this.beforeVatTotal=0,this.VATTotal=0,this.alertService.success(),this.checkdisableForm()):(this.alertService.error(),this.loaderStart=!1,this.ngxLoader.stopLoader("order"))},()=>{this.loaderStart=!1,this.alertService.error(),this.ngxLoader.stopLoader("order")})}registerForDirectSales(t,n){this.baseService.register(t).subscribe(i=>{i.success?(this.ngxLoader.stopLoader("order"),this.statusOrder=n,this.orderCode=i.data.id,this.finishedOrder(i.data.id),this.subtotal=0,this.beforeVatTotal=0,this.VATTotal=0,this.alertService.success(),this.checkdisableForm()):(this.alertService.error(),this.loaderStart=!1,this.ngxLoader.stopLoader("order"))},()=>{this.loaderStart=!1,this.alertService.error(),this.ngxLoader.stopLoader("order")})}checkdisableForm(){this.form.clientLocationId=this.baseService.salesOrderForm.clientLocationId;let t=!1;null==this.form.clientId||0==this.form.clientId||null==this.form.clientId||null==this.form.clientLocationId||0==this.form.clientLocationId||null==this.form.clientLocationId||this.form.items.length<=0?t=!0:this.form.items.length>0?(this.form.items.forEach(n=>{0!=n.itemId||(t=!0)}),t=!!t):t=!1,this.disabledStatus=t}openModalRequest(t,n="md"){this.formRequest={id:0,clientId:this.form.clientId},this.modalService.open(t,{centered:!0,size:n})}OnRequestSubmit(){this.ngxLoader.start(this.operationLoader),this.requestPersonSalesService.register(this.formRequest).pipe((0,v.O)(),(0,R.c)(this.mainDelay),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader(this.operationLoader)),(0,pe.W)(t=>(0,ue.$)(t))).subscribe(t=>{t.success?(this.alertService.success(),this.modalService.dismissAll()):this.alertService.error(t.message)},t=>{this.alertService.error("general.message."+t)})}next(){let t=this.active+1;this.baseService.salesOrderForm.isCustomerDataValid&&(2!==t&&t!==this.maxNav||this.baseService.salesOrderForm.clientId)?t===this.maxNav+1&&!this.isFinished||(this.form.itemsOffers.length>0?this.active=Math.min(t,this.maxNav):(t=2==this.active?4:this.active,this.active=Math.min(t,this.maxNav+1))):this.alertService.error("orderManagement.order.mustSelectClient")}back(){let t=this.active-1;this.form.itemsOffers.length<=0&&4==this.active&&(t-=1,this.active=t<=0?1:t),this.active=t<=0?1:t}goEdit(t){this.router.navigateByUrl("/basicData/products/edit",{state:{id:t}})}getClientSearchDropdwon(t){this.clientParam.search=t,this.clientParam.pageNumber=1,this.clientService.GetClientSearch(this.clientParam).subscribe(n=>{this.clients=n.data})}scrollClient(){this.clientParam.pageNumber=this.clientParam.pageNumber+1,this.clientService.GetClientSearch(this.clientParam).subscribe(t=>{this.clients=[...this.clients,...t.data]})}getClientInfo(t){null!=t&&(this.baseService.salesOrderForm.clientId=t,this.baseService.salesOrderForm.clientVisitDate=this.form.clientVisitDate,this.clientService.GetClientInfo(t).subscribe(n=>{if(n.data.isValid){this.baseService.salesOrderForm.isCustomerDataValid=!0;let i=n.data.client;this.form.creditLimit=i.creditLimit,this.baseService.salesOrderForm.terms=i.terms,this.baseService.salesOrderForm.clientGroupId=i.clientGroupId,this.baseService.checkValidationSource.next(!0),this.clientInfo=i,this.form.isPrecentage=2==i.discountType,this.form.discountAmount=i.discount,this.GetServiceList(this.baseService.salesOrderForm.clientGroupId,i.priceListId),this.getClientLocations(t)}else{this.baseService.salesOrderForm.isCustomerDataValid=!1;let i=n.data.client;i.postalCode=+i.postalCode,i.subNumber=+i.subNumber,i.buildingNumber=+i.buildingNumber,this.customer=i,this.errors=n.data.errors,this.modalService.open(this.clientModal,{centered:!0,size:"md"})}}))}getClientDropdwon(t){return this.clientParam.search=t,this.clientParam.pageNumber=1,this.clientService.GetClientSearch(this.clientParam).pipe((0,ae.n)(n=>(this.clients=n.data,this.loading=!1,[])))}loadClient(t){return this.loading=!0,""==t||null==t?(this.loading=!1,(0,ge.of)([])):this.getClientDropdwon(t)}getClientLocations(t){this.clientService.GetClientLocations(t).subscribe(n=>{this.form.locations=n.data,this.baseService.salesOrderForm.locations=n.data})}onStepChange(t=1){this.resetForm(),this.step=t}goUpdate(){this.modalService.dismissAll(),this.step=2}validateDiscount(){!this.form.isPrecentage&&this.form.discountAmount>this.subtotal&&(this.form.discountAmount=this.subtotal),this.checkTotal()}getDiscountPercentage(){return this.form.discountAmount&&0!==this.subtotal?((this.form.discountAmount||0)/this.subtotal*100).toFixed(2)+"%":"0%"}getProductOffer(){this.productOfferService.GetActiveOffer().subscribe(t=>{this.productOffer=t.data})}static{this.\u0275fac=function(n){return new(n||r)(e.rXU(g.c$),e.rXU(U.A),e.rXU(Ve.u),e.rXU(E.u),e.rXU(w.eD),e.rXU(p.vh),e.rXU(_.Bq),e.rXU(M.Ix),e.rXU(oe.X),e.rXU(Pe.N),e.rXU(nt.L),e.rXU(rt.k))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["sales-operation"]],viewQuery:function(n,i){if(1&n&&e.GBs(Lt,5),2&n){let a;e.mGM(a=e.lsd())&&(i.clientModal=a.first)}},inputs:{form:"form",orderCode:"orderCode",mobile:"mobile",cityCode:"cityCode",agentName:"agentName",pendingCode:"pendingCode",isInner:"isInner",isOrderEdit:"isOrderEdit",isReopen:"isReopen",clients:"clients"},decls:9,vars:6,consts:[["RequestModal",""],["clientModal",""],["formEntity","ngForm"],["customNav","ngbNav"],["discountAmount","ngModel"],["cost","ngModel"],["notes","ngModel"],[1,"step-wizard"],["translate","sales.salesOrder.salesOrderNew",1,"step",3,"click"],["translate","sales.salesOrder.completeCustomerData",1,"step"],["class","row",4,"ngIf"],[4,"ngIf"],[1,"row"],[1,"col-xl-8"],[1,"card"],[1,"card-body","checkout-tab"],[1,"row","my-2"],[1,"col-12"],["for","mobile","translate","",1,"form-label","text-secondary"],["bindLabel","displayName","id","mobile","bindValue","id","required","",3,"scrollToEnd","ngModelChange","virtualScroll","items","typeahead","loading","multiple","ngModel","disabled"],["fgsColor","rgba(255,255,255,0)",3,"loaderId"],[1,"step-arrow-nav"],["ngbNav","","role","tablist",1,"nav","nav-pills","nav-justified","custom-nav",3,"navChange","activeId"],[3,"ngbNavItem"],["ngbNavLink","","id","pills-bill-info-tab","data-bs-toggle","pill","data-bs-target","#pills-bill-info","role","tab","aria-controls","pills-bill-info","aria-selected","true","data-position","0",1,"nav-link","fs-16","p-2"],[1,"ri-user-3-fill","fs-16","p-2","bg-primary-subtle","text-primary","rounded-circle","align-middle","mx-2"],[1,"d-inline","mt-2"],["ngbNavContent",""],["ngbNavLink","","data-bs-toggle","tab","role","tab",1,"nav-link","fs-15","p-2"],[1,"ri-shopping-cart-fill","fs-16","p-2","bg-primary-subtle","text-primary","rounded-circle","align-middle","mx-2"],[3,"ngbNavItem",4,"ngIf"],[1,"ri-truck-line","fs-16","p-2","bg-primary-subtle","text-primary","rounded-circle","align-middle","me-2"],[1,"ri-checkbox-circle-line","fs-16","p-2","bg-primary-subtle","text-primary","rounded-circle","align-middle","me-2"],[1,"tab-content"],[3,"ngbNavOutlet"],[1,"card-footer","text-center",2,"padding","0.5rem","position","relative"],[1,"row","justify-content-center"],[1,"col-12","col-md-3"],["type","button","class","btn btn-primary btn-label waves-effect waves-light rounded-pill mx-1",3,"click",4,"ngIf"],["type","button","class","btn btn-primary btn-label waves-effect right waves-light rounded-pill",3,"click",4,"ngIf"],["class","col-12 col-md-3",4,"ngIf"],[1,"col-xl-4"],[1,"card-header"],[1,"d-flex"],[1,"flex-grow-1"],[1,"card-title","mb-0"],[1,"card-body"],[1,"table-responsive","table-card"],[1,"table","table-borderless","align-middle","mb-0"],[1,"table-light","text-muted"],["scope","col",2,"width","90px"],["scope","col"],["scope","col",1,"text-end"],["lass","py-0",2,"border-top","hsl(226, 36%, 80%) solid 1px !important"],["colspan","3"],[1,"d-flex","justify-content-between","align-items-center","mb-2"],[1,"w-75","fw-semibold"],[1,"w-25","fw-semibold","text-end"],["class","col-6 input-group",4,"hasPermission"],[1,"mt-2","text-left"],["class","text-danger small",4,"ngIf"],["class","small text-danger",4,"ngIf"],[1,"d-flex","justify-content-between","align-items-center"],[1,"fw-semibold"],[1,"fw-semibold","text-end"],[1,"table-active","py-0"],[1,"py-0",2,"border-top","hsl(226, 36%, 80%) solid 1px !important"],["colspan","2",1,"fw-semibold"],[1,"fw-semibold","text-end","text-danger"],[3,"calacTotal","setFormByOrderCode","isOrderEdit","isInner","clientInfo","form"],[3,"CalcTotal","isOrderEdit","productsLookUp","form"],[1,"ri-alarm-warning-line","fs-16","p-2","bg-danger-subtle","text-danger","rounded-circle","align-middle","mx-2"],["class","badge bg-danger ms-1",4,"ngIf"],[1,"badge","bg-danger","ms-1"],[3,"serviceCategories","form"],[3,"isOrderEdit","form"],[3,"editOrderActiveTab","newOrder","statusOrder","orderCode","form"],["type","button",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill","mx-1",3,"click"],[1,"ri-arrow-left-circle-fill","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.back"],["type","button",1,"btn","btn-primary","btn-label","waves-effect","right","waves-light","rounded-pill",3,"click"],[1,"ri-arrow-right-circle-fill","label-icon","align-middle","rounded-pill","fs-16","ms-2"],["translate","general.action.next"],[1,"d-inline-block"],[1,"dropdown-custom","d-inline-block"],["type","button",1,"btn","dropbtn","btn-primary","btn-label","waves-effect","right","waves-light","rounded-pill"],[1,"ri-more-2-fill","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.actions"],[1,"dropdown-menu","dropdown-menu-end","dropdown-content",2,"left","0"],[3,"click",4,"ngIf"],[3,"click"],[1,"dropdown-item"],[1,"text-warning","ri-add-box-fill","align-bottom","me-2"],["translate","orderManagement.order.orderSavedAsDraft"],[1,"text-success","ri-add-box-fill","align-bottom","me-2"],["translate","orderManagement.order.orderSaved"],[1,"text-info","ri-add-box-fill","align-bottom","me-2"],["translate","sales.salesOrder.addRequestLimit"],[4,"ngFor","ngForOf"],[1,"avatar-container","bg-light","rounded","p-1"],["alt","",1,"img-fluid","d-block",3,"src"],[1,"fs-14"],["href","javascript: void(0);",1,"text-body",3,"click"],[1,"text-muted","mb-0"],[1,"text-muted","me-0"],[1,"text-muted","me-2"],[1,"row","align-items-center"],[1,"col-12","col-md-6","text-mute","text-center"],[1,"input-step","mt-2"],["type","button",1,"minus","btn-success",3,"click"],["type","number","min","1","max","100",1,"product-quantity",3,"keyup","change","ngModelChange","id","ngModel"],["type","button",1,"plus","btn-success",3,"click"],[1,"col-12","col-md-4","text-mute","text-right"],[1,"ri-close-fill","text-danger","cursor-pointer",3,"click"],["colspan","3",1,"text-center","text-danger"],["id","empty-cart",1,"text-center","empty-cart",2,"display","block"],[1,"avatar-md","mx-auto","my-3"],[1,"avatar-title","bg-info-subtle","text-info","fs-36","rounded-circle"],[1,"bx","bx-cart","bx-tada"],[1,"mb-3","text-danger"],[1,"col-6","input-group"],["type","button",1,"btn","btn-danger"],["tooltipPosition","top",1,"input-group-text","d-inline",3,"pTooltip"],["type","checkbox","aria-label","Checkbox for following text input",1,"form-check-input",3,"change","checked"],[1,"p-1"],["min","0","InputTirmFilter","","name","discountAmount","type","number","id","discountAmount","required","",1,"form-control","text-right",3,"change","ngModelChange","max","ngModel"],[1,"text-danger","small"],[1,"small","text-danger"],[3,"OnStepChange","showBreadcrumbs","form","isEdit","errors"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"hasProgressBar","fgsType","loaderId"],[3,"submit"],[1,"mb-2"],["for","cost","translate","",1,"fw-bold","form-label"],["InputTirmFilter","","name","cost","type","number","id","cost",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["class","text-danger text-center","translate","",4,"ngIf"],["for","notes","translate","",1,"fw-bold","form-label"],["rows","2","InputTirmFilter","","name","notes","type","text","id","notes",1,"form-control","fs-6",3,"ngModelChange","ngModel"],[1,"text-center"],["type","submit","type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],["translate","",1,"text-danger","text-center"],[1,"modal-content"],[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"mt-2","text-center"],["src","https://cdn.lordicon.com/gdfrsvpt.json","stroke","bold","state","hover-oscillate","trigger","loop","colors","primary:#f7b84b,secondary:#f06548",2,"width","130px","height","130px"],["translate","approvals.customerRequest.requiedFields",1,"fs-5"],["role","alert",1,"alert","alert-danger","alert-dismissible","material-shadow","alert-label-icon","rounded-label","fade","show"],[1,"ri-error-warning-line","label-icon"],[1,"d-flex","gap-2","justify-content-center","mt-4","mb-2"],["type","button","id","save","translate","general.action.update",1,"btn","w-sm","btn-success","fs-4",3,"click"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light","fs-4",3,"click"]],template:function(n,i){if(1&n){const a=e.RV6();e.j41(0,"div",7)(1,"div",8),e.bIt("click",function(){return e.eBV(a),e.Njj(i.step=1)}),e.k0s(),e.nrm(2,"div",9),e.k0s(),e.DNE(3,ni,130,90,"div",10)(4,ri,2,4,"div",11)(5,si,24,7,"ng-template",null,0,e.C5r)(7,li,13,1,"ng-template",null,1,e.C5r)}2&n&&(e.R7$(),e.AVh("active",1==i.step),e.R7$(),e.AVh("active",2==i.step),e.R7$(),e.Y8G("ngIf",1==i.step),e.R7$(),e.Y8G("ngIf",2==i.step))},dependencies:[p.Sq,p.bT,_.Um,_.X9,_.sy,_.Gx,_.Ri,_.WA,_.m_,d.qT,d.me,d.Q0,d.BC,d.cb,d.YS,d.VZ,d.zX,d.vS,d.cV,g.Mm,B.m,A.p,P.vr,w.Cv,de.m,ot,vt,Ct,Mt,Ot.z,Dt,g.D9],styles:[".avatar-container[_ngcontent-%COMP%]{width:60px;height:60px;background-color:#f8f9fa;display:flex;align-items:center;justify-content:center}@media (max-width: 768px){.avatar-container[_ngcontent-%COMP%]{width:40px;height:40px}}"]})}}return r})(),ci=(()=>{class r{constructor(){this.breadCrumbItems=[],this.addOrders="orderManagement.order.addOrders"}ngOnInit(){}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["order-register"]],decls:1,vars:0,template:function(n,i){1&n&&e.nrm(0,"sales-operation")},dependencies:[di],encapsulation:2})}}return r})();var Q=c(56701),_e=c(26364),X=c(75622),Ce=c(67569),xe=c(21626);let mi=(()=>{class r extends Ce.d{constructor(t){super(t,Y.c.apiUrl+"ShippingTruck/")}static{this.\u0275fac=function(n){return new(n||r)(e.KVO(xe.Qq))}}static{this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var H=c(91426),K=c(53928),W=c(40724),J=c(88148),Z=c(91580),q=c(5779);const pi=()=>["salesSetting.register"],ui=()=>["salesSetting.edit"],gi=()=>["salesSetting.delete"];function _i(r,s){1&r&&(e.j41(0,"tr",25)(1,"th",26),e.EFF(2,"#"),e.k0s(),e.j41(3,"th",27),e.nrm(4,"i",28),e.EFF(5," sales.shippingTruck.name "),e.k0s(),e.j41(6,"th",29),e.nrm(7,"i",28),e.EFF(8," sales.shippingTruck.truckNumber "),e.k0s(),e.j41(9,"th",30),e.nrm(10,"i",28),e.EFF(11," sales.shippingTruck.truckDriverName "),e.k0s(),e.j41(12,"th",31),e.EFF(13," sales.shippingTruck.cityName "),e.k0s(),e.j41(14,"th",32),e.nrm(15,"i",28),e.EFF(16," general.table.isActive "),e.k0s(),e.nrm(17,"th",31),e.k0s())}function hi(r,s){if(1&r&&(e.qex(0),e.j41(1,"span",40),e.EFF(2),e.k0s(),e.bVm()),2&r){const t=s.$implicit;e.R7$(2),e.JRh(t.cityName)}}function fi(r,s){1&r&&e.nrm(0,"span",41)}function bi(r,s){1&r&&e.nrm(0,"span",42)}function vi(r,s){if(1&r&&(e.nrm(0,"i",43),e.EFF(1),e.nI1(2,"date"),e.nrm(3,"br")(4,"i",44),e.EFF(5),e.nI1(6,"date"),e.nrm(7,"br")(8,"i",45),e.EFF(9)),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",e.i5U(2,3,t.createdDate,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",e.i5U(6,6,t.updatedDate,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",t.creatorName," ")}}function Si(r,s){if(1&r){const t=e.RV6();e.j41(0,"button",46),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,a=e.XpG(),o=e.sdS(20);return e.Njj(a.EditModel(i.id,o))}),e.nrm(1,"i",47),e.k0s()}}function Ci(r,s){if(1&r){const t=e.RV6();e.j41(0,"button",48),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,a=e.XpG(),o=e.sdS(22);return e.Njj(a.openModal(i.id,o))}),e.nrm(1,"i",49),e.k0s()}}function xi(r,s){if(1&r&&(e.j41(0,"tr",33)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td"),e.DNE(10,hi,3,1,"ng-container",34),e.k0s(),e.j41(11,"td"),e.DNE(12,fi,1,0,"span",35)(13,bi,1,0,"span",36),e.k0s(),e.j41(14,"td"),e.DNE(15,vi,10,9,"ng-template",null,3,e.C5r),e.nrm(17,"i",37),e.DNE(18,Si,2,0,"button",38)(19,Ci,2,0,"button",39),e.k0s()()),2&r){const t=s.$implicit,n=s.rowIndex,i=e.sdS(16);e.R7$(2),e.JRh(n+1),e.R7$(2),e.JRh(t.name),e.R7$(2),e.JRh(t.truckNumber),e.R7$(2),e.JRh(t.truckDriverName),e.R7$(2),e.Y8G("ngForOf",t.cities),e.R7$(2),e.Y8G("ngIf",t.isActive),e.R7$(),e.Y8G("ngIf",!t.isActive),e.R7$(4),e.Y8G("ngbTooltip",i),e.R7$(),e.Y8G("hasPermission",e.lJ4(10,ui)),e.R7$(),e.Y8G("hasPermission",e.lJ4(11,gi))}}function yi(r,s){1&r&&(e.j41(0,"div",50),e.EFF(1," general.table.noData "),e.k0s())}function Ii(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",51)(1,"div",52),e.nrm(2,"ngb-pagination-info",53),e.j41(3,"table-length",54),e.bIt("lengthChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.ListItemChange(i))}),e.k0s()(),e.j41(4,"div",55)(5,"ngb-pagination",56),e.bIt("pageChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.pageChanged(i))}),e.mxI("pageChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.pagination.pageNumber,i)||(a.pagination.pageNumber=i),e.Njj(i)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function ji(r,s){1&r&&(e.j41(0,"span",82),e.EFF(1,"general.action.register "),e.k0s())}function Ti(r,s){1&r&&(e.j41(0,"span",82),e.EFF(1,"general.action.edit "),e.k0s())}function ki(r,s){1&r&&(e.j41(0,"div",83),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function wi(r,s){1&r&&(e.j41(0,"div",83),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function Mi(r,s){1&r&&(e.j41(0,"div",83),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function Oi(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",57)(1,"div",58)(2,"h4",59),e.DNE(3,ji,2,0,"span",60)(4,Ti,2,0,"span",60),e.j41(5,"span",61),e.EFF(6),e.k0s()(),e.j41(7,"button",62),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss("Cross click"))}),e.k0s()(),e.j41(8,"div",63),e.nrm(9,"ngx-ui-loader",18),e.j41(10,"form",64,4),e.bIt("submit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.OnSubmit())}),e.j41(12,"div",65)(13,"label",66),e.EFF(14,"sales.shippingTruck.name"),e.k0s(),e.j41(15,"input",67,5),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.name,i)||(a.form.name=i),e.Njj(i)}),e.k0s(),e.DNE(17,ki,2,0,"div",68),e.k0s(),e.j41(18,"div",65)(19,"label",69),e.EFF(20,"sales.shippingTruck.truckNumber"),e.k0s(),e.j41(21,"input",70,6),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.truckNumber,i)||(a.form.truckNumber=i),e.Njj(i)}),e.k0s(),e.DNE(23,wi,2,0,"div",68),e.k0s(),e.j41(24,"div",65)(25,"label",71),e.EFF(26,"sales.shippingTruck.driver"),e.k0s(),e.j41(27,"ng-select",72,7),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.truckDriverId,i)||(a.form.truckDriverId=i),e.Njj(i)}),e.k0s(),e.DNE(29,Mi,2,0,"div",68),e.k0s(),e.j41(30,"div",73)(31,"label",71),e.EFF(32,"sales.shippingTruck.cities"),e.k0s(),e.j41(33,"ng-select",74),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.cities,i)||(a.form.cities=i),e.Njj(i)}),e.k0s()(),e.j41(34,"div",75)(35,"label",76),e.EFF(36,"general.table.isActive"),e.k0s(),e.j41(37,"p-inputSwitch",77),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.isActive,i)||(a.form.isActive=i),e.Njj(i)}),e.k0s()(),e.j41(38,"div",78)(39,"button",79),e.nrm(40,"i",80)(41,"span",81),e.k0s()()()()()}if(2&r){const t=e.sdS(11),n=e.sdS(16),i=e.sdS(22),a=e.sdS(28),o=e.XpG();e.R7$(3),e.Y8G("ngIf",!o.isEditForm),e.R7$(),e.Y8G("ngIf",o.isEditForm),e.R7$(2),e.JRh(o.titleOperation),e.R7$(3),e.Y8G("hasProgressBar",!1)("fgsType",o.loaderOperationShap)("loaderId",o.operationLoader),e.R7$(6),e.R50("ngModel",o.form.name),e.R7$(2),e.Y8G("ngIf",n.invalid&&n.touched),e.R7$(4),e.R50("ngModel",o.form.truckNumber),e.R7$(2),e.Y8G("ngIf",i.invalid&&i.touched),e.R7$(4),e.Y8G("items",o.employees)("multiple",!1),e.R50("ngModel",o.form.truckDriverId),e.R7$(2),e.Y8G("ngIf",a.invalid&&a.touched),e.R7$(4),e.Y8G("items",o.cities)("multiple",!0),e.R50("ngModel",o.form.cities),e.R7$(4),e.R50("ngModel",o.form.isActive),e.R7$(2),e.Y8G("disabled",!t.valid)}}function Ri(r,s){if(1&r){const t=e.RV6();e.j41(0,"delete-modal",84),e.bIt("deleteConfirm",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.DeleteConfirmSoft())})("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}}let Fi=(()=>{class r extends X.w{constructor(t,n,i,a,o,l,h,x,y,I,j){super(t,n,h,i,a,o,l),this.baseService=i,this.excelService=y,this.employeeService=I,this.cityService=j,this.title="sales.shippingTruck.title",this.titleOperation="sales.shippingTruck.titleOperation",this.keySelected="",this.assignUsers=[],this.times=[],this.employees=[],this.searchForm={},this.cities=[],this.configRoute(),this.getEmployees(),this.getCities()}OnSearch(t){this.ngxLoader.startLoader(u.a7),this.loadentities()}onSearch(){this.ngxLoader.startLoader(u.a7),this.loadentities()}configRoute(){this.routerActive.data.pipe((0,m.Q)(this.notifier)).subscribe(t=>{this.entities=t.data.data,this.pagination.totalItems=t.data.totalItems},()=>{this.alertService.error()})}getEmployees(){this.employeeService.getDropDown().pipe((0,m.Q)(this.notifier)).subscribe(t=>{this.employees=t.data},()=>{this.alertService.error()})}getCities(){this.cityService.GetAllDropDown().pipe((0,m.Q)(this.notifier)).subscribe(t=>{this.cities=t.data},()=>{this.alertService.error()})}mapExcel(){let t=[];return this.entities?.forEach(n=>{t.push({workTime:n.workTime,isActive:this.getTranslationText("general.table.active")})}),t}mapRegisterForm(t){let n={...t};return n.id=0,n.cities=n.cities.map(i=>({cityId:i,shippingTruckId:0})),n}mapForm(t){let n={...t};return n.cities=n.cities.map(i=>({cityId:i,shippingTruckId:n.id})),n}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,"Service Type",[])}editEntity(){let t=this.mapForm(this.form);this.baseService.editPut(t.id,t).pipe((0,v.O)(),(0,R.c)(this.mainDelay),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(n=>{n.success?this.submitFunished():this.alertService.error("general.message."+n.message)},n=>{this.alertService.error("general.message."+n)})}static{this.\u0275fac=function(n){return new(n||r)(e.rXU(M.nX),e.rXU(g.c$),e.rXU(mi),e.rXU(E.u),e.rXU(p.vh),e.rXU(w.eD),e.rXU(_.Bq),e.rXU(e.gRc),e.rXU(H.V),e.rXU(K.O),e.rXU(le.h))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-shipping-trucks"]],features:[e.Vt3],decls:23,vars:18,consts:[["tableMaster",""],["operation",""],["deleteModal",""],["tooltipContent",""],["formEntity","ngForm"],["name","ngModel"],["truckNumber","ngModel"],["truckDriverId","ngModel"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],[3,"reset","search","addNew","addPermission","showExport","totalItems","title"],["control",""],[1,"col-md-3","mb-2"],[1,"search-box"],["InputTirmFilter","","type","search","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],[1,"card-body"],[3,"hasProgressBar","fgsType","loaderId"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["translate","",2,"width",".5%"],["pSortableColumn","name","translate","",2,"width","10%"],[1,"ri-expand-up-down-line"],["pSortableColumn","truckNumber","translate","",2,"width","10%"],["pSortableColumn","truckDriverId","translate","",2,"width","10%"],["translate","",2,"width","10%"],["pSortableColumn","isActive","translate","",2,"width","8%"],[1,"fs-5"],[4,"ngFor","ngForOf"],["class","badge bg-success-subtle text-success p-2","translate","general.table.active",4,"ngIf"],["class","badge bg-danger-subtle text-danger p-2","translate","general.table.noActive",4,"ngIf"],["tooltipPosition","top",1,"mdi","mdi-cog-outline","text-muted","fs-16","align-middle","me-1",3,"ngbTooltip"],["class","btn btn-sm btn-soft-info edit-list mx-2",3,"click",4,"hasPermission"],["class","btn btn-sm btn-soft-danger remove-list",3,"click",4,"hasPermission"],[1,"badge","badge-pill","bg-primary","mx-1"],["translate","general.table.active",1,"badge","bg-success-subtle","text-success","p-2"],["translate","general.table.noActive",1,"badge","bg-danger-subtle","text-danger","p-2"],[1,"ri-history-fill","text-warning"],[1,"ri-history-fill","text-danger"],[1,"ri-user-location-fill","text-primary"],[1,"btn","btn-sm","btn-soft-info","edit-list","mx-2",3,"click"],[1,"ri-pencil-fill","align-bottom","mx-1"],[1,"btn","btn-sm","btn-soft-danger","remove-list",3,"click"],[1,"ri-delete-bin-5-fill","align-bottom"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["class","fw-bold fs-4","translate","",4,"ngIf"],["translate",""],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"submit"],[1,"mb-3"],["for","name","translate","",1,"fw-bold","form-label"],["InputTirmFilter","","name","name","type","text","id","name",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["class","text-danger text-center  ","translate","",4,"ngIf"],["for","truckNumber","translate","",1,"fw-bold","form-label"],["InputTirmFilter","","name","truckNumber","type","text","id","truckNumber",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["translate","",1,"required","fw-bold","form-label","w-100"],["name","truckDriverId","bindValue","code","bindLabel","name","required","",3,"ngModelChange","items","multiple","ngModel"],[1,"col-12","mb-1"],["name","cities","bindValue","code","bindLabel","name",3,"ngModelChange","items","multiple","ngModel"],[1,"form-check"],["for","isActive","translate","",1,"fw-bold","form-label","w-100"],["name","isActive","inputId","isActive",3,"ngModelChange","ngModel"],[1,"text-center"],["type","submit","type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],["translate","",1,"fw-bold","fs-4"],["translate","",1,"text-danger","text-center"],[3,"deleteConfirm","dismiss"]],template:function(n,i){if(1&n){const a=e.RV6();e.j41(0,"div",8)(1,"div",9)(2,"div",10)(3,"base-filter",11),e.bIt("reset",function(){return e.eBV(a),e.Njj(i.onReset())})("search",function(){return e.eBV(a),e.Njj(i.onSearch())})("addNew",function(){e.eBV(a);const l=e.sdS(20);return e.Njj(i.openModalTitle(l,"md"))}),e.qex(4,12),e.j41(5,"div",13)(6,"div",14)(7,"input",15),e.nI1(8,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.filterValue,l)||(i.pagination.filterValue=l),e.Njj(l)}),e.k0s(),e.nrm(9,"i",16),e.k0s()(),e.bVm(),e.k0s(),e.j41(10,"div",17),e.nrm(11,"ngx-ui-loader",18),e.j41(12,"div",19)(13,"p-table",20,0),e.bIt("onLazyLoad",function(l){return e.eBV(a),e.Njj(i.tableChange(l))})("selectionChange",function(l){return e.eBV(a),e.Njj(i.onSelectionChange(l))}),e.DNE(15,_i,18,0,"ng-template",21)(16,xi,20,12,"ng-template",22),e.k0s()(),e.DNE(17,yi,2,0,"div",23)(18,Ii,6,8,"div",24),e.k0s()()()(),e.DNE(19,Oi,42,19,"ng-template",null,1,e.C5r)(21,Ri,1,0,"ng-template",null,2,e.C5r)}2&n&&(e.R7$(3),e.Y8G("addPermission",e.lJ4(17,pi))("showExport",!1)("totalItems",i.pagination.totalItems)("title",i.title),e.R7$(4),e.FS9("placeholder",e.bMT(8,15,"task.tasklist.subject")),e.R50("ngModel",i.pagination.filterValue),e.R7$(4),e.Y8G("hasProgressBar",!1)("fgsType",i.loaderSearchShap)("loaderId",i.searchLoader),e.R7$(2),e.Y8G("value",i.entities)("rows",i.pagination.pageSize)("lazy",!0)("totalRecords",i.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",i.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",i.pagination.totalItems>0))},dependencies:[p.Sq,p.bT,d.qT,d.me,d.BC,d.cb,d.YS,d.vS,d.cV,_.s5,W.b,z.w,J.p,Z.g,g.Mm,V.XI,q.Ei,V.Tg,me.HW,w.Cv,P.vr,_.md,B.m,A.p,p.vh,g.D9],encapsulation:2})}}return r})(),Vi=(()=>{class r extends Ce.d{constructor(t){super(t,Y.c.apiUrl+"VisitType/")}static{this.\u0275fac=function(n){return new(n||r)(e.KVO(xe.Qq))}}static{this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();const Ei=()=>["salesSetting.register"],Ni=()=>["salesSetting.edit"],Di=()=>["salesSetting.delete"];function Li(r,s){1&r&&(e.j41(0,"tr",24)(1,"th",25),e.EFF(2,"#"),e.k0s(),e.j41(3,"th",26),e.nrm(4,"i",27),e.EFF(5," general.table.nameAr "),e.k0s(),e.j41(6,"th",28),e.nrm(7,"i",27),e.EFF(8," general.table.nameEn "),e.k0s(),e.j41(9,"th",29),e.nrm(10,"i",27),e.EFF(11," sales.visitType.color "),e.k0s(),e.j41(12,"th",30),e.nrm(13,"i",27),e.EFF(14," general.table.isActive "),e.k0s(),e.nrm(15,"th",31),e.k0s())}function Gi(r,s){1&r&&e.nrm(0,"span",38)}function Pi(r,s){1&r&&e.nrm(0,"span",39)}function $i(r,s){if(1&r&&(e.nrm(0,"i",40),e.EFF(1),e.nI1(2,"date"),e.nrm(3,"br")(4,"i",41),e.EFF(5),e.nI1(6,"date"),e.nrm(7,"br")(8,"i",42),e.EFF(9)),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",e.i5U(2,3,t.createdDate,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",e.i5U(6,6,t.updatedDate,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",t.creatorName," ")}}function Bi(r,s){if(1&r){const t=e.RV6();e.j41(0,"button",43),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,a=e.XpG(),o=e.sdS(19);return e.Njj(a.EditModel(i.id,o))}),e.nrm(1,"i",44),e.k0s()}}function Xi(r,s){if(1&r){const t=e.RV6();e.j41(0,"button",45),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,a=e.XpG(),o=e.sdS(21);return e.Njj(a.openModal(i.id,o))}),e.nrm(1,"i",46),e.k0s()}}function Ai(r,s){if(1&r&&(e.j41(0,"tr",32)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.nrm(7,"td"),e.j41(8,"td"),e.DNE(9,Gi,1,0,"span",33)(10,Pi,1,0,"span",34),e.k0s(),e.j41(11,"td"),e.DNE(12,$i,10,9,"ng-template",null,3,e.C5r),e.nrm(14,"i",35),e.DNE(15,Bi,2,0,"button",36)(16,Xi,2,0,"button",37),e.k0s()()),2&r){const t=s.$implicit,n=s.rowIndex,i=e.sdS(13);e.R7$(2),e.JRh(n+1),e.R7$(2),e.JRh(t.nameAr),e.R7$(2),e.JRh(t.nameEn),e.R7$(),e.xc7("background-color",t.color),e.R7$(2),e.Y8G("ngIf",t.isActive),e.R7$(),e.Y8G("ngIf",!t.isActive),e.R7$(4),e.Y8G("ngbTooltip",i),e.R7$(),e.Y8G("hasPermission",e.lJ4(10,Ni)),e.R7$(),e.Y8G("hasPermission",e.lJ4(11,Di))}}function qi(r,s){1&r&&(e.j41(0,"div",47),e.EFF(1," general.table.noData "),e.k0s())}function Yi(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",48)(1,"div",49),e.nrm(2,"ngb-pagination-info",50),e.j41(3,"table-length",51),e.bIt("lengthChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.ListItemChange(i))}),e.k0s()(),e.j41(4,"div",52)(5,"ngb-pagination",53),e.bIt("pageChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.pageChanged(i))}),e.mxI("pageChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.pagination.pageNumber,i)||(a.pagination.pageNumber=i),e.Njj(i)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function Ui(r,s){1&r&&(e.j41(0,"span",78),e.EFF(1,"general.action.register "),e.k0s())}function zi(r,s){1&r&&(e.j41(0,"span",78),e.EFF(1,"general.action.edit "),e.k0s())}function Qi(r,s){1&r&&(e.j41(0,"div",79),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function Hi(r,s){1&r&&(e.j41(0,"div",79),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function Wi(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",54)(1,"div",55)(2,"h4",56),e.DNE(3,Ui,2,0,"span",57)(4,zi,2,0,"span",57),e.j41(5,"span",58),e.EFF(6),e.k0s()(),e.j41(7,"button",59),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss("Cross click"))}),e.k0s()(),e.j41(8,"div",60),e.nrm(9,"ngx-ui-loader",61),e.j41(10,"form",62,4),e.bIt("submit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.OnSubmit())}),e.j41(12,"div",63)(13,"label",64),e.EFF(14,"general.table.nameAr"),e.k0s(),e.j41(15,"input",65,5),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.nameAr,i)||(a.form.nameAr=i),e.Njj(i)}),e.k0s(),e.DNE(17,Qi,2,0,"div",66),e.k0s(),e.j41(18,"div",63)(19,"label",67),e.EFF(20,"general.table.nameEn"),e.k0s(),e.j41(21,"input",68,6),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.nameEn,i)||(a.form.nameEn=i),e.Njj(i)}),e.k0s(),e.DNE(23,Hi,2,0,"div",66),e.k0s(),e.j41(24,"div",63)(25,"label",69),e.EFF(26,"sales.visitType.color"),e.k0s(),e.j41(27,"input",70,7),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.color,i)||(a.form.color=i),e.Njj(i)}),e.k0s()(),e.j41(29,"div",71)(30,"label",72),e.EFF(31,"general.table.isActive"),e.k0s(),e.j41(32,"p-inputSwitch",73),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.isActive,i)||(a.form.isActive=i),e.Njj(i)}),e.k0s()(),e.j41(33,"div",74)(34,"button",75),e.nrm(35,"i",76)(36,"span",77),e.k0s()()()()()}if(2&r){const t=e.sdS(11),n=e.sdS(16),i=e.sdS(22),a=e.XpG();e.R7$(3),e.Y8G("ngIf",!a.isEditForm),e.R7$(),e.Y8G("ngIf",a.isEditForm),e.R7$(2),e.JRh(a.titleOperation),e.R7$(3),e.Y8G("hasProgressBar",!1)("fgsType",a.loaderOperationShap)("loaderId",a.operationLoader),e.R7$(6),e.R50("ngModel",a.form.nameAr),e.R7$(2),e.Y8G("ngIf",n.invalid&&n.touched),e.R7$(4),e.R50("ngModel",a.form.nameEn),e.R7$(2),e.Y8G("ngIf",i.invalid&&i.touched),e.R7$(4),e.R50("ngModel",a.form.color),e.R7$(5),e.R50("ngModel",a.form.isActive),e.R7$(2),e.Y8G("disabled",!t.valid)}}function Ji(r,s){if(1&r){const t=e.RV6();e.j41(0,"delete-modal",80),e.bIt("deleteConfirm",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.DeleteConfirm())})("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}}let Zi=(()=>{class r extends X.w{constructor(t,n,i,a,o,l,h,x,y,I,j){super(t,n,h,i,a,o,l),this.baseService=i,this.excelService=y,this.employeeService=I,this.cityService=j,this.title="sales.visitType.title",this.titleOperation="sales.visitType.titleOperation",this.keySelected="",this.configRoute()}OnSearch(t){this.ngxLoader.startLoader(u.a7),this.loadentities()}onSearch(){this.ngxLoader.startLoader(u.a7),this.loadentities()}configRoute(){this.routerActive.data.pipe((0,m.Q)(this.notifier)).subscribe(t=>{this.entities=t.data.data,this.pagination.totalItems=t.data.totalItems},()=>{this.alertService.error()})}mapExcel(){let t=[];return this.entities?.forEach(n=>{t.push({nameAr:n.nameAr,isActive:this.getTranslationText("general.table.active")})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,"Visit Types",[])}editEntity(){let t=this.mapForm(this.form);this.baseService.editPut(t.id,t).pipe((0,v.O)(),(0,R.c)(this.mainDelay),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(n=>{n.success?this.submitFunished():this.alertService.error("general.message."+n.message)},n=>{this.alertService.error("general.message."+n)})}static{this.\u0275fac=function(n){return new(n||r)(e.rXU(M.nX),e.rXU(g.c$),e.rXU(Vi),e.rXU(E.u),e.rXU(p.vh),e.rXU(w.eD),e.rXU(_.Bq),e.rXU(e.gRc),e.rXU(H.V),e.rXU(K.O),e.rXU(le.h))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["visitType"]],features:[e.Vt3],decls:22,vars:15,consts:[["tableMaster",""],["operation",""],["deleteModal",""],["tooltipContent",""],["formEntity","ngForm"],["nameAr","ngModel"],["nameEn","ngModel"],["color","ngModel"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],[3,"reset","search","addNew","addPermission","showExport","totalItems","title"],["control",""],[1,"col-md-3","mb-2"],[1,"search-box"],["InputTirmFilter","","type","search","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["translate","",2,"width",".5%"],["pSortableColumn","nameAr","translate","",2,"width","10%"],[1,"ri-expand-up-down-line"],["pSortableColumn","nameEn","translate","",2,"width","10%"],["pSortableColumn","color","translate","",2,"width","3%"],["pSortableColumn","isActive","translate","",2,"width","8%"],["translate","",2,"width","10%"],[1,"fs-5"],["class","badge bg-success-subtle text-success p-2","translate","general.table.active",4,"ngIf"],["class","badge bg-danger-subtle text-danger p-2","translate","general.table.noActive",4,"ngIf"],["tooltipPosition","top",1,"mdi","mdi-cog-outline","text-muted","fs-16","align-middle","me-1",3,"ngbTooltip"],["class","btn btn-sm btn-soft-info edit-list mx-2",3,"click",4,"hasPermission"],["class","btn btn-sm btn-soft-danger remove-list",3,"click",4,"hasPermission"],["translate","general.table.active",1,"badge","bg-success-subtle","text-success","p-2"],["translate","general.table.noActive",1,"badge","bg-danger-subtle","text-danger","p-2"],[1,"ri-history-fill","text-warning"],[1,"ri-history-fill","text-danger"],[1,"ri-user-location-fill","text-primary"],[1,"btn","btn-sm","btn-soft-info","edit-list","mx-2",3,"click"],[1,"ri-pencil-fill","align-bottom","mx-1"],[1,"btn","btn-sm","btn-soft-danger","remove-list",3,"click"],[1,"ri-delete-bin-5-fill","align-bottom"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["class","fw-bold fs-4","translate","",4,"ngIf"],["translate",""],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"hasProgressBar","fgsType","loaderId"],[3,"submit"],[1,"mb-3"],["for","nameAr","translate","",1,"required","fw-bold","form-label"],["InputTirmFilter","","name","nameAr","type","text","id","nameAr",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["class","text-danger text-center  ","translate","",4,"ngIf"],["for","nameEn","translate","",1,"required","fw-bold","form-label"],["InputTirmFilter","","name","nameEn","type","text","id","nameEn",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["for","color","translate","",1,"required","fw-bold","form-label"],["InputTirmFilter","","name","color","type","color","id","color",1,"form-control","fs-6",3,"ngModelChange","ngModel"],[1,"form-check"],["for","isActive","translate","",1,"fw-bold","form-label","w-100"],["name","isActive","inputId","isActive",3,"ngModelChange","ngModel"],[1,"text-center"],["type","submit","type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],["translate","",1,"fw-bold","fs-4"],["translate","",1,"text-danger","text-center"],[3,"deleteConfirm","dismiss"]],template:function(n,i){if(1&n){const a=e.RV6();e.j41(0,"div",8)(1,"div",9)(2,"div",10)(3,"base-filter",11),e.bIt("reset",function(){return e.eBV(a),e.Njj(i.onReset())})("search",function(){return e.eBV(a),e.Njj(i.onSearch())})("addNew",function(){e.eBV(a);const l=e.sdS(19);return e.Njj(i.openModalTitle(l,"md"))}),e.qex(4,12),e.j41(5,"div",13)(6,"div",14)(7,"input",15),e.nI1(8,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.filterValue,l)||(i.pagination.filterValue=l),e.Njj(l)}),e.k0s(),e.nrm(9,"i",16),e.k0s()(),e.bVm(),e.k0s(),e.j41(10,"div",17)(11,"div",18)(12,"p-table",19,0),e.bIt("onLazyLoad",function(l){return e.eBV(a),e.Njj(i.tableChange(l))})("selectionChange",function(l){return e.eBV(a),e.Njj(i.onSelectionChange(l))}),e.DNE(14,Li,16,0,"ng-template",20)(15,Ai,17,12,"ng-template",21),e.k0s()(),e.DNE(16,qi,2,0,"div",22)(17,Yi,6,8,"div",23),e.k0s()()()(),e.DNE(18,Wi,37,13,"ng-template",null,1,e.C5r)(20,Ji,1,0,"ng-template",null,2,e.C5r)}2&n&&(e.R7$(3),e.Y8G("addPermission",e.lJ4(14,Ei))("showExport",!1)("totalItems",i.pagination.totalItems)("title",i.title),e.R7$(4),e.FS9("placeholder",e.bMT(8,12,"task.tasklist.subject")),e.R50("ngModel",i.pagination.filterValue),e.R7$(5),e.Y8G("value",i.entities)("rows",i.pagination.pageSize)("lazy",!0)("totalRecords",i.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",i.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",i.pagination.totalItems>0))},dependencies:[p.bT,d.qT,d.me,d.BC,d.cb,d.vS,d.cV,_.s5,W.b,z.w,J.p,Z.g,g.Mm,V.XI,q.Ei,V.Tg,me.HW,w.Cv,_.md,B.m,A.p,p.vh,g.D9]})}}return r})(),Ki=(()=>{class r extends Ce.d{constructor(t){super(t,Y.c.apiUrl+"VisitObjective/")}static{this.\u0275fac=function(n){return new(n||r)(e.KVO(xe.Qq))}}static{this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();const en=()=>["salesSetting.register"],tn=()=>["salesSetting.edit"],nn=()=>["salesSetting.delete"];function rn(r,s){1&r&&(e.j41(0,"tr",23)(1,"th",24),e.EFF(2,"#"),e.k0s(),e.j41(3,"th",25),e.nrm(4,"i",26),e.EFF(5," general.table.nameAr "),e.k0s(),e.j41(6,"th",27),e.nrm(7,"i",26),e.EFF(8," general.table.nameEn "),e.k0s(),e.j41(9,"th",28),e.nrm(10,"i",26),e.EFF(11," general.table.isActive "),e.k0s(),e.nrm(12,"th",29),e.k0s())}function an(r,s){1&r&&e.nrm(0,"span",36)}function sn(r,s){1&r&&e.nrm(0,"span",37)}function on(r,s){if(1&r&&(e.nrm(0,"i",38),e.EFF(1),e.nI1(2,"date"),e.nrm(3,"br")(4,"i",39),e.EFF(5),e.nI1(6,"date"),e.nrm(7,"br")(8,"i",40),e.EFF(9)),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",e.i5U(2,3,t.createdDate,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",e.i5U(6,6,t.updatedDate,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",t.creatorName," ")}}function ln(r,s){if(1&r){const t=e.RV6();e.j41(0,"button",41),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,a=e.XpG(),o=e.sdS(19);return e.Njj(a.EditModel(i.id,o))}),e.nrm(1,"i",42),e.k0s()}}function dn(r,s){if(1&r){const t=e.RV6();e.j41(0,"button",43),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,a=e.XpG(),o=e.sdS(21);return e.Njj(a.openModal(i.id,o))}),e.nrm(1,"i",44),e.k0s()}}function cn(r,s){if(1&r&&(e.j41(0,"tr",30)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.DNE(8,an,1,0,"span",31)(9,sn,1,0,"span",32),e.k0s(),e.j41(10,"td"),e.DNE(11,on,10,9,"ng-template",null,3,e.C5r),e.nrm(13,"i",33),e.DNE(14,ln,2,0,"button",34)(15,dn,2,0,"button",35),e.k0s()()),2&r){const t=s.$implicit,n=s.rowIndex,i=e.sdS(12);e.R7$(2),e.JRh(n+1),e.R7$(2),e.JRh(t.nameAr),e.R7$(2),e.JRh(t.nameEn),e.R7$(2),e.Y8G("ngIf",t.isActive),e.R7$(),e.Y8G("ngIf",!t.isActive),e.R7$(4),e.Y8G("ngbTooltip",i),e.R7$(),e.Y8G("hasPermission",e.lJ4(8,tn)),e.R7$(),e.Y8G("hasPermission",e.lJ4(9,nn))}}function mn(r,s){1&r&&(e.j41(0,"div",45),e.EFF(1," general.table.noData "),e.k0s())}function pn(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",46)(1,"div",47),e.nrm(2,"ngb-pagination-info",48),e.j41(3,"table-length",49),e.bIt("lengthChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.ListItemChange(i))}),e.k0s()(),e.j41(4,"div",50)(5,"ngb-pagination",51),e.bIt("pageChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.pageChanged(i))}),e.mxI("pageChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.pagination.pageNumber,i)||(a.pagination.pageNumber=i),e.Njj(i)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function un(r,s){1&r&&(e.j41(0,"span",74),e.EFF(1,"general.action.register "),e.k0s())}function gn(r,s){1&r&&(e.j41(0,"span",74),e.EFF(1,"general.action.edit "),e.k0s())}function _n(r,s){1&r&&(e.j41(0,"div",75),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function hn(r,s){1&r&&(e.j41(0,"div",75),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function fn(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",52)(1,"div",53)(2,"h4",54),e.DNE(3,un,2,0,"span",55)(4,gn,2,0,"span",55),e.j41(5,"span",56),e.EFF(6),e.k0s()(),e.j41(7,"button",57),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss("Cross click"))}),e.k0s()(),e.j41(8,"div",58),e.nrm(9,"ngx-ui-loader",59),e.j41(10,"form",60,4),e.bIt("submit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.OnSubmit())}),e.j41(12,"div",61)(13,"label",62),e.EFF(14,"general.table.nameAr"),e.k0s(),e.j41(15,"input",63,5),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.nameAr,i)||(a.form.nameAr=i),e.Njj(i)}),e.k0s(),e.DNE(17,_n,2,0,"div",64),e.k0s(),e.j41(18,"div",61)(19,"label",65),e.EFF(20,"general.table.nameEn"),e.k0s(),e.j41(21,"input",66,6),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.nameEn,i)||(a.form.nameEn=i),e.Njj(i)}),e.k0s(),e.DNE(23,hn,2,0,"div",64),e.k0s(),e.j41(24,"div",67)(25,"label",68),e.EFF(26,"general.table.isActive"),e.k0s(),e.j41(27,"p-inputSwitch",69),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.isActive,i)||(a.form.isActive=i),e.Njj(i)}),e.k0s()(),e.j41(28,"div",70)(29,"button",71),e.nrm(30,"i",72)(31,"span",73),e.k0s()()()()()}if(2&r){const t=e.sdS(11),n=e.sdS(16),i=e.sdS(22),a=e.XpG();e.R7$(3),e.Y8G("ngIf",!a.isEditForm),e.R7$(),e.Y8G("ngIf",a.isEditForm),e.R7$(2),e.JRh(a.titleOperation),e.R7$(3),e.Y8G("hasProgressBar",!1)("fgsType",a.loaderOperationShap)("loaderId",a.operationLoader),e.R7$(6),e.R50("ngModel",a.form.nameAr),e.R7$(2),e.Y8G("ngIf",n.invalid&&n.touched),e.R7$(4),e.R50("ngModel",a.form.nameEn),e.R7$(2),e.Y8G("ngIf",i.invalid&&i.touched),e.R7$(4),e.R50("ngModel",a.form.isActive),e.R7$(2),e.Y8G("disabled",!t.valid)}}function bn(r,s){if(1&r){const t=e.RV6();e.j41(0,"delete-modal",76),e.bIt("deleteConfirm",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.DeleteConfirm())})("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}}let vn=(()=>{class r extends X.w{constructor(t,n,i,a,o,l,h,x,y,I,j){super(t,n,h,i,a,o,l),this.baseService=i,this.excelService=y,this.employeeService=I,this.cityService=j,this.title="sales.visitObjective.title",this.titleOperation="sales.visitObjective.titleOperation",this.keySelected="",this.configRoute()}OnSearch(t){this.ngxLoader.startLoader(u.a7),this.loadentities()}onSearch(){this.ngxLoader.startLoader(u.a7),this.loadentities()}configRoute(){this.routerActive.data.pipe((0,m.Q)(this.notifier)).subscribe(t=>{this.entities=t.data.data,this.pagination.totalItems=t.data.totalItems},()=>{this.alertService.error()})}mapExcel(){let t=[];return this.entities?.forEach(n=>{t.push({nameAr:n.nameAr,isActive:this.getTranslationText("general.table.active")})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,"Visit Types",[])}editEntity(){let t=this.mapForm(this.form);this.baseService.editPut(t.id,t).pipe((0,v.O)(),(0,R.c)(this.mainDelay),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(n=>{n.success?this.submitFunished():this.alertService.error("general.message."+n.message)},n=>{this.alertService.error("general.message."+n)})}static{this.\u0275fac=function(n){return new(n||r)(e.rXU(M.nX),e.rXU(g.c$),e.rXU(Ki),e.rXU(E.u),e.rXU(p.vh),e.rXU(w.eD),e.rXU(_.Bq),e.rXU(e.gRc),e.rXU(H.V),e.rXU(K.O),e.rXU(le.h))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["visitObjective"]],features:[e.Vt3],decls:22,vars:15,consts:[["tableMaster",""],["operation",""],["deleteModal",""],["tooltipContent",""],["formEntity","ngForm"],["nameAr","ngModel"],["nameEn","ngModel"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],[3,"reset","search","addNew","addPermission","showExport","totalItems","title"],["control",""],[1,"col-md-3","mb-2"],[1,"search-box"],["InputTirmFilter","","type","search","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["translate","",2,"width",".5%"],["pSortableColumn","nameAr","translate","",2,"width","10%"],[1,"ri-expand-up-down-line"],["pSortableColumn","nameEn","translate","",2,"width","10%"],["pSortableColumn","isActive","translate","",2,"width","8%"],["translate","",2,"width","10%"],[1,"fs-5"],["class","badge bg-success-subtle text-success p-2","translate","general.table.active",4,"ngIf"],["class","badge bg-danger-subtle text-danger p-2","translate","general.table.noActive",4,"ngIf"],["tooltipPosition","top",1,"mdi","mdi-cog-outline","text-muted","fs-16","align-middle","me-1",3,"ngbTooltip"],["class","btn btn-sm btn-soft-info edit-list mx-2",3,"click",4,"hasPermission"],["class","btn btn-sm btn-soft-danger remove-list",3,"click",4,"hasPermission"],["translate","general.table.active",1,"badge","bg-success-subtle","text-success","p-2"],["translate","general.table.noActive",1,"badge","bg-danger-subtle","text-danger","p-2"],[1,"ri-history-fill","text-warning"],[1,"ri-history-fill","text-danger"],[1,"ri-user-location-fill","text-primary"],[1,"btn","btn-sm","btn-soft-info","edit-list","mx-2",3,"click"],[1,"ri-pencil-fill","align-bottom","mx-1"],[1,"btn","btn-sm","btn-soft-danger","remove-list",3,"click"],[1,"ri-delete-bin-5-fill","align-bottom"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["class","fw-bold fs-4","translate","",4,"ngIf"],["translate",""],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"hasProgressBar","fgsType","loaderId"],[3,"submit"],[1,"mb-3"],["for","nameAr","translate","",1,"required","fw-bold","form-label"],["InputTirmFilter","","name","nameAr","type","text","id","nameAr",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["class","text-danger text-center  ","translate","",4,"ngIf"],["for","nameEn","translate","",1,"required","fw-bold","form-label"],["InputTirmFilter","","name","nameEn","type","text","id","nameEn",1,"form-control","fs-6",3,"ngModelChange","ngModel"],[1,"form-check"],["for","isActive","translate","",1,"fw-bold","form-label","w-100"],["name","isActive","inputId","isActive",3,"ngModelChange","ngModel"],[1,"text-center"],["type","submit","type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],["translate","",1,"fw-bold","fs-4"],["translate","",1,"text-danger","text-center"],[3,"deleteConfirm","dismiss"]],template:function(n,i){if(1&n){const a=e.RV6();e.j41(0,"div",7)(1,"div",8)(2,"div",9)(3,"base-filter",10),e.bIt("reset",function(){return e.eBV(a),e.Njj(i.onReset())})("search",function(){return e.eBV(a),e.Njj(i.onSearch())})("addNew",function(){e.eBV(a);const l=e.sdS(19);return e.Njj(i.openModalTitle(l,"md"))}),e.qex(4,11),e.j41(5,"div",12)(6,"div",13)(7,"input",14),e.nI1(8,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.filterValue,l)||(i.pagination.filterValue=l),e.Njj(l)}),e.k0s(),e.nrm(9,"i",15),e.k0s()(),e.bVm(),e.k0s(),e.j41(10,"div",16)(11,"div",17)(12,"p-table",18,0),e.bIt("onLazyLoad",function(l){return e.eBV(a),e.Njj(i.tableChange(l))})("selectionChange",function(l){return e.eBV(a),e.Njj(i.onSelectionChange(l))}),e.DNE(14,rn,13,0,"ng-template",19)(15,cn,16,10,"ng-template",20),e.k0s()(),e.DNE(16,mn,2,0,"div",21)(17,pn,6,8,"div",22),e.k0s()()()(),e.DNE(18,fn,32,12,"ng-template",null,1,e.C5r)(20,bn,1,0,"ng-template",null,2,e.C5r)}2&n&&(e.R7$(3),e.Y8G("addPermission",e.lJ4(14,en))("showExport",!1)("totalItems",i.pagination.totalItems)("title",i.title),e.R7$(4),e.FS9("placeholder",e.bMT(8,12,"task.tasklist.subject")),e.R50("ngModel",i.pagination.filterValue),e.R7$(5),e.Y8G("value",i.entities)("rows",i.pagination.pageSize)("lazy",!0)("totalRecords",i.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",i.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",i.pagination.totalItems>0))},dependencies:[p.bT,d.qT,d.me,d.BC,d.cb,d.vS,d.cV,_.s5,W.b,z.w,J.p,Z.g,g.Mm,V.XI,q.Ei,V.Tg,me.HW,w.Cv,_.md,B.m,A.p,p.vh,g.D9]})}}return r})();function Sn(r,s){1&r&&e.nrm(0,"app-shipping-trucks")}function Cn(r,s){1&r&&e.nrm(0,"visitType")}function xn(r,s){1&r&&e.nrm(0,"visitObjective")}let yn=(()=>{class r{constructor(){this.title="sales.salesSetting.title"}ngOnInit(){this.breadCrumbItems=[]}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-sales-setting"]],decls:27,vars:9,consts:[["Arrow","ngbNav"],[3,"title","breadcrumbItems"],[1,"col-12"],[1,"card"],[1,"card-body"],["ngbNav","",1,"nav","nav-pills","arrow-navtabs","nav-success","bg-light","mb-3",3,"activeId"],[3,"ngbNavItem"],["ngbNavLink",""],[1,"d-block","d-sm-none"],[1,"mdi","mdi-home-variant"],["translate","sales.shippingTruck.title",1,"d-sm-block"],["ngbNavContent",""],["translate","sales.visitType.title",1,"d-sm-block"],["translate","sales.visitObjective.title",1,"d-sm-block"],[1,"tab-content","text-muted"],[3,"ngbNavOutlet"]],template:function(n,i){if(1&n&&(e.nrm(0,"app-breadcrumbs",1),e.nI1(1,"translate"),e.j41(2,"div",2)(3,"div",3)(4,"div",4)(5,"ul",5,0)(7,"li",6)(8,"a",7)(9,"span",8),e.nrm(10,"i",9),e.k0s(),e.nrm(11,"span",10),e.k0s(),e.DNE(12,Sn,1,0,"ng-template",11),e.k0s(),e.j41(13,"li",6)(14,"a",7)(15,"span",8),e.nrm(16,"i",9),e.k0s(),e.nrm(17,"span",12),e.k0s(),e.DNE(18,Cn,1,0,"ng-template",11),e.k0s(),e.j41(19,"li",6)(20,"a",7)(21,"span",8),e.nrm(22,"i",9),e.k0s(),e.nrm(23,"span",13),e.k0s(),e.DNE(24,xn,1,0,"ng-template",11),e.k0s()(),e.j41(25,"div",14),e.nrm(26,"div",15),e.k0s()()()()),2&n){const a=e.sdS(6);e.FS9("title",e.bMT(1,7,i.title)),e.Y8G("breadcrumbItems",i.breadCrumbItems),e.R7$(5),e.Y8G("activeId",1),e.R7$(2),e.Y8G("ngbNavItem",1),e.R7$(6),e.Y8G("ngbNavItem",2),e.R7$(6),e.Y8G("ngbNavItem",3),e.R7$(7),e.Y8G("ngbNavOutlet",a)}},dependencies:[_.Um,_.X9,_.sy,_.Gx,_.Ri,_.WA,_.m_,_e.m,g.Mm,Fi,Zi,vn,g.D9],encapsulation:2})}}return r})();var ye=c(96357),$e=c(12128),ke=c(99902),Ie=c(35419),ce=c(26366),Ee=c(3200);const In=()=>["salesInvoices.register"],jn=(r,s)=>({"bg-success-subtle text-success":r,"bg-danger-subtle text-danger":s}),Tn=()=>["salesInvoices.odooSync","salesInvoices.printPill"],kn=()=>["salesInvoices.odooSync"],wn=()=>["salesInvoices.printPill"];function Mn(r,s){1&r&&(e.j41(0,"tr",38)(1,"th",39),e.EFF(2,"#"),e.k0s(),e.j41(3,"th",40),e.nrm(4,"i",41),e.EFF(5," orderManagement.order.invoiceCode "),e.k0s(),e.j41(6,"th",42),e.nrm(7,"i",41),e.EFF(8," orderManagement.order.clientName "),e.k0s(),e.j41(9,"th",43),e.nrm(10,"i",41),e.EFF(11," orderManagement.order.orderCode "),e.k0s(),e.j41(12,"th",44),e.nrm(13,"i",41),e.EFF(14," sales.salesInvoices.creationDue "),e.k0s(),e.j41(15,"th",45),e.EFF(16," sales.salesOrder.salsePerson "),e.k0s(),e.j41(17,"th",46),e.nrm(18,"i",41),e.EFF(19," sales.salesInvoices.total "),e.k0s(),e.j41(20,"th",47),e.nrm(21,"i",41),e.EFF(22," sales.salesOrder.totalDiscount "),e.k0s(),e.j41(23,"th",48),e.nrm(24,"i",41),e.EFF(25," sales.salesInvoices.tax "),e.k0s(),e.j41(26,"th",49),e.nrm(27,"i",41),e.EFF(28," sales.salesOrder.netPrice "),e.k0s(),e.j41(29,"th",50),e.nrm(30,"i",41),e.EFF(31," sales.salesOrder.invoiceStatus "),e.k0s(),e.j41(32,"th",51),e.nrm(33,"i",41),e.EFF(34," sales.salesOrder.isSync "),e.k0s(),e.j41(35,"th",52),e.nrm(36,"i",41),e.EFF(37," sales.salesInvoices.notes "),e.k0s(),e.nrm(38,"th",53),e.k0s())}function On(r,s){1&r&&e.nrm(0,"span",69)}function Rn(r,s){1&r&&e.nrm(0,"span",70)}function Fn(r,s){1&r&&e.nrm(0,"span",71)}function Vn(r,s){1&r&&e.nrm(0,"span",72)}function En(r,s){1&r&&e.nrm(0,"span",73)}function Nn(r,s){1&r&&(e.j41(0,"li")(1,"span",78),e.nrm(2,"i",83)(3,"span",84),e.k0s()())}function Dn(r,s){if(1&r){const t=e.RV6();e.j41(0,"li",55),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2).$implicit,a=e.XpG();return e.Njj(a.Print(i.id))}),e.j41(1,"span",78),e.nrm(2,"i",83)(3,"span",85),e.k0s()()}}function Ln(r,s){if(1&r){const t=e.RV6();e.j41(0,"span",67)(1,"div",74)(2,"button",75),e.nrm(3,"i",76),e.k0s(),e.j41(4,"ul",77)(5,"li",55),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,a=e.XpG(),o=e.sdS(55);return e.Njj(a.getInvoiceAttachments(i.id,o))}),e.j41(6,"span",78),e.nrm(7,"i",79)(8,"span",80),e.k0s()(),e.DNE(9,Nn,4,0,"li",81)(10,Dn,4,0,"li",82),e.k0s()()()}2&r&&(e.R7$(9),e.Y8G("hasPermission",e.lJ4(2,kn)),e.R7$(),e.Y8G("hasPermission",e.lJ4(3,wn)))}function Gn(r,s){if(1&r){const t=e.RV6();e.j41(0,"tr",54)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td",55),e.bIt("click",function(){const i=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.Print(i.id))}),e.nrm(4,"i",56),e.j41(5,"bdi",57),e.EFF(6),e.k0s()(),e.j41(7,"td",55),e.bIt("click",function(){const i=e.eBV(t).$implicit,a=e.XpG(),o=e.sdS(57);return e.Njj(a.openModal(i.clientId,o,"md"))}),e.j41(8,"a",58),e.EFF(9),e.k0s()(),e.j41(10,"td"),e.nrm(11,"i",56),e.j41(12,"bdi",59),e.EFF(13),e.k0s()(),e.j41(14,"td")(15,"div"),e.EFF(16),e.nI1(17,"date"),e.k0s(),e.j41(18,"div",60),e.EFF(19),e.nI1(20,"date"),e.k0s()(),e.j41(21,"td"),e.EFF(22),e.k0s(),e.j41(23,"td"),e.EFF(24),e.k0s(),e.j41(25,"td"),e.EFF(26),e.k0s(),e.j41(27,"td"),e.EFF(28),e.k0s(),e.j41(29,"td")(30,"span",61),e.EFF(31),e.k0s()(),e.j41(32,"td"),e.DNE(33,On,1,0,"span",62)(34,Rn,1,0,"span",63)(35,Fn,1,0,"span",64),e.k0s(),e.j41(36,"td"),e.DNE(37,Vn,1,0,"span",65)(38,En,1,0,"span",66),e.k0s(),e.j41(39,"td"),e.EFF(40),e.k0s(),e.j41(41,"td")(42,"div",67),e.DNE(43,Ln,11,4,"span",68),e.k0s()()()}if(2&r){const t=s.$implicit,n=s.rowIndex;e.R7$(2),e.JRh(n+1),e.R7$(4),e.SpI("#INV#",t.id,""),e.R7$(3),e.SpI(" ",t.clientName," "),e.R7$(4),e.SpI("#SO#",t.offerOrderId," "),e.R7$(3),e.JRh(e.i5U(17,19,t.creationTime,"yyyy-MM-dd")),e.R7$(2),e.Y8G("ngClass",e.l_i(25,jn,!t.isDue,t.isDue)),e.R7$(),e.JRh(e.i5U(20,22,t.dueDate,"yyyy-MM-dd")),e.R7$(3),e.JRh(t.salsePersonName),e.R7$(2),e.JRh(t.total),e.R7$(2),e.JRh(t.totalDiscount),e.R7$(2),e.JRh(t.tax),e.R7$(3),e.JRh(t.net),e.R7$(2),e.Y8G("ngIf",0==t.status),e.R7$(),e.Y8G("ngIf",2==t.status),e.R7$(),e.Y8G("ngIf",3==t.status),e.R7$(2),e.Y8G("ngIf",t.isSync),e.R7$(),e.Y8G("ngIf",!t.isSync),e.R7$(2),e.JRh(t.notes),e.R7$(3),e.Y8G("hasPermission",e.lJ4(28,Tn))}}function Pn(r,s){1&r&&(e.j41(0,"div",86),e.EFF(1," general.table.noData "),e.k0s())}function $n(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",87)(1,"div",88),e.nrm(2,"ngb-pagination-info",89),e.j41(3,"table-length",90),e.bIt("lengthChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.ListItemChange(i))}),e.k0s()(),e.j41(4,"div",91)(5,"ngb-pagination",92),e.bIt("pageChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.pageChanged(i))}),e.mxI("pageChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.pagination.pageNumber,i)||(a.pagination.pageNumber=i),e.Njj(i)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function Bn(r,s){1&r&&(e.j41(0,"span",118),e.EFF(1,"general.action.register "),e.k0s())}function Xn(r,s){1&r&&(e.j41(0,"span",118),e.EFF(1,"general.action.edit "),e.k0s())}function An(r,s){1&r&&(e.j41(0,"div",119),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function qn(r,s){1&r&&(e.j41(0,"div",119),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function Yn(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",122)(1,"i",123),e.bIt("click",function(){e.eBV(t);const i=e.XpG().index,a=e.XpG(2);return e.Njj(a.removeFile(i))}),e.k0s(),e.j41(2,"p-image",124),e.bIt("error",function(i){e.eBV(t);const a=e.XpG(3);return e.Njj(a.setDefaultImage(i,"assets/images/custom/no-img.jpg"))}),e.k0s()()}2&r&&(e.R7$(2),e.Y8G("src","assets/images/PDF.png")("preview",!1)("alt","pdf"))}function Un(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",122)(1,"i",123),e.bIt("click",function(){e.eBV(t);const i=e.XpG().index,a=e.XpG(2);return e.Njj(a.removeFile(i))}),e.k0s(),e.j41(2,"p-image",124),e.bIt("error",function(i){e.eBV(t);const a=e.XpG(3);return e.Njj(a.setDefaultImage(i,"assets/images/custom/no-img.jpg"))}),e.k0s()()}if(2&r){const t=e.XpG().$implicit,n=e.XpG(2);e.R7$(2),e.Y8G("src",t.isNew?t.attachment:n.serverPath+t.attachment)("preview",!0)("alt","image")}}function zn(r,s){if(1&r&&(e.j41(0,"div",120),e.DNE(1,Yn,3,3,"div",121)(2,Un,3,3,"div",121),e.k0s()),2&r){const t=s.index,n=e.XpG(2);e.R7$(),e.Y8G("ngIf","application/pdf"===n.filesNames[t]),e.R7$(),e.Y8G("ngIf","application/pdf"!==n.filesNames[t])}}function Qn(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",93)(1,"div",94)(2,"h4",95),e.DNE(3,Bn,2,0,"span",96)(4,Xn,2,0,"span",96),e.j41(5,"span",97),e.EFF(6),e.k0s()(),e.j41(7,"button",98),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss("Cross click"))}),e.k0s()(),e.j41(8,"div",99),e.nrm(9,"ngx-ui-loader",31),e.j41(10,"form",100,5),e.bIt("submit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.OnSubmit())}),e.j41(12,"div",101)(13,"label",102),e.EFF(14,"sales.salesInvoices.paymentTypeName"),e.k0s(),e.j41(15,"ng-select",103,6),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.paymentTypeId,i)||(a.form.paymentTypeId=i),e.Njj(i)}),e.k0s(),e.DNE(17,An,2,0,"div",104),e.k0s(),e.j41(18,"div",101)(19,"label",105),e.EFF(20,"sales.salesInvoices.cost"),e.k0s(),e.j41(21,"input",106,7),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.cost,i)||(a.form.cost=i),e.Njj(i)}),e.k0s(),e.DNE(23,qn,2,0,"div",107),e.k0s(),e.j41(24,"div",101)(25,"label",108),e.EFF(26,"general.table.notes"),e.k0s(),e.j41(27,"textarea",109),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.notes,i)||(a.form.notes=i),e.Njj(i)}),e.EFF(28,"                    "),e.k0s()(),e.j41(29,"div",10)(30,"div",110)(31,"label",102),e.EFF(32," orderManagement.order.attachment"),e.k0s(),e.j41(33,"input",111,8),e.bIt("change",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.onFileSelected(i))}),e.k0s()(),e.j41(35,"div",112),e.DNE(36,zn,3,2,"div",113),e.k0s()(),e.j41(37,"div",114)(38,"button",115),e.nrm(39,"i",116)(40,"span",117),e.k0s()()()()()}if(2&r){const t=e.sdS(11),n=e.sdS(16),i=e.sdS(22),a=e.XpG();e.R7$(3),e.Y8G("ngIf",!a.isEditForm),e.R7$(),e.Y8G("ngIf",a.isEditForm),e.R7$(2),e.JRh(a.titleOperation),e.R7$(3),e.Y8G("hasProgressBar",!1)("fgsType",a.loaderOperationShap)("loaderId",a.operationLoader),e.R7$(6),e.Y8G("items",a.paymentMethods)("multiple",!1),e.R50("ngModel",a.form.paymentTypeId),e.R7$(2),e.Y8G("ngIf",n.invalid&&n.touched),e.R7$(4),e.R50("ngModel",a.form.cost),e.R7$(2),e.Y8G("ngIf",i.invalid&&i.touched),e.R7$(4),e.R50("ngModel",a.form.notes),e.R7$(9),e.Y8G("ngForOf",a.filesToShow),e.R7$(2),e.Y8G("disabled",!t.valid)}}function Hn(r,s){if(1&r){const t=e.RV6();e.j41(0,"delete-modal",125),e.bIt("deleteConfirm",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.DeleteConfirmSoft())})("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}}function Wn(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",128)(1,"p-image",129),e.bIt("error",function(i){e.eBV(t);const a=e.XpG(2);return e.Njj(a.setDefaultImage(i,"assets/images/custom/no-img.jpg"))}),e.k0s()()}if(2&r){const t=s.$implicit,n=e.XpG(2);e.R7$(),e.Y8G("src",n.serverPath+t.path)("preview",!0)}}function Jn(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",93)(1,"div",94),e.nrm(2,"h2",80),e.j41(3,"button",98),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss("Cross click"))}),e.k0s()(),e.j41(4,"div",126)(5,"div",10),e.DNE(6,Wn,2,2,"div",127),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(6),e.Y8G("ngForOf",t.images)}}function Zn(r,s){if(1&r){const t=e.RV6();e.j41(0,"client-summary",130),e.bIt("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("clientId",t.operationId)}}let Kn=(()=>{class r extends X.w{constructor(t,n,i,a,o,l,h,x,y,I,j,T){super(t,n,h,i,a,o,l),this.baseService=i,this.paymentTypesService=x,this.formData=y,this.employeeService=I,this.regionService=j,this.cityService=T,this.title="sales.salesInvoices.title",this.titleOperation="sales.salesInvoices.payment",this.paymentMethods=[],this.searchForm={},this.form={file:""},this.filesToSend=[],this.filesToShow=[],this.filesNames=[],this.isResolveList=!0,this.serverPath=Y.c.mediaUrl,this.countLoad=0,this.isOrderEdit=!1,this.images=[],this.salesPersons=[],this.regions=[],this.cities=[],this.setDates=(b,C,O)=>{if(b?.from||b?.to){const k=b.to||b.from;this.pagination[C]=this.datePipe.transform(b.from||b.to,"yyyy-MM-ddT00:00:00"),this.pagination[O]=this.datePipe.transform(k,"yyyy-MM-ddT23:59:59.999")}else this.pagination[C]=null,this.pagination[O]=null},this.configRoute(),this.GetSalesPersons(),this.GetRegions(),this.GetCities()}GetRegions(){this.regionService.getDropDown().subscribe(t=>{this.regions=t.data},t=>{console.log(t)})}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetSalesPersons(){this.employeeService.GetAllByType(9).subscribe(t=>{this.salesPersons=t.data},t=>{console.log(t)})}configRoute(){this.routerActive.data.pipe((0,m.Q)(this.notifier)).subscribe(t=>{this.entities=t.data.data,this.pagination.totalItems=t.data.totalItems},()=>{this.alertService.error()})}getInvoiceAttachments(t,n){this.baseService.getInvoiceAttachments(t).subscribe({next:i=>{this.images=i.data,this.modalService.open(n,{centered:!0,size:"md"})}})}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader(u.a7),this.setDates(t.dueDates,"dueDateFrom","dueDateTo"),this.setDates(t.creationDates,"creationTimeFrom","creationTimeTo"),this.loadentities()}LoadSuccess(){this.ngxLoader.stopLoader(u.a7)}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems}}openInvoiceModal(t,n,i="md",a){if(this.isEditForm=a,this.form={},this.clearFiles(),this.operationId=t.id,a){this.form=t,console.log(this.form);let o="";t.path&&(o=t.path.split(".")[1]),this.filesToSend.push({id:0,isNew:!1,attachment:t.path}),this.filesToShow.push({id:0,isNew:!1,attachment:t.path}),this.filesNames.push("pdf"===o?"application/pdf":o),this.modalService.open(n,{centered:!0,size:i})}else this.form.invoiceMasterId=t.id,this.modalService.open(n,{centered:!0,size:i})}onFileSelected(t){this.clearFiles();const n=t.target;if(t.target.files&&t.target.files[0]){let i=t.target.files.length;for(let a=0;a<i;a++){let o=new FileReader;this.filesToSend.push({id:0,isNew:!0,attachment:t.target.files.item(a)}),this.filesNames.push(t.target.files[a].type),o.onload=l=>{this.filesToShow.push({id:0,isNew:!0,attachment:l.target.result}),console.log(this.filesToShow)},o.readAsDataURL(t.target?.files[a])}n.value=""}}setDefaultImage(t,n){t.target.src=n}checkExtension(t){const i=t.split("/").pop().split(".").pop();return console.log(),i}checkUrl(t){return null==t||""==t?"":t.startsWith("/upload")?t.replace("/upload","upload"):t}removeFile(t){this.filesToShow.splice(t,1),this.filesNames.splice(t,1),this.filesToSend.splice(t,1)}clearFiles(){this.filesNames=[],this.filesToShow=[],this.filesToSend=[]}registerEntity(){let t=this.mapRegisterForm(this.form);t.file=this.filesToSend&&this.filesToSend.length>0?this.filesToSend[0].attachment:null,this.baseService.register(this.formData.formatFormData(t)).pipe((0,v.O)(),(0,R.c)(this.mainDelay),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader(u.ZW)),(0,pe.W)(n=>(0,ue.$)(n))).subscribe(n=>{n.success?(this.modalService.dismissAll(),this.submitFunished()):this.alertService.error("general.message."+n.message)},n=>{this.alertService.error("general.message."+n)})}editEntity(){let t=this.mapForm(this.form);t.file=this.filesToSend&&this.filesToSend.length>0?this.filesToSend[0].attachment:null,this.baseService.edit(this.formData.formatFormData(t)).pipe((0,v.O)(),(0,R.c)(this.mainDelay),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(n=>{n.success?this.submitFunished():this.alertService.error("general.message."+n.message)},n=>{this.alertService.error("general.message."+n)})}Print(t){this.ngxLoader.startLoader("searchLoader"),this.baseService.print(t).pipe((0,v.O)(),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader("searchLoader"))).subscribe(n=>{this.openUrl(n)},n=>{this.alertService.error("general.message."+n)})}openUrl(t){let n=new Blob([t],{type:t.type});var i=URL.createObjectURL(n);window.open(i,"_blank")}static{this.\u0275fac=function(n){return new(n||r)(e.rXU(M.nX),e.rXU(g.c$),e.rXU(ye.Q),e.rXU(E.u),e.rXU(p.vh),e.rXU(w.eD),e.rXU(_.Bq),e.rXU($e.z),e.rXU(ke.Q),e.rXU(K.O),e.rXU(Ie.S),e.rXU(le.h))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-sales-invoices"]],features:[e.Vt3],decls:58,vars:62,consts:[["tableMaster",""],["addPaymentModal",""],["deleteModal",""],["viewMedia",""],["ClientInfo",""],["formEntity","ngForm"],["paymentTypeId","ngModel"],["cost","ngModel"],["fileInput",""],[3,"title","breadcrumbItems"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"reset","search","addPermission","showAdd","showExport","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","id","name","id",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","search","id","clientName","name","clientName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],["type","text","mwlFlatpickr","","id","dueDates","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],["name","regionId","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],["name","cityId","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],["name","customerSize","id","customerSize","aria-label","Floating label select example",1,"form-select",3,"ngModelChange","ngModel"],["translate","sales.salesInvoices.Unpaid",3,"value"],["translate","sales.salesInvoices.PartiallyPaid",3,"value"],["translate","sales.salesInvoices.Paid",3,"value"],[1,"card-body"],[3,"hasProgressBar","fgsType","loaderId"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["translate","",2,"width",".3%"],["pSortableColumn","id","translate","",2,"width","3%"],[1,"ri-expand-up-down-line"],["pSortableColumn","clientId","translate","",2,"width","10%"],["pSortableColumn","id","translate","",2,"width","4%"],["pSortableColumn","creationTime","translate","",2,"width","12%"],["translate","",2,"width","8%"],["pSortableColumn","total","translate","",2,"width","5%"],["pSortableColumn","totalDiscount","translate","",2,"width","5%"],["pSortableColumn","tax","translate","",2,"width","4%"],["pSortableColumn","net","translate","",2,"width","4%"],["pSortableColumn","invoiceStatus","translate","",2,"width","6%"],["pSortableColumn","isSync","translate","",2,"width","5%"],["pSortableColumn","notes","translate","",2,"width","5%"],[2,"width","3%"],[1,"fs-5"],[3,"click"],[1,"ri-share-circle-fill","label-icon","align-middle","rounded-pill","fs-16","me-2"],[1,"code-pointer","text-decoration-underline"],["href","javascript:void(0)",1,"link-primary","link-offset-2","text-decoration-underline","link-underline-opacity-25","link-underline-opacity-100-hover"],[1,"code-pointer"],[1,"badge",3,"ngClass"],[1,"badge","fs-5","bg-success-subtle","text-success","badge-border"],["class","badge bg-danger","translate","sales.salesInvoices.Unpaid",4,"ngIf"],["class","badge bg-warning","translate","sales.salesInvoices.PartiallyPaid",4,"ngIf"],["class","badge bg-success","translate","sales.salesInvoices.Paid",4,"ngIf"],["class","badge bg-success","translate","sales.salesOrder.syncSend",4,"ngIf"],["class","badge bg-warning","translate","sales.salesOrder.syncNotSend",4,"ngIf"],[1,"d-inline-block"],["class","d-inline-block",4,"hasPermission"],["translate","sales.salesInvoices.Unpaid",1,"badge","bg-danger"],["translate","sales.salesInvoices.PartiallyPaid",1,"badge","bg-warning"],["translate","sales.salesInvoices.Paid",1,"badge","bg-success"],["translate","sales.salesOrder.syncSend",1,"badge","bg-success"],["translate","sales.salesOrder.syncNotSend",1,"badge","bg-warning"],[1,"dropdown-custom","d-inline-block"],["type","button",1,"btn","dropbtn","btn-soft-secondary","btn-sm","dropdown-custom","arrow-none"],[1,"ri-more-fill"],[1,"dropdown-menu","dropdown-menu-end","dropdown-content",2,"left","0"],[1,"dropdown-item"],[1,"ri-image-fill","align-bottom","me-2","text-muted"],["translate","sales.salesOrder.attachments"],[4,"hasPermission"],[3,"click",4,"hasPermission"],[1,"ri-printer-line","align-bottom","me-2","text-muted"],["translate","sales.salesOrder.isSync"],["translate","orderManagement.order.printPill"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["class","fw-bold fs-4","translate","",4,"ngIf"],["translate",""],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"submit"],[1,"mb-3"],["translate","",1,"required","fw-bold","form-label","w-100"],["name","paymentTypeId","bindValue","code","bindLabel","name","required","",3,"ngModelChange","items","multiple","ngModel"],["class","text-danger text-center","translate","",4,"ngIf"],["for","cost","translate","",1,"required","fw-bold","form-label"],["InputTirmFilter","","name","cost","type","text","id","employeeName","required","",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["class","text-danger text-center  ","translate","",4,"ngIf"],["for","notes","translate","",1,"fw-bold","form-label"],["rows","3","name","notes","type","text","id","notes",1,"form-control","fs-6",3,"ngModelChange","ngModel"],[1,"col-12","mb-2"],["accept","image/*, application/pdf","type","file","placeholder","dfd",1,"form-control","fs-6",3,"change"],[1,"my-3","row","row-cols-5"],["class","col",4,"ngFor","ngForOf"],[1,"text-center"],["type","submit","type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],["translate","",1,"fw-bold","fs-4"],["translate","",1,"text-danger","text-center"],[1,"col"],["class","position-relative",4,"ngIf"],[1,"position-relative"],[1,"ri-close-fill","position-absolute",2,"border-radius","50%","background-color","red","inset-inline-start","-14px","top","-8px","color","white",3,"click"],["width","50","height","50",3,"error","src","preview","alt"],[3,"deleteConfirm","dismiss"],[1,"modal-body","p-4"],["class","col-12 col-md-3",4,"ngFor","ngForOf"],[1,"col-12","col-md-3"],["width","80","height","100",3,"error","src","preview"],[3,"dismiss","clientId"]],template:function(n,i){if(1&n){const a=e.RV6();e.nrm(0,"app-breadcrumbs",9),e.nI1(1,"translate"),e.j41(2,"div",10)(3,"div",11)(4,"div",12),e.nrm(5,"ngx-ui-loader",13),e.j41(6,"base-filter",14),e.bIt("reset",function(){return e.eBV(a),e.Njj(i.onReset())})("search",function(){return e.eBV(a),e.Njj(i.onSearch())}),e.qex(7,15),e.j41(8,"div",16)(9,"div",17)(10,"input",18),e.nI1(11,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.id,l)||(i.pagination.id=l),e.Njj(l)}),e.k0s(),e.nrm(12,"i",19),e.k0s()(),e.j41(13,"div",16)(14,"div",17)(15,"input",20),e.nI1(16,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.clientName,l)||(i.pagination.clientName=l),e.Njj(l)}),e.k0s(),e.nrm(17,"i",19),e.k0s()(),e.j41(18,"div",16)(19,"div",17)(20,"ng-select",21),e.nI1(21,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.salesPersonId,l)||(i.pagination.salesPersonId=l),e.Njj(l)}),e.k0s()()(),e.j41(22,"div",16)(23,"input",22),e.nI1(24,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.searchForm.creationDates,l)||(i.searchForm.creationDates=l),e.Njj(l)}),e.k0s()(),e.j41(25,"div",16)(26,"input",23),e.nI1(27,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.searchForm.dueDates,l)||(i.searchForm.dueDates=l),e.Njj(l)}),e.k0s()(),e.j41(28,"div",16)(29,"div",17)(30,"ng-select",24),e.nI1(31,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.regionId,l)||(i.pagination.regionId=l),e.Njj(l)}),e.k0s()()(),e.j41(32,"div",16)(33,"div",17)(34,"ng-select",25),e.nI1(35,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.cityId,l)||(i.pagination.cityId=l),e.Njj(l)}),e.k0s()()(),e.j41(36,"div",16)(37,"select",26),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.status,l)||(i.pagination.status=l),e.Njj(l)}),e.nrm(38,"option",27)(39,"option",28)(40,"option",29),e.k0s()(),e.bVm(),e.k0s(),e.j41(41,"div",30),e.nrm(42,"ngx-ui-loader",31),e.j41(43,"div",32)(44,"p-table",33,0),e.bIt("onLazyLoad",function(l){return e.eBV(a),e.Njj(i.tableChange(l))})("selectionChange",function(l){return e.eBV(a),e.Njj(i.onSelectionChange(l))}),e.DNE(46,Mn,39,0,"ng-template",34)(47,Gn,44,29,"ng-template",35),e.k0s()(),e.DNE(48,Pn,2,0,"div",36)(49,$n,6,8,"div",37),e.k0s()()()(),e.DNE(50,Qn,41,15,"ng-template",null,1,e.C5r)(52,Hn,1,0,"ng-template",null,2,e.C5r)(54,Jn,7,1,"ng-template",null,3,e.C5r)(56,Zn,1,1,"ng-template",null,4,e.C5r)}2&n&&(e.FS9("title",e.bMT(1,45,i.title)),e.Y8G("breadcrumbItems",i.breadCrumbItems),e.R7$(5),e.Y8G("loaderId","newLoader"),e.R7$(),e.Y8G("addPermission",e.lJ4(61,In))("showAdd",!1)("showExport",!1)("totalItems",i.pagination.totalItems)("title",i.title),e.R7$(4),e.FS9("placeholder",e.bMT(11,47,"orderManagement.order.orderCode")),e.R50("ngModel",i.pagination.id),e.R7$(5),e.FS9("placeholder",e.bMT(16,49,"orderManagement.order.agentName")),e.R50("ngModel",i.pagination.clientName),e.R7$(5),e.FS9("placeholder",e.bMT(21,51,"sales.salesOrder.salsePerson")),e.Y8G("items",i.salesPersons)("multiple",!1),e.R50("ngModel",i.pagination.salesPersonId),e.R7$(3),e.FS9("placeholder",e.bMT(24,53,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",i.searchForm.creationDates),e.R7$(3),e.FS9("placeholder",e.bMT(27,55,"sales.salesInvoices.dueDates")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",i.searchForm.dueDates),e.R7$(4),e.FS9("placeholder",e.bMT(31,57,"client.client.regionName")),e.Y8G("items",i.regions)("multiple",!1),e.R50("ngModel",i.pagination.regionId),e.R7$(4),e.FS9("placeholder",e.bMT(35,59,"client.client.cityName")),e.Y8G("items",i.cities)("multiple",!1),e.R50("ngModel",i.pagination.cityId),e.R7$(3),e.R50("ngModel",i.pagination.status),e.R7$(),e.Y8G("value",0),e.R7$(),e.Y8G("value",2),e.R7$(),e.Y8G("value",3),e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",i.loaderSearchShap)("loaderId",i.searchLoader),e.R7$(2),e.Y8G("value",i.entities)("rows",i.pagination.pageSize)("lazy",!0)("totalRecords",i.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",i.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",i.pagination.totalItems>0))},dependencies:[p.YU,p.Sq,p.bT,d.qT,d.xH,d.y7,d.me,d.Q0,d.wz,d.BC,d.cb,d.YS,d.vS,d.cV,_.s5,G.kL,_e.m,W.b,z.w,J.p,Z.g,ce.x,g.Mm,V.XI,q.Ei,V.Tg,w.Cv,P.vr,B.m,A.p,Ee._,p.vh,g.D9],encapsulation:2})}}return r})();var je=c(56131);let er=(()=>{class r extends je.E{constructor(t,n,i){super(t,n,i)}static{this.\u0275fac=function(n){return new(n||r)(e.KVO(M.Ix),e.KVO(ye.Q),e.KVO(E.u))}}static{this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();c(67376);var Be=c(61351);const tr=()=>["clientCollection.register"],ir=()=>["clientCollection.edit"],nr=()=>["clientCollection.delete"];function rr(r,s){1&r&&(e.j41(0,"tr",34)(1,"th",35),e.EFF(2,"#"),e.k0s(),e.j41(3,"th",36),e.nrm(4,"i",37),e.EFF(5," sales.clientCollection.serial "),e.k0s(),e.j41(6,"th",38),e.nrm(7,"i",37),e.EFF(8," sales.clientCollection.clientName "),e.k0s(),e.j41(9,"th",39),e.nrm(10,"i",37),e.EFF(11," sales.clientCollection.paymentTypeName "),e.k0s(),e.j41(12,"th",40),e.nrm(13,"i",37),e.EFF(14," orderManagement.order.creation "),e.k0s(),e.j41(15,"th",41),e.nrm(16,"i",37),e.EFF(17," sales.clientCollection.paymentAmount "),e.k0s(),e.j41(18,"th",42),e.nrm(19,"i",37),e.EFF(20," sales.clientCollection.depositNumber "),e.k0s(),e.j41(21,"th",43),e.nrm(22,"i",37),e.EFF(23," sales.clientCollection.isSyncOdoo "),e.k0s(),e.j41(24,"th",44),e.nrm(25,"i",37),e.EFF(26," sales.clientCollection.notes "),e.k0s(),e.nrm(27,"th",45),e.k0s())}function ar(r,s){1&r&&e.nrm(0,"span",57)}function sr(r,s){1&r&&e.nrm(0,"span",58)}function or(r,s){if(1&r&&(e.nrm(0,"i",59),e.EFF(1),e.nI1(2,"date"),e.nrm(3,"br")(4,"i",60),e.EFF(5),e.nI1(6,"date"),e.nrm(7,"br")(8,"i",61),e.EFF(9)),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",e.i5U(2,3,t.creationTime,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",e.i5U(6,6,t.lastModificationTime,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",t.creatorName," ")}}function lr(r,s){if(1&r){const t=e.RV6();e.j41(0,"button",62),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,a=e.XpG(),o=e.sdS(29);return e.Njj(a.EditModel(i.id,o))}),e.nrm(1,"i",63),e.k0s()}}function dr(r,s){if(1&r){const t=e.RV6();e.j41(0,"button",64),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,a=e.XpG(),o=e.sdS(31);return e.Njj(a.openModal(i.id,o))}),e.nrm(1,"i",65),e.k0s()}}function cr(r,s){if(1&r){const t=e.RV6();e.j41(0,"tr",46)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td",47),e.bIt("click",function(){const i=e.eBV(t).$implicit,a=e.XpG(),o=e.sdS(33);return e.Njj(a.openModal(i.clientId,o,"md"))}),e.j41(6,"a",48),e.EFF(7),e.k0s()(),e.j41(8,"td"),e.EFF(9),e.k0s(),e.j41(10,"td")(11,"span",49),e.EFF(12),e.k0s(),e.EFF(13),e.nI1(14,"date"),e.k0s(),e.j41(15,"td"),e.EFF(16),e.k0s(),e.j41(17,"td"),e.EFF(18),e.k0s(),e.j41(19,"td"),e.DNE(20,ar,1,0,"span",50)(21,sr,1,0,"span",51),e.k0s(),e.j41(22,"td"),e.EFF(23),e.k0s(),e.j41(24,"td"),e.DNE(25,or,10,9,"ng-template",null,4,e.C5r),e.nrm(27,"i",52),e.j41(28,"button",53),e.bIt("click",function(){const i=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.onPrint(i.id))}),e.nrm(29,"i",54),e.k0s(),e.DNE(30,lr,2,0,"button",55)(31,dr,2,0,"button",56),e.k0s()()}if(2&r){const t=s.$implicit,n=s.rowIndex,i=e.sdS(26);e.R7$(2),e.JRh(n+1),e.R7$(2),e.JRh(t.serial),e.R7$(3),e.SpI(" ",t.clientName," "),e.R7$(2),e.JRh(t.paymentTypeName),e.R7$(3),e.SpI("",t.creatorName," "),e.R7$(),e.SpI(" ",e.i5U(14,14,t.creationTime,"yyyy-MM-dd")," "),e.R7$(3),e.JRh(t.cost),e.R7$(2),e.JRh(t.depositNumber),e.R7$(2),e.Y8G("ngIf",t.isSyncOdoo),e.R7$(),e.Y8G("ngIf",!t.isSyncOdoo),e.R7$(2),e.JRh(t.notes),e.R7$(4),e.Y8G("ngbTooltip",i),e.R7$(3),e.Y8G("hasPermission",e.lJ4(17,ir)),e.R7$(),e.Y8G("hasPermission",e.lJ4(18,nr))}}function mr(r,s){1&r&&(e.j41(0,"div",66),e.EFF(1," general.table.noData"),e.k0s())}function pr(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",67)(1,"div",68),e.nrm(2,"ngb-pagination-info",69),e.j41(3,"table-length",70),e.bIt("lengthChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.ListItemChange(i))}),e.k0s()(),e.j41(4,"div",71)(5,"ngb-pagination",72),e.bIt("pageChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.pageChanged(i))}),e.mxI("pageChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.pagination.pageNumber,i)||(a.pagination.pageNumber=i),e.Njj(i)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function ur(r,s){1&r&&(e.j41(0,"span",111),e.EFF(1,"general.action.register "),e.k0s())}function gr(r,s){1&r&&(e.j41(0,"span",111),e.EFF(1,"general.action.edit "),e.k0s())}function _r(r,s){if(1&r){const t=e.RV6();e.j41(0,"i",112),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.removeMainImage())}),e.k0s()}}function hr(r,s){1&r&&(e.j41(0,"div",113),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function fr(r,s){1&r&&(e.j41(0,"div",113),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function br(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",73)(1,"div",74)(2,"h4",75),e.DNE(3,ur,2,0,"span",76)(4,gr,2,0,"span",76),e.j41(5,"span",77),e.EFF(6),e.k0s()(),e.j41(7,"button",78),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss("Cross click"))}),e.k0s()(),e.j41(8,"div",79),e.nrm(9,"ngx-ui-loader",27),e.j41(10,"form",80,5),e.bIt("submit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.OnSubmit())}),e.j41(12,"div",81)(13,"div",82)(14,"div",83)(15,"div",84)(16,"label",85),e.bIt("click",function(){e.eBV(t);const i=e.sdS(21);return e.Njj(i.click())}),e.j41(17,"div",86)(18,"div",87),e.nrm(19,"i",88),e.k0s()()(),e.j41(20,"input",89,6),e.bIt("change",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.onFileChangedMain(i))}),e.k0s()(),e.j41(22,"div",90)(23,"div",91),e.DNE(24,_r,1,0,"i",92),e.j41(25,"div",93),e.nrm(26,"img",94),e.k0s()()()()()(),e.j41(27,"div",81)(28,"label",95),e.EFF(29,"sales.clientCollection.clientName"),e.k0s(),e.j41(30,"ng-select",96),e.bIt("scrollToEnd",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.scrollClient())}),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.clientId,i)||(a.form.clientId=i),e.Njj(i)}),e.k0s()(),e.j41(31,"div",81)(32,"label",97),e.EFF(33,"sales.salesInvoices.paymentTypeName"),e.k0s(),e.j41(34,"ng-select",98,7),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.paymentTypeId,i)||(a.form.paymentTypeId=i),e.Njj(i)}),e.k0s(),e.DNE(36,hr,2,0,"div",99),e.k0s(),e.j41(37,"div",100)(38,"label",101),e.EFF(39,"sales.clientCollection.costCollection"),e.k0s(),e.j41(40,"input",102,8),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.cost,i)||(a.form.cost=i),e.Njj(i)}),e.k0s(),e.DNE(42,fr,2,0,"div",103),e.k0s(),e.j41(43,"div",100)(44,"label",104),e.EFF(45,"sales.clientCollection.depositNumber"),e.k0s(),e.j41(46,"input",105,9),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.depositNumber,i)||(a.form.depositNumber=i),e.Njj(i)}),e.k0s()(),e.j41(48,"div",100)(49,"label",106),e.EFF(50,"sales.clientCollection.notes"),e.k0s(),e.j41(51,"textarea",107,10),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.notes,i)||(a.form.notes=i),e.Njj(i)}),e.k0s()(),e.j41(53,"div",82)(54,"button",108),e.nrm(55,"i",109)(56,"span",110),e.k0s()()()()()}if(2&r){const t=e.sdS(11),n=e.sdS(35),i=e.sdS(41),a=e.XpG();e.R7$(3),e.Y8G("ngIf",!a.isEditForm),e.R7$(),e.Y8G("ngIf",a.isEditForm),e.R7$(2),e.JRh(a.titleOperation),e.R7$(3),e.Y8G("hasProgressBar",!1)("fgsType",a.loaderOperationShap)("loaderId",a.operationLoader),e.R7$(15),e.Y8G("ngIf",a.image.path),e.R7$(2),e.Y8G("src",a.image.isApi?a.serverPath+a.image.path:a.image.path,e.B4B),e.R7$(4),e.Y8G("virtualScroll",!0)("items",a.clients)("typeahead",a.searchClient)("loading",a.loading)("multiple",!1),e.R50("ngModel",a.form.clientId),e.R7$(4),e.Y8G("items",a.paymentMethods)("multiple",!1),e.R50("ngModel",a.form.paymentTypeId),e.R7$(2),e.Y8G("ngIf",n.invalid&&n.touched),e.R7$(4),e.R50("ngModel",a.form.cost),e.R7$(2),e.Y8G("ngIf",i.invalid&&i.touched),e.R7$(4),e.R50("ngModel",a.form.depositNumber),e.R7$(5),e.R50("ngModel",a.form.notes),e.R7$(3),e.Y8G("disabled",!t.valid)}}function vr(r,s){if(1&r){const t=e.RV6();e.j41(0,"delete-modal",114),e.bIt("deleteConfirm",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.DeleteConfirmSoft())})("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}}function Sr(r,s){if(1&r){const t=e.RV6();e.j41(0,"client-summary",115),e.bIt("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("clientId",t.operationId)}}let Cr=(()=>{class r extends X.w{constructor(t,n,i,a,o,l,h,x,y,I,j,T){super(t,n,h,i,a,o,l),this.baseService=i,this.excelService=y,this.clientService=I,this.paymentTypesService=j,this._formDataService=T,this.title="sales.clientCollection.title",this.titleOperation="sales.clientCollection.titleOperation",this.keySelected="",this.assignUsers=[],this.times=[],this.employees=[],this.searchForm={},this.isResolveList=!0,this.countLoad=2,this.clientParam={pageSize:50,pageNumber:1,search:"",clientId:null},this.clients=[],this.loading=!1,this.searchClient=new ne.B,this.paymentMethods=[],this.image={},this.serverPath=Y.c.mediaUrl,this.clientGroups=[],this.regions=[],this.sales=[],this.priceList=[],this.cities=[],this.sumResult={total:0},this.setDates=(b,C,O)=>{if(b?.from||b?.to){const k=b.to||b.from;this.pagination[C]=this.datePipe.transform(b.from||b.to,"yyyy-MM-ddT00:00:00"),this.pagination[O]=this.datePipe.transform(k,"yyyy-MM-ddT23:59:59.999")}else this.pagination[C]=null,this.pagination[O]=null},this.configRoute()}ngOnInitMore(){this.searchClient.pipe((0,ve.B)(300),(0,Se.F)(),(0,ae.n)(t=>this.loadClient(t))).subscribe(),this.getPaymentTypes(),this.GetAgentLookUps()}GetAgentLookUps(){this.clientService.CustomerCompanyLookUps().subscribe(t=>{this.regions=t.data.regions,this.cities=t.data.cities,this.clientGroups=t.data.clientGroups,this.sales=t.data.employees,this.priceList=t.data.priceList},t=>{console.log(t)})}getPaymentTypes(){this.paymentTypesService.getDropDown().subscribe({next:t=>{this.paymentMethods=t.data}})}onSearch(){this.ngxLoader.startLoader(u.a7);let t={...this.searchForm};this.pagination.depositNumber&&(this.pagination.depositNumber=this.pagination.depositNumber.toString()),this.setDates(t.creationDates,"dateFrom","dateTo"),this.loadentities()}loadClient(t){return this.loading=!0,""==t||null==t?(this.loading=!1,(0,ge.of)([])):this.getClientDropdwon(t)}getClientDropdwon(t=""){return this.clientParam.search=t,this.clientParam.clientId=null,this.clientParam.pageNumber=1,this.clientService.GetClientSearch(this.clientParam).pipe((0,ae.n)(n=>(this.clients=n.data,this.loading=!1,[])))}mapForm(t){let n={...t};return this._formDataService.formatFormData(n)}validAttachment(){return!!(2!==this.form.paymentTypeId&&3!==this.form.paymentTypeId||this.form.image||this.form.path)||(this.ngxLoader.stopLoader(this.operationLoader),this.alertService.error("sales.clientCollection.mustEnterReceipt"),!1)}mapRegisterForm(t){let n={...t};return n.id=0,this._formDataService.formatFormData(n)}OnSearch(t){this.ngxLoader.startLoader(u.a7),this.loadentities()}configRoute(){}OnSubmit(){this.form.cost<=0?this.alertService.error("sales.clientCollection.costLargeZero"):(this.ngxLoader.startLoader(this.operationLoader),!0===this.isEditForm?this.editEntity():this.registerEntity())}EditModel(t,n,i="md"){this.isEditForm=!0,this.image={},this.form={},this.baseService.getById(t).pipe((0,m.Q)(this.notifier)).subscribe(a=>{a.success?(this.clientParam.clientId=a.data.clientId,this.clientParam.search="",this.clientService.GetClientSearch(this.clientParam).subscribe(o=>{this.clients=o.data}),this.image.path=a.data.path,this.image.isApi=!0,this.form=a.data):this.alertService.error("general.message."+a.message),this.modalService.open(n,{centered:!0,size:i})},a=>{this.alertService.error()})}mapExcel(){let t=[];return this.entities?.forEach(n=>{t.push({Client_Name:n.clientName,Date:this.datePipe.transform(n.creationTime,"yyyy-MM-dd HH:mm"),User:n.creatorName,Payment_Name:n.paymentTypeName,Cost:n.cost,DepositNumber:n.depositNumber,Sync_Odoo:this.getTranslationText(n.isSyncOdoo?"sales.salesOrder.syncSend":"sales.salesOrder.syncNotSend"),Notes:n.notes})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.getTranslationText(this.title),[])}registerEntity(){if(!this.validAttachment())return;let n=this.mapRegisterForm(this.form);this.baseService.register(n).pipe((0,v.O)(),(0,R.c)(this.mainDelay),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader(this.operationLoader)),(0,pe.W)(i=>(0,ue.$)(i))).subscribe(i=>{i.success?this.submitFunished():this.alertService.error("general.message."+i.message)},i=>{this.alertService.error("general.message."+i)})}editEntity(){if(!this.validAttachment())return;let n=this.mapForm(this.form);this.baseService.editPut(this.form.id,n).pipe((0,v.O)(),(0,R.c)(this.mainDelay),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(i=>{i.success?this.submitFunished():this.alertService.error("general.message."+i.message)},i=>{this.alertService.error("general.message."+i)})}scrollClient(){this.clientParam.pageNumber=this.clientParam.pageNumber+1,this.clientService.GetClientSearch(this.clientParam).subscribe(t=>{this.clients=[...this.clients,...t.data]})}onFileChangedMain(t){if(t.target.files&&t.target.files[0]){let n=t.target.files.length;for(let i=0;i<n;i++){let a=new FileReader;this.form.image=t.target.files.item(i),a.onload=o=>{this.image={isApi:!1,path:o.target.result}},a.readAsDataURL(t.target.files[i]),console.log(this.image)}}}removeMainImage(){this.form.image="",this.image={isApi:!1,path:""}}onPrint(t){this.ngxLoader.startLoader("searchLoader"),this.baseService.print(t).pipe((0,v.O)(),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader("searchLoader"))).subscribe(n=>{this.openUrl(n)},n=>{this.alertService.error("general.message."+n)})}openUrl(t){let n=new Blob([t],{type:t.type});var i=URL.createObjectURL(n);window.open(i,"_blank")}getTotal(t){this.sumResult.total=t.reduce((n,i)=>n+i.cost,0)}loadentities(){this.baseService.get(this.pagination).pipe((0,m.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader(u.a7),this.entities=t.data,this.getTotal(this.entities),this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader(u.a7),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[]}static{this.\u0275fac=function(n){return new(n||r)(e.rXU(M.nX),e.rXU(g.c$),e.rXU(Be.F),e.rXU(E.u),e.rXU(p.vh),e.rXU(w.eD),e.rXU(_.Bq),e.rXU(e.gRc),e.rXU(H.V),e.rXU(oe.X),e.rXU($e.z),e.rXU(ke.Q))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-clientCollection"]],features:[e.Vt3],decls:34,vars:33,consts:[["tableMaster",""],["operation",""],["deleteModal",""],["ClientInfo",""],["tooltipContent",""],["formEntity","ngForm"],["FileInputMain",""],["paymentTypeId","ngModel"],["cost","ngModel"],["depositNumber","ngModel"],["notes","ngModel"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],[3,"reset","search","exportXlsx","addNew","addPermission","totalItems","title"],["control",""],[1,"col-md-3","mb-2"],[1,"search-box"],["type","search","id","name","name","name",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],[1,"col-12","col-md-2","mb-2"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"col-12","col-md-2"],["name","paymentTypeId","bindValue","code","bindLabel","name","required","",3,"ngModelChange","items","multiple","placeholder","ngModel"],[1,"col-md-2","mb-2"],["type","number","id","depositNumber","name","depositNumber",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"card-body"],[3,"hasProgressBar","fgsType","loaderId"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["translate","",2,"width",".5%"],["pSortableColumn","serial","translate","",2,"width","4%"],[1,"ri-expand-up-down-line"],["pSortableColumn","clientId","translate","",2,"width","15%"],["pSortableColumn","paymentTypeName","translate","",2,"width","8%"],["pSortableColumn","creationTime","translate","",2,"width","12%"],["pSortableColumn","cost","translate","",2,"width","5%"],["pSortableColumn","depositNumber","translate","",2,"width","8%"],["pSortableColumn","isSyncOdoo","translate","",2,"width","6%"],["pSortableColumn","notes","translate","",2,"width","8%"],["translate","",2,"width","12%"],[1,"fs-5"],[3,"click"],["href","javascript:void(0)",1,"link-primary","link-offset-2","text-decoration-underline","link-underline-opacity-25","link-underline-opacity-100-hover"],[1,"badge","bg-success-subtle","text-success"],["class","badge bg-success","translate","sales.salesOrder.syncSend",4,"ngIf"],["class","badge bg-warning","translate","sales.salesOrder.syncNotSend",4,"ngIf"],["tooltipPosition","top",1,"mdi","mdi-cog-outline","text-muted","fs-16","align-middle","me-1",3,"ngbTooltip"],[1,"btn","btn-sm","btn-soft-warning","edit-list","mx-2",3,"click"],[1,"ri-printer-cloud-fill","align-bottom","mx-1"],["class","btn btn-sm btn-soft-info edit-list mx-2",3,"click",4,"hasPermission"],["class","btn btn-sm btn-soft-danger remove-list",3,"click",4,"hasPermission"],["translate","sales.salesOrder.syncSend",1,"badge","bg-success"],["translate","sales.salesOrder.syncNotSend",1,"badge","bg-warning"],[1,"ri-history-fill","text-warning"],[1,"ri-history-fill","text-danger"],[1,"ri-user-location-fill","text-primary"],[1,"btn","btn-sm","btn-soft-info","edit-list","mx-2",3,"click"],[1,"ri-pencil-fill","align-bottom","mx-1"],[1,"btn","btn-sm","btn-soft-danger","remove-list",3,"click"],[1,"ri-delete-bin-5-fill","align-bottom"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["class","fw-bold fs-4","translate","",4,"ngIf"],["translate",""],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"submit"],[1,"mb-3"],[1,"text-center"],[1,"position-relative","d-inline-block"],[1,"position-absolute","top-100","start-100","translate-middle"],["placement","right","ngbTooltip","Select Image",1,"mb-0",3,"click"],[1,"avatar-xs"],[1,"avatar-title","bg-light","border","rounded-circle","text-muted","cursor-pointer"],[1,"ri-image-fill"],["value","","type","file","accept","image/png, image/gif, image/jpeg",1,"form-control","d-none",3,"change"],[1,"d-flex"],[1,"avatar-lg","mx-2","position-relative"],["class","position-absolute bx bx-x-circle text-white","style","background: red; top: 1px; right: -4px; font-size: 1rem;\n                                                        border-radius: 50% ",3,"click",4,"ngIf"],[1,"avatar-title","bg-light","rounded"],["id","product-img2","alt","",1,"avatar-md","h-auto",3,"src"],["for","nameAr","translate","",1,"required","fw-bold","form-label"],["bindLabel","displayName","bindValue","id","name","clientId","required","",3,"scrollToEnd","ngModelChange","virtualScroll","items","typeahead","loading","multiple","ngModel"],["translate","",1,"required","fw-bold","form-label","w-100"],["name","paymentTypeId","bindValue","code","bindLabel","name","required","",3,"ngModelChange","items","multiple","ngModel"],["class","text-danger text-center","translate","",4,"ngIf"],[1,"mb-2"],["for","cost","translate","",1,"fw-bold","form-label"],["InputTirmFilter","","name","cost","type","text","id","cost",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["class","text-danger text-center  ","translate","",4,"ngIf"],["for","depositNumber","translate","",1,"fw-bold","form-label"],["InputTirmFilter","","name","depositNumber","type","text","id","depositNumber",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["for","notes","translate","",1,"fw-bold","form-label"],["rows","2","InputTirmFilter","","name","notes","type","text","id","notes",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["type","submit","type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],["translate","",1,"fw-bold","fs-4"],[1,"position-absolute","bx","bx-x-circle","text-white",2,"background","red","top","1px","right","-4px","font-size","1rem","border-radius","50%",3,"click"],["translate","",1,"text-danger","text-center"],[3,"deleteConfirm","dismiss"],[3,"dismiss","clientId"]],template:function(n,i){if(1&n){const a=e.RV6();e.j41(0,"div",11)(1,"div",12)(2,"div",13)(3,"base-filter",14),e.bIt("reset",function(){return e.eBV(a),e.Njj(i.onReset())})("search",function(){return e.eBV(a),e.Njj(i.onSearch())})("exportXlsx",function(){return e.eBV(a),e.Njj(i.onExportXlsx())})("addNew",function(){e.eBV(a);const l=e.sdS(29);return e.Njj(i.openModalTitle(l,"md"))}),e.qex(4,15),e.j41(5,"div",16)(6,"div",17)(7,"input",18),e.nI1(8,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.name,l)||(i.pagination.name=l),e.Njj(l)}),e.k0s(),e.nrm(9,"i",19),e.k0s()(),e.j41(10,"div",20)(11,"input",21),e.nI1(12,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.searchForm.creationDates,l)||(i.searchForm.creationDates=l),e.Njj(l)}),e.k0s()(),e.j41(13,"div",22)(14,"ng-select",23),e.nI1(15,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.paymentTypeId,l)||(i.pagination.paymentTypeId=l),e.Njj(l)}),e.k0s()(),e.j41(16,"div",24)(17,"input",25),e.nI1(18,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.depositNumber,l)||(i.pagination.depositNumber=l),e.Njj(l)}),e.k0s()(),e.bVm(),e.k0s(),e.j41(19,"div",26),e.nrm(20,"ngx-ui-loader",27),e.j41(21,"div",28)(22,"p-table",29,0),e.bIt("onLazyLoad",function(l){return e.eBV(a),e.Njj(i.tableChange(l))})("selectionChange",function(l){return e.eBV(a),e.Njj(i.onSelectionChange(l))}),e.DNE(24,rr,28,0,"ng-template",30)(25,cr,32,19,"ng-template",31),e.k0s()(),e.DNE(26,mr,2,0,"div",32)(27,pr,6,8,"div",33),e.k0s()()()(),e.DNE(28,br,57,23,"ng-template",null,1,e.C5r)(30,vr,1,0,"ng-template",null,2,e.C5r)(32,Sr,1,1,"ng-template",null,3,e.C5r)}2&n&&(e.R7$(3),e.Y8G("addPermission",e.lJ4(32,tr))("totalItems",i.pagination.totalItems)("title",i.title),e.R7$(4),e.FS9("placeholder",e.bMT(8,24,"general.table.name")),e.R50("ngModel",i.pagination.name),e.R7$(4),e.FS9("placeholder",e.bMT(12,26,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",i.searchForm.creationDates),e.R7$(3),e.FS9("placeholder",e.bMT(15,28,"sales.salesInvoices.paymentTypeName")),e.Y8G("items",i.paymentMethods)("multiple",!1),e.R50("ngModel",i.pagination.paymentTypeId),e.R7$(3),e.FS9("placeholder",e.bMT(18,30,"sales.clientCollection.depositNumber")),e.R50("ngModel",i.pagination.depositNumber),e.R7$(3),e.Y8G("hasProgressBar",!1)("fgsType",i.loaderSearchShap)("loaderId",i.searchLoader),e.R7$(2),e.Y8G("value",i.entities)("rows",i.pagination.pageSize)("lazy",!0)("totalRecords",i.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",i.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",i.pagination.totalItems>0))},dependencies:[p.bT,d.qT,d.me,d.Q0,d.BC,d.cb,d.YS,d.vS,d.cV,_.s5,G.kL,W.b,z.w,J.p,Z.g,ce.x,g.Mm,V.XI,q.Ei,V.Tg,w.Cv,P.vr,_.md,B.m,A.p,p.vh,g.D9],encapsulation:2})}}return r})();const xr=()=>["requestPersonSales.register"],yr=()=>["requestPersonSales.changeStatus"],Xe=()=>["requestPersonSales.edit"];function Ir(r,s){1&r&&(e.j41(0,"tr",47)(1,"th",48),e.EFF(2,"#"),e.k0s(),e.j41(3,"th",49),e.nrm(4,"i",50),e.EFF(5," sales.clientCollection.clientName "),e.k0s(),e.j41(6,"th",51),e.nrm(7,"i",50),e.EFF(8," orderManagement.order.creation "),e.k0s(),e.j41(9,"th",52),e.EFF(10," sales.salesOrder.salsePerson "),e.k0s(),e.j41(11,"th",53),e.nrm(12,"i",50),e.EFF(13," sales.clientCollection.cost "),e.k0s(),e.j41(14,"th",54),e.nrm(15,"i",50),e.EFF(16," sales.requestPersonSales.requestPersonStatus "),e.k0s(),e.j41(17,"th",55),e.nrm(18,"i",50),e.EFF(19," sales.clientCollection.notes "),e.k0s(),e.nrm(20,"th",56),e.k0s())}function jr(r,s){if(1&r&&(e.nrm(0,"i",64),e.EFF(1),e.nI1(2,"date"),e.nrm(3,"br")(4,"i",65),e.EFF(5),e.nI1(6,"date"),e.nrm(7,"br")(8,"i",66),e.EFF(9)),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",e.i5U(2,3,t.creationTime,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",e.i5U(6,6,t.lastModificationTime,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",t.creatorName," ")}}function Tr(r,s){if(1&r){const t=e.RV6();e.j41(0,"button",67),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,a=e.XpG(),o=e.sdS(83);return e.Njj(a.openModal(i.id,o))}),e.nrm(1,"i",68),e.k0s()}}function kr(r,s){if(1&r){const t=e.RV6();e.j41(0,"button",71),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2).$implicit,a=e.XpG(),o=e.sdS(79);return e.Njj(a.EditModel(i.id,o))}),e.nrm(1,"i",72),e.k0s()}}function wr(r,s){if(1&r){const t=e.RV6();e.j41(0,"button",73),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2).$implicit,a=e.XpG();return e.Njj(a.Send(i.id))}),e.nrm(2,"i",74),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"general.action.send"))}function Mr(r,s){1&r&&(e.qex(0),e.DNE(1,kr,2,0,"button",69)(2,wr,3,3,"button",70),e.bVm()),2&r&&(e.R7$(),e.Y8G("hasPermission",e.lJ4(2,Xe)),e.R7$(),e.Y8G("hasPermission",e.lJ4(3,Xe)))}function Or(r,s){if(1&r){const t=e.RV6();e.j41(0,"tr",57)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td",58),e.bIt("click",function(){const i=e.eBV(t).$implicit,a=e.XpG(),o=e.sdS(85);return e.Njj(a.openModal(i.clientId,o,"md"))}),e.j41(4,"a",59),e.EFF(5),e.k0s()(),e.j41(6,"td"),e.EFF(7),e.nI1(8,"date"),e.k0s(),e.j41(9,"td"),e.EFF(10),e.k0s(),e.j41(11,"td"),e.EFF(12),e.k0s(),e.j41(13,"td")(14,"span"),e.nrm(15,"span",60),e.k0s()(),e.j41(16,"td"),e.EFF(17),e.k0s(),e.j41(18,"td"),e.DNE(19,jr,10,9,"ng-template",null,5,e.C5r),e.nrm(21,"i",61),e.DNE(22,Tr,2,0,"button",62)(23,Mr,3,4,"ng-container",63),e.k0s()()}if(2&r){const t=s.$implicit,n=s.rowIndex,i=e.sdS(20),a=e.XpG();e.R7$(2),e.JRh(n+1),e.R7$(3),e.SpI(" ",t.clientName," "),e.R7$(2),e.SpI(" ",e.i5U(8,13,t.creationTime,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(3),e.JRh(t.creatorName),e.R7$(2),e.JRh(t.cost),e.R7$(2),e.ZvI("badge ",a.getStatus(t.requestPersonStatus),""),e.R7$(),e.FS9("translate","sales.salesOrder."+t.requestPersonStatusName),e.R7$(2),e.JRh(t.notes),e.R7$(4),e.Y8G("ngbTooltip",i),e.R7$(),e.Y8G("hasPermission",e.lJ4(16,yr)),e.R7$(),e.Y8G("ngIf",50==t.requestPersonStatus)}}function Rr(r,s){1&r&&(e.j41(0,"div",75),e.EFF(1," general.table.noData"),e.k0s())}function Fr(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",76)(1,"div",77),e.nrm(2,"ngb-pagination-info",78),e.j41(3,"table-length",79),e.bIt("lengthChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.ListItemChange(i))}),e.k0s()(),e.j41(4,"div",80)(5,"ngb-pagination",81),e.bIt("pageChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.pageChanged(i))}),e.mxI("pageChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.pagination.pageNumber,i)||(a.pagination.pageNumber=i),e.Njj(i)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function Vr(r,s){1&r&&(e.j41(0,"span",104),e.EFF(1,"general.action.register "),e.k0s())}function Er(r,s){1&r&&(e.j41(0,"span",104),e.EFF(1,"general.action.edit "),e.k0s())}function Nr(r,s){1&r&&(e.j41(0,"div",105),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function Dr(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",82)(1,"div",83)(2,"h4",84),e.DNE(3,Vr,2,0,"span",85)(4,Er,2,0,"span",85),e.j41(5,"span",86),e.EFF(6),e.k0s()(),e.j41(7,"button",87),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss("Cross click"))}),e.k0s()(),e.j41(8,"div",88),e.nrm(9,"ngx-ui-loader",89),e.j41(10,"form",90,6),e.bIt("submit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.OnSubmit())}),e.j41(12,"div",91)(13,"label",92),e.EFF(14,"sales.clientCollection.clientName"),e.k0s(),e.j41(15,"ng-select",93),e.bIt("scrollToEnd",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.scrollClient())}),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.clientId,i)||(a.form.clientId=i),e.Njj(i)}),e.k0s()(),e.j41(16,"div",94)(17,"label",95),e.EFF(18,"sales.clientCollection.cost"),e.k0s(),e.j41(19,"input",96,7),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.cost,i)||(a.form.cost=i),e.Njj(i)}),e.k0s(),e.DNE(21,Nr,2,0,"div",97),e.k0s(),e.j41(22,"div",94)(23,"label",98),e.EFF(24,"sales.clientCollection.notes"),e.k0s(),e.j41(25,"textarea",99,8),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.notes,i)||(a.form.notes=i),e.Njj(i)}),e.k0s()(),e.j41(27,"div",100)(28,"button",101),e.nrm(29,"i",102)(30,"span",103),e.k0s()()()()()}if(2&r){const t=e.sdS(11),n=e.sdS(20),i=e.XpG();e.R7$(3),e.Y8G("ngIf",!i.isEditForm),e.R7$(),e.Y8G("ngIf",i.isEditForm),e.R7$(2),e.JRh(i.titleOperation),e.R7$(3),e.Y8G("hasProgressBar",!1)("fgsType",i.loaderOperationShap)("loaderId",i.operationLoader),e.R7$(6),e.Y8G("virtualScroll",!0)("items",i.clients)("typeahead",i.searchClient)("loading",i.loading)("multiple",!1),e.R50("ngModel",i.form.clientId),e.R7$(4),e.R50("ngModel",i.form.cost),e.R7$(2),e.Y8G("ngIf",n.invalid&&n.touched),e.R7$(4),e.R50("ngModel",i.form.notes),e.R7$(3),e.Y8G("disabled",!t.valid)}}function Lr(r,s){if(1&r){const t=e.RV6();e.j41(0,"delete-modal",106),e.bIt("deleteConfirm",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.DeleteConfirmSoft())})("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}}function Gr(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",91)(1,"label",111),e.EFF(2,"sales.clientCollection.cost"),e.k0s(),e.j41(3,"input",112),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG(2);return e.DH7(a.form.cost,i)||(a.form.cost=i),e.Njj(i)}),e.k0s()()}if(2&r){const t=e.XpG(2);e.R7$(3),e.R50("ngModel",t.form.cost)}}function Pr(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",82)(1,"div",83)(2,"h4",84)(3,"span",86),e.EFF(4),e.k0s()(),e.j41(5,"button",87),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss("Cross click"))}),e.k0s()(),e.j41(6,"div",88),e.nrm(7,"ngx-ui-loader",89),e.j41(8,"form",90,6),e.bIt("submit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.OnStatusSubmit())}),e.j41(10,"div",28)(11,"div",91)(12,"label",107),e.EFF(13,"sales.requestPersonSales.requestPersonStatus"),e.k0s(),e.j41(14,"ng-select",108),e.nI1(15,"translate"),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.requestPersonStatus,i)||(a.form.requestPersonStatus=i),e.Njj(i)}),e.k0s()(),e.DNE(16,Gr,4,1,"div",109),e.k0s(),e.j41(17,"div",100)(18,"button",110),e.nrm(19,"i",102)(20,"span",103),e.k0s()()()()()}if(2&r){const t=e.sdS(9),n=e.XpG();e.R7$(4),e.JRh(n.titleOperation),e.R7$(3),e.Y8G("hasProgressBar",!1)("fgsType",n.loaderOperationShap)("loaderId",n.operationLoader),e.R7$(7),e.FS9("placeholder",e.bMT(15,10,"sales.requestPersonSales.requestPersonStatus")),e.Y8G("items",n.status)("multiple",!1),e.R50("ngModel",n.form.requestPersonStatus),e.R7$(2),e.Y8G("ngIf",30==n.form.requestPersonStatus),e.R7$(2),e.Y8G("disabled",!t.valid)}}function $r(r,s){if(1&r){const t=e.RV6();e.j41(0,"client-summary",113),e.bIt("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("clientId",t.operationId)}}let Br=(()=>{class r extends X.w{constructor(t,n,i,a,o,l,h,x,y,I,j){super(t,n,h,i,a,o,l),this.baseService=i,this.excelService=y,this.clientService=I,this.employeeService=j,this.title="sales.requestPersonSales.title",this.titleOperation="sales.requestPersonSales.titleOperation",this.searchForm={},this.isResolveList=!0,this.countLoad=2,this.clientParam={pageSize:50,pageNumber:1,search:"",clientId:null},this.clients=[],this.loading=!1,this.searchClient=new ne.B,this.status=[],this.requestStatus={all:0,pending:0,underReview:0,accept:0,reject:0},this.option={startVal:0,useEasing:!0,duration:2,decimalPlaces:0},this.salesPersons=[],this.setDates=(T,b,C)=>{if(T?.from||T?.to){const F=T.to||T.from;this.pagination[b]=this.datePipe.transform(T.from||T.to,"yyyy-MM-ddT00:00:00"),this.pagination[C]=this.datePipe.transform(F,"yyyy-MM-ddT23:59:59.999")}else this.pagination[b]=null,this.pagination[C]=null},this.configRoute(),this.GetSalesPersons()}ngOnInitMore(){this.GetRequestCount(),this.searchClient.pipe((0,ve.B)(300),(0,Se.F)(),(0,ae.n)(t=>this.loadClient(t))).subscribe(),this.GetRequestLookups()}GetSalesPersons(){this.employeeService.GetAllByType(9).subscribe(t=>{this.salesPersons=t.data},t=>{console.log(t)})}GetRequestCount(){this.baseService.GetRequestCount().pipe((0,m.Q)(this.notifier)).subscribe(t=>{this.requestStatus=t.data})}GetRequestLookups(){this.baseService.GetRequestLookups().pipe((0,m.Q)(this.notifier)).subscribe(t=>{let n=t.data.status;n.forEach(i=>{i.name=this.getTranslationText("sales.salesOrder."+i.name)}),this.status=n})}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader("allLoader"),this.setDates(t.creationDates,"dateFrom","dateTo"),this.loadentities()}loadClient(t){return this.loading=!0,""==t||null==t?(this.loading=!1,(0,ge.of)([])):this.getClientDropdwon(t)}getClientDropdwon(t=""){return this.clientParam.search=t,this.clientParam.clientId=null,this.clientParam.pageNumber=1,this.clientService.GetClientSearch(this.clientParam).pipe((0,ae.n)(n=>(this.clients=n.data,this.loading=!1,[])),(0,m.Q)(this.notifier))}mapForm(t){return{...t}}mapRegisterForm(t){let n={...t};return n.id=0,n}OnSearch(t){this.ngxLoader.startLoader(u.a7),this.loadentities()}configRoute(){}EditModel(t,n,i="md"){this.isEditForm=!0,this.baseService.getById(t).pipe((0,m.Q)(this.notifier)).subscribe(a=>{a.success?(this.clientParam.clientId=a.data.clientId,this.clientParam.search="",this.clientService.GetClientSearch(this.clientParam).pipe((0,m.Q)(this.notifier)).subscribe(o=>{this.clients=o.data}),this.form=a.data):this.alertService.error("general.message."+a.message),this.modalService.open(n,{centered:!0,size:i})},a=>{this.alertService.error()})}mapExcel(){let t=[];return this.entities?.forEach(n=>{t.push({nameAr:n.nameAr,nameEn:n.nameEn,isActive:this.getTranslationText("general.table.active"),notes:n.notes})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.getTranslationText(this.title),[])}editEntity(){let t=this.mapForm(this.form);this.baseService.editPut(t.id,t).pipe((0,v.O)(),(0,R.c)(this.mainDelay),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(n=>{n.success?this.submitFunished():this.alertService.error("general.message."+n.message)},n=>{this.alertService.error("general.message."+n)})}scrollClient(){this.clientParam.pageNumber=this.clientParam.pageNumber+1,this.clientService.GetClientSearch(this.clientParam).subscribe(t=>{this.clients=[...this.clients,...t.data]})}getStatus(t){return 10==t||20==t?"bg-warning-subtle text-warning":30==t?"bg-success-subtle text-success":40==t?"bg-danger-subtle text-danger":"bg-warning-subtle text-warning"}OnStatusSubmit(){let t={requestPersonStatus:this.form.requestPersonStatus,id:this.operationId,cost:this.form.cost?this.form.cost:0};this.ngxLoader.start(u.ZW),this.baseService.UpdateLimit(t).pipe((0,v.O)(),(0,R.c)(this.mainDelay),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader(u.ZW))).subscribe(n=>{n.success?(this.alertService.success(),this.modalService.dismissAll(),this.loadentities(),this.GetRequestCount()):this.alertService.error("general.message."+n.message)},n=>{this.alertService.error("general.message."+n)})}onStatusSelect(t){this.pagination.requestPersonStatus=0==t?null:t,this.loadentities()}Send(t){this.baseService.Send(t).pipe((0,v.O)(),(0,R.c)(this.mainDelay),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(n=>{n.success?this.submitFunished():this.alertService.error("general.message."+n.message)},n=>{this.alertService.error("general.message."+n)})}static{this.\u0275fac=function(n){return new(n||r)(e.rXU(M.nX),e.rXU(g.c$),e.rXU(Ve.u),e.rXU(E.u),e.rXU(p.vh),e.rXU(w.eD),e.rXU(_.Bq),e.rXU(e.gRc),e.rXU(H.V),e.rXU(oe.X),e.rXU(K.O))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-requestPersonSales"]],features:[e.Vt3],decls:86,vars:44,consts:[["tableMaster",""],["operation",""],["deleteModal",""],["operationStatus",""],["ClientInfo",""],["tooltipContent",""],["formEntity","ngForm"],["cost","ngModel"],["notes","ngModel"],[3,"title","breadcrumbItems"],[1,"row","justify-content-around"],[1,"col-12","col-md-3","cursor-pointer"],[1,"card","card-animate",3,"click"],[1,"card-body"],[1,"d-flex","justify-content-between"],["translate","sales.salesOrder.all",1,"fw-medium","text-muted","mb-0"],[1,"mt-4","ff-secondary","fw-semibold"],[1,"counter-value",3,"countUp","options"],[1,"avatar-sm","flex-shrink-0"],[1,"avatar-title","bg-primary-subtle","text-primary","rounded-circle","fs-4"],[1,"ri-ticket-2-line"],[1,"col-12","col-md-2","cursor-pointer"],["translate","sales.salesOrder.UnderReview",1,"fw-medium","text-muted","mb-0"],[1,"avatar-title","bg-warning-subtle","text-warning","rounded-circle","fs-4"],["translate","sales.salesOrder.Accept",1,"fw-medium","text-muted","mb-0"],[1,"avatar-title","bg-success-subtle","text-success","rounded-circle","fs-4"],["translate","sales.salesOrder.Reject",1,"fw-medium","text-muted","mb-0"],[1,"avatar-title","bg-danger-subtle","text-danger","rounded-circle","fs-4"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],[3,"reset","search","exportXlsx","addNew","addPermission","totalItems","title"],["control",""],[1,"col-md-3","mb-2"],[1,"search-box"],["type","search","id","name","name","name",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],[1,"col-12","col-md-3","mb-2"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"col-12","col-md-2","mb-2"],["name","name","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["translate","",2,"width",".5%"],["pSortableColumn","clientId","translate","",2,"width","15%"],[1,"ri-expand-up-down-line"],["pSortableColumn","creationTime","translate","",2,"width","12%"],["translate","",2,"width","8%"],["pSortableColumn","cost","translate","",2,"width","10%"],["pSortableColumn","requestPersonStatus","translate","",2,"width","8%"],["pSortableColumn","notes","translate","",2,"width","10%"],["translate","",2,"width","15%"],[1,"fs-5"],[3,"click"],["href","javascript:void(0)",1,"link-primary","link-offset-2","text-decoration-underline","link-underline-opacity-25","link-underline-opacity-100-hover"],[3,"translate"],["tooltipPosition","top",1,"mdi","mdi-cog-outline","text-muted","fs-16","align-middle","me-1",3,"ngbTooltip"],["class","btn btn-sm btn-soft-warning edit-list mx-2 ",3,"click",4,"hasPermission"],[4,"ngIf"],[1,"ri-history-fill","text-warning"],[1,"ri-history-fill","text-danger"],[1,"ri-user-location-fill","text-primary"],[1,"btn","btn-sm","btn-soft-warning","edit-list","mx-2",3,"click"],[1,"ri-exchange-line","align-bottom","mx-1"],["class","btn btn-sm btn-soft-info edit-list mx-2",3,"click",4,"hasPermission"],["class","btn btn-sm btn-warning edit-list mx-1","tooltipPosition","top",3,"pTooltip","click",4,"hasPermission"],[1,"btn","btn-sm","btn-soft-info","edit-list","mx-2",3,"click"],[1,"ri-pencil-fill","align-bottom","mx-1"],["tooltipPosition","top",1,"btn","btn-sm","btn-warning","edit-list","mx-1",3,"click","pTooltip"],[1,"ri-send-plane-fill","align-bottom"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["class","fw-bold fs-4","translate","",4,"ngIf"],["translate",""],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"hasProgressBar","fgsType","loaderId"],[3,"submit"],[1,"mb-3"],["for","nameAr","translate","",1,"required","fw-bold","form-label"],["bindLabel","displayName","bindValue","id","name","clientId","required","",3,"scrollToEnd","ngModelChange","virtualScroll","items","typeahead","loading","multiple","ngModel"],[1,"mb-2"],["for","cost","translate","",1,"fw-bold","form-label"],["InputTirmFilter","","name","cost","type","text","id","cost",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["class","text-danger text-center  ","translate","",4,"ngIf"],["for","notes","translate","",1,"fw-bold","form-label"],["rows","2","InputTirmFilter","","name","notes","type","text","id","notes",1,"form-control","fs-6",3,"ngModelChange","ngModel"],[1,"text-center"],["type","submit","type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],["translate","",1,"fw-bold","fs-4"],["translate","",1,"text-danger","text-center"],[3,"deleteConfirm","dismiss"],["for","status","translate","",1,"required","fw-bold","form-label"],["name","name","bindValue","id","bindLabel","name","required","",3,"ngModelChange","placeholder","items","multiple","ngModel"],["class","mb-3",4,"ngIf"],["type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],["for","cost","translate","",1,"required","fw-bold","form-label"],["type","numbers","id","cost","name","cost",1,"form-control",3,"ngModelChange","ngModel"],[3,"dismiss","clientId"]],template:function(n,i){if(1&n){const a=e.RV6();e.nrm(0,"app-breadcrumbs",9),e.nI1(1,"translate"),e.j41(2,"div",10)(3,"div",11)(4,"div",12),e.bIt("click",function(){return e.eBV(a),e.Njj(i.onStatusSelect(0))}),e.j41(5,"div",13)(6,"div",14)(7,"div"),e.nrm(8,"p",15),e.j41(9,"h2",16),e.nrm(10,"span",17),e.k0s()(),e.j41(11,"div")(12,"div",18)(13,"span",19),e.nrm(14,"i",20),e.k0s()()()()()()(),e.j41(15,"div",21)(16,"div",12),e.bIt("click",function(){return e.eBV(a),e.Njj(i.onStatusSelect(20))}),e.j41(17,"div",13)(18,"div",14)(19,"div"),e.nrm(20,"p",22),e.j41(21,"h2",16),e.nrm(22,"span",17),e.k0s()(),e.j41(23,"div")(24,"div",18)(25,"span",23),e.nrm(26,"i",20),e.k0s()()()()()()(),e.j41(27,"div",21)(28,"div",12),e.bIt("click",function(){return e.eBV(a),e.Njj(i.onStatusSelect(30))}),e.j41(29,"div",13)(30,"div",14)(31,"div"),e.nrm(32,"p",24),e.j41(33,"h2",16),e.nrm(34,"span",17),e.k0s()(),e.j41(35,"div")(36,"div",18)(37,"span",25),e.nrm(38,"i",20),e.k0s()()()()()()(),e.j41(39,"div",21)(40,"div",12),e.bIt("click",function(){return e.eBV(a),e.Njj(i.onStatusSelect(40))}),e.j41(41,"div",13)(42,"div",14)(43,"div"),e.nrm(44,"p",26),e.j41(45,"h2",16),e.nrm(46,"span",17),e.k0s()(),e.j41(47,"div")(48,"div",18)(49,"span",27),e.nrm(50,"i",20),e.k0s()()()()()()()(),e.j41(51,"div",28)(52,"div",29)(53,"div",30)(54,"base-filter",31),e.bIt("reset",function(){return e.eBV(a),e.Njj(i.onReset())})("search",function(){return e.eBV(a),e.Njj(i.onSearch())})("exportXlsx",function(){return e.eBV(a),e.Njj(i.onExportXlsx())})("addNew",function(){e.eBV(a);const l=e.sdS(79);return e.Njj(i.openModalTitle(l,"md"))}),e.qex(55,32),e.j41(56,"div",33)(57,"div",34)(58,"input",35),e.nI1(59,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.name,l)||(i.pagination.name=l),e.Njj(l)}),e.k0s(),e.nrm(60,"i",36),e.k0s()(),e.j41(61,"div",37)(62,"input",38),e.nI1(63,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.searchForm.creationDates,l)||(i.searchForm.creationDates=l),e.Njj(l)}),e.k0s()(),e.j41(64,"div",39)(65,"ng-select",40),e.nI1(66,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.salesPersonId,l)||(i.pagination.salesPersonId=l),e.Njj(l)}),e.k0s()(),e.j41(67,"div",39)(68,"ng-select",40),e.nI1(69,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.requestPersonStatus,l)||(i.pagination.requestPersonStatus=l),e.Njj(l)}),e.k0s()(),e.bVm(),e.k0s(),e.j41(70,"div",13)(71,"div",41)(72,"p-table",42,0),e.bIt("onLazyLoad",function(l){return e.eBV(a),e.Njj(i.tableChange(l))})("selectionChange",function(l){return e.eBV(a),e.Njj(i.onSelectionChange(l))}),e.DNE(74,Ir,21,0,"ng-template",43)(75,Or,24,17,"ng-template",44),e.k0s()(),e.DNE(76,Rr,2,0,"div",45)(77,Fr,6,8,"div",46),e.k0s()()()(),e.DNE(78,Dr,31,16,"ng-template",null,1,e.C5r)(80,Lr,1,0,"ng-template",null,2,e.C5r)(82,Pr,21,12,"ng-template",null,3,e.C5r)(84,$r,1,1,"ng-template",null,4,e.C5r)}2&n&&(e.FS9("title",e.bMT(1,33,i.title)),e.Y8G("breadcrumbItems",i.breadCrumbItems),e.R7$(10),e.Y8G("countUp",null==i.requestStatus?null:i.requestStatus.all)("options",i.option),e.R7$(12),e.Y8G("countUp",null==i.requestStatus?null:i.requestStatus.underReview)("options",i.option),e.R7$(12),e.Y8G("countUp",null==i.requestStatus?null:i.requestStatus.accept)("options",i.option),e.R7$(12),e.Y8G("countUp",null==i.requestStatus?null:i.requestStatus.reject)("options",i.option),e.R7$(8),e.Y8G("addPermission",e.lJ4(43,xr))("totalItems",i.pagination.totalItems)("title",i.title),e.R7$(4),e.FS9("placeholder",e.bMT(59,35,"general.table.name")),e.R50("ngModel",i.pagination.name),e.R7$(4),e.FS9("placeholder",e.bMT(63,37,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",i.searchForm.creationDates),e.R7$(3),e.FS9("placeholder",e.bMT(66,39,"sales.salesOrder.salsePerson")),e.Y8G("items",i.salesPersons)("multiple",!1),e.R50("ngModel",i.pagination.salesPersonId),e.R7$(3),e.FS9("placeholder",e.bMT(69,41,"sales.requestPersonSales.requestPersonStatus")),e.Y8G("items",i.status)("multiple",!1),e.R50("ngModel",i.pagination.requestPersonStatus),e.R7$(4),e.Y8G("value",i.entities)("rows",i.pagination.pageSize)("lazy",!0)("totalRecords",i.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",i.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",i.pagination.totalItems>0))},dependencies:[p.bT,d.qT,d.me,d.BC,d.cb,d.YS,d.vS,d.cV,_.s5,G.kL,te.G,_e.m,W.b,z.w,J.p,Z.g,ce.x,g.Mm,V.XI,q.Ei,V.Tg,w.Cv,P.vr,_.md,B.m,A.p,de.m,p.vh,g.D9],encapsulation:2})}}return r})();c(39974),c(85343),c(54360),c(58750);let De=(()=>{class r extends Ce.d{constructor(t){super(t,Y.c.apiUrl+"PriceList/")}UpdatePriceListItemUnit(t){return this.http.get(this.baseUrl+"UpdatePriceListItemUnit/"+t)}GetPriceListWithUnits(t){return this.http.get(this.baseUrl+"GetPriceListWithUnits/"+t)}EditPriceListItem(t){return this.http.post(this.baseUrl+"EditPriceListItem/",t)}static{this.\u0275fac=function(n){return new(n||r)(e.KVO(xe.Qq))}}static{this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var we=c(84205);const Ur=()=>["priceList.register"],zr=()=>["priceList.edit"],Qr=()=>["priceList.delete"];function Hr(r,s){1&r&&(e.j41(0,"tr",28)(1,"th",29),e.EFF(2,"#"),e.k0s(),e.j41(3,"th",30),e.nrm(4,"i",31),e.EFF(5," general.table.id "),e.k0s(),e.j41(6,"th",32),e.nrm(7,"i",31),e.EFF(8," sales.priceList.name "),e.k0s(),e.j41(9,"th",33),e.nrm(10,"i",31),e.EFF(11," sales.priceList.clientGroupName "),e.k0s(),e.j41(12,"th",34),e.nrm(13,"i",31),e.EFF(14," general.table.isActive "),e.k0s(),e.j41(15,"th",35),e.nrm(16,"i",31),e.EFF(17," sales.clientCollection.notes "),e.k0s(),e.nrm(18,"th",36),e.k0s())}function Wr(r,s){1&r&&e.nrm(0,"span",44)}function Jr(r,s){1&r&&e.nrm(0,"span",45)}function Zr(r,s){if(1&r&&(e.nrm(0,"i",46),e.EFF(1),e.nI1(2,"date"),e.nrm(3,"br")(4,"i",47),e.EFF(5),e.nI1(6,"date"),e.nrm(7,"br")(8,"i",48),e.EFF(9)),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",e.i5U(2,3,t.creationTime,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",e.i5U(6,6,t.lastModificationTime,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",t.creatorName," ")}}function Kr(r,s){if(1&r){const t=e.RV6();e.j41(0,"button",49),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,a=e.XpG();return e.Njj(a.goList(i.id))}),e.nrm(1,"i",50),e.k0s()}}function ea(r,s){if(1&r){const t=e.RV6();e.j41(0,"button",51),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,a=e.XpG(),o=e.sdS(24);return e.Njj(a.openModal(i.id,o))}),e.nrm(1,"i",52),e.k0s()}}function ta(r,s){if(1&r){const t=e.RV6();e.j41(0,"tr",37)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td",38),e.bIt("click",function(){const i=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.goList(i.id))}),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td"),e.DNE(10,Wr,1,0,"span",39)(11,Jr,1,0,"span",40),e.k0s(),e.j41(12,"td"),e.EFF(13),e.k0s(),e.j41(14,"td"),e.DNE(15,Zr,10,9,"ng-template",null,3,e.C5r),e.nrm(17,"i",41),e.DNE(18,Kr,2,0,"button",42)(19,ea,2,0,"button",43),e.k0s()()}if(2&r){const t=s.$implicit,n=s.rowIndex,i=e.sdS(16);e.R7$(2),e.JRh(n+1),e.R7$(2),e.JRh(t.id),e.R7$(2),e.JRh(t.name),e.R7$(2),e.JRh(t.clientGroupName),e.R7$(2),e.Y8G("ngIf",t.isActive),e.R7$(),e.Y8G("ngIf",!t.isActive),e.R7$(2),e.JRh(t.notes),e.R7$(4),e.Y8G("ngbTooltip",i),e.R7$(),e.Y8G("hasPermission",e.lJ4(10,zr)),e.R7$(),e.Y8G("hasPermission",e.lJ4(11,Qr))}}function ia(r,s){1&r&&(e.j41(0,"div",53),e.EFF(1," general.table.noData"),e.k0s())}function na(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",54)(1,"div",55),e.nrm(2,"ngb-pagination-info",56),e.j41(3,"table-length",57),e.bIt("lengthChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.ListItemChange(i))}),e.k0s()(),e.j41(4,"div",58)(5,"ngb-pagination",59),e.bIt("pageChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.pageChanged(i))}),e.mxI("pageChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.pagination.pageNumber,i)||(a.pagination.pageNumber=i),e.Njj(i)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function ra(r,s){1&r&&(e.j41(0,"span",91),e.EFF(1,"general.action.register "),e.k0s())}function aa(r,s){1&r&&(e.j41(0,"span",91),e.EFF(1,"general.action.edit "),e.k0s())}function sa(r,s){1&r&&(e.j41(0,"div",92),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function oa(r,s){1&r&&(e.j41(0,"div",92),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function la(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",60)(1,"div",61)(2,"h4",62),e.DNE(3,ra,2,0,"span",63)(4,aa,2,0,"span",63),e.j41(5,"span",64),e.EFF(6),e.k0s()(),e.j41(7,"button",65),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss("Cross click"))}),e.k0s()(),e.j41(8,"div",66),e.nrm(9,"ngx-ui-loader",67),e.j41(10,"form",68,4),e.bIt("submit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.OnSubmit())}),e.j41(12,"div",10)(13,"div",69)(14,"label",70),e.EFF(15,"sales.priceList.name"),e.k0s(),e.j41(16,"input",71,5),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.name,i)||(a.form.name=i),e.Njj(i)}),e.k0s(),e.DNE(18,sa,2,0,"div",72),e.k0s(),e.j41(19,"div",73)(20,"label",74),e.EFF(21,"sales.priceList.clientGroupName"),e.k0s(),e.j41(22,"ng-select",75,6),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.clientGroupId,i)||(a.form.clientGroupId=i),e.Njj(i)}),e.k0s(),e.DNE(24,oa,2,0,"div",76),e.k0s(),e.j41(25,"div",77)(26,"label",74),e.EFF(27,"sales.priceList.discountType"),e.k0s(),e.j41(28,"ng-select",78,7),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.discountType,i)||(a.form.discountType=i),e.Njj(i)}),e.k0s()(),e.j41(30,"div",77)(31,"label",79),e.EFF(32,"sales.priceList.discount"),e.k0s(),e.j41(33,"input",80,8),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.discount,i)||(a.form.discount=i),e.Njj(i)}),e.k0s()(),e.j41(35,"div",73)(36,"label",81),e.EFF(37,"sales.clientCollection.clientName"),e.k0s(),e.j41(38,"ng-select",82),e.bIt("scrollToEnd",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.scrollClient())}),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.clientId,i)||(a.form.clientId=i),e.Njj(i)}),e.k0s()(),e.j41(39,"div",77)(40,"label",83),e.EFF(41,"stores.storesUnits.isActive"),e.k0s(),e.j41(42,"p-inputSwitch",84),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.isActive,i)||(a.form.isActive=i),e.Njj(i)}),e.k0s()(),e.j41(43,"div",73)(44,"label",85),e.EFF(45,"sales.clientCollection.notes"),e.k0s(),e.j41(46,"textarea",86,9),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.notes,i)||(a.form.notes=i),e.Njj(i)}),e.k0s()(),e.j41(48,"div",87)(49,"button",88),e.nrm(50,"i",89)(51,"span",90),e.k0s()()()()()()}if(2&r){const t=e.sdS(11),n=e.sdS(17),i=e.sdS(23),a=e.XpG();e.R7$(3),e.Y8G("ngIf",!a.isEditForm),e.R7$(),e.Y8G("ngIf",a.isEditForm),e.R7$(2),e.JRh(a.titleOperation),e.R7$(3),e.Y8G("hasProgressBar",!1)("fgsType",a.loaderOperationShap)("loaderId",a.operationLoader),e.R7$(7),e.R50("ngModel",a.form.name),e.R7$(2),e.Y8G("ngIf",n.invalid&&n.touched),e.R7$(4),e.Y8G("items",a.clientGroups)("multiple",!1),e.R50("ngModel",a.form.clientGroupId),e.R7$(2),e.Y8G("ngIf",i.invalid&&i.touched),e.R7$(4),e.Y8G("items",a.discountTypes),e.R50("ngModel",a.form.discountType),e.R7$(5),e.R50("ngModel",a.form.discount),e.R7$(5),e.Y8G("virtualScroll",!0)("items",a.clients)("typeahead",a.searchClient)("loading",a.loading)("multiple",!1),e.R50("ngModel",a.form.clientId),e.R7$(4),e.R50("ngModel",a.form.isActive),e.R7$(4),e.R50("ngModel",a.form.notes),e.R7$(3),e.Y8G("disabled",!t.valid)}}function da(r,s){if(1&r){const t=e.RV6();e.j41(0,"delete-modal",93),e.bIt("deleteConfirm",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.DeleteConfirmSoft())})("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}}let ca=(()=>{class r extends X.w{constructor(t,n,i,a,o,l,h,x,y,I,j,T,b){super(t,n,h,i,a,o,l),this.baseService=i,this.excelService=y,this.clientService=I,this.clientGroupsService=j,this.offerOrderService=T,this.router=b,this.title="sales.priceList.title",this.titleOperation="sales.priceList.titleOperation",this.keySelected="",this.assignUsers=[],this.times=[],this.employees=[],this.searchForm={},this.isResolveList=!0,this.countLoad=2,this.clientParam={pageSize:50,pageNumber:1,search:"",clientId:null},this.clients=[],this.loading=!1,this.searchClient=new ne.B,this.clientGroups=[],this.discountTypes=[],this.setDates=(C,O,F)=>{if(C?.from||C?.to){const $=C.to||C.from;this.pagination[O]=this.datePipe.transform(C.from||C.to,"yyyy-MM-ddT00:00:00"),this.pagination[F]=this.datePipe.transform($,"yyyy-MM-ddT23:59:59.999")}else this.pagination[O]=null,this.pagination[F]=null},this.configRoute(),this.discountTypes=this.offerOrderService.discountTypes,this.discountTypes.forEach(C=>{C.name=this.getTranslationText("sales.salesOrder."+C.name)})}ngOnInitMore(){this.searchClient.pipe((0,ve.B)(300),(0,Se.F)(),(0,ae.n)(t=>this.loadClient(t))).subscribe(),this.getClientGroups()}getClientGroups(){this.clientGroupsService.getDropDown().subscribe({next:t=>{this.clientGroups=t.data}})}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader("allLoader"),this.setDates(t.creationDates,"dateFrom","dateTo"),this.loadentities()}loadClient(t){return this.loading=!0,""==t||null==t?(this.loading=!1,(0,ge.of)([])):this.getClientDropdwon(t)}getClientDropdwon(t=""){return this.clientParam.search=t,this.clientParam.clientId=null,this.clientParam.pageNumber=1,this.clientService.GetClientSearch(this.clientParam).pipe((0,ae.n)(n=>(this.clients=n.data,this.loading=!1,[])))}mapForm(t){let n={...t};return n.clientId>0&&(n.clientGroupId=null),n}mapRegisterForm(t){let n={...t};return n.clientId>0&&(n.clientGroupId=null),n.id=0,n}OnSearch(t){this.ngxLoader.startLoader(u.a7),this.loadentities()}configRoute(){}EditModel(t,n,i="md"){this.isEditForm=!0,this.baseService.getById(t).pipe((0,m.Q)(this.notifier)).subscribe(a=>{a.success?(this.clientParam.clientId=a.data.clientId,this.clientParam.search="",this.clientService.GetClientSearch(this.clientParam).subscribe(o=>{this.clients=o.data}),this.form=a.data):this.alertService.error("general.message."+a.message),this.modalService.open(n,{centered:!0,size:i})},a=>{this.alertService.error()})}mapExcel(){let t=[];return this.entities?.forEach(n=>{t.push({nameAr:n.nameAr,nameEn:n.nameEn,isActive:this.getTranslationText("general.table.active"),notes:n.notes})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.getTranslationText(this.title),[])}editEntity(){let t=this.mapForm(this.form);this.baseService.editPut(t.id,t).pipe((0,v.O)(),(0,R.c)(this.mainDelay),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(n=>{n.success?this.submitFunished():this.alertService.error("general.message."+n.message)},n=>{this.alertService.error("general.message."+n)})}scrollClient(){this.clientParam.pageNumber=this.clientParam.pageNumber+1,this.clientService.GetClientSearch(this.clientParam).subscribe(t=>{this.clients=[...this.clients,...t.data]})}goList(t){this.router.navigateByUrl("/sales/PriceListItems/"+t)}goRegister(){this.router.navigateByUrl("/sales/PriceListItems")}static{this.\u0275fac=function(n){return new(n||r)(e.rXU(M.nX),e.rXU(g.c$),e.rXU(De),e.rXU(E.u),e.rXU(p.vh),e.rXU(w.eD),e.rXU(_.Bq),e.rXU(e.gRc),e.rXU(H.V),e.rXU(oe.X),e.rXU(we.t),e.rXU(U.A),e.rXU(M.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-priceList"]],features:[e.Vt3],decls:25,vars:20,consts:[["tableMaster",""],["operation",""],["deleteModal",""],["tooltipContent",""],["formEntity","ngForm"],["name","ngModel"],["clientGroupId","ngModel"],["discountType","ngModel"],["discount","ngModel"],["notes","ngModel"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],[3,"reset","search","exportXlsx","addNew","addPermission","totalItems","title"],["control",""],[1,"col-md-4","mb-2"],[1,"search-box"],["type","search","id","name","name","name",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],[1,"col-12","col-md-3","mb-2"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["translate","",2,"width",".5%"],["pSortableColumn","code","translate","",2,"width","3%"],[1,"ri-expand-up-down-line"],["pSortableColumn","paymentTypeName","translate","",2,"width","10%"],["pSortableColumn","clientGroupId","translate","",2,"width","12%"],["pSortableColumn","isActive","translate","",2,"width","6%"],["pSortableColumn","notes","translate","",2,"width","8%"],["translate","",2,"width","12%"],[1,"fs-5"],[3,"click"],["class","badge bg-success-subtle text-success p-2","translate","general.table.active",4,"ngIf"],["class","badge bg-danger-subtle text-danger p-2","translate","general.table.noActive",4,"ngIf"],["tooltipPosition","top",1,"mdi","mdi-cog-outline","text-muted","fs-16","align-middle","me-1",3,"ngbTooltip"],["class","btn btn-sm btn-soft-info edit-list mx-2",3,"click",4,"hasPermission"],["class","btn btn-sm btn-soft-danger remove-list",3,"click",4,"hasPermission"],["translate","general.table.active",1,"badge","bg-success-subtle","text-success","p-2"],["translate","general.table.noActive",1,"badge","bg-danger-subtle","text-danger","p-2"],[1,"ri-history-fill","text-warning"],[1,"ri-history-fill","text-danger"],[1,"ri-user-location-fill","text-primary"],[1,"btn","btn-sm","btn-soft-info","edit-list","mx-2",3,"click"],[1,"ri-pencil-fill","align-bottom","mx-1"],[1,"btn","btn-sm","btn-soft-danger","remove-list",3,"click"],[1,"ri-delete-bin-5-fill","align-bottom"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["class","fw-bold fs-4","translate","",4,"ngIf"],["translate",""],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"hasProgressBar","fgsType","loaderId"],[3,"submit"],[1,"col-12"],["for","name","translate","",1,"fw-bold","form-label"],["InputTirmFilter","","name","name","type","text","id","name","required","",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["class","text-danger text-center  ","translate","",4,"ngIf"],[1,"col-12","my-1"],["translate","",1,"fw-bold","form-label","w-100"],["name","clientGroupId","id","clientGroupId","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","ngModel"],["class","text-danger text-center","translate","",4,"ngIf"],[1,"col-12","col-md-6"],["clearable","false","clearOnBackspace","false","name","discountType","bindValue","id","bindLabel","name",2,"width","100%",3,"ngModelChange","items","ngModel"],["for","discount","translate","",1,"fw-bold","form-label"],["InputTirmFilter","","name","name","type","number","id","discount",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["for","nameAr","translate","",1,"fw-bold","form-label"],["bindLabel","displayName","bindValue","id","name","clientId",3,"scrollToEnd","ngModelChange","virtualScroll","items","typeahead","loading","multiple","ngModel"],["for","isActive","translate","",1,"fw-bold","form-label","d-block"],["id","isActive","name","isActive","inputId","isActive",3,"ngModelChange","ngModel"],["for","notes","translate","",1,"fw-bold","form-label"],["rows","1","InputTirmFilter","","name","notes","type","text","id","notes",1,"form-control","fs-6",3,"ngModelChange","ngModel"],[1,"text-center"],["type","submit","type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],["translate","",1,"fw-bold","fs-4"],["translate","",1,"text-danger","text-center"],[3,"deleteConfirm","dismiss"]],template:function(n,i){if(1&n){const a=e.RV6();e.j41(0,"div",10)(1,"div",11)(2,"div",12)(3,"base-filter",13),e.bIt("reset",function(){return e.eBV(a),e.Njj(i.onReset())})("search",function(){return e.eBV(a),e.Njj(i.onSearch())})("exportXlsx",function(){return e.eBV(a),e.Njj(i.onExportXlsx())})("addNew",function(){return e.eBV(a),e.Njj(i.goRegister())}),e.qex(4,14),e.j41(5,"div",15)(6,"div",16)(7,"input",17),e.nI1(8,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.name,l)||(i.pagination.name=l),e.Njj(l)}),e.k0s(),e.nrm(9,"i",18),e.k0s()(),e.j41(10,"div",19)(11,"input",20),e.nI1(12,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.searchForm.creationDates,l)||(i.searchForm.creationDates=l),e.Njj(l)}),e.k0s()(),e.bVm(),e.k0s(),e.j41(13,"div",21)(14,"div",22)(15,"p-table",23,0),e.bIt("onLazyLoad",function(l){return e.eBV(a),e.Njj(i.tableChange(l))})("selectionChange",function(l){return e.eBV(a),e.Njj(i.onSelectionChange(l))}),e.DNE(17,Hr,19,0,"ng-template",24)(18,ta,20,12,"ng-template",25),e.k0s()(),e.DNE(19,ia,2,0,"div",26)(20,na,6,8,"div",27),e.k0s()()()(),e.DNE(21,la,52,24,"ng-template",null,1,e.C5r)(23,da,1,0,"ng-template",null,2,e.C5r)}2&n&&(e.R7$(3),e.Y8G("addPermission",e.lJ4(19,Ur))("totalItems",i.pagination.totalItems)("title",i.title),e.R7$(4),e.FS9("placeholder",e.bMT(8,15,"general.table.name")),e.R50("ngModel",i.pagination.name),e.R7$(4),e.FS9("placeholder",e.bMT(12,17,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",i.searchForm.creationDates),e.R7$(4),e.Y8G("value",i.entities)("rows",i.pagination.pageSize)("lazy",!0)("totalRecords",i.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",i.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",i.pagination.totalItems>0))},dependencies:[p.bT,d.qT,d.me,d.Q0,d.BC,d.cb,d.YS,d.vS,d.cV,_.s5,G.kL,W.b,z.w,J.p,Z.g,g.Mm,V.XI,q.Ei,V.Tg,me.HW,w.Cv,P.vr,_.md,B.m,A.p,p.vh,g.D9],encapsulation:2})}}return r})(),ma=(()=>{class r extends je.E{constructor(t,n,i){super(t,n,i)}static{this.\u0275fac=function(n){return new(n||r)(e.KVO(M.Ix),e.KVO(Be.F),e.KVO(E.u))}}static{this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var he=c(86865),fe=c(62984);const pa=(r,s)=>({"max-height":r,"overflow-y":s}),ua=()=>["assignTruckOrder.changeStatus"],ga=()=>["assignTruckOrder.print"],_a=()=>["assignTruckOrder.finish"];function ha(r,s){1&r&&(e.j41(0,"span",63),e.nrm(1,"i",64),e.EFF(2),e.nI1(3,"translate"),e.k0s()),2&r&&(e.R7$(2),e.SpI(" ",e.bMT(3,1,"orderManagement.order.noMap")," "))}function fa(r,s){if(1&r&&(e.j41(0,"a",65),e.nrm(1,"i",64),e.EFF(2),e.nI1(3,"translate"),e.k0s()),2&r){const t=e.XpG().$implicit,n=e.XpG();e.Y8G("href",n.mapUrl(t.lng,t.lat),e.B4B),e.R7$(2),e.SpI(" ",e.bMT(3,2,"orderManagement.order.viewMap")," ")}}function ba(r,s){if(1&r&&(e.qex(0),e.j41(1,"div",66)(2,"div",67)(3,"div",25)(4,"span",68),e.EFF(5),e.k0s(),e.j41(6,"span",69),e.EFF(7),e.k0s()(),e.j41(8,"div")(9,"span",70),e.EFF(10),e.k0s(),e.j41(11,"span",63),e.EFF(12),e.k0s()()()(),e.bVm()),2&r){const t=s.$implicit,n=s.index;e.R7$(5),e.JRh(n+1),e.R7$(2),e.JRh(t.itemName),e.R7$(3),e.JRh(t.unitName),e.R7$(2),e.JRh(t.quantity)}}function va(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",71)(1,"div",72)(2,"button",73),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,a=e.XpG(),o=e.sdS(28);return e.Njj(a.openChangeStatusModal(i,o))}),e.nrm(3,"i",74),e.j41(4,"span",75),e.EFF(5),e.nI1(6,"translate"),e.k0s(),e.j41(7,"span",76),e.EFF(8,"orderManagement.order.changeTeamStatus"),e.k0s()()()()}2&r&&(e.R7$(5),e.JRh(e.bMT(6,1,"orderManagement.order.changeTeamStatus")))}function Sa(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",77)(1,"div",72)(2,"button",78),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,a=e.XpG();return e.Njj(a.PrintOrderReceived(i.offerOrderMasterId))}),e.nrm(3,"i",79),e.j41(4,"span",75),e.EFF(5),e.nI1(6,"translate"),e.k0s(),e.j41(7,"span",76),e.EFF(8,"general.action.print"),e.k0s()()()()}2&r&&(e.R7$(5),e.JRh(e.bMT(6,1,"general.action.print")))}function Ca(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",81)(1,"button",82),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2).$implicit,a=e.XpG(),o=e.sdS(30);return e.Njj(a.openFinishedModal(i.id,o,"md"))}),e.nrm(2,"i",83),e.j41(3,"span",75),e.EFF(4),e.nI1(5,"translate"),e.k0s(),e.j41(6,"span",76),e.EFF(7,"orderManagement.order.finishOrder"),e.k0s()()()}2&r&&(e.R7$(4),e.JRh(e.bMT(5,1,"orderManagement.order.finishOrder")))}function xa(r,s){1&r&&(e.qex(0),e.DNE(1,Ca,8,3,"div",80),e.bVm()),2&r&&(e.R7$(),e.Y8G("hasPermission",e.lJ4(1,_a)))}function ya(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",21)(1,"div",22)(2,"div",23)(3,"bdi")(4,"span")(5,"span"),e.EFF(6),e.nI1(7,"translate"),e.k0s()()(),e.j41(8,"div",24)(9,"div",25),e.nrm(10,"i",26),e.j41(11,"div")(12,"h4",27),e.EFF(13),e.k0s(),e.j41(14,"small",28),e.EFF(15),e.k0s()()()(),e.j41(16,"div",29)(17,"div",17)(18,"div",30)(19,"div",31),e.nrm(20,"i",32),e.j41(21,"strong"),e.EFF(22,"\u0627\u0644\u0634\u0627\u062d\u0646\u0629:"),e.k0s(),e.EFF(23),e.k0s(),e.j41(24,"div"),e.nrm(25,"i",33),e.j41(26,"strong"),e.EFF(27,"\u0627\u0644\u0633\u0627\u0626\u0642:"),e.k0s(),e.EFF(28),e.k0s()(),e.j41(29,"div",30)(30,"div",31),e.nrm(31,"i",34),e.j41(32,"strong"),e.EFF(33,"\u0627\u0644\u062a\u0627\u0631\u064a\u062e:"),e.k0s(),e.EFF(34),e.nI1(35,"date"),e.k0s(),e.j41(36,"div"),e.nrm(37,"i",35),e.j41(38,"strong"),e.EFF(39,"\u0631\u0642\u0645 \u0627\u0644\u0634\u0627\u062d\u0646\u0629:"),e.k0s(),e.EFF(40),e.k0s()()()(),e.j41(41,"div",36)(42,"span",37),e.nrm(43,"i",38),e.EFF(44),e.k0s(),e.j41(45,"span",39),e.nrm(46,"i",40),e.EFF(47),e.k0s()(),e.j41(48,"div",41)(49,"div",42),e.nrm(50,"i",43),e.j41(51,"span",44),e.bIt("click",function(){const i=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.copytext(i.mobile))}),e.EFF(52),e.nrm(53,"i",45),e.k0s()(),e.j41(54,"div"),e.DNE(55,ha,4,3,"span",46)(56,fa,4,4,"a",47),e.k0s()(),e.j41(57,"div",48)(58,"div",49)(59,"h2",50)(60,"button",51),e.nrm(61,"i",52),e.EFF(62),e.nI1(63,"translate"),e.j41(64,"span",53),e.EFF(65),e.k0s()()(),e.j41(66,"div",54)(67,"div",55)(68,"div",56),e.DNE(69,ba,13,4,"ng-container",57),e.k0s()()()()(),e.j41(70,"div",58),e.DNE(71,va,9,3,"div",59),e.nrm(72,"div",60),e.DNE(73,Sa,9,3,"div",61)(74,xa,2,2,"ng-container",62),e.k0s()()()()}if(2&r){const t=s.$implicit;e.R7$(4),e.ZvI("ribbon ",t.trunckStatusName," round-shape"),e.R7$(2),e.JRh(e.bMT(7,31,"sales.salesOrder."+t.trunckStatusName)),e.R7$(7),e.JRh(t.clientName||"\u0627\u0633\u0645 \u0627\u0644\u0639\u0645\u064a\u0644 \u063a\u064a\u0631 \u0645\u062a\u0648\u0641\u0631"),e.R7$(2),e.JRh(t.clientCode||""),e.R7$(8),e.SpI(" ",t.shippingTruckName," "),e.R7$(5),e.SpI(" ",t.driverName," "),e.R7$(6),e.SpI(" ",e.i5U(35,33,t.deliveryDate,"yyyy-MM-dd HH:mm")," "),e.R7$(6),e.SpI(" ",t.shippingTruckNumber," "),e.R7$(4),e.SpI(" #SO#",t.offerOrderMasterId," "),e.R7$(3),e.SpI(" #SHO#",t.id," "),e.R7$(5),e.SpI(" ",t.mobile," "),e.R7$(3),e.Y8G("ngIf",!t.lng),e.R7$(),e.Y8G("ngIf",t.lng),e.R7$(),e.Mz_("id","accordionItems-",t.id,""),e.R7$(2),e.Mz_("id","heading-",t.id,""),e.R7$(),e.BMQ("data-bs-target","#collapse-"+t.id)("aria-controls","collapse-"+t.id),e.R7$(2),e.SpI(" ",e.bMT(63,36,"orderManagement.order.items")," "),e.R7$(3),e.JRh(t.details.length),e.R7$(),e.Y8G("id","collapse-"+t.id),e.BMQ("aria-labelledby","heading-"+t.id)("data-bs-parent","#accordionItems-"+t.id),e.R7$(),e.Y8G("ngStyle",e.l_i(38,pa,t.details.length>5?"250px":"none",t.details.length>5?"auto":"hidden")),e.R7$(2),e.Y8G("ngForOf",t.details),e.R7$(2),e.Y8G("hasPermission",e.lJ4(41,ua)),e.R7$(2),e.Y8G("hasPermission",e.lJ4(42,ga)),e.R7$(),e.Y8G("ngIf",50==t.trunckStatus)}}function Ia(r,s){1&r&&(e.j41(0,"div",84),e.EFF(1," general.table.noData "),e.k0s())}function ja(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",85)(1,"div",86),e.nrm(2,"ngb-pagination-info",87),e.j41(3,"table-length",88),e.bIt("lengthChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.ListItemChange(i))}),e.k0s()(),e.j41(4,"div",89)(5,"ngb-pagination",90),e.bIt("pageChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.pageChanged(i))}),e.mxI("pageChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.pagination.pageNumber,i)||(a.pagination.pageNumber=i),e.Njj(i)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function Ta(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",91)(1,"div",92)(2,"h4",93),e.nrm(3,"span",94),e.k0s(),e.j41(4,"button",95),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()(),e.j41(5,"div",96),e.nrm(6,"ngx-ui-loader",97),e.j41(7,"form",98,2),e.bIt("ngSubmit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.changeStatus())}),e.j41(9,"div",17)(10,"div",99)(11,"label",100),e.EFF(12,"sales.salesOrder.trunckStatus"),e.k0s(),e.j41(13,"ng-select",101),e.nI1(14,"translate"),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.trunckStatus,i)||(a.form.trunckStatus=i),e.Njj(i)}),e.k0s()()(),e.j41(15,"div",102)(16,"button",103),e.nrm(17,"i",104)(18,"span",105),e.k0s()()()()()}if(2&r){const t=e.sdS(8),n=e.XpG();e.R7$(6),e.Y8G("hasProgressBar",!1)("fgsType",n.loaderOperationShap)("loaderId",n.operationLoader),e.R7$(7),e.FS9("placeholder",e.bMT(14,8,"orderManagement.order.changeTeamStatus")),e.Y8G("items",n.statusList)("multiple",!1),e.R50("ngModel",n.form.trunckStatus),e.R7$(3),e.Y8G("disabled",!t.valid)}}function ka(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",118)(1,"i",119),e.bIt("click",function(){const i=e.eBV(t),a=i.$implicit,o=i.index,l=e.XpG(2);return e.Njj(l.removeImage(a.id,o))}),e.k0s(),e.j41(2,"div",120),e.nrm(3,"img",121),e.k0s()()}if(2&r){const t=s.$implicit,n=e.XpG(2);e.R7$(3),e.Y8G("src",0==t.id?t.path:n.serverPath+t.path,e.B4B)}}function wa(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",92)(1,"h4",93),e.nrm(2,"span",106),e.k0s(),e.j41(3,"button",95),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()(),e.j41(4,"div",96)(5,"form",null,2),e.nrm(7,"ngx-ui-loader",97),e.j41(8,"div",107)(9,"div",108)(10,"div",109)(11,"div",110)(12,"button",111),e.bIt("click",function(){e.eBV(t);const i=e.sdS(17);return e.Njj(i.click())}),e.EFF(13," orderManagement.order.assignedOrders.select "),e.k0s(),e.j41(14,"div",112),e.DNE(15,ka,4,1,"div",113),e.k0s()(),e.j41(16,"input",114,3),e.bIt("change",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.onFileChanged(i))}),e.k0s()(),e.j41(18,"div",115)(19,"button",116),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.finishOrder())}),e.k0s(),e.j41(20,"button",117),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()()()()()()}if(2&r){const t=e.XpG();e.R7$(7),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader),e.R7$(8),e.Y8G("ngForOf",t.images)}}let Ma=(()=>{class r extends X.w{constructor(t,n,i,a,o,l,h,x,y,I,j){super(t,n,x,i,o,l,h),this.baseService=i,this.salesInvoicesService=a,this.authDaamService=y,this.excelService=I,this._formDataService=j,this.title="sales.assignTruckOrder.title",this.titleOperation="sales.assignTruckOrder.title",this.config={infinite:!0,slidesToShow:5,slidesToScroll:1,autoplay:!1,arrows:!1},this.trunks=[],this.isFlagTime=!0,this.searchForm={},this.statusList=[],this.pagination={pageNumber:1,pageSize:30},this.images=[],this.serverPath=Y.c.mediaUrl,this.form={orderId:0,attachmens:[]},this.setDates=(T,b,C)=>{if(T?.from||T?.to){const F=T.to||T.from;this.pagination[b]=this.datePipe.transform(T.from||T.to,"yyyy-MM-ddT00:00:00"),this.pagination[C]=this.datePipe.transform(F,"yyyy-MM-ddT23:59:59.999")}else this.pagination[b]=null,this.pagination[C]=null}}loadentities(){this.ngxLoader.startLoader(u.a7),this.baseService.GetOrderAssignTrunk(this.pagination).pipe((0,m.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader(u.a7),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader(u.a7),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[]}ngOnInitMore(){this.loadentities(),this.checkStatus()}checkStatus(){let t=this.baseService.getTrunckStatus();t.forEach(n=>{n.name=this.getTranslationText("sales.salesOrder."+n.name)}),this.statusList=t}mapExcel(){let t=[];return this.entities.forEach(n=>{t.push({"Order Code":n.orderCode,"Created Date":n.createdDate,"City Name":n.cityName,"District Name":n.districtName?n.districtName:"--","Agent Name":n.agentName,Mobile:n.mobile,"Channel Name":n.channelName,"Assigned To":n.teamNames,Times:n.workTimes,"Visit Date":n.visitDate,Services:n.services})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader("allLoader"),this.setDates(t.dates,"visitDateFrom","visitDateTo"),this.setDates(t.creationDates,"creationTimeFrom","creationTimeTo"),this.loadentities()}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}openChangeStatusModal(t,n,i="md"){this.form={},this.form.trunckStatus=t.trunckStatus,this.form.id=t.id,this.modalService.open(n,{centered:!0,size:i})}changeStatus(){this.ngxLoader.startLoader(this.operationLoader),this.baseService.changeStatus({trunckStatus:this.form.trunckStatus,id:this.form.id}).pipe((0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(n=>{this.loadentities(),this.alertService.success(),this.modalService.dismissAll()},()=>{this.alertService.error()})}mapUrl(t,n){return null===t||null==n?"":`https://www.google.com/maps/dir//${n},${t}/@${n},${t},17z?hl=en-US`}SubmitFinishOrder(){this.ngxLoader.startLoader(this.operationLoader),this.salesInvoicesService.finishOrder(this.form.id).pipe((0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(t=>{this.loadentities(),this.alertService.success(),this.modalService.dismissAll()},()=>{this.alertService.error()})}PrintOrderReceived(t){this.ngxLoader.startLoader("searchLoader"),this.baseService.PrintOrderReceived(t).pipe((0,v.O)(),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader("searchLoader"))).subscribe(n=>{this.openUrl(n)},n=>{this.alertService.error("general.message."+n)})}openUrl(t){let n=new Blob([t],{type:t.type});var i=URL.createObjectURL(n);window.open(i,"_blank")}onFileChanged(t){if(t.target.files&&t.target.files[0]){let n=t.target.files.length;for(let i=0;i<n;i++){let a=new FileReader;this.form.attachmens.push({attachImage:t.target.files.item(i),type:"file"}),a.onload=o=>{this.images.push({id:0,path:o.target.result,completePath:o.target.result})},a.readAsDataURL(t.target.files[i])}}}removeImage(t,n){this.form.attachmens.splice(n,1),this.images.splice(n,1)}openFinishedModal(t,n,i="md"){this.form={},this.form.orderId=t,this.images=[],this.form.attachmens=[],this.modalService.open(n,{centered:!0,size:i})}finishOrder(){if(this.form.attachmens.length<=0)return void this.alertService.error("sales.assignTruckOrder.mustInsertFile");const t=new FormData;t.append("OrderId",this.form.orderId.toString()),this.form.attachmens.forEach(n=>{t.append("Attachmens",n.attachImage)}),this.ngxLoader.startLoader(u.Fq),this.salesInvoicesService.finishOrder(t).subscribe(n=>{this.ngxLoader.stopLoader(u.Fq),this.loadentities(),this.modalService.dismissAll()},n=>{console.log(n),this.ngxLoader.stopLoader(u.Fq)})}static{this.\u0275fac=function(n){return new(n||r)(e.rXU(M.nX),e.rXU(g.c$),e.rXU(he.B),e.rXU(ye.Q),e.rXU(E.u),e.rXU(p.vh),e.rXU(w.eD),e.rXU(_.Bq),e.rXU(fe.J),e.rXU(H.V),e.rXU(ke.Q))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["assign-truck-order"]],features:[e.Vt3],decls:31,vars:26,consts:[["changeStatusModal",""],["finishOrderModal",""],["formEntity","ngForm"],["FileInput",""],[1,"card"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[1,"card-body","p-0"],[3,"reset","search","exportXlsx","showAdd","showExport","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","search","id","agentName","name","agentName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["InputTirmFilter","","type","tel","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"col-12","col-md-4","mb-2"],["type","text","mwlFlatpickr","","id","isDate","mode","range",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"row"],["class","col-12 col-md-4 my-2",4,"ngFor","ngForOf"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row text-center px-1 py-1 overflow-hidden",4,"ngIf"],[1,"col-12","col-md-4","my-2"],[1,"card","ribbon-box","border","shadow-none","mb-lg-0","material-shadow","card-item"],[1,"card-body","p-3","d-flex","flex-column"],[1,"client-header","bg-light","p-3","rounded","mb-3"],[1,"d-flex","align-items-center"],[1,"ri-user-3-fill","text-primary","fs-4","me-3"],[1,"mb-0","text-primary"],[1,"text-muted"],[1,"order-info","mb-3","p-3","bg-light","rounded"],[1,"col-6"],[1,"mb-2"],[1,"ri-truck-line","text-muted","me-2"],[1,"ri-user-line","text-muted","me-2"],[1,"ri-calendar-2-fill","text-muted","me-2"],[1,"ri-numbers-line","text-muted","me-2"],[1,"ids-section","d-flex","justify-content-between","mb-3"],[1,"badge","bg-secondary"],[1,"ri-shopping-cart-line","me-1"],[1,"badge","bg-dark"],[1,"ri-file-list-line","me-1"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],[1,"phone-number"],[1,"ri-phone-fill","text-info","me-2"],[1,"cursor-pointer","text-primary","fw-medium",3,"click"],[1,"ri-clipboard-line","ms-1"],["class","badge bg-danger-subtle text-danger",4,"ngIf"],["target","_blank","class","badge bg-success-subtle text-success",3,"href",4,"ngIf"],[1,"accordion","accordion-flush",3,"id"],[1,"accordion-item","border-0"],[1,"accordion-header",3,"id"],["type","button","data-bs-toggle","collapse","aria-expanded","false",1,"accordion-button","collapsed","bg-light","p-2"],[1,"ri-list-check-2","me-2"],[1,"badge","bg-primary","ms-2"],[1,"accordion-collapse","collapse",3,"id"],[1,"accordion-body","p-0",3,"ngStyle"],[1,"list-group","list-group-flush"],[4,"ngFor","ngForOf"],[1,"row","mt-3","g-2","align-items-center"],["class","col-12 col-md-auto order-1",4,"hasPermission"],[1,"d-none","d-md-block","col"],["class","col-12 col-md-auto order-2",4,"hasPermission"],[4,"ngIf"],[1,"badge","bg-danger-subtle","text-danger"],[1,"ri-map-pin-line","me-1"],["target","_blank",1,"badge","bg-success-subtle","text-success",3,"href"],[1,"list-group-item","border-0","py-2","px-1"],[1,"d-flex","justify-content-between","align-items-center"],[1,"badge","bg-secondary","me-2"],[1,"text-truncate","text-wrap","text-break"],[1,"badge","bg-primary-subtle","text-primary","mx-1"],[1,"col-12","col-md-auto","order-1"],[1,"d-flex","d-md-block","justify-content-center"],[1,"btn","btn-sm","btn-success","w-100","py-2",3,"click"],[1,"ri-swap-line","me-1"],[1,"d-none","d-sm-inline"],["translate","",1,"d-inline","d-sm-none"],[1,"col-12","col-md-auto","order-2"],[1,"btn","btn-sm","btn-info","w-100","py-2",3,"click"],[1,"ri-printer-fill","me-1"],["class","col-12 col-md-4 order-3 mt-2 mt-md-0 mx-md-auto",4,"hasPermission"],[1,"col-12","col-md-4","order-3","mt-2","mt-md-0","mx-md-auto"],[1,"btn","btn-sm","btn-primary","w-100","py-2",3,"click"],[1,"ri-checkbox-circle-fill","me-1"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","text-center","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["translate","orderManagement.order.changeTeamStatus",1,"fw-bold","fs-4"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"hasProgressBar","fgsType","loaderId"],[3,"ngSubmit"],[1,"mb-3"],["for","trunckStatus","translate","",1,"fw-bold","form-label"],["name","trunckStatus","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],[1,"text-center"],["type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],["translate","orderManagement.order.finishOrder",1,"fw-bold","fs-4"],[1,"modal-content"],[1,"modal-body","p-1"],[1,"col-12","col-lg-12","d-flex"],[1,"w-75"],["translate","",1,"btn","btn-warning","px-5",3,"click"],[1,"my-3","d-flex"],["class","avatar-lg mx-2 position-relative",4,"ngFor","ngForOf"],["multiple","","value","","type","file","accept","image/png, image/gif, image/jpeg",1,"form-control","d-none",3,"change"],[1,"d-flex","gap-2","justify-content-center","my-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger",3,"click"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],[1,"avatar-lg","mx-2","position-relative"],[1,"position-absolute","bx","bx-x-circle","text-white",2,"background","red","top","1px","right","-4px","font-size","1rem","border-radius","50%",3,"click"],[1,"avatar-title","bg-light","rounded"],["id","product-img1","alt","",1,"avatar-md","h-auto",3,"src"]],template:function(n,i){if(1&n){const a=e.RV6();e.j41(0,"div",4),e.nrm(1,"ngx-ui-loader",5),e.j41(2,"div",6)(3,"base-filter",7),e.bIt("reset",function(){return e.eBV(a),e.Njj(i.onReset())})("search",function(){return e.eBV(a),e.Njj(i.onSearch())})("exportXlsx",function(){return e.eBV(a),e.Njj(i.onExportXlsx())}),e.qex(4,8),e.j41(5,"div",9)(6,"div",10)(7,"input",11),e.nI1(8,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.orderCode,l)||(i.pagination.orderCode=l),e.Njj(l)}),e.k0s(),e.nrm(9,"i",12),e.k0s()(),e.j41(10,"div",9)(11,"div",10)(12,"input",13),e.nI1(13,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.agentName,l)||(i.pagination.agentName=l),e.Njj(l)}),e.k0s(),e.nrm(14,"i",12),e.k0s()(),e.j41(15,"div",9)(16,"div",10)(17,"input",14),e.nI1(18,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.mobile,l)||(i.pagination.mobile=l),e.Njj(l)}),e.k0s(),e.nrm(19,"i",12),e.k0s()(),e.j41(20,"div",15)(21,"input",16),e.nI1(22,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.searchForm.creationDates,l)||(i.searchForm.creationDates=l),e.Njj(l)}),e.k0s()(),e.bVm(),e.k0s()()(),e.j41(23,"div",17),e.DNE(24,ya,75,43,"div",18),e.k0s(),e.DNE(25,Ia,2,0,"div",19)(26,ja,6,8,"div",20)(27,Ta,19,10,"ng-template",null,0,e.C5r)(29,wa,21,4,"ng-template",null,1,e.C5r)}2&n&&(e.R7$(),e.Y8G("loaderId","searchLoader"),e.R7$(2),e.Y8G("showAdd",!1)("showExport",!1)("totalItems",i.pagination.totalItems)("title",i.title),e.R7$(4),e.FS9("placeholder",e.bMT(8,18,"orderManagement.order.orderCode")),e.R50("ngModel",i.pagination.orderCode),e.R7$(5),e.FS9("placeholder",e.bMT(13,20,"orderManagement.order.agentName")),e.R50("ngModel",i.pagination.agentName),e.R7$(5),e.FS9("placeholder",e.bMT(18,22,"orderManagement.order.mobile")),e.R50("ngModel",i.pagination.mobile),e.R7$(4),e.FS9("placeholder",e.bMT(22,24,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",i.searchForm.creationDates),e.R7$(3),e.Y8G("ngForOf",i.entities),e.R7$(),e.Y8G("ngIf",i.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",i.pagination.totalItems>0))},dependencies:[p.Sq,p.bT,p.B3,d.qT,d.me,d.Q0,d.BC,d.cb,d.vS,d.cV,_.s5,G.kL,W.b,J.p,Z.g,g.Mm,w.Cv,P.vr,B.m,A.p,p.vh,g.D9],encapsulation:2})}}return r})();var qe=c(54384);const Oa=()=>["priceList.updatePrice"];function Ra(r,s){1&r&&(e.j41(0,"div",36),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function Fa(r,s){1&r&&(e.j41(0,"div",36),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function Va(r,s){if(1&r){const t=e.RV6();e.j41(0,"button",38),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.addAllItems())}),e.nrm(1,"i",32)(2,"span",39),e.k0s()}if(2&r){e.XpG(2);const t=e.sdS(7);e.Y8G("disabled",!t.valid)}}function Ea(r,s){if(1&r&&(e.qex(0),e.DNE(1,Va,3,1,"button",37),e.bVm()),2&r){const t=e.XpG();e.R7$(),e.Y8G("ngIf",t.listId)}}function Na(r,s){1&r&&(e.j41(0,"tr",50)(1,"th",51),e.EFF(2,"#"),e.k0s(),e.j41(3,"th",52),e.EFF(4," sales.priceList.itemName "),e.k0s(),e.j41(5,"th",52),e.EFF(6," sales.priceList.unitName "),e.k0s(),e.j41(7,"th",53),e.EFF(8," sales.priceList.itemPrice "),e.k0s(),e.j41(9,"th",53),e.EFF(10," sales.priceList.listPrice "),e.k0s()())}function Da(r,s){if(1&r){const t=e.RV6();e.j41(0,"tr",54)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td")(10,"input",55),e.nI1(11,"translate"),e.mxI("ngModelChange",function(i){const a=e.eBV(t).rowIndex,o=e.XpG(2);return e.DH7(o.form[a].price,i)||(o.form[a].price=i),e.Njj(i)}),e.k0s()()()}if(2&r){const t=s.$implicit,n=s.rowIndex,i=e.XpG(2);e.R7$(2),e.JRh(n+1),e.R7$(2),e.JRh(t.itemName),e.R7$(2),e.JRh(t.unitName),e.R7$(2),e.JRh(t.itemPrice),e.R7$(2),e.FS9("placeholder",e.bMT(11,6,"sales.priceList.price")),e.R50("ngModel",i.form[n].price)}}function La(r,s){1&r&&(e.j41(0,"div",56),e.EFF(1," general.table.noData "),e.k0s())}function Ga(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",47)(1,"a",57),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.Save())}),e.nrm(2,"i",49),e.j41(3,"span"),e.EFF(4),e.nI1(5,"translate"),e.k0s()()()}2&r&&(e.R7$(4),e.JRh(e.bMT(5,1,"general.action.save")))}function Pa(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",8)(1,"div",9)(2,"div",10),e.nrm(3,"ngx-ui-loader",11),e.j41(4,"div",40)(5,"p-table",41,6),e.DNE(7,Na,11,0,"ng-template",42)(8,Da,12,8,"ng-template",43),e.k0s()(),e.DNE(9,La,2,0,"div",44),e.j41(10,"div",45),e.DNE(11,Ga,6,3,"div",46),e.j41(12,"div",47)(13,"a",48),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.back())}),e.nrm(14,"i",49),e.j41(15,"span"),e.EFF(16),e.nI1(17,"translate"),e.k0s()()()()()()()}if(2&r){const t=e.XpG();e.R7$(3),e.Y8G("loaderId",t.searchLoader),e.R7$(2),e.Y8G("value",t.form)("rows",null==t.form?null:t.form.length),e.R7$(4),e.Y8G("ngIf",(null==t.form?null:t.form.length)<=0),e.R7$(2),e.Y8G("ngIf",(null==t.form?null:t.form.length)>0),e.R7$(5),e.JRh(e.bMT(17,6,"general.action.back"))}}let Ye=(()=>{class r extends X.w{constructor(t,n,i,a,o,l,h,x,y,I,j){super(t,n,h,o,i,a,l),this.baseService=o,this.service=x,this.clientGroupsService=y,this.offerOrderService=I,this.router=j,this.title="sales.priceList.priceListItems",this.submitted=!1,this.pagination={pageNumber:1,pageSize:1e3},this.form=[],this.formMaster={},this.listId=0,this.clientGroups=[],this.discountTypes=[]}ngOnInitMore(){this.listId=this.routerActive.snapshot.paramMap.get("id"),this.listId&&this.GetById(),this.loadentities(),this.getClientGroups(),this.discountTypes=this.offerOrderService.discountTypes,this.discountTypes.forEach(t=>{t.name=this.getTranslationText("sales.salesOrder."+t.name)})}GetById(){this.baseService.getById(this.listId).pipe((0,m.Q)(this.notifier)).subscribe(t=>{t.success?(this.isEditForm=!0,this.formMaster=t.data):this.alertService.error("general.message."+t.message)},t=>{this.alertService.error()})}getClientGroups(){this.clientGroupsService.getDropDown().subscribe({next:t=>{this.clientGroups=t.data}})}addAllItems(){this.ngxLoader.startLoader(u.a7),this.baseService.UpdatePriceListItemUnit(this.listId).pipe((0,m.Q)(this.notifier)).subscribe(t=>{this.LoadSuccess(),this.loadentities(),this.ngxLoader.stopLoader(u.a7)},t=>{this.ngxLoader.stopLoader(u.a7),this.alertService.error(t)})}Save(){let t=[];this.form.forEach(n=>{t.push({id:n.id,UnitId:n.unitId,itemId:n.itemId,priceListMasterId:n.priceListMasterId,price:n.price})}),this.ngxLoader.startLoader(this.searchLoader),this.baseService.EditPriceListItem(t).pipe((0,v.O)(),(0,R.c)(this.mainDelay),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader(this.searchLoader)),(0,pe.W)(n=>(0,ue.$)(n))).subscribe(n=>{n.success?this.submitFunished():this.alertService.error("general.message."+n.message)},n=>{this.alertService.error("general.message."+n)})}loadentities(){this.baseService.GetPriceListWithUnits(this.listId).pipe((0,m.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader(u.a7),this.form=t.data,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader(u.a7),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[]}back(){this.router.navigate(["/sales/Prices-List/"])}OnSubmit(){this.ngxLoader.startLoader(this.operationLoader),!0===this.isEditForm?this.editEntity():this.registerEntity()}submitFunished(){this.alertService.success(),this.ngxLoader.stop(u.a7),this.ngxLoader.stop(u.ZW),this.btnDisabled=!0}registerEntity(){this.ngxLoader.startLoader(this.operationLoader);let t=this.mapRegisterForm(this.formMaster);this.baseService.register(t).pipe((0,v.O)(),(0,R.c)(this.mainDelay),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader(this.operationLoader)),(0,pe.W)(n=>(0,ue.$)(n))).subscribe(n=>{n.success?(this.goList(n.data),this.submitFunished()):this.alertService.error("general.message."+n.message)},n=>{this.alertService.error("general.message."+n)})}editEntity(){this.ngxLoader.startLoader(this.operationLoader);let t=this.mapForm(this.formMaster);this.baseService.edit(t.id,t).pipe((0,v.O)(),(0,R.c)(this.mainDelay),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(n=>{n.success?this.submitFunished():this.alertService.error("general.message."+n.message)},n=>{this.alertService.error("general.message."+n)})}goList(t){this.router.navigateByUrl("/sales/PriceListItems/"+t)}static{this.\u0275fac=function(n){return new(n||r)(e.rXU(M.nX),e.rXU(g.c$),e.rXU(E.u),e.rXU(p.vh),e.rXU(De),e.rXU(w.eD),e.rXU(_.Bq),e.rXU(qe.m),e.rXU(we.t),e.rXU(U.A),e.rXU(M.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-priceList-operation"]],features:[e.Vt3],decls:46,vars:20,consts:[["formEntity","ngForm"],["namess","ngModel"],["clientGroupId","ngModel"],["discountType","ngModel"],["discount","ngModel"],["notes","ngModel"],["tableMaster",""],[3,"title","breadcrumbItems"],[1,"row"],[1,"card","grid"],[1,"card-body"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"submit"],[1,"col-12","col-md-3"],["for","name","translate","",1,"fw-bold","form-label"],["InputTirmFilter","","id","name","name","name","type","text","id","name","required","",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["class","text-danger text-center  ","translate","",4,"ngIf"],[1,"col-12","col-md-2"],["translate","",1,"fw-bold","form-label","w-100"],["name","clientGroupId","id","clientGroupId","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","ngModel"],["class","text-danger text-center","translate","",4,"ngIf"],["clearable","false","clearOnBackspace","false","name","discountType","bindValue","id","bindLabel","name",2,"width","100%",3,"ngModelChange","items","ngModel"],[1,"col-12","col-md-1"],["for","discount","translate","",1,"fw-bold","form-label"],["InputTirmFilter","","name","discount","type","number","id","discount",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["for","isActive","translate","",1,"fw-bold","form-label","d-block"],["id","isActive","name","isActive","inputId","isActive",3,"ngModelChange","ngModel"],[1,"col-12","col-md-2","my-1"],["for","notes","translate","",1,"fw-bold","form-label"],["rows","1","InputTirmFilter","","name","notes","type","text","id","notes",1,"form-control","fs-6",3,"ngModelChange","ngModel"],[1,"text-center"],["type","submit","type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],[4,"hasPermission"],["class","row",4,"ngIf"],["translate","",1,"text-danger","text-center"],["type","submit","class","btn btn-success btn-label waves-effect waves-light rounded-pill mx-2",3,"disabled","click",4,"ngIf"],["type","submit",1,"btn","btn-success","btn-label","waves-effect","waves-light","rounded-pill","mx-2",3,"click","disabled"],["translate","sales.priceList.UpdateItems"],[1,"table-responsive"],["dataKey","id",3,"value","rows"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],[1,"row","justify-content-center","py-2"],["class","text-center text-danger text-bold fs-6  col-2",4,"ngIf"],[1,"text-center","text-danger","text-bold","fs-6","col-2"],[1,"btn","btn-dark",3,"click"],[1,"ri-check-double-fill","align-bottom"],[1,""],["translate","",2,"width",".5%"],["translate","",2,"width","30%"],["translate","",2,"width","10%"],[1,"fs-5"],["type","number",1,"form-control","text-center",3,"ngModelChange","placeholder","ngModel"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],["href","javascript:void(0);",1,"btn","btn-success",3,"click"]],template:function(n,i){if(1&n){const a=e.RV6();e.nrm(0,"app-breadcrumbs",7),e.nI1(1,"translate"),e.j41(2,"div",8)(3,"div",9)(4,"div",10),e.nrm(5,"ngx-ui-loader",11),e.j41(6,"form",12,0),e.bIt("submit",function(){return e.eBV(a),e.Njj(i.OnSubmit())}),e.j41(8,"div",8)(9,"div",13)(10,"label",14),e.EFF(11,"sales.priceList.name"),e.k0s(),e.j41(12,"input",15,1),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.formMaster.name,l)||(i.formMaster.name=l),e.Njj(l)}),e.k0s(),e.DNE(14,Ra,2,0,"div",16),e.k0s(),e.j41(15,"div",17)(16,"label",18),e.EFF(17,"sales.priceList.clientGroupName"),e.k0s(),e.j41(18,"ng-select",19,2),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.formMaster.clientGroupId,l)||(i.formMaster.clientGroupId=l),e.Njj(l)}),e.k0s(),e.DNE(20,Fa,2,0,"div",20),e.k0s(),e.j41(21,"div",17)(22,"label",18),e.EFF(23,"sales.priceList.discountType"),e.k0s(),e.j41(24,"ng-select",21,3),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.formMaster.discountType,l)||(i.formMaster.discountType=l),e.Njj(l)}),e.k0s()(),e.j41(26,"div",22)(27,"label",23),e.EFF(28,"sales.priceList.discount"),e.k0s(),e.j41(29,"input",24,4),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.formMaster.discount,l)||(i.formMaster.discount=l),e.Njj(l)}),e.k0s()(),e.j41(31,"div",22)(32,"label",25),e.EFF(33,"stores.storesUnits.isActive"),e.k0s(),e.j41(34,"p-inputSwitch",26),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.formMaster.isActive,l)||(i.formMaster.isActive=l),e.Njj(l)}),e.k0s()(),e.j41(35,"div",27)(36,"label",28),e.EFF(37,"sales.clientCollection.notes"),e.k0s(),e.j41(38,"textarea",29,5),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.formMaster.notes,l)||(i.formMaster.notes=l),e.Njj(l)}),e.k0s()(),e.j41(40,"div",30)(41,"button",31),e.nrm(42,"i",32)(43,"span",33),e.k0s(),e.DNE(44,Ea,2,1,"ng-container",34),e.k0s()()()()()(),e.DNE(45,Pa,18,8,"div",35)}if(2&n){const a=e.sdS(7),o=e.sdS(13),l=e.sdS(19);e.FS9("title",e.bMT(1,17,i.title)),e.Y8G("breadcrumbItems",i.breadCrumbItems),e.R7$(5),e.Y8G("loaderId",i.operationLoader),e.R7$(7),e.R50("ngModel",i.formMaster.name),e.R7$(2),e.Y8G("ngIf",o.invalid&&o.touched),e.R7$(4),e.Y8G("items",i.clientGroups)("multiple",!1),e.R50("ngModel",i.formMaster.clientGroupId),e.R7$(2),e.Y8G("ngIf",l.invalid&&l.touched),e.R7$(4),e.Y8G("items",i.discountTypes),e.R50("ngModel",i.formMaster.discountType),e.R7$(5),e.R50("ngModel",i.formMaster.discount),e.R7$(5),e.R50("ngModel",i.formMaster.isActive),e.R7$(4),e.R50("ngModel",i.formMaster.notes),e.R7$(3),e.Y8G("disabled",!a.valid),e.R7$(3),e.Y8G("hasPermission",e.lJ4(19,Oa)),e.R7$(),e.Y8G("ngIf",i.listId)}},dependencies:[p.bT,d.qT,d.me,d.Q0,d.BC,d.cb,d.YS,d.vS,d.cV,_e.m,g.Mm,V.XI,q.Ei,me.HW,w.Cv,P.vr,B.m,A.p,g.D9],encapsulation:2})}}return r})(),$a=(()=>{class r extends je.E{constructor(t,n,i){super(t,n,i)}static{this.\u0275fac=function(n){return new(n||r)(e.KVO(M.Ix),e.KVO(Ve.u),e.KVO(E.u))}}static{this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})(),Ba=(()=>{class r extends je.E{constructor(t,n,i){super(t,n,i)}static{this.\u0275fac=function(n){return new(n||r)(e.KVO(M.Ix),e.KVO(De),e.KVO(E.u))}}static{this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var Me=c(70053),Oe=c(69433),Xa=c(91020);let Re=(()=>{class r{constructor(t,n,i,a){this.cancelReasonService=t,this.orderService=n,this.ngxLoader=i,this.alertService=a,this.cancelReasons=[],this.form={},this.orderId=0,this.loaderOperationShap=u.$$,this.operationLoader=u.ZW,this.notifier=new ne.B,this.success=new e.bkB,this.dismiss=new e.bkB}ngOnInit(){this.GetReturnReasons()}GetReturnReasons(){this.cancelReasonService.getDropDown().subscribe(t=>{this.cancelReasons=t.data},t=>{console.log(t)})}onCancelOrder(){let t={cancelReasonId:this.form.cancelReasonCode,id:this.orderId};this.ngxLoader.startLoader(this.operationLoader),this.orderService.CancelOfferOrder(t).pipe((0,m.Q)(this.notifier)).subscribe(n=>{this.ngxLoader.stopLoader(this.operationLoader),n.success?(this.alertService.success(),this.success.emit(!0),this.dismiss.emit(!0)):this.alertService.error()},()=>{this.alertService.error(),this.ngxLoader.stopLoader(this.operationLoader)})}dismissFn(){this.dismiss.emit(!0)}static{this.\u0275fac=function(n){return new(n||r)(e.rXU(Xa.e),e.rXU(U.A),e.rXU(w.eD),e.rXU(E.u))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["cancel-sales-model"]],inputs:{orderId:"orderId"},outputs:{success:"success",dismiss:"dismiss"},decls:19,vars:10,consts:[["formEntity","ngForm"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["translate","orderManagement.order.cancelReasonName",1,"fw-bold","fs-4"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"hasProgressBar","fgsType","loaderId"],[3,"ngSubmit"],[1,"row"],[1,"mb-3"],["for","actionMismatch","translate","",1,"required","fw-bold","form-label"],["name","name","bindValue","code","bindLabel","name","required","",3,"ngModelChange","placeholder","items","multiple","ngModel"],[1,"text-center"],["type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"]],template:function(n,i){if(1&n){const a=e.RV6();e.j41(0,"div",1)(1,"div",2)(2,"h4",3),e.nrm(3,"span",4),e.k0s(),e.j41(4,"button",5),e.bIt("click",function(){return e.eBV(a),e.Njj(i.dismissFn())}),e.k0s()(),e.j41(5,"div",6),e.nrm(6,"ngx-ui-loader",7),e.j41(7,"form",8,0),e.bIt("ngSubmit",function(){return e.eBV(a),e.Njj(i.onCancelOrder())}),e.j41(9,"div",9)(10,"div",10)(11,"label",11),e.EFF(12,"orderManagement.order.cancelReasonName"),e.k0s(),e.j41(13,"ng-select",12),e.nI1(14,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.form.cancelReasonCode,l)||(i.form.cancelReasonCode=l),e.Njj(l)}),e.k0s()()(),e.j41(15,"div",13)(16,"button",14),e.nrm(17,"i",15)(18,"span",16),e.k0s()()()()()}if(2&n){const a=e.sdS(8);e.R7$(6),e.Y8G("hasProgressBar",!1)("fgsType",i.loaderOperationShap)("loaderId",i.operationLoader),e.R7$(7),e.FS9("placeholder",e.bMT(14,8,"orderManagement.order.cancelReasonName")),e.Y8G("items",i.cancelReasons)("multiple",!1),e.R50("ngModel",i.form.cancelReasonCode),e.R7$(3),e.Y8G("disabled",!a.valid)}},dependencies:[d.qT,d.BC,d.cb,d.YS,d.vS,d.cV,g.Mm,w.Cv,P.vr,g.D9],encapsulation:2})}}return r})();var Ue=c(57415);const be=r=>[r];function Aa(r,s){if(1&r&&(e.j41(0,"span"),e.nrm(1,"span",62),e.k0s()),2&r){const t=e.XpG(2);e.ZvI(" badge ",t.getStatus(t.form),""),e.R7$(),e.FS9("translate","sales.salesOrder."+t.form.offerOrderStatusName)}}function qa(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",15)(1,"label",22),e.EFF(2,"sales.salesOrder.clientDeliveryDate"),e.k0s(),e.j41(3,"input",63),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG(2);return e.DH7(a.form.clientVisitDate,i)||(a.form.clientVisitDate=i),e.Njj(i)}),e.k0s()()}if(2&r){const t=e.XpG(2);e.R7$(3),e.R50("ngModel",t.form.clientVisitDate),e.Y8G("altInput",!0)("enableTime",!0)("convertModelValue",!0)("dateFormat","Y-m-d H:i")}}function Ya(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",15),e.EFF(1),e.nrm(2,"label",64),e.j41(3,"ng-select",65),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG(2);return e.DH7(a.form.salsePersonId,i)||(a.form.salsePersonId=i),e.Njj(i)}),e.k0s()()}if(2&r){const t=e.XpG(2);e.R7$(),e.SpI(" ",t.form.offerOrderStatus," "),e.R7$(2),e.Y8G("disabled",t.isDraft)("items",t.employees),e.R50("ngModel",t.form.salsePersonId)}}function Ua(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",21)(1,"label",66),e.EFF(2,"sales.salesOrder.changeQuantityMessage"),e.k0s(),e.j41(3,"textarea",67,1),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG(2);return e.DH7(a.form.changeQuantityMessage,i)||(a.form.changeQuantityMessage=i),e.Njj(i)}),e.k0s()()}if(2&r){const t=e.XpG(2);e.R7$(3),e.Y8G("disabled",t.isDraft),e.R50("ngModel",t.form.changeQuantityMessage)}}function za(r,s){1&r&&e.nrm(0,"th",68)}function Qa(r,s){1&r&&e.nrm(0,"th",69)}function Ha(r,s){1&r&&e.nrm(0,"th",70)}function Wa(r,s){if(1&r){const t=e.RV6();e.j41(0,"td")(1,"input",77),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG().$implicit;return e.DH7(a.clientQuantity,i)||(a.clientQuantity=i),e.Njj(i)}),e.k0s()()}if(2&r){const t=e.XpG(),n=t.$implicit,i=t.$index;e.R7$(),e.Y8G("name","clientQuantity"+e.eq3(2,be,i)),e.R50("ngModel",n.clientQuantity)}}function Ja(r,s){if(1&r){const t=e.RV6();e.j41(0,"td")(1,"ng-select",72),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG().$index,o=e.XpG(2);return e.Njj(o.discountSelect(i,a,2))}),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG().$implicit;return e.DH7(a.discountType,i)||(a.discountType=i),e.Njj(i)}),e.k0s()()}if(2&r){const t=e.XpG(),n=t.$implicit,i=t.$index,a=e.XpG(2);e.R7$(),e.Y8G("name","discountType"+e.eq3(3,be,i))("items",a.discountTypes),e.R50("ngModel",n.discountType)}}function Za(r,s){if(1&r){const t=e.RV6();e.j41(0,"td")(1,"input",78),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG().$index,o=e.XpG(2);return e.Njj(o.discountSelect(i,a))}),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG().$implicit;return e.DH7(a.discount,i)||(a.discount=i),e.Njj(i)}),e.k0s()()}if(2&r){const t=e.XpG(),n=t.$implicit,i=t.$index;e.R7$(),e.Y8G("name","discount"+e.eq3(2,be,i)),e.R50("ngModel",n.discount)}}function Ka(r,s){if(1&r){const t=e.RV6();e.j41(0,"tr")(1,"td")(2,"ng-select",71),e.bIt("change",function(i){const a=e.eBV(t).$index,o=e.XpG(2);return e.Njj(o.itemSelected(i,a))}),e.mxI("ngModelChange",function(i){const a=e.eBV(t).$implicit;return e.DH7(a.itemId,i)||(a.itemId=i),e.Njj(i)}),e.k0s()(),e.j41(3,"td")(4,"ng-select",72),e.mxI("ngModelChange",function(i){const a=e.eBV(t).$implicit;return e.DH7(a.unitId,i)||(a.unitId=i),e.Njj(i)}),e.k0s()(),e.DNE(5,Wa,2,4,"td",73),e.j41(6,"td")(7,"input",74),e.bIt("ngModelChange",function(i){const a=e.eBV(t).$index,o=e.XpG(2);return e.Njj(o.quantitySelect(i,a))}),e.mxI("ngModelChange",function(i){const a=e.eBV(t).$implicit;return e.DH7(a.quantity,i)||(a.quantity=i),e.Njj(i)}),e.k0s()(),e.j41(8,"td"),e.EFF(9),e.k0s(),e.DNE(10,Ja,2,5,"td",73)(11,Za,2,4,"td",73),e.j41(12,"td"),e.EFF(13),e.k0s(),e.j41(14,"td")(15,"span",75),e.bIt("click",function(){const i=e.eBV(t).$index,a=e.XpG(2);return e.Njj(a.deleteRow(i))}),e.nrm(16,"i",76),e.k0s()()()}if(2&r){const t=s.$implicit,n=s.$index,i=e.XpG(2);e.R7$(2),e.Y8G("name","itemId"+e.eq3(13,be,n))("items",i.items),e.R50("ngModel",t.itemId),e.R7$(2),e.Y8G("name","unitId"+e.eq3(15,be,n))("items",t.units),e.R50("ngModel",t.unitId),e.R7$(),e.Y8G("ngIf",!(0==i.form.offerOrderStatus||5==i.form.offerOrderStatus)),e.R7$(2),e.Y8G("name","quantity"+e.eq3(17,be,n)),e.R50("ngModel",t.quantity),e.R7$(2),e.SpI(" ",t.price," "),e.R7$(),e.Y8G("ngIf",!i.isChangeQuantity&&!i.isDraft),e.R7$(),e.Y8G("ngIf",!i.isChangeQuantity&&!i.isDraft),e.R7$(2),e.SpI("",t.net," ")}}function es(r,s){if(1&r){const t=e.RV6();e.j41(0,"td",51)(1,"div",79)(2,"ng-select",80),e.bIt("change",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.getTotal())}),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG(2);return e.DH7(a.form.totalAddDiscountType,i)||(a.form.totalAddDiscountType=i),e.Njj(i)}),e.k0s(),e.j41(3,"input",81),e.bIt("change",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.getTotal())}),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG(2);return e.DH7(a.form.totalAddDiscount,i)||(a.form.totalAddDiscount=i),e.Njj(i)}),e.k0s()()()}if(2&r){const t=e.XpG(2);e.R7$(2),e.Y8G("disabled",t.isChangeQuantity)("items",t.discountTypes),e.R50("ngModel",t.form.totalAddDiscountType),e.R7$(),e.Y8G("disabled",t.isChangeQuantity),e.R50("ngModel",t.form.totalAddDiscount)}}function ts(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",3)(1,"div",4)(2,"h4",5)(3,"span",6),e.EFF(4),e.k0s(),e.j41(5,"span",7),e.EFF(6),e.k0s(),e.DNE(7,Aa,2,4,"span",8),e.k0s(),e.j41(8,"button",9),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.dismissFn())}),e.k0s()(),e.j41(9,"div",10),e.nrm(10,"ngx-ui-loader",11),e.j41(11,"form",12,0),e.bIt("submit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.orderFinished())}),e.j41(13,"div",13),e.DNE(14,qa,4,5,"div",14),e.j41(15,"div",15)(16,"label",16),e.EFF(17,"sales.salesOrder.acutalDeliveryDate"),e.k0s(),e.j41(18,"input",17),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.acutalVisitDate,i)||(a.form.acutalVisitDate=i),e.Njj(i)}),e.k0s()(),e.j41(19,"div",15),e.nrm(20,"label",18),e.j41(21,"ng-select",19),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.clientLocationId,i)||(a.form.clientLocationId=i),e.Njj(i)}),e.k0s()(),e.DNE(22,Ya,4,4,"div",14)(23,Ua,5,2,"div",20),e.j41(24,"div",21)(25,"label",22),e.EFF(26,"sales.salesOrder.terms"),e.k0s(),e.j41(27,"textarea",23),e.nI1(28,"translate"),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.terms,i)||(a.form.terms=i),e.Njj(i)}),e.k0s()()(),e.j41(29,"div",24)(30,"div",25)(31,"div",26)(32,"div",27),e.nrm(33,"h5",28),e.k0s()(),e.j41(34,"div",29)(35,"div",30)(36,"table",31)(37,"thead",32)(38,"tr"),e.nrm(39,"th",33)(40,"th",34),e.DNE(41,za,1,0,"th",35),e.nrm(42,"th",36)(43,"th",37),e.DNE(44,Qa,1,0,"th",38)(45,Ha,1,0,"th",39),e.nrm(46,"th",40)(47,"th",41),e.k0s()(),e.j41(48,"tbody",42),e.Z7z(49,Ka,17,19,"tr",null,e.Vm6),e.j41(51,"tr",43)(52,"td",44)(53,"span",45),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.addRow())}),e.nrm(54,"i",46)(55,"span",47),e.k0s()(),e.j41(56,"td",48)(57,"table",49)(58,"tbody")(59,"tr"),e.nrm(60,"td",50),e.j41(61,"td",51),e.EFF(62),e.k0s()(),e.j41(63,"tr"),e.nrm(64,"td",52),e.DNE(65,es,4,5,"td",53),e.k0s(),e.j41(66,"tr",54),e.nrm(67,"td",55),e.j41(68,"td",51),e.EFF(69),e.k0s()(),e.j41(70,"tr",56),e.nrm(71,"th",57),e.j41(72,"th",51),e.EFF(73),e.k0s()()()()()()()()()()()(),e.j41(74,"div",58)(75,"button",59),e.nrm(76,"i",60)(77,"span",61),e.k0s()()()()()}if(2&r){const t=e.sdS(12),n=e.XpG();e.R7$(4),e.SpI("#SO#",n.form.id," "),e.R7$(2),e.SpI("",n.form.clientName," "),e.R7$(),e.Y8G("ngIf",n.form.offerOrderStatus>=0),e.R7$(3),e.Y8G("hasProgressBar",!1)("fgsType",n.loaderOperationShap)("loaderId",n.operationLoader),e.R7$(4),e.Y8G("ngIf",!(0==n.form.offerOrderStatus||5==n.form.offerOrderStatus)),e.R7$(4),e.R50("ngModel",n.form.acutalVisitDate),e.Y8G("altInput",!0)("enableTime",!0)("convertModelValue",!0)("dateFormat","Y-m-d H:i"),e.R7$(3),e.Y8G("items",n.locations),e.R50("ngModel",n.form.clientLocationId),e.R7$(),e.Y8G("ngIf",!(0==n.form.offerOrderStatus||5==n.form.offerOrderStatus)),e.R7$(),e.Y8G("ngIf",5==n.form.offerOrderStatus),e.R7$(4),e.Y8G("placeholder",e.bMT(28,28,"sales.salesOrder.termsPlaceholder")),e.R50("ngModel",n.form.terms),e.R7$(14),e.Y8G("ngIf",!(0==n.form.offerOrderStatus||5==n.form.offerOrderStatus)),e.R7$(3),e.Y8G("ngIf",!n.isChangeQuantity&&!n.isDraft),e.R7$(),e.Y8G("ngIf",!n.isChangeQuantity&&!n.isDraft),e.R7$(4),e.Dyx(n.form.details),e.R7$(3),e.BMQ("colspan",0==n.form.offerOrderStatus||5==n.form.offerOrderStatus?3:4),e.R7$(4),e.BMQ("colspan",0==n.form.offerOrderStatus||5==n.form.offerOrderStatus?1:2),e.R7$(6),e.JRh(n.form.total),e.R7$(3),e.Y8G("ngIf",!(0==n.form.offerOrderStatus||5==n.form.offerOrderStatus)),e.R7$(4),e.JRh(n.form.tax),e.R7$(4),e.JRh(n.form.totalNet),e.R7$(2),e.Y8G("disabled",!t.valid)}}function is(r,s){1&r&&e.nrm(0,"span",83)}function ns(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",3)(1,"div",4)(2,"h4",5)(3,"p",82),e.nrm(4,"span",83),e.k0s()(),e.j41(5,"button",9),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.dismissFn())}),e.k0s()(),e.j41(6,"p",82),e.DNE(7,is,1,0,"span",84),e.k0s()()}if(2&r){const t=e.XpG();e.R7$(7),e.Y8G("ngForOf",t.repeat22)}}let Fe=(()=>{class r{constructor(t,n,i,a,o,l,h,x,y){this.translateService=t,this.offerOrderService=n,this.salesRequestService=i,this.itemsService=a,this.clientService=o,this.employeeService=l,this.alertService=h,this.datePipe=x,this.ngxLoader=y,this.orderSelected=0,this.isDraft=!1,this.isChangeQuantity=!1,this.isShipping=!1,this.isRequest=!1,this.loaderOperationShap=u.$$,this.operationLoader=u.ZW,this.form={},this.truncks=[],this.locations=[],this.discountTypes=[],this.items=[],this.employees=[],this.isHiden=!0,this.notifier=new ne.B,this.repeat22=Array.from({length:19}),this.dismiss=new e.bkB}ngOnInit(){this.GetPersones(),this.getItemsServices(),this.discountTypes=this.offerOrderService.discountTypes,this.discountTypes.forEach(t=>{t.name=this.getTranslationText("sales.salesOrder."+t.name)}),this.getOrder()}getItemsServices(){this.itemsService.getItemDropDown().subscribe(t=>{this.items=t.data})}getLocations(t){this.clientService.GetClientLocations(t).subscribe(n=>{this.locations=n.data})}GetPersones(){this.employeeService.GetAllByType(9).subscribe(t=>{this.employees=t.data})}getTranslationText(t){let n="";return this.translateService.get(t).pipe((0,m.Q)(this.notifier)).subscribe(i=>{n=i}),n}getOrder(){this.isRequest?this.getSalesRequestOrder():this.offerOrderService.GetOrderDetail(this.orderSelected).subscribe(t=>{this.isHiden=!1,this.form=t.data,this.getLocations(this.form.clientId),this.getTotal()},t=>{this.alertService.error(t)})}getSalesRequestOrder(){this.salesRequestService.GetOrderDetail(this.orderSelected).subscribe(t=>{this.isHiden=!1,this.form=t.data,this.getLocations(this.form.clientId),this.getTotal()},t=>{this.alertService.error(t)})}update(){}getTotal(){let t=0,n=0,i=0;this.form.details.forEach(a=>{a.discount<0&&(a.discoun=0);let o=a.quantity*a.price,l=0;1===a.discountType?l=a.discount:2===a.discountType&&(l=o*a.discount/100),n+=+l;let h=o-l;a.net=h.toFixed(2),t+=+h}),1===this.form.totalAddDiscountType?i=this.form.totalAddDiscount:2===this.form.totalAddDiscountType&&(i=t*this.form.totalAddDiscount/100),this.form.total=t,this.form.totalAddDiscount=this.form.totalAddDiscount,this.form.tax=15*this.form.total/100,this.form.totalNet=this.form.total-i+this.form.tax,this.form.total=this.form.total.toFixed(2),this.form.totalAddDiscount=this.form.totalAddDiscount.toFixed(2),this.form.tax=this.form.tax.toFixed(2),this.form.totalNet=this.form.totalNet.toFixed(2)}quantitySelect(t,n){t&&(t<=0&&(t=1),this.form.details[n].quantity=parseInt(t),this.form.details[n].net=this.form.details[n].price*this.form.details[n].quantity,this.discountSelect(this.form.details[n].discount,n),this.getTotal())}discountSelect(t,n,i=1){if(t){(t=parseInt(t))<=0&&(this.form.details[n].discount=0),1==i&&(this.form.details[n].discount=t);let a=0;1==this.form.details[n].discountType?a=this.form.details[n].discount:(a=this.form.details[n].price*this.form.details[n].quantity*this.form.details[n].discount/100,a=+a.toFixed(2)),this.form.details[n].net=this.form.details[n].price*this.form.details[n].quantity-a,this.form.details[n].net=this.form.details[n].net.toFixed(2),this.getTotal()}}dismissFn(){this.dismiss.emit(!0)}getStatus(t){return 10==t.offerOrderStatus||20==t.offerOrderStatus?"bg-warning-subtle text-warning":30==t.offerOrderStatus?"bg-success-subtle text-success":40==t.offerOrderStatus?"bg-danger-subtle text-danger":50==t.offerOrderStatus?"bg-danger-success text-success":"bg-warning-subtle text-warning"}addRow(){this.form.details.push({itemId:0,unitId:null,units:[],clientQuantity:1,quantity:1,priceUnit:null,discount:0,discountType:1,net:0})}itemSelected(t,n){t&&(this.form.details[n].unitId=t.units.length>0?t.units[0].id:null,this.form.details[n].units=t.units,this.form.details[n].price=t.price,this.quantitySelect(this.form.details[n].quantity,n),this.getTotal())}deleteRow(t){this.form.details.length<=1||(this.form.details.splice(t,1),this.getTotal())}orderFinished(){this.ngxLoader.startLoader("operationLoader"),this.isRequest?this.editSalesRequest():this.editSalesOrder()}editSalesRequest(){let t={id:this.form.id,clientId:this.form.clientId,clientVisitDate:this.datePipe.transform(this.form.clientVisitDate,"yyyy-MM-ddTHH:mm:ss.000"),acutalVisitDate:this.datePipe.transform(this.form.acutalVisitDate,"yyyy-MM-ddTHH:mm:ss.000"),offerOrderStatus:this.form.offerOrderStatus,notes:this.form.notes,terms:this.form.terms,changeQuantityMessage:this.form.changeQuantityMessage,salsePersonId:this.form.salsePersonId,clientLocationId:this.form.clientLocationId,totalAddDiscount:this.form.discountAmount,totalAddDiscountType:this.form.isPrecentage?2:1,salesRequestDetails:this.form.details.map(n=>({discount:n.discount,discountType:n.discountType,itemId:n.itemId,clientQuantity:n.clientQuantity,approvedQuantity:n.quantity,id:n.id,price:n.price,unitId:n.unitId,salesRequestMasterId:this.form.id}))};this.salesRequestService.edit(t.id,t).subscribe(n=>{n.success?(this.ngxLoader.stopLoader("operationLoader"),this.alertService.success()):(this.alertService.error(),this.ngxLoader.stopLoader("operationLoader"))},()=>{this.alertService.error(),this.ngxLoader.stopLoader("operationLoader")})}editSalesOrder(){let t={id:this.form.id,clientId:this.form.clientId,clientVisitDate:this.datePipe.transform(this.form.clientVisitDate,"yyyy-MM-ddTHH:mm:ss.000"),acutalVisitDate:this.datePipe.transform(this.form.acutalVisitDate,"yyyy-MM-ddTHH:mm:ss.000"),offerOrderStatus:this.form.offerOrderStatus,notes:this.form.notes,terms:this.form.terms,changeQuantityMessage:this.form.changeQuantityMessage,salsePersonId:this.form.salsePersonId,clientLocationId:this.form.clientLocationId,totalAddDiscount:this.form.discountAmount,totalAddDiscountType:this.form.isPrecentage?2:1,offerOrderDetails:this.form.details.map(n=>({discount:n.discount,discountType:n.discountType,itemId:n.itemId,clientQuantity:n.clientQuantity,approvedQuantity:n.quantity,id:n.id,price:n.price,unitId:n.unitId,offerOrderMasterId:this.form.id}))};this.offerOrderService.edit(t.id,t).subscribe(n=>{n.success?(this.ngxLoader.stopLoader("operationLoader"),this.alertService.success()):(this.alertService.error(),this.ngxLoader.stopLoader("operationLoader"))},()=>{this.alertService.error(),this.ngxLoader.stopLoader("operationLoader")})}ngOnDestroy(){this.notifier.next(),this.notifier.complete()}static{this.\u0275fac=function(n){return new(n||r)(e.rXU(g.c$),e.rXU(U.A),e.rXU(Ue.Z),e.rXU(Pe.N),e.rXU(oe.X),e.rXU(K.O),e.rXU(E.u),e.rXU(p.vh),e.rXU(w.eD))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["sales-edit-order"]],inputs:{orderSelected:"orderSelected",isDraft:"isDraft",isChangeQuantity:"isChangeQuantity",isShipping:"isShipping",isRequest:"isRequest"},outputs:{dismiss:"dismiss"},decls:2,vars:2,consts:[["formEntity","ngForm"],["notes","ngModel"],["class","modal-content border-0  ",4,"ngIf"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-dark-subtle"],[1,"card-title","mb-0"],[1,"badge","bg-primary-subtle","text-primary","fs-4"],[1,"badge","bg-danger-subtle","text-danger","fs-4","mx-2"],[3,"class",4,"ngIf"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"hasProgressBar","fgsType","loaderId"],[3,"submit"],[1,"row"],["class","col-12 col-md-3",4,"ngIf"],[1,"col-12","col-md-3"],["for","name","translate","",1,"required","fw-bold","form-label"],["name","acutalVisitDate","type","text","mwlFlatpickr","","altFormat","Y-m-d H:i","required","",1,"form-control","flatpickr-input",3,"ngModelChange","ngModel","altInput","enableTime","convertModelValue","dateFormat"],["for","name","translate","orderManagement.order.savedAddress",1,"required","fw-bold","form-label"],["name","clientLocationId","bindValue","id","bindLabel","name","required","",2,"width","100%",3,"ngModelChange","items","ngModel"],["class","col-12 col-md-6",4,"ngIf"],[1,"col-12","col-md-6"],["for","name","translate","",1,"fw-bold","form-label"],["rows","1","name","terms","type","text",1,"form-control",3,"ngModelChange","placeholder","ngModel"],[1,"row","justify-content-center","my-0"],[1,"card"],[1,"card-header","p-0"],[1,"d-flex","align-items-center"],["translate","sales.salesRequests.items",1,"card-title","flex-grow-1","mb-0"],[1,"card-body"],[1,"table-responsive","table-card"],[1,"table","table-nowrap","align-middle","table-borderless","mb-0"],[1,"table-light","text-muted","p-1"],["translate","sales.salesRequests.itemName",2,"width","20%"],["translate","sales.salesRequests.unit",2,"width","12%"],["style","width:10%","translate","sales.salesRequests.clientQuantity",4,"ngIf"],["translate","sales.salesRequests.quantity",2,"width","12%"],["translate","sales.salesRequests.priceUnit",2,"width","12%"],["style","width:12%","translate","sales.salesRequests.discountType",4,"ngIf"],["style","width:12%","translate","sales.salesRequests.discount",4,"ngIf"],["translate","sales.salesRequests.net",2,"width","12%"],[2,"width","5%"],[1,"body-orderEdit"],[1,"border-top","border-top-dashed"],[2,"vertical-align","top"],[1,"cursor-pointer","p-2","mb-0","badge","bg-success-subtle","text-success",3,"click"],[1,"ri-add-fill"],["translate","sales.salesRequests.addItem"],[1,"fw-medium","p-0"],[1,"table","table-borderless","mb-0"],["translate","sales.salesOrder.total",1,"m-0","p-0"],[1,"text-end","m-0","p-0"],["translate","sales.salesOrder.extraDiscount",1,"m-0","p-0"],["class","text-end m-0 p-0",4,"ngIf"],[1,"m-0","p-0"],["translate","sales.salesOrder.tax",1,"m-0","p-0"],[1,"border-top","border-top-dashed","m-0","p-0"],["scope","row","translate","sales.salesOrder.net",1,"m-0","p-0"],[1,"d-flex","justify-content-center","m-0"],["type","submit","type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],[3,"translate"],["name","clientVisitDate","type","text","mwlFlatpickr","","altFormat","Y-m-d H:i","required","",1,"form-control","flatpickr-input",3,"ngModelChange","ngModel","altInput","enableTime","convertModelValue","dateFormat"],["for","name","translate","sales.salesOrder.salsePerson",1,"fw-bold","form-label"],["name","salsePersonId","bindValue","id","bindLabel","name",2,"width","100%",3,"ngModelChange","disabled","items","ngModel"],["for","changeQuantityMessage","translate","",1,"fw-bold","form-label"],["rows","1","InputTirmFilter","","name","changeQuantityMessage","type","text","id","changeQuantityMessage",1,"form-control","fs-6",3,"ngModelChange","disabled","ngModel"],["translate","sales.salesRequests.clientQuantity",2,"width","10%"],["translate","sales.salesRequests.discountType",2,"width","12%"],["translate","sales.salesRequests.discount",2,"width","12%"],["clearable","false","clearOnBackspace","false","bindValue","id","bindLabel","name",2,"width","100%",3,"change","ngModelChange","name","items","ngModel"],["clearable","false","clearOnBackspace","false","bindValue","id","bindLabel","name",2,"width","100%",3,"ngModelChange","name","items","ngModel"],[4,"ngIf"],["type","text","id","quantity",1,"form-control","fs-6",3,"ngModelChange","name","ngModel"],[1,"cursor-pointer","mb-0","p-2","badge","bg-danger-subtle","text-danger",3,"click"],[1,"ri-delete-bin-2-fill"],["type","text","id","clientQuantity",1,"form-control","fs-6",3,"ngModelChange","name","ngModel"],["InputTirmFilter","","type","text","id","discount",1,"form-control","fs-6",3,"ngModelChange","name","ngModel"],[1,"input-group","mx-4","my-1",2,"width","80%"],["clearable","false","clearOnBackspace","false","name","totalAddDiscountType","bindValue","id","bindLabel","name",3,"change","ngModelChange","disabled","items","ngModel"],["InputTirmFilter","","name","totalAddDiscount","type","text","id","totalAddDiscount",1,"form-control","fs-6",2,"width","20%",3,"change","ngModelChange","disabled","ngModel"],[1,"card-text","placeholder-glow"],[1,"placeholder","col-12"],["class","placeholder col-12",4,"ngFor","ngForOf"]],template:function(n,i){1&n&&e.DNE(0,ts,78,30,"div",2)(1,ns,8,1,"div",2),2&n&&(e.Y8G("ngIf",!i.isHiden),e.R7$(),e.Y8G("ngIf",i.isHiden))},dependencies:[p.Sq,p.bT,d.qT,d.me,d.BC,d.cb,d.YS,d.vS,d.cV,G.kL,g.Mm,w.Cv,P.vr,B.m,g.D9],encapsulation:2})}}return r})();const rs=()=>["salesOrder.viewOrderCount"],as=()=>["salesOrder.register"],ss=()=>["salesOrderStore.assignTrunk"],os=()=>["salesOrder.sendApproval"],ls=()=>["salesOrder.sendStore"],ds=()=>["salesOrder.edit"],cs=()=>["salesOrder.changeQuantity"],ms=()=>["salesOrder.reopenOrder"],ps=()=>["salesOrder.cancel"],ze=r=>[r];function us(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",40),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.onSelectStatus(-1))}),e.j41(1,"div",41)(2,"div",51)(3,"div",43)(4,"div",52),e.nrm(5,"i",45),e.k0s()(),e.j41(6,"div",46)(7,"h5",47),e.EFF(8),e.k0s(),e.nrm(9,"p",53),e.k0s()()()()}if(2&r){const t=e.XpG(2);e.R7$(2),e.AVh("bg-primary-subtle",null==t.pagination.status),e.R7$(6),e.JRh(t.count.all)}}function gs(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",40),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.onSelectStatus(0))}),e.j41(1,"div",41)(2,"div",42)(3,"div",43)(4,"div",54),e.nrm(5,"i",45),e.k0s()(),e.j41(6,"div",46)(7,"h5",47),e.EFF(8),e.k0s(),e.nrm(9,"p",55),e.k0s()()()()}if(2&r){const t=e.XpG(2);e.R7$(),e.AVh("bg-primary-subtle",0==t.pagination.status),e.R7$(7),e.JRh(t.count.draft)}}function _s(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",40),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.onSelectStatus(5))}),e.j41(1,"div",41)(2,"div",42)(3,"div",43)(4,"div",54),e.nrm(5,"i",45),e.k0s()(),e.j41(6,"div",46)(7,"h5",47),e.EFF(8),e.k0s(),e.nrm(9,"p",56),e.k0s()()()()}if(2&r){const t=e.XpG(2);e.R7$(),e.AVh("bg-primary-subtle",5==t.pagination.status),e.R7$(7),e.JRh(t.count.changeQuantity)}}function hs(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",40),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.onSelectStatus(20))}),e.j41(1,"div",41)(2,"div",42)(3,"div",43)(4,"div",57),e.nrm(5,"i",45),e.k0s()(),e.j41(6,"div",46)(7,"h5",47),e.EFF(8),e.k0s(),e.nrm(9,"small",58),e.k0s()()()()}if(2&r){const t=e.XpG(2);e.R7$(),e.AVh("bg-primary-subtle",20==t.pagination.status),e.R7$(7),e.JRh(t.count.underReview)}}function fs(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",40),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.onSelectStatus(30))}),e.j41(1,"div",41)(2,"div",42)(3,"div",43)(4,"div",59),e.nrm(5,"i",45),e.k0s()(),e.j41(6,"div",46)(7,"h5",47),e.EFF(8),e.k0s(),e.nrm(9,"p",60),e.k0s()()()()}if(2&r){const t=e.XpG(2);e.R7$(),e.AVh("bg-primary-subtle",30==t.pagination.status),e.R7$(7),e.JRh(t.count.repareOrder)}}function bs(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",40),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.onSelectStatus(50))}),e.j41(1,"div",41)(2,"div",42)(3,"div",43)(4,"div",61),e.nrm(5,"i",45),e.k0s()(),e.j41(6,"div",46)(7,"h5",47),e.EFF(8),e.k0s(),e.nrm(9,"p",62),e.k0s()()()()}if(2&r){const t=e.XpG(2);e.R7$(),e.AVh("bg-primary-subtle",50==t.pagination.status),e.R7$(7),e.JRh(t.count.assign)}}function vs(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",38),e.DNE(1,us,10,3,"div",39)(2,gs,10,3,"div",39)(3,_s,10,3,"div",39)(4,hs,10,3,"div",39)(5,fs,10,3,"div",39)(6,bs,10,3,"div",39),e.j41(7,"div",40),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.onSelectStatus(60))}),e.j41(8,"div",41)(9,"div",42)(10,"div",43)(11,"div",44),e.nrm(12,"i",45),e.k0s()(),e.j41(13,"div",46)(14,"h5",47),e.EFF(15),e.k0s(),e.nrm(16,"p",48),e.k0s()()()(),e.j41(17,"div",40),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.onSelectStatus(40))}),e.j41(18,"div",41)(19,"div",42)(20,"div",43)(21,"div",49),e.nrm(22,"i",45),e.k0s()(),e.j41(23,"div",46)(24,"h5",47),e.EFF(25),e.k0s(),e.nrm(26,"p",50),e.k0s()()()()()}if(2&r){const t=e.XpG();e.R7$(),e.Y8G("ngIf",12!=t.user.userType),e.R7$(),e.Y8G("ngIf",1==t.user.userType||9==t.user.userType),e.R7$(),e.Y8G("ngIf",1==t.user.userType||9==t.user.userType),e.R7$(),e.Y8G("ngIf",1==t.user.userType||12==t.user.userType),e.R7$(),e.Y8G("ngIf",1==t.user.userType),e.R7$(),e.Y8G("ngIf",1==t.user.userType),e.R7$(2),e.AVh("bg-primary-subtle",60==t.pagination.status),e.R7$(7),e.JRh(t.count.finished),e.R7$(3),e.AVh("bg-primary-subtle",40==t.pagination.status),e.R7$(7),e.JRh(t.count.cancel)}}function Ss(r,s){1&r&&(e.j41(0,"th",72),e.EFF(1," sales.salesOrder.trunck "),e.k0s())}function Cs(r,s){1&r&&(e.j41(0,"th",81),e.EFF(1," sales.salesOrder.cancelReasonName "),e.k0s())}function xs(r,s){if(1&r&&(e.j41(0,"tr",63),e.nrm(1,"th",64),e.j41(2,"th",65),e.EFF(3,"#"),e.k0s(),e.j41(4,"th",66),e.nrm(5,"i",67),e.EFF(6," orderManagement.order.orderCode "),e.k0s(),e.j41(7,"th",68),e.nrm(8,"i",67),e.EFF(9," orderManagement.order.creation "),e.k0s(),e.j41(10,"th",69),e.EFF(11," orderManagement.order.status "),e.k0s(),e.j41(12,"th",70),e.nrm(13,"i",67),e.EFF(14," orderManagement.order.agentName "),e.k0s(),e.j41(15,"th",71),e.EFF(16," sales.salesOrder.clientLocationName "),e.k0s(),e.j41(17,"th",72),e.EFF(18," sales.salesOrder.salsePerson "),e.k0s(),e.j41(19,"th",73),e.nrm(20,"i",67),e.EFF(21," sales.salesOrder.clientVisitDate "),e.k0s(),e.j41(22,"th",74),e.nrm(23,"i",67),e.EFF(24," sales.salesOrder.totalQuantity "),e.k0s(),e.j41(25,"th",75),e.nrm(26,"i",67),e.EFF(27," sales.salesOrder.totalDiscount "),e.k0s(),e.j41(28,"th",76),e.EFF(29," orderManagement.order.totalTax "),e.k0s(),e.j41(30,"th",77),e.nrm(31,"i",67),e.EFF(32," sales.salesOrder.netPrice "),e.k0s(),e.DNE(33,Ss,2,0,"th",78)(34,Cs,2,0,"th",79),e.nrm(35,"th",80),e.k0s()),2&r){const t=e.XpG();e.R7$(33),e.Y8G("ngIf",50==t.pagination.status),e.R7$(),e.Y8G("ngIf",40==t.pagination.status||5==t.pagination.status)}}function ys(r,s){1&r&&e.nrm(0,"span",99)}function Is(r,s){if(1&r&&(e.j41(0,"a",100),e.nrm(1,"i",101),e.k0s()),2&r){const t=e.XpG().$implicit,n=e.XpG();e.Y8G("href",n.mapUrl(null==t?null:t.lng,null==t?null:t.lat),e.B4B)}}function js(r,s){if(1&r&&(e.j41(0,"td")(1,"div"),e.EFF(2),e.k0s(),e.j41(3,"div"),e.EFF(4),e.k0s()()),2&r){const t=e.XpG().$implicit;e.R7$(2),e.JRh(t.shippingTruckName),e.R7$(2),e.JRh(t.driverName)}}function Ts(r,s){if(1&r&&(e.j41(0,"td")(1,"span",102),e.EFF(2),e.k0s()()),2&r){const t=e.XpG().$implicit;e.R7$(2),e.SpI("",t.cancelReasonName," ")}}function ks(r,s){if(1&r&&(e.j41(0,"td")(1,"span",102),e.EFF(2),e.k0s()()),2&r){const t=e.XpG().$implicit;e.R7$(2),e.SpI("",t.changeQuantityMessage," ")}}function ws(r,s){if(1&r){const t=e.RV6();e.j41(0,"button",104),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2).$implicit,a=e.XpG(),o=e.sdS(69);return e.Njj(a.openShippingModal(i.id,o,"lg"))}),e.nrm(2,"i",105),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"sales.salesOrder.shipping"))}function Ms(r,s){if(1&r&&(e.qex(0),e.DNE(1,ws,3,3,"button",103),e.bVm()),2&r){const t=e.XpG().$implicit;e.R7$(),e.Y8G("ngIf",30==t.offerOrderStatus)}}function Os(r,s){if(1&r){const t=e.RV6();e.j41(0,"button",107),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2).$implicit,a=e.XpG(),o=e.sdS(63);return e.Njj(a.openStatusModal(i.id,o,20,"md"))}),e.nrm(2,"i",108),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"general.action.send"))}function Rs(r,s){if(1&r&&(e.qex(0),e.DNE(1,Os,3,3,"button",106),e.bVm()),2&r){const t=e.XpG().$implicit;e.R7$(),e.Y8G("ngIf",0==t.offerOrderStatus||5==t.offerOrderStatus)}}function Fs(r,s){if(1&r){const t=e.RV6();e.j41(0,"button",110),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2).$implicit,a=e.XpG(),o=e.sdS(63);return e.Njj(a.openStatusModal(i.id,o,30,"md"))}),e.nrm(2,"i",108),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"general.action.approve"))}function Vs(r,s){if(1&r&&(e.qex(0),e.DNE(1,Fs,3,3,"button",109),e.bVm()),2&r){const t=e.XpG().$implicit;e.R7$(),e.Y8G("ngIf",20==t.offerOrderStatus)}}function Es(r,s){if(1&r){const t=e.RV6();e.j41(0,"li",84),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2).$implicit,a=e.XpG(),o=e.sdS(57);return e.Njj(a.openModal(i.id,o,"xl"))}),e.j41(1,"span",111),e.nrm(2,"i",112)(3,"span",113),e.k0s()()}}function Ns(r,s){if(1&r&&(e.qex(0),e.DNE(1,Es,4,0,"li",98),e.bVm()),2&r){const t=e.XpG(2);e.R7$(),e.Y8G("ngIf",null==t.pagination.status)}}function Ds(r,s){if(1&r){const t=e.RV6();e.j41(0,"li",84),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2).$implicit,a=e.XpG(),o=e.sdS(57);return e.Njj(a.openModal(i.id,o,"xl"))}),e.j41(1,"span",111),e.nrm(2,"i",112)(3,"span",113),e.k0s()()}}function Ls(r,s){if(1&r){const t=e.RV6();e.j41(0,"li",84),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2).$implicit,a=e.XpG(),o=e.sdS(59);return e.Njj(a.openModal(i.id,o,"xl"))}),e.j41(1,"span",111),e.nrm(2,"i",112)(3,"span",113),e.k0s()()}}function Gs(r,s){if(1&r&&(e.qex(0),e.DNE(1,Ds,4,0,"li",98)(2,Ls,4,0,"li",98),e.bVm()),2&r){const t=e.XpG().$implicit;e.R7$(),e.Y8G("ngIf",0==t.offerOrderStatus||100==t.offerOrderStatus),e.R7$(),e.Y8G("ngIf",5==t.offerOrderStatus||0==t.offerOrderStatus||100==t.offerOrderStatus)}}function Ps(r,s){if(1&r){const t=e.RV6();e.j41(0,"li",84),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2).$implicit,a=e.XpG(),o=e.sdS(65);return e.Njj(a.openModal(i.id,o))}),e.j41(1,"span",111),e.nrm(2,"i",114)(3,"span",115),e.k0s()()}}function $s(r,s){if(1&r&&(e.qex(0),e.DNE(1,Ps,4,0,"li",98),e.bVm()),2&r){const t=e.XpG().$implicit;e.R7$(),e.Y8G("ngIf",20==t.offerOrderStatus)}}function Bs(r,s){if(1&r){const t=e.RV6();e.j41(0,"li",84),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2).$implicit,a=e.XpG(),o=e.sdS(67);return e.Njj(a.openModal(i.id,o))}),e.j41(1,"span",111),e.nrm(2,"i",116)(3,"span",117),e.k0s()()}}function Xs(r,s){if(1&r&&(e.qex(0),e.DNE(1,Bs,4,0,"li",98),e.bVm()),2&r){const t=e.XpG().$implicit;e.R7$(),e.Y8G("ngIf",0==t.offerOrderStatus||100==t.offerOrderStatus)}}function As(r,s){if(1&r){const t=e.RV6();e.j41(0,"li",84),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,a=e.XpG(),o=e.sdS(53);return e.Njj(a.openModal(i.id,o))}),e.j41(1,"span",111),e.nrm(2,"i",116)(3,"span",118),e.k0s()()}}function qs(r,s){if(1&r){const t=e.RV6();e.j41(0,"tr",82)(1,"td"),e.nrm(2,"button",83),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td",84),e.bIt("click",function(){const i=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.PrintSalesOrder(i.id))}),e.j41(6,"bdi",85),e.EFF(7),e.k0s()(),e.j41(8,"td"),e.EFF(9),e.nI1(10,"date"),e.k0s(),e.j41(11,"td")(12,"span"),e.nrm(13,"span",86),e.k0s()(),e.j41(14,"td",84),e.bIt("click",function(){const i=e.eBV(t).$implicit,a=e.XpG(),o=e.sdS(61);return e.Njj(a.openModal(i.clientId,o,"md"))}),e.j41(15,"a",87),e.EFF(16),e.k0s()(),e.j41(17,"td"),e.DNE(18,ys,1,0,"span",88)(19,Is,2,1,"a",89),e.k0s(),e.j41(20,"td")(21,"div"),e.EFF(22),e.k0s(),e.j41(23,"div",90),e.EFF(24),e.k0s()(),e.j41(25,"td"),e.EFF(26),e.nI1(27,"date"),e.k0s(),e.j41(28,"td"),e.EFF(29),e.k0s(),e.j41(30,"td"),e.EFF(31),e.k0s(),e.j41(32,"td"),e.EFF(33),e.k0s(),e.j41(34,"td"),e.EFF(35),e.k0s(),e.DNE(36,js,5,2,"td",91)(37,Ts,3,1,"td",91)(38,ks,3,1,"td",91),e.j41(39,"td"),e.DNE(40,Ms,2,1,"ng-container",92)(41,Rs,2,1,"ng-container",92)(42,Vs,2,1,"ng-container",92),e.j41(43,"span",93)(44,"div",94)(45,"button",95),e.nrm(46,"i",96),e.k0s(),e.j41(47,"ul",97),e.DNE(48,Ns,2,1,"ng-container",92)(49,Gs,3,2,"ng-container",92)(50,$s,2,1,"ng-container",92)(51,Xs,2,1,"ng-container",92)(52,As,4,0,"li",98),e.k0s()()()()()}if(2&r){const t=s.$implicit,n=s.rowIndex,i=s.expanded,a=e.XpG();e.R7$(2),e.Y8G("pRowToggler",t)("ngClass",i?" ri-arrow-down-s-line":"  ri-arrow-up-s-line"),e.R7$(2),e.JRh(n+1),e.R7$(3),e.SpI("#SO#",t.id,""),e.R7$(2),e.SpI(" ",e.i5U(10,30,t.creationTime,"yyyy-MM-dd HH:mm")," "),e.R7$(3),e.ZvI("badge ",a.getStatus(t),""),e.R7$(),e.FS9("translate","sales.salesOrder."+t.offerOrderStatusValue),e.R7$(3),e.SpI(" ",t.clientName," "),e.R7$(2),e.Y8G("ngIf",""==t.lng),e.R7$(),e.Y8G("ngIf",null==t?null:t.lng),e.R7$(3),e.JRh(t.salsePersonName),e.R7$(2),e.JRh(t.storeName),e.R7$(2),e.SpI(" ",e.i5U(27,33,t.acutalVisitDate,"yyyy-MM-dd HH:mm"),""),e.R7$(3),e.JRh(t.totalQuantity),e.R7$(2),e.JRh(t.totalDiscount),e.R7$(2),e.JRh(t.totalTax),e.R7$(2),e.JRh(t.netPrice),e.R7$(),e.Y8G("ngIf",50==a.pagination.status),e.R7$(),e.Y8G("ngIf",40==a.pagination.status),e.R7$(),e.Y8G("ngIf",5==a.pagination.status),e.R7$(2),e.Y8G("hasPermission",e.lJ4(36,ss)),e.R7$(),e.Y8G("hasPermission",e.lJ4(37,os)),e.R7$(),e.Y8G("hasPermission",e.lJ4(38,ls)),e.R7$(6),e.Y8G("hasPermission",e.lJ4(39,ds)),e.R7$(),e.Y8G("hasPermission",e.lJ4(40,cs)),e.R7$(),e.Y8G("hasPermission",e.lJ4(41,ms)),e.R7$(),e.Y8G("hasPermission",e.lJ4(42,ps)),e.R7$(),e.Y8G("ngIf",0==t.offerOrderStatus)}}function Ys(r,s){1&r&&e.nrm(0,"span",131)}function Us(r,s){1&r&&e.nrm(0,"span",132)}function zs(r,s){if(1&r&&(e.qex(0),e.j41(1,"tr")(2,"td"),e.EFF(3),e.k0s(),e.j41(4,"td"),e.EFF(5),e.k0s(),e.j41(6,"td"),e.EFF(7),e.k0s(),e.j41(8,"td"),e.EFF(9),e.k0s(),e.j41(10,"td"),e.EFF(11),e.k0s(),e.j41(12,"td"),e.DNE(13,Ys,1,0,"span",129)(14,Us,1,0,"span",130),e.k0s()(),e.bVm()),2&r){const t=s.$implicit,n=s.index;e.R7$(),e.AVh("bg-danger-subtle",t.isFree),e.R7$(2),e.JRh(n+1),e.R7$(2),e.JRh(t.itemName),e.R7$(2),e.JRh(t.unitName),e.R7$(2),e.JRh(t.approvedQuantity),e.R7$(2),e.JRh(t.price),e.R7$(2),e.Y8G("ngIf",t.isFree),e.R7$(),e.Y8G("ngIf",!t.isFree)}}function Qs(r,s){if(1&r&&(e.j41(0,"tr")(1,"td",119)(2,"div")(3,"table",120)(4,"thead")(5,"tr",121)(6,"th",122),e.EFF(7,"#"),e.k0s(),e.nrm(8,"th",123)(9,"th",124)(10,"th",125)(11,"th",126)(12,"th",127),e.k0s()(),e.j41(13,"tbody"),e.DNE(14,zs,15,9,"ng-container",128),e.k0s()()()()()),2&r){const t=s.$implicit;e.R7$(14),e.Y8G("ngForOf",t.offerOrderDetails)}}function Hs(r,s){1&r&&(e.j41(0,"div",133),e.EFF(1," general.table.noData "),e.k0s())}function Ws(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",134)(1,"div",135),e.nrm(2,"ngb-pagination-info",136),e.j41(3,"table-length",137),e.bIt("lengthChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.ListItemChange(i))}),e.k0s()(),e.j41(4,"div",138)(5,"ngb-pagination",139),e.bIt("pageChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.pageChanged(i))}),e.mxI("pageChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.pagination.pageNumber,i)||(a.pagination.pageNumber=i),e.Njj(i)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function Js(r,s){if(1&r){const t=e.RV6();e.j41(0,"delete-modal",140),e.bIt("deleteConfirm",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.DeleteConfirm())})("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}}function Zs(r,s){if(1&r){const t=e.RV6();e.j41(0,"app-all-orders-details",141),e.bIt("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderDetails",t.operationId)}}function Ks(r,s){if(1&r){const t=e.RV6();e.j41(0,"sales-edit-order",142),e.bIt("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("isChangeQuantity",!0)("isDraft",!0)("orderSelected",t.operationId)}}function eo(r,s){if(1&r){const t=e.RV6();e.j41(0,"sales-edit-order",142),e.bIt("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("isChangeQuantity",!0)("isDraft",!0)("orderSelected",t.operationId)}}function to(r,s){if(1&r){const t=e.RV6();e.j41(0,"client-summary",143),e.bIt("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("clientId",t.operationId)}}function io(r,s){if(1&r){const t=e.RV6();e.j41(0,"form",144,10),e.bIt("ngSubmit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.SubmitOrder())}),e.nrm(2,"ngx-ui-loader",145),e.j41(3,"div",146)(4,"div",147)(5,"button",148),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()(),e.j41(6,"div",149)(7,"div",150),e.nrm(8,"lord-icon",151),e.j41(9,"div",152),e.nrm(10,"h3",153)(11,"p",154),e.k0s()(),e.j41(12,"div",155),e.nrm(13,"button",156),e.j41(14,"button",157),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()()()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}function no(r,s){1&r&&(e.j41(0,"div",164),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function ro(r,s){if(1&r){const t=e.RV6();e.j41(0,"form",144,10),e.bIt("ngSubmit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.RequestChangeQuantity())}),e.nrm(2,"ngx-ui-loader",145),e.j41(3,"div",146)(4,"div",147)(5,"button",148),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()(),e.j41(6,"div",149)(7,"div",158)(8,"label",159),e.EFF(9,"sales.salesOrder.changeQuantityMessage"),e.k0s(),e.j41(10,"textarea",160,11),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.changeQuantityMessage,i)||(a.form.changeQuantityMessage=i),e.Njj(i)}),e.k0s(),e.DNE(12,no,2,0,"div",161),e.k0s(),e.j41(13,"div",155),e.nrm(14,"button",162),e.j41(15,"button",163),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()()()()()}if(2&r){const t=e.sdS(1),n=e.sdS(11),i=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",i.loaderOperationShap)("loaderId",i.deleteLoader),e.R7$(8),e.R50("ngModel",i.form.changeQuantityMessage),e.R7$(2),e.Y8G("ngIf",n.invalid&&n.touched),e.R7$(2),e.Y8G("disabled",!t.valid)}}function ao(r,s){if(1&r){const t=e.RV6();e.j41(0,"cancel-sales-model",165),e.bIt("success",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.reload())})("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderId",t.operationId)}}function so(r,s){if(1&r){const t=e.RV6();e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td")(4,"ng-select",194),e.mxI("ngModelChange",function(i){const a=e.eBV(t).$implicit;return e.DH7(a.unitId,i)||(a.unitId=i),e.Njj(i)}),e.k0s()(),e.j41(5,"td")(6,"input",195),e.bIt("ngModelChange",function(i){const a=e.eBV(t).$index,o=e.XpG(2);return e.Njj(o.quantitySelect(i,a))}),e.mxI("ngModelChange",function(i){const a=e.eBV(t).$implicit;return e.DH7(a.quantity,i)||(a.quantity=i),e.Njj(i)}),e.k0s()()()}if(2&r){const t=s.$implicit,n=s.$index;e.R7$(2),e.SpI(" ",t.itemName," "),e.R7$(2),e.Y8G("name","unitId"+e.eq3(6,ze,n))("items",t.units),e.R50("ngModel",t.unitId),e.R7$(2),e.Y8G("name","quantity"+e.eq3(8,ze,n)),e.R50("ngModel",t.quantity)}}function oo(r,s){if(1&r){const t=e.RV6();e.j41(0,"tr",196),e.nrm(1,"td",197),e.j41(2,"td",198)(3,"table",199)(4,"tbody")(5,"tr"),e.nrm(6,"td",200),e.j41(7,"td",201),e.EFF(8),e.nI1(9,"translate"),e.k0s()(),e.j41(10,"tr"),e.nrm(11,"td",202),e.j41(12,"td",201)(13,"div",203)(14,"ng-select",204),e.bIt("change",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.getTotal())}),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG(2);return e.DH7(a.form.totalAddDiscountType,i)||(a.form.totalAddDiscountType=i),e.Njj(i)}),e.k0s(),e.j41(15,"input",205),e.bIt("change",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.getTotal())}),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG(2);return e.DH7(a.form.totalAddDiscount,i)||(a.form.totalAddDiscount=i),e.Njj(i)}),e.k0s()()()(),e.j41(16,"tr",206),e.nrm(17,"td",207),e.j41(18,"td",201),e.EFF(19),e.nI1(20,"translate"),e.k0s()(),e.j41(21,"tr",208),e.nrm(22,"th",209),e.j41(23,"th",201),e.EFF(24),e.nI1(25,"translate"),e.k0s()()()()()()}if(2&r){const t=e.XpG(2);e.R7$(8),e.Lme("",t.form.total," ",e.bMT(9,9,"orderManagement.order.currancy"),""),e.R7$(6),e.Y8G("items",t.discountTypes),e.R50("ngModel",t.form.totalAddDiscountType),e.R7$(),e.R50("ngModel",t.form.totalAddDiscount),e.R7$(4),e.Lme("",t.form.tax," ",e.bMT(20,11,"orderManagement.order.currancy"),""),e.R7$(5),e.Lme("",t.form.totalNet," ",e.bMT(25,13,"orderManagement.order.currancy"),"")}}function lo(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",166)(1,"div",167)(2,"h4",168),e.nrm(3,"span",169),e.k0s(),e.j41(4,"button",170),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss("Cross click"))}),e.k0s()(),e.j41(5,"div",149),e.nrm(6,"ngx-ui-loader",145),e.j41(7,"form",171,10),e.bIt("submit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.updateTruck())}),e.j41(9,"div",13)(10,"div",172)(11,"label",173),e.EFF(12,"sales.salesOrder.acutalDeliveryDate"),e.k0s(),e.j41(13,"input",174),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.dateChangeModal(i))}),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.acutalVisitDate,i)||(a.form.acutalVisitDate=i),e.Njj(i)}),e.k0s()(),e.j41(14,"div",172),e.nrm(15,"label",175),e.j41(16,"ng-select",176),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.clientLocationId,i)||(a.form.clientLocationId=i),e.Njj(i)}),e.k0s()(),e.j41(17,"div",177)(18,"label",173),e.EFF(19,"sales.salesOrder.truncks"),e.k0s(),e.j41(20,"ng-select",178),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.shippingTruckId,i)||(a.form.shippingTruckId=i),e.Njj(i)}),e.k0s()()(),e.j41(21,"div",179)(22,"div",41)(23,"div",180)(24,"div",181),e.nrm(25,"h5",182),e.k0s()(),e.j41(26,"div",30)(27,"div",183)(28,"table",184)(29,"thead",185)(30,"tr"),e.nrm(31,"th",186)(32,"th",187)(33,"th",188),e.k0s()(),e.j41(34,"tbody"),e.Z7z(35,so,7,10,"tr",null,e.Vm6),e.DNE(37,oo,26,15,"tr",189),e.k0s()()()()()(),e.j41(38,"div",190)(39,"button",191),e.nrm(40,"i",192)(41,"span",193),e.k0s()()()()()}if(2&r){const t=e.sdS(8),n=e.XpG();e.R7$(6),e.Y8G("hasProgressBar",!1)("fgsType",n.loaderOperationShap)("loaderId",n.operationLoader),e.R7$(7),e.R50("ngModel",n.form.acutalVisitDate),e.Y8G("altInput",!0)("enableTime",!0)("convertModelValue",!0)("dateFormat","d-m-Y H:i"),e.R7$(3),e.Y8G("disabled",!0)("items",n.locations),e.R50("ngModel",n.form.clientLocationId),e.R7$(4),e.Y8G("items",n.truncks),e.R50("ngModel",n.form.shippingTruckId),e.R7$(15),e.Dyx(n.form.details),e.R7$(2),e.Y8G("ngIf",!1),e.R7$(2),e.Y8G("disabled",!t.valid)}}let Qe=(()=>{class r extends X.w{constructor(t,n,i,a,o,l,h,x,y,I,j,T,b,C,O,F){super(t,n,h,i,a,o,l),this.baseService=i,this.authDaamService=x,this.teamService=y,this.employeeService=I,this.regionService=j,this.cityService=T,this.excelService=b,this.router=C,this.storesService=O,this.orderReceivedService=F,this.title="sales.salesOrder.title",this.titleOperation="sales.salesOrder.titleOperation",this.keySelected="",this.searchForm={},this.isResolveList=!0,this.employeeGroups=[],this.activeindex="2",this.active=2,this.clientSelected=0,this.status=[],this.countLoad=2,this.isOrderEdit=!1,this.orderSelected={},this.users=[],this.statusCount={},this.salesPersons=[],this.regions=[],this.cities=[],this.count={},this.truncks=[],this.locations=[],this.discountTypes=[],this.showStore=!1,this.statusList=[{id:0,name:"Draft"},{id:5,name:"ChangeQuantity"},{id:20,name:"UnderReview"},{id:30,name:"StoreDeliveryOrder"},{id:32,name:"RepareOrder"},{id:40,name:"Cancel"},{id:50,name:"Assign"},{id:60,name:"Finished"},{id:100,name:"Return"}],this.user=JSON.parse(localStorage.getItem("user")),this.stores=[],this.setting=[],this.setDates=(k,$,L)=>{if(k?.from||k?.to){const se=k.to||k.from;this.pagination[$]=this.datePipe.transform(k.from||k.to,"yyyy-MM-ddT00:00:00"),this.pagination[L]=this.datePipe.transform(se,"yyyy-MM-ddT23:59:59.999")}else this.pagination[$]=null,this.pagination[L]=null},this.configRoute(),this.GetSalesPersons(),this.GetRegions(),this.GetCities(),this.GetOfferOrderCount(),this.configStatus(),this.GetStores()}configStatus(){this.statusList.forEach(t=>{t.name=this.getTranslationText("sales.salesOrder."+t.name)})}GetOfferOrderCount(){this.baseService.GetOfferOrderCount().subscribe(t=>{this.count=t.data})}GetStores(){this.storesService.getDropDown().subscribe(t=>{this.stores=t.data},t=>{console.log(t)})}GetRegions(){this.regionService.getDropDown().subscribe(t=>{this.regions=t.data},t=>{console.log(t)})}GetCities(){this.cityService.GetAllDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetSalesPersons(){this.employeeService.GetAllByType(9).subscribe(t=>{this.salesPersons=t.data},t=>{console.log(t)})}ngOnInitMore(){this.discountTypes=this.baseService.discountTypes,this.discountTypes.forEach(t=>{t.name=this.getTranslationText("sales.salesOrder."+t.name)})}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,m.Q)(this.notifier)).subscribe(n=>{n?this.alertService.success():this.alertService.error("general.message."+n)},n=>{this.alertService.error()})}mapRegisterForm(t){let n={...t};return n.employeeCode=0,n}onSearch(){-1===this.pagination.status?(this.pagination.status=null,this.pagination.statusList=[],this.showStore=!1):30===this.pagination.status?(this.pagination.status=null,this.showStore=!0,this.pagination.statusList=[30,32]):(this.pagination.statusList=[],this.showStore=!1);let t={...this.searchForm};this.ngxLoader.startLoader("allLoader"),this.setDates(t.dates,"visitDateFrom","visitDateTo"),this.setDates(t.creationDates,"creationTimeFrom","creationTimeTo"),this.loadentities()}LoadSuccess(){this.ngxLoader.stopLoader("allLoader")}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems},this.loadentities()}configRoute(){this.routerActive.data.pipe((0,m.Q)(this.notifier)).subscribe(t=>{this.entities=t.data,this.pagination.totalItems=t.data?.totalItems},()=>{this.alertService.error()})}mapExcel(){let t=[];return this.entities.forEach(n=>{t.push({Code:n.id,CreatorName:n.creatorName,creationTime:n.creationTime,clientName:n.clientName,Status:this.getTranslationText("sales.salesOrder."+n.offerOrderStatusValue),salse_Person:n.salsePersonName,"Delivery.Date":n.acutalVisitDate,"T.Quantity":n.totalQuantity," T.Discount":n.totalDiscount,Tax:n.totalTax,Net:n.netPrice,Reason:n.cancelReasonName})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}getStatus(t){return 10==t.offerOrderStatus||5==t.offerOrderStatus?"bg-warning":20==t.offerOrderStatus?"bg-secondary ":30==t.offerOrderStatus?"bg-info":60==t.offerOrderStatus?"bg-success":40==t.offerOrderStatus?"bg-danger":50==t.offerOrderStatus?"bg-info":"bg-warning"}checkEdit(t){return!t.isCancel&&!t.isFinish}openModalClient(t,n,i="xl"){this.clientSelected=t.orderCode,this.orderSelected=t,this.isOrderEdit=!1,this.modalService.open(n,{centered:!0,size:i})}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}goNew(){this.router.navigateByUrl("/sales/new")}onSelectStatus(t){this.pagination.status=t,this.onSearch()}openStatusModal(t,n,i,a="md"){this.isEditForm=!1,this.form={},this.form={id:t,status:i},this.modalService.open(n,{centered:!0,size:a})}SubmitOrder(){this.ngxLoader.startLoader(u.Fq),this.baseService.changStatus({id:this.form.id,status:this.form.status}).pipe((0,v.O)(),(0,R.c)(this.mainDelay),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader(u.Fq))).subscribe({next:n=>{n.success?(this.modalService.dismissAll(),this.reload(),this.alertService.success()):this.alertService.error("general.message."+n.message)}})}cancelOrder(){this.ngxLoader.startLoader(u.Fq),console.log(this.operationId),this.baseService.changStatus({id:this.operationId,status:40}).pipe((0,v.O)(),(0,R.c)(this.mainDelay),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader(u.Fq))).subscribe({next:n=>{this.modalService.dismissAll(),this.reload(),this.alertService.success()}})}RequestChangeQuantity(){this.ngxLoader.startLoader(u.Fq),console.log(this.operationId),this.baseService.RequestChangeQuantity({id:this.operationId,changeQuantityMessage:this.form.changeQuantityMessage}).pipe((0,v.O)(),(0,R.c)(this.mainDelay),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader(u.Fq))).subscribe({next:n=>{this.modalService.dismissAll(),this.reload(),this.alertService.success()}})}reload(){this.modalService.dismissAll(),this.GetOfferOrderCount(),this.loadentities()}formatDate(t){if(!t)return"";const n=new Date(t);return n.getDate().toString().padStart(2,"0")+"-"+(n.getMonth()+1).toString().padStart(2,"0")+"-"+n.getFullYear()+" "+n.getHours().toString().padStart(2,"0")+":"+n.getMinutes().toString().padStart(2,"0")}openShippingModal(t,n,i="md"){this.baseService.GetTrucks({id:t,acutalVisitDate:null}).subscribe(o=>{o.success?(this.form=o.data.order,this.getTotal(),this.form.clientVisitDate=this.formatDate(this.form.clientVisitDate),this.form.acutalVisitDate=this.formatDate(this.form.acutalVisitDate),this.truncks=o.data.truncks,this.locations=o.data.locations,this.modalService.open(n,{centered:!0,size:i})):this.alertService.error("general.message."+o.message)},o=>{this.alertService.error("general.message."+o)})}getTotal(){let t=0,n=0,i=0;this.form.details.forEach(a=>{a.discount<0&&(a.discoun=0);let o=a.quantity*a.price,l=0;1===a.discountType?l=a.discount:2===a.discountType&&(l=o*a.discount/100),n=+l;let h=o-l;a.net=h,t=+h}),1===this.form.totalAddDiscountType?i=this.form.totalAddDiscount:2===this.form.totalAddDiscountType&&(i=t*this.form.totalAddDiscount/100),this.form.total=t,this.form.totalAddDiscount=this.form.totalAddDiscount,this.form.tax=15*this.form.total/100,this.form.totalNet=this.form.total-i+this.form.tax}updateTruck(){this.form.acutalVisitDate=new Date(this.convertToISO(this.form.acutalVisitDate));let t={shippingTruckId:this.form.shippingTruckId,clientLocationId:this.form.clientLocationId,offerOrderMasterId:this.form.id,Notes:this.form.notes,terms:this.form.terms,deliveryDate:this.datePipe.transform(this.form.acutalVisitDate,"yyyy-MM-ddTHH:mm:00.000"),details:this.form.details.map(n=>({id:0,itemId:n.itemId,itemName:n.itemName,quantity:n.quantity,unitId:n.unitId,price:n.price,discount:n.discount,discountType:n.discountType,clientQuantity:n.clientQuantity,approvedQuantity:n.approvedQuantity}))};this.ngxLoader.startLoader(this.operationLoader),this.orderReceivedService.register(t).pipe((0,v.O)(),(0,R.c)(this.mainDelay),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(n=>{n.success?this.reload():this.alertService.error("general.message."+n.message)},n=>{this.alertService.error("general.message."+n)})}convertToISO(t){if(t instanceof Date)return t.toISOString();if("string"==typeof t){const[n,i,a,o,l]=t.split(/[-\s:]/);return`${a}-${i}-${n}T${o}:${l}:00`}}dateChangeModal(t){t=new Date(t);let n={id:this.form.id,acutalVisitDate:this.datePipe.transform(t,"yyyy-MM-ddT00:00:00.000")};this.baseService.GetTrucks(n).subscribe(i=>{i.success?this.truncks=i.data.truncks:this.alertService.error("general.message."+i.message)},i=>{this.alertService.error("general.message."+i)})}quantitySelect(t,n){t&&(t<=0&&(t=1),this.form.details[n].quantity=parseInt(t),this.form.details[n].net=this.form.details[n].price*this.form.details[n].quantity,this.discountSelect(this.form.details[n].discount,n),this.getTotal())}discountSelect(t,n,i=1){if(t){(t=parseInt(t))<=0&&(this.form.details[n].discount=0),1==i&&(this.form.details[n].discount=t);let a=0;1==this.form.details[n].discountType?a=this.form.details[n].discount:(a=this.form.details[n].price*this.form.details[n].quantity*this.form.details[n].discount/100,a=+a.toFixed(2)),this.form.details[n].net=this.form.details[n].price*this.form.details[n].quantity-a,this.form.details[n].net=this.form.details[n].net.toFixed(2),this.getTotal()}}PrintOrderReceived(t){this.ngxLoader.startLoader("allLoader"),this.orderReceivedService.PrintOrderReceived(t).pipe((0,v.O)(),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader("allLoader"))).subscribe(n=>{this.openUrl(n)},n=>{this.alertService.error("general.message."+n)})}openUrl(t){let n=new Blob([t],{type:t.type});var i=URL.createObjectURL(n);window.open(i,"_blank")}PrintSalesOrder(t){this.ngxLoader.startLoader("allLoader"),this.baseService.PrintSalesOrder(t).pipe((0,v.O)(),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader("allLoader"))).subscribe(n=>{this.openUrl(n)},n=>{this.alertService.error("general.message."+n)})}mapUrl(t,n){return null===t||null==n?"":`https://www.google.com/maps/dir//${n},${t}/@${n},${t},17z?hl=en-US`}static{this.\u0275fac=function(n){return new(n||r)(e.rXU(M.nX),e.rXU(g.c$),e.rXU(U.A),e.rXU(E.u),e.rXU(p.vh),e.rXU(w.eD),e.rXU(_.Bq),e.rXU(fe.J),e.rXU(Me.n),e.rXU(K.O),e.rXU(Ie.S),e.rXU(le.h),e.rXU(H.V),e.rXU(M.Ix),e.rXU(Oe.a),e.rXU(he.B))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-sales-order"]],features:[e.Vt3],decls:70,vars:65,consts:[["tableMaster",""],["deleteModal",""],["orderViewModel",""],["SalesEditModel",""],["SalesChangeModel",""],["ClientInfo",""],["StatusOrderModal",""],["SubmitChangeQuantityModal",""],["cancelModal",""],["SubmitOrderModal",""],["formEntity","ngForm"],["changeQuantityMessage","ngModel"],["class","row justify-content-center",4,"hasPermission"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"addNew","reset","search","exportXlsx","addPermission","showAdd","showExport","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","id","name","id",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],["InputTirmFilter","","type","search","id","clientName","name","clientName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["name","regionId","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],["name","cityId","bindValue","code","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],["name","status","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],["name","storeId","bindValue","id","bindLabel","nameAR",3,"ngModelChange","items","multiple","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,"row","justify-content-center"],["class","col-sm-12 col-custom-7 cursor-pointer ",3,"click",4,"ngIf"],[1,"col-sm-12","col-custom-7","cursor-pointer",3,"click"],[1,"card"],[1,"card-body","d-flex","gap-3","align-items-center"],[1,"avatar-sm"],[1,"avatar-title","border","bg-success","border-opacity-25","rounded-2","fs-17"],[1,"ri-shopping-cart-2-fill"],[1,"flex-grow-1"],[1,"fs-15"],["translate","sales.salesOrder.completeOrder",1,"mb-0","text-muted"],[1,"avatar-title","border","bg-danger","border-opacity-25","rounded-2","fs-17"],["translate","sales.salesOrder.cancelOrder",1,"mb-0","text-muted"],[1,"card-body","bg-primary-subtle","d-flex","gap-1","align-items-center"],[1,"avatar-title","border","border-opacity-25","rounded-2","fs-17"],["translate","general.table.all",1,"mb-0","text-muted"],[1,"avatar-title","border","bg-warning","border-opacity-25","rounded-2","fs-17"],["translate","sales.salesOrder.draft",1,"mb-0","text-muted"],["translate","sales.salesOrder.reopen",1,"mb-0","text-muted"],[1,"avatar-title","bg-secondary","border","border-opacity-25","rounded-2","fs-17"],["translate","sales.salesOrder.approveMangerSM",1,"mb-0","text-muted"],[1,"avatar-title","bg-info","border","border-opacity-25","rounded-2","fs-17"],["translate","sales.salesOrder.storeRepeare",1,"mb-0","text-muted"],[1,"avatar-title","border","bg-info","border-opacity-25","rounded-2","fs-17"],["translate","sales.salesOrder.orderShipping",1,"mb-0","text-muted"],[1,""],[2,"width",".2%"],["translate","",2,"width",".3%"],["pSortableColumn","id","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["pSortableColumn","creationTime","translate","",2,"width","10%"],["pSortableColumn","status","translate","",2,"width","6%"],["pSortableColumn","clientId","translate","",2,"width","10%"],["translate","",2,"width","3%"],["translate","",2,"width","12%"],["pSortableColumn","clientVisitDate","translate","",2,"width","10%"],["pSortableColumn","totalQuantity","translate","",2,"width","8%"],["pSortableColumn","totalDiscount","translate","",2,"width","8%"],["translate","",2,"width","6%"],["pSortableColumn","netPrice","translate","",2,"width","8%"],["style","width:12%","translate","",4,"ngIf"],["style","width:10%","translate","",4,"ngIf"],["translate","",2,"width","8%"],["translate","",2,"width","10%"],[1,"fs-5"],["type","button","pRipple","",1,"border-0","p-button-text","p-button-rounded","p-button-plain",3,"pRowToggler","ngClass"],[3,"click"],[1,"code-pointer","text-decoration-underline","link-underline-opacity-25","link-underline-opacity-100-hover"],[3,"translate"],["href","javascript:void(0)",1,"link-primary","link-offset-2","text-decoration-underline","link-underline-opacity-25","link-underline-opacity-100-hover"],["class","badge bg-danger-subtle text-danger mx-1","translate","orderManagement.order.noMap",4,"ngIf"],["target","_blank","class","badge bg-success-subtle text-success mx-1","translate","orderManagement.order.viewMap",3,"href",4,"ngIf"],[1,"badge","bg-primary"],[4,"ngIf"],[4,"hasPermission"],[1,"d-inline-block"],[1,"dropdown-custom","d-inline-block"],["type","button",1,"btn","dropbtn","btn-soft-secondary","btn-sm","dropdown-custom","arrow-none"],[1,"ri-more-fill"],[1,"dropdown-menu","dropdown-menu-end","dropdown-content",2,"left","0"],[3,"click",4,"ngIf"],["translate","orderManagement.order.noMap",1,"badge","bg-danger-subtle","text-danger","mx-1"],["target","_blank","translate","orderManagement.order.viewMap",1,"badge","bg-success-subtle","text-success","mx-1",3,"href"],[1,"ri-map-pin-line"],[1,"badge","bg-danger-subtle","text-danger"],["class","btn btn-sm btn-primary edit-list mx-1","tooltipPosition","top",3,"pTooltip","click",4,"ngIf"],["tooltipPosition","top",1,"btn","btn-sm","btn-primary","edit-list","mx-1",3,"click","pTooltip"],[1,"ri-truck-line","align-bottom"],["class","btn btn-sm btn-warning edit-list mx-1","tooltipPosition","top",3,"pTooltip","click",4,"ngIf"],["tooltipPosition","top",1,"btn","btn-sm","btn-warning","edit-list","mx-1",3,"click","pTooltip"],[1,"ri-send-plane-fill","align-bottom"],["class","btn btn-sm btn-success edit-list mx-1","tooltipPosition","top",3,"pTooltip","click",4,"ngIf"],["tooltipPosition","top",1,"btn","btn-sm","btn-success","edit-list","mx-1",3,"click","pTooltip"],[1,"dropdown-item"],[1,"text-success","ri-pencil-fill","align-bottom","me-2"],["translate","general.action.edit"],[1,"text-primary","ri-check-double-fill","align-bottom","me-2"],["translate","sales.salesOrder.backToSales"],[1,"text-danger","ri-close-fill","align-bottom","me-2"],["translate","general.action.cancel"],["translate","general.action.delete"],["colspan","17"],["dataKey","id"],[1,"bg-light"],[2,"width","3%"],["translate","sales.salesOrder.itemName",2,"width","10%"],["translate","sales.salesOrder.unit",2,"width","6%"],["translate","sales.salesOrder.approvedQuantity",2,"width","8%"],["translate","sales.salesOrder.price",2,"width","5%"],["translate","sales.salesOrder.isFree",2,"width","5%"],[4,"ngFor","ngForOf"],["translate","sales.salesOrder.free",4,"ngIf"],["translate","sales.salesOrder.noFree",4,"ngIf"],["translate","sales.salesOrder.free"],["translate","sales.salesOrder.noFree"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"deleteConfirm","dismiss"],[3,"dismiss","orderDetails"],[3,"dismiss","isChangeQuantity","isDraft","orderSelected"],[3,"dismiss","clientId"],[3,"ngSubmit"],[3,"hasProgressBar","fgsType","loaderId"],[1,"modal-content"],[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mt-2","text-center"],["src","https://cdn.lordicon.com/gdfrsvpt.json","stroke","bold","state","hover-oscillate","trigger","loop","colors","primary:#f7b84b,secondary:#f06548",2,"width","130px","height","130px"],[1,"pt-2","fs-15","mx-4","mx-sm-5"],["translate","orderManagement.order.AreYouSureMessage"],[1,"text-muted","mx-4","mb-0"],[1,"d-flex","gap-2","justify-content-center","mt-4","mb-2"],["type","submit","id","save","translate","general.action.send",1,"btn","w-sm","btn-danger","fs-4"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light","fs-4",3,"click"],[1,"mb-2"],["for","changeQuantityMessage","translate","",1,"required","text-bold","form-label"],["rows","5","InputTirmFilter","","name","changeQuantityMessage","type","text","id","changeQuantityMessage",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["class","text-danger text-center  ","translate","",4,"ngIf"],["t","","type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger",3,"disabled"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],["translate","",1,"text-danger","text-center"],[3,"success","dismiss","orderId"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["translate","sales.salesOrder.truckUpdate"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[3,"submit"],[1,"col-12","col-md-3"],["for","name","translate","",1,"required","fw-bold","form-label"],["name","acutalVisitDate","type","text","mwlFlatpickr","","altFormat","d-m-Y H:i","required","",1,"form-control","flatpickr-input",3,"ngModelChange","ngModel","altInput","enableTime","convertModelValue","dateFormat"],["for","name","translate","orderManagement.order.savedAddress",1,"required","fw-bold","form-label"],["name","clientLocationId","bindValue","id","bindLabel","name","required","",2,"width","100%",3,"ngModelChange","disabled","items","ngModel"],[1,"col-12","col-md-6"],["name","shippingTruckId","bindValue","id","bindLabel","name","required","",2,"width","100%",3,"ngModelChange","items","ngModel"],[1,"row","justify-content-center","my-0"],[1,"card-header","p-0"],[1,"d-flex","align-items-center"],["translate","sales.salesRequests.items",1,"card-title","flex-grow-1","mb-0"],[1,"table-responsive","table-card",2,"overflow","visible"],[1,"table","table-nowrap","align-middle","table-borderless","mb-0"],[1,"table-light","text-muted","p-1"],["translate","sales.salesRequests.itemName",2,"width","20%"],["translate","sales.salesRequests.unit",2,"width","25%"],["translate","sales.salesRequests.quantity",2,"width","25%"],["class","border-top border-top-dashed",4,"ngIf"],[1,"d-flex","justify-content-center","m-0"],["type","submit","type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],["clearable","false","clearOnBackspace","false","bindValue","id","bindLabel","name",2,"width","100%",3,"ngModelChange","name","items","ngModel"],["type","text","id","quantity",1,"form-control","fs-6",3,"ngModelChange","name","ngModel"],[1,"border-top","border-top-dashed"],["colspan","3"],["colspan","4",1,"fw-medium","p-0"],[1,"table","table-borderless","mb-0"],["translate","sales.salesOrder.total",1,"m-0","p-0"],[1,"text-end","m-0","p-0"],["translate","sales.salesOrder.extraDiscount",1,"m-0","p-0"],[1,"input-group","mx-4",2,"width","80%"],["clearable","false","clearOnBackspace","false","name","totalAddDiscountType","bindValue","id","bindLabel","name",3,"change","ngModelChange","items","ngModel"],["InputTirmFilter","","name","totalAddDiscount","type","text","id","totalAddDiscount",1,"form-control","fs-6",2,"width","30%",3,"change","ngModelChange","ngModel"],[1,"m-0","p-0"],["translate","sales.salesOrder.tax",1,"m-0","p-0"],[1,"border-top","border-top-dashed","m-0","p-0"],["scope","row","translate","sales.salesOrder.net",1,"m-0","p-0"]],template:function(n,i){if(1&n){const a=e.RV6();e.DNE(0,vs,27,12,"div",12),e.j41(1,"div",13)(2,"div",14)(3,"div",15),e.nrm(4,"ngx-ui-loader",16),e.j41(5,"base-filter",17),e.bIt("addNew",function(){return e.eBV(a),e.Njj(i.goNew())})("reset",function(){return e.eBV(a),e.Njj(i.onReset())})("search",function(){return e.eBV(a),e.Njj(i.onSearch())})("exportXlsx",function(){return e.eBV(a),e.Njj(i.onExportXlsx())}),e.qex(6,18),e.j41(7,"div",19)(8,"div",20)(9,"input",21),e.nI1(10,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.id,l)||(i.pagination.id=l),e.Njj(l)}),e.k0s(),e.nrm(11,"i",22),e.k0s()(),e.j41(12,"div",19)(13,"input",23),e.nI1(14,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.searchForm.creationDates,l)||(i.searchForm.creationDates=l),e.Njj(l)}),e.k0s()(),e.j41(15,"div",19)(16,"div",20)(17,"input",24),e.nI1(18,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.clientName,l)||(i.pagination.clientName=l),e.Njj(l)}),e.k0s(),e.nrm(19,"i",22),e.k0s()(),e.j41(20,"div",19)(21,"div",20)(22,"ng-select",25),e.nI1(23,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.salesPersonId,l)||(i.pagination.salesPersonId=l),e.Njj(l)}),e.k0s()()(),e.j41(24,"div",19)(25,"input",23),e.nI1(26,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.searchForm.dates,l)||(i.searchForm.dates=l),e.Njj(l)}),e.k0s()(),e.j41(27,"div",19)(28,"div",20)(29,"ng-select",26),e.nI1(30,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.regionId,l)||(i.pagination.regionId=l),e.Njj(l)}),e.k0s()()(),e.j41(31,"div",19)(32,"div",20)(33,"ng-select",27),e.nI1(34,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.cityId,l)||(i.pagination.cityId=l),e.Njj(l)}),e.k0s()()(),e.j41(35,"div",19)(36,"div",20)(37,"ng-select",28),e.nI1(38,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.status,l)||(i.pagination.status=l),e.Njj(l)}),e.k0s()()(),e.j41(39,"div",19)(40,"div",20)(41,"ng-select",29),e.nI1(42,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.storeId,l)||(i.pagination.storeId=l),e.Njj(l)}),e.k0s()()(),e.bVm(),e.k0s(),e.j41(43,"div",30)(44,"div",31)(45,"p-table",32,0),e.bIt("onLazyLoad",function(l){return e.eBV(a),e.Njj(i.tableChange(l))})("selectionChange",function(l){return e.eBV(a),e.Njj(i.onSelectionChange(l))}),e.DNE(47,xs,36,2,"ng-template",33)(48,qs,53,43,"ng-template",34)(49,Qs,15,1,"ng-template",35),e.k0s()(),e.DNE(50,Hs,2,0,"div",36)(51,Ws,6,8,"div",37),e.k0s()()()(),e.DNE(52,Js,1,0,"ng-template",null,1,e.C5r)(54,Zs,1,1,"ng-template",null,2,e.C5r)(56,Ks,1,3,"ng-template",null,3,e.C5r)(58,eo,1,3,"ng-template",null,4,e.C5r)(60,to,1,1,"ng-template",null,5,e.C5r)(62,io,15,3,"ng-template",null,6,e.C5r)(64,ro,16,6,"ng-template",null,7,e.C5r)(66,ao,1,1,"ng-template",null,8,e.C5r)(68,lo,42,15,"ng-template",null,9,e.C5r)}2&n&&(e.Y8G("hasPermission",e.lJ4(63,rs)),e.R7$(4),e.Y8G("loaderId","allLoader"),e.R7$(),e.Y8G("addPermission",e.lJ4(64,as))("showAdd",!0)("showExport",!0)("totalItems",i.pagination.totalItems)("title",""),e.R7$(4),e.FS9("placeholder",e.bMT(10,45,"orderManagement.order.orderCode")),e.R50("ngModel",i.pagination.id),e.R7$(4),e.FS9("placeholder",e.bMT(14,47,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",i.searchForm.creationDates),e.R7$(4),e.FS9("placeholder",e.bMT(18,49,"orderManagement.order.agentName")),e.R50("ngModel",i.pagination.clientName),e.R7$(5),e.FS9("placeholder",e.bMT(23,51,"sales.salesOrder.salsePerson")),e.Y8G("items",i.salesPersons)("multiple",!1),e.R50("ngModel",i.pagination.salesPersonId),e.R7$(3),e.FS9("placeholder",e.bMT(26,53,"sales.salesOrder.clientVisitDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",i.searchForm.dates),e.R7$(4),e.FS9("placeholder",e.bMT(30,55,"client.client.regionName")),e.Y8G("items",i.regions)("multiple",!1),e.R50("ngModel",i.pagination.regionId),e.R7$(4),e.FS9("placeholder",e.bMT(34,57,"client.client.cityName")),e.Y8G("items",i.cities)("multiple",!1),e.R50("ngModel",i.pagination.cityId),e.R7$(4),e.FS9("placeholder",e.bMT(38,59,"orderManagement.order.status")),e.Y8G("items",i.statusList)("multiple",!1),e.R50("ngModel",i.pagination.status),e.R7$(4),e.FS9("placeholder",e.bMT(42,61,"sales.salesOrder.storeName")),e.Y8G("items",i.stores)("multiple",!1),e.R50("ngModel",i.pagination.storeId),e.R7$(4),e.Y8G("value",i.entities)("rows",i.pagination.pageSize)("lazy",!0)("totalRecords",i.pagination.totalItems),e.R7$(5),e.Y8G("ngIf",i.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",i.pagination.totalItems>0))},dependencies:[p.YU,p.Sq,p.bT,d.qT,d.me,d.Q0,d.BC,d.cb,d.YS,d.vS,d.cV,_.s5,G.kL,W.b,z.w,J.p,Z.g,ce.x,g.Mm,V.XI,q.Ei,V.Tg,V.FP,w.Cv,P.vr,B.m,A.p,de.m,Re,Fe,p.vh,g.D9],encapsulation:2})}}return r})();const co=()=>["salesOrder.register"],mo=()=>["salesOrderStore.assignTrunk"],po=()=>["salesOrderStore.prepare"],He=r=>[r];function uo(r,s){1&r&&(e.j41(0,"th",67),e.EFF(1," sales.salesOrder.trunck "),e.k0s())}function go(r,s){1&r&&(e.j41(0,"th",62),e.EFF(1," sales.salesOrder.trunckStatus "),e.k0s())}function _o(r,s){if(1&r&&(e.j41(0,"tr",53),e.nrm(1,"th",54),e.j41(2,"th",55),e.EFF(3,"#"),e.k0s(),e.j41(4,"th",56),e.nrm(5,"i",57),e.EFF(6," orderManagement.order.orderCode "),e.k0s(),e.j41(7,"th",58),e.nrm(8,"i",57),e.EFF(9," orderManagement.order.creation "),e.k0s(),e.j41(10,"th",59),e.EFF(11," orderManagement.order.status "),e.k0s(),e.j41(12,"th",60),e.nrm(13,"i",57),e.EFF(14," orderManagement.order.agentName "),e.k0s(),e.j41(15,"th",61),e.EFF(16," sales.salesOrder.clientLocationName "),e.k0s(),e.j41(17,"th",62),e.EFF(18," sales.salesOrder.salsePerson "),e.k0s(),e.j41(19,"th",63),e.nrm(20,"i",57),e.EFF(21," sales.salesOrder.clientVisitDate "),e.k0s(),e.j41(22,"th",64),e.nrm(23,"i",57),e.EFF(24," sales.salesOrder.totalQuantity "),e.k0s(),e.DNE(25,uo,2,0,"th",65)(26,go,2,0,"th",66),e.nrm(27,"th",62),e.k0s()),2&r){const t=e.XpG();e.R7$(25),e.Y8G("ngIf",t.showInfo),e.R7$(),e.Y8G("ngIf",t.showInfo)}}function ho(r,s){1&r&&e.nrm(0,"span",78)}function fo(r,s){if(1&r&&(e.j41(0,"a",79),e.nrm(1,"i",80),e.k0s()),2&r){const t=e.XpG().$implicit,n=e.XpG();e.Y8G("href",n.mapUrl(null==t?null:t.lng,null==t?null:t.lat),e.B4B)}}function bo(r,s){if(1&r&&(e.j41(0,"td")(1,"div"),e.EFF(2),e.k0s(),e.j41(3,"div",81),e.EFF(4),e.k0s()()),2&r){const t=e.XpG().$implicit;e.R7$(2),e.JRh(t.shippingTruckName),e.R7$(2),e.JRh(t.driverName)}}function vo(r,s){if(1&r&&(e.j41(0,"td")(1,"div")(2,"span"),e.EFF(3),e.nI1(4,"translate"),e.k0s()()()),2&r){const t=e.XpG().$implicit;e.R7$(),e.ZvI("badge badge-success   ",t.trunckStatusName," round-shape"),e.R7$(2),e.JRh(e.bMT(4,4,"sales.salesOrder."+t.trunckStatusName))}}function So(r,s){if(1&r){const t=e.RV6();e.j41(0,"button",83),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2).$implicit,a=e.XpG(),o=e.sdS(107);return e.Njj(a.openShippingModal(i.id,o,"lg"))}),e.nrm(2,"i",84),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"sales.salesOrderStore.trunkAssign"))}function Co(r,s){if(1&r&&(e.qex(0),e.DNE(1,So,3,3,"button",82),e.bVm()),2&r){const t=e.XpG().$implicit;e.R7$(),e.Y8G("ngIf",32==t.offerOrderStatus)}}function xo(r,s){if(1&r){const t=e.RV6();e.j41(0,"button",86),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2).$implicit,a=e.XpG(),o=e.sdS(101);return e.Njj(a.openStatusModal(i.id,o,32,"md"))}),e.nrm(2,"i",87),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"sales.salesOrderStore.ready"))}function yo(r,s){if(1&r){const t=e.RV6();e.j41(0,"button",83),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2).$implicit,a=e.XpG();return e.Njj(a.PrintStoreReport(i.id))}),e.nrm(2,"i",88),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"general.action.print"))}function Io(r,s){if(1&r&&(e.qex(0),e.DNE(1,xo,3,3,"button",85)(2,yo,3,3,"button",82),e.bVm()),2&r){const t=e.XpG().$implicit;e.R7$(),e.Y8G("ngIf",30==t.offerOrderStatus),e.R7$(),e.Y8G("ngIf",30==t.offerOrderStatus)}}function jo(r,s){if(1&r){const t=e.RV6();e.j41(0,"tr",68)(1,"td"),e.nrm(2,"button",69),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td")(6,"bdi",70),e.EFF(7),e.k0s()(),e.j41(8,"td"),e.EFF(9),e.nI1(10,"date"),e.k0s(),e.j41(11,"td")(12,"span"),e.nrm(13,"span",71),e.k0s()(),e.j41(14,"td",72),e.bIt("click",function(){const i=e.eBV(t).$implicit,a=e.XpG(),o=e.sdS(99);return e.Njj(a.openModal(i.clientId,o,"md"))}),e.j41(15,"a",73),e.EFF(16),e.k0s()(),e.j41(17,"td"),e.DNE(18,ho,1,0,"span",74)(19,fo,2,1,"a",75),e.k0s(),e.j41(20,"td"),e.EFF(21),e.k0s(),e.j41(22,"td"),e.EFF(23),e.nI1(24,"date"),e.k0s(),e.j41(25,"td"),e.EFF(26),e.k0s(),e.DNE(27,bo,5,2,"td",76)(28,vo,5,6,"td",76),e.j41(29,"td"),e.DNE(30,Co,2,1,"ng-container",77)(31,Io,3,2,"ng-container",77),e.k0s()()}if(2&r){const t=s.$implicit,n=s.rowIndex,i=s.expanded,a=e.XpG();e.R7$(2),e.Y8G("pRowToggler",t)("ngClass",i?" ri-arrow-down-s-line":"  ri-arrow-up-s-line"),e.R7$(2),e.JRh(n+1),e.R7$(3),e.SpI("#SO#",t.id,""),e.R7$(2),e.SpI(" ",e.i5U(10,19,t.creationTime,"yyyy-MM-dd HH:mm")," "),e.R7$(3),e.ZvI("badge ",a.getStatus(t),""),e.R7$(),e.FS9("translate","sales.salesOrder."+t.offerOrderStatusValue),e.R7$(3),e.SpI(" ",t.clientName," "),e.R7$(2),e.Y8G("ngIf",""==t.lng),e.R7$(),e.Y8G("ngIf",null==t?null:t.lng),e.R7$(2),e.JRh(t.salsePersonName),e.R7$(2),e.SpI(" ",e.i5U(24,22,t.acutalVisitDate,"yyyy-MM-dd HH:mm"),""),e.R7$(3),e.JRh(t.totalQuantity),e.R7$(),e.Y8G("ngIf",a.showInfo),e.R7$(),e.Y8G("ngIf",a.showInfo),e.R7$(2),e.Y8G("hasPermission",e.lJ4(25,mo)),e.R7$(),e.Y8G("hasPermission",e.lJ4(26,po))}}function To(r,s){if(1&r&&(e.qex(0),e.j41(1,"tr")(2,"td"),e.EFF(3),e.k0s(),e.j41(4,"td"),e.EFF(5),e.k0s(),e.j41(6,"td"),e.EFF(7),e.k0s(),e.j41(8,"td"),e.EFF(9),e.k0s()(),e.bVm()),2&r){const t=s.$implicit,n=s.index;e.R7$(3),e.JRh(n+1),e.R7$(2),e.JRh(t.itemName),e.R7$(2),e.JRh(t.unitName),e.R7$(2),e.JRh(t.approvedQuantity)}}function ko(r,s){if(1&r&&(e.j41(0,"tr")(1,"td",89)(2,"div")(3,"table",90)(4,"thead")(5,"tr",91)(6,"th",92),e.EFF(7,"# "),e.k0s(),e.nrm(8,"th",93)(9,"th",94)(10,"th",95),e.k0s()(),e.j41(11,"tbody"),e.DNE(12,To,10,4,"ng-container",96),e.k0s()()()()()),2&r){const t=s.$implicit;e.R7$(12),e.Y8G("ngForOf",t.offerOrderDetails)}}function wo(r,s){1&r&&(e.j41(0,"div",97),e.EFF(1," general.table.noData "),e.k0s())}function Mo(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",98)(1,"div",99),e.nrm(2,"ngb-pagination-info",100),e.j41(3,"table-length",101),e.bIt("lengthChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.ListItemChange(i))}),e.k0s()(),e.j41(4,"div",102)(5,"ngb-pagination",103),e.bIt("pageChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.pageChanged(i))}),e.mxI("pageChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.pagination.pageNumber,i)||(a.pagination.pageNumber=i),e.Njj(i)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function Oo(r,s){if(1&r){const t=e.RV6();e.j41(0,"delete-modal",104),e.bIt("deleteConfirm",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.DeleteConfirm())})("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}}function Ro(r,s){if(1&r){const t=e.RV6();e.j41(0,"app-all-orders-details",105),e.bIt("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderDetails",t.operationId)}}function Fo(r,s){if(1&r){const t=e.RV6();e.j41(0,"sales-edit-order",106),e.bIt("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("isChangeQuantity",!0)("isDraft",!0)("orderSelected",t.operationId)}}function Vo(r,s){if(1&r){const t=e.RV6();e.j41(0,"sales-edit-order",106),e.bIt("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("isChangeQuantity",!0)("isDraft",!0)("orderSelected",t.operationId)}}function Eo(r,s){if(1&r){const t=e.RV6();e.j41(0,"client-summary",107),e.bIt("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("clientId",t.operationId)}}function No(r,s){if(1&r){const t=e.RV6();e.j41(0,"form",108,10),e.bIt("ngSubmit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.SubmitOrder())}),e.nrm(2,"ngx-ui-loader",109),e.j41(3,"div",110)(4,"div",111)(5,"button",112),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()(),e.j41(6,"div",113)(7,"div",114),e.nrm(8,"lord-icon",115),e.j41(9,"div",116),e.nrm(10,"h3",117)(11,"p",118),e.k0s()(),e.j41(12,"div",119),e.nrm(13,"button",120),e.j41(14,"button",121),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()()()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}function Do(r,s){1&r&&(e.j41(0,"div",128),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function Lo(r,s){if(1&r){const t=e.RV6();e.j41(0,"form",108,10),e.bIt("ngSubmit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.RequestChangeQuantity())}),e.nrm(2,"ngx-ui-loader",109),e.j41(3,"div",110)(4,"div",111)(5,"button",112),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()(),e.j41(6,"div",113)(7,"div",122)(8,"label",123),e.EFF(9,"sales.salesOrder.changeQuantityMessage"),e.k0s(),e.j41(10,"textarea",124,11),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.changeQuantityMessage,i)||(a.form.changeQuantityMessage=i),e.Njj(i)}),e.k0s(),e.DNE(12,Do,2,0,"div",125),e.k0s(),e.j41(13,"div",119),e.nrm(14,"button",126),e.j41(15,"button",127),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()()()()()}if(2&r){const t=e.sdS(1),n=e.sdS(11),i=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",i.loaderOperationShap)("loaderId",i.deleteLoader),e.R7$(8),e.R50("ngModel",i.form.changeQuantityMessage),e.R7$(2),e.Y8G("ngIf",n.invalid&&n.touched),e.R7$(2),e.Y8G("disabled",!t.valid)}}function Go(r,s){if(1&r){const t=e.RV6();e.j41(0,"cancel-sales-model",129),e.bIt("success",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.reload())})("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderId",t.operationId)}}function Po(r,s){if(1&r){const t=e.RV6();e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td")(4,"ng-select",158),e.mxI("ngModelChange",function(i){const a=e.eBV(t).$implicit;return e.DH7(a.unitId,i)||(a.unitId=i),e.Njj(i)}),e.k0s()(),e.j41(5,"td")(6,"input",159),e.bIt("ngModelChange",function(i){const a=e.eBV(t).$index,o=e.XpG(2);return e.Njj(o.quantitySelect(i,a))}),e.mxI("ngModelChange",function(i){const a=e.eBV(t).$implicit;return e.DH7(a.quantity,i)||(a.quantity=i),e.Njj(i)}),e.k0s()()()}if(2&r){const t=s.$implicit,n=s.$index;e.R7$(2),e.SpI(" ",t.itemName," "),e.R7$(2),e.Y8G("name","unitId"+e.eq3(6,He,n))("items",t.units),e.R50("ngModel",t.unitId),e.R7$(2),e.Y8G("name","quantity"+e.eq3(8,He,n)),e.R50("ngModel",t.quantity)}}function $o(r,s){if(1&r){const t=e.RV6();e.j41(0,"tr",160),e.nrm(1,"td",161),e.j41(2,"td",162)(3,"table",163)(4,"tbody")(5,"tr"),e.nrm(6,"td",164),e.j41(7,"td",165),e.EFF(8),e.nI1(9,"translate"),e.k0s()(),e.j41(10,"tr"),e.nrm(11,"td",166),e.j41(12,"td",165)(13,"div",167)(14,"ng-select",168),e.bIt("change",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.getTotal())}),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG(2);return e.DH7(a.form.totalAddDiscountType,i)||(a.form.totalAddDiscountType=i),e.Njj(i)}),e.k0s(),e.j41(15,"input",169),e.bIt("change",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.getTotal())}),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG(2);return e.DH7(a.form.totalAddDiscount,i)||(a.form.totalAddDiscount=i),e.Njj(i)}),e.k0s()()()(),e.j41(16,"tr",170),e.nrm(17,"td",171),e.j41(18,"td",165),e.EFF(19),e.nI1(20,"translate"),e.k0s()(),e.j41(21,"tr",172),e.nrm(22,"th",173),e.j41(23,"th",165),e.EFF(24),e.nI1(25,"translate"),e.k0s()()()()()()}if(2&r){const t=e.XpG(2);e.R7$(8),e.Lme("",t.form.total," ",e.bMT(9,9,"orderManagement.order.currancy"),""),e.R7$(6),e.Y8G("items",t.discountTypes),e.R50("ngModel",t.form.totalAddDiscountType),e.R7$(),e.R50("ngModel",t.form.totalAddDiscount),e.R7$(4),e.Lme("",t.form.tax," ",e.bMT(20,11,"orderManagement.order.currancy"),""),e.R7$(5),e.Lme("",t.form.totalNet," ",e.bMT(25,13,"orderManagement.order.currancy"),"")}}function Bo(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",130)(1,"div",131)(2,"h4",132),e.nrm(3,"span",133),e.k0s(),e.j41(4,"button",134),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss("Cross click"))}),e.k0s()(),e.j41(5,"div",113),e.nrm(6,"ngx-ui-loader",109),e.j41(7,"form",135,10),e.bIt("submit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.updateTruck())}),e.j41(9,"div",28)(10,"div",136)(11,"label",137),e.EFF(12,"sales.salesOrder.acutalDeliveryDate"),e.k0s(),e.j41(13,"input",138),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.dateChangeModal(i))}),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.acutalVisitDate,i)||(a.form.acutalVisitDate=i),e.Njj(i)}),e.k0s()(),e.j41(14,"div",136),e.nrm(15,"label",139),e.j41(16,"ng-select",140),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.clientLocationId,i)||(a.form.clientLocationId=i),e.Njj(i)}),e.k0s()(),e.j41(17,"div",141)(18,"label",137),e.EFF(19,"sales.salesOrder.truncks"),e.k0s(),e.j41(20,"ng-select",142),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.shippingTruckId,i)||(a.form.shippingTruckId=i),e.Njj(i)}),e.k0s()()(),e.j41(21,"div",143)(22,"div",14)(23,"div",144)(24,"div",145),e.nrm(25,"h5",146),e.k0s()(),e.j41(26,"div",45)(27,"div",147)(28,"table",148)(29,"thead",149)(30,"tr"),e.nrm(31,"th",150)(32,"th",151)(33,"th",152),e.k0s()(),e.j41(34,"tbody"),e.Z7z(35,Po,7,10,"tr",null,e.Vm6),e.DNE(37,$o,26,15,"tr",153),e.k0s()()()()()(),e.j41(38,"div",154)(39,"button",155),e.nrm(40,"i",156)(41,"span",157),e.k0s()()()()()}if(2&r){const t=e.sdS(8),n=e.XpG();e.R7$(6),e.Y8G("hasProgressBar",!1)("fgsType",n.loaderOperationShap)("loaderId",n.operationLoader),e.R7$(7),e.R50("ngModel",n.form.acutalVisitDate),e.Y8G("altInput",!0)("enableTime",!0)("convertModelValue",!0)("dateFormat","d-m-Y H:i"),e.R7$(3),e.Y8G("disabled",!0)("items",n.locations),e.R50("ngModel",n.form.clientLocationId),e.R7$(4),e.Y8G("items",n.truncks),e.R50("ngModel",n.form.shippingTruckId),e.R7$(15),e.Dyx(n.form.details),e.R7$(2),e.Y8G("ngIf",!1),e.R7$(2),e.Y8G("disabled",!t.valid)}}let Xo=(()=>{class r extends X.w{constructor(t,n,i,a,o,l,h,x,y,I,j,T,b,C,O,F){super(t,n,h,i,a,o,l),this.baseService=i,this.authDaamService=x,this.teamService=y,this.employeeService=I,this.regionService=j,this.cityService=T,this.storesService=b,this.excelService=C,this.router=O,this.orderReceivedService=F,this.title="sales.salesOrderStore.title",this.titleOperation="sales.salesOrderStore.titleOperation",this.keySelected="",this.searchForm={},this.isResolveList=!0,this.employeeGroups=[],this.activeindex="2",this.active=2,this.clientSelected=0,this.status=[],this.countLoad=2,this.isOrderEdit=!1,this.orderSelected={},this.users=[],this.statusCount={},this.salesPersons=[],this.regions=[],this.cities=[],this.count={},this.truncks=[],this.locations=[],this.discountTypes=[],this.pagination={pageNumber:1,pageSize:10,status:30},this.showInfo=!1,this.stores=[],this.statusList=[],this.setDates=(k,$,L)=>{if(k?.from||k?.to){const se=k.to||k.from;this.pagination[$]=this.datePipe.transform(k.from||k.to,"yyyy-MM-ddT00:00:00"),this.pagination[L]=this.datePipe.transform(se,"yyyy-MM-ddT23:59:59.999")}else this.pagination[$]=null,this.pagination[L]=null},this.configRoute(),this.GetSalesPersons(),this.GetRegions(),this.GetCities(),this.GetStores(),this.GetOfferOrderCount(),this.checkStatus()}checkStatus(){let t=this.orderReceivedService.getTrunckStatus();t.forEach(n=>{n.name=this.getTranslationText("sales.salesOrder."+n.name)}),this.statusList=t}GetOfferOrderCount(){this.baseService.GetOfferOrderStoreCount().subscribe(t=>{this.count=t.data})}GetRegions(){this.regionService.getDropDown().subscribe(t=>{this.regions=t.data},t=>{console.log(t)})}GetStores(){this.storesService.getDropDown().subscribe(t=>{this.stores=t.data},t=>{console.log(t)})}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetSalesPersons(){this.employeeService.GetAllByType(9).subscribe(t=>{this.salesPersons=t.data},t=>{console.log(t)})}ngOnInitMore(){this.discountTypes=this.baseService.discountTypes,this.discountTypes.forEach(t=>{t.name=this.getTranslationText("sales.salesOrder."+t.name)})}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,m.Q)(this.notifier)).subscribe(n=>{n?this.alertService.success():this.alertService.error("general.message."+n)},n=>{this.alertService.error()})}mapRegisterForm(t){let n={...t};return n.employeeCode=0,n}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader("allLoader"),this.setDates(t.dates,"visitDateFrom","visitDateTo"),this.setDates(t.creationDates,"creationTimeFrom","creationTimeTo"),this.loadentities()}LoadSuccess(){this.ngxLoader.stopLoader("allLoader")}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems},this.loadentities()}configRoute(){this.routerActive.data.pipe((0,m.Q)(this.notifier)).subscribe(t=>{this.entities=t.data,this.pagination.totalItems=t.data?.totalItems},()=>{this.alertService.error()})}mapExcel(){let t=[];return this.entities.forEach(n=>{t.push({Code:n.id,CreatorName:n.creatorName,creationTime:n.creationTime,clientName:n.clientName,Status:this.getTranslationText("sales.salesOrder."+n.offerOrderStatusValue),salse_Person:n.salsePersonName,"Delivery.Date":n.acutalVisitDate,"T.Quantity":n.totalQuantity," T.Discount":n.totalDiscount,Tax:n.totalTax,Net:n.netPrice,Reason:n.cancelReasonName})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}getStatus(t){return 10==t.offerOrderStatus||5==t.offerOrderStatus?"bg-warning":20==t.offerOrderStatus?"bg-secondary ":30==t.offerOrderStatus?"bg-info":60==t.offerOrderStatus?"bg-success":40==t.offerOrderStatus?"bg-danger":50==t.offerOrderStatus?"bg-info":"bg-warning"}checkEdit(t){return!t.isCancel&&!t.isFinish}openModalClient(t,n,i="xl"){this.clientSelected=t.orderCode,this.orderSelected=t,this.isOrderEdit=!1,this.modalService.open(n,{centered:!0,size:i})}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}goNew(){this.router.navigateByUrl("/sales/new")}onSelectStatus(t){this.showInfo=!1,-1==t?this.pagination.status=null:0==t?(this.pagination.statusList=[30,40,32,50,60,100],this.pagination.status=null,this.showInfo=!0):(this.pagination.statusList=[],this.pagination.status=t),this.onSearch()}openStatusModal(t,n,i,a="md"){this.isEditForm=!1,this.form={},this.form={id:t,status:i},this.modalService.open(n,{centered:!0,size:a})}SubmitOrder(){this.ngxLoader.startLoader(u.Fq),this.baseService.changStatus({id:this.form.id,status:this.form.status}).pipe((0,v.O)(),(0,R.c)(this.mainDelay),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader(u.Fq))).subscribe({next:n=>{this.modalService.dismissAll(),this.reload(),this.alertService.success()}})}cancelOrder(){this.ngxLoader.startLoader(u.Fq),console.log(this.operationId),this.baseService.changStatus({id:this.operationId,status:40}).pipe((0,v.O)(),(0,R.c)(this.mainDelay),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader(u.Fq))).subscribe({next:n=>{this.modalService.dismissAll(),this.reload(),this.alertService.success()}})}RequestChangeQuantity(){this.ngxLoader.startLoader(u.Fq),console.log(this.operationId),this.baseService.RequestChangeQuantity({id:this.operationId,changeQuantityMessage:this.form.changeQuantityMessage}).pipe((0,v.O)(),(0,R.c)(this.mainDelay),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader(u.Fq))).subscribe({next:n=>{this.modalService.dismissAll(),this.reload(),this.alertService.success()}})}reload(){this.modalService.dismissAll(),this.GetOfferOrderCount(),this.loadentities()}formatDate(t){if(!t)return"";const n=new Date(t);return n.getDate().toString().padStart(2,"0")+"-"+(n.getMonth()+1).toString().padStart(2,"0")+"-"+n.getFullYear()+" "+n.getHours().toString().padStart(2,"0")+":"+n.getMinutes().toString().padStart(2,"0")}openShippingModal(t,n,i="md"){this.baseService.GetTrucks({id:t,acutalVisitDate:null}).subscribe(o=>{o.success?(this.form=o.data.order,this.getTotal(),this.form.clientVisitDate=this.formatDate(this.form.clientVisitDate),this.form.acutalVisitDate=this.formatDate(this.form.acutalVisitDate),this.truncks=o.data.truncks,this.locations=o.data.locations,this.modalService.open(n,{centered:!0,size:i})):this.alertService.error("general.message."+o.message)},o=>{this.alertService.error("general.message."+o)})}getTotal(){let t=0,n=0,i=0;this.form.details.forEach(a=>{a.discount<0&&(a.discoun=0);let o=a.quantity*a.price,l=0;1===a.discountType?l=a.discount:2===a.discountType&&(l=o*a.discount/100),n=+l;let h=o-l;a.net=h,t=+h}),1===this.form.totalAddDiscountType?i=this.form.totalAddDiscount:2===this.form.totalAddDiscountType&&(i=t*this.form.totalAddDiscount/100),this.form.total=t,this.form.totalAddDiscount=this.form.totalAddDiscount,this.form.tax=15*this.form.total/100,this.form.totalNet=this.form.total-i+this.form.tax}updateTruck(){this.form.acutalVisitDate=new Date(this.convertToISO(this.form.acutalVisitDate));let t={shippingTruckId:this.form.shippingTruckId,clientLocationId:this.form.clientLocationId,offerOrderMasterId:this.form.id,Notes:this.form.notes,terms:this.form.terms,deliveryDate:this.datePipe.transform(this.form.acutalVisitDate,"yyyy-MM-ddTHH:mm:00.000"),details:this.form.details.map(n=>({id:0,itemId:n.itemId,itemName:n.itemName,quantity:n.quantity,unitId:n.unitId,price:n.price,isFree:n.isFree,originalPrice:n.originalPrice,discount:n.discount,discountType:n.discountType,clientQuantity:n.clientQuantity,approvedQuantity:n.approvedQuantity}))};this.ngxLoader.startLoader(this.operationLoader),this.orderReceivedService.register(t).pipe((0,v.O)(),(0,R.c)(this.mainDelay),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(n=>{n.success?this.reload():this.alertService.error("general.message."+n.message)},n=>{this.alertService.error("general.message."+n)})}convertToISO(t){if(t instanceof Date)return t.toISOString();if("string"==typeof t){const[n,i,a,o,l]=t.split(/[-\s:]/);return`${a}-${i}-${n}T${o}:${l}:00`}}dateChangeModal(t){t=new Date(t);let n={id:this.form.id,acutalVisitDate:this.datePipe.transform(t,"yyyy-MM-ddT00:00:00.000")};this.baseService.GetTrucks(n).subscribe(i=>{i.success?this.truncks=i.data.truncks:this.alertService.error("general.message."+i.message)},i=>{this.alertService.error("general.message."+i)})}quantitySelect(t,n){t&&(t<=0&&(t=1),this.form.details[n].quantity=parseInt(t),this.form.details[n].net=this.form.details[n].price*this.form.details[n].quantity,this.discountSelect(this.form.details[n].discount,n),this.getTotal())}discountSelect(t,n,i=1){if(t){(t=parseInt(t))<=0&&(this.form.details[n].discount=0),1==i&&(this.form.details[n].discount=t);let a=0;1==this.form.details[n].discountType?a=this.form.details[n].discount:(a=this.form.details[n].price*this.form.details[n].quantity*this.form.details[n].discount/100,a=+a.toFixed(2)),this.form.details[n].net=this.form.details[n].price*this.form.details[n].quantity-a,this.form.details[n].net=this.form.details[n].net.toFixed(2),this.getTotal()}}PrintOrderReceived(t){this.ngxLoader.startLoader("allLoader"),this.orderReceivedService.PrintOrderReceived(t).pipe((0,v.O)(),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader("allLoader"))).subscribe(n=>{this.openUrl(n)},n=>{this.alertService.error("general.message."+n)})}openUrl(t){let n=new Blob([t],{type:t.type});var i=URL.createObjectURL(n);window.open(i,"_blank")}mapUrl(t,n){return null===t||null==n?"":`https://www.google.com/maps/dir//${n},${t}/@${n},${t},17z?hl=en-US`}loadentities(){this.baseService.GetOrderStore(this.pagination).pipe((0,m.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader(u.a7),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader(u.a7),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[]}PrintStoreReport(t){this.ngxLoader.startLoader("allLoader"),this.baseService.PrintStoreReport(t).pipe((0,v.O)(),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader("allLoader"))).subscribe(n=>{this.openUrl(n)},n=>{this.alertService.error()})}static{this.\u0275fac=function(n){return new(n||r)(e.rXU(M.nX),e.rXU(g.c$),e.rXU(U.A),e.rXU(E.u),e.rXU(p.vh),e.rXU(w.eD),e.rXU(_.Bq),e.rXU(fe.J),e.rXU(Me.n),e.rXU(K.O),e.rXU(Ie.S),e.rXU(le.h),e.rXU(Oe.a),e.rXU(H.V),e.rXU(M.Ix),e.rXU(he.B))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-sales-order-store"]],features:[e.Vt3],decls:108,vars:74,consts:[["tableMaster",""],["deleteModal",""],["orderViewModel",""],["SalesEditModel",""],["SalesChangeModel",""],["ClientInfo",""],["StatusOrderModal",""],["SubmitChangeQuantityModal",""],["cancelModal",""],["SubmitOrderModal",""],["formEntity","ngForm"],["changeQuantityMessage","ngModel"],[1,"row","justify-content-center"],[1,"col-sm-12","col-md-3","cursor-pointer",3,"click"],[1,"card"],[1,"card-body","d-flex","gap-3","align-items-center"],[1,"avatar-sm"],[1,"avatar-title","bg-warning","border","border-opacity-25","rounded-2","fs-17"],[1,"ri-shopping-cart-2-fill"],[1,"flex-grow-1"],[1,"fs-15"],["translate","sales.salesOrderStore.deliveries",1,"mb-0","text-muted"],[1,"avatar-title","border","bg-success","border-opacity-25","rounded-2","fs-17"],["translate","sales.salesOrderStore.ready",1,"mb-0","text-muted"],[1,"avatar-title","border","bg-danger","border-opacity-25","rounded-2","fs-17"],["translate","sales.salesOrderStore.return",1,"mb-0","text-muted"],[1,"avatar-title","border","bg-primary","border-opacity-25","rounded-2","fs-17"],["translate","sales.salesOrderStore.history",1,"mb-0","text-muted"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"addNew","reset","search","exportXlsx","addPermission","showAdd","showExport","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","id","name","id",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],["InputTirmFilter","","type","search","id","clientName","name","clientName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["name","regionId","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],["name","cityId","bindValue","code","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],["name","storeId","bindValue","id","bindLabel","nameAR",3,"ngModelChange","items","multiple","placeholder","ngModel"],["name","trunckStatus","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],[2,"width",".2%"],["translate","",2,"width",".5%"],["pSortableColumn","id","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["pSortableColumn","creationTime","translate","",2,"width","10%"],["pSortableColumn","status","translate","",2,"width","6%"],["pSortableColumn","clientId","translate","",2,"width","15%"],["translate","",2,"width","3%"],["translate","",2,"width","8%"],["pSortableColumn","clientVisitDate","translate","",2,"width","10%"],["pSortableColumn","totalQuantity","translate","",2,"width","8%"],["style","width:12%","translate","",4,"ngIf"],["style","width:8%","translate","",4,"ngIf"],["translate","",2,"width","12%"],[1,"fs-5"],["type","button","pRipple","",1,"border-0","p-button-text","p-button-rounded","p-button-plain",3,"pRowToggler","ngClass"],[1,"code-pointer"],[3,"translate"],[3,"click"],["href","javascript:void(0)",1,"link-primary","link-offset-2","text-decoration-underline","link-underline-opacity-25","link-underline-opacity-100-hover"],["class","badge bg-danger-subtle text-danger mx-1","translate","orderManagement.order.noMap",4,"ngIf"],["target","_blank","class","badge bg-success-subtle text-success mx-1","translate","orderManagement.order.viewMap",3,"href",4,"ngIf"],[4,"ngIf"],[4,"hasPermission"],["translate","orderManagement.order.noMap",1,"badge","bg-danger-subtle","text-danger","mx-1"],["target","_blank","translate","orderManagement.order.viewMap",1,"badge","bg-success-subtle","text-success","mx-1",3,"href"],[1,"ri-map-pin-line"],[1,"badge","bg-primary","mx-2"],["class","btn btn-sm btn-primary edit-list mx-1","tooltipPosition","top",3,"pTooltip","click",4,"ngIf"],["tooltipPosition","top",1,"btn","btn-sm","btn-primary","edit-list","mx-1",3,"click","pTooltip"],[1,"ri-truck-line","align-bottom"],["class","btn btn-sm btn-warning edit-list mx-1","tooltipPosition","top",3,"pTooltip","click",4,"ngIf"],["tooltipPosition","top",1,"btn","btn-sm","btn-warning","edit-list","mx-1",3,"click","pTooltip"],[1,"ri-send-plane-fill","align-bottom"],[1,"ri-printer-fill","align-bottom"],["colspan","17"],["dataKey","id"],[1,"bg-light"],[2,"width","8%"],["translate","sales.salesOrder.itemName",2,"width","20%"],["translate","sales.salesOrder.unit",2,"width","6%"],["translate","sales.salesOrder.approvedQuantity",2,"width","8%"],[4,"ngFor","ngForOf"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"deleteConfirm","dismiss"],[3,"dismiss","orderDetails"],[3,"dismiss","isChangeQuantity","isDraft","orderSelected"],[3,"dismiss","clientId"],[3,"ngSubmit"],[3,"hasProgressBar","fgsType","loaderId"],[1,"modal-content"],[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mt-2","text-center"],["src","https://cdn.lordicon.com/gdfrsvpt.json","stroke","bold","state","hover-oscillate","trigger","loop","colors","primary:#f7b84b,secondary:#f06548",2,"width","130px","height","130px"],[1,"pt-2","fs-15","mx-4","mx-sm-5"],["translate","orderManagement.order.AreYouSureMessage"],[1,"text-muted","mx-4","mb-0"],[1,"d-flex","gap-2","justify-content-center","mt-4","mb-2"],["type","submit","id","save","translate","general.action.send",1,"btn","w-sm","btn-danger","fs-4"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light","fs-4",3,"click"],[1,"mb-2"],["for","changeQuantityMessage","translate","",1,"required","text-bold","form-label"],["rows","5","InputTirmFilter","","name","changeQuantityMessage","type","text","id","changeQuantityMessage",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["class","text-danger text-center  ","translate","",4,"ngIf"],["t","","type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger",3,"disabled"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],["translate","",1,"text-danger","text-center"],[3,"success","dismiss","orderId"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["translate","sales.salesOrder.truckUpdate"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[3,"submit"],[1,"col-12","col-md-3"],["for","name","translate","",1,"required","fw-bold","form-label"],["name","acutalVisitDate","type","text","mwlFlatpickr","","altFormat","d-m-Y H:i","required","",1,"form-control","flatpickr-input",3,"ngModelChange","ngModel","altInput","enableTime","convertModelValue","dateFormat"],["for","name","translate","orderManagement.order.savedAddress",1,"required","fw-bold","form-label"],["name","clientLocationId","bindValue","id","bindLabel","name","required","",2,"width","100%",3,"ngModelChange","disabled","items","ngModel"],[1,"col-12","col-md-6"],["name","shippingTruckId","bindValue","id","bindLabel","name","required","",2,"width","100%",3,"ngModelChange","items","ngModel"],[1,"row","justify-content-center","my-0"],[1,"card-header","p-0"],[1,"d-flex","align-items-center"],["translate","sales.salesRequests.items",1,"card-title","flex-grow-1","mb-0"],[1,"table-responsive","table-card",2,"overflow","visible"],[1,"table","table-nowrap","align-middle","table-borderless","mb-0"],[1,"table-light","text-muted","p-1"],["translate","sales.salesRequests.itemName",2,"width","20%"],["translate","sales.salesRequests.unit",2,"width","25%"],["translate","sales.salesRequests.quantity",2,"width","25%"],["class","border-top border-top-dashed",4,"ngIf"],[1,"d-flex","justify-content-center","m-0"],["type","submit","type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],["clearable","false","clearOnBackspace","false","bindValue","id","bindLabel","name",2,"width","100%",3,"ngModelChange","name","items","ngModel"],["type","text","id","quantity",1,"form-control","fs-6",3,"ngModelChange","name","ngModel"],[1,"border-top","border-top-dashed"],["colspan","3"],["colspan","4",1,"fw-medium","p-0"],[1,"table","table-borderless","mb-0"],["translate","sales.salesOrder.total",1,"m-0","p-0"],[1,"text-end","m-0","p-0"],["translate","sales.salesOrder.extraDiscount",1,"m-0","p-0"],[1,"input-group","mx-4",2,"width","80%"],["clearable","false","clearOnBackspace","false","name","totalAddDiscountType","bindValue","id","bindLabel","name",3,"change","ngModelChange","items","ngModel"],["InputTirmFilter","","name","totalAddDiscount","type","text","id","totalAddDiscount",1,"form-control","fs-6",2,"width","30%",3,"change","ngModelChange","ngModel"],[1,"m-0","p-0"],["translate","sales.salesOrder.tax",1,"m-0","p-0"],[1,"border-top","border-top-dashed","m-0","p-0"],["scope","row","translate","sales.salesOrder.net",1,"m-0","p-0"]],template:function(n,i){if(1&n){const a=e.RV6();e.j41(0,"div",12)(1,"div",13),e.bIt("click",function(){return e.eBV(a),e.Njj(i.onSelectStatus(30))}),e.j41(2,"div",14)(3,"div",15)(4,"div",16)(5,"div",17),e.nrm(6,"i",18),e.k0s()(),e.j41(7,"div",19)(8,"h5",20),e.EFF(9),e.k0s(),e.nrm(10,"p",21),e.k0s()()()(),e.j41(11,"div",13),e.bIt("click",function(){return e.eBV(a),e.Njj(i.onSelectStatus(32))}),e.j41(12,"div",14)(13,"div",15)(14,"div",16)(15,"div",22),e.nrm(16,"i",18),e.k0s()(),e.j41(17,"div",19)(18,"h5",20),e.EFF(19),e.k0s(),e.nrm(20,"p",23),e.k0s()()()(),e.j41(21,"div",13),e.bIt("click",function(){return e.eBV(a),e.Njj(i.onSelectStatus(100))}),e.j41(22,"div",14)(23,"div",15)(24,"div",16)(25,"div",24),e.nrm(26,"i",18),e.k0s()(),e.j41(27,"div",19)(28,"h5",20),e.EFF(29),e.k0s(),e.nrm(30,"p",25),e.k0s()()()(),e.j41(31,"div",13),e.bIt("click",function(){return e.eBV(a),e.Njj(i.onSelectStatus(0))}),e.j41(32,"div",14)(33,"div",15)(34,"div",16)(35,"div",26),e.nrm(36,"i",18),e.k0s()(),e.j41(37,"div",19),e.nrm(38,"p",27),e.k0s()()()()(),e.j41(39,"div",28)(40,"div",29)(41,"div",30),e.nrm(42,"ngx-ui-loader",31),e.j41(43,"base-filter",32),e.bIt("addNew",function(){return e.eBV(a),e.Njj(i.goNew())})("reset",function(){return e.eBV(a),e.Njj(i.onReset())})("search",function(){return e.eBV(a),e.Njj(i.onSearch())})("exportXlsx",function(){return e.eBV(a),e.Njj(i.onExportXlsx())}),e.qex(44,33),e.j41(45,"div",34)(46,"div",35)(47,"input",36),e.nI1(48,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.id,l)||(i.pagination.id=l),e.Njj(l)}),e.k0s(),e.nrm(49,"i",37),e.k0s()(),e.j41(50,"div",34)(51,"input",38),e.nI1(52,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.searchForm.creationDates,l)||(i.searchForm.creationDates=l),e.Njj(l)}),e.k0s()(),e.j41(53,"div",34)(54,"div",35)(55,"input",39),e.nI1(56,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.clientName,l)||(i.pagination.clientName=l),e.Njj(l)}),e.k0s(),e.nrm(57,"i",37),e.k0s()(),e.j41(58,"div",34)(59,"div",35)(60,"ng-select",40),e.nI1(61,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.salesPersonId,l)||(i.pagination.salesPersonId=l),e.Njj(l)}),e.k0s()()(),e.j41(62,"div",34)(63,"input",38),e.nI1(64,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.searchForm.dates,l)||(i.searchForm.dates=l),e.Njj(l)}),e.k0s()(),e.j41(65,"div",34)(66,"div",35)(67,"ng-select",41),e.nI1(68,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.regionId,l)||(i.pagination.regionId=l),e.Njj(l)}),e.k0s()()(),e.j41(69,"div",34)(70,"div",35)(71,"ng-select",42),e.nI1(72,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.cityId,l)||(i.pagination.cityId=l),e.Njj(l)}),e.k0s()()(),e.j41(73,"div",34)(74,"div",35)(75,"ng-select",43),e.nI1(76,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.storeId,l)||(i.pagination.storeId=l),e.Njj(l)}),e.k0s()()(),e.j41(77,"div",34)(78,"div",35)(79,"ng-select",44),e.nI1(80,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.trunckStatus,l)||(i.pagination.trunckStatus=l),e.Njj(l)}),e.k0s()()(),e.bVm(),e.k0s(),e.j41(81,"div",45)(82,"div",46)(83,"p-table",47,0),e.bIt("onLazyLoad",function(l){return e.eBV(a),e.Njj(i.tableChange(l))})("selectionChange",function(l){return e.eBV(a),e.Njj(i.onSelectionChange(l))}),e.DNE(85,_o,28,2,"ng-template",48)(86,jo,32,27,"ng-template",49)(87,ko,13,1,"ng-template",50),e.k0s()(),e.DNE(88,wo,2,0,"div",51)(89,Mo,6,8,"div",52),e.k0s()()()(),e.DNE(90,Oo,1,0,"ng-template",null,1,e.C5r)(92,Ro,1,1,"ng-template",null,2,e.C5r)(94,Fo,1,3,"ng-template",null,3,e.C5r)(96,Vo,1,3,"ng-template",null,4,e.C5r)(98,Eo,1,1,"ng-template",null,5,e.C5r)(100,No,15,3,"ng-template",null,6,e.C5r)(102,Lo,16,6,"ng-template",null,7,e.C5r)(104,Go,1,1,"ng-template",null,8,e.C5r)(106,Bo,42,15,"ng-template",null,9,e.C5r)}2&n&&(e.R7$(2),e.AVh("bg-primary-subtle",30==i.pagination.status),e.R7$(7),e.JRh(i.count.storeDeliveryOrder),e.R7$(3),e.AVh("bg-primary-subtle",32==i.pagination.status),e.R7$(7),e.JRh(i.count.repareOrder),e.R7$(3),e.AVh("bg-primary-subtle",100==i.pagination.status),e.R7$(7),e.JRh(i.count.return),e.R7$(3),e.AVh("bg-primary-subtle",0==i.pagination.status),e.R7$(10),e.Y8G("loaderId","allLoader"),e.R7$(),e.Y8G("addPermission",e.lJ4(73,co))("showAdd",!1)("showExport",!1)("totalItems",i.pagination.totalItems)("title",i.title),e.R7$(4),e.FS9("placeholder",e.bMT(48,55,"orderManagement.order.orderCode")),e.R50("ngModel",i.pagination.id),e.R7$(4),e.FS9("placeholder",e.bMT(52,57,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",i.searchForm.creationDates),e.R7$(4),e.FS9("placeholder",e.bMT(56,59,"orderManagement.order.agentName")),e.R50("ngModel",i.pagination.clientName),e.R7$(5),e.FS9("placeholder",e.bMT(61,61,"sales.salesOrder.salsePerson")),e.Y8G("items",i.salesPersons)("multiple",!1),e.R50("ngModel",i.pagination.salesPersonId),e.R7$(3),e.FS9("placeholder",e.bMT(64,63,"sales.salesOrder.clientVisitDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",i.searchForm.dates),e.R7$(4),e.FS9("placeholder",e.bMT(68,65,"client.client.regionName")),e.Y8G("items",i.regions)("multiple",!1),e.R50("ngModel",i.pagination.regionId),e.R7$(4),e.FS9("placeholder",e.bMT(72,67,"client.client.cityName")),e.Y8G("items",i.cities)("multiple",!1),e.R50("ngModel",i.pagination.cityId),e.R7$(4),e.FS9("placeholder",e.bMT(76,69,"sales.salesOrder.storeName")),e.Y8G("items",i.stores)("multiple",!1),e.R50("ngModel",i.pagination.storeId),e.R7$(4),e.FS9("placeholder",e.bMT(80,71,"sales.salesOrder.trunckStatus")),e.Y8G("items",i.statusList)("multiple",!1),e.R50("ngModel",i.pagination.trunckStatus),e.R7$(4),e.Y8G("value",i.entities)("rows",i.pagination.pageSize)("lazy",!0)("totalRecords",i.pagination.totalItems),e.R7$(5),e.Y8G("ngIf",i.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",i.pagination.totalItems>0))},dependencies:[p.YU,p.Sq,p.bT,d.qT,d.me,d.Q0,d.BC,d.cb,d.YS,d.vS,d.cV,_.s5,G.kL,W.b,z.w,J.p,Z.g,ce.x,g.Mm,V.XI,q.Ei,V.Tg,V.FP,w.Cv,P.vr,B.m,A.p,de.m,Re,Fe,p.vh,g.D9]})}}return r})(),Le=(()=>{class r extends Ce.d{constructor(t){super(t,Y.c.apiUrl+"RepresentativeVisitPlan/")}GetLookups(){return this.http.get(this.baseUrl+"GetLookups")}static{this.\u0275fac=function(n){return new(n||r)(e.KVO(xe.Qq))}}static{this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();const Ao=()=>["visitPlan.register"],qo=r=>({width:r}),Yo=()=>["visitPlan.edit"],Uo=()=>["visitPlan.delete"];function zo(r,s){1&r&&(e.j41(0,"tr",22)(1,"th",23),e.EFF(2,"#"),e.k0s(),e.j41(3,"th",24),e.nrm(4,"i",25),e.EFF(5," general.table.id "),e.k0s(),e.j41(6,"th",26),e.nrm(7,"i",25),e.EFF(8," sales.visitPlan.name "),e.k0s(),e.j41(9,"th",27),e.nrm(10,"i",25),e.EFF(11," sales.visitPlan.salesPersonName "),e.k0s(),e.j41(12,"th",28),e.nrm(13,"i",25),e.EFF(14," sales.visitPlan.dateFrom "),e.k0s(),e.j41(15,"th",29),e.nrm(16,"i",25),e.EFF(17," sales.visitPlan.dateTo "),e.k0s(),e.j41(18,"th",30),e.EFF(19," sales.visitPlan.visitCount "),e.k0s(),e.j41(20,"th",30),e.EFF(21," sales.visitPlan.statusPlan "),e.k0s(),e.nrm(22,"th",31),e.k0s())}function Qo(r,s){if(1&r&&(e.nrm(0,"i",45),e.EFF(1),e.nI1(2,"date"),e.nrm(3,"br")(4,"i",46),e.EFF(5),e.nI1(6,"date"),e.nrm(7,"br")(8,"i",47),e.EFF(9)),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",e.i5U(2,3,t.creationTime,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",e.i5U(6,6,t.lastModificationTime,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",t.creatorName," ")}}function Ho(r,s){if(1&r){const t=e.RV6();e.j41(0,"li",33),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,a=e.XpG();return e.Njj(a.goEdit(i.id))}),e.j41(1,"span",48),e.nrm(2,"i",49)(3,"span",50),e.k0s()()}}function Wo(r,s){if(1&r){const t=e.RV6();e.j41(0,"li",33),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,a=e.XpG(),o=e.sdS(26);return e.Njj(a.openModal(i.id,o))}),e.j41(1,"a",51),e.nrm(2,"i",52)(3,"span",53),e.k0s()()}}function Jo(r,s){if(1&r){const t=e.RV6();e.j41(0,"tr",32)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td",33),e.bIt("click",function(){const i=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.goEdit(i.id))}),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td"),e.EFF(10),e.nI1(11,"date"),e.k0s(),e.j41(12,"td"),e.EFF(13),e.nI1(14,"date"),e.k0s(),e.j41(15,"td")(16,"span",34),e.EFF(17),e.k0s()(),e.j41(18,"td")(19,"div",35)(20,"div",36)(21,"div",37),e.EFF(22),e.k0s()()()(),e.j41(23,"td"),e.DNE(24,Qo,10,9,"ng-template",null,2,e.C5r),e.j41(26,"span",38)(27,"div",39),e.nrm(28,"i",40),e.j41(29,"button",41),e.nrm(30,"i",42),e.k0s(),e.j41(31,"ul",43),e.DNE(32,Ho,4,0,"li",44)(33,Wo,4,0,"li",44),e.k0s()()()()()}if(2&r){const t=s.$implicit,n=s.rowIndex,i=e.sdS(25),a=e.XpG();e.R7$(2),e.JRh(n+1),e.R7$(2),e.JRh(t.id),e.R7$(2),e.JRh(t.name),e.R7$(2),e.JRh(t.salesPersonName),e.R7$(2),e.JRh(e.i5U(11,24,t.dateFrom,"yyyy-MM-dd")),e.R7$(3),e.JRh(e.i5U(14,27,t.dateTo,"yyyy-MM-dd")),e.R7$(4),e.JRh(t.visitsCount),e.R7$(3),e.AVh("bg-warning",0==t.visitsCompleteCount)("bg-info",t.visitsCompleteCount<t.visitsCount)("bg-success",t.visitsCompleteCount==t.visitsCount),e.Y8G("ngStyle",e.eq3(30,qo,a.getPrecentage(t.visitsCompleteCount,t.visitsCount)+"%")),e.R7$(),e.AVh("bg-warning",0==t.visitsCompleteCount)("bg-info",t.visitsCompleteCount<t.visitsCount)("bg-success",t.visitsCompleteCount==t.visitsCount),e.R7$(),e.SpI(" ",a.getPrecentage(t.visitsCompleteCount,t.visitsCount),"% "),e.R7$(6),e.Y8G("ngbTooltip",i),e.R7$(4),e.Y8G("hasPermission",e.lJ4(32,Yo)),e.R7$(),e.Y8G("hasPermission",e.lJ4(33,Uo))}}function Zo(r,s){1&r&&(e.j41(0,"div",54),e.EFF(1," general.table.noData"),e.k0s())}function Ko(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",55)(1,"div",56),e.nrm(2,"ngb-pagination-info",57),e.j41(3,"table-length",58),e.bIt("lengthChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.ListItemChange(i))}),e.k0s()(),e.j41(4,"div",59)(5,"ngb-pagination",60),e.bIt("pageChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.pageChanged(i))}),e.mxI("pageChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.pagination.pageNumber,i)||(a.pagination.pageNumber=i),e.Njj(i)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function el(r,s){if(1&r){const t=e.RV6();e.j41(0,"delete-modal",61),e.bIt("deleteConfirm",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.DeleteConfirm())})("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}}let tl=(()=>{class r extends X.w{constructor(t,n,i,a,o,l,h,x,y,I,j,T,b,C){super(t,n,h,i,a,o,l),this.baseService=i,this.excelService=y,this.clientService=I,this.clientGroupsService=j,this.offerOrderService=T,this.router=b,this.employeeService=C,this.title="sales.visitPlan.title",this.titleOperation="sales.visitPlan.titleOperation",this.keySelected="",this.assignUsers=[],this.times=[],this.employees=[],this.searchForm={},this.isResolveList=!0,this.countLoad=2,this.clientParam={pageSize:50,pageNumber:1,search:""},this.clients=[],this.loading=!1,this.salesPersons=[],this.setDates=(O,F,k)=>{if(O?.from||O?.to){const L=O.to||O.from;this.pagination[F]=this.datePipe.transform(O.from||O.to,"yyyy-MM-ddT00:00:00"),this.pagination[k]=this.datePipe.transform(L,"yyyy-MM-ddT23:59:59.999")}else this.pagination[F]=null,this.pagination[k]=null},this.configRoute(),this.GetSalesPersons()}GetSalesPersons(){this.employeeService.GetAllByType(9).pipe((0,m.Q)(this.notifier)).subscribe(t=>{this.salesPersons=t.data},t=>{console.log(t)})}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader("allLoader"),this.setDates(t.creationDates,"dateFrom","dateTo"),this.loadentities()}OnSearch(t){this.ngxLoader.startLoader(u.a7),this.loadentities()}configRoute(){}mapExcel(){let t=[];return this.entities?.forEach(n=>{t.push({Name:n.name,Sales_Man:n.salesPersonName,Datefrom:this.datePipe.transform(n.dateFrom,"yyyy-MM-ddd"),Dateto:this.datePipe.transform(n.dateTo,"yyyy-MM-ddd"),notes:n.notes})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.getTranslationText(this.title),[])}goEdit(t){this.router.navigateByUrl("/sales/visit-plan-edit/"+t,{state:{id:t}})}goRegister(){this.router.navigateByUrl("/sales/visit-plans/register")}DeleteConfirmSoft(){console.log(this.selectedRow,"selectedRow"),this.ngxLoader.startLoader(u.Fq),this.baseService.delete(this.selectedRow[0].id).pipe((0,v.O)(),(0,R.c)(this.mainDelay),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader(u.Fq))).subscribe(t=>{t.success?(this.alertService.success(),this.loadentities(),this.modalService.dismissAll(),this.resetSelected()):this.alertService.error("general.message."+t)},()=>{this.alertService.error()})}getPrecentage(t,n){return 0==t||0==n?0:Math.floor(t/n*100)}static{this.\u0275fac=function(n){return new(n||r)(e.rXU(M.nX),e.rXU(g.c$),e.rXU(Le),e.rXU(E.u),e.rXU(p.vh),e.rXU(w.eD),e.rXU(_.Bq),e.rXU(e.gRc),e.rXU(H.V),e.rXU(oe.X),e.rXU(we.t),e.rXU(U.A),e.rXU(M.Ix),e.rXU(K.O))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-visit-plan"]],features:[e.Vt3],decls:27,vars:26,consts:[["tableMaster",""],["deleteModal",""],["tooltipContent",""],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],[3,"reset","search","exportXlsx","addNew","addPermission","totalItems","title"],["control",""],[1,"col-md-4","mb-2"],[1,"search-box"],["type","search","id","name","name","name",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],[1,"col-12","col-md-3","mb-2"],["name","name","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-4 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["translate","",2,"width",".5%"],["pSortableColumn","code","translate","",2,"width","3%"],[1,"ri-expand-up-down-line"],["pSortableColumn","name","translate","",2,"width","15%"],["pSortableColumn","salesPersonId","translate","",2,"width","10%"],["pSortableColumn","dateFrom","translate","",2,"width","10%"],["pSortableColumn","dateTo","translate","",2,"width","10%"],["translate","",2,"width","5%"],["translate","",2,"width","4%"],[1,"fs-5"],[3,"click"],[1,"badge","bg-success","mx-1"],[1,"progress","animated-progess","custom-progress","progress-label"],["role","progressbar","aria-valuenow","30","aria-valuemin","0","aria-valuemax","100",1,"progress-bar",3,"ngStyle"],[1,"label"],[1,"d-inline"],[1,"dropdown-custom"],["tooltipPosition","top",1,"mdi","mdi-cog-outline","text-muted","fs-16","align-middle","me-1","d-inline",3,"ngbTooltip"],["type","button",1,"btn","dropbtn","btn-soft-secondary","btn-sm","dropdown-custom","arrow-none"],[1,"ri-more-fill"],[1,"dropdown-menu","dropdown-menu-end","dropdown-content"],[3,"click",4,"hasPermission"],[1,"ri-history-fill","text-warning"],[1,"ri-history-fill","text-danger"],[1,"ri-user-location-fill","text-primary"],[1,"dropdown-item"],[1,"ri-pencil-fill","align-bottom","me-2","text-muted"],["translate","general.action.edit"],["href","javascript:void(0);",1,"dropdown-item"],[1,"ri-delete-bin-fill","align-bottom","me-2","text-muted"],["translate","general.action.delete"],["translate","",1,"text-center","text-danger","text-bold","fs-4","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"deleteConfirm","dismiss"]],template:function(n,i){if(1&n){const a=e.RV6();e.j41(0,"div",3)(1,"div",4)(2,"div",5)(3,"base-filter",6),e.bIt("reset",function(){return e.eBV(a),e.Njj(i.onReset())})("search",function(){return e.eBV(a),e.Njj(i.onSearch())})("exportXlsx",function(){return e.eBV(a),e.Njj(i.onExportXlsx())})("addNew",function(){return e.eBV(a),e.Njj(i.goRegister())}),e.qex(4,7),e.j41(5,"div",8)(6,"div",9)(7,"input",10),e.nI1(8,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.name,l)||(i.pagination.name=l),e.Njj(l)}),e.k0s(),e.nrm(9,"i",11),e.k0s()(),e.j41(10,"div",12)(11,"div",9)(12,"ng-select",13),e.nI1(13,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.salesPersonId,l)||(i.pagination.salesPersonId=l),e.Njj(l)}),e.k0s()()(),e.j41(14,"div",12)(15,"input",14),e.nI1(16,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.searchForm.creationDates,l)||(i.searchForm.creationDates=l),e.Njj(l)}),e.k0s()(),e.bVm(),e.k0s(),e.j41(17,"div",15)(18,"div",16)(19,"p-table",17,0),e.bIt("onLazyLoad",function(l){return e.eBV(a),e.Njj(i.tableChange(l))})("selectionChange",function(l){return e.eBV(a),e.Njj(i.onSelectionChange(l))}),e.DNE(21,zo,23,0,"ng-template",18)(22,Jo,34,34,"ng-template",19),e.k0s()(),e.DNE(23,Zo,2,0,"div",20)(24,Ko,6,8,"div",21),e.k0s()()()(),e.DNE(25,el,1,0,"ng-template",null,1,e.C5r)}2&n&&(e.R7$(3),e.Y8G("addPermission",e.lJ4(25,Ao))("totalItems",i.pagination.totalItems)("title",i.title),e.R7$(4),e.FS9("placeholder",e.bMT(8,19,"general.table.name")),e.R50("ngModel",i.pagination.name),e.R7$(5),e.FS9("placeholder",e.bMT(13,21,"sales.salesOrder.salsePerson")),e.Y8G("items",i.salesPersons)("multiple",!1),e.R50("ngModel",i.pagination.salesPersonId),e.R7$(3),e.FS9("placeholder",e.bMT(16,23,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",i.searchForm.creationDates),e.R7$(4),e.Y8G("value",i.entities)("rows",i.pagination.pageSize)("lazy",!0)("totalRecords",i.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",i.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",i.pagination.totalItems>0))},dependencies:[p.bT,p.B3,d.me,d.BC,d.vS,_.s5,G.kL,W.b,z.w,J.p,Z.g,g.Mm,V.XI,q.Ei,V.Tg,P.vr,_.md,A.p,p.vh,g.D9]})}}return r})();function il(r,s){1&r&&(e.j41(0,"div",55),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function nl(r,s){1&r&&(e.j41(0,"div",55),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function rl(r,s){1&r&&(e.j41(0,"div",55),e.EFF(1," general.message.filedIdRequired"),e.k0s())}function al(r,s){1&r&&(e.j41(0,"div",55),e.EFF(1," general.message.filedIdRequired"),e.k0s())}function sl(r,s){if(1&r&&e.EFF(0),2&r){const t=s.items,n=e.XpG();e.SpI(" ",n.getLabels(t)," ")}}function ol(r,s){1&r&&(e.j41(0,"tr",56)(1,"th",57),e.EFF(2,"#"),e.k0s(),e.j41(3,"th",58),e.EFF(4," sales.visitPlan.customerName "),e.k0s(),e.j41(5,"th",58),e.EFF(6," sales.visitPlan.date "),e.k0s(),e.j41(7,"th",58),e.EFF(8," sales.visitPlan.visitType "),e.k0s(),e.j41(9,"th",59),e.EFF(10," sales.visitPlan.visitObjectives "),e.k0s(),e.j41(11,"th",58),e.EFF(12," sales.visitPlan.status "),e.k0s(),e.j41(13,"th",58),e.EFF(14," sales.visitPlan.note "),e.k0s(),e.nrm(15,"th",60),e.k0s())}function ll(r,s){if(1&r){const t=e.RV6();e.j41(0,"button",68),e.bIt("click",function(){e.eBV(t);const i=e.XpG().rowIndex,a=e.XpG();return e.Njj(a.onDelete(i))}),e.nrm(1,"i",69),e.k0s()}}function dl(r,s){if(1&r){const t=e.RV6();e.j41(0,"tr",61)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td")(6,"input",62),e.mxI("ngModelChange",function(i){const a=e.eBV(t).rowIndex,o=e.XpG();return e.DH7(o.formMaster.visits[a].date,i)||(o.formMaster.visits[a].date=i),e.Njj(i)}),e.k0s()(),e.j41(7,"td")(8,"ng-select",63),e.mxI("ngModelChange",function(i){const a=e.eBV(t).rowIndex,o=e.XpG();return e.DH7(o.formMaster.visits[a].visitTypeId,i)||(o.formMaster.visits[a].visitTypeId=i),e.Njj(i)}),e.k0s()(),e.j41(9,"td")(10,"ng-select",64),e.mxI("ngModelChange",function(i){const a=e.eBV(t).rowIndex,o=e.XpG();return e.DH7(o.formMaster.visits[a].visitObjectivePlans,i)||(o.formMaster.visits[a].visitObjectivePlans=i),e.Njj(i)}),e.k0s()(),e.j41(11,"td")(12,"ng-select",65),e.mxI("ngModelChange",function(i){const a=e.eBV(t).rowIndex,o=e.XpG();return e.DH7(o.formMaster.visits[a].status,i)||(o.formMaster.visits[a].status=i),e.Njj(i)}),e.k0s()(),e.j41(13,"td")(14,"textarea",66,1),e.mxI("ngModelChange",function(i){const a=e.eBV(t).rowIndex,o=e.XpG();return e.DH7(o.formMaster.visits[a].note,i)||(o.formMaster.visits[a].note=i),e.Njj(i)}),e.k0s()(),e.j41(16,"td"),e.DNE(17,ll,2,0,"button",67),e.k0s()()}if(2&r){const t=s.$implicit,n=s.rowIndex,i=e.XpG();e.R7$(2),e.JRh(n+1),e.R7$(2),e.JRh(t.clientName),e.R7$(2),e.Mz_("name","date",n,""),e.R50("ngModel",i.formMaster.visits[n].date),e.Y8G("altInput",!0)("enableTime",!0)("convertModelValue",!0)("dateFormat","d-m-Y H:i"),e.R7$(2),e.Mz_("name","visitTypeId",n,""),e.Y8G("items",i.visitTypes),e.R50("ngModel",i.formMaster.visits[n].visitTypeId),e.R7$(2),e.Mz_("name","visitObjectivePlans",n,""),e.Y8G("items",i.visitObjectives),e.R50("ngModel",i.formMaster.visits[n].visitObjectivePlans),e.R7$(2),e.Mz_("name","status",n,""),e.Y8G("items",i.status),e.R50("ngModel",i.formMaster.visits[n].status),e.R7$(2),e.Mz_("name","note",n,""),e.Mz_("id","note",n,""),e.R50("ngModel",i.formMaster.visits[n].note),e.R7$(3),e.Y8G("ngIf",10==i.formMaster.visits[n].status)}}let We=(()=>{class r extends X.w{constructor(t,n,i,a,o,l,h,x,y,I,j){super(t,n,h,o,i,a,l),this.baseService=o,this.service=x,this.clientGroupsService=y,this.clientService=I,this.router=j,this.editPaln="sales.visitPlan.editPlan",this.addPlan="sales.visitPlan.addPlan",this.titleOperation="sales.visitPlan.titleOperation",this.submitted=!1,this.pagination={pageNumber:1,pageSize:1e3},this.form=[],this.formMaster={id:0,visits:[]},this.listId=0,this.clientGroups=[],this.salesMan=[],this.cities=[],this.regions=[],this.clients=[],this.visitTypes=[],this.visitObjectives=[],this.formClient={},this.status=[]}ngOnInitMore(){this.listId=this.routerActive.snapshot.paramMap.get("id"),this.GetLookups(),this.configRoute(),this.breadCrumbItems=[{label:"layout.sidebar.sales"},{label:"sales.visitPlan.title",active:!0,url:"sales/visit-plans"},{label:this.isEditForm?"general.action.edit":"general.action.register",active:!0}]}GetById(){this.baseService.getById(this.listId).pipe((0,m.Q)(this.notifier)).subscribe(t=>{t.success?(this.isEditForm=!0,this.formMaster=t.data):this.alertService.error("general.message."+t.message)},t=>{this.alertService.error()})}GetLookups(){this.baseService.GetLookups().pipe((0,m.Q)(this.notifier)).subscribe({next:t=>{this.salesMan=t.data.salesMan,this.clientGroups=t.data.clientGroups,this.regions=t.data.regions,this.cities=t.data.cities,this.visitTypes=t.data.visitTypes,this.visitObjectives=t.data.visitObjectives;let n=t.data.status;n.forEach(i=>{i.name=this.getTranslationText("sales.visitPlan."+i.name)}),this.status=n}})}GetClientDropDown(){this.formMaster.salesPersonId?this.clientService.GetClientDropDown({salesPersonId:this.formMaster.salesPersonId,regionId:this.formClient.regionId,cityId:this.formClient.cityId,clientGroupId:this.formClient.clientGroupId}).pipe((0,m.Q)(this.notifier)).subscribe({next:n=>{this.clients=n.data}}):this.alertService.error("mustSelectSalesMan")}back(){this.router.navigate(["/sales/visit-plans"])}mapForm(t){let n=structuredClone(t);return n.dateFrom=this.datePipe.transform(n.dateFrom,"yyyy-MM-ddT00:00:00.000"),n.dateTo=this.datePipe.transform(n.dateTo,"yyyy-MM-ddT00:00:00.000"),n.visits.forEach(i=>{i.date=this.datePipe.transform(i.date,"yyyy-MM-ddTHH:mm"),i.visitObjectivePlans=i.visitObjectivePlans.map(a=>({representativeVisitPlanDetailId:i.id,visitObjectiveId:a}))}),n}mapRegisterForm(t){let n=structuredClone(t);return n.dateFrom=this.datePipe.transform(n.dateFrom,"yyyy-MM-ddT00:00:00.000"),n.dateTo=this.datePipe.transform(n.dateTo,"yyyy-MM-ddT00:00:00.000"),n.visits.forEach(i=>{i.date=this.datePipe.transform(i.date,"yyyy-MM-ddTHH:mm"),i.visitObjectivePlans=i.visitObjectivePlans.map(a=>({representativeVisitPlanDetailId:0,visitObjectiveId:a}))}),n}OnSubmit(){this.validForm()&&(this.ngxLoader.startLoader(this.operationLoader),!0===this.isEditForm?this.editEntity():this.registerEntity())}validForm(){const t=this.formMaster.visits;return t&&0!==t.length?!t.some(i=>0===i.visitTypeId||!i.visitObjectivePlans?.length)||(this.alertService.error("sales.visitPlan.eatchServiceMustHaveTypeAndOneObjectiveAtLeast"),!1):(this.alertService.error("sales.visitPlan.mustSelectVisit"),!1)}submitFunished(){this.alertService.success(),this.ngxLoader.stop(u.a7),this.ngxLoader.stop(u.ZW),this.btnDisabled=!0}registerEntity(){this.ngxLoader.startLoader(this.operationLoader);let t=this.mapRegisterForm(this.formMaster);this.baseService.register(t).pipe((0,v.O)(),(0,R.c)(this.mainDelay),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader(this.operationLoader)),(0,pe.W)(n=>(0,ue.$)(n))).subscribe(n=>{n.success?(this.goList(),this.submitFunished()):this.alertService.error("general.message."+n.message)},n=>{this.alertService.error("general.message."+n)})}editEntity(){this.ngxLoader.startLoader(this.operationLoader);let t=this.mapForm({...this.formMaster});this.baseService.editPut(t.id,t).pipe((0,v.O)(),(0,R.c)(this.mainDelay),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(n=>{n.success?this.submitFunished():this.alertService.error("general.message."+n.message)},n=>{this.alertService.error("general.message."+n)})}goList(){this.router.navigateByUrl("/sales/visit-plans/")}controlDateFormat(t){"dateFrom"===t?this.form[t]=this.datePipe.transform(this.form[t],"yyyy-MM-ddT00:00:00"):"dateTo"===t&&(this.form[t]=this.datePipe.transform(this.form[t],"yyyy-MM-ddT23:59:59.999"))}getLabels(t){return t?t.length<=1?t.map(n=>n.name).join("  ,   "):t.slice(0,1).map(n=>n.name).join(", ")+` +${t.length-1} +`:""}addSelected(){this.formClient.clientId&&this.formClient.clientId.forEach(t=>{this.formMaster.visits.some(i=>i.clientId==t.id)||this.formMaster.visits.push({id:0,clientId:t.id,clientName:t.name,date:this.formMaster.dateFrom,visitTypeId:0,visitObjectivePlans:[],representativeVisitPlanMasterId:this.formMaster.id,note:"",status:1})})}addALLSelected(){this.formClient.clientId=this.clients,this.addSelected()}onDelete(t){this.formMaster.visits.splice(t,1)}configRoute(){this.routerActive.data.pipe((0,m.Q)(this.notifier)).subscribe(t=>{if(t.data?.success){this.isEditForm=!0;let n=t.data.data;n.visits.forEach(i=>{i.date=new Date(i.date)}),this.formMaster=n,this.GetClientDropDown()}},()=>{this.alertService.error()})}static{this.\u0275fac=function(n){return new(n||r)(e.rXU(M.nX),e.rXU(g.c$),e.rXU(E.u),e.rXU(p.vh),e.rXU(Le),e.rXU(w.eD),e.rXU(_.Bq),e.rXU(qe.m),e.rXU(we.t),e.rXU(oe.X),e.rXU(M.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-visit-plan-operation"]],features:[e.Vt3],decls:96,vars:42,consts:[["formEntity","ngForm"],["name","ngModel"],["salesPersonId","ngModel"],["dateFrom","ngModel"],["dateTo","ngModel"],["clientGroupId","ngModel"],["tableMaster",""],[3,"title","breadcrumbItems"],[1,"row"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[1,"card","grid"],[1,"modal-header","p-0"],[1,"fs-3"],["translate","sales.visitPlan.planData",1,"badge","rounded-pill","bg-primary"],[1,"card-body"],[3,"submit"],[1,"col-12","col-md-3"],["for","name","translate","",1,"required","fw-bold","form-label"],["InputTirmFilter","","name","name","type","text","id","name","required","",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["class","text-danger text-center  ","translate","",4,"ngIf"],["translate","",1,"required","fw-bold","form-label","w-100"],["clearable","false","clearOnBackspace","false","name","salesPersonId","bindValue","id","bindLabel","name","required","",2,"width","100%",3,"change","ngModelChange","items","ngModel"],[1,"col-12","col-md-3","mb-3"],["for","dateFrom","translate","",1,"fw-bold","form-label","required"],[1,"input-group"],["type","text","mwlFlatpickr","","name","dateFrom","id","dateFrom","altFormat","d/m/Y","required","",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],["for","dateTo","translate","",1,"fw-bold","form-label","required"],["type","text","mwlFlatpickr","","name","dateTo","id","dateTo","altFormat","d/m/Y","required","",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","disabled","minDate","altInput","convertModelValue","placeholder","ngModel"],["translate","sales.visitPlan.customerData",1,"badge","rounded-pill","bg-primary"],[1,"row","align-items-center"],[1,"col-12","col-md-2"],["translate","",1,"fw-bold","form-label","w-100"],["clearable","true","clearable","false","clearOnBackspace","false","name","clientGroupId","bindValue","id","bindLabel","name",2,"width","100%",3,"change","ngModelChange","items","ngModel"],["clearable","true","clearable","false","clearOnBackspace","false","name","regionId","bindValue","id","bindLabel","name",2,"width","100%",3,"change","ngModelChange","items","ngModel"],["clearable","true","clearable","false","clearOnBackspace","false","name","cityId","bindValue","id","bindLabel","name",2,"width","100%",3,"change","ngModelChange","items","ngModel"],["clearable","true","clearOnBackspace","true","name","clientId","markFirst","true","multiple","true","closeOnSelect","false","bindLabel","name",2,"width","100%",3,"ngModelChange","items","ngModel"],["ng-multi-label-tmp",""],[1,"fw-bold","form-label","w-100"],["href","javascript:void(0);",1,"btn","btn-info","p-2",3,"click","disabled"],[1,"ri-add-circle-fill","align-bottom"],["translate","sales.visitPlan.addCustomer"],["href","javascript:void(0);",1,"btn","btn-info","p-2","mx-2",3,"click","disabled"],["translate","sales.visitPlan.addAll"],["href","javascript:void(0);",1,"btn","btn-success","p-2",3,"click","disabled"],[1,"ri-checkbox-circle-fill","align-bottom"],["translate","general.action.save"],["translate","sales.visitPlan.visitData",1,"badge","rounded-pill","bg-primary"],[1,"",2,"overflow-y","visible"],["dataKey","id",3,"value","rows"],["pTemplate","header"],["pTemplate","body"],[1,"row","justify-content-center","py-2"],[1,"text-center","text-danger","text-bold","fs-6","col-2"],[1,"btn","btn-dark",3,"click"],[1,"ri-check-double-fill","align-bottom"],["translate","",1,"text-danger","text-center"],[1,""],["translate","",2,"width",".5%"],["translate","",2,"width","10%"],["translate","",2,"width","20%"],[2,"width","5%"],[1,"fs-5"],["type","text","mwlFlatpickr","","altFormat","d-m-Y H:i","required","",1,"form-control","flatpickr-input",3,"ngModelChange","ngModel","name","altInput","enableTime","convertModelValue","dateFormat"],["clearable","false","clearOnBackspace","false","name","salesPersonId","bindValue","id","bindLabel","name",2,"width","100%",3,"ngModelChange","name","items","ngModel"],["clearable","true","clearOnBackspace","true","name","clientId","bindValue","id","markFirst","true","multiple","true","closeOnSelect","false","bindLabel","name",2,"width","100%",3,"ngModelChange","name","items","ngModel"],["clearable","false","clearOnBackspace","false","name","status","bindValue","id","bindLabel","name",2,"width","100%",3,"ngModelChange","name","items","ngModel"],["rows","1","InputTirmFilter","","type","text",1,"form-control","fs-6",3,"ngModelChange","name","ngModel","id"],["class","btn btn-sm btn-soft-danger remove-list",3,"click",4,"ngIf"],[1,"btn","btn-sm","btn-soft-danger","remove-list",3,"click"],[1,"ri-delete-bin-5-fill","align-bottom"]],template:function(n,i){if(1&n){const a=e.RV6();e.nrm(0,"app-breadcrumbs",7),e.nI1(1,"translate"),e.j41(2,"div",8),e.nrm(3,"ngx-ui-loader",9),e.j41(4,"div",10)(5,"div",11)(6,"h6",12),e.nrm(7,"span",13),e.k0s()(),e.j41(8,"div",14)(9,"form",15,0),e.bIt("submit",function(){return e.eBV(a),e.Njj(i.OnSubmit())}),e.j41(11,"div",8)(12,"div",16)(13,"label",17),e.EFF(14,"sales.visitPlan.name"),e.k0s(),e.j41(15,"input",18,1),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.formMaster.name,l)||(i.formMaster.name=l),e.Njj(l)}),e.k0s(),e.DNE(17,il,2,0,"div",19),e.k0s(),e.j41(18,"div",16)(19,"label",20),e.EFF(20,"sales.visitPlan.salesPersonName"),e.k0s(),e.j41(21,"ng-select",21,2),e.bIt("change",function(){return e.eBV(a),e.Njj(i.GetClientDropDown())}),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.formMaster.salesPersonId,l)||(i.formMaster.salesPersonId=l),e.Njj(l)}),e.k0s(),e.DNE(23,nl,2,0,"div",19),e.k0s(),e.j41(24,"div",22)(25,"label",23),e.EFF(26,"sales.visitPlan.dateFrom"),e.k0s(),e.j41(27,"div",24)(28,"input",25,3),e.nI1(30,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.formMaster.dateFrom,l)||(i.formMaster.dateFrom=l),e.Njj(l)}),e.bIt("ngModelChange",function(){return e.eBV(a),e.Njj(i.controlDateFormat("dateFrom"))}),e.k0s()(),e.DNE(31,rl,2,0,"div",19),e.k0s(),e.j41(32,"div",22)(33,"label",26),e.EFF(34,"sales.visitPlan.dateTo"),e.k0s(),e.j41(35,"div",24)(36,"input",27,4),e.nI1(38,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.formMaster.dateTo,l)||(i.formMaster.dateTo=l),e.Njj(l)}),e.bIt("ngModelChange",function(){return e.eBV(a),e.Njj(i.controlDateFormat("dateTo"))}),e.k0s()(),e.DNE(39,al,2,0,"div",19),e.k0s()()()()(),e.j41(40,"div",10)(41,"div",11)(42,"h6",12),e.nrm(43,"span",28),e.k0s()(),e.j41(44,"div",14)(45,"div",29)(46,"div",30)(47,"label",31),e.EFF(48,"sales.visitPlan.clientGroup"),e.k0s(),e.j41(49,"ng-select",32,5),e.bIt("change",function(){return e.eBV(a),e.Njj(i.GetClientDropDown())}),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.formClient.clientGroupId,l)||(i.formClient.clientGroupId=l),e.Njj(l)}),e.k0s()(),e.j41(51,"div",30)(52,"label",31),e.EFF(53,"sales.visitPlan.regionName"),e.k0s(),e.j41(54,"ng-select",33,5),e.bIt("change",function(){return e.eBV(a),e.Njj(i.GetClientDropDown())}),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.formClient.regionId,l)||(i.formClient.regionId=l),e.Njj(l)}),e.k0s()(),e.j41(56,"div",30)(57,"label",31),e.EFF(58,"sales.visitPlan.cityName"),e.k0s(),e.j41(59,"ng-select",34,5),e.bIt("change",function(){return e.eBV(a),e.Njj(i.GetClientDropDown())}),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.formClient.cityId,l)||(i.formClient.cityId=l),e.Njj(l)}),e.k0s()(),e.j41(61,"div",16)(62,"label",31),e.EFF(63,"sales.visitPlan.customerName"),e.k0s(),e.j41(64,"ng-select",35,5),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.formClient.clientId,l)||(i.formClient.clientId=l),e.Njj(l)}),e.DNE(66,sl,1,1,"ng-template",36),e.k0s()(),e.j41(67,"div",16),e.nrm(68,"label",37),e.j41(69,"button",38),e.bIt("click",function(){return e.eBV(a),e.Njj(i.addSelected())}),e.nrm(70,"i",39)(71,"span",40),e.k0s(),e.j41(72,"button",41),e.bIt("click",function(){return e.eBV(a),e.Njj(i.addALLSelected())}),e.nrm(73,"i",39)(74,"span",42),e.k0s(),e.j41(75,"button",43),e.bIt("click",function(){return e.eBV(a),e.Njj(i.OnSubmit())}),e.nrm(76,"i",44)(77,"span",45),e.k0s()()()()()(),e.j41(78,"div",8)(79,"div",10)(80,"div",11)(81,"h6",12),e.nrm(82,"span",46),e.k0s()(),e.j41(83,"div",14)(84,"div",47)(85,"p-table",48,6),e.DNE(87,ol,16,0,"ng-template",49)(88,dl,18,27,"ng-template",50),e.k0s()(),e.j41(89,"div",51)(90,"div",52)(91,"a",53),e.bIt("click",function(){return e.eBV(a),e.Njj(i.back())}),e.nrm(92,"i",54),e.j41(93,"span"),e.EFF(94),e.nI1(95,"translate"),e.k0s()()()()()()()}if(2&n){const a=e.sdS(10),o=e.sdS(16),l=e.sdS(22),h=e.sdS(29),x=e.sdS(37);e.FS9("title",0==i.isEditForm?i.addPlan:e.bMT(1,34,i.editPaln)),e.Y8G("breadcrumbItems",i.breadCrumbItems),e.R7$(3),e.Y8G("loaderId",i.operationLoader),e.R7$(12),e.R50("ngModel",i.formMaster.name),e.R7$(2),e.Y8G("ngIf",o.invalid&&o.touched),e.R7$(4),e.Y8G("items",i.salesMan),e.R50("ngModel",i.formMaster.salesPersonId),e.R7$(2),e.Y8G("ngIf",l.invalid&&l.touched),e.R7$(5),e.FS9("placeholder",e.bMT(30,36,"hr.target.dateFrom")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",i.formMaster.dateFrom),e.R7$(3),e.Y8G("ngIf",h.invalid&&h.touched),e.R7$(5),e.FS9("placeholder",e.bMT(38,38,"hr.target.dateTo")),e.Y8G("disabled",!i.formMaster.dateFrom)("minDate",i.formMaster.dateFrom)("altInput",!0)("convertModelValue",!0),e.R50("ngModel",i.formMaster.dateTo),e.R7$(3),e.Y8G("ngIf",x.invalid&&x.touched),e.R7$(10),e.Y8G("items",i.clientGroups),e.R50("ngModel",i.formClient.clientGroupId),e.R7$(5),e.Y8G("items",i.regions),e.R50("ngModel",i.formClient.regionId),e.R7$(5),e.Y8G("items",i.cities),e.R50("ngModel",i.formClient.cityId),e.R7$(5),e.Y8G("items",i.clients),e.R50("ngModel",i.formClient.clientId),e.R7$(5),e.Y8G("disabled",!((null==i.formClient||null==i.formClient.clientId?null:i.formClient.clientId.length)>0)),e.R7$(3),e.Y8G("disabled",!(i.clients.length>0)),e.R7$(3),e.Y8G("disabled",!a.valid),e.R7$(10),e.Y8G("value",i.formMaster.visits)("rows",null==i.formMaster.visits?null:i.formMaster.visits.length),e.R7$(9),e.JRh(e.bMT(95,40,"general.action.back"))}},dependencies:[p.bT,d.qT,d.me,d.BC,d.cb,d.YS,d.vS,d.cV,G.kL,_e.m,g.Mm,V.XI,q.Ei,w.Cv,P.vr,P.EY,B.m,g.D9]})}}return r})(),cl=(()=>{class r{constructor(t,n,i,a){this.router=t,this.route=n,this.representativeVisitPlanService=i,this.alertService=a}resolve(t,n){const a=this.router.getCurrentNavigation()?.extras?.state?.id;return""===a?(this.alertService.error(),this.router.navigateByUrl("/sales/visit-plans"),(0,ge.of)(null)):this.representativeVisitPlanService.getById(a)}static{this.\u0275fac=function(n){return new(n||r)(e.KVO(M.Ix),e.KVO(M.nX),e.KVO(Le),e.KVO(E.u))}}static{this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();function ml(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",66)(1,"div",67)(2,"div",68)(3,"div",69)(4,"div")(5,"h6",70),e.EFF(6),e.k0s(),e.j41(7,"small",71),e.EFF(8),e.k0s()(),e.j41(9,"span",72),e.EFF(10),e.nI1(11,"translate"),e.k0s()(),e.j41(12,"div",73)(13,"div"),e.nrm(14,"i",74),e.EFF(15),e.k0s(),e.j41(16,"div"),e.nrm(17,"i",75),e.EFF(18),e.k0s(),e.j41(19,"div"),e.nrm(20,"i",76),e.EFF(21),e.k0s()(),e.j41(22,"div",77),e.nrm(23,"i",78),e.EFF(24),e.nrm(25,"span",79),e.k0s(),e.j41(26,"div",80)(27,"button",81),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.goToAnotherPage())}),e.EFF(28),e.nI1(29,"translate"),e.k0s(),e.j41(30,"button",82),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.goToDetails())}),e.EFF(31),e.nI1(32,"translate"),e.k0s()()()()()}if(2&r){const t=s.$implicit;e.R7$(6),e.JRh(t.companyName),e.R7$(2),e.JRh(t.clientId),e.R7$(2),e.SpI(" ",e.bMT(11,9,"sales.visits.pending")," "),e.R7$(5),e.JRh(t.address),e.R7$(3),e.JRh(t.name),e.R7$(3),e.JRh(t.phone),e.R7$(3),e.SpI("",t.lastVisit," "),e.R7$(4),e.SpI(" ",e.bMT(29,11,"sales.visits.startVisit")," "),e.R7$(3),e.SpI(" ",e.bMT(32,13,"sales.visits.details")," ")}}function pl(r,s){if(1&r&&(e.j41(0,"div",65),e.Z7z(1,ml,33,15,"div",66,e.Vm6),e.k0s()),2&r){const t=e.XpG();e.R7$(),e.Dyx(t.visits)}}function ul(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",83)(1,"div",84)(2,"div",4)(3,"div",85)(4,"div")(5,"h5",86),e.EFF(6),e.k0s(),e.j41(7,"small",71),e.EFF(8),e.k0s()(),e.nrm(9,"span",87),e.k0s(),e.j41(10,"div",88)(11,"div")(12,"i",74),e.EFF(13),e.k0s()(),e.j41(14,"div"),e.nrm(15,"i",75),e.EFF(16),e.k0s(),e.j41(17,"div"),e.nrm(18,"i",76),e.EFF(19),e.k0s()(),e.j41(20,"div",89),e.EFF(21),e.nrm(22,"i",78)(23,"span",79),e.k0s(),e.j41(24,"div",90)(25,"button",91),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.goToAnotherPage())}),e.k0s(),e.j41(26,"button",92),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.goToDetails())}),e.k0s()()()()()}if(2&r){const t=s.$implicit;e.R7$(6),e.SpI(" ",t.companyName," "),e.R7$(2),e.SpI(" ",t.clientId," "),e.R7$(5),e.SpI(" ",t.address," "),e.R7$(3),e.SpI(" ",t.name," "),e.R7$(3),e.SpI(" ",t.phone," "),e.R7$(2),e.SpI(" ",t.lastVisit," ")}}function gl(r,s){if(1&r&&(e.j41(0,"div",65),e.Z7z(1,ul,27,6,"div",83,e.Vm6),e.k0s()),2&r){const t=e.XpG();e.R7$(),e.Dyx(t.visits)}}let _l=(()=>{class r extends X.w{constructor(t,n,i,a,o,l,h,x,y,I,j,T){super(n,i,y,a,l,h,x),this.router=t,this.baseService=a,this.salesInvoicesService=o,this.authDaamService=I,this.excelService=j,this._formDataService=T,this.title="sales.assignTruckOrder.title",this.titleOperation="sales.assignTruckOrder.title",this.showCart=!0,this.trunks=[],this.isFlagTime=!0,this.searchForm={},this.statusList=[],this.pagination={pageNumber:1,pageSize:30},this.images=[],this.serverPath=Y.c.mediaUrl,this.form={orderId:0,attachmens:[]},this.visits=[{companyName:"novaIndustries",clientId:"NOV-101",status:"active",address:"100 Galaxy St, Orbit City, FL 33101",name:"Alice Monroe",phone:"(555) 321-9876",lastVisit:"2025-05-06"},{companyName:"fusionTech",clientId:"FUS-102",status:"inactive",address:"200 Reactor Rd, Core Town, AZ 85001",name:"Brian Keller",phone:"(555) 654-3210",lastVisit:"2025-04-22"},{companyName:"quantumSystems",clientId:"QTM-103",status:"pending",address:"300 Particle Ln, Quantum Valley, NM 87501",name:"Diana Blake",phone:"(555) 777-8888",lastVisit:"2025-05-01"},{companyName:"vertexSolutions",clientId:"VTX-104",status:"confirmed",address:"400 Peak Dr, Summit City, CO 80203",name:"Oscar Lee",phone:"(555) 111-2222",lastVisit:"2025-05-03"},{companyName:"aeroDynamics",clientId:"AER-105",status:"archived",address:"500 Wind Tunnel Blvd, Jet City, WA 98101",name:"Clara Kent",phone:"(555) 333-4444",lastVisit:"2025-04-20"},{companyName:"cyberWave",clientId:"CYB-106",status:"active",address:"600 Digital Way, Cyber Town, CA 90210",name:"Liam Ford",phone:"(555) 222-9999",lastVisit:"2025-05-05"},{companyName:"ecoPower",clientId:"ECO-107",status:"suspended",address:"700 Green Dr, Solar City, TX 73301",name:"Nora Hill",phone:"(555) 444-6666",lastVisit:"2025-04-29"},{companyName:"hyperNet",clientId:"HYP-108",status:"confirmed",address:"800 Speed Ln, Fiber City, IL 60611",name:"Ethan Black",phone:"(555) 555-0000",lastVisit:"2025-05-07"},{companyName:"stellarConnect",clientId:"STL-109",status:"inactive",address:"900 Orbit Blvd, Moon Base, NV 89101",name:"Grace Moon",phone:"(555) 888-7777",lastVisit:"2025-04-26"},{companyName:"infinityGroup",clientId:"INF-110",status:"pending",address:"1000 Endless Rd, Limitless City, MA 02101",name:"Jacob Snow",phone:"(555) 999-1234",lastVisit:"2025-05-02"}],this.setDates=(b,C,O)=>{if(b?.from||b?.to){const k=b.to||b.from;this.pagination[C]=this.datePipe.transform(b.from||b.to,"yyyy-MM-ddT00:00:00"),this.pagination[O]=this.datePipe.transform(k,"yyyy-MM-ddT23:59:59.999")}else this.pagination[C]=null,this.pagination[O]=null}}loadentities(){this.ngxLoader.startLoader(u.a7),this.baseService.GetOrderAssignTrunk(this.pagination).pipe((0,m.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader(u.a7),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader(u.a7),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[]}startVisit(){}ngOnInitMore(){this.loadentities(),this.checkStatus()}checkStatus(){let t=this.baseService.getTrunckStatus();t.forEach(n=>{n.name=this.getTranslationText("sales.salesOrder."+n.name)}),this.statusList=t}mapExcel(){let t=[];return this.entities.forEach(n=>{t.push({"Order Code":n.orderCode,"Created Date":n.createdDate,"City Name":n.cityName,"District Name":n.districtName?n.districtName:"--","Agent Name":n.agentName,Mobile:n.mobile,"Channel Name":n.channelName,"Assigned To":n.teamNames,Times:n.workTimes,"Visit Date":n.visitDate,Services:n.services})}),t}goToAnotherPage(){this.router.navigate(["/sales/startVisits"])}goToDetails(){this.router.navigate(["/sales/details"])}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader("allLoader"),this.setDates(t.dates,"visitDateFrom","visitDateTo"),this.setDates(t.creationDates,"creationTimeFrom","creationTimeTo"),this.loadentities()}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}openChangeStatusModal(t,n,i="md"){this.form={},this.form.trunckStatus=t.trunckStatus,this.form.id=t.id,this.modalService.open(n,{centered:!0,size:i})}changeStatus(){this.ngxLoader.startLoader(this.operationLoader),this.baseService.changeStatus({trunckStatus:this.form.trunckStatus,id:this.form.id}).pipe((0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(n=>{this.loadentities(),this.alertService.success(),this.modalService.dismissAll()},()=>{this.alertService.error()})}mapUrl(t,n){return null===t||null==n?"":`https://www.google.com/maps/dir//${n},${t}/@${n},${t},17z?hl=en-US`}SubmitFinishOrder(){this.ngxLoader.startLoader(this.operationLoader),this.salesInvoicesService.finishOrder(this.form.id).pipe((0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(t=>{this.loadentities(),this.alertService.success(),this.modalService.dismissAll()},()=>{this.alertService.error()})}PrintOrderReceived(t){this.ngxLoader.startLoader("searchLoader"),this.baseService.PrintOrderReceived(t).pipe((0,v.O)(),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader("searchLoader"))).subscribe(n=>{this.openUrl(n)},n=>{this.alertService.error("general.message."+n)})}openUrl(t){let n=new Blob([t],{type:t.type});var i=URL.createObjectURL(n);window.open(i,"_blank")}onFileChanged(t){if(t.target.files&&t.target.files[0]){let n=t.target.files.length;for(let i=0;i<n;i++){let a=new FileReader;this.form.attachmens.push({attachImage:t.target.files.item(i),type:"file"}),a.onload=o=>{this.images.push({id:0,path:o.target.result,completePath:o.target.result})},a.readAsDataURL(t.target.files[i])}}}removeImage(t,n){this.form.attachmens.splice(n,1),this.images.splice(n,1)}openFinishedModal(t,n,i="md"){this.form={},this.form.orderId=t,this.images=[],this.form.attachmens=[],this.modalService.open(n,{centered:!0,size:i})}finishOrder(){const t=new FormData;t.append("OrderId",this.form.orderId.toString()),this.form.attachmens.forEach(n=>{t.append("Attachmens",n.attachImage)}),this.ngxLoader.startLoader(u.Fq),this.salesInvoicesService.finishOrder(t).subscribe(n=>{this.ngxLoader.stopLoader(u.Fq),this.loadentities(),this.modalService.dismissAll()},n=>{console.log(n),this.ngxLoader.stopLoader(u.Fq)})}static{this.\u0275fac=function(n){return new(n||r)(e.rXU(M.Ix),e.rXU(M.nX),e.rXU(g.c$),e.rXU(he.B),e.rXU(ye.Q),e.rXU(E.u),e.rXU(p.vh),e.rXU(w.eD),e.rXU(_.Bq),e.rXU(fe.J),e.rXU(H.V),e.rXU(ke.Q))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-visits"]],features:[e.Vt3],decls:101,vars:2,consts:[[1,"row","mb-5"],["translate","sales.visits.visits",1,"fw-bold","fs-5"],[1,"col-xxl-3","col-sm-6"],[1,"card","card-animate","rounded-4"],[1,"card-body"],[1,"d-flex","justify-content-between"],["translate","sales.visits.totalVisits",1,"fw-medium","text-muted","mb-0"],[1,"mt-4","ff-secondary","fw-bold","fs-3"],["translate","sales.visits.thisMonth",1,"mb-0","text-muted"],[1,"avatar-sm","flex-shrink-0"],[1,"avatar-title","bg-light","text-primary","rounded-4","fs-4"],[1,"ri-calendar-line"],[1,"d-flex","justify-content-between","p-2"],["translate","sales.visits.scheduled",1,"fw-medium","text-muted","mb-0"],[1,"mt-4","ff-secondary","fw-bold","fs-3","text-primary"],[1,"avatar-title","text-black","rounded-4","fs-4",2,"background-color","#F0F8FF"],["translate","sales.visits.completed",1,"fw-semibold","text-muted","mb-0"],[1,"mt-4","ff-secondary","fw-bold","fs-5","text-success"],[1,"mb-0","text-muted"],["translate","sales.visits.vslastmonth",1,"badge","text-success","mb-0"],[1,"bx","bx-plus","fw-bold"],[1,"avatar-title","rounded-4","fs-4","text-black",2,"background-color","#DFFFD6"],["translate","sales.visits.overdue",1,"fw-medium","text-muted","mb-0"],[1,"mt-4","ff-secondary","fw-bold","fs-3","text-danger"],["translate","sales.visits.vsLastMonth",1,"badge","bg-light","text-danger","mb-0"],[1,"avatar-title","text-black","rounded-4","fs-4",2,"background-color","#FFCCCC"],[1,"d-flex","justify-content-between","align-items-center","mt-5"],[1,"w-25","rounded-3"],["translate","sales.visits.visitSchedule",1,"fs-16","fw-bold"],["translate","sales.visits.manageAndTrackYourCustomerVisits",1,"text-muted"],["translate","sales.visits.newVisit",1,"btn","btn-primary"],[1,"ri-user-add-line"],[1,"bg-light","cursor-pointer",3,"click"],[1,"ri-layout-row-line","fs-2"],[1,"row","mb-4"],[1,"col-md","d-flex","justify-content-between","align-items-center","flex-wrap","gap-2"],[1,"rounded-5","d-flex","gap-3","p-1",2,"background-color","rgb(211, 211, 211)"],["translate","sales.visits.allVisits",1,"btn","btn-outline-primary","rounded-4","active"],["translate","sales.visits.Scheduled",1,"btn","btn-outline-primary","rounded-4"],["translate","sales.visits.Completed",1,"btn","btn-outline-primary","rounded-4"],["translate","sales.visits.Overdue",1,"btn","btn-outline-primary","rounded-4"],[1,"d-flex","align-items-center","position-relative"],["type","text","placeholder","Search visits...",1,"form-control","form-control-sm","border","p-2","ps-5","pe-5","rounded-5"],[1,"ri-search-line","position-absolute",2,"left","12px","top","50%","transform","translateY(-50%)"],["translate","sales.visits.filter",1,"btn","btn-light","px-4","py-1","ms-2","rounded-2"],[1,"ri-filter-2-line"],["id","candidate-list",1,"row","gy-4","mb-2"],[1,"col-md-12"],[1,"card","mb-0"],[1,"card-body","d-none"],[1,"d-lg-flex","align-items-center","justify-content-between"],[1,"ms-lg-3","my-3","my-lg-0"],["translate","sales.visits.acmeCorporation",1,"fs-16","mb-0","fw-bold"],[1,"text-mute"],[1,"d-flex","flex-column","gap-3","mx-auto"],[1,"w-75","text-muted"],["translate","sales.visits.Business",1,"ri-map-pin-2-line","text-primary","me-1","align-bottom"],[1,"mt-0","text-muted"],[1,"ri-phone-line","text-primary","me-1","align-bottom"],["translate","sales.visits.lastVisit"],[1,"rounded-circle","bg-success","d-inline-block",2,"width","12px","height","12px"],[1,"d-flex","justify-content-end","gap-4","mt-4","me-1"],["translate","sales.visits.startVisit",1,"btn","btn-primary","px-5","py-2","d-flex","justify-content-center","align-items-center"],["translate","sales.visits.details",1,"btn","btn-light","px-5","py-2","d-flex","justify-content-center","align-items-center"],["class","row gy-4 ",4,"ngIf"],[1,"row","gy-4"],[1,"col-12"],[1,"card","shadow-sm","rounded-4","border-0"],[1,"card-body","py-3","px-3"],[1,"d-flex","justify-content-between","align-items-start","flex-wrap"],[1,"mb-1","fw-bold","text-truncate"],[1,"text-muted"],[1,"badge","bg-warning","text-dark","fw-semibold"],[1,"mt-2","text-muted","small"],[1,"ri-map-pin-2-line","me-1","text-primary"],[1,"ri-user-3-line","me-1","text-primary"],[1,"ri-phone-line","me-1","text-primary"],[1,"mt-2","small","text-muted","d-flex","align-items-center"],[1,"ri-calendar-line","me-1"],[1,"rounded-circle","bg-success","d-inline-block","ms-2",2,"width","10px","height","10px"],[1,"d-flex","justify-content-end","gap-2","mt-3"],[1,"btn","btn-primary","btn-sm","px-3",3,"click"],[1,"btn","btn-outline-primary","btn-sm","px-3",3,"click"],[1,"col-xxl-3","col-lg-6"],[1,"card","shadow-sm","rounded-4","h-100"],[1,"d-flex","justify-content-between","align-items-start"],[1,"mb-0","fw-bold"],["translate","sales.visits.pending",1,"badge","bg-warning","text-dark","fw-semibold"],[1,"mt-3","text-muted","small"],[1,"mt-3","small","text-muted"],[1,"d-flex","justify-content-end","align-items-start","gap-2","mt-4"],["translate","sales.visits.startVisit",1,"btn","btn-primary","px-4","py-2",3,"click"],["translate","sales.visits.details",1,"btn","btn-outline-primary","px-4","py-2",3,"click"]],template:function(n,i){1&n&&(e.j41(0,"div",0),e.nrm(1,"h2",1),e.j41(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div"),e.nrm(7,"p",6),e.j41(8,"h2",7),e.EFF(9,"12"),e.k0s(),e.nrm(10,"p",8),e.k0s(),e.j41(11,"div")(12,"div",9)(13,"span",10),e.nrm(14,"i",11),e.k0s()()()()()()(),e.j41(15,"div",2)(16,"div",3)(17,"div",4)(18,"div",12)(19,"div"),e.nrm(20,"p",13),e.j41(21,"h2",14),e.EFF(22,"6"),e.k0s()(),e.j41(23,"div")(24,"div",9)(25,"span",15),e.nrm(26,"i",11),e.k0s()()()()()()(),e.j41(27,"div",2)(28,"div",3)(29,"div",4)(30,"div",5)(31,"div"),e.nrm(32,"p",16),e.j41(33,"h2",17),e.EFF(34,"3"),e.k0s(),e.j41(35,"p",18)(36,"span",19),e.nrm(37,"i",20),e.k0s()()(),e.j41(38,"div")(39,"div",9)(40,"span",21),e.nrm(41,"i",11),e.k0s()()()()()()(),e.j41(42,"div",2)(43,"div",3)(44,"div",4)(45,"div",5)(46,"div"),e.nrm(47,"p",22),e.j41(48,"h2",23),e.EFF(49,"2"),e.k0s(),e.j41(50,"p",18),e.nrm(51,"span",24),e.k0s()(),e.j41(52,"div")(53,"div",9)(54,"span",25),e.nrm(55,"i",11),e.k0s()()()()()()()(),e.j41(56,"div",26)(57,"div",27),e.nrm(58,"h2",28)(59,"p",29),e.k0s(),e.j41(60,"div")(61,"button",30),e.nrm(62,"i",31),e.k0s()(),e.j41(63,"div")(64,"div",32),e.bIt("click",function(){return i.showCart=!i.showCart}),e.nrm(65,"i",33),e.k0s()()(),e.j41(66,"div",34)(67,"div",35)(68,"div",36),e.nrm(69,"button",37)(70,"button",38)(71,"button",39)(72,"button",40),e.k0s(),e.j41(73,"div",41),e.nrm(74,"input",42)(75,"i",43),e.j41(76,"button",44),e.nrm(77,"i",45),e.k0s()()()(),e.j41(78,"div",46)(79,"div",47)(80,"div",48)(81,"div",49)(82,"div",50)(83,"div",51),e.nrm(84,"h3",52),e.j41(85,"span",53),e.EFF(86,"ACM-OOl"),e.k0s(),e.j41(87,"div",54)(88,"div",55),e.nrm(89,"i",56),e.k0s(),e.j41(90,"div",57),e.nrm(91,"i",58),e.EFF(92,"(555) 123-4567 "),e.k0s()(),e.j41(93,"div",59),e.nrm(94,"i",11)(95,"span",60),e.k0s(),e.j41(96,"div",61),e.nrm(97,"button",62)(98,"button",63),e.k0s()()()()(),e.DNE(99,pl,3,0,"div",64)(100,gl,3,0,"div",64),e.k0s()()),2&n&&(e.R7$(99),e.Y8G("ngIf",!i.showCart),e.R7$(),e.Y8G("ngIf",i.showCart))},dependencies:[p.bT,g.Mm,g.D9]})}}return r})();const hl=()=>[1,2,3,4,5],fl=(r,s)=>({"bg-primary text-white":r,"bg-light text-dark":s}),bl=()=>["Not Started","In Progress","Actions","Results","Completed"];function vl(r,s){if(1&r&&(e.j41(0,"div",13)(1,"span",14),e.EFF(2),e.k0s(),e.j41(3,"div",15),e.EFF(4),e.k0s()()),2&r){const t=s.$implicit,n=s.index,i=e.XpG();e.R7$(),e.Y8G("ngClass",e.l_i(3,fl,i.currentStep===t,i.currentStep!==t)),e.R7$(),e.SpI(" ",t," "),e.R7$(2),e.SpI(" ",e.lJ4(6,bl)[n]," ")}}function Sl(r,s){1&r&&(e.j41(0,"div")(1,"div",16)(2,"h4",17),e.EFF(3,"Acme Corporation"),e.k0s(),e.j41(4,"p",18),e.EFF(5,"123 Business Ave, Commerce City, CA 94105"),e.k0s(),e.j41(6,"div",19),e.nrm(7,"input",20)(8,"label",21),e.k0s(),e.j41(9,"p",22)(10,"span",23),e.EFF(11,"Unknown location"),e.k0s(),e.j41(12,"span",23),e.EFF(13,"\u24d8"),e.k0s()()(),e.j41(14,"div",16),e.nrm(15,"h4",24),e.j41(16,"div",25),e.nrm(17,"label",26),e.j41(18,"div",27),e.nrm(19,"button",28)(20,"button",29)(21,"button",30)(22,"button",31)(23,"button",32)(24,"button",33),e.k0s()(),e.j41(25,"div",25),e.nrm(26,"label",34)(27,"textarea",35),e.k0s(),e.j41(28,"div",25),e.nrm(29,"label",36)(30,"textarea",37),e.k0s()()())}function Cl(r,s){1&r&&(e.j41(0,"div")(1,"div",38)(2,"div",39),e.nrm(3,"h4",40)(4,"p",41),e.j41(5,"div",25)(6,"div",42)(7,"div"),e.nrm(8,"p",43)(9,"small",44),e.k0s(),e.j41(10,"button",45)(11,"span",46),e.nrm(12,"i",47),e.k0s()()()(),e.j41(13,"div",25)(14,"div",42)(15,"div"),e.nrm(16,"p",48)(17,"small",44),e.k0s(),e.j41(18,"button",45)(19,"span",46),e.nrm(20,"i",47),e.k0s()()()(),e.j41(21,"div",25)(22,"div",42)(23,"div"),e.nrm(24,"p",49),e.j41(25,"small",23),e.EFF(26,"Last purchased: 3 week ago"),e.k0s()(),e.j41(27,"button",45)(28,"span",46),e.nrm(29,"i",47),e.k0s()()()(),e.j41(30,"div",25)(31,"div",42)(32,"div"),e.nrm(33,"p",50),e.j41(34,"small",23),e.EFF(35,"Last purchased: 3 week ago"),e.k0s()(),e.j41(36,"button",45)(37,"span",46),e.nrm(38,"i",47),e.k0s()()()(),e.j41(39,"div",51)(40,"span",52),e.EFF(41,"\u26a0\ufe0f"),e.k0s(),e.nrm(42,"span",53),e.k0s(),e.j41(43,"button",54)(44,"span",52),e.nrm(45,"i",47),e.k0s()()()()())}function xl(r,s){1&r&&(e.j41(0,"div")(1,"div",55)(2,"div",56),e.nrm(3,"h5",57),e.j41(4,"div",58)(5,"button",59)(6,"span",52),e.nrm(7,"i",60),e.k0s()(),e.j41(8,"button",61)(9,"span",52),e.nrm(10,"i",62),e.k0s(),e.nrm(11,"span",63),e.k0s(),e.j41(12,"button",64)(13,"span",52),e.nrm(14,"i",47),e.k0s()()()()(),e.j41(15,"div",65)(16,"div",56),e.nrm(17,"h5",66)(18,"p",67),e.j41(19,"div",68)(20,"button",69)(21,"span",52),e.nrm(22,"i",70),e.k0s()(),e.j41(23,"button",71)(24,"span",52),e.nrm(25,"i",72),e.k0s()()()()(),e.j41(26,"div",73)(27,"button",74)(28,"span",75),e.nrm(29,"i",76),e.k0s()(),e.nrm(30,"button",77),e.k0s()())}function yl(r,s){1&r&&(e.j41(0,"div")(1,"div",78)(2,"div",79),e.nrm(3,"h5",80)(4,"span",81),e.k0s(),e.j41(5,"div",82)(6,"p",83),e.EFF(7,"Visit to Acme Corporation"),e.k0s()(),e.j41(8,"div",82),e.nrm(9,"label",84),e.j41(10,"div",68),e.nrm(11,"button",85)(12,"button",86),e.k0s()(),e.j41(13,"div",82)(14,"label",87),e.EFF(15,"Completed Actions"),e.k0s(),e.j41(16,"div",88)(17,"button",89),e.EFF(18,"Shelf Audit"),e.k0s(),e.j41(19,"span",90),e.nrm(20,"i",91),e.k0s()()(),e.j41(21,"div",82),e.nrm(22,"label",92)(23,"textarea",93),e.k0s(),e.nrm(24,"button",94),e.k0s()())}function Il(r,s){1&r&&(e.j41(0,"div")(1,"div",95)(2,"div",96)(3,"div",97),e.EFF(4,"\u2714\ufe0f"),e.k0s(),e.nrm(5,"h2",98)(6,"p",99)(7,"a",100),e.k0s()()())}let jl=(()=>{class r{constructor(){this.currentStep=1,this.totalSteps=5,this.actions=[{name:"Start",icon:"ri-play-line"},{name:"Pause",icon:"ri-pause-line"},{name:"End",icon:"ri-stop-line"}],this.selectedAction=""}ngOnInit(){}fileChange(t,n){const i=t.target.files[0];if(!i)return;const a=new FileReader;a.onerror=()=>{console.error("Error reading file",a.error),alert("\u062d\u062f\u062b \u062e\u0637\u0623 \u0623\u062b\u0646\u0627\u0621 \u062a\u062d\u0645\u064a\u0644 \u0627\u0644\u0635\u0648\u0631\u0629")},a.readAsDataURL(i)}goToPreviousStep(){this.currentStep>1&&this.currentStep--}goToNextStep(){this.currentStep<this.totalSteps&&this.currentStep++}cancelVisit(){this.currentStep=1}selectAction(t){this.selectedAction=t}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-StartVisits"]],decls:18,vars:9,consts:[[1,"d-flex","justify-content-center","min-vh-100","align-items-center"],[1,"container","col-md-10","col-lg-8"],["translate","sales.startVisits.customerVisit",1,"mb-3","text-center","me-1"],[1,"badge","bg-secondary","rounded-pill"],[1,"d-flex","justify-content-center","p-2","rounded","mb-4"],[1,"d-flex","justify-content-between","w-75"],["class","text-center",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"d-flex","justify-content-between"],["translate","sales.startVisits.back",1,"btn","btn-outline-secondary","w-25","me-2",3,"click","disabled"],["translate","sales.startVisits.next",1,"btn","btn-outline-dark","w-50","me-2",3,"click","disabled"],[1,"ri-arrow-right-line","ms-2"],["translate","sales.startVisits.cancelVisit",1,"btn","btn-outline-danger","w-25",3,"click"],[1,"text-center"],[1,"badge","rounded-circle","me-2","border","p-3",3,"ngClass"],[1,"text-dark"],[1,"card","p-3","mb-4"],[1,"mb-2","fs-3","fw-bold"],[1,"mb-2"],[1,"form-check","mb-2"],["type","checkbox","id","currentTime","checked","",1,"form-check-input"],["for","currentTime","translate","sales.startVisits.current",1,"form-check-label"],["translate","sales.startVisits.currentLocation",1,"text-danger","mb-3"],[1,"text-muted"],["translate","sales.startVisits.visitInformation",1,"mb-3"],[1,"mb-3"],["translate","sales.startVisits.visitGoals",1,"form-label","fw-bold"],["role","group",1,"btn-group","d-flex","flex-wrap"],["type","button","translate","sales.startVisits.sales",1,"btn","btn-outline-secondary","rounded-pill","me-2","mb-2","active"],["type","button","translate","sales.startVisits.collection",1,"btn","btn-outline-secondary","rounded-pill","me-2","mb-2"],["type","button","translate","sales.startVisits.shelf",1,"btn","btn-outline-secondary","rounded-pill","me-2","mb-2"],["type","button","translate","sales.startVisits.order",1,"btn","btn-outline-secondary","rounded-pill","me-2","mb-2"],["type","button","translate","sales.startVisits.audit",1,"btn","btn-outline-secondary","rounded-pill","me-2","mb-2"],["type","button","translate","sales.startVisits.other",1,"btn","btn-outline-secondary","rounded-pill","mb-2"],["translate","sales.startVisits.visitPurpose",1,"form-label","fw-bold"],["rows","2","placeholder","Brief description of visit purpose",1,"form-control"],["translate","sales.startVisits.visitNotes",1,"form-label","fw-bold"],["rows","3","placeholder","Additional notes about this visit",1,"form-control"],[1,"card","p-5","text-center","text-muted","mb-4"],[1,"card","p-3"],["translate","sales.startVisits.shelfAudit",1,"fw-bold","fs-2"],["translate","sales.startVisits.category",1,"text-muted"],[1,"d-flex","justify-content-between","align-items-center","border","rounded","p-2","mb-2"],["translate","sales.startVisits.beverages",1,"mb-0","fw-bold"],["translate","sales.startVisits.lastpurchased",1,"text-muted"],["translate","sales.startVisits.uploadPhoto",1,"btn","btn-outline-secondary","btn-sm"],[1,"me-1"],[1,"ri-camera-line"],["translate","sales.startVisits.snacks",1,"mb-0","fw-bold"],["translate","sales.startVisits.dairy",1,"mb-0","fw-bold"],["translate","sales.startVisits.cleaningProducts",1,"mb-0","fw-bold"],[1,"alert","alert-warning","d-none","align-items-center","mb-2"],[1,"me-2"],["translate","sales.startVisits.pleaseupload"],["translate","sales.startVisits.uploadAllPhotos",1,"btn","btn-secondary","w-100","d-flex","justify-content-center","align-items-center"],[1,"card","shadow-sm","mb-4","py-5"],[1,"card-body"],["translate","sales.startVisits.visitActions",1,"card-title","fw-bold"],[1,"d-flex","flex-wrap","gap-2"],["translate","sales.startVisits.logCollection",1,"btn","btn-outline-secondary","d-flex","py-3","align-items-center"],[1,"ri-layout-top-line"],["translate","sales.startVisits.shelfAuditResult",1,"btn","btn-outline-success","py-3","d-flex","align-items-center"],[1,"ri-battery-2-line"],["translate","sales.startVisits.completed",1,"badge","bg-success","ms-2"],["translate","sales.startVisits.uploadPhoto",1,"btn","btn-outline-warning","py-3","d-flex","align-items-center"],[1,"card","shadow-sm","mb-4"],["translate","sales.startVisits.visitResult",1,"card-title","fw-bold"],["translate","sales.startVisits.systemSuggested",1,"text-muted"],[1,"d-flex","gap-2"],["translate","sales.startVisits.positive",1,"btn","btn-success","d-flex","align-items-center"],[1,"ri-check-line","bg-success"],["translate","sales.startVisits.negative",1,"btn","btn-outline-danger","d-flex","align-items-center"],[1,"ri-close-line","bg-danger"],[1,"d-flex","gap-2","mb-5"],["translate","sales.startVisits.endVisit",1,"btn","btn-primary","opacety-10","w-100","d-flex","align-items-center","justify-content-center"],[1,"ms-2"],[1,"ri-arrow-right-line"],["translate","sales.startVisits.cancelVisit",1,"btn","btn-outline-danger","w-25","d-flex","align-items-center","justify-content-center"],[1,"card","shadow-sm","p-4"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],["translate","sales.startVisits.visitSummary",1,"card-title","fw-bold","mb-0"],["translate","sales.startVisits.positiveVisit",1,"badge","bg-success","rounded-pill","px-3","py-2"],[1,"mb-4"],[1,"text-muted","mb-0"],["translate","sales.startVisits.visitType",1,"form-label","fw-medium"],["translate","sales.startVisits.collection",1,"btn","btn-outline-success","btn-sm","rounded-pill","px-3","py-1","active"],["translate","sales.startVisits.shelfAudit",1,"btn","btn-outline-secondary","btn-sm","rounded-pill","px-3","py-1"],[1,"form-label","fw-medium"],[1,"d-flex","align-items-center"],[1,"btn","btn-outline-primary","btn-sm","rounded-pill","px-3","py-1"],[1,"text-success","ms-2"],[1,"ri-check-line","fs-1"],["translate","sales.startVisits.additionalNotes",1,"form-label","fw-medium"],["rows","4","placeholder","Add any additional notes about this visit",1,"form-control","border-light"],["translate","sales.startVisits.submitVisit",1,"btn","btn-secondary","w-100","rounded-pill","py-2"],[1,"container","d-flex","justify-content-center","align-items-center","vh-100"],[1,"bg-light","p-5","rounded-4","shadow-lg","text-center"],[1,"display-1","text-primary","mb-3"],["translate","sales.startVisits.completed",1,"fw-bold","text-dark","mb-3"],["translate","sales.startVisits.allvisitsteps",1,"fs-5","text-muted","mb-4"],["routerLink","/","translate","sales.startVisits.backToDashboard",1,"btn","btn-primary","px-5","py-2","rounded-pill","shadow"]],template:function(n,i){1&n&&(e.j41(0,"div",0)(1,"div",1)(2,"h2",2)(3,"span",3),e.EFF(4,"Draft"),e.k0s()(),e.j41(5,"div",4)(6,"div",5),e.DNE(7,vl,5,7,"div",6),e.k0s()(),e.DNE(8,Sl,31,0,"div",7)(9,Cl,46,0,"div",7)(10,xl,31,0,"div",7)(11,yl,25,0,"div",7)(12,Il,8,0,"div",7),e.j41(13,"div",8)(14,"button",9),e.bIt("click",function(){return i.goToPreviousStep()}),e.k0s(),e.j41(15,"button",10),e.bIt("click",function(){return i.goToNextStep()}),e.nrm(16,"i",11),e.k0s(),e.j41(17,"button",12),e.bIt("click",function(){return i.cancelVisit()}),e.k0s()()()()),2&n&&(e.R7$(7),e.Y8G("ngForOf",e.lJ4(8,hl)),e.R7$(),e.Y8G("ngIf",1===i.currentStep),e.R7$(),e.Y8G("ngIf",2===i.currentStep),e.R7$(),e.Y8G("ngIf",3===i.currentStep),e.R7$(),e.Y8G("ngIf",4===i.currentStep),e.R7$(),e.Y8G("ngIf",5===i.currentStep),e.R7$(2),e.Y8G("disabled",1===i.currentStep),e.R7$(),e.Y8G("disabled",5===i.currentStep))},dependencies:[p.YU,p.Sq,p.bT,M.Wk,g.Mm]})}}return r})(),Tl=(()=>{class r{constructor(){}ngOnInit(){}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-DashboardSalesRep"]],decls:402,vars:21,consts:[[1,"row"],[1,"col-md-4","mb-3"],[1,"card","shadow-sm","card-animate","rounded-4","mb-4","border-0"],[1,"card-header","login-modal","rounded-top-4"],[1,"d-flex","justify-content-between","align-items-center"],[1,"d-flex","align-items-center"],[1,"ri-funds-line","fs-4","text-white","me-2"],["translate","sales.dashboardSalesRep.monthlySalesTarget",1,"mb-0","text-white"],[1,"text-success","fw-semibold","d-flex","align-items-center","small"],[1,"bx","bxs-up-arrow-alt","me-1","bx-sm","text-success"],[1,"card-body"],[1,"position-relative","me-4"],["width","100%","height","100%","viewBox","0 0 36 36",1,"circular-chart"],["d","M18 2.0845\n             a 15.9155 15.9155 0 0 1 0 31.831\n             a 15.9155 15.9155 0 0 1 0 -31.831","fill","none","stroke","#eee","stroke-width","2.5",1,"circle-bg"],["stroke-dasharray","75, 100","d","M18 2.0845\n             a 15.9155 15.9155 0 0 1 0 31.831\n             a 15.9155 15.9155 0 0 1 0 -31.831","fill","none","stroke","#4f68bb","stroke-width","2.5",1,"circle"],[1,"position-absolute","top-50","start-50","translate-middle","fw-bold","display-6"],[1,"flex-grow-1"],["translate","sales.dashboardSalesRep.salesAchieved",1,"text-sm","font-medium","text-muted-foreground"],[1,"fw-bold","fs-4","badge","bg-danger"],["translate","sales.dashboardSalesRep.targetTillToday",1,"text-sm","font-medium","text-muted-foreground"],[1,"ff-secondary","fw-bold","fs-5"],["translate","sales.dashboardSalesRep.monthlyTarget",1,"text-sm","font-medium","text-muted-foreground"],["translate","sales.dashboardSalesRep.RemainingToTarget",1,"text-sm","font-medium","text-muted-foreground"],[1,"text-warning","fw-bold","fs-5"],[1,"ri-coins-line","fs-4","text-white","me-2"],["translate","sales.dashboardSalesRep.monthlyCollectionTarget",1,"mb-0","text-white"],["stroke-dasharray","23, 100","d","M18 2.0845\n             a 15.9155 15.9155 0 0 1 0 31.831\n             a 15.9155 15.9155 0 0 1 0 -31.831","fill","none","stroke","#299cdb","stroke-width","2.5",1,"circle"],["translate","sales.dashboardSalesRep.collectionAchieved",1,"text-sm","font-medium","text-muted-foreground"],[1,"fw-bold","fs-4","badge","bg-warning"],[1,"row","mb-4"],[1,"col-xxl-4","col-sm-4","mb-3"],[1,"card","card-animate","rounded-4","h-100","border-1","border-primary"],[1,"card-body","position-relative"],[1,"position-absolute","top-0","end-0","m-3"],[1,"avatar-sm"],[1,"avatar-title","text-black","rounded-4","fs-5",2,"background-color","#f0f8ff"],[1,"ri-group-fill"],["translate","sales.dashboardSalesRep.activeCustomers",1,"fw-medium","text-primary","fs-4","mb-1"],[1,"mt-2","ff-secondary","fw-bold","fs-4","text-primary"],[1,"mb-0","text-muted","small"],[1,"ri-add-fill","text-success"],[1,"text-success"],[1,"card","card-animate","rounded-4","h-100","border-1","border-success"],[1,"avatar-title","text-black","rounded-4","fs-5",2,"background-color","#dfffd6"],["translate","sales.dashboardSalesRep.newCustomers",1,"fw-medium","text-primary","fs-4","mb-1"],[1,"mt-2","ff-secondary","fw-bold","fs-4","text-success"],[1,"card","card-animate","rounded-4","h-100","border-1","border-danger"],[1,"avatar-title","text-black","rounded-4","fs-5",2,"background-color","#ffcccc"],["translate","sales.dashboardSalesRep.inactiveCustomers",1,"fw-medium","text-primary","fs-4","mb-1"],[1,"mt-2","ff-secondary","fw-bold","fs-4","text-danger"],[1,"ri-subtract-line","text-danger"],[1,"text-danger"],[1,"col-md-6","mb-3"],[1,"ri-service-line","fs-4","text-white","me-2"],["translate","sales.dashboardSalesRep.monthlyVisitTarget",1,"mb-0","text-white"],[1,"text-danger","fw-semibold","d-flex","align-items-center","small"],[1,"bx","bxs-down-arrow-alt","me-1","bx-sm","text-danger"],[1,"col-12"],[1,"mb-4"],[1,"d-flex","justify-content-between","mb-2"],["translate","sales.dashboardSalesRep.progress",1,"progress-text"],[1,"progress-text"],[1,"progress"],["role","progressbar","aria-valuenow","72","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","progress-bar-striped","bg-success",2,"width","72%"],[1,"row","text-center","mb-4"],[1,"col"],[1,"target-numbers","completed-text"],["translate","sales.dashboardSalesRep.Completed",1,"text-muted","small"],[1,"col-auto","px-0","d-flex","align-items-center"],[1,"divider"],[1,"target-numbers","target-text"],["translate","sales.dashboardSalesRep.Target",1,"text-muted","small"],[1,"remaining-container","text-center"],["translate","sales.dashboardSalesRep.RemainingToTarget",1,"remaining-text","mb-1"],[1,"target-numbers","text-warning","fw-bold","fs-5"],[1,"card","card-animate","rounded-4","h-100","border-1"],[1,"avatar-title","bg-light","text-primary","rounded-4","fs-5"],[1,"ri-calendar-line"],["translate","sales.dashboardSalesRep.scheduledVisits",1,"fw-medium","text-muted","mb-1"],[1,"mt-2","ff-secondary","fw-bold","fs-4"],["translate","sales.dashboardSalesRep.today",1,"mb-0","text-muted","small"],["translate","sales.dashboardSalesRep.completedVisits",1,"fw-medium","text-muted","mb-1"],["translate","sales.dashboardSalesRep.overdueVisits",1,"fw-medium","text-muted","mb-1"],[1,"col-md-6"],[1,"card","p-3"],[1,"d-flex","justify-content-between","mb-3"],["translate","sales.dashboardSalesRep.invoicesDue"],[1,"badge","bg-primary"],["translate","sales.dashboardSalesRep.totalAmountDue",1,"mb-3","fw-bold"],[1,"list-group"],[1,"list-group-item"],[1,"d-flex","w-100","justify-content-between"],[1,"mb-1"],[1,"d-flex","justify-content-end"],["translate","sales.dashboardSalesRep.overdue",1,"badge","bg-danger"],[1,"text-muted","ms-2"],[1,"badge","bg-secondary"],[1,"text-center","mt-2","text-primary"],["translate","sales.dashboardSalesRep.upcomingVisits",1,"mb-3"],[1,"table-responsive"],[1,"table","table-borderless"],["translate","sales.dashboardSalesRep.customerName"],["translate","sales.dashboardSalesRep.visitType"],["translate","sales.dashboardSalesRep.Location"],["translate","sales.dashboardSalesRep.Time"],[1,"bi","bi-person-circle","me-2"],["translate","sales.dashboardSalesRep.sales",1,"badge","bg-primary"],[1,"bi","bi-geo-alt","me-2"],[1,"bi","bi-calendar-event","me-2"],[1,"text-end"],[1,"bi","bi-three-dots"],[1,"badge","bg-success"],["translate","sales.dashboardSalesRep.collection",1,"badge","bg-success"],[1,"badge","bg-light","text-dark"],["translate","sales.dashboardSalesRep.follow-up",1,"badge","bg-light","text-dark"],[1,"card","p-3","border-0","shadow-sm"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],["translate","sales.dashboardSalesRep.notifications",1,"mb-0"],[1,"badge","bg-secondary","rounded-pill"],["href","#","translate","sales.dashboardSalesRep.viewAll",1,"text-primary","small"],[1,"mb-3"],[1,"d-flex","align-items-start","mb-2"],[1,"badge","rounded-circle","border","border-primary","me-2","p-1","d-flex","justify-content-center","align-items-center",2,"width","30px","height","30px","background-color","transparent","color","#c63b3b"],[1,"mdi","mdi-alert-circle-outline"],["translate","sales.dashboardSalesRep.overdueVisit",1,"d-block"],["translate","sales.dashboardSalesRep.yourScheduledVisit",1,"text-muted","small"],["translate","sales.dashboardSalesRep.hourAgo",1,"text-muted"],["href","#","translate","sales.dashboardSalesRep.markAsRead",1,"text-primary","small","ms-2"],[1,"d-flex","align-items-start","mb-2","border-primary"],[1,"badge","rounded-circle","me-2","p-2",2,"background-color","#cce5ff","color","white"],[1,"bx","bxl-snapchat"],["translate","sales.dashboardSalesRep.visitCanceled",1,"d-block"],["translate","sales.dashboardSalesRep.saudiTech",1,"text-muted","small"],["translate","sales.dashboardSalesRep.hoursAgo",1,"text-muted"],["href","#","translate","sales.dashboardSalesRep.saudiTech",1,"text-primary","small","ms-2"],[1,"badge","rounded-circle","me-2","p-2",2,"background-color","#ffcc00","color","white"],[1,"bx","bx-time-five"],["translate","sales.dashboardSalesRep.paymentReminder",1,"d-block"],[1,"text-muted","small"],[1,"text-muted"],[1,"text-center","mt-2"],["href","#","translate","sales.dashboardSalesRep.moreNotifications",1,"text-primary","small"],["translate","sales.dashboardSalesRep.recentActivity",1,"mb-3"],[1,"badge","bg-success","rounded-circle","me-2","p-2"],[1,"bi","bi-check-circle"],["translate","sales.dashboardSalesRep.visitCompleted",1,"d-block"],["translate","sales.dashboardSalesRep.discussed",1,"text-muted","small"],[1,"badge","bg-primary","rounded-circle","me-2","p-2"],[1,"bi","bi-cart"],["translate","sales.dashboardSalesRep.newSaleRecorded",1,"d-block"],[1,"bi","bi-cash"],["translate","sales.dashboardSalesRep.collectionMade",1,"d-block"],["translate","sales.dashboardSalesRep.received",1,"text-muted","small"],["translate","sales.dashboardSalesRep.yesterday",1,"text-muted"]],template:function(n,i){1&n&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),e.nrm(6,"i",6)(7,"h5",7),e.k0s(),e.j41(8,"div",8),e.nrm(9,"i",9),e.j41(10,"span"),e.EFF(11),e.nI1(12,"translate"),e.k0s()()()(),e.j41(13,"div",10)(14,"div",4)(15,"div",11),e.qSk(),e.j41(16,"svg",12),e.nrm(17,"path",13)(18,"path",14),e.k0s(),e.joV(),e.j41(19,"div",15),e.EFF(20," %75 "),e.k0s()(),e.j41(21,"div")(22,"div",16),e.nrm(23,"span",17),e.j41(24,"h2",18),e.EFF(25,"60,000 SAR"),e.k0s()(),e.nrm(26,"span",19),e.j41(27,"h2",20),e.EFF(28,"80,000 SAR"),e.k0s(),e.nrm(29,"span",21),e.j41(30,"h2",20),e.EFF(31,"100,000 SAR"),e.k0s(),e.nrm(32,"span",22),e.j41(33,"h2",23),e.EFF(34,"40,000 SAR"),e.k0s()()()()()(),e.j41(35,"div",1)(36,"div",2)(37,"div",3)(38,"div",4)(39,"div",5),e.nrm(40,"i",24)(41,"h5",25),e.k0s(),e.j41(42,"div",8),e.nrm(43,"i",9),e.j41(44,"span"),e.EFF(45),e.nI1(46,"translate"),e.k0s()()()(),e.j41(47,"div",10)(48,"div",4)(49,"div",11),e.qSk(),e.j41(50,"svg",12),e.nrm(51,"path",13)(52,"path",26),e.k0s(),e.joV(),e.j41(53,"div",15),e.EFF(54," %23 "),e.k0s()(),e.j41(55,"div")(56,"div",16),e.nrm(57,"span",27),e.j41(58,"h2",28),e.EFF(59,"30,000 SAR"),e.k0s()(),e.nrm(60,"span",19),e.j41(61,"h2",20),e.EFF(62,"80,000 SAR"),e.k0s(),e.nrm(63,"span",21),e.j41(64,"h2",20),e.EFF(65,"100,000 SAR"),e.k0s(),e.nrm(66,"span",22),e.j41(67,"h2",23),e.EFF(68,"70,000 SAR"),e.k0s()()()()()()(),e.j41(69,"div",29)(70,"div",30)(71,"div",31)(72,"div",32)(73,"div",33)(74,"div",34)(75,"span",35),e.nrm(76,"i",36),e.k0s()()(),e.nrm(77,"p",37),e.j41(78,"h2",38),e.EFF(79,"25"),e.k0s(),e.j41(80,"p",39),e.nrm(81,"i",40),e.j41(82,"span",41),e.EFF(83,"12%"),e.k0s(),e.EFF(84),e.nI1(85,"translate"),e.k0s()()()(),e.j41(86,"div",30)(87,"div",42)(88,"div",32)(89,"div",33)(90,"div",34)(91,"span",43),e.nrm(92,"i",36),e.k0s()()(),e.nrm(93,"p",44),e.j41(94,"h2",45),e.EFF(95,"5"),e.k0s(),e.j41(96,"p",39),e.nrm(97,"i",40),e.j41(98,"span",41),e.EFF(99,"12%"),e.k0s(),e.EFF(100),e.nI1(101,"translate"),e.k0s()()()(),e.j41(102,"div",30)(103,"div",46)(104,"div",32)(105,"div",33)(106,"div",34)(107,"span",47),e.nrm(108,"i",36),e.k0s()()(),e.nrm(109,"p",48),e.j41(110,"h2",49),e.EFF(111,"10"),e.k0s(),e.j41(112,"p",39),e.nrm(113,"i",50),e.j41(114,"span",51),e.EFF(115,"5%"),e.k0s(),e.EFF(116),e.nI1(117,"translate"),e.k0s()()()()(),e.j41(118,"div",0)(119,"div",52)(120,"div",2)(121,"div",3)(122,"div",4)(123,"div",5),e.nrm(124,"i",53)(125,"h5",54),e.k0s(),e.j41(126,"div",55),e.nrm(127,"i",56),e.j41(128,"span"),e.EFF(129),e.nI1(130,"translate"),e.k0s()()()(),e.j41(131,"div",10)(132,"div",0)(133,"div",57)(134,"div",58)(135,"div",59),e.nrm(136,"span",60),e.j41(137,"span",61),e.EFF(138,"72%"),e.k0s()(),e.j41(139,"div",62),e.nrm(140,"div",63),e.k0s()(),e.j41(141,"div",64)(142,"div",65)(143,"div",66),e.EFF(144,"18"),e.k0s(),e.nrm(145,"div",67),e.k0s(),e.j41(146,"div",68),e.nrm(147,"div",69),e.k0s(),e.j41(148,"div",65)(149,"div",70),e.EFF(150,"25"),e.k0s(),e.nrm(151,"div",71),e.k0s()(),e.j41(152,"div",72),e.nrm(153,"p",73),e.j41(154,"h3",74),e.EFF(155,"7"),e.k0s()()()(),e.j41(156,"div",0)(157,"div",30)(158,"div",75)(159,"div",32)(160,"div",33)(161,"div",34)(162,"span",76),e.nrm(163,"i",77),e.k0s()()(),e.nrm(164,"p",78),e.j41(165,"h2",79),e.EFF(166,"3"),e.k0s(),e.nrm(167,"p",80),e.k0s()()(),e.j41(168,"div",30)(169,"div",75)(170,"div",32)(171,"div",33)(172,"div",34)(173,"span",43),e.nrm(174,"i",77),e.k0s()()(),e.nrm(175,"p",81),e.j41(176,"h2",45),e.EFF(177,"2"),e.k0s(),e.nrm(178,"p",80),e.k0s()()(),e.j41(179,"div",30)(180,"div",75)(181,"div",32)(182,"div",33)(183,"div",34)(184,"span",47),e.nrm(185,"i",77),e.k0s()()(),e.nrm(186,"p",82),e.j41(187,"h2",49),e.EFF(188,"10"),e.k0s(),e.j41(189,"p",39),e.nrm(190,"i",50),e.j41(191,"span",51),e.EFF(192," 5%"),e.k0s(),e.EFF(193),e.nI1(194,"translate"),e.k0s()()()()()()()(),e.j41(195,"div",83)(196,"div",84)(197,"div",85),e.nrm(198,"h5",86),e.j41(199,"span",87),e.EFF(200,"5"),e.k0s()(),e.nrm(201,"div",88),e.j41(202,"div",89)(203,"div",90)(204,"div",91)(205,"h6",92),e.EFF(206,"Al Faisal Trading Co."),e.k0s(),e.j41(207,"small"),e.EFF(208,"15,000 SAR"),e.k0s()(),e.j41(209,"div",93),e.nrm(210,"span",94),e.j41(211,"small",95),e.EFF(212,"May 15, 2024"),e.k0s()()(),e.j41(213,"div",90)(214,"div",91)(215,"h6",92),e.EFF(216,"Najm Electronics"),e.k0s(),e.j41(217,"small"),e.EFF(218,"8,000 SAR"),e.k0s()(),e.j41(219,"div",93)(220,"span",96),e.EFF(221,"Due in 3 days"),e.k0s(),e.j41(222,"small",95),e.EFF(223,"May 20, 2024"),e.k0s()()(),e.j41(224,"div",90)(225,"div",91)(226,"h6",92),e.EFF(227,"Al Jazeera Supplies"),e.k0s(),e.j41(228,"small"),e.EFF(229,"12,000 SAR"),e.k0s()(),e.j41(230,"div",93)(231,"span",96),e.EFF(232,"Due in 11 days"),e.k0s(),e.j41(233,"small",95),e.EFF(234,"May 28, 2024"),e.k0s()()(),e.j41(235,"div",90)(236,"div",91)(237,"h6",92),e.EFF(238,"Saudi Tech Solutions"),e.k0s(),e.j41(239,"small"),e.EFF(240,"5,200 SAR"),e.k0s()(),e.j41(241,"div",93)(242,"span",96),e.EFF(243,"Due in 19 days"),e.k0s(),e.j41(244,"small",95),e.EFF(245,"June 5, 2024"),e.k0s()()()(),e.j41(246,"div",97),e.EFF(247,"+ 1 more invoices"),e.k0s()()()(),e.j41(248,"div",84),e.nrm(249,"h5",98),e.j41(250,"div",99)(251,"table",100)(252,"thead")(253,"tr"),e.nrm(254,"th",101)(255,"th",102)(256,"th",103)(257,"th",104)(258,"th"),e.k0s()(),e.j41(259,"tbody")(260,"tr")(261,"td"),e.nrm(262,"i",105),e.EFF(263," Al Faisal Trading Co. "),e.k0s(),e.j41(264,"td"),e.nrm(265,"span",106),e.k0s(),e.j41(266,"td"),e.nrm(267,"span",106),e.k0s(),e.j41(268,"td"),e.nrm(269,"i",107),e.EFF(270," Riyadh, Main Office"),e.k0s(),e.j41(271,"td"),e.nrm(272,"i",108),e.EFF(273," Today, 2:00 PM"),e.k0s(),e.j41(274,"td",109),e.nrm(275,"i",110),e.k0s()(),e.j41(276,"tr")(277,"td"),e.nrm(278,"i",105),e.EFF(279," Najm Electronics"),e.k0s(),e.j41(280,"td")(281,"span",111),e.EFF(282,"Collection"),e.k0s()(),e.j41(283,"td"),e.nrm(284,"i",107),e.EFF(285," Jeddah, Branch #2"),e.k0s(),e.j41(286,"td"),e.nrm(287,"i",108),e.EFF(288," Today, 4:30 PM"),e.k0s(),e.j41(289,"td"),e.nrm(290,"i",105),e.EFF(291," Najm Electronics "),e.k0s(),e.j41(292,"td"),e.nrm(293,"span",112),e.k0s(),e.j41(294,"td"),e.nrm(295,"i",107),e.EFF(296," Jeddah, Branch #2 "),e.k0s(),e.j41(297,"td"),e.nrm(298,"i",108),e.EFF(299," Today, 4:30 PM "),e.k0s(),e.j41(300,"td",109),e.nrm(301,"i",110),e.k0s()(),e.j41(302,"tr")(303,"td"),e.nrm(304,"i",105),e.EFF(305," Al Jazeera Supplies"),e.k0s(),e.j41(306,"td")(307,"span",113),e.EFF(308,"Follow-up"),e.k0s()(),e.j41(309,"td"),e.nrm(310,"i",107),e.EFF(311," Dammam, Warehouse"),e.k0s(),e.j41(312,"td"),e.nrm(313,"i",108),e.EFF(314," Tomorrow, 10:00 AM"),e.k0s(),e.j41(315,"td"),e.nrm(316,"i",105),e.EFF(317," Al Jazeera Supplies "),e.k0s(),e.j41(318,"td"),e.nrm(319,"span",114),e.k0s(),e.j41(320,"td"),e.nrm(321,"i",107),e.EFF(322," Dammam, Warehouse "),e.k0s(),e.j41(323,"td"),e.nrm(324,"i",108),e.EFF(325," Tomorrow, 10:00 AM "),e.k0s(),e.j41(326,"td",109),e.nrm(327,"i",110),e.k0s()()()()()(),e.j41(328,"div",115)(329,"div",116)(330,"h5",117)(331,"span",118),e.EFF(332,"4"),e.k0s()(),e.nrm(333,"a",119),e.k0s(),e.j41(334,"div",120)(335,"div",121)(336,"span",122),e.nrm(337,"i",123),e.k0s(),e.j41(338,"div",16),e.nrm(339,"strong",124)(340,"span",125)(341,"br"),e.j41(342,"small",126),e.EFF(343,"2 hours ago"),e.k0s()(),e.nrm(344,"a",127),e.k0s()(),e.j41(345,"div",120)(346,"div",128)(347,"span",129),e.nrm(348,"i",130),e.k0s(),e.j41(349,"div",16),e.nrm(350,"strong",131)(351,"span",132)(352,"br")(353,"small",133),e.k0s(),e.j41(354,"a",134),e.EFF(355,"Mark as read"),e.k0s()()(),e.j41(356,"div",120)(357,"div",121)(358,"span",135),e.nrm(359,"i",136),e.k0s(),e.j41(360,"div",16),e.nrm(361,"strong",137),e.j41(362,"span",138),e.EFF(363,"Najm Electronics payment of 15,000 SAR is due tomorrow"),e.k0s(),e.nrm(364,"br"),e.j41(365,"small",139),e.EFF(366,"5 hours ago"),e.k0s()(),e.nrm(367,"a",127),e.k0s()(),e.j41(368,"div",140),e.nrm(369,"a",141),e.k0s()(),e.j41(370,"div",115),e.nrm(371,"h5",142),e.j41(372,"div",120)(373,"div",121)(374,"span",143),e.nrm(375,"i",144),e.k0s(),e.j41(376,"div",16),e.nrm(377,"strong",145)(378,"span",146)(379,"br"),e.j41(380,"small",139),e.EFF(381,"Today, 11:30 AM"),e.k0s()()()(),e.j41(382,"div",120)(383,"div",121)(384,"span",147),e.nrm(385,"i",148),e.k0s(),e.j41(386,"div",16),e.nrm(387,"strong",149),e.j41(388,"span",138),e.EFF(389,"Order #5782 - 12,500 SAR"),e.k0s(),e.nrm(390,"br"),e.j41(391,"small",139),e.EFF(392,"Today, 10:15 AM"),e.k0s()()()(),e.j41(393,"div",120)(394,"div",121)(395,"span",143),e.nrm(396,"i",150),e.k0s(),e.j41(397,"div",16),e.nrm(398,"strong",151)(399,"span",152)(400,"br")(401,"small",153),e.k0s()()()()),2&n&&(e.R7$(11),e.SpI("12 % ",e.bMT(12,7,"sales.dashboardSalesRep.VsLastMonth"),""),e.R7$(34),e.SpI("20 % ",e.bMT(46,9,"sales.dashboardSalesRep.VsLastMonth"),""),e.R7$(39),e.SpI(" ",e.bMT(85,11,"sales.dashboardSalesRep.VsLastMonth")," "),e.R7$(16),e.SpI(" ",e.bMT(101,13,"sales.dashboardSalesRep.VsLastMonth")," "),e.R7$(16),e.SpI(" ",e.bMT(117,15,"sales.dashboardSalesRep.VsLastMonth")," "),e.R7$(13),e.SpI(" 7% ",e.bMT(130,17,"sales.dashboardSalesRep.VsLastMonth"),""),e.R7$(64),e.SpI("",e.bMT(194,19,"sales.dashboardSalesRep.VsLastMonth")," "))},dependencies:[g.Mm,g.D9]})}}return r})();const kl=()=>["salesOrder.register"],wl=()=>["salesOrderStore.assignTrunk"],Ml=()=>["salesOrderStore.prepare"],Je=r=>[r];function Ol(r,s){1&r&&(e.j41(0,"th",65),e.EFF(1," sales.salesOrder.trunck "),e.k0s())}function Rl(r,s){if(1&r&&(e.j41(0,"tr",52),e.nrm(1,"th",53),e.j41(2,"th",54),e.EFF(3,"#"),e.k0s(),e.j41(4,"th",55),e.nrm(5,"i",56),e.EFF(6," orderManagement.order.orderCode "),e.k0s(),e.j41(7,"th",57),e.nrm(8,"i",56),e.EFF(9," orderManagement.order.creation "),e.k0s(),e.j41(10,"th",58),e.EFF(11," orderManagement.order.status "),e.k0s(),e.j41(12,"th",59),e.nrm(13,"i",56),e.EFF(14," orderManagement.order.agentName "),e.k0s(),e.j41(15,"th",60),e.EFF(16," sales.salesOrder.clientLocationName "),e.k0s(),e.j41(17,"th",61),e.EFF(18," sales.salesOrder.salsePerson "),e.k0s(),e.j41(19,"th",62),e.nrm(20,"i",56),e.EFF(21," sales.salesOrder.clientVisitDate "),e.k0s(),e.j41(22,"th",63),e.nrm(23,"i",56),e.EFF(24," sales.salesOrder.totalQuantity "),e.k0s(),e.DNE(25,Ol,2,0,"th",64),e.nrm(26,"th",61),e.k0s()),2&r){const t=e.XpG();e.R7$(25),e.Y8G("ngIf",t.showInfo)}}function Fl(r,s){1&r&&e.nrm(0,"span",76)}function Vl(r,s){if(1&r&&(e.j41(0,"a",77),e.nrm(1,"i",78),e.k0s()),2&r){const t=e.XpG().$implicit,n=e.XpG();e.Y8G("href",n.mapUrl(null==t?null:t.lng,null==t?null:t.lat),e.B4B)}}function El(r,s){if(1&r&&(e.j41(0,"td")(1,"div"),e.EFF(2),e.k0s(),e.j41(3,"div",79),e.EFF(4),e.k0s()()),2&r){const t=e.XpG().$implicit;e.R7$(2),e.JRh(t.shippingTruckName),e.R7$(2),e.JRh(t.driverName)}}function Nl(r,s){if(1&r){const t=e.RV6();e.j41(0,"button",81),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2).$implicit,a=e.XpG(),o=e.sdS(103);return e.Njj(a.openShippingModal(i.id,o,"lg"))}),e.nrm(2,"i",82),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"sales.salesOrderStore.trunkAssign"))}function Dl(r,s){if(1&r&&(e.qex(0),e.DNE(1,Nl,3,3,"button",80),e.bVm()),2&r){const t=e.XpG().$implicit;e.R7$(),e.Y8G("ngIf",32==t.offerOrderStatus)}}function Ll(r,s){if(1&r){const t=e.RV6();e.j41(0,"button",84),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2).$implicit,a=e.XpG(),o=e.sdS(97);return e.Njj(a.openStatusModal(i.id,o,32,"md"))}),e.nrm(2,"i",85),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"sales.salesOrderStore.ready"))}function Gl(r,s){if(1&r){const t=e.RV6();e.j41(0,"button",81),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2).$implicit,a=e.XpG();return e.Njj(a.PrintStoreReport(i.id))}),e.nrm(2,"i",86),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"general.action.print"))}function Pl(r,s){if(1&r&&(e.qex(0),e.DNE(1,Ll,3,3,"button",83)(2,Gl,3,3,"button",80),e.bVm()),2&r){const t=e.XpG().$implicit;e.R7$(),e.Y8G("ngIf",30==t.offerOrderStatus),e.R7$(),e.Y8G("ngIf",30==t.offerOrderStatus)}}function $l(r,s){if(1&r){const t=e.RV6();e.j41(0,"tr",66)(1,"td"),e.nrm(2,"button",67),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td")(6,"bdi",68),e.EFF(7),e.k0s()(),e.j41(8,"td"),e.EFF(9),e.nI1(10,"date"),e.k0s(),e.j41(11,"td")(12,"span"),e.nrm(13,"span",69),e.k0s()(),e.j41(14,"td",70),e.bIt("click",function(){const i=e.eBV(t).$implicit,a=e.XpG(),o=e.sdS(95);return e.Njj(a.openModal(i.clientId,o,"md"))}),e.j41(15,"a",71),e.EFF(16),e.k0s()(),e.j41(17,"td"),e.DNE(18,Fl,1,0,"span",72)(19,Vl,2,1,"a",73),e.k0s(),e.j41(20,"td"),e.EFF(21),e.k0s(),e.j41(22,"td"),e.EFF(23),e.nI1(24,"date"),e.k0s(),e.j41(25,"td"),e.EFF(26),e.k0s(),e.DNE(27,El,5,2,"td",74),e.j41(28,"td"),e.DNE(29,Dl,2,1,"ng-container",75)(30,Pl,3,2,"ng-container",75),e.k0s()()}if(2&r){const t=s.$implicit,n=s.rowIndex,i=s.expanded,a=e.XpG();e.R7$(2),e.Y8G("pRowToggler",t)("ngClass",i?" ri-arrow-down-s-line":"  ri-arrow-up-s-line"),e.R7$(2),e.JRh(n+1),e.R7$(3),e.SpI("#SO#",t.id,""),e.R7$(2),e.SpI(" ",e.i5U(10,18,t.creationTime,"yyyy-MM-dd HH:mm")," "),e.R7$(3),e.ZvI("badge ",a.getStatus(t),""),e.R7$(),e.FS9("translate","sales.salesOrder."+t.offerOrderStatusValue),e.R7$(3),e.SpI(" ",t.clientName," "),e.R7$(2),e.Y8G("ngIf",""==t.lng),e.R7$(),e.Y8G("ngIf",null==t?null:t.lng),e.R7$(2),e.JRh(t.salsePersonName),e.R7$(2),e.SpI(" ",e.i5U(24,21,t.acutalVisitDate,"yyyy-MM-dd HH:mm"),""),e.R7$(3),e.JRh(t.totalQuantity),e.R7$(),e.Y8G("ngIf",a.showInfo),e.R7$(2),e.Y8G("hasPermission",e.lJ4(24,wl)),e.R7$(),e.Y8G("hasPermission",e.lJ4(25,Ml))}}function Bl(r,s){if(1&r&&(e.qex(0),e.j41(1,"tr")(2,"td"),e.EFF(3),e.k0s(),e.j41(4,"td"),e.EFF(5),e.k0s(),e.j41(6,"td"),e.EFF(7),e.k0s(),e.j41(8,"td"),e.EFF(9),e.k0s()(),e.bVm()),2&r){const t=s.$implicit,n=s.index;e.R7$(3),e.JRh(n+1),e.R7$(2),e.JRh(t.itemName),e.R7$(2),e.JRh(t.unitName),e.R7$(2),e.JRh(t.approvedQuantity)}}function Xl(r,s){if(1&r&&(e.j41(0,"tr")(1,"td",87)(2,"div")(3,"table",88)(4,"thead")(5,"tr",89)(6,"th",90),e.EFF(7,"# "),e.k0s(),e.nrm(8,"th",91)(9,"th",92)(10,"th",93),e.k0s()(),e.j41(11,"tbody"),e.DNE(12,Bl,10,4,"ng-container",94),e.k0s()()()()()),2&r){const t=s.$implicit;e.R7$(12),e.Y8G("ngForOf",t.offerOrderDetails)}}function Al(r,s){1&r&&(e.j41(0,"div",95),e.EFF(1," general.table.noData "),e.k0s())}function ql(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",96)(1,"div",97),e.nrm(2,"ngb-pagination-info",98),e.j41(3,"table-length",99),e.bIt("lengthChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.ListItemChange(i))}),e.k0s()(),e.j41(4,"div",100)(5,"ngb-pagination",101),e.bIt("pageChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.pageChanged(i))}),e.mxI("pageChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.pagination.pageNumber,i)||(a.pagination.pageNumber=i),e.Njj(i)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function Yl(r,s){if(1&r){const t=e.RV6();e.j41(0,"delete-modal",102),e.bIt("deleteConfirm",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.DeleteConfirm())})("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}}function Ul(r,s){if(1&r){const t=e.RV6();e.j41(0,"app-all-orders-details",103),e.bIt("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderDetails",t.operationId)}}function zl(r,s){if(1&r){const t=e.RV6();e.j41(0,"sales-edit-order",104),e.bIt("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("isChangeQuantity",!0)("isDraft",!0)("orderSelected",t.operationId)}}function Ql(r,s){if(1&r){const t=e.RV6();e.j41(0,"sales-edit-order",104),e.bIt("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("isChangeQuantity",!0)("isDraft",!0)("orderSelected",t.operationId)}}function Hl(r,s){if(1&r){const t=e.RV6();e.j41(0,"client-summary",105),e.bIt("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("clientId",t.operationId)}}function Wl(r,s){if(1&r){const t=e.RV6();e.j41(0,"form",106,10),e.bIt("ngSubmit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.SubmitOrder())}),e.nrm(2,"ngx-ui-loader",107),e.j41(3,"div",108)(4,"div",109)(5,"button",110),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()(),e.j41(6,"div",111)(7,"div",112),e.nrm(8,"lord-icon",113),e.j41(9,"div",114),e.nrm(10,"h3",115)(11,"p",116),e.k0s()(),e.j41(12,"div",117),e.nrm(13,"button",118),e.j41(14,"button",119),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()()()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}function Jl(r,s){1&r&&(e.j41(0,"div",126),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function Zl(r,s){if(1&r){const t=e.RV6();e.j41(0,"form",106,10),e.bIt("ngSubmit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.RequestChangeQuantity())}),e.nrm(2,"ngx-ui-loader",107),e.j41(3,"div",108)(4,"div",109)(5,"button",110),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()(),e.j41(6,"div",111)(7,"div",120)(8,"label",121),e.EFF(9,"sales.salesOrder.changeQuantityMessage"),e.k0s(),e.j41(10,"textarea",122,11),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.changeQuantityMessage,i)||(a.form.changeQuantityMessage=i),e.Njj(i)}),e.k0s(),e.DNE(12,Jl,2,0,"div",123),e.k0s(),e.j41(13,"div",117),e.nrm(14,"button",124),e.j41(15,"button",125),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()()()()()}if(2&r){const t=e.sdS(1),n=e.sdS(11),i=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",i.loaderOperationShap)("loaderId",i.deleteLoader),e.R7$(8),e.R50("ngModel",i.form.changeQuantityMessage),e.R7$(2),e.Y8G("ngIf",n.invalid&&n.touched),e.R7$(2),e.Y8G("disabled",!t.valid)}}function Kl(r,s){if(1&r){const t=e.RV6();e.j41(0,"cancel-sales-model",127),e.bIt("success",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.reload())})("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderId",t.operationId)}}function ed(r,s){if(1&r){const t=e.RV6();e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td")(4,"ng-select",156),e.mxI("ngModelChange",function(i){const a=e.eBV(t).$implicit;return e.DH7(a.unitId,i)||(a.unitId=i),e.Njj(i)}),e.k0s()(),e.j41(5,"td")(6,"input",157),e.bIt("ngModelChange",function(i){const a=e.eBV(t).$index,o=e.XpG(2);return e.Njj(o.quantitySelect(i,a))}),e.mxI("ngModelChange",function(i){const a=e.eBV(t).$implicit;return e.DH7(a.quantity,i)||(a.quantity=i),e.Njj(i)}),e.k0s()()()}if(2&r){const t=s.$implicit,n=s.$index;e.R7$(2),e.SpI(" ",t.itemName," "),e.R7$(2),e.Y8G("name","unitId"+e.eq3(6,Je,n))("items",t.units),e.R50("ngModel",t.unitId),e.R7$(2),e.Y8G("name","quantity"+e.eq3(8,Je,n)),e.R50("ngModel",t.quantity)}}function td(r,s){if(1&r){const t=e.RV6();e.j41(0,"tr",158),e.nrm(1,"td",159),e.j41(2,"td",160)(3,"table",161)(4,"tbody")(5,"tr"),e.nrm(6,"td",162),e.j41(7,"td",163),e.EFF(8),e.nI1(9,"translate"),e.k0s()(),e.j41(10,"tr"),e.nrm(11,"td",164),e.j41(12,"td",163)(13,"div",165)(14,"ng-select",166),e.bIt("change",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.getTotal())}),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG(2);return e.DH7(a.form.totalAddDiscountType,i)||(a.form.totalAddDiscountType=i),e.Njj(i)}),e.k0s(),e.j41(15,"input",167),e.bIt("change",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.getTotal())}),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG(2);return e.DH7(a.form.totalAddDiscount,i)||(a.form.totalAddDiscount=i),e.Njj(i)}),e.k0s()()()(),e.j41(16,"tr",168),e.nrm(17,"td",169),e.j41(18,"td",163),e.EFF(19),e.nI1(20,"translate"),e.k0s()(),e.j41(21,"tr",170),e.nrm(22,"th",171),e.j41(23,"th",163),e.EFF(24),e.nI1(25,"translate"),e.k0s()()()()()()}if(2&r){const t=e.XpG(2);e.R7$(8),e.Lme("",t.form.total," ",e.bMT(9,9,"orderManagement.order.currancy"),""),e.R7$(6),e.Y8G("items",t.discountTypes),e.R50("ngModel",t.form.totalAddDiscountType),e.R7$(),e.R50("ngModel",t.form.totalAddDiscount),e.R7$(4),e.Lme("",t.form.tax," ",e.bMT(20,11,"orderManagement.order.currancy"),""),e.R7$(5),e.Lme("",t.form.totalNet," ",e.bMT(25,13,"orderManagement.order.currancy"),"")}}function id(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",128)(1,"div",129)(2,"h4",130),e.nrm(3,"span",131),e.k0s(),e.j41(4,"button",132),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss("Cross click"))}),e.k0s()(),e.j41(5,"div",111),e.nrm(6,"ngx-ui-loader",107),e.j41(7,"form",133,10),e.bIt("submit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.updateTruck())}),e.j41(9,"div",28)(10,"div",134)(11,"label",135),e.EFF(12,"sales.salesOrder.acutalDeliveryDate"),e.k0s(),e.j41(13,"input",136),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.dateChangeModal(i))}),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.acutalVisitDate,i)||(a.form.acutalVisitDate=i),e.Njj(i)}),e.k0s()(),e.j41(14,"div",134),e.nrm(15,"label",137),e.j41(16,"ng-select",138),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.clientLocationId,i)||(a.form.clientLocationId=i),e.Njj(i)}),e.k0s()(),e.j41(17,"div",139)(18,"label",135),e.EFF(19,"sales.salesOrder.truncks"),e.k0s(),e.j41(20,"ng-select",140),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.shippingTruckId,i)||(a.form.shippingTruckId=i),e.Njj(i)}),e.k0s()()(),e.j41(21,"div",141)(22,"div",14)(23,"div",142)(24,"div",143),e.nrm(25,"h5",144),e.k0s()(),e.j41(26,"div",44)(27,"div",145)(28,"table",146)(29,"thead",147)(30,"tr"),e.nrm(31,"th",148)(32,"th",149)(33,"th",150),e.k0s()(),e.j41(34,"tbody"),e.Z7z(35,ed,7,10,"tr",null,e.Vm6),e.DNE(37,td,26,15,"tr",151),e.k0s()()()()()(),e.j41(38,"div",152)(39,"button",153),e.nrm(40,"i",154)(41,"span",155),e.k0s()()()()()}if(2&r){const t=e.sdS(8),n=e.XpG();e.R7$(6),e.Y8G("hasProgressBar",!1)("fgsType",n.loaderOperationShap)("loaderId",n.operationLoader),e.R7$(7),e.R50("ngModel",n.form.acutalVisitDate),e.Y8G("altInput",!0)("enableTime",!0)("convertModelValue",!0)("dateFormat","d-m-Y H:i"),e.R7$(3),e.Y8G("disabled",!0)("items",n.locations),e.R50("ngModel",n.form.clientLocationId),e.R7$(4),e.Y8G("items",n.truncks),e.R50("ngModel",n.form.shippingTruckId),e.R7$(15),e.Dyx(n.form.details),e.R7$(2),e.Y8G("ngIf",!1),e.R7$(2),e.Y8G("disabled",!t.valid)}}let nd=(()=>{class r extends X.w{constructor(t,n,i,a,o,l,h,x,y,I,j,T,b,C,O,F){super(t,n,h,i,a,o,l),this.baseService=i,this.authDaamService=x,this.teamService=y,this.employeeService=I,this.regionService=j,this.cityService=T,this.storesService=b,this.excelService=C,this.router=O,this.orderReceivedService=F,this.title="sales.salesOrderStore.title",this.titleOperation="sales.salesOrderStore.titleOperation",this.keySelected="",this.searchForm={},this.isResolveList=!0,this.employeeGroups=[],this.activeindex="2",this.active=2,this.clientSelected=0,this.status=[],this.countLoad=2,this.isOrderEdit=!1,this.orderSelected={},this.users=[],this.statusCount={},this.salesPersons=[],this.regions=[],this.cities=[],this.count={},this.truncks=[],this.locations=[],this.discountTypes=[],this.pagination={pageNumber:1,pageSize:10,status:30},this.showInfo=!1,this.stores=[],this.setDates=(k,$,L)=>{if(k?.from||k?.to){const se=k.to||k.from;this.pagination[$]=this.datePipe.transform(k.from||k.to,"yyyy-MM-ddT00:00:00"),this.pagination[L]=this.datePipe.transform(se,"yyyy-MM-ddT23:59:59.999")}else this.pagination[$]=null,this.pagination[L]=null},this.configRoute(),this.GetSalesPersons(),this.GetRegions(),this.GetCities(),this.GetStores(),this.GetOfferOrderCount()}GetOfferOrderCount(){this.baseService.GetOfferOrderStoreCount().subscribe(t=>{this.count=t.data})}GetRegions(){this.regionService.getDropDown().subscribe(t=>{this.regions=t.data},t=>{console.log(t)})}GetStores(){this.storesService.getDropDown().subscribe(t=>{this.stores=t.data},t=>{console.log(t)})}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetSalesPersons(){this.employeeService.GetAllByType(9).subscribe(t=>{this.salesPersons=t.data},t=>{console.log(t)})}ngOnInitMore(){this.discountTypes=this.baseService.discountTypes,this.discountTypes.forEach(t=>{t.name=this.getTranslationText("sales.salesOrder."+t.name)})}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,m.Q)(this.notifier)).subscribe(n=>{n?this.alertService.success():this.alertService.error("general.message."+n)},n=>{this.alertService.error()})}mapRegisterForm(t){let n={...t};return n.employeeCode=0,n}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader("allLoader"),this.setDates(t.dates,"visitDateFrom","visitDateTo"),this.setDates(t.creationDates,"creationTimeFrom","creationTimeTo"),this.loadentities()}LoadSuccess(){this.ngxLoader.stopLoader("allLoader")}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems},this.loadentities()}configRoute(){this.routerActive.data.pipe((0,m.Q)(this.notifier)).subscribe(t=>{this.entities=t.data,this.pagination.totalItems=t.data?.totalItems},()=>{this.alertService.error()})}mapExcel(){let t=[];return this.entities.forEach(n=>{t.push({Code:n.id,CreatorName:n.creatorName,creationTime:n.creationTime,clientName:n.clientName,Status:this.getTranslationText("sales.salesOrder."+n.offerOrderStatusValue),salse_Person:n.salsePersonName,"Delivery.Date":n.acutalVisitDate,"T.Quantity":n.totalQuantity," T.Discount":n.totalDiscount,Tax:n.totalTax,Net:n.netPrice,Reason:n.cancelReasonName})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}getStatus(t){return 10==t.offerOrderStatus||5==t.offerOrderStatus?"bg-warning":20==t.offerOrderStatus?"bg-secondary ":30==t.offerOrderStatus?"bg-info":60==t.offerOrderStatus?"bg-success":40==t.offerOrderStatus?"bg-danger":50==t.offerOrderStatus?"bg-info":"bg-warning"}checkEdit(t){return!t.isCancel&&!t.isFinish}openModalClient(t,n,i="xl"){this.clientSelected=t.orderCode,this.orderSelected=t,this.isOrderEdit=!1,this.modalService.open(n,{centered:!0,size:i})}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}goNew(){this.router.navigateByUrl("/sales/new")}onSelectStatus(t){this.showInfo=!1,-1==t?this.pagination.status=null:0==t?(this.pagination.statusList=[30,40,32,50,60,100],this.pagination.status=null,this.showInfo=!0):(this.pagination.statusList=[],this.pagination.status=t),this.onSearch()}openStatusModal(t,n,i,a="md"){this.isEditForm=!1,this.form={},this.form={id:t,status:i},this.modalService.open(n,{centered:!0,size:a})}SubmitOrder(){this.ngxLoader.startLoader(u.Fq),this.baseService.changStatus({id:this.form.id,status:this.form.status}).pipe((0,v.O)(),(0,R.c)(this.mainDelay),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader(u.Fq))).subscribe({next:n=>{this.modalService.dismissAll(),this.reload(),this.alertService.success()}})}cancelOrder(){this.ngxLoader.startLoader(u.Fq),console.log(this.operationId),this.baseService.changStatus({id:this.operationId,status:40}).pipe((0,v.O)(),(0,R.c)(this.mainDelay),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader(u.Fq))).subscribe({next:n=>{this.modalService.dismissAll(),this.reload(),this.alertService.success()}})}RequestChangeQuantity(){this.ngxLoader.startLoader(u.Fq),console.log(this.operationId),this.baseService.RequestChangeQuantity({id:this.operationId,changeQuantityMessage:this.form.changeQuantityMessage}).pipe((0,v.O)(),(0,R.c)(this.mainDelay),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader(u.Fq))).subscribe({next:n=>{this.modalService.dismissAll(),this.reload(),this.alertService.success()}})}reload(){this.modalService.dismissAll(),this.GetOfferOrderCount(),this.loadentities()}formatDate(t){if(!t)return"";const n=new Date(t);return n.getDate().toString().padStart(2,"0")+"-"+(n.getMonth()+1).toString().padStart(2,"0")+"-"+n.getFullYear()+" "+n.getHours().toString().padStart(2,"0")+":"+n.getMinutes().toString().padStart(2,"0")}openShippingModal(t,n,i="md"){this.baseService.GetTrucks({id:t,acutalVisitDate:null}).subscribe(o=>{o.success?(this.form=o.data.order,this.getTotal(),this.form.clientVisitDate=this.formatDate(this.form.clientVisitDate),this.form.acutalVisitDate=this.formatDate(this.form.acutalVisitDate),this.truncks=o.data.truncks,this.locations=o.data.locations,this.modalService.open(n,{centered:!0,size:i})):this.alertService.error("general.message."+o.message)},o=>{this.alertService.error("general.message."+o)})}getTotal(){let t=0,n=0,i=0;this.form.details.forEach(a=>{a.discount<0&&(a.discoun=0);let o=a.quantity*a.price,l=0;1===a.discountType?l=a.discount:2===a.discountType&&(l=o*a.discount/100),n=+l;let h=o-l;a.net=h,t=+h}),1===this.form.totalAddDiscountType?i=this.form.totalAddDiscount:2===this.form.totalAddDiscountType&&(i=t*this.form.totalAddDiscount/100),this.form.total=t,this.form.totalAddDiscount=this.form.totalAddDiscount,this.form.tax=15*this.form.total/100,this.form.totalNet=this.form.total-i+this.form.tax}updateTruck(){this.form.acutalVisitDate=new Date(this.convertToISO(this.form.acutalVisitDate));let t={shippingTruckId:this.form.shippingTruckId,clientLocationId:this.form.clientLocationId,offerOrderMasterId:this.form.id,Notes:this.form.notes,terms:this.form.terms,deliveryDate:this.datePipe.transform(this.form.acutalVisitDate,"yyyy-MM-ddTHH:mm:00.000"),details:this.form.details.map(n=>({id:0,itemId:n.itemId,itemName:n.itemName,quantity:n.quantity,unitId:n.unitId,price:n.price,isFree:n.isFree,originalPrice:n.originalPrice,discount:n.discount,discountType:n.discountType,clientQuantity:n.clientQuantity,approvedQuantity:n.approvedQuantity}))};this.ngxLoader.startLoader(this.operationLoader),this.orderReceivedService.register(t).pipe((0,v.O)(),(0,R.c)(this.mainDelay),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(n=>{n.success?this.reload():this.alertService.error("general.message."+n.message)},n=>{this.alertService.error("general.message."+n)})}convertToISO(t){if(t instanceof Date)return t.toISOString();if("string"==typeof t){const[n,i,a,o,l]=t.split(/[-\s:]/);return`${a}-${i}-${n}T${o}:${l}:00`}}dateChangeModal(t){t=new Date(t);let n={id:this.form.id,acutalVisitDate:this.datePipe.transform(t,"yyyy-MM-ddT00:00:00.000")};this.baseService.GetTrucks(n).subscribe(i=>{i.success?this.truncks=i.data.truncks:this.alertService.error("general.message."+i.message)},i=>{this.alertService.error("general.message."+i)})}quantitySelect(t,n){t&&(t<=0&&(t=1),this.form.details[n].quantity=parseInt(t),this.form.details[n].net=this.form.details[n].price*this.form.details[n].quantity,this.discountSelect(this.form.details[n].discount,n),this.getTotal())}discountSelect(t,n,i=1){if(t){(t=parseInt(t))<=0&&(this.form.details[n].discount=0),1==i&&(this.form.details[n].discount=t);let a=0;1==this.form.details[n].discountType?a=this.form.details[n].discount:(a=this.form.details[n].price*this.form.details[n].quantity*this.form.details[n].discount/100,a=+a.toFixed(2)),this.form.details[n].net=this.form.details[n].price*this.form.details[n].quantity-a,this.form.details[n].net=this.form.details[n].net.toFixed(2),this.getTotal()}}PrintOrderReceived(t){this.ngxLoader.startLoader("allLoader"),this.orderReceivedService.PrintOrderReceived(t).pipe((0,v.O)(),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader("allLoader"))).subscribe(n=>{this.openUrl(n)},n=>{this.alertService.error("general.message."+n)})}openUrl(t){let n=new Blob([t],{type:t.type});var i=URL.createObjectURL(n);window.open(i,"_blank")}mapUrl(t,n){return null===t||null==n?"":`https://www.google.com/maps/dir//${n},${t}/@${n},${t},17z?hl=en-US`}loadentities(){this.baseService.GetOrderStore(this.pagination).pipe((0,m.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader(u.a7),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader(u.a7),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[]}PrintStoreReport(t){this.ngxLoader.startLoader("allLoader"),this.baseService.PrintStoreReport(t).pipe((0,v.O)(),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader("allLoader"))).subscribe(n=>{this.openUrl(n)},n=>{this.alertService.error()})}static{this.\u0275fac=function(n){return new(n||r)(e.rXU(M.nX),e.rXU(g.c$),e.rXU(U.A),e.rXU(E.u),e.rXU(p.vh),e.rXU(w.eD),e.rXU(_.Bq),e.rXU(fe.J),e.rXU(Me.n),e.rXU(K.O),e.rXU(Ie.S),e.rXU(le.h),e.rXU(Oe.a),e.rXU(H.V),e.rXU(M.Ix),e.rXU(he.B))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-salesman-order"]],features:[e.Vt3],decls:104,vars:68,consts:[["tableMaster",""],["deleteModal",""],["orderViewModel",""],["SalesEditModel",""],["SalesChangeModel",""],["ClientInfo",""],["StatusOrderModal",""],["SubmitChangeQuantityModal",""],["cancelModal",""],["SubmitOrderModal",""],["formEntity","ngForm"],["changeQuantityMessage","ngModel"],[1,"row","justify-content-center"],[1,"col-sm-12","col-md-3","cursor-pointer",3,"click"],[1,"card"],[1,"card-body","d-flex","gap-3","align-items-center"],[1,"avatar-sm"],[1,"avatar-title","bg-warning","border","border-opacity-25","rounded-2","fs-17"],[1,"ri-shopping-cart-2-fill"],[1,"flex-grow-1"],[1,"fs-15"],["translate","sales.salesOrderStore.deliveries",1,"mb-0","text-muted"],[1,"avatar-title","border","bg-success","border-opacity-25","rounded-2","fs-17"],["translate","sales.salesOrderStore.ready",1,"mb-0","text-muted"],[1,"avatar-title","border","bg-danger","border-opacity-25","rounded-2","fs-17"],["translate","sales.salesOrderStore.return",1,"mb-0","text-muted"],[1,"avatar-title","border","bg-primary","border-opacity-25","rounded-2","fs-17"],["translate","sales.salesOrderStore.history",1,"mb-0","text-muted"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"addNew","reset","search","exportXlsx","addPermission","showAdd","showExport","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","id","name","id",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],["InputTirmFilter","","type","search","id","clientName","name","clientName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["name","regionId","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],["name","cityId","bindValue","code","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],["name","storeId","bindValue","id","bindLabel","nameAR",3,"ngModelChange","items","multiple","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],[2,"width",".2%"],["translate","",2,"width",".5%"],["pSortableColumn","id","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["pSortableColumn","creationTime","translate","",2,"width","10%"],["pSortableColumn","status","translate","",2,"width","6%"],["pSortableColumn","clientId","translate","",2,"width","15%"],["translate","",2,"width","3%"],["translate","",2,"width","8%"],["pSortableColumn","clientVisitDate","translate","",2,"width","10%"],["pSortableColumn","totalQuantity","translate","",2,"width","8%"],["style","width:12%","translate","",4,"ngIf"],["translate","",2,"width","12%"],[1,"fs-5"],["type","button","pRipple","",1,"border-0","p-button-text","p-button-rounded","p-button-plain",3,"pRowToggler","ngClass"],[1,"code-pointer"],[3,"translate"],[3,"click"],["href","javascript:void(0)",1,"link-primary","link-offset-2","text-decoration-underline","link-underline-opacity-25","link-underline-opacity-100-hover"],["class","badge bg-danger-subtle text-danger mx-1","translate","orderManagement.order.noMap",4,"ngIf"],["target","_blank","class","badge bg-success-subtle text-success mx-1","translate","orderManagement.order.viewMap",3,"href",4,"ngIf"],[4,"ngIf"],[4,"hasPermission"],["translate","orderManagement.order.noMap",1,"badge","bg-danger-subtle","text-danger","mx-1"],["target","_blank","translate","orderManagement.order.viewMap",1,"badge","bg-success-subtle","text-success","mx-1",3,"href"],[1,"ri-map-pin-line"],[1,"badge","bg-primary"],["class","btn btn-sm btn-primary edit-list mx-1","tooltipPosition","top",3,"pTooltip","click",4,"ngIf"],["tooltipPosition","top",1,"btn","btn-sm","btn-primary","edit-list","mx-1",3,"click","pTooltip"],[1,"ri-truck-line","align-bottom"],["class","btn btn-sm btn-warning edit-list mx-1","tooltipPosition","top",3,"pTooltip","click",4,"ngIf"],["tooltipPosition","top",1,"btn","btn-sm","btn-warning","edit-list","mx-1",3,"click","pTooltip"],[1,"ri-send-plane-fill","align-bottom"],[1,"ri-printer-fill","align-bottom"],["colspan","17"],["dataKey","id"],[1,"bg-light"],[2,"width","8%"],["translate","sales.salesOrder.itemName",2,"width","20%"],["translate","sales.salesOrder.unit",2,"width","6%"],["translate","sales.salesOrder.approvedQuantity",2,"width","8%"],[4,"ngFor","ngForOf"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"deleteConfirm","dismiss"],[3,"dismiss","orderDetails"],[3,"dismiss","isChangeQuantity","isDraft","orderSelected"],[3,"dismiss","clientId"],[3,"ngSubmit"],[3,"hasProgressBar","fgsType","loaderId"],[1,"modal-content"],[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mt-2","text-center"],["src","https://cdn.lordicon.com/gdfrsvpt.json","stroke","bold","state","hover-oscillate","trigger","loop","colors","primary:#f7b84b,secondary:#f06548",2,"width","130px","height","130px"],[1,"pt-2","fs-15","mx-4","mx-sm-5"],["translate","orderManagement.order.AreYouSureMessage"],[1,"text-muted","mx-4","mb-0"],[1,"d-flex","gap-2","justify-content-center","mt-4","mb-2"],["type","submit","id","save","translate","general.action.send",1,"btn","w-sm","btn-danger","fs-4"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light","fs-4",3,"click"],[1,"mb-2"],["for","changeQuantityMessage","translate","",1,"required","text-bold","form-label"],["rows","5","InputTirmFilter","","name","changeQuantityMessage","type","text","id","changeQuantityMessage",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["class","text-danger text-center  ","translate","",4,"ngIf"],["t","","type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger",3,"disabled"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],["translate","",1,"text-danger","text-center"],[3,"success","dismiss","orderId"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["translate","sales.salesOrder.truckUpdate"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[3,"submit"],[1,"col-12","col-md-3"],["for","name","translate","",1,"required","fw-bold","form-label"],["name","acutalVisitDate","type","text","mwlFlatpickr","","altFormat","d-m-Y H:i","required","",1,"form-control","flatpickr-input",3,"ngModelChange","ngModel","altInput","enableTime","convertModelValue","dateFormat"],["for","name","translate","orderManagement.order.savedAddress",1,"required","fw-bold","form-label"],["name","clientLocationId","bindValue","id","bindLabel","name","required","",2,"width","100%",3,"ngModelChange","disabled","items","ngModel"],[1,"col-12","col-md-6"],["name","shippingTruckId","bindValue","id","bindLabel","name","required","",2,"width","100%",3,"ngModelChange","items","ngModel"],[1,"row","justify-content-center","my-0"],[1,"card-header","p-0"],[1,"d-flex","align-items-center"],["translate","sales.salesRequests.items",1,"card-title","flex-grow-1","mb-0"],[1,"table-responsive","table-card",2,"overflow","visible"],[1,"table","table-nowrap","align-middle","table-borderless","mb-0"],[1,"table-light","text-muted","p-1"],["translate","sales.salesRequests.itemName",2,"width","20%"],["translate","sales.salesRequests.unit",2,"width","25%"],["translate","sales.salesRequests.quantity",2,"width","25%"],["class","border-top border-top-dashed",4,"ngIf"],[1,"d-flex","justify-content-center","m-0"],["type","submit","type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],["clearable","false","clearOnBackspace","false","bindValue","id","bindLabel","name",2,"width","100%",3,"ngModelChange","name","items","ngModel"],["type","text","id","quantity",1,"form-control","fs-6",3,"ngModelChange","name","ngModel"],[1,"border-top","border-top-dashed"],["colspan","3"],["colspan","4",1,"fw-medium","p-0"],[1,"table","table-borderless","mb-0"],["translate","sales.salesOrder.total",1,"m-0","p-0"],[1,"text-end","m-0","p-0"],["translate","sales.salesOrder.extraDiscount",1,"m-0","p-0"],[1,"input-group","mx-4",2,"width","80%"],["clearable","false","clearOnBackspace","false","name","totalAddDiscountType","bindValue","id","bindLabel","name",3,"change","ngModelChange","items","ngModel"],["InputTirmFilter","","name","totalAddDiscount","type","text","id","totalAddDiscount",1,"form-control","fs-6",2,"width","30%",3,"change","ngModelChange","ngModel"],[1,"m-0","p-0"],["translate","sales.salesOrder.tax",1,"m-0","p-0"],[1,"border-top","border-top-dashed","m-0","p-0"],["scope","row","translate","sales.salesOrder.net",1,"m-0","p-0"]],template:function(n,i){if(1&n){const a=e.RV6();e.j41(0,"div",12)(1,"div",13),e.bIt("click",function(){return e.eBV(a),e.Njj(i.onSelectStatus(30))}),e.j41(2,"div",14)(3,"div",15)(4,"div",16)(5,"div",17),e.nrm(6,"i",18),e.k0s()(),e.j41(7,"div",19)(8,"h5",20),e.EFF(9),e.k0s(),e.nrm(10,"p",21),e.k0s()()()(),e.j41(11,"div",13),e.bIt("click",function(){return e.eBV(a),e.Njj(i.onSelectStatus(32))}),e.j41(12,"div",14)(13,"div",15)(14,"div",16)(15,"div",22),e.nrm(16,"i",18),e.k0s()(),e.j41(17,"div",19)(18,"h5",20),e.EFF(19),e.k0s(),e.nrm(20,"p",23),e.k0s()()()(),e.j41(21,"div",13),e.bIt("click",function(){return e.eBV(a),e.Njj(i.onSelectStatus(100))}),e.j41(22,"div",14)(23,"div",15)(24,"div",16)(25,"div",24),e.nrm(26,"i",18),e.k0s()(),e.j41(27,"div",19)(28,"h5",20),e.EFF(29),e.k0s(),e.nrm(30,"p",25),e.k0s()()()(),e.j41(31,"div",13),e.bIt("click",function(){return e.eBV(a),e.Njj(i.onSelectStatus(0))}),e.j41(32,"div",14)(33,"div",15)(34,"div",16)(35,"div",26),e.nrm(36,"i",18),e.k0s()(),e.j41(37,"div",19),e.nrm(38,"p",27),e.k0s()()()()(),e.j41(39,"div",28)(40,"div",29)(41,"div",30),e.nrm(42,"ngx-ui-loader",31),e.j41(43,"base-filter",32),e.bIt("addNew",function(){return e.eBV(a),e.Njj(i.goNew())})("reset",function(){return e.eBV(a),e.Njj(i.onReset())})("search",function(){return e.eBV(a),e.Njj(i.onSearch())})("exportXlsx",function(){return e.eBV(a),e.Njj(i.onExportXlsx())}),e.qex(44,33),e.j41(45,"div",34)(46,"div",35)(47,"input",36),e.nI1(48,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.id,l)||(i.pagination.id=l),e.Njj(l)}),e.k0s(),e.nrm(49,"i",37),e.k0s()(),e.j41(50,"div",34)(51,"input",38),e.nI1(52,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.searchForm.creationDates,l)||(i.searchForm.creationDates=l),e.Njj(l)}),e.k0s()(),e.j41(53,"div",34)(54,"div",35)(55,"input",39),e.nI1(56,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.clientName,l)||(i.pagination.clientName=l),e.Njj(l)}),e.k0s(),e.nrm(57,"i",37),e.k0s()(),e.j41(58,"div",34)(59,"div",35)(60,"ng-select",40),e.nI1(61,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.salesPersonId,l)||(i.pagination.salesPersonId=l),e.Njj(l)}),e.k0s()()(),e.j41(62,"div",34)(63,"input",38),e.nI1(64,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.searchForm.dates,l)||(i.searchForm.dates=l),e.Njj(l)}),e.k0s()(),e.j41(65,"div",34)(66,"div",35)(67,"ng-select",41),e.nI1(68,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.regionId,l)||(i.pagination.regionId=l),e.Njj(l)}),e.k0s()()(),e.j41(69,"div",34)(70,"div",35)(71,"ng-select",42),e.nI1(72,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.cityId,l)||(i.pagination.cityId=l),e.Njj(l)}),e.k0s()()(),e.j41(73,"div",34)(74,"div",35)(75,"ng-select",43),e.nI1(76,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.storeId,l)||(i.pagination.storeId=l),e.Njj(l)}),e.k0s()()(),e.bVm(),e.k0s(),e.j41(77,"div",44)(78,"div",45)(79,"p-table",46,0),e.bIt("onLazyLoad",function(l){return e.eBV(a),e.Njj(i.tableChange(l))})("selectionChange",function(l){return e.eBV(a),e.Njj(i.onSelectionChange(l))}),e.DNE(81,Rl,27,1,"ng-template",47)(82,$l,31,26,"ng-template",48)(83,Xl,13,1,"ng-template",49),e.k0s()(),e.DNE(84,Al,2,0,"div",50)(85,ql,6,8,"div",51),e.k0s()()()(),e.DNE(86,Yl,1,0,"ng-template",null,1,e.C5r)(88,Ul,1,1,"ng-template",null,2,e.C5r)(90,zl,1,3,"ng-template",null,3,e.C5r)(92,Ql,1,3,"ng-template",null,4,e.C5r)(94,Hl,1,1,"ng-template",null,5,e.C5r)(96,Wl,15,3,"ng-template",null,6,e.C5r)(98,Zl,16,6,"ng-template",null,7,e.C5r)(100,Kl,1,1,"ng-template",null,8,e.C5r)(102,id,42,15,"ng-template",null,9,e.C5r)}2&n&&(e.R7$(2),e.AVh("bg-primary-subtle",30==i.pagination.status),e.R7$(7),e.JRh(i.count.storeDeliveryOrder),e.R7$(3),e.AVh("bg-primary-subtle",32==i.pagination.status),e.R7$(7),e.JRh(i.count.repareOrder),e.R7$(3),e.AVh("bg-primary-subtle",100==i.pagination.status),e.R7$(7),e.JRh(i.count.return),e.R7$(3),e.AVh("bg-primary-subtle",0==i.pagination.status),e.R7$(10),e.Y8G("loaderId","allLoader"),e.R7$(),e.Y8G("addPermission",e.lJ4(67,kl))("showAdd",!1)("showExport",!1)("totalItems",i.pagination.totalItems)("title",i.title),e.R7$(4),e.FS9("placeholder",e.bMT(48,51,"orderManagement.order.orderCode")),e.R50("ngModel",i.pagination.id),e.R7$(4),e.FS9("placeholder",e.bMT(52,53,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",i.searchForm.creationDates),e.R7$(4),e.FS9("placeholder",e.bMT(56,55,"orderManagement.order.agentName")),e.R50("ngModel",i.pagination.clientName),e.R7$(5),e.FS9("placeholder",e.bMT(61,57,"sales.salesOrder.salsePerson")),e.Y8G("items",i.salesPersons)("multiple",!1),e.R50("ngModel",i.pagination.salesPersonId),e.R7$(3),e.FS9("placeholder",e.bMT(64,59,"sales.salesOrder.clientVisitDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",i.searchForm.dates),e.R7$(4),e.FS9("placeholder",e.bMT(68,61,"client.client.regionName")),e.Y8G("items",i.regions)("multiple",!1),e.R50("ngModel",i.pagination.regionId),e.R7$(4),e.FS9("placeholder",e.bMT(72,63,"client.client.cityName")),e.Y8G("items",i.cities)("multiple",!1),e.R50("ngModel",i.pagination.cityId),e.R7$(4),e.FS9("placeholder",e.bMT(76,65,"sales.salesOrder.storeName")),e.Y8G("items",i.stores)("multiple",!1),e.R50("ngModel",i.pagination.storeId),e.R7$(4),e.Y8G("value",i.entities)("rows",i.pagination.pageSize)("lazy",!0)("totalRecords",i.pagination.totalItems),e.R7$(5),e.Y8G("ngIf",i.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",i.pagination.totalItems>0))},dependencies:[p.YU,p.Sq,p.bT,d.qT,d.me,d.Q0,d.BC,d.cb,d.YS,d.vS,d.cV,_.s5,G.kL,W.b,z.w,J.p,Z.g,ce.x,g.Mm,V.XI,q.Ei,V.Tg,V.FP,w.Cv,P.vr,B.m,A.p,de.m,Re,Fe,p.vh,g.D9],encapsulation:2})}}return r})(),rd=(()=>{class r{constructor(t){this.router=t}ngOnInit(){}goMangeVisit(){this.router.navigate(["/sales/mange"])}static{this.\u0275fac=function(n){return new(n||r)(e.rXU(M.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-VisitDetails"]],decls:57,vars:0,consts:[[1,"container","py-4"],["href","#",1,"text-muted","mb-3","d-inline-block"],[1,"d-flex","justify-content-between","align-items-center"],[1,"fw-bold","mb-0"],[1,"badge","bg-light","text-dark","border","border-dark","ms-2"],["translate","sales.visitDetails.startVisit",1,"btn","btn-dark","me-2"],["translate","sales.visitDetails.manageVisits",1,"btn","btn-outline-dark",3,"click"],[1,"text-muted","mb-4"],[1,"row","bg-light","p-3","rounded"],[1,"col-md-6","mb-2"],[1,"bi","bi-geo-alt-fill","me-1"],[1,"col-md-6"],[1,"bi","bi-telephone-fill","me-1"],[1,"bi","bi-envelope-fill","me-1"],[1,"bi","bi-calendar-event-fill","me-1"],[1,"text-danger","fs-6","ms-1"],["role","tablist",1,"nav","nav-tabs","my-4"],[1,"nav-item"],["data-bs-toggle","tab","href","#history","translate","sales.visitDetails.visitHistory",1,"nav-link","active"],["data-bs-toggle","tab","href","#notes","translate","sales.visitDetails.notes",1,"nav-link"],[1,"tab-content"],["id","history",1,"tab-pane","fade","show","active"],[1,"card","shadow-sm","border-0","mb-3"],[1,"card-body"],[1,"d-flex","justify-content-between","align-items-center","mb-2"],[1,"bi","bi-calendar-event","me-1"],["translate","sales.visitDetails.missed",1,"badge","bg-danger","ms-2"],["translate","sales.visitDetails.viewDetails",1,"btn","btn-outline-secondary","btn-sm"],[1,"bi","bi-arrow-right"],[1,"mb-2"],[1,"bi","bi-clock","me-1"],["translate","sales.visitDetails.collection",1,"badge","bg-light","text-dark","border"],[1,"mt-2","mb-0","text-muted"],["id","notes",1,"tab-pane","fade"],["translate","sales.visitDetails.noNotesaAvailable",1,"text-muted"]],template:function(n,i){1&n&&(e.j41(0,"div",0)(1,"a",1),e.EFF(2,"\u2190 Back"),e.k0s(),e.j41(3,"div",2)(4,"h3",3),e.EFF(5," TechStart Inc. "),e.j41(6,"span",4),e.EFF(7,"TSI-002"),e.k0s()(),e.j41(8,"div"),e.nrm(9,"button",5),e.j41(10,"button",6),e.bIt("click",function(){return i.goMangeVisit()}),e.k0s()()(),e.j41(11,"p",7),e.EFF(12,"Biweekly visits"),e.k0s(),e.j41(13,"div",8)(14,"div",9),e.nrm(15,"i",10),e.EFF(16," 456 Innovation Blvd, Tech Valley, CA 94107 "),e.nrm(17,"br"),e.EFF(18," Contact: Sarah Johnson "),e.k0s(),e.j41(19,"div",11)(20,"div"),e.nrm(21,"i",12),e.EFF(22," (555) 987-6543"),e.k0s(),e.j41(23,"div"),e.nrm(24,"i",13),e.EFF(25," Taefik gmail.com"),e.k0s(),e.j41(26,"div"),e.nrm(27,"i",14),e.EFF(28," Last visit: 5/7/2025 "),e.j41(29,"span",15),e.EFF(30,"\u25cf"),e.k0s()()()(),e.j41(31,"ul",16)(32,"li",17),e.nrm(33,"a",18),e.k0s(),e.j41(34,"li",17),e.nrm(35,"a",19),e.k0s()(),e.j41(36,"div",20)(37,"div",21)(38,"div",22)(39,"div",23)(40,"div",24)(41,"div"),e.nrm(42,"i",25),e.j41(43,"strong"),e.EFF(44,"Wednesday, May 7, 2025"),e.k0s(),e.nrm(45,"span",26),e.k0s(),e.j41(46,"div")(47,"button",27),e.nrm(48,"i",28),e.k0s()()(),e.j41(49,"div",29),e.nrm(50,"i",30),e.EFF(51," 08:10 PM "),e.k0s(),e.nrm(52,"span",31),e.j41(53,"p",32),e.EFF(54,"Store was closed due to unexpected maintenance."),e.k0s()()()(),e.j41(55,"div",33),e.nrm(56,"p",34),e.k0s()()())},dependencies:[g.Mm]})}}return r})();function ad(r,s){1&r&&(e.j41(0,"div",58),e.EFF(1," This field is required "),e.k0s())}function sd(r,s){1&r&&(e.j41(0,"div",58),e.EFF(1," This field is required "),e.k0s())}function od(r,s){1&r&&(e.j41(0,"div",58),e.EFF(1," This field is required "),e.k0s())}function ld(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",28)(1,"div",29),e.nrm(2,"h4",30),e.j41(3,"button",31),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss("Cross click"))}),e.k0s()(),e.j41(4,"div",32)(5,"form",33,2),e.bIt("ngSubmit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.OnSubmit())}),e.j41(7,"div",34)(8,"label",35),e.EFF(9,"Acme Corporation"),e.k0s(),e.nrm(10,"input",36),e.k0s(),e.j41(11,"div",34),e.nrm(12,"label",37),e.j41(13,"select",38,3),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.reason,i)||(a.form.reason=i),e.Njj(i)}),e.nrm(15,"option",39)(16,"option",40)(17,"option",41)(18,"option",42)(19,"option",43)(20,"option",44)(21,"option",45),e.k0s(),e.DNE(22,ad,2,0,"div",46),e.k0s(),e.j41(23,"div",47)(24,"div",48),e.nrm(25,"label",49),e.j41(26,"input",50,4),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.newDate,i)||(a.form.newDate=i),e.Njj(i)}),e.k0s(),e.DNE(28,sd,2,0,"div",46),e.k0s(),e.j41(29,"div",48),e.nrm(30,"label",51),e.j41(31,"input",52,5),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.newTime,i)||(a.form.newTime=i),e.Njj(i)}),e.k0s(),e.DNE(33,od,2,0,"div",46),e.k0s()(),e.j41(34,"div",34),e.nrm(35,"label",53),e.j41(36,"textarea",54),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.notes,i)||(a.form.notes=i),e.Njj(i)}),e.k0s()(),e.j41(37,"div",55),e.nrm(38,"button",56),e.j41(39,"button",57),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss("Cancel"))}),e.k0s()()()()()}if(2&r){const t=e.sdS(6),n=e.sdS(14),i=e.sdS(27),a=e.sdS(32),o=e.XpG();e.R7$(10),e.Y8G("value",o.originalVisit),e.R7$(3),e.R50("ngModel",o.form.reason),e.R7$(9),e.Y8G("ngIf",n.invalid&&n.touched),e.R7$(4),e.R50("ngModel",o.form.newDate),e.R7$(2),e.Y8G("ngIf",i.invalid&&i.touched),e.R7$(3),e.R50("ngModel",o.form.newTime),e.R7$(2),e.Y8G("ngIf",a.invalid&&a.touched),e.R7$(3),e.R50("ngModel",o.form.notes),e.R7$(2),e.Y8G("disabled",!t.valid)}}function dd(r,s){1&r&&(e.j41(0,"div",58),e.EFF(1," This field is required "),e.k0s())}function cd(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",28)(1,"div",29),e.nrm(2,"h4",59),e.j41(3,"button",31),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss("Cross click"))}),e.k0s()(),e.j41(4,"div",32)(5,"form",33,6),e.bIt("ngSubmit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.OnCancel())}),e.j41(7,"div",34)(8,"label",35),e.EFF(9,"Acme Corporation"),e.k0s(),e.nrm(10,"input",36),e.k0s(),e.j41(11,"div",34),e.nrm(12,"label",60),e.j41(13,"select",61,7),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.cancelReason,i)||(a.form.cancelReason=i),e.Njj(i)}),e.nrm(15,"option",62)(16,"option",63)(17,"option",64)(18,"option",65)(19,"option",66)(20,"option",67),e.j41(21,"option",68),e.EFF(22,"Other"),e.k0s()(),e.DNE(23,dd,2,0,"div",46),e.k0s(),e.j41(24,"div",34),e.nrm(25,"label",53),e.j41(26,"textarea",69),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.cancelNotes,i)||(a.form.cancelNotes=i),e.Njj(i)}),e.k0s()(),e.j41(27,"div",55),e.nrm(28,"button",70),e.j41(29,"button",57),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss("Cancel"))}),e.k0s()()()()()}if(2&r){const t=e.sdS(6),n=e.sdS(14),i=e.XpG();e.R7$(10),e.Y8G("value",i.originalVisit),e.R7$(3),e.R50("ngModel",i.form.cancelReason),e.R7$(10),e.Y8G("ngIf",n.invalid&&n.touched),e.R7$(3),e.R50("ngModel",i.form.cancelNotes),e.R7$(2),e.Y8G("disabled",!t.valid)}}let md=(()=>{class r{constructor(t){this.modalService=t,this.form={},this.originalVisit="Originally scheduled for Friday, May 9, 2025 at 08:15 PM"}ngOnInit(){}openModalTitle(t,n="md"){this.form={},this.modalService.open(t,{centered:!0,size:n})}OnSubmit(){console.log("Reschedule submitted:",this.form),this.modalService.dismissAll()}OnCancel(){console.log("Cancel submitted:",this.form),this.modalService.dismissAll()}static{this.\u0275fac=function(n){return new(n||r)(e.rXU(_.Bq))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-Mangevisits"]],decls:30,vars:0,consts:[["operation",""],["cancelOperation",""],["formEntity","ngForm"],["reason","ngModel"],["newDate","ngModel"],["newTime","ngModel"],["cancelForm","ngForm"],["cancelReason","ngModel"],[1,"container","py-5",2,"background-color","#f8f9fa","min-height","100vh"],[1,"mb-4","d-flex","align-items-center"],["href","#",1,"me-3","text-decoration-none","text-dark"],[1,"ri-arrow-left-line"],["translate","sales.mangevisits.title",1,"mb-0","fw-bold"],["translate","sales.mangevisits.ongoing",1,"badge","bg-primary","ms-auto"],[1,"card","mb-4","shadow-sm"],[1,"card-body"],[1,"card-title","fw-bold","mb-1"],[1,"card-text","mb-2"],[1,"card-text","mb-1"],[1,"bi","bi-calendar3","me-2"],[1,"card-text"],[1,"bi","bi-clock","me-2"],[1,"card","shadow-sm"],["translate","sales.mangevisits.visitActions",1,"card-title","fw-bold"],[1,"card-text","mb-3"],[1,"d-grid","gap-2"],["translate","sales.mangevisits.rescheduleVisit",1,"btn","btn-primary",3,"click"],["translate","sales.mangevisits.cancelVisit",1,"btn","btn-danger",3,"click"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-light"],["translate","sales.mangevisits.rescheduleVisit",1,"card-title","mb-0","fw-bold","fs-2"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"ngSubmit"],[1,"mb-3"],[1,"form-label"],["type","text","readonly","",1,"form-control",3,"value"],["translate","sales.mangevisits.reasonForRescheduling",1,"form-label","required"],["name","reason","required","",1,"form-select",3,"ngModelChange","ngModel"],["value","","disabled","","selected","","translate","sales.mangevisits.selectareason"],["value","Requested By Customer","translate","sales.mangevisits.requestedByCustomer"],["value","Customer Unavailable","translate","sales.mangevisits.customerUnavailable"],["value","Internal Delay","translate","sales.mangevisits.internalDelay"],["value","Weather Conditions","translate","sales.mangevisits.weatherConditions"],["value","Transportation Issue","translate","sales.mangevisits.transportationIssue"],["value","Other","translate","sales.mangevisits.other"],["class","text-danger",4,"ngIf"],[1,"row","mb-3"],[1,"col"],["translate","sales.mangevisits.newDate",1,"form-label","required"],["type","date","name","newDate","required","",1,"form-control",3,"ngModelChange","ngModel"],["translate","sales.mangevisits.newTime",1,"form-label","required"],["type","time","name","newTime","required","",1,"form-control",3,"ngModelChange","ngModel"],["translate","sales.mangevisits.additionalNotes",1,"form-label"],["rows","3","name","notes","placeholder","Add any additional details about the rescheduling",1,"form-control",3,"ngModelChange","ngModel"],[1,"d-flex","justify-content-end","gap-2"],["type","submit","translate","sales.mangevisits.confirmReschedule",1,"btn","btn-primary",3,"disabled"],["type","button","translate","sales.mangevisits.cancel",1,"btn","btn-outline-secondary",3,"click"],[1,"text-danger"],["translate","sales.mangevisits.cancelVisit",1,"card-title","mb-0","fw-bold","fs-2"],["translate","sales.mangevisits.reasonForCancellation",1,"form-label","required"],["name","cancelReason","required","",1,"form-select",3,"ngModelChange","ngModel"],["value","","disabled","","selected","","translate","sales.mangevisits.storeClosed"],["value","Customer Request","translate","sales.mangevisits.storeRelocated"],["value","Internal Issue","translate","sales.mangevisits.customerRefused"],["value","Unavailability","translate","sales.mangevisits.wrongAddress"],["value","Unavailability","translate","sales.mangevisits.dupliCateVisit"],["value","Unavailability","translate","sales.mangevisits.emergency"],["value","Other"],["rows","3","name","cancelNotes","placeholder","Add any additional details about the cancellation",1,"form-control",3,"ngModelChange","ngModel"],["type","submit","translate","sales.mangevisits.confirmCancellation",1,"btn","btn-danger",3,"disabled"]],template:function(n,i){if(1&n){const a=e.RV6();e.j41(0,"div",8)(1,"div",9)(2,"a",10),e.nrm(3,"i",11),e.k0s(),e.nrm(4,"h4",12)(5,"span",13),e.k0s(),e.j41(6,"div",14)(7,"div",15)(8,"h5",16),e.EFF(9,"Acme Corporation"),e.k0s(),e.j41(10,"p",17),e.EFF(11,"123 Business Ave, Commerce City, CA 94105"),e.k0s(),e.j41(12,"p",18),e.nrm(13,"i",19),e.EFF(14," Friday, May 9, 2025 "),e.k0s(),e.j41(15,"p",20),e.nrm(16,"i",21),e.EFF(17," 08:15 PM "),e.k0s()()(),e.j41(18,"div",22)(19,"div",15),e.nrm(20,"h5",23),e.j41(21,"p",24),e.EFF(22,"Choose an action to manage this visit:"),e.k0s(),e.j41(23,"div",25)(24,"button",26),e.bIt("click",function(){e.eBV(a);const l=e.sdS(27);return e.Njj(i.openModalTitle(l,"lg"))}),e.k0s(),e.j41(25,"button",27),e.bIt("click",function(){e.eBV(a);const l=e.sdS(29);return e.Njj(i.openModalTitle(l,"lg"))}),e.k0s()()()()(),e.DNE(26,ld,40,9,"ng-template",null,0,e.C5r)(28,cd,30,5,"ng-template",null,1,e.C5r)}},dependencies:[p.bT,d.qT,d.xH,d.y7,d.me,d.wz,d.BC,d.cb,d.YS,d.vS,d.cV,g.Mm]})}}return r})();const pd=()=>["salesRequest.register"],ud=()=>["salesRequest.sendApproval"],gd=()=>["salesRequest.changeQuantity"],_d=()=>["salesRequest.cancel"],Ze=r=>[r];function hd(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",15),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.onSelectStatus(-1))}),e.j41(1,"div",16)(2,"div",51)(3,"div",18)(4,"div",52),e.nrm(5,"i",20),e.k0s()(),e.j41(6,"div",21)(7,"h5",22),e.EFF(8),e.k0s(),e.nrm(9,"p",53),e.k0s()()()()}if(2&r){const t=e.XpG();e.R7$(2),e.AVh("bg-primary-subtle",null==t.pagination.status),e.R7$(6),e.JRh(t.count.all)}}function fd(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",15),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.onSelectStatus(0))}),e.j41(1,"div",16)(2,"div",17)(3,"div",18)(4,"div",54),e.nrm(5,"i",20),e.k0s()(),e.j41(6,"div",21)(7,"h5",22),e.EFF(8),e.k0s(),e.nrm(9,"p",55),e.k0s()()()()}if(2&r){const t=e.XpG();e.R7$(),e.AVh("bg-primary-subtle",0==t.pagination.status),e.R7$(7),e.JRh(t.count.draft)}}function bd(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",15),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.onSelectStatus(5))}),e.j41(1,"div",16)(2,"div",17)(3,"div",18)(4,"div",54),e.nrm(5,"i",20),e.k0s()(),e.j41(6,"div",21)(7,"h5",22),e.EFF(8),e.k0s(),e.nrm(9,"p",56),e.k0s()()()()}if(2&r){const t=e.XpG();e.R7$(),e.AVh("bg-primary-subtle",5==t.pagination.status),e.R7$(7),e.JRh(t.count.changeQuantity)}}function vd(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",15),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.onSelectStatus(20))}),e.j41(1,"div",16)(2,"div",17)(3,"div",18)(4,"div",57),e.nrm(5,"i",20),e.k0s()(),e.j41(6,"div",21)(7,"h5",22),e.EFF(8),e.k0s(),e.nrm(9,"small",58),e.k0s()()()()}if(2&r){const t=e.XpG();e.R7$(),e.AVh("bg-primary-subtle",20==t.pagination.status),e.R7$(7),e.JRh(t.count.underReview)}}function Sd(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",15),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.onSelectStatus(30))}),e.j41(1,"div",16)(2,"div",17)(3,"div",18)(4,"div",59),e.nrm(5,"i",20),e.k0s()(),e.j41(6,"div",21)(7,"h5",22),e.EFF(8),e.k0s(),e.nrm(9,"p",60),e.k0s()()()()}if(2&r){const t=e.XpG();e.R7$(),e.AVh("bg-primary-subtle",30==t.pagination.status),e.R7$(7),e.JRh(t.count.repareOrder)}}function Cd(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",15),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.onSelectStatus(50))}),e.j41(1,"div",16)(2,"div",17)(3,"div",18)(4,"div",61),e.nrm(5,"i",20),e.k0s()(),e.j41(6,"div",21)(7,"h5",22),e.EFF(8),e.k0s(),e.nrm(9,"p",62),e.k0s()()()()}if(2&r){const t=e.XpG();e.R7$(),e.AVh("bg-primary-subtle",50==t.pagination.status),e.R7$(7),e.JRh(t.count.assign)}}function xd(r,s){1&r&&(e.j41(0,"th",72),e.EFF(1," sales.salesOrder.trunck "),e.k0s())}function yd(r,s){1&r&&(e.j41(0,"th",81),e.EFF(1," sales.salesOrder.cancelReasonName "),e.k0s())}function Id(r,s){if(1&r&&(e.j41(0,"tr",63),e.nrm(1,"th",64),e.j41(2,"th",65),e.EFF(3,"#"),e.k0s(),e.j41(4,"th",66),e.nrm(5,"i",67),e.EFF(6," orderManagement.order.orderCode "),e.k0s(),e.j41(7,"th",68),e.nrm(8,"i",67),e.EFF(9," orderManagement.order.creation "),e.k0s(),e.j41(10,"th",69),e.EFF(11," orderManagement.order.status "),e.k0s(),e.j41(12,"th",70),e.nrm(13,"i",67),e.EFF(14," orderManagement.order.agentName "),e.k0s(),e.j41(15,"th",71),e.EFF(16," sales.salesOrder.clientLocationName "),e.k0s(),e.j41(17,"th",72),e.EFF(18," sales.salesOrder.salsePerson "),e.k0s(),e.j41(19,"th",73),e.nrm(20,"i",67),e.EFF(21," sales.salesOrder.clientVisitDate "),e.k0s(),e.j41(22,"th",74),e.nrm(23,"i",67),e.EFF(24," sales.salesOrder.totalQuantity "),e.k0s(),e.j41(25,"th",75),e.nrm(26,"i",67),e.EFF(27," sales.salesOrder.totalDiscount "),e.k0s(),e.j41(28,"th",76),e.EFF(29," orderManagement.order.totalTax "),e.k0s(),e.j41(30,"th",77),e.nrm(31,"i",67),e.EFF(32," sales.salesOrder.netPrice "),e.k0s(),e.DNE(33,xd,2,0,"th",78)(34,yd,2,0,"th",79),e.nrm(35,"th",80),e.k0s()),2&r){const t=e.XpG();e.R7$(33),e.Y8G("ngIf",50==t.pagination.status),e.R7$(),e.Y8G("ngIf",40==t.pagination.status||5==t.pagination.status)}}function jd(r,s){1&r&&e.nrm(0,"span",100)}function Td(r,s){if(1&r&&(e.j41(0,"a",101),e.nrm(1,"i",102),e.k0s()),2&r){const t=e.XpG().$implicit,n=e.XpG();e.Y8G("href",n.mapUrl(null==t?null:t.lng,null==t?null:t.lat),e.B4B)}}function kd(r,s){if(1&r&&(e.j41(0,"td")(1,"div"),e.EFF(2),e.k0s(),e.j41(3,"div"),e.EFF(4),e.k0s()()),2&r){const t=e.XpG().$implicit;e.R7$(2),e.JRh(t.shippingTruckName),e.R7$(2),e.JRh(t.driverName)}}function wd(r,s){if(1&r&&(e.j41(0,"td")(1,"span",103),e.EFF(2),e.k0s()()),2&r){const t=e.XpG().$implicit;e.R7$(2),e.SpI("",t.cancelReasonName," ")}}function Md(r,s){if(1&r&&(e.j41(0,"td")(1,"span",103),e.EFF(2),e.k0s()()),2&r){const t=e.XpG().$implicit;e.R7$(2),e.SpI("",t.changeQuantityMessage," ")}}function Od(r,s){if(1&r){const t=e.RV6();e.j41(0,"button",104),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,a=e.XpG(),o=e.sdS(97);return e.Njj(a.getInvoiceAttachments(i.id,o))}),e.nrm(2,"i",105),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"general.action.attachment"))}function Rd(r,s){if(1&r){const t=e.RV6();e.j41(0,"button",107),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2).$implicit,a=e.XpG(),o=e.sdS(89);return e.Njj(a.openStatusModal(i.id,o,20,"md"))}),e.nrm(2,"i",108),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"general.action.send"))}function Fd(r,s){if(1&r&&(e.qex(0),e.DNE(1,Rd,3,3,"button",106),e.bVm()),2&r){const t=e.XpG().$implicit;e.R7$(),e.Y8G("ngIf",0==t.salesRequestStatus||5==t.salesRequestStatus)}}function Vd(r,s){if(1&r){const t=e.RV6();e.j41(0,"li",84),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2).$implicit,a=e.XpG(),o=e.sdS(85);return e.Njj(a.openModal(i.id,o,"xl"))}),e.j41(1,"span",109),e.nrm(2,"i",110)(3,"span",111),e.k0s()()}}function Ed(r,s){if(1&r&&(e.qex(0),e.DNE(1,Vd,4,0,"li",99),e.bVm()),2&r){const t=e.XpG().$implicit;e.R7$(),e.Y8G("ngIf",5==t.salesRequestStatus||0==t.salesRequestStatus||100==t.salesRequestStatus)}}function Nd(r,s){if(1&r){const t=e.RV6();e.j41(0,"li",84),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2).$implicit,a=e.XpG(),o=e.sdS(93);return e.Njj(a.openModal(i.id,o))}),e.j41(1,"span",109),e.nrm(2,"i",112)(3,"span",113),e.k0s()()}}function Dd(r,s){if(1&r&&(e.qex(0),e.DNE(1,Nd,4,0,"li",99),e.bVm()),2&r){const t=e.XpG().$implicit;e.R7$(),e.Y8G("ngIf",0==t.salesRequestStatus||100==t.salesRequestStatus)}}function Ld(r,s){if(1&r){const t=e.RV6();e.j41(0,"li",84),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,a=e.XpG(),o=e.sdS(79);return e.Njj(a.openModal(i.id,o))}),e.j41(1,"span",109),e.nrm(2,"i",112)(3,"span",114),e.k0s()()}}function Gd(r,s){if(1&r){const t=e.RV6();e.j41(0,"tr",82)(1,"td"),e.nrm(2,"button",83),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td",84),e.bIt("click",function(){const i=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.PrintSalesOrder(i.id))}),e.j41(6,"bdi",85),e.EFF(7),e.k0s()(),e.j41(8,"td"),e.EFF(9),e.nI1(10,"date"),e.k0s(),e.j41(11,"td")(12,"span"),e.nrm(13,"span",86),e.k0s()(),e.j41(14,"td",84),e.bIt("click",function(){const i=e.eBV(t).$implicit,a=e.XpG(),o=e.sdS(87);return e.Njj(a.openModal(i.clientId,o,"md"))}),e.j41(15,"a",87),e.EFF(16),e.k0s()(),e.j41(17,"td"),e.DNE(18,jd,1,0,"span",88)(19,Td,2,1,"a",89),e.k0s(),e.j41(20,"td")(21,"div"),e.EFF(22),e.k0s(),e.j41(23,"div",90),e.EFF(24),e.k0s()(),e.j41(25,"td"),e.EFF(26),e.nI1(27,"date"),e.k0s(),e.j41(28,"td"),e.EFF(29),e.k0s(),e.j41(30,"td"),e.EFF(31),e.k0s(),e.j41(32,"td"),e.EFF(33),e.k0s(),e.j41(34,"td"),e.EFF(35),e.k0s(),e.DNE(36,kd,5,2,"td",91)(37,wd,3,1,"td",91)(38,Md,3,1,"td",91),e.j41(39,"td"),e.qex(40),e.DNE(41,Od,3,3,"button",92),e.bVm(),e.DNE(42,Fd,2,1,"ng-container",93),e.j41(43,"span",94)(44,"div",95)(45,"button",96),e.nrm(46,"i",97),e.k0s(),e.j41(47,"ul",98),e.DNE(48,Ed,2,1,"ng-container",93)(49,Dd,2,1,"ng-container",93)(50,Ld,4,0,"li",99),e.k0s()()()()()}if(2&r){const t=s.$implicit,n=s.rowIndex,i=s.expanded,a=e.XpG();e.R7$(2),e.Y8G("pRowToggler",t)("ngClass",i?" ri-arrow-down-s-line":"  ri-arrow-up-s-line"),e.R7$(2),e.JRh(n+1),e.R7$(3),e.SpI("#SR#",t.id,""),e.R7$(2),e.SpI(" ",e.i5U(10,27,t.creationTime,"yyyy-MM-dd HH:mm")," "),e.R7$(3),e.ZvI("badge ",a.getStatus(t),""),e.R7$(),e.FS9("translate","sales.salesOrder."+t.statusName),e.R7$(3),e.SpI(" ",t.clientName," "),e.R7$(2),e.Y8G("ngIf",""==t.lng),e.R7$(),e.Y8G("ngIf",null==t?null:t.lng),e.R7$(3),e.JRh(t.salsePersonName),e.R7$(2),e.JRh(t.storeName),e.R7$(2),e.SpI(" ",e.i5U(27,30,t.acutalVisitDate,"yyyy-MM-dd HH:mm"),""),e.R7$(3),e.JRh(t.totalQuantity),e.R7$(2),e.JRh(t.totalDiscount),e.R7$(2),e.JRh(t.totalTax),e.R7$(2),e.JRh(t.netPrice),e.R7$(),e.Y8G("ngIf",50==a.pagination.status),e.R7$(),e.Y8G("ngIf",40==a.pagination.status),e.R7$(),e.Y8G("ngIf",5==a.pagination.status),e.R7$(3),e.Y8G("ngIf",60==t.salesRequestStatus),e.R7$(),e.Y8G("hasPermission",e.lJ4(33,ud)),e.R7$(6),e.Y8G("hasPermission",e.lJ4(34,gd)),e.R7$(),e.Y8G("hasPermission",e.lJ4(35,_d)),e.R7$(),e.Y8G("ngIf",0==t.salesRequestStatus)}}function Pd(r,s){1&r&&e.nrm(0,"span",127)}function $d(r,s){1&r&&e.nrm(0,"span",128)}function Bd(r,s){if(1&r&&(e.qex(0),e.j41(1,"tr")(2,"td"),e.EFF(3),e.k0s(),e.j41(4,"td"),e.EFF(5),e.k0s(),e.j41(6,"td"),e.EFF(7),e.k0s(),e.j41(8,"td"),e.EFF(9),e.k0s(),e.j41(10,"td"),e.EFF(11),e.k0s(),e.j41(12,"td"),e.DNE(13,Pd,1,0,"span",125)(14,$d,1,0,"span",126),e.k0s()(),e.bVm()),2&r){const t=s.$implicit,n=s.index;e.R7$(),e.AVh("bg-danger-subtle",t.isFree),e.R7$(2),e.JRh(n+1),e.R7$(2),e.JRh(t.itemName),e.R7$(2),e.JRh(t.unitName),e.R7$(2),e.JRh(t.approvedQuantity),e.R7$(2),e.JRh(t.price),e.R7$(2),e.Y8G("ngIf",t.isFree),e.R7$(),e.Y8G("ngIf",!t.isFree)}}function Xd(r,s){if(1&r&&(e.j41(0,"tr")(1,"td",115)(2,"div")(3,"table",116)(4,"thead")(5,"tr",117)(6,"th",118),e.EFF(7,"#"),e.k0s(),e.nrm(8,"th",119)(9,"th",120)(10,"th",121)(11,"th",122)(12,"th",123),e.k0s()(),e.j41(13,"tbody"),e.DNE(14,Bd,15,9,"ng-container",124),e.k0s()()()()()),2&r){const t=s.$implicit;e.R7$(14),e.Y8G("ngForOf",t.salesRequestDetails)}}function Ad(r,s){1&r&&(e.j41(0,"div",129),e.EFF(1," general.table.noData "),e.k0s())}function qd(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",130)(1,"div",131),e.nrm(2,"ngb-pagination-info",132),e.j41(3,"table-length",133),e.bIt("lengthChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.ListItemChange(i))}),e.k0s()(),e.j41(4,"div",134)(5,"ngb-pagination",135),e.bIt("pageChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.pageChanged(i))}),e.mxI("pageChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.pagination.pageNumber,i)||(a.pagination.pageNumber=i),e.Njj(i)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function Yd(r,s){if(1&r){const t=e.RV6();e.j41(0,"delete-modal",136),e.bIt("deleteConfirm",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.DeleteConfirm())})("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}}function Ud(r,s){if(1&r){const t=e.RV6();e.j41(0,"app-all-orders-details",137),e.bIt("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderDetails",t.operationId)}}function zd(r,s){if(1&r){const t=e.RV6();e.j41(0,"sales-edit-order",138),e.bIt("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("isChangeQuantity",!0)("isDraft",!0)("orderSelected",t.operationId)}}function Qd(r,s){if(1&r){const t=e.RV6();e.j41(0,"sales-edit-order",139),e.bIt("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("isRequest",!0)("isChangeQuantity",!0)("isDraft",!0)("orderSelected",t.operationId)}}function Hd(r,s){if(1&r){const t=e.RV6();e.j41(0,"client-summary",140),e.bIt("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("clientId",t.operationId)}}function Wd(r,s){if(1&r){const t=e.RV6();e.j41(0,"form",141,11),e.bIt("ngSubmit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.SubmitOrder())}),e.nrm(2,"ngx-ui-loader",142),e.j41(3,"div",143)(4,"div",144)(5,"button",145),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()(),e.j41(6,"div",146)(7,"div",147),e.nrm(8,"lord-icon",148),e.j41(9,"div",149),e.nrm(10,"h3",150)(11,"p",151),e.k0s()(),e.j41(12,"div",152),e.nrm(13,"button",153),e.j41(14,"button",154),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()()()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}function Jd(r,s){1&r&&(e.j41(0,"div",161),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function Zd(r,s){if(1&r){const t=e.RV6();e.j41(0,"form",141,11),e.bIt("ngSubmit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.RequestChangeQuantity())}),e.nrm(2,"ngx-ui-loader",142),e.j41(3,"div",143)(4,"div",144)(5,"button",145),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()(),e.j41(6,"div",146)(7,"div",155)(8,"label",156),e.EFF(9,"sales.salesOrder.changeQuantityMessage"),e.k0s(),e.j41(10,"textarea",157,12),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.changeQuantityMessage,i)||(a.form.changeQuantityMessage=i),e.Njj(i)}),e.k0s(),e.DNE(12,Jd,2,0,"div",158),e.k0s(),e.j41(13,"div",152),e.nrm(14,"button",159),e.j41(15,"button",160),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()()()()()}if(2&r){const t=e.sdS(1),n=e.sdS(11),i=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",i.loaderOperationShap)("loaderId",i.deleteLoader),e.R7$(8),e.R50("ngModel",i.form.changeQuantityMessage),e.R7$(2),e.Y8G("ngIf",n.invalid&&n.touched),e.R7$(2),e.Y8G("disabled",!t.valid)}}function Kd(r,s){if(1&r){const t=e.RV6();e.j41(0,"cancel-sales-model",162),e.bIt("success",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.reload())})("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderId",t.operationId)}}function ec(r,s){if(1&r){const t=e.RV6();e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td")(4,"ng-select",191),e.mxI("ngModelChange",function(i){const a=e.eBV(t).$implicit;return e.DH7(a.unitId,i)||(a.unitId=i),e.Njj(i)}),e.k0s()(),e.j41(5,"td")(6,"input",192),e.bIt("ngModelChange",function(i){const a=e.eBV(t).$index,o=e.XpG(2);return e.Njj(o.quantitySelect(i,a))}),e.mxI("ngModelChange",function(i){const a=e.eBV(t).$implicit;return e.DH7(a.quantity,i)||(a.quantity=i),e.Njj(i)}),e.k0s()()()}if(2&r){const t=s.$implicit,n=s.$index;e.R7$(2),e.SpI(" ",t.itemName," "),e.R7$(2),e.Y8G("name","unitId"+e.eq3(6,Ze,n))("items",t.units),e.R50("ngModel",t.unitId),e.R7$(2),e.Y8G("name","quantity"+e.eq3(8,Ze,n)),e.R50("ngModel",t.quantity)}}function tc(r,s){if(1&r){const t=e.RV6();e.j41(0,"tr",193),e.nrm(1,"td",194),e.j41(2,"td",195)(3,"table",196)(4,"tbody")(5,"tr"),e.nrm(6,"td",197),e.j41(7,"td",198),e.EFF(8),e.nI1(9,"translate"),e.k0s()(),e.j41(10,"tr"),e.nrm(11,"td",199),e.j41(12,"td",198)(13,"div",200)(14,"ng-select",201),e.bIt("change",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.getTotal())}),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG(2);return e.DH7(a.form.totalAddDiscountType,i)||(a.form.totalAddDiscountType=i),e.Njj(i)}),e.k0s(),e.j41(15,"input",202),e.bIt("change",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.getTotal())}),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG(2);return e.DH7(a.form.totalAddDiscount,i)||(a.form.totalAddDiscount=i),e.Njj(i)}),e.k0s()()()(),e.j41(16,"tr",203),e.nrm(17,"td",204),e.j41(18,"td",198),e.EFF(19),e.nI1(20,"translate"),e.k0s()(),e.j41(21,"tr",205),e.nrm(22,"th",206),e.j41(23,"th",198),e.EFF(24),e.nI1(25,"translate"),e.k0s()()()()()()}if(2&r){const t=e.XpG(2);e.R7$(8),e.Lme("",t.form.total," ",e.bMT(9,8,"orderManagement.order.currancy"),""),e.R7$(6),e.R50("ngModel",t.form.totalAddDiscountType),e.R7$(),e.R50("ngModel",t.form.totalAddDiscount),e.R7$(4),e.Lme("",t.form.tax," ",e.bMT(20,10,"orderManagement.order.currancy"),""),e.R7$(5),e.Lme("",t.form.totalNet," ",e.bMT(25,12,"orderManagement.order.currancy"),"")}}function ic(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",163)(1,"div",164)(2,"h4",165),e.nrm(3,"span",166),e.k0s(),e.j41(4,"button",167),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss("Cross click"))}),e.k0s()(),e.j41(5,"div",146),e.nrm(6,"ngx-ui-loader",142),e.j41(7,"form",168,11),e.bIt("submit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.updateTruck())}),e.j41(9,"div",26)(10,"div",169)(11,"label",170),e.EFF(12,"sales.salesOrder.acutalDeliveryDate"),e.k0s(),e.j41(13,"input",171),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.dateChangeModal(i))}),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.acutalVisitDate,i)||(a.form.acutalVisitDate=i),e.Njj(i)}),e.k0s()(),e.j41(14,"div",169),e.nrm(15,"label",172),e.j41(16,"ng-select",173),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.clientLocationId,i)||(a.form.clientLocationId=i),e.Njj(i)}),e.k0s()(),e.j41(17,"div",174)(18,"label",170),e.EFF(19,"sales.salesOrder.truncks"),e.k0s(),e.j41(20,"ng-select",175),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.shippingTruckId,i)||(a.form.shippingTruckId=i),e.Njj(i)}),e.k0s()()(),e.j41(21,"div",176)(22,"div",16)(23,"div",177)(24,"div",178),e.nrm(25,"h5",179),e.k0s()(),e.j41(26,"div",43)(27,"div",180)(28,"table",181)(29,"thead",182)(30,"tr"),e.nrm(31,"th",183)(32,"th",184)(33,"th",185),e.k0s()(),e.j41(34,"tbody"),e.Z7z(35,ec,7,10,"tr",null,e.Vm6),e.DNE(37,tc,26,14,"tr",186),e.k0s()()()()()(),e.j41(38,"div",187)(39,"button",188),e.nrm(40,"i",189)(41,"span",190),e.k0s()()()()()}if(2&r){const t=e.sdS(8),n=e.XpG();e.R7$(6),e.Y8G("hasProgressBar",!1)("fgsType",n.loaderOperationShap)("loaderId",n.operationLoader),e.R7$(7),e.R50("ngModel",n.form.acutalVisitDate),e.Y8G("altInput",!0)("enableTime",!0)("convertModelValue",!0)("dateFormat","d-m-Y H:i"),e.R7$(3),e.Y8G("disabled",!0)("items",n.locations),e.R50("ngModel",n.form.clientLocationId),e.R7$(4),e.Y8G("items",n.truncks),e.R50("ngModel",n.form.shippingTruckId),e.R7$(15),e.Dyx(n.form.details),e.R7$(2),e.Y8G("ngIf",!1),e.R7$(2),e.Y8G("disabled",!t.valid)}}function nc(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",169)(1,"p-image",210),e.bIt("error",function(i){e.eBV(t);const a=e.XpG(2);return e.Njj(a.setDefaultImage(i,"assets/images/custom/no-img.jpg"))}),e.k0s()()}if(2&r){const t=s.$implicit,n=e.XpG(2);e.R7$(),e.Y8G("src",n.serverPath+t.path)("preview",!0)}}function rc(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",163)(1,"div",164),e.nrm(2,"h2",207),e.j41(3,"button",167),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss("Cross click"))}),e.k0s()(),e.j41(4,"div",208)(5,"div",26),e.DNE(6,nc,2,2,"div",209),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(6),e.Y8G("ngForOf",t.images)}}let ac=(()=>{class r extends X.w{constructor(t,n,i,a,o,l,h,x,y,I,j,T,b,C,O,F,k,$){super(t,n,y,i,l,h,x),this.baseService=i,this.salesRequestService=a,this.salesInvoicesService=o,this.authDaamService=I,this.teamService=j,this.employeeService=T,this.regionService=b,this.cityService=C,this.excelService=O,this.router=F,this.storesService=k,this.orderReceivedService=$,this.title="sales.salesRequests.title",this.titleOperation="sales.salesRequests.titleOperation",this.keySelected="",this.searchForm={},this.isResolveList=!0,this.employeeGroups=[],this.activeindex="2",this.active=2,this.clientSelected=0,this.status=[],this.countLoad=2,this.isOrderEdit=!1,this.orderSelected={},this.users=[],this.statusCount={},this.salesPersons=[],this.regions=[],this.cities=[],this.count={},this.truncks=[],this.locations=[],this.discountTypes=[],this.showStore=!1,this.statusList=[{id:0,name:"Draft"},{id:5,name:"ChangeQuantity"},{id:20,name:"UnderReview"},{id:30,name:"StoreDeliveryOrder"},{id:32,name:"RepareOrder"},{id:40,name:"Cancel"},{id:50,name:"Assign"},{id:60,name:"Finished"},{id:100,name:"Return"}],this.user=JSON.parse(localStorage.getItem("user")),this.stores=[],this.setting=[],this.images=[],this.serverPath=Y.c.mediaUrl,this.setDates=(L,ee,se)=>{if(L?.from||L?.to){const dp=L.to||L.from;this.pagination[ee]=this.datePipe.transform(L.from||L.to,"yyyy-MM-ddT00:00:00"),this.pagination[se]=this.datePipe.transform(dp,"yyyy-MM-ddT23:59:59.999")}else this.pagination[ee]=null,this.pagination[se]=null},this.configRoute(),this.GetSalesPersons(),this.GetRegions(),this.GetCities(),this.GetOfferOrderCount(),this.configStatus(),this.GetStores()}configStatus(){this.statusList.forEach(t=>{t.name=this.getTranslationText("sales.salesOrder."+t.name)})}GetOfferOrderCount(){this.salesRequestService.SalesRequestCount().subscribe(t=>{this.count=t.data})}GetStores(){this.storesService.getDropDown().subscribe(t=>{this.stores=t.data},t=>{console.log(t)})}GetRegions(){this.regionService.getDropDown().subscribe(t=>{this.regions=t.data},t=>{console.log(t)})}GetCities(){this.cityService.GetAllDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetSalesPersons(){this.employeeService.GetAllByType(9).subscribe(t=>{this.salesPersons=t.data},t=>{console.log(t)})}ngOnInitMore(){this.discountTypes=this.baseService.discountTypes,this.discountTypes.forEach(t=>{t.name=this.getTranslationText("sales.salesOrder."+t.name)})}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,m.Q)(this.notifier)).subscribe(n=>{n?this.alertService.success():this.alertService.error("general.message."+n)},n=>{this.alertService.error()})}mapRegisterForm(t){let n={...t};return n.employeeCode=0,n}onSearch(){-1===this.pagination.status?(this.pagination.status=null,this.pagination.statusList=[],this.showStore=!1):30===this.pagination.status?(this.pagination.status=null,this.showStore=!0,this.pagination.statusList=[30,32]):(this.pagination.statusList=[],this.showStore=!1);let t={...this.searchForm};this.ngxLoader.startLoader("allLoader"),this.setDates(t.dates,"visitDateFrom","visitDateTo"),this.setDates(t.creationDates,"creationTimeFrom","creationTimeTo"),this.loadentities()}LoadSuccess(){this.ngxLoader.stopLoader("allLoader")}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems},this.loadentities()}configRoute(){this.routerActive.data.pipe((0,m.Q)(this.notifier)).subscribe(t=>{this.entities=t.data,this.pagination.totalItems=t.data?.totalItems},()=>{this.alertService.error()})}mapExcel(){let t=[];return this.entities.forEach(n=>{t.push({Code:n.id,CreatorName:n.creatorName,creationTime:n.creationTime,clientName:n.clientName,Status:this.getTranslationText("sales.salesOrder."+n.offerOrderStatusValue),salse_Person:n.salsePersonName,"Delivery.Date":n.acutalVisitDate,"T.Quantity":n.totalQuantity," T.Discount":n.totalDiscount,Tax:n.totalTax,Net:n.netPrice,Reason:n.cancelReasonName})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}getStatus(t){return 10==t.salesRequestStatus||5==t.salesRequestStatus?"bg-warning":20==t.salesRequestStatus?"bg-secondary ":30==t.salesRequestStatus?"bg-info":60==t.salesRequestStatus?"bg-success":40==t.salesRequestStatus?"bg-danger":50==t.salesRequestStatus?"bg-info":"bg-warning"}checkEdit(t){return!t.isCancel&&!t.isFinish}openModalClient(t,n,i="xl"){this.clientSelected=t.orderCode,this.orderSelected=t,this.isOrderEdit=!1,this.modalService.open(n,{centered:!0,size:i})}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}goNew(){this.router.navigateByUrl("/sales/new")}onSelectStatus(t){this.pagination.status=t,this.onSearch()}openStatusModal(t,n,i,a="md"){this.isEditForm=!1,this.form={},this.form={id:t,status:i},this.modalService.open(n,{centered:!0,size:a})}SubmitOrder(){this.ngxLoader.startLoader(u.Fq),this.salesRequestService.changStatus({id:this.form.id,status:this.form.status}).pipe((0,v.O)(),(0,R.c)(this.mainDelay),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader(u.Fq))).subscribe({next:n=>{n.success?(this.modalService.dismissAll(),this.reload(),this.alertService.success()):this.alertService.error("general.message."+n.message)}})}cancelOrder(){this.ngxLoader.startLoader(u.Fq),console.log(this.operationId),this.baseService.changStatus({id:this.operationId,status:40}).pipe((0,v.O)(),(0,R.c)(this.mainDelay),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader(u.Fq))).subscribe({next:n=>{this.modalService.dismissAll(),this.reload(),this.alertService.success()}})}RequestChangeQuantity(){this.ngxLoader.startLoader(u.Fq),console.log(this.operationId),this.baseService.RequestChangeQuantity({id:this.operationId,changeQuantityMessage:this.form.changeQuantityMessage}).pipe((0,v.O)(),(0,R.c)(this.mainDelay),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader(u.Fq))).subscribe({next:n=>{this.modalService.dismissAll(),this.reload(),this.alertService.success()}})}reload(){this.modalService.dismissAll(),this.GetOfferOrderCount(),this.loadentities()}formatDate(t){if(!t)return"";const n=new Date(t);return n.getDate().toString().padStart(2,"0")+"-"+(n.getMonth()+1).toString().padStart(2,"0")+"-"+n.getFullYear()+" "+n.getHours().toString().padStart(2,"0")+":"+n.getMinutes().toString().padStart(2,"0")}openShippingModal(t,n,i="md"){this.baseService.GetTrucks({id:t,acutalVisitDate:null}).subscribe(o=>{o.success?(this.form=o.data.order,this.getTotal(),this.form.clientVisitDate=this.formatDate(this.form.clientVisitDate),this.form.acutalVisitDate=this.formatDate(this.form.acutalVisitDate),this.truncks=o.data.truncks,this.locations=o.data.locations,this.modalService.open(n,{centered:!0,size:i})):this.alertService.error("general.message."+o.message)},o=>{this.alertService.error("general.message."+o)})}getTotal(){let t=0,n=0,i=0;this.form.details.forEach(a=>{a.discount<0&&(a.discoun=0);let o=a.quantity*a.price,l=0;1===a.discountType?l=a.discount:2===a.discountType&&(l=o*a.discount/100),n=+l;let h=o-l;a.net=h,t=+h}),1===this.form.totalAddDiscountType?i=this.form.totalAddDiscount:2===this.form.totalAddDiscountType&&(i=t*this.form.totalAddDiscount/100),this.form.total=t,this.form.totalAddDiscount=this.form.totalAddDiscount,this.form.tax=15*this.form.total/100,this.form.totalNet=this.form.total-i+this.form.tax}updateTruck(){this.form.acutalVisitDate=new Date(this.convertToISO(this.form.acutalVisitDate));let t={shippingTruckId:this.form.shippingTruckId,clientLocationId:this.form.clientLocationId,offerOrderMasterId:this.form.id,Notes:this.form.notes,terms:this.form.terms,deliveryDate:this.datePipe.transform(this.form.acutalVisitDate,"yyyy-MM-ddTHH:mm:00.000"),details:this.form.details.map(n=>({id:0,itemId:n.itemId,itemName:n.itemName,quantity:n.quantity,unitId:n.unitId,price:n.price,discount:n.discount,discountType:n.discountType,clientQuantity:n.clientQuantity,approvedQuantity:n.approvedQuantity}))};this.ngxLoader.startLoader(this.operationLoader),this.orderReceivedService.register(t).pipe((0,v.O)(),(0,R.c)(this.mainDelay),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(n=>{n.success?this.reload():this.alertService.error("general.message."+n.message)},n=>{this.alertService.error("general.message."+n)})}convertToISO(t){if(t instanceof Date)return t.toISOString();if("string"==typeof t){const[n,i,a,o,l]=t.split(/[-\s:]/);return`${a}-${i}-${n}T${o}:${l}:00`}}dateChangeModal(t){t=new Date(t);let n={id:this.form.id,acutalVisitDate:this.datePipe.transform(t,"yyyy-MM-ddT00:00:00.000")};this.baseService.GetTrucks(n).subscribe(i=>{i.success?this.truncks=i.data.truncks:this.alertService.error("general.message."+i.message)},i=>{this.alertService.error("general.message."+i)})}quantitySelect(t,n){t&&(t<=0&&(t=1),this.form.details[n].quantity=parseInt(t),this.form.details[n].net=this.form.details[n].price*this.form.details[n].quantity,this.discountSelect(this.form.details[n].discount,n),this.getTotal())}discountSelect(t,n,i=1){if(t){(t=parseInt(t))<=0&&(this.form.details[n].discount=0),1==i&&(this.form.details[n].discount=t);let a=0;1==this.form.details[n].discountType?a=this.form.details[n].discount:(a=this.form.details[n].price*this.form.details[n].quantity*this.form.details[n].discount/100,a=+a.toFixed(2)),this.form.details[n].net=this.form.details[n].price*this.form.details[n].quantity-a,this.form.details[n].net=this.form.details[n].net.toFixed(2),this.getTotal()}}PrintOrderReceived(t){this.ngxLoader.startLoader("allLoader"),this.orderReceivedService.PrintOrderReceived(t).pipe((0,v.O)(),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader("allLoader"))).subscribe(n=>{this.openUrl(n)},n=>{this.alertService.error("general.message."+n)})}openUrl(t){let n=new Blob([t],{type:t.type});var i=URL.createObjectURL(n);window.open(i,"_blank")}PrintSalesOrder(t){this.ngxLoader.startLoader("allLoader"),this.salesRequestService.PrintReport(t).pipe((0,v.O)(),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader("allLoader"))).subscribe(n=>{this.openUrl(n)},n=>{this.alertService.error("general.message."+n)})}mapUrl(t,n){return null===t||null==n?"":`https://www.google.com/maps/dir//${n},${t}/@${n},${t},17z?hl=en-US`}loadentities(){this.salesRequestService.get(this.pagination).pipe((0,m.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader(u.a7),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader(u.a7),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[]}setDefaultImage(t,n){t.target.src=n}getInvoiceAttachments(t,n){this.salesInvoicesService.GetInvoiceAttachmentsByOrder(t).subscribe({next:i=>{this.images=i.data,this.modalService.open(n,{centered:!0,size:"md"})}})}static{this.\u0275fac=function(n){return new(n||r)(e.rXU(M.nX),e.rXU(g.c$),e.rXU(U.A),e.rXU(Ue.Z),e.rXU(ye.Q),e.rXU(E.u),e.rXU(p.vh),e.rXU(w.eD),e.rXU(_.Bq),e.rXU(fe.J),e.rXU(Me.n),e.rXU(K.O),e.rXU(Ie.S),e.rXU(le.h),e.rXU(H.V),e.rXU(M.Ix),e.rXU(Oe.a),e.rXU(he.B))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-sales-request"]],features:[e.Vt3],decls:98,vars:75,consts:[["tableMaster",""],["deleteModal",""],["orderViewModel",""],["SalesEditModel",""],["SalesChangeModel",""],["ClientInfo",""],["StatusOrderModal",""],["SubmitChangeQuantityModal",""],["cancelModal",""],["SubmitOrderModal",""],["viewMedia",""],["formEntity","ngForm"],["changeQuantityMessage","ngModel"],[1,"row","justify-content-center"],["class","col-sm-12 col-custom-7 cursor-pointer ",3,"click",4,"ngIf"],[1,"col-sm-12","col-custom-7","cursor-pointer",3,"click"],[1,"card"],[1,"card-body","d-flex","gap-3","align-items-center"],[1,"avatar-sm"],[1,"avatar-title","border","bg-success","border-opacity-25","rounded-2","fs-17"],[1,"ri-shopping-cart-2-fill"],[1,"flex-grow-1"],[1,"fs-15"],["translate","sales.salesOrder.completeOrder",1,"mb-0","text-muted"],[1,"avatar-title","border","bg-danger","border-opacity-25","rounded-2","fs-17"],["translate","sales.salesOrder.cancelOrder",1,"mb-0","text-muted"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"addNew","reset","search","exportXlsx","addPermission","showAdd","showExport","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","id","name","id",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],["InputTirmFilter","","type","search","id","clientName","name","clientName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["name","regionId","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],["name","cityId","bindValue","code","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],["name","status","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],["name","storeId","bindValue","id","bindLabel","nameAR",3,"ngModelChange","items","multiple","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,"card-body","bg-primary-subtle","d-flex","gap-1","align-items-center"],[1,"avatar-title","border","border-opacity-25","rounded-2","fs-17"],["translate","general.table.all",1,"mb-0","text-muted"],[1,"avatar-title","border","bg-warning","border-opacity-25","rounded-2","fs-17"],["translate","sales.salesOrder.draft",1,"mb-0","text-muted"],["translate","sales.salesOrder.reopen",1,"mb-0","text-muted"],[1,"avatar-title","bg-secondary","border","border-opacity-25","rounded-2","fs-17"],["translate","sales.salesOrder.approveMangerSM",1,"mb-0","text-muted"],[1,"avatar-title","bg-info","border","border-opacity-25","rounded-2","fs-17"],["translate","sales.salesOrder.storeRepeare",1,"mb-0","text-muted"],[1,"avatar-title","border","bg-info","border-opacity-25","rounded-2","fs-17"],["translate","sales.salesOrder.orderShipping",1,"mb-0","text-muted"],[1,""],[2,"width",".2%"],["translate","",2,"width",".3%"],["pSortableColumn","id","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["pSortableColumn","creationTime","translate","",2,"width","10%"],["pSortableColumn","status","translate","",2,"width","6%"],["pSortableColumn","clientId","translate","",2,"width","10%"],["translate","",2,"width","3%"],["translate","",2,"width","12%"],["pSortableColumn","clientVisitDate","translate","",2,"width","10%"],["pSortableColumn","totalQuantity","translate","",2,"width","8%"],["pSortableColumn","totalDiscount","translate","",2,"width","8%"],["translate","",2,"width","6%"],["pSortableColumn","netPrice","translate","",2,"width","8%"],["style","width:12%","translate","",4,"ngIf"],["style","width:10%","translate","",4,"ngIf"],["translate","",2,"width","8%"],["translate","",2,"width","10%"],[1,"fs-5"],["type","button","pRipple","",1,"border-0","p-button-text","p-button-rounded","p-button-plain",3,"pRowToggler","ngClass"],[3,"click"],[1,"code-pointer","text-decoration-underline","link-underline-opacity-25","link-underline-opacity-100-hover"],[3,"translate"],["href","javascript:void(0)",1,"link-primary","link-offset-2","text-decoration-underline","link-underline-opacity-25","link-underline-opacity-100-hover"],["class","badge bg-danger-subtle text-danger mx-1","translate","orderManagement.order.noMap",4,"ngIf"],["target","_blank","class","badge bg-success-subtle text-success mx-1","translate","orderManagement.order.viewMap",3,"href",4,"ngIf"],[1,"badge","bg-primary"],[4,"ngIf"],["class","btn btn-sm btn-primary edit-list mx-1","tooltipPosition","top",3,"pTooltip","click",4,"ngIf"],[4,"hasPermission"],[1,"d-inline-block"],[1,"dropdown-custom","d-inline-block"],["type","button",1,"btn","dropbtn","btn-soft-secondary","btn-sm","dropdown-custom","arrow-none"],[1,"ri-more-fill"],[1,"dropdown-menu","dropdown-menu-end","dropdown-content",2,"left","0"],[3,"click",4,"ngIf"],["translate","orderManagement.order.noMap",1,"badge","bg-danger-subtle","text-danger","mx-1"],["target","_blank","translate","orderManagement.order.viewMap",1,"badge","bg-success-subtle","text-success","mx-1",3,"href"],[1,"ri-map-pin-line"],[1,"badge","bg-danger-subtle","text-danger"],["tooltipPosition","top",1,"btn","btn-sm","btn-primary","edit-list","mx-1",3,"click","pTooltip"],[1,"ri-image-2-fill","align-bottom"],["class","btn btn-sm btn-warning edit-list mx-1","tooltipPosition","top",3,"pTooltip","click",4,"ngIf"],["tooltipPosition","top",1,"btn","btn-sm","btn-warning","edit-list","mx-1",3,"click","pTooltip"],[1,"ri-send-plane-fill","align-bottom"],[1,"dropdown-item"],[1,"text-success","ri-pencil-fill","align-bottom","me-2"],["translate","general.action.edit"],[1,"text-danger","ri-close-fill","align-bottom","me-2"],["translate","general.action.cancel"],["translate","general.action.delete"],["colspan","17"],["dataKey","id"],[1,"bg-light"],[2,"width","3%"],["translate","sales.salesOrder.itemName",2,"width","10%"],["translate","sales.salesOrder.unit",2,"width","6%"],["translate","sales.salesOrder.approvedQuantity",2,"width","8%"],["translate","sales.salesOrder.price",2,"width","5%"],["translate","sales.salesOrder.isFree",2,"width","5%"],[4,"ngFor","ngForOf"],["translate","sales.salesOrder.free",4,"ngIf"],["translate","sales.salesOrder.noFree",4,"ngIf"],["translate","sales.salesOrder.free"],["translate","sales.salesOrder.noFree"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"deleteConfirm","dismiss"],[3,"dismiss","orderDetails"],[3,"dismiss","isChangeQuantity","isDraft","orderSelected"],[3,"dismiss","isRequest","isChangeQuantity","isDraft","orderSelected"],[3,"dismiss","clientId"],[3,"ngSubmit"],[3,"hasProgressBar","fgsType","loaderId"],[1,"modal-content"],[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mt-2","text-center"],["src","https://cdn.lordicon.com/gdfrsvpt.json","stroke","bold","state","hover-oscillate","trigger","loop","colors","primary:#f7b84b,secondary:#f06548",2,"width","130px","height","130px"],[1,"pt-2","fs-15","mx-4","mx-sm-5"],["translate","orderManagement.order.AreYouSureMessage"],[1,"text-muted","mx-4","mb-0"],[1,"d-flex","gap-2","justify-content-center","mt-4","mb-2"],["type","submit","id","save","translate","general.action.send",1,"btn","w-sm","btn-danger","fs-4"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light","fs-4",3,"click"],[1,"mb-2"],["for","changeQuantityMessage","translate","",1,"required","text-bold","form-label"],["rows","5","InputTirmFilter","","name","changeQuantityMessage","type","text","id","changeQuantityMessage",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["class","text-danger text-center  ","translate","",4,"ngIf"],["t","","type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger",3,"disabled"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],["translate","",1,"text-danger","text-center"],[3,"success","dismiss","orderId"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["translate","sales.salesOrder.truckUpdate"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[3,"submit"],[1,"col-12","col-md-3"],["for","name","translate","",1,"required","fw-bold","form-label"],["name","acutalVisitDate","type","text","mwlFlatpickr","","altFormat","d-m-Y H:i","required","",1,"form-control","flatpickr-input",3,"ngModelChange","ngModel","altInput","enableTime","convertModelValue","dateFormat"],["for","name","translate","orderManagement.order.savedAddress",1,"required","fw-bold","form-label"],["name","clientLocationId","bindValue","id","bindLabel","name","required","",2,"width","100%",3,"ngModelChange","disabled","items","ngModel"],[1,"col-12","col-md-6"],["name","shippingTruckId","bindValue","id","bindLabel","name","required","",2,"width","100%",3,"ngModelChange","items","ngModel"],[1,"row","justify-content-center","my-0"],[1,"card-header","p-0"],[1,"d-flex","align-items-center"],["translate","sales.salesRequests.items",1,"card-title","flex-grow-1","mb-0"],[1,"table-responsive","table-card",2,"overflow","visible"],[1,"table","table-nowrap","align-middle","table-borderless","mb-0"],[1,"table-light","text-muted","p-1"],["translate","sales.salesRequests.itemName",2,"width","20%"],["translate","sales.salesRequests.unit",2,"width","25%"],["translate","sales.salesRequests.quantity",2,"width","25%"],["class","border-top border-top-dashed",4,"ngIf"],[1,"d-flex","justify-content-center","m-0"],["type","submit","type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],["clearable","false","clearOnBackspace","false","bindValue","id","bindLabel","name",2,"width","100%",3,"ngModelChange","name","items","ngModel"],["type","text","id","quantity",1,"form-control","fs-6",3,"ngModelChange","name","ngModel"],[1,"border-top","border-top-dashed"],["colspan","3"],["colspan","4",1,"fw-medium","p-0"],[1,"table","table-borderless","mb-0"],["translate","sales.salesOrder.total",1,"m-0","p-0"],[1,"text-end","m-0","p-0"],["translate","sales.salesOrder.extraDiscount",1,"m-0","p-0"],[1,"input-group","mx-4",2,"width","80%"],["clearable","false","clearOnBackspace","false",3,"change","ngModelChange","ngModel"],["InputTirmFilter","","name","totalAddDiscount","type","text","id","totalAddDiscount",1,"form-control","fs-6",2,"width","30%",3,"change","ngModelChange","ngModel"],[1,"m-0","p-0"],["translate","sales.salesOrder.tax",1,"m-0","p-0"],[1,"border-top","border-top-dashed","m-0","p-0"],["scope","row","translate","sales.salesOrder.net",1,"m-0","p-0"],["translate","sales.salesOrder.attachments"],[1,"modal-body","p-4"],["class","col-12 col-md-3",4,"ngFor","ngForOf"],["width","80","height","100",3,"error","src","preview"]],template:function(n,i){if(1&n){const a=e.RV6();e.j41(0,"div",13),e.DNE(1,hd,10,3,"div",14)(2,fd,10,3,"div",14)(3,bd,10,3,"div",14)(4,vd,10,3,"div",14)(5,Sd,10,3,"div",14)(6,Cd,10,3,"div",14),e.j41(7,"div",15),e.bIt("click",function(){return e.eBV(a),e.Njj(i.onSelectStatus(60))}),e.j41(8,"div",16)(9,"div",17)(10,"div",18)(11,"div",19),e.nrm(12,"i",20),e.k0s()(),e.j41(13,"div",21)(14,"h5",22),e.EFF(15),e.k0s(),e.nrm(16,"p",23),e.k0s()()()(),e.j41(17,"div",15),e.bIt("click",function(){return e.eBV(a),e.Njj(i.onSelectStatus(40))}),e.j41(18,"div",16)(19,"div",17)(20,"div",18)(21,"div",24),e.nrm(22,"i",20),e.k0s()(),e.j41(23,"div",21)(24,"h5",22),e.EFF(25),e.k0s(),e.nrm(26,"p",25),e.k0s()()()()(),e.j41(27,"div",26)(28,"div",27)(29,"div",28),e.nrm(30,"ngx-ui-loader",29),e.j41(31,"base-filter",30),e.bIt("addNew",function(){return e.eBV(a),e.Njj(i.goNew())})("reset",function(){return e.eBV(a),e.Njj(i.onReset())})("search",function(){return e.eBV(a),e.Njj(i.onSearch())})("exportXlsx",function(){return e.eBV(a),e.Njj(i.onExportXlsx())}),e.qex(32,31),e.j41(33,"div",32)(34,"div",33)(35,"input",34),e.nI1(36,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.id,l)||(i.pagination.id=l),e.Njj(l)}),e.k0s(),e.nrm(37,"i",35),e.k0s()(),e.j41(38,"div",32)(39,"input",36),e.nI1(40,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.searchForm.creationDates,l)||(i.searchForm.creationDates=l),e.Njj(l)}),e.k0s()(),e.j41(41,"div",32)(42,"div",33)(43,"input",37),e.nI1(44,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.clientName,l)||(i.pagination.clientName=l),e.Njj(l)}),e.k0s(),e.nrm(45,"i",35),e.k0s()(),e.j41(46,"div",32)(47,"div",33)(48,"ng-select",38),e.nI1(49,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.salesPersonId,l)||(i.pagination.salesPersonId=l),e.Njj(l)}),e.k0s()()(),e.j41(50,"div",32)(51,"input",36),e.nI1(52,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.searchForm.dates,l)||(i.searchForm.dates=l),e.Njj(l)}),e.k0s()(),e.j41(53,"div",32)(54,"div",33)(55,"ng-select",39),e.nI1(56,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.regionId,l)||(i.pagination.regionId=l),e.Njj(l)}),e.k0s()()(),e.j41(57,"div",32)(58,"div",33)(59,"ng-select",40),e.nI1(60,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.cityId,l)||(i.pagination.cityId=l),e.Njj(l)}),e.k0s()()(),e.j41(61,"div",32)(62,"div",33)(63,"ng-select",41),e.nI1(64,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.status,l)||(i.pagination.status=l),e.Njj(l)}),e.k0s()()(),e.j41(65,"div",32)(66,"div",33)(67,"ng-select",42),e.nI1(68,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.storeId,l)||(i.pagination.storeId=l),e.Njj(l)}),e.k0s()()(),e.bVm(),e.k0s(),e.j41(69,"div",43)(70,"div",44)(71,"p-table",45,0),e.bIt("onLazyLoad",function(l){return e.eBV(a),e.Njj(i.tableChange(l))})("selectionChange",function(l){return e.eBV(a),e.Njj(i.onSelectionChange(l))}),e.DNE(73,Id,36,2,"ng-template",46)(74,Gd,51,36,"ng-template",47)(75,Xd,15,1,"ng-template",48),e.k0s()(),e.DNE(76,Ad,2,0,"div",49)(77,qd,6,8,"div",50),e.k0s()()()(),e.DNE(78,Yd,1,0,"ng-template",null,1,e.C5r)(80,Ud,1,1,"ng-template",null,2,e.C5r)(82,zd,1,3,"ng-template",null,3,e.C5r)(84,Qd,1,4,"ng-template",null,4,e.C5r)(86,Hd,1,1,"ng-template",null,5,e.C5r)(88,Wd,15,3,"ng-template",null,6,e.C5r)(90,Zd,16,6,"ng-template",null,7,e.C5r)(92,Kd,1,1,"ng-template",null,8,e.C5r)(94,ic,42,15,"ng-template",null,9,e.C5r)(96,rc,7,1,"ng-template",null,10,e.C5r)}2&n&&(e.R7$(),e.Y8G("ngIf",12!=i.user.userType),e.R7$(),e.Y8G("ngIf",1==i.user.userType||9==i.user.userType),e.R7$(),e.Y8G("ngIf",1==i.user.userType||9==i.user.userType),e.R7$(),e.Y8G("ngIf",1==i.user.userType||12==i.user.userType),e.R7$(),e.Y8G("ngIf",1==i.user.userType),e.R7$(),e.Y8G("ngIf",1==i.user.userType),e.R7$(2),e.AVh("bg-primary-subtle",60==i.pagination.status),e.R7$(7),e.JRh(i.count.finished),e.R7$(3),e.AVh("bg-primary-subtle",40==i.pagination.status),e.R7$(7),e.JRh(i.count.cancel),e.R7$(5),e.Y8G("loaderId","allLoader"),e.R7$(),e.Y8G("addPermission",e.lJ4(74,pd))("showAdd",!0)("showExport",!0)("totalItems",i.pagination.totalItems)("title",i.title),e.R7$(4),e.FS9("placeholder",e.bMT(36,56,"orderManagement.order.orderCode")),e.R50("ngModel",i.pagination.id),e.R7$(4),e.FS9("placeholder",e.bMT(40,58,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",i.searchForm.creationDates),e.R7$(4),e.FS9("placeholder",e.bMT(44,60,"orderManagement.order.agentName")),e.R50("ngModel",i.pagination.clientName),e.R7$(5),e.FS9("placeholder",e.bMT(49,62,"sales.salesOrder.salsePerson")),e.Y8G("items",i.salesPersons)("multiple",!1),e.R50("ngModel",i.pagination.salesPersonId),e.R7$(3),e.FS9("placeholder",e.bMT(52,64,"sales.salesOrder.clientVisitDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",i.searchForm.dates),e.R7$(4),e.FS9("placeholder",e.bMT(56,66,"client.client.regionName")),e.Y8G("items",i.regions)("multiple",!1),e.R50("ngModel",i.pagination.regionId),e.R7$(4),e.FS9("placeholder",e.bMT(60,68,"client.client.cityName")),e.Y8G("items",i.cities)("multiple",!1),e.R50("ngModel",i.pagination.cityId),e.R7$(4),e.FS9("placeholder",e.bMT(64,70,"orderManagement.order.status")),e.Y8G("items",i.statusList)("multiple",!1),e.R50("ngModel",i.pagination.status),e.R7$(4),e.FS9("placeholder",e.bMT(68,72,"sales.salesOrder.storeName")),e.Y8G("items",i.stores)("multiple",!1),e.R50("ngModel",i.pagination.storeId),e.R7$(4),e.Y8G("value",i.entities)("rows",i.pagination.pageSize)("lazy",!0)("totalRecords",i.pagination.totalItems),e.R7$(5),e.Y8G("ngIf",i.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",i.pagination.totalItems>0))},dependencies:[p.YU,p.Sq,p.bT,d.qT,d.me,d.Q0,d.BC,d.cb,d.YS,d.vS,d.cV,_.s5,G.kL,W.b,z.w,J.p,Z.g,ce.x,g.Mm,V.XI,q.Ei,V.Tg,V.FP,w.Cv,P.vr,B.m,A.p,de.m,Ee._,Re,Fe,p.vh,g.D9]})}}return r})();var Ke=c(55999);const sc=()=>["customerRequest.register"],oc=()=>["customerRequest.changeStatus"],lc=()=>["customerRequest.edit"];function dc(r,s){1&r&&(e.j41(0,"tr",47)(1,"th",48),e.EFF(2,"#"),e.k0s(),e.j41(3,"th",49),e.nrm(4,"i",50),e.EFF(5," general.table.id "),e.k0s(),e.j41(6,"th",51),e.nrm(7,"i",50),e.EFF(8," sales.clientCollection.clientName "),e.k0s(),e.j41(9,"th",52),e.nrm(10,"i",50),e.EFF(11," approvals.customerRequest.primaryPhoneNumber "),e.k0s(),e.j41(12,"th",53),e.nrm(13,"i",50),e.EFF(14," approvals.customerRequest.clientGroup "),e.k0s(),e.j41(15,"th",54),e.nrm(16,"i",50),e.EFF(17," approvals.customerRequest.city "),e.k0s(),e.j41(18,"th",55),e.nrm(19,"i",50),e.EFF(20," orderManagement.order.creation "),e.k0s(),e.j41(21,"th",56),e.EFF(22," sales.salesOrder.salsePerson "),e.k0s(),e.j41(23,"th",57),e.nrm(24,"i",50),e.EFF(25," sales.requestPersonSales.requestPersonStatus "),e.k0s(),e.j41(26,"th",58),e.nrm(27,"i",50),e.EFF(28," sales.clientCollection.notes "),e.k0s(),e.nrm(29,"th",59),e.k0s())}function cc(r,s){if(1&r&&(e.nrm(0,"i",65),e.EFF(1),e.nI1(2,"date"),e.nrm(3,"br")(4,"i",66),e.EFF(5),e.nI1(6,"date"),e.nrm(7,"br")(8,"i",67),e.EFF(9)),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",e.i5U(2,3,t.creationTime,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",e.i5U(6,6,t.lastModificationTime,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",t.creatorName," ")}}function mc(r,s){if(1&r){const t=e.RV6();e.j41(0,"button",68),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,a=e.XpG(),o=e.sdS(83);return e.Njj(a.openModal(i.id,o))}),e.nrm(1,"i",69),e.k0s()}}function pc(r,s){if(1&r){const t=e.RV6();e.j41(0,"button",71),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2).$implicit,a=e.XpG();return e.Njj(a.Send(i.id))}),e.nrm(2,"i",72),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"general.action.send"))}function uc(r,s){1&r&&(e.qex(0),e.DNE(1,pc,3,3,"button",70),e.bVm()),2&r&&(e.R7$(),e.Y8G("hasPermission",e.lJ4(1,lc)))}function gc(r,s){if(1&r&&(e.j41(0,"tr",60)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td"),e.EFF(10),e.k0s(),e.j41(11,"td"),e.EFF(12),e.k0s(),e.j41(13,"td"),e.EFF(14),e.nI1(15,"date"),e.k0s(),e.j41(16,"td"),e.EFF(17),e.k0s(),e.j41(18,"td")(19,"span"),e.nrm(20,"span",61),e.k0s()(),e.j41(21,"td"),e.EFF(22),e.k0s(),e.j41(23,"td"),e.DNE(24,cc,10,9,"ng-template",null,5,e.C5r),e.nrm(26,"i",62),e.DNE(27,mc,2,0,"button",63)(28,uc,2,2,"ng-container",64),e.k0s()()),2&r){const t=s.$implicit,n=s.rowIndex,i=e.sdS(25),a=e.XpG();e.R7$(2),e.JRh(n+1),e.R7$(2),e.JRh(t.id),e.R7$(2),e.SpI(" ",t.customerName," "),e.R7$(2),e.JRh(t.primaryPhoneNumber),e.R7$(2),e.JRh(t.clientGroupName),e.R7$(2),e.JRh(t.cityName),e.R7$(2),e.SpI(" ",e.i5U(15,16,t.creationTime,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(3),e.JRh(t.creatorName),e.R7$(2),e.ZvI("badge ",a.getStatus(t.status),""),e.R7$(),e.FS9("translate","sales.salesOrder."+t.statusValue),e.R7$(2),e.JRh(t.notes),e.R7$(4),e.Y8G("ngbTooltip",i),e.R7$(),e.Y8G("hasPermission",e.lJ4(19,oc)),e.R7$(),e.Y8G("ngIf",50==t.requestPersonStatus)}}function _c(r,s){1&r&&(e.j41(0,"div",73),e.EFF(1," general.table.noData"),e.k0s())}function hc(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",74)(1,"div",75),e.nrm(2,"ngb-pagination-info",76),e.j41(3,"table-length",77),e.bIt("lengthChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.ListItemChange(i))}),e.k0s()(),e.j41(4,"div",78)(5,"ngb-pagination",79),e.bIt("pageChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.pageChanged(i))}),e.mxI("pageChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.pagination.pageNumber,i)||(a.pagination.pageNumber=i),e.Njj(i)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function fc(r,s){1&r&&(e.j41(0,"span",102),e.EFF(1,"general.action.register "),e.k0s())}function bc(r,s){1&r&&(e.j41(0,"span",102),e.EFF(1,"general.action.edit "),e.k0s())}function vc(r,s){1&r&&(e.j41(0,"div",103),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function Sc(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",80)(1,"div",81)(2,"h4",82),e.DNE(3,fc,2,0,"span",83)(4,bc,2,0,"span",83),e.j41(5,"span",84),e.EFF(6),e.k0s()(),e.j41(7,"button",85),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss("Cross click"))}),e.k0s()(),e.j41(8,"div",86),e.nrm(9,"ngx-ui-loader",87),e.j41(10,"form",88,6),e.bIt("submit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.OnSubmit())}),e.j41(12,"div",89)(13,"label",90),e.EFF(14,"sales.clientCollection.clientName"),e.k0s(),e.j41(15,"ng-select",91),e.bIt("scrollToEnd",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.scrollClient())}),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.clientId,i)||(a.form.clientId=i),e.Njj(i)}),e.k0s()(),e.j41(16,"div",92)(17,"label",93),e.EFF(18,"sales.clientCollection.cost"),e.k0s(),e.j41(19,"input",94,7),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.cost,i)||(a.form.cost=i),e.Njj(i)}),e.k0s(),e.DNE(21,vc,2,0,"div",95),e.k0s(),e.j41(22,"div",92)(23,"label",96),e.EFF(24,"sales.clientCollection.notes"),e.k0s(),e.j41(25,"textarea",97,8),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.notes,i)||(a.form.notes=i),e.Njj(i)}),e.k0s()(),e.j41(27,"div",98)(28,"button",99),e.nrm(29,"i",100)(30,"span",101),e.k0s()()()()()}if(2&r){const t=e.sdS(11),n=e.sdS(20),i=e.XpG();e.R7$(3),e.Y8G("ngIf",!i.isEditForm),e.R7$(),e.Y8G("ngIf",i.isEditForm),e.R7$(2),e.JRh(i.titleOperation),e.R7$(3),e.Y8G("hasProgressBar",!1)("fgsType",i.loaderOperationShap)("loaderId",i.operationLoader),e.R7$(6),e.Y8G("virtualScroll",!0)("items",i.clients)("typeahead",i.searchClient)("loading",i.loading)("multiple",!1),e.R50("ngModel",i.form.clientId),e.R7$(4),e.R50("ngModel",i.form.cost),e.R7$(2),e.Y8G("ngIf",n.invalid&&n.touched),e.R7$(4),e.R50("ngModel",i.form.notes),e.R7$(3),e.Y8G("disabled",!t.valid)}}function Cc(r,s){if(1&r){const t=e.RV6();e.j41(0,"delete-modal",104),e.bIt("deleteConfirm",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.DeleteConfirmSoft())})("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}}function xc(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",89)(1,"label",109),e.EFF(2,"sales.clientCollection.cost"),e.k0s(),e.j41(3,"input",110),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG(2);return e.DH7(a.form.cost,i)||(a.form.cost=i),e.Njj(i)}),e.k0s()()}if(2&r){const t=e.XpG(2);e.R7$(3),e.R50("ngModel",t.form.cost)}}function yc(r,s){if(1&r){const t=e.RV6();e.j41(0,"div",80)(1,"div",81)(2,"h4",82)(3,"span",84),e.EFF(4),e.k0s()(),e.j41(5,"button",85),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss("Cross click"))}),e.k0s()(),e.j41(6,"div",86),e.nrm(7,"ngx-ui-loader",87),e.j41(8,"form",88,6),e.bIt("submit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.OnStatusSubmit())}),e.j41(10,"div",28)(11,"div",89)(12,"label",105),e.EFF(13,"sales.requestPersonSales.requestPersonStatus"),e.k0s(),e.j41(14,"ng-select",106),e.nI1(15,"translate"),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.form.requestPersonStatus,i)||(a.form.requestPersonStatus=i),e.Njj(i)}),e.k0s()(),e.DNE(16,xc,4,1,"div",107),e.k0s(),e.j41(17,"div",98)(18,"button",108),e.nrm(19,"i",100)(20,"span",101),e.k0s()()()()()}if(2&r){const t=e.sdS(9),n=e.XpG();e.R7$(4),e.JRh(n.titleOperation),e.R7$(3),e.Y8G("hasProgressBar",!1)("fgsType",n.loaderOperationShap)("loaderId",n.operationLoader),e.R7$(7),e.FS9("placeholder",e.bMT(15,10,"sales.requestPersonSales.requestPersonStatus")),e.Y8G("items",n.status)("multiple",!1),e.R50("ngModel",n.form.requestPersonStatus),e.R7$(2),e.Y8G("ngIf",30==n.form.requestPersonStatus),e.R7$(2),e.Y8G("disabled",!t.valid)}}function Ic(r,s){if(1&r){const t=e.RV6();e.j41(0,"client-summary",111),e.bIt("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("clientId",t.operationId)}}const kc=[{path:"salesman-orders",component:nd,data:{permission:["visitPlan.view"]}},{path:"sales-requests",component:ac,canActivate:[Q.g],data:{permission:["salesRequest.view"]}},{path:"visit-plans",component:tl,data:{permission:["visitPlan.view"]}},{path:"visit-plans/register",component:We,canActivate:[Q.g],data:{permission:["visitPlan.register"]}},{path:"visit-plan-edit/:id",component:We,resolve:{data:cl},canActivate:[Q.g],data:{permission:["visitPlan.edit"]}},{path:"sales-orders",component:Qe,canActivate:[Q.g],data:{permission:["salesOrder.view"]}},{path:"sales-order-store",component:Xo,canActivate:[Q.g],data:{permission:["salesOrderStore.view"]}},{path:"sales-order",component:Qe,canActivate:[Q.g],data:{permission:["salesOrder.view"]}},{path:"setting",component:yn,canActivate:[Q.g],data:{permission:["salesSetting.view"]}},{path:"new",component:ci},{path:"sales-invoices",component:Kn,resolve:{data:er},canActivate:[Q.g],data:{permission:["salesInvoices.view"]}},{path:"Client-Collections",component:Cr,resolve:{data:ma},canActivate:[Q.g],data:{permission:["clientCollection.view"]}},{path:"Requests-Limit",component:Br,resolve:{data:$a},canActivate:[Q.g],data:{permission:["requestPersonSales.view"]}},{path:"open-customer-requests",component:(()=>{class r extends X.w{constructor(t,n,i,a,o,l,h,x,y,I,j,T){super(t,n,h,i,a,o,l),this.baseService=i,this.router=x,this.excelService=I,this.clientService=j,this.employeeService=T,this.title="approvals.customerRequest.title",this.titleOperation="approvals.customerRequest.titleOperation",this.searchForm={},this.isResolveList=!0,this.countLoad=2,this.clientParam={pageSize:50,pageNumber:1,search:"",clientId:null},this.clients=[],this.loading=!1,this.searchClient=new ne.B,this.status=[],this.requestStatus={all:0,pending:0,underReview:0,accept:0,reject:0},this.option={startVal:0,useEasing:!0,duration:2,decimalPlaces:0},this.salesPersons=[],this.setDates=(b,C,O)=>{if(b?.from||b?.to){const k=b.to||b.from;this.pagination[C]=this.datePipe.transform(b.from||b.to,"yyyy-MM-ddT00:00:00"),this.pagination[O]=this.datePipe.transform(k,"yyyy-MM-ddT23:59:59.999")}else this.pagination[C]=null,this.pagination[O]=null},this.configRoute(),this.GetSalesPersons()}ngOnInitMore(){this.GetRequestCount(),this.searchClient.pipe((0,ve.B)(300),(0,Se.F)(),(0,ae.n)(t=>this.loadClient(t))).subscribe(),this.GetRequestLookups()}GetSalesPersons(){this.employeeService.GetAllByType(9).subscribe(t=>{this.salesPersons=t.data},t=>{console.log(t)})}GetRequestCount(){this.baseService.GetRequestCount().pipe((0,m.Q)(this.notifier)).subscribe(t=>{this.requestStatus=t.data})}GetRequestLookups(){this.baseService.GetRequestLookups().pipe((0,m.Q)(this.notifier)).subscribe(t=>{let n=t.data.status;n.forEach(i=>{i.name=this.getTranslationText("sales.salesOrder."+i.name)}),this.status=n})}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader("allLoader"),this.setDates(t.creationDates,"dateFrom","dateTo"),this.loadentities()}loadClient(t){return this.loading=!0,""==t||null==t?(this.loading=!1,(0,ge.of)([])):this.getClientDropdwon(t)}getClientDropdwon(t=""){return this.clientParam.search=t,this.clientParam.clientId=null,this.clientParam.pageNumber=1,this.clientService.GetClientSearch(this.clientParam).pipe((0,ae.n)(n=>(this.clients=n.data,this.loading=!1,[])),(0,m.Q)(this.notifier))}mapForm(t){return{...t}}mapRegisterForm(t){let n={...t};return n.id=0,n}OnSearch(t){this.ngxLoader.startLoader(u.a7),this.loadentities()}configRoute(){}EditModel(t,n,i="md"){this.isEditForm=!0,this.baseService.getById(t).pipe((0,m.Q)(this.notifier)).subscribe(a=>{a.success?(this.clientParam.clientId=a.data.clientId,this.clientParam.search="",this.clientService.GetClientSearch(this.clientParam).pipe((0,m.Q)(this.notifier)).subscribe(o=>{this.clients=o.data}),this.form=a.data):this.alertService.error("general.message."+a.message),this.modalService.open(n,{centered:!0,size:i})},a=>{this.alertService.error()})}mapExcel(){let t=[];return this.entities?.forEach(n=>{t.push({nameAr:n.nameAr,nameEn:n.nameEn,isActive:this.getTranslationText("general.table.active"),notes:n.notes})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.getTranslationText(this.title),[])}editEntity(){let t=this.mapForm(this.form);this.baseService.editPut(t.id,t).pipe((0,v.O)(),(0,R.c)(this.mainDelay),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(n=>{n.success?this.submitFunished():this.alertService.error("general.message."+n.message)},n=>{this.alertService.error("general.message."+n)})}scrollClient(){this.clientParam.pageNumber=this.clientParam.pageNumber+1,this.clientService.GetClientSearch(this.clientParam).subscribe(t=>{this.clients=[...this.clients,...t.data]})}getStatus(t){return 10==t||20==t?"bg-warning-subtle text-warning":30==t?"bg-success-subtle text-success":40==t?"bg-danger-subtle text-danger":"bg-warning-subtle text-warning"}OnStatusSubmit(){}onStatusSelect(t){this.pagination.status=0==t?null:t,this.loadentities()}Send(t){this.baseService.Send(t).pipe((0,v.O)(),(0,R.c)(this.mainDelay),(0,S.Z)(),(0,m.Q)(this.notifier),(0,f.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(n=>{n.success?this.submitFunished():this.alertService.error("general.message."+n.message)},n=>{this.alertService.error("general.message."+n)})}goNew(){this.router.navigateByUrl("/approvals/request-new-customer")}static{this.\u0275fac=function(n){return new(n||r)(e.rXU(M.nX),e.rXU(g.c$),e.rXU(Ke.T),e.rXU(E.u),e.rXU(p.vh),e.rXU(w.eD),e.rXU(_.Bq),e.rXU(M.Ix),e.rXU(e.gRc),e.rXU(H.V),e.rXU(oe.X),e.rXU(K.O))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-customer-request-list"]],features:[e.Vt3],decls:86,vars:44,consts:[["tableMaster",""],["operation",""],["deleteModal",""],["operationStatus",""],["ClientInfo",""],["tooltipContent",""],["formEntity","ngForm"],["cost","ngModel"],["notes","ngModel"],[3,"title","breadcrumbItems"],[1,"row","justify-content-around"],[1,"col-12","col-md-3","cursor-pointer"],[1,"card","card-animate",3,"click"],[1,"card-body"],[1,"d-flex","justify-content-between"],["translate","sales.salesOrder.all",1,"fw-medium","text-muted","mb-0"],[1,"mt-4","ff-secondary","fw-semibold"],[1,"counter-value",3,"countUp","options"],[1,"avatar-sm","flex-shrink-0"],[1,"avatar-title","bg-primary-subtle","text-primary","rounded-circle","fs-4"],[1,"ri-ticket-2-line"],[1,"col-12","col-md-2","cursor-pointer"],["translate","sales.salesOrder.UnderReview",1,"fw-medium","text-muted","mb-0"],[1,"avatar-title","bg-warning-subtle","text-warning","rounded-circle","fs-4"],["translate","sales.salesOrder.Accept",1,"fw-medium","text-muted","mb-0"],[1,"avatar-title","bg-success-subtle","text-success","rounded-circle","fs-4"],["translate","sales.salesOrder.Reject",1,"fw-medium","text-muted","mb-0"],[1,"avatar-title","bg-danger-subtle","text-danger","rounded-circle","fs-4"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],[3,"reset","search","exportXlsx","addNew","addPermission","totalItems","title"],["control",""],[1,"col-md-3","mb-2"],[1,"search-box"],["type","search","id","name","name","name",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],[1,"col-12","col-md-3","mb-2"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"col-12","col-md-2","mb-2"],["name","name","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["translate","",2,"width",".5%"],["pSortableColumn","id","translate","",2,"width","5%"],[1,"ri-expand-up-down-line"],["pSortableColumn","clientId","translate","",2,"width","15%"],["pSortableColumn","primaryPhoneNumber","translate","",2,"width","10%"],["pSortableColumn","clientGroupId","translate","",2,"width","10%"],["pSortableColumn","cityId","translate","",2,"width","10%"],["pSortableColumn","creationTime","translate","",2,"width","12%"],["translate","",2,"width","8%"],["pSortableColumn","requestPersonStatus","translate","",2,"width","8%"],["pSortableColumn","notes","translate","",2,"width","10%"],["translate","",2,"width","15%"],[1,"fs-5"],[3,"translate"],["tooltipPosition","top",1,"mdi","mdi-cog-outline","text-muted","fs-16","align-middle","me-1",3,"ngbTooltip"],["class","btn btn-sm btn-soft-warning edit-list mx-2 ",3,"click",4,"hasPermission"],[4,"ngIf"],[1,"ri-history-fill","text-warning"],[1,"ri-history-fill","text-danger"],[1,"ri-user-location-fill","text-primary"],[1,"btn","btn-sm","btn-soft-warning","edit-list","mx-2",3,"click"],[1,"ri-exchange-line","align-bottom","mx-1"],["class","btn btn-sm btn-warning edit-list mx-1","tooltipPosition","top",3,"pTooltip","click",4,"hasPermission"],["tooltipPosition","top",1,"btn","btn-sm","btn-warning","edit-list","mx-1",3,"click","pTooltip"],[1,"ri-send-plane-fill","align-bottom"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["class","fw-bold fs-4","translate","",4,"ngIf"],["translate",""],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"hasProgressBar","fgsType","loaderId"],[3,"submit"],[1,"mb-3"],["for","nameAr","translate","",1,"required","fw-bold","form-label"],["bindLabel","displayName","bindValue","id","name","clientId","required","",3,"scrollToEnd","ngModelChange","virtualScroll","items","typeahead","loading","multiple","ngModel"],[1,"mb-2"],["for","cost","translate","",1,"fw-bold","form-label"],["InputTirmFilter","","name","cost","type","text","id","cost",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["class","text-danger text-center  ","translate","",4,"ngIf"],["for","notes","translate","",1,"fw-bold","form-label"],["rows","2","InputTirmFilter","","name","notes","type","text","id","notes",1,"form-control","fs-6",3,"ngModelChange","ngModel"],[1,"text-center"],["type","submit","type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],["translate","",1,"fw-bold","fs-4"],["translate","",1,"text-danger","text-center"],[3,"deleteConfirm","dismiss"],["for","status","translate","",1,"required","fw-bold","form-label"],["name","name","bindValue","id","bindLabel","name","required","",3,"ngModelChange","placeholder","items","multiple","ngModel"],["class","mb-3",4,"ngIf"],["type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],["for","cost","translate","",1,"required","fw-bold","form-label"],["type","numbers","id","cost","name","cost",1,"form-control",3,"ngModelChange","ngModel"],[3,"dismiss","clientId"]],template:function(n,i){if(1&n){const a=e.RV6();e.nrm(0,"app-breadcrumbs",9),e.nI1(1,"translate"),e.j41(2,"div",10)(3,"div",11)(4,"div",12),e.bIt("click",function(){return e.eBV(a),e.Njj(i.onStatusSelect(0))}),e.j41(5,"div",13)(6,"div",14)(7,"div"),e.nrm(8,"p",15),e.j41(9,"h2",16),e.nrm(10,"span",17),e.k0s()(),e.j41(11,"div")(12,"div",18)(13,"span",19),e.nrm(14,"i",20),e.k0s()()()()()()(),e.j41(15,"div",21)(16,"div",12),e.bIt("click",function(){return e.eBV(a),e.Njj(i.onStatusSelect(20))}),e.j41(17,"div",13)(18,"div",14)(19,"div"),e.nrm(20,"p",22),e.j41(21,"h2",16),e.nrm(22,"span",17),e.k0s()(),e.j41(23,"div")(24,"div",18)(25,"span",23),e.nrm(26,"i",20),e.k0s()()()()()()(),e.j41(27,"div",21)(28,"div",12),e.bIt("click",function(){return e.eBV(a),e.Njj(i.onStatusSelect(30))}),e.j41(29,"div",13)(30,"div",14)(31,"div"),e.nrm(32,"p",24),e.j41(33,"h2",16),e.nrm(34,"span",17),e.k0s()(),e.j41(35,"div")(36,"div",18)(37,"span",25),e.nrm(38,"i",20),e.k0s()()()()()()(),e.j41(39,"div",21)(40,"div",12),e.bIt("click",function(){return e.eBV(a),e.Njj(i.onStatusSelect(40))}),e.j41(41,"div",13)(42,"div",14)(43,"div"),e.nrm(44,"p",26),e.j41(45,"h2",16),e.nrm(46,"span",17),e.k0s()(),e.j41(47,"div")(48,"div",18)(49,"span",27),e.nrm(50,"i",20),e.k0s()()()()()()()(),e.j41(51,"div",28)(52,"div",29)(53,"div",30)(54,"base-filter",31),e.bIt("reset",function(){return e.eBV(a),e.Njj(i.onReset())})("search",function(){return e.eBV(a),e.Njj(i.onSearch())})("exportXlsx",function(){return e.eBV(a),e.Njj(i.onExportXlsx())})("addNew",function(){return e.eBV(a),e.Njj(i.goNew())}),e.qex(55,32),e.j41(56,"div",33)(57,"div",34)(58,"input",35),e.nI1(59,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.name,l)||(i.pagination.name=l),e.Njj(l)}),e.k0s(),e.nrm(60,"i",36),e.k0s()(),e.j41(61,"div",37)(62,"input",38),e.nI1(63,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.searchForm.creationDates,l)||(i.searchForm.creationDates=l),e.Njj(l)}),e.k0s()(),e.j41(64,"div",39)(65,"ng-select",40),e.nI1(66,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.salesPersonId,l)||(i.pagination.salesPersonId=l),e.Njj(l)}),e.k0s()(),e.j41(67,"div",39)(68,"ng-select",40),e.nI1(69,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(i.pagination.requestPersonStatus,l)||(i.pagination.requestPersonStatus=l),e.Njj(l)}),e.k0s()(),e.bVm(),e.k0s(),e.j41(70,"div",13)(71,"div",41)(72,"p-table",42,0),e.bIt("onLazyLoad",function(l){return e.eBV(a),e.Njj(i.tableChange(l))})("selectionChange",function(l){return e.eBV(a),e.Njj(i.onSelectionChange(l))}),e.DNE(74,dc,30,0,"ng-template",43)(75,gc,29,20,"ng-template",44),e.k0s()(),e.DNE(76,_c,2,0,"div",45)(77,hc,6,8,"div",46),e.k0s()()()(),e.DNE(78,Sc,31,16,"ng-template",null,1,e.C5r)(80,Cc,1,0,"ng-template",null,2,e.C5r)(82,yc,21,12,"ng-template",null,3,e.C5r)(84,Ic,1,1,"ng-template",null,4,e.C5r)}2&n&&(e.FS9("title",e.bMT(1,33,i.title)),e.Y8G("breadcrumbItems",i.breadCrumbItems),e.R7$(10),e.Y8G("countUp",null==i.requestStatus?null:i.requestStatus.all)("options",i.option),e.R7$(12),e.Y8G("countUp",null==i.requestStatus?null:i.requestStatus.underReview)("options",i.option),e.R7$(12),e.Y8G("countUp",null==i.requestStatus?null:i.requestStatus.accept)("options",i.option),e.R7$(12),e.Y8G("countUp",null==i.requestStatus?null:i.requestStatus.reject)("options",i.option),e.R7$(8),e.Y8G("addPermission",e.lJ4(43,sc))("totalItems",i.pagination.totalItems)("title",i.title),e.R7$(4),e.FS9("placeholder",e.bMT(59,35,"general.table.name")),e.R50("ngModel",i.pagination.name),e.R7$(4),e.FS9("placeholder",e.bMT(63,37,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",i.searchForm.creationDates),e.R7$(3),e.FS9("placeholder",e.bMT(66,39,"sales.salesOrder.salsePerson")),e.Y8G("items",i.salesPersons)("multiple",!1),e.R50("ngModel",i.pagination.salesPersonId),e.R7$(3),e.FS9("placeholder",e.bMT(69,41,"sales.requestPersonSales.requestPersonStatus")),e.Y8G("items",i.status)("multiple",!1),e.R50("ngModel",i.pagination.requestPersonStatus),e.R7$(4),e.Y8G("value",i.entities)("rows",i.pagination.pageSize)("lazy",!0)("totalRecords",i.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",i.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",i.pagination.totalItems>0))},dependencies:[p.bT,d.qT,d.me,d.BC,d.cb,d.YS,d.vS,d.cV,_.s5,G.kL,te.G,_e.m,W.b,z.w,J.p,Z.g,ce.x,g.Mm,V.XI,q.Ei,V.Tg,w.Cv,P.vr,_.md,B.m,A.p,de.m,p.vh,g.D9],encapsulation:2})}}return r})(),resolve:{data:(()=>{class r extends je.E{constructor(t,n,i){super(t,n,i)}static{this.\u0275fac=function(n){return new(n||r)(e.KVO(M.Ix),e.KVO(Ke.T),e.KVO(E.u))}}static{this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})()},data:{permission:["customerRequest.view"]}},{path:"Prices-List",component:ca,resolve:{data:Ba},canActivate:[Q.g],data:{permission:["priceList.view"]}},{path:"PriceListItems",component:Ye,canActivate:[Q.g],data:{permission:["priceList.view"]}},{path:"PriceListItems/:id",component:Ye,canActivate:[Q.g],data:{permission:["priceList.view"]}},{path:"assign-truck-orders",component:Ma,canActivate:[Q.g],data:{permission:["assignTruckOrder.view"]}},{path:"visits",component:_l,data:{permission:["assignTruckOrder.view"]}},{path:"startVisits",component:jl,data:{permission:["assignTruckOrder.view"]}},{path:"dashboard",component:Tl,data:{permission:["assignTruckOrder.view"]}},{path:"details",component:rd,data:{permission:["assignTruckOrder.view"]}},{path:"mange",component:md,data:{permission:["assignTruckOrder.view"]}}];let wc=(()=>{class r{static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275mod=e.$C({type:r})}static{this.\u0275inj=e.G2t({imports:[M.iI.forChild(kc),M.iI]})}}return r})();var Mc=c(71144),Oc=c(81141),Rc=c(41198);c(79284),c(16229),c(12822),c(50204);let lp=(()=>{class r{constructor(){(0,N.eV)(D().loadAnimation)}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275mod=e.$C({type:r})}static{this.\u0275inj=e.G2t({imports:[p.MD,d.YN,_.zH,_.Pv,_.c9,G.ND,te.r,wc,ie.G,g.h.forChild(),V.bG,it.q4,me.H_,_.c9,w.th,P.MQ,_.n8,Mc.j,_._f,de.S,Ee.U,Oc.tm,Rc.TV,d.X1]})}}return r})()}}]);