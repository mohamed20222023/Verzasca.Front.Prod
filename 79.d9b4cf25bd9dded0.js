(self.webpackChunkvelzon=self.webpackChunkvelzon||[]).push([[79],{12822:(Mt,tt,x)=>{"use strict";x.d(tt,{l:()=>Ut});var k=x(67569),g=x(45312),F=x(54438),Ce=x(21626);let Ut=(()=>{class ce extends k.d{constructor(Ie){super(Ie,g.c.apiUrl+"Channel/")}static{this.\u0275fac=function(on){return new(on||ce)(F.KVO(Ce.Qq))}}static{this.\u0275prov=F.jDH({token:ce,factory:ce.\u0275fac,providedIn:"root"})}}return ce})()},16229:(Mt,tt,x)=>{"use strict";x.d(tt,{m:()=>Ut});var k=x(67569),g=x(45312),F=x(54438),Ce=x(21626);let Ut=(()=>{class ce extends k.d{constructor(Ie){super(Ie,g.c.apiUrl+"District/")}getByCityId(Ie){return this.http.get(this.baseUrl+"getByCityId/"+Ie)}static{this.\u0275fac=function(on){return new(on||ce)(F.KVO(Ce.Qq))}}static{this.\u0275prov=F.jDH({token:ce,factory:ce.\u0275fac,providedIn:"root"})}}return ce})()},96402:(Mt,tt,x)=>{"use strict";x.d(tt,{N:()=>Ut});var k=x(67569),g=x(45312),F=x(54438),Ce=x(21626);let Ut=(()=>{class ce extends k.d{constructor(Ie){super(Ie,g.c.apiUrl+"Service/")}deleteImage(Ie){return this.http.delete(this.baseUrl+"deleteImage/"+Ie,this.httpOptions)}deleteUnit(Ie){return this.http.delete(this.baseUrl+"deleteUnit/"+Ie,this.httpOptions)}getItemDropDown(){return this.http.get(this.baseUrl+"GetItemDropDown")}servicesByCategory(Ie){return this.http.post(this.baseUrl+"servicesByCategory",Ie)}static{this.\u0275fac=function(on){return new(on||ce)(F.KVO(Ce.Qq))}}static{this.\u0275prov=F.jDH({token:ce,factory:ce.\u0275fac,providedIn:"root"})}}return ce})()},67079:(Mt,tt,x)=>{"use strict";x.r(tt),x.d(tt,{SalesModule:()=>Qd});var k=x(60177),g=x(89417),F=x(69005),Ce=x(91022),Ut=x(70255),ce=x(63789),Aa=x(98982),Ie=x.n(Aa),on=x(83289),O=x(8147),Y=x(45286),Qr=x(65430),Yt=x(41631),X=x(1530),fe=x(72510),A=x(51188),e=x(54438),ut=x(21413),R=x(56977),me=x(37021),se=x(35335),pe=x(45236),ie=x(70980),qt=x(99437),fn=x(18810),N=x(36158),Ai=x(84412),Qt=x(67569),nt=x(45312),Ot=x(21626);let Ge=(()=>{class a extends Qt.d{constructor(t){super(t,nt.c.apiUrl+"OfferOrder/"),this.checkValidationSource=new Ai.t(!0),this.checkValidation=this.checkValidationSource.asObservable(),this.GetOrderCountSource=new Ai.t(!0),this.GetOrderCount=this.GetOrderCountSource.asObservable(),this.removeServiceQ=new Ai.t(0),this.removeService=this.removeServiceQ.asObservable(),this.discountTypes=[{id:1,name:"Cost"},{id:2,name:"Precentage"}],this.salesOrderForm={id:null,clientLocationId:0,clientVisitDate:new Date,clientId:0,notes:"",items:[],discountAmount:0,discountAmountAdd:0,total:0,agent:{},orderLocations:{},discountType:1,discountTypeAdd:1,isPrecentage:!0,isPrecentageAdd:!1,totalAddDiscountType:0,totalAddDiscount:0,serviceCategoryCode:[]}}getLookups(){return this.http.get(this.baseUrl+"Lookups")}changStatus(t){return this.http.put(this.baseUrl+"ChangeStatus/",t)}UpdateQuantity(t){return this.http.put(this.baseUrl+"UpdateQuantity",t)}updateTruck(t){return this.http.put(this.baseUrl+"updateTruck",t)}GetTrucks(t){return this.http.post(this.baseUrl+"GetTrucks/",t)}CancelOfferOrder(t){return this.http.post(this.baseUrl+"CancelOfferOrder",t)}GetOfferOrderCount(){return this.http.get(this.baseUrl+"OfferOrderCount")}GetAssignSalesOrder(){return this.http.get(this.baseUrl+"GetAssignSalesOrder")}GetOrderDetail(t){return this.http.get(this.baseUrl+"GetOrderDetail/"+t)}RequestChangeQuantity(t){return this.http.post(this.baseUrl+"RequestChangeQuantity/",t)}static{this.\u0275fac=function(s){return new(s||a)(e.KVO(Ot.Qq))}}static{this.\u0275prov=e.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})(),Ui=(()=>{class a extends Qt.d{constructor(t){super(t,nt.c.apiUrl+"RequestPersonSales/")}UpdateLimit(t){return this.http.post(this.baseUrl+"UpdateLimit",t)}GetRequestLookups(){return this.http.get(this.baseUrl+"GetRequestLookups")}static{this.\u0275fac=function(s){return new(s||a)(e.KVO(Ot.Qq))}}static{this.\u0275prov=e.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})();var le=x(3888),Se=x(29935),Be=x(94575),gt=x(38542),ze=x(70152),Kn=x(23294),zt=x(25558),Zn=x(7673),it=x(75922);function ei(a,u){if(1&a&&(e.j41(0,"div",23),e.nrm(1,"i",24),e.EFF(2),e.k0s()),2&a){const t=e.XpG(2);e.R7$(2),e.SpI(" ",t.clientInfo.alertMessage," ")}}function Ua(a,u){if(1&a&&(e.j41(0,"div",8)(1,"div",11)(2,"div",12)(3,"div",13),e.nrm(4,"i",14),e.k0s(),e.j41(5,"div",15)(6,"div"),e.nrm(7,"strong",16),e.EFF(8),e.k0s(),e.j41(9,"div"),e.nrm(10,"strong",17),e.EFF(11),e.k0s(),e.j41(12,"div"),e.nrm(13,"strong",18),e.EFF(14),e.k0s()(),e.j41(15,"div",15)(16,"div"),e.nrm(17,"strong",19),e.EFF(18),e.k0s(),e.j41(19,"div"),e.nrm(20,"strong",20),e.EFF(21),e.k0s(),e.j41(22,"div"),e.nrm(23,"strong",21),e.EFF(24),e.k0s()()()(),e.DNE(25,ei,3,1,"div",22),e.k0s()),2&a){const t=e.XpG();e.R7$(8),e.SpI(" : ",t.clientInfo.name,""),e.R7$(3),e.SpI(" : ",t.clientInfo.vatNumber,""),e.R7$(3),e.SpI(" : ",t.clientInfo.mobile,""),e.R7$(4),e.SpI(" : ",t.clientInfo.creditLimit,""),e.R7$(3),e.SpI(" : ",t.clientInfo.nationalAddress,""),e.R7$(3),e.SpI(" : ",t.clientInfo.clientGroupName,""),e.R7$(),e.Y8G("ngIf",!1)}}let Rn=(()=>{class a{constructor(t,s,i){this.clientService=t,this.offerOrder=s,this.route=i,this.form={},this.keySelected="",this.notifier=new ut.B,this.mainDelay=100,this.loaderSearchShap=N.cX,this.loaderOperationShap=N.$$,this.operationLoader=N.ZW,this.isEditForm=!1,this.showEdit=!1,this.clients=[],this.paymentTypes=[],this.isClientFound=!0,this.errorMessage="",this.setFormByOrderCode=new e.bkB,this.calacTotal=new e.bkB,this.isOrderEdit=!0,this.loading=!1,this.searchClient=new ut.B,this.clientParam={pageSize:50,pageNumber:1,search:""}}ngOnInit(){this.form=this.offerOrder.salesOrderForm,this.form.clientId&&(this.getClientSearchDropdwon(this.form.clientId),this.getClientInfo(this.form.clientId)),this.searchClient.pipe((0,ze.B)(300),(0,Kn.F)(),(0,zt.n)(t=>this.loadClient(t))).subscribe()}loadClient(t){return this.loading=!0,""==t||null==t?(this.loading=!1,(0,Zn.of)([])):this.getClientDropdwon(t)}getClientDropdwon(t){return this.clientParam.search=t,this.clientParam.pageNumber=1,this.clientService.GetClientSearch(this.clientParam).pipe((0,zt.n)(s=>(this.clients=s.data,this.loading=!1,[])))}getClientSearchDropdwon(t){this.clientParam.search=t,this.clientParam.pageNumber=1,this.clientService.GetClientSearch(this.clientParam).subscribe(s=>{this.clients=s.data})}scrollClient(){this.clientParam.pageNumber=this.clientParam.pageNumber+1,this.clientService.GetClientSearch(this.clientParam).subscribe(t=>{this.clients=[...this.clients,...t.data]})}getClientInfo(t){null!=t&&(this.offerOrder.salesOrderForm.clientId=t,this.offerOrder.salesOrderForm.clientVisitDate=this.form.clientVisitDate,this.clientService.GetClientInfo(t).subscribe(s=>{this.form.creditLimit=s.data.creditLimit,this.offerOrder.checkValidationSource.next(!0),this.clientInfo=s.data}))}ngOnDestroy(){}static{this.\u0275fac=function(s){return new(s||a)(e.rXU(it.X),e.rXU(Ge),e.rXU(A.nX))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["app-client-info-salse"]],inputs:{form:"form",clients:"clients",isOrderEdit:"isOrderEdit"},outputs:{setFormByOrderCode:"setFormByOrderCode",calacTotal:"calacTotal"},decls:16,vars:17,consts:[[1,"row","mt-4"],[1,"col-12","col-md-8"],["for","mobile","translate","",1,"fw-bold","form-label"],["bindLabel","displayName","bindValue","id","required","",3,"scrollToEnd","ngModelChange","virtualScroll","items","typeahead","loading","multiple","ngModel","disabled"],[1,"col-12","col-md-4"],["for","name","translate","",1,"fw-bold","form-label"],["name","clientVisitDate","type","text","mwlFlatpickr","","altFormat","d-m-Y H:i",1,"form-control","flatpickr-input",3,"ngModelChange","ngModel","altInput","enableTime","convertModelValue","dateFormat"],["class","row",4,"ngIf"],[1,"row"],[1,"col-12","mb-3"],["rows","2","name","terms","type","text",1,"form-control",3,"ngModelChange","placeholder","ngModel"],["role","alert",1,"col-12","mt-2","alert","alert-primary","alert-dismissible","material-shadow","alert-label-icon","rounded-label","fade","show"],[1,"row","align-items-center"],[1,"col-12","col-md-1"],[1,"ri-user-smile-line","label-icon"],[1,"col-12","col-md-5"],["translate","sales.salesOrder.clientName"],["translate","sales.salesOrder.vatNumber"],["translate","sales.salesOrder.mobile"],["translate","sales.salesOrder.creditLimit"],["translate","sales.salesOrder.nationalAddress"],["translate","sales.salesOrder.clientGroupName"],["class","alert alert-danger alert-border-left alert-dismissible material-shadow fade show","role","alert",4,"ngIf"],["role","alert",1,"alert","alert-danger","alert-border-left","alert-dismissible","material-shadow","fade","show"],[1,"ri-alert-line","me-3","align-middle"]],template:function(s,i){1&s&&(e.j41(0,"div",0)(1,"div",1)(2,"label",2),e.EFF(3,"orderManagement.order.clientSearch"),e.k0s(),e.j41(4,"ng-select",3),e.bIt("scrollToEnd",function(){return i.scrollClient()}),e.mxI("ngModelChange",function(m){return e.DH7(i.form.clientId,m)||(i.form.clientId=m),m}),e.bIt("ngModelChange",function(m){return i.getClientInfo(m)}),e.k0s()(),e.j41(5,"div",4)(6,"label",5),e.EFF(7,"sales.salesOrder.acutalVisitDate"),e.k0s(),e.j41(8,"input",6),e.mxI("ngModelChange",function(m){return e.DH7(i.form.clientVisitDate,m)||(i.form.clientVisitDate=m),m}),e.k0s()()(),e.DNE(9,Ua,26,7,"div",7),e.j41(10,"div",8)(11,"div",9)(12,"label",5),e.EFF(13,"sales.salesOrder.terms"),e.k0s(),e.j41(14,"textarea",10),e.nI1(15,"translate"),e.mxI("ngModelChange",function(m){return e.DH7(i.form.terms,m)||(i.form.terms=m),m}),e.k0s()()()),2&s&&(e.R7$(4),e.Y8G("virtualScroll",!0)("items",i.clients)("typeahead",i.searchClient)("loading",i.loading)("multiple",!1),e.R50("ngModel",i.form.clientId),e.Y8G("disabled",!i.isOrderEdit),e.R7$(4),e.R50("ngModel",i.form.clientVisitDate),e.Y8G("altInput",!0)("enableTime",!0)("convertModelValue",!0)("dateFormat","d-m-Y H:i"),e.R7$(),e.Y8G("ngIf",i.clientInfo),e.R7$(5),e.Y8G("placeholder",e.bMT(15,15,"sales.salesOrder.termsPlaceholder")),e.R50("ngModel",i.form.terms))},dependencies:[k.bT,g.me,g.BC,g.YS,g.vS,O.Mm,fe.vr,Ce.kL,O.D9],encapsulation:2})}}return a})();var Mn=x(25947),Ya=x(33121),Ue=x(12260),rt=x(15084);function zr(a,u){if(1&a){const t=e.RV6();e.qex(0),e.j41(1,"div",17)(2,"div",18)(3,"input",19),e.bIt("change",function(){const i=e.eBV(t).$implicit,l=e.XpG();return e.Njj(l.locationChange(i))}),e.k0s(),e.j41(4,"label",20)(5,"span",21),e.EFF(6),e.k0s(),e.j41(7,"span",22),e.EFF(8),e.k0s()()(),e.j41(9,"div",23)(10,"div")(11,"a",24),e.bIt("click",function(){const i=e.eBV(t).$implicit,l=e.XpG(),m=e.sdS(9);return e.Njj(l.openEditModal(i,m))}),e.nrm(12,"i",25)(13,"span",26),e.k0s()(),e.j41(14,"div")(15,"a",27),e.bIt("click",function(){const i=e.eBV(t).$implicit,l=e.XpG(),m=e.sdS(11);return e.Njj(l.confirm(i.id,m))}),e.nrm(16,"i",28)(17,"span",29),e.k0s()()()(),e.bVm()}if(2&a){const t=u.$implicit;e.R7$(3),e.Mz_("id","S",t.id,""),e.Y8G("checked",t.isSelected),e.R7$(),e.Mz_("for","S",t.id,""),e.R7$(2),e.Lme(" ",t.cityName,"- ",t.name,""),e.R7$(2),e.SpI(" ",t.address,"")}}function ht(a,u){1&a&&(e.j41(0,"span",58),e.EFF(1,"general.action.register "),e.k0s())}function On(a,u){1&a&&(e.j41(0,"span",58),e.EFF(1,"general.action.edit "),e.k0s())}function qa(a,u){1&a&&(e.j41(0,"div",59),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function wt(a,u){1&a&&(e.j41(0,"div",59),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function Hr(a,u){if(1&a){const t=e.RV6();e.j41(0,"div",30)(1,"div",31)(2,"h4",32),e.DNE(3,ht,2,0,"span",33)(4,On,2,0,"span",33),e.k0s(),e.j41(5,"button",34),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss("Cross click"))}),e.k0s()(),e.j41(6,"div",35),e.nrm(7,"ngx-ui-loader",36),e.j41(8,"form",37,2),e.bIt("submit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.OnSubmit())}),e.j41(10,"div",38),e.nrm(11,"label",39),e.j41(12,"ng-select",40,3),e.nI1(14,"translate"),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.formEdit.cityCode,i)||(l.formEdit.cityCode=i),e.Njj(i)}),e.k0s()(),e.j41(15,"div",38),e.nrm(16,"label",41),e.j41(17,"input",42,4),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.formEdit.name,i)||(l.formEdit.name=i),e.Njj(i)}),e.k0s(),e.DNE(19,qa,2,0,"div",43),e.k0s(),e.j41(20,"div",38),e.nrm(21,"label",44),e.j41(22,"textarea",45,5),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.formEdit.address,i)||(l.formEdit.address=i),e.Njj(i)}),e.k0s(),e.DNE(24,wt,2,0,"div",43),e.k0s(),e.j41(25,"div",38),e.nrm(26,"label",46),e.j41(27,"input",47,6),e.bIt("change",function(i){e.eBV(t);const l=e.XpG();return e.Njj(l.onUrlChange(i))}),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.formEdit.mapURL,i)||(l.formEdit.mapURL=i),e.Njj(i)}),e.k0s()(),e.j41(29,"div",48)(30,"div",49),e.nrm(31,"label",50),e.j41(32,"input",51,7),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.formEdit.lat,i)||(l.formEdit.lat=i),e.Njj(i)}),e.k0s()(),e.j41(34,"div",49),e.nrm(35,"label",52),e.j41(36,"input",53,8),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.formEdit.lng,i)||(l.formEdit.lng=i),e.Njj(i)}),e.k0s()()(),e.j41(38,"div",54)(39,"button",55),e.nrm(40,"i",56)(41,"span",57),e.k0s()()()()()}if(2&a){const t=e.sdS(9),s=e.sdS(18),i=e.sdS(23),l=e.XpG();e.R7$(3),e.Y8G("ngIf",!l.isEditForm),e.R7$(),e.Y8G("ngIf",l.isEditForm),e.R7$(3),e.Y8G("hasProgressBar",!1)("fgsType",l.loaderOperationShap)("loaderId","locationOperation"),e.R7$(5),e.FS9("placeholder",e.bMT(14,17,"orderManagement.order.cityName")),e.R50("ngModel",l.formEdit.cityCode),e.Y8G("items",l.cities)("multiple",!1),e.R7$(5),e.R50("ngModel",l.formEdit.name),e.R7$(2),e.Y8G("ngIf",s.invalid&&s.touched),e.R7$(3),e.R50("ngModel",l.formEdit.address),e.R7$(2),e.Y8G("ngIf",i.invalid&&i.touched),e.R7$(3),e.R50("ngModel",l.formEdit.mapURL),e.R7$(5),e.R50("ngModel",l.formEdit.lat),e.R7$(4),e.R50("ngModel",l.formEdit.lng),e.R7$(3),e.Y8G("disabled",!t.valid)}}function Qa(a,u){if(1&a){const t=e.RV6();e.j41(0,"delete-modal",60),e.bIt("deleteConfirm",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.DeleteConfirm())})("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}}let _t=(()=>{class a{constructor(t,s,i,l,m,c,E,P){this.modalService=t,this.baseService=s,this.alertService=i,this.ngxLoader=l,this.whatsupService=m,this.whatsAppMessagesService=c,this.cityService=E,this.offerOrder=P,this.submitted=!1,this.form={},this.mainDelay=20,this.notifier=new ut.B,this.operationLoader=N.ZW,this.isEditForm=!1,this.loaderOperationShap=N.$$,this.isLoad=!1,this.formEdit={},this.cities=[],this.idSelected=0,this.isOrderEdit=!0,this.modalRefs={}}ngOnInit(){this.form=this.offerOrder.salesOrderForm,this.form.clientId&&this.checkLocation(),this.form.clientLocationId&&this.checkSelected(this.form.clientLocationId),this.GetCities()}confirm(t,s){this.idSelected=t,this.modalService.open(s,{centered:!0})}openModal(t){this.ngxLoader.stopLoader(this.operationLoader),this.submitted=!1,this.modalRefs=this.modalService.open(t,{size:"md",centered:!0})}openEditModal(t,s){this.submitted=!1,this.formEdit=t,this.isEditForm=!0,this.modalRefs=this.modalService.open(s,{size:"md",centered:!0})}changeActiveTab(t){this.nav.select(t)}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}registerEntity(t=!1){this.ngxLoader.startLoader("locationOperation");let s=this.mapRegisterForm(this.formEdit);s.isSend=t,this.baseService.AddLocation(s).pipe((0,me.O)(),(0,se.c)(this.mainDelay),(0,pe.Z)(),(0,R.Q)(this.notifier),(0,ie.j)(()=>this.ngxLoader.stopLoader("locationOperation")),(0,qt.W)(i=>(0,fn.$)(i))).subscribe(i=>{i.success?(this.alertService.success(),this.modalRefs.dismiss(),this.refresh()):this.alertService.error("general.message."+i.message)},i=>{this.alertService.error("general.message."+i)})}editEntity(t=!1){this.ngxLoader.startLoader("locationOperation");let s=this.mapForm(this.formEdit);s.isSend=t,this.baseService.EditLocation(s).pipe((0,me.O)(),(0,se.c)(this.mainDelay),(0,pe.Z)(),(0,R.Q)(this.notifier),(0,ie.j)(()=>this.ngxLoader.stopLoader("locationOperation"))).subscribe(i=>{i.success?(this.alertService.success(),this.modalRefs.dismiss(),this.refresh()):this.alertService.error("general.message."+i.message)},i=>{this.alertService.error("general.message."+i)})}mapForm(t){let s={...t};return s.agentCode=this.form.clientId,s.cityCode=s.cityCode,s.agentName="",s.mobile="",s.mapURL=s.mapURL,s.lat=s.lat?s.lat.toString():"",s.lng=s.lng?s.lng.toString():"",s}mapRegisterForm(t){let s={...t};return s.id=0,s.cityCode=s.cityCode,s.agentName="",s.mobile="",s.agentCode=this.form.clientId,s.mapURL=s.mapURL,s.lat=s.lat,s.lng=s.lng,s}submitFunished(){this.alertService.success(),this.modalService?.dismissAll()}OnSubmit(t=!1){this.ngxLoader.startLoader(this.operationLoader),!0===this.isEditForm?this.editEntity(t):this.registerEntity(t)}getFromClient(){this.form.agent.mobile||this.alertService.error("orderManagement.order.mustEnterNumber"),this.isLoad=!0,this.whatsupService.GetLocationFromClient(this.form.agent.mobile).pipe((0,R.Q)(this.notifier),(0,ie.j)(()=>this.isLoad=!1)).subscribe(t=>{t.success?this.alertService.success("orderManagement.order.successSendLocation"):this.alertService.error("orderManagement.order.failSendLocation")},()=>{this.alertService.error("orderManagement.order.failSendLocation")})}DeleteConfirm(){this.baseService.DeleteLocation(this.idSelected).pipe((0,me.O)(),(0,se.c)(this.mainDelay),(0,pe.Z)(),(0,R.Q)(this.notifier),(0,ie.j)(()=>this.ngxLoader.stopLoader("deleteLoader"))).subscribe(t=>{if(t.success){const s=this.form.locations.findIndex(i=>i.id===this.idSelected);-1!==s&&this.form.locations.splice(s,1),this.alertService.success(),this.modalService.dismissAll()}else this.alertService.error("general.message."+t)},()=>{this.alertService.error()})}refresh(){this.checkLocation()}locationChange(t){this.form.clientLocationId=t.id;let s=this.form.locations.find(i=>i.id==t.id);s.isSelected=!s.isSelected,this.offerOrder.salesOrderForm.clientLocationId=this.form.clientLocationId}checkSelected(t){this.offerOrder.checkValidationSource.next(!0),this.form.locations.find(i=>i.id==t).isSelected=!0}checkLocation(){this.offerOrder.checkValidationSource.next(!0),this.baseService.GetClientLocations(this.form.clientId).subscribe(t=>{this.form.locations=t.data})}ngOnDestroy(){this.notifier.next(),this.notifier.complete()}onUrlChange(t){let l=new URL(t.target.value).searchParams.get("q");if(l){let[m,c]=l.split(",").map(Number);this.formEdit.lat=m,this.formEdit.lng=c}}static{this.\u0275fac=function(s){return new(s||a)(e.rXU(F.Bq),e.rXU(it.X),e.rXU(le.u),e.rXU(X.eD),e.rXU(Mn.A),e.rXU(Ya.Q),e.rXU(Ue.h),e.rXU(Ge))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["client-location-salse"]],viewQuery:function(s,i){if(1&s&&e.GBs(F.X9,5),2&s){let l;e.mGM(l=e.lsd())&&(i.nav=l.first)}},inputs:{form:"form",isOrderEdit:"isOrderEdit"},features:[e.Jv_([F.X9])],decls:12,vars:2,consts:[["content",""],["deleteModal",""],["formEntity","ngForm"],["cityCode","ngModel"],["name","ngModel"],["address","ngModel"],["mapURL","ngModel"],["lat","ngModel"],["lng","ngModel"],[1,"mt-4"],[1,"d-flex","align-items-center","mb-2"],[1,"flex-grow-1"],["translate","orderManagement.order.savedAddress",1,"fs-15","mb-0"],[1,"flex-shrink-0"],["type","button","translate","orderManagement.order.sendToClient",1,"btn","btn-sm","btn-success","mb-1",3,"click","disabled"],[1,"row","gy-3"],[4,"ngFor","ngForOf"],[1,"col-lg-4","col-sm-6"],[1,"form-check","card-radio"],["name","location","type","radio",1,"form-check-input",3,"change","id","checked"],[1,"form-check-label",3,"for"],[1,"mb-4","fw-bold","d-block","text-muted","text-uppercase"],[1,"text-muted","fw-normal","text-wrap","mb-1","d-block"],[1,"d-flex","flex-wrap","p-2","py-1","bg-light","rounded-bottom","border","mt-n1"],["href","javascript:void(0);","data-bs-toggle","modal","data-bs-target","#addAddressModal",1,"d-block","text-body","p-1","px-2",3,"click"],[1,"ri-pencil-fill","text-muted","align-bottom","me-1"],["translate","general.action.edit"],["href","javascript:void(0);","data-bs-toggle","modal","data-bs-target","#removeItemModal",1,"d-block","text-body","p-1","px-2",3,"click"],[1,"ri-delete-bin-fill","text-muted","align-bottom","me-1"],["translate","general.action.delete"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["class","fw-bold fs-4","translate","",4,"ngIf"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"hasProgressBar","fgsType","loaderId"],[3,"submit"],[1,"mb-1"],["for","name","translate","orderManagement.order.cityName",1,"required","fw-bold","form-label"],["name","cityCode","id","cityCode","bindValue","code","bindLabel","name",3,"ngModelChange","ngModel","placeholder","items","multiple"],["for","name","translate","orderManagement.order.name",1,"required","fw-bold","form-label"],["InputTirmFilter","","name","name","type","text","id","name","required","",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["class","text-danger text-center  ","translate","",4,"ngIf"],["for","address","translate","orderManagement.order.address",1,"fw-bold","form-label"],["rows","2","InputTirmFilter","","name","address","type","text","id","address",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["for","mapURL","translate","orderManagement.order.mapURL",1,"fw-bold","form-label"],["InputTirmFilter","","name","mapURL","type","text","id","mapURL",1,"form-control","fs-6",3,"change","ngModelChange","ngModel"],[1,"row","my-2"],[1,"col-12","col-md-6"],["for","lat","translate","orderManagement.order.lat",1,"fw-bold","form-label"],["disabled","","InputTirmFilter","","name","lat","type","text","id","lat",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["for","lng","translate","orderManagement.order.lng",1,"fw-bold","form-label"],["disabled","","InputTirmFilter","","name","lng","type","text","id","lng",1,"form-control","fs-6",3,"ngModelChange","ngModel"],[1,"text-center"],["type","submit","type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],["translate","",1,"fw-bold","fs-4"],["translate","",1,"text-danger","text-center"],[3,"deleteConfirm","dismiss"]],template:function(s,i){if(1&s){const l=e.RV6();e.j41(0,"div",9)(1,"div",10)(2,"div",11),e.nrm(3,"h5",12),e.k0s(),e.j41(4,"div",13)(5,"button",14),e.bIt("click",function(){e.eBV(l);const c=e.sdS(9);return e.Njj(i.openModal(c))}),e.k0s()()(),e.j41(6,"div",15),e.DNE(7,zr,18,8,"ng-container",16),e.k0s()(),e.DNE(8,Hr,42,19,"ng-template",null,0,e.C5r)(10,Qa,1,0,"ng-template",null,1,e.C5r)}2&s&&(e.R7$(5),e.Y8G("disabled",i.isLoad),e.R7$(2),e.Y8G("ngForOf",i.form.locations))},dependencies:[k.Sq,k.bT,g.qT,g.me,g.BC,g.cb,g.YS,g.vS,g.cV,O.Mm,Se.m,fe.vr,X.Cv,rt.w,O.D9],encapsulation:2})}}return a})();function Nn(a,u){if(1&a&&(e.j41(0,"h3",9),e.nrm(1,"span",10),e.j41(2,"a",11),e.EFF(3),e.k0s()()),2&a){const t=e.XpG();e.R7$(3),e.SpI("#SO#",t.orderCode,"")}}let ti=(()=>{class a{constructor(){this.form={},this.orderCode=0,this.statusOrder=0,this.newOrder=new e.bkB,this.editOrderActiveTab=new e.bkB}ngOnDestroy(){}ngOnInit(){}newOrderAgain(){this.newOrder.next(!0)}static{this.\u0275fac=function(s){return new(s||a)}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["app-finish-order-salse"]],inputs:{form:"form",orderCode:"orderCode",statusOrder:"statusOrder"},outputs:{newOrder:"newOrder",editOrderActiveTab:"editOrderActiveTab"},decls:9,vars:1,consts:[[1,"text-center","py-5"],[1,"mb-4"],["src","https://cdn.lordicon.com/lupuorrc.json","trigger","loop","colors","primary:#0ab39c,secondary:#405189",2,"width","120px","height","120px"],["translate","orderManagement.order.orderSaveSuccess"],["class","fw-semibold",4,"ngIf"],[1,"d-flex","align-items-start","gap-3","mt-4"],["type","button","data-nexttab","pills-finish-tab",1,"btn","btn-primary","btn-label","right","ms-auto","nexttab",3,"click"],[1,"ri-chat-new-line","label-icon","align-middle","fs-16","ms-2"],["translate","orderManagement.order.newOrderAgain"],[1,"fw-semibold"],["translate","orderManagement.order.orderCode"],["routerLink","/ecommerce/order-details",1,"text-decoration-underline"]],template:function(s,i){1&s&&(e.j41(0,"div",0)(1,"div",1),e.nrm(2,"lord-icon",2),e.k0s(),e.nrm(3,"h5",3),e.DNE(4,Nn,4,1,"h3",4),e.k0s(),e.j41(5,"div",5)(6,"button",6),e.bIt("click",function(){return i.newOrderAgain()}),e.nrm(7,"i",7)(8,"span",8),e.k0s()()),2&s&&(e.R7$(4),e.Y8G("ngIf",10==i.statusOrder))},dependencies:[k.bT,O.Mm,A.Wk],encapsulation:2})}}return a})();var za=x(33826),En=x(56009),Jr=x(96402),Gn=x(16743),Te=x(5779);const Yi=a=>({"active-category":a}),qi=a=>({" border-service ":a});function Qi(a,u){if(1&a){const t=e.RV6();e.j41(0,"div",15)(1,"div",16),e.bIt("click",function(){const i=e.eBV(t).$implicit,l=e.XpG();return e.Njj(l.chooseCategory(i))}),e.j41(2,"div",17),e.nrm(3,"img",18),e.j41(4,"span",19),e.EFF(5),e.k0s()()()()}if(2&a){const t=u.$implicit,s=e.XpG();e.R7$(),e.Mz_("id","category",t.id,""),e.Y8G("ngClass",e.eq3(6,Yi,t.isSelected)),e.R7$(2),e.Y8G("width",100)("src",s.serverImage+t.imageUrl,e.B4B),e.R7$(2),e.JRh(t.name)}}function zi(a,u){if(1&a&&(e.j41(0,"span",20),e.EFF(1),e.k0s()),2&a){const t=e.XpG();e.R7$(),e.JRh(t.seviceCount)}}function Hi(a,u){1&a&&(e.j41(0,"div",21),e.nrm(1,"button",22),e.k0s())}function Ji(a,u){if(1&a){const t=e.RV6();e.qex(0),e.j41(1,"div",23)(2,"div",24)(3,"div",25),e.bIt("click",function(i){const l=e.eBV(t).$implicit,m=e.XpG();return e.Njj(m.onServiceChange(l.id,i))}),e.j41(4,"div",26)(5,"div",27),e.nrm(6,"img",28),e.k0s(),e.j41(7,"div",29)(8,"h5",30),e.EFF(9),e.k0s()()(),e.j41(10,"div",31),e.nrm(11,"div",32),e.j41(12,"div",33),e.EFF(13),e.k0s()(),e.j41(14,"div",31),e.nrm(15,"div",34),e.j41(16,"div",35),e.EFF(17),e.k0s()(),e.j41(18,"div",31),e.nrm(19,"div",36),e.j41(20,"div",35),e.EFF(21),e.k0s()(),e.j41(22,"div",31),e.nrm(23,"div",37),e.j41(24,"div",35),e.EFF(25),e.nI1(26,"translate"),e.k0s()()(),e.j41(27,"div",31),e.nrm(28,"div",38),e.j41(29,"div",35)(30,"ng-select",39),e.bIt("change",function(i){const l=e.eBV(t).$implicit,m=e.XpG();return e.Njj(m.unitChange(l,i))}),e.mxI("ngModelChange",function(i){const l=e.eBV(t).$implicit;return e.DH7(l.unitId,i)||(l.unitId=i),e.Njj(i)}),e.k0s()()()()(),e.bVm()}if(2&a){const t=u.$implicit,s=e.XpG();e.R7$(2),e.Y8G("ngClass",e.eq3(13,qi,t.isSelected)),e.R7$(4),e.Y8G("src",s.serverImage+t.image,e.B4B),e.R7$(3),e.JRh(t.name),e.R7$(4),e.JRh(t.categoryName),e.R7$(4),e.JRh(t.stock),e.R7$(4),e.JRh(t.status),e.R7$(4),e.Lme("",e.bMT(26,11,"orderManagement.order.currancy")," ",t.price,""),e.R7$(5),e.Y8G("clearable",!1)("items",t.units),e.R50("ngModel",t.unitId)}}let Wi=(()=>{class a{constructor(t,s,i,l,m,c,E,P){this.routerActive=t,this.translateService=s,this.baseService=i,this.serviceCategoryService=l,this.serviceService=m,this.alertService=c,this.ngxLoader=E,this.offerOrder=P,this.form={},this.selectedServices=[],this.notifier=new ut.B,this.mainDelay=100,this.loaderSearchShap=N.cX,this.loaderOperationShap=N.$$,this.operationLoader=N.ZW,this.isEditForm=!1,this.showEdit=!1,this.serviceCategories=[],this.services=[],this.currentLang=this.translateService.currentLang,this.subtotal=0,this.total=0,this.serverImage=nt.c.mediaUrl,this.filteredServices=[],this.seviceCount=0,this.serviceSelected=[],this.CalcTotal=new e.bkB,this.isOrderEdit=!0,this.responsiveOptions=[{breakpoint:"1400px",numVisible:4,numScroll:3},{breakpoint:"1220px",numVisible:4,numScroll:2},{breakpoint:"1100px",numVisible:4,numScroll:1}]}ngOnDestroy(){this.notifier.next(),this.notifier.complete()}ngOnInit(){this.getCategory(),this.getServicesByCategory(),this.offerOrder.removeServiceQ.pipe((0,R.Q)(this.notifier)).subscribe(t=>{const s=this.filteredServices[t];s&&(s.isSelected=!s.isSelected),this.seviceCount=this.filteredServices.filter(i=>i.isSelected).length})}getCategory(){this.serviceCategoryService.getServiceCategoryByType(!0).pipe((0,R.Q)(this.notifier)).subscribe(t=>{this.serviceCategories=t.data,this.checkCategorySelected()})}checkCategorySelected(){this.serviceCategories.forEach(t=>{t.isSelected=this.form.serviceCategoryCode.includes(t.id)})}addService(t){const s=this.form.items.findIndex(i=>i.itemId===t.id);s>-1?this.form.items.splice(s,1):(this.form.items.push({itemGroup:null,itemName:t.name,itemId:t.id,unitId:t.units[0].id,units:t.units,quantity:t.quantity,priceUnit:t.units[0].price,discount:0,discountType:1,price:t.units[0].price,net:t.price*t.quantity}),this.offerOrder.checkValidationSource.next(!0)),this.checkTotal()}updatePrice(t){const s=this.form.orderServices.find(i=>i.serviceCode===t.code);s.quantity=t.quantity,s.price=t.price}checkTotal(){this.CalcTotal.next(!0)}deleteService(t){this.form.orderServices.splice(t,1)}deletePayment(t){this.form.orderPayments.splice(t,1)}resetServiceForm(){let t=this.form.formServices;t.serviceCode=void 0,t.price=null,t.notes=null}resetPaymentForm(){let t=this.form.formPayment;t.paymentTypeCode=null,t.value=null,t.attachRecietPath=null,t.fileName=null}configRoute(){this.routerActive.data.pipe((0,R.Q)(this.notifier)).subscribe(t=>{let s=t.data.data;s&&(this.isEditForm=!0,this.form=s,"Proposed"==s.leadsTypes?this.form.leadsTypes=1:"Inquiry"==s.leadsTypes&&(this.form.leadsTypes=2))},()=>{this.alertService.error()})}getServicesByCategory(){let t=this.form.serviceCategoryCode;return t.length<=0?(this.services=[],this.filteredServices=[],0):(this.ngxLoader.startLoader("order"),this.serviceService.servicesByCategory(t).subscribe(s=>{this.ngxLoader.stopLoader("order"),this.services=this.setupUnit(s.data),this.filteredServices=this.services,this.checkSelected()},s=>{this.ngxLoader.stopLoader("order"),console.log(s)}),1)}setupUnit(t){return t.forEach(s=>{s.unitId=s.units[0].id,s.price=s.units[0].price}),t}unitChange(t,s){if(!t.isSelected)return;let i=this.form.items.find(m=>m.itemId===t.id),l=this.filteredServices.find(m=>m.id===t.id);i.unitId=s.id,i.unitPrice=s.price,i.price=s.price,l.unitPrice=s.price,l.price=s.price,l.unitId=s.id,this.checkTotal()}checkSelected(){this.form.items.forEach(t=>{let s=this.filteredServices.find(i=>i.id===t.itemId);s&&(s.isSelected=!0)})}getTranslationText(t){let s="";return this.translateService.get(t).pipe((0,R.Q)(this.notifier)).subscribe(i=>{s=i}),s}onTimeSelected(t){this.form.orderTeams=t,console.log(t)}chooseCategory(t){let s=this.serviceCategories.find(i=>i.id===t.id);if(s.isSelected=!s.isSelected,s.isSelected)this.form.serviceCategoryCode.push(t.id);else{let i=this.serviceCategories.findIndex(l=>l.id===t.id);-1!==i&&this.form.serviceCategoryCode.splice(i,1)}this.getServicesByCategory()}onServiceChange(t,s){s.stopPropagation();const i=this.filteredServices.find(l=>l.id===t);i&&(i.isSelected=!i.isSelected),this.seviceCount=this.filteredServices.filter(l=>l.isSelected).length,this.addService(i)}btnPlus(t,s){s.stopPropagation();const i=this.filteredServices.find(l=>l.code===t);i&&(i.quantity++,this.updatePrice(i),this.checkTotal())}btnMinus(t,s){s.stopPropagation();const i=this.filteredServices.find(l=>l.code===t);i&&i.quantity>1?i.quantity-=1:i.quantity=1,this.updatePrice(i),this.checkTotal()}searchChange(t){const s=t.target.value.toLowerCase();this.filteredServices=""===s?[...this.services]:this.services.filter(i=>i.name.toLowerCase().includes(s))}static{this.\u0275fac=function(s){return new(s||a)(e.rXU(A.nX),e.rXU(O.c$),e.rXU(za.Q),e.rXU(En.j),e.rXU(Jr.N),e.rXU(le.u),e.rXU(X.eD),e.rXU(Ge))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["order-products"]],inputs:{form:"form",serviceCategories:"serviceCategories",isOrderEdit:"isOrderEdit"},outputs:{CalcTotal:"CalcTotal"},decls:25,vars:18,consts:[[1,"service-container"],[1,"mt-2"],[1,"row","justify-content-between","align-items-center"],[1,"col-12","col-md-5"],[1,"mb-0","d-inline-block","position-relative"],[1,"col-12","col-md-5","mx-5"],[1,"search-box"],["type","search","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"change","placeholder"],[1,"ri-search-line","search-icon"],[3,"circular","value","numVisible","numScroll","rtl","responsiveOptions"],["pTemplate","item"],["class","badge bg-primary mx-1",4,"ngIf"],["class","d-flex justify-content-center",4,"ngIf"],[1,"mt-3","row","row-cols-3"],[4,"ngFor","ngForOf"],[1,"border-1","surface-border","border-round","m-0","p-1"],[1,"card",2,"max-width","150px!important","border-radius","15px !important","cursor","pointer","box-shadow","0px 0px 15px 0px #00000026 !important",3,"click","ngClass","id"],[1,"card-body","text-center"],["height","50","onerror","this.onerror=null;this.src='assets/images/custom/no-img.jpg';",1,"rounded",3,"width","src"],[1,"d-block","mt-2",2,"font-size",".9rem !important","min-height","20px","font-weight","500 !important","line-height","27.2px !important"],[1,"badge","bg-primary","mx-1"],[1,"d-flex","justify-content-center"],["type","button","translate","orderManagement.order.noCategoryMessage",1,"btn","btn-sm","my-2","btn-danger","fs-4","mb-3"],[1,"col-12","col-md-4","text-center"],[1,"card","card-service","card-body",3,"ngClass"],[1,"row",3,"click"],[1,"row","align-items-center","p-0"],[1,"col-12","col-md-6"],["onerror","this.onerror=null;this.src='assets/images/custom/no-img.jpg';",1,"avatar-sm",2,"width","100%","height","120px",3,"src"],[1,"col-12","col-md-6","2"],[1,"card-title","mb-1"],[1,"row","p-1"],["translate","sales.salesOrder.category",1,"col-12","col-md-5","m-0","text-left"],[1,"col-12","col-md-7","m-0"],["translate","sales.salesOrder.stock",1,"col-12","col-md-5","text-left"],[1,"col-12","col-md-7"],["translate","sales.salesOrder.status",1,"col-12","col-md-5","text-left"],["translate","sales.salesOrder.price",1,"col-12","col-md-5","text-left"],["translate","sales.salesOrder.unit",1,"col-12","col-md-5","text-left"],["bindValue","id","bindLabel","name",2,"width","100%",3,"change","ngModelChange","clearable","items","ngModel"]],template:function(s,i){1&s&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h4",4),e.EFF(5),e.nI1(6,"translate"),e.k0s()(),e.j41(7,"div",5)(8,"div",6)(9,"input",7),e.nI1(10,"translate"),e.bIt("change",function(m){return i.searchChange(m)}),e.k0s(),e.nrm(11,"i",8),e.k0s()()(),e.j41(12,"bdi")(13,"p-carousel",9),e.DNE(14,Qi,6,8,"ng-template",10),e.k0s()()(),e.j41(15,"div")(16,"div",2)(17,"div",3)(18,"h4",4),e.EFF(19),e.nI1(20,"translate"),e.k0s(),e.DNE(21,zi,2,1,"span",11),e.k0s()(),e.DNE(22,Hi,2,0,"div",12),e.j41(23,"div",13),e.DNE(24,Ji,31,15,"ng-container",14),e.k0s()()()),2&s&&(e.R7$(5),e.SpI("",e.bMT(6,12,"orderManagement.order.serviceCategory")," "),e.R7$(4),e.FS9("placeholder",e.bMT(10,14,"orderManagement.order.searchProduct")),e.R7$(4),e.Y8G("circular",!0)("value",i.serviceCategories)("numVisible",4)("numScroll",1)("rtl",!1)("responsiveOptions",i.responsiveOptions),e.R7$(6),e.SpI("",e.bMT(20,16,"orderManagement.order.selectedProducts")," "),e.R7$(2),e.Y8G("ngIf",i.seviceCount>0),e.R7$(),e.Y8G("ngIf",0==i.filteredServices.length),e.R7$(2),e.Y8G("ngForOf",i.filteredServices))},dependencies:[k.YU,k.Sq,k.bT,g.BC,g.vS,Gn.F,Te.Ei,O.Mm,fe.vr,O.D9],encapsulation:2})}}return a})();const Ki=(a,u)=>({"border-right: solid #E5E5E6 2px":a,"border-left: solid #E5E5E6 2px":u}),Zi=()=>["salesOrder.editTotalDiscont"],Ha=a=>({"border-bottom:1px solid #E5E5E6;":a});function Ja(a,u){if(1&a){const t=e.RV6();e.j41(0,"app-client-info-salse",53),e.bIt("calacTotal",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.checkTotal())})("setFormByOrderCode",function(i){e.eBV(t);const l=e.XpG();return e.Njj(l.setFormByOrderCode(i))}),e.k0s()}if(2&a){const t=e.XpG();e.Y8G("isOrderEdit",t.isOrderEdit)("isInner",t.isInner)("form",t.form)}}function Wa(a,u){if(1&a&&e.nrm(0,"client-location-salse",54),2&a){const t=e.XpG();e.Y8G("isOrderEdit",t.isOrderEdit)("form",t.form)}}function Wr(a,u){if(1&a){const t=e.RV6();e.j41(0,"order-products",55),e.bIt("CalcTotal",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.checkTotal())}),e.k0s()}if(2&a){const t=e.XpG();e.Y8G("isOrderEdit",t.isOrderEdit)("form",t.form)}}function Kr(a,u){if(1&a){const t=e.RV6();e.j41(0,"app-finish-order-salse",56),e.bIt("editOrderActiveTab",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.editOrder())})("newOrder",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.newOrder())}),e.k0s()}if(2&a){const t=e.XpG();e.Y8G("statusOrder",t.statusOrder)("orderCode",t.orderCode)("form",t.form)}}function Ka(a,u){if(1&a){const t=e.RV6();e.j41(0,"button",57),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.back())}),e.nrm(1,"i",58)(2,"span",59),e.k0s()}}function Za(a,u){if(1&a){const t=e.RV6();e.j41(0,"button",60),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.next())}),e.nrm(1,"i",61)(2,"span",62),e.k0s()}}function eo(a,u){if(1&a){const t=e.RV6();e.j41(0,"div",28)(1,"span",63)(2,"div",64)(3,"button",65),e.nrm(4,"i",66)(5,"span",67),e.k0s(),e.j41(6,"ul",68)(7,"li",69),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.orderFinished())}),e.j41(8,"span",70),e.nrm(9,"i",71)(10,"span",72),e.k0s()(),e.j41(11,"li",69),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.orderFinished(0))}),e.j41(12,"span",70),e.nrm(13,"i",73)(14,"span",74),e.k0s()(),e.j41(15,"li",69),e.bIt("click",function(){e.eBV(t);const i=e.XpG(),l=e.sdS(123);return e.Njj(i.openModalRequest(l))}),e.j41(16,"span",70),e.nrm(17,"i",75)(18,"span",76),e.k0s()()()()()()}}function to(a,u){if(1&a){const t=e.RV6();e.qex(0),e.j41(1,"tr",79)(2,"td",80)(3,"div",81)(4,"div",82)(5,"span",83),e.EFF(6),e.k0s(),e.j41(7,"span")(8,"small",84),e.EFF(9),e.k0s(),e.j41(10,"small",85),e.EFF(11),e.nI1(12,"translate"),e.k0s()()(),e.j41(13,"div",86)(14,"div",87)(15,"button",88),e.bIt("click",function(){const i=e.eBV(t).$implicit,l=e.XpG(2);return e.Njj(l.decrement(i))}),e.EFF(16,"\u2013 "),e.k0s(),e.j41(17,"input",89),e.bIt("change",function(i){const l=e.eBV(t).$implicit,m=e.XpG(2);return e.Njj(m.quantityChange(i,l))}),e.k0s(),e.j41(18,"button",90),e.bIt("click",function(){const i=e.eBV(t).$implicit,l=e.XpG(2);return e.Njj(l.increment(i))}),e.EFF(19,"+ "),e.k0s()()(),e.j41(20,"div",91),e.EFF(21),e.nI1(22,"translate"),e.j41(23,"i",92),e.bIt("click",function(){const i=e.eBV(t).index,l=e.XpG(2);return l.removeService(i),e.Njj(l.checkTotal())}),e.k0s()()()()(),e.bVm()}if(2&a){const t=u.$implicit,s=u.index,i=e.XpG(2);e.R7$(),e.Y8G("ngStyle",e.eq3(14,Ha,s===i.form.items.length-1)),e.R7$(5),e.JRh(s+1),e.R7$(3),e.SpI(" ",t.itemName," "),e.R7$(2),e.Lme(" ",t.price," ",e.bMT(12,10,"orderManagement.order.currancy")," "),e.R7$(6),e.Mz_("id","cart-",t.code,""),e.FS9("value",t.quantity),e.R7$(4),e.Lme(" ",t.price*t.quantity-t.discount," ",e.bMT(22,12,"orderManagement.order.currancy")," ")}}function Zr(a,u){if(1&a&&(e.qex(0),e.j41(1,"h5",77),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.DNE(4,to,24,16,"ng-container",78),e.bVm()),2&a){const t=e.XpG();e.R7$(2),e.SpI(" ",e.bMT(3,2,"orderManagement.order.clientServices")," "),e.R7$(2),e.Y8G("ngForOf",t.form.items)}}function no(a,u){1&a&&(e.j41(0,"tr")(1,"td",93),e.EFF(2),e.nI1(3,"translate"),e.k0s()()),2&a&&(e.R7$(2),e.SpI(" ",e.bMT(3,1,"orderManagement.order.noServices")," "))}function io(a,u){1&a&&(e.j41(0,"tr")(1,"td",94),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.j41(4,"td",95),e.EFF(5," 0 "),e.k0s()()),2&a&&(e.R7$(2),e.SpI(" ",e.bMT(3,1,"orderManagement.order.ServicePrice")," "))}function ro(a,u){if(1&a){const t=e.RV6();e.j41(0,"div",96)(1,"button",97),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.j41(4,"div",98),e.nI1(5,"translate"),e.j41(6,"input",99),e.bIt("change",function(i){e.eBV(t);const l=e.XpG();return e.Njj(l.checkPrecentageChange(i))}),e.k0s(),e.j41(7,"span",100),e.EFF(8,"%"),e.k0s()(),e.j41(9,"input",101,4),e.bIt("change",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.checkTotal())}),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.form.discountAmount,i)||(l.form.discountAmount=i),e.Njj(i)}),e.k0s()()}if(2&a){const t=e.XpG();e.R7$(2),e.SpI(" ",e.bMT(3,4,"orderManagement.order.Discount")," "),e.R7$(2),e.FS9("pTooltip",e.bMT(5,6,"orderManagement.order.discount")),e.R7$(2),e.Y8G("checked",t.form.isPrecentage),e.R7$(3),e.R50("ngModel",t.form.discountAmount)}}function er(a,u){1&a&&(e.j41(0,"div",119),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function so(a,u){if(1&a){const t=e.RV6();e.j41(0,"div",102)(1,"div",103)(2,"h4",104),e.nrm(3,"span",76),e.k0s(),e.j41(4,"button",105),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss("Cross click"))}),e.k0s()(),e.j41(5,"div",106),e.nrm(6,"ngx-ui-loader",107),e.j41(7,"form",108,0),e.bIt("submit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.OnRequestSubmit())}),e.j41(9,"div",109)(10,"label",110),e.EFF(11,"sales.clientCollection.cost"),e.k0s(),e.j41(12,"input",111,5),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.formRequest.cost,i)||(l.formRequest.cost=i),e.Njj(i)}),e.k0s(),e.DNE(14,er,2,0,"div",112),e.k0s(),e.j41(15,"div",109)(16,"label",113),e.EFF(17,"sales.clientCollection.notes"),e.k0s(),e.j41(18,"textarea",114,2),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.formRequest.notes,i)||(l.formRequest.notes=i),e.Njj(i)}),e.k0s()(),e.j41(20,"div",115)(21,"button",116),e.nrm(22,"i",117)(23,"span",118),e.k0s()()()()()}if(2&a){const t=e.sdS(8),s=e.sdS(13),i=e.XpG();e.R7$(6),e.Y8G("hasProgressBar",!1)("fgsType",i.loaderOperationShap)("loaderId",i.operationLoader),e.R7$(6),e.R50("ngModel",i.formRequest.cost),e.R7$(2),e.Y8G("ngIf",s.invalid&&s.touched),e.R7$(4),e.R50("ngModel",i.formRequest.notes),e.R7$(3),e.Y8G("disabled",!t.valid)}}let tr=(()=>{class a{constructor(t,s,i,l,m,c,E){this.translateService=t,this.baseService=s,this.requestPersonSalesService=i,this.alertService=l,this.ngxLoader=m,this.datePipe=c,this.modalService=E,this.editOrders="orderManagement.order.editOrders",this.addOrders="orderManagement.order.addOrders",this.titleOperation="orderManagement.order.titleOperation",this.keySelected="",this.active=1,this.language=this.translateService.currentLang,this.searchForm="",this.breadCrumbItems=[],this.disabledStatus=!0,this.form={clientVisitDate:new Date,id:null,cityCode:0,clientLocationId:0,clientId:0,isUrgent:!1,notes:"",items:[],discountAmount:0,discountAmountAdd:0,total:0,agent:{},orderPayments:[],orderLocations:{},discountType:1,discountTypeAdd:1,isPrecentage:!0,isPrecentageAdd:!1,totalAddDiscountType:0,totalAddDiscount:0,creditLimit:0,terms:"",serviceCategoryCode:[]},this.orderCode=0,this.mobile=0,this.cityCode=0,this.agentName="",this.pendingCode=0,this.isInner=!1,this.isOrderEdit=!0,this.idForm=0,this.totalPaid=0,this.priceModel=0,this.priceModelIndex=0,this.subtotal=0,this.paidTotal=0,this.VATTotal=0,this.beforeVatTotal=0,this.total=0,this.isResolveList=!0,this.extraDiscountCalc=!1,this.employeeGroups=[],this.notifier=new ut.B,this.mainDelay=100,this.loaderSearchShap=N.cX,this.loaderOperationShap=N.$$,this.operationLoader=N.ZW,this.isEditForm=!1,this.showEdit=!1,this.orderTypes=[],this.serviceCategories=[],this.services=[],this.paymentTypes=[],this.isFinished=!1,this.isUpdate=!1,this.isReopen=!1,this.formRequest={},this.statusOrder=10,this.form=this.baseService.salesOrderForm}OpenChangInput(t,s){this.showEdit=!0,this.priceModel=s.price,this.priceModelIndex=t}ChangInput(){this.form.orderServices[`${this.priceModelIndex}`].price=this.priceModel,this.showEdit=!1}ngOnDestroy(){this.notifier.next(),this.notifier.complete()}ngOnInit(){localStorage.getItem("isReopen")&&(this.isReopen=!0),this.resetForm(),this.breadCrumbItems=[{label:"layout.sidebar.orders"},{label:"orderManagement.order.title",active:!0,url:"order/list"},{label:this.isEditForm?"general.action.edit":"general.action.register",active:!0}],this.GetOrderLookUp(),this.checkTotal(),this.baseService.checkValidation.subscribe(s=>{this.checkdisableForm()})}GetOrderLookUp(){}getTranslationText(t){let s="";return this.translateService.get(t).pipe((0,R.Q)(this.notifier)).subscribe(i=>{s=i}),s}checkTotal(){this.subtotal=this.form.items.reduce((s,i)=>s+(i.price*i.quantity-i.discount||0),0),this.form.discountAmount<0&&(this.form.discountAmount=0),this.form.discountAmountAdd<0&&(this.form.discountAmountAdd=0);let t=0;this.form.isPrecentage?(this.form.discountAmount=this.form.discountAmount>100?100:this.form.discountAmount,t=this.subtotal-this.subtotal*(+this.form.discountAmount||0)*.01):t=this.subtotal-(+this.form.discountAmount||0),this.form.isPrecentageAdd?(this.form.discountAmountAdd=this.form.discountAmountAdd>100?100:this.form.discountAmountAdd,t-=this.subtotal*(+this.form.discountAmount||0)*.01):t-=+this.form.discountAmountAdd||0,this.beforeVatTotal=t,this.VATTotal=0==t?0:t+.15*t,this.form.total=this.total=this.VATTotal}setFormByOrderCode(t){this.form=t,this.checkTotal(),this.form.isFree&&(this.form.isPrecentage=!0,this.form.discountAmount=100)}onTimeSelected(t){this.form.visitDate=t.dataVisit,this.form.orderTeams=t.selectedTimes}onNavChange(t){this.active=t.nextId}changeTab(){}finishedOrder(t){this.isFinished=!0,this.orderCode=t,this.active=6,this.resetForm()}finishedUpdateOrder(t){this.isFinished=!0,this.orderCode=t,this.active=6}newOrder(){this.resetForm(),this.orderCode=0,this.active=1,this.total=0,this.subtotal=0}editOrder(){this.active=1}resetForm(){this.form=this.baseService.salesOrderForm={clientVisitDate:new Date,id:null,clientLocationId:0,clientId:0,notes:"",items:[],discountAmount:0,discountAmountAdd:0,total:0,agent:{},orderLocations:{},discountType:1,discountTypeAdd:1,isPrecentage:!0,isPrecentageAdd:!1,totalAddDiscountType:0,totalAddDiscount:0,creditLimit:0,terms:"",serviceCategoryCode:[]}}removeService(t){this.form.items.splice(t,1),this.baseService.removeServiceQ.next(t)}updatePrice(t,s){this.form.items[s].price=t.price*t.quantity}decrement(t){let s=this.form.items.find(i=>i.itemId==t.itemId);s.quantity<=1||(s&&(s.quantity=s.quantity-1),this.checkTotal())}increment(t){let s=this.form.items.find(i=>i.itemId==t.itemId);s&&(s.quantity=s.quantity+1),this.checkTotal()}quantityChange(t,s){parseInt(t.target.value)<=0&&(this.form.orderServices.find(m=>m.serviceCode==s.serviceCode).quantity=1),this.checkTotal(),this.form.orderServices=[...this.form.orderServices]}checkPrecentageChange(t){this.form.isPrecentage=t.target.checked,this.checkTotal()}checkPrecentageAddChange(t){this.form.isPrecentageAdd=t.target.checked,this.checkTotal()}onIsFreeChange(t){t?(this.form.isPrecentage=!0,this.form.discountAmount=100):(this.form.isPrecentage=!1,this.form.discountAmount=0),this.checkTotal()}orderFinished(t=10){let s={id:0,clientId:this.form.clientId,clientVisitDate:this.datePipe.transform(this.form.clientVisitDate,"yyyy-MM-ddTHH:mm:ss.000"),offerOrderStatus:t,notes:this.form.notes,terms:this.form.terms,clientLocationId:this.form.clientLocationId,totalAddDiscount:this.form.discountAmount,totalAddDiscountType:this.form.isPrecentage?2:1,offerOrderDetails:this.form.items.map(i=>({discount:i.discount,discountType:i.discountType,itemId:i.itemId,clientQuantity:i.quantity,id:0,price:i.price,unitId:i.unitId}))};this.ngxLoader.startLoader("order"),this.baseService.register(s).subscribe(i=>{i.success?(this.ngxLoader.stopLoader("order"),this.statusOrder=t,this.finishedOrder(i.data.id),this.alertService.success(),localStorage.removeItem("orderCode"),this.checkdisableForm()):(this.alertService.error(),this.ngxLoader.stopLoader("order"))},()=>{this.alertService.error(),this.ngxLoader.stopLoader("order")})}checkdisableForm(){let t=!1;null==this.form.clientId||0==this.form.clientId||null==this.form.clientId||null==this.form.clientLocationId||0==this.form.clientLocationId||null==this.form.clientLocationId||this.form.items.length<=0?t=!0:this.form.items.length>0?(this.form.items.forEach(s=>{0!=s.itemId||(t=!0)}),t=!!t):t=!1,this.disabledStatus=t}openModalRequest(t,s="md"){this.formRequest={id:0,clientId:this.form.clientId},this.modalService.open(t,{centered:!0,size:s})}OnRequestSubmit(){this.ngxLoader.start(this.operationLoader),this.requestPersonSalesService.register(this.formRequest).pipe((0,me.O)(),(0,se.c)(this.mainDelay),(0,pe.Z)(),(0,R.Q)(this.notifier),(0,ie.j)(()=>this.ngxLoader.stopLoader(this.operationLoader)),(0,qt.W)(t=>(0,fn.$)(t))).subscribe(t=>{t.success?(this.alertService.success(),this.modalService.dismissAll()):this.alertService.error("general.message."+t.message)},t=>{this.alertService.error("general.message."+t)})}next(){let t=this.active+1;this.active=t>3?3:t}back(){let t=this.active-1;this.active=t<=0?1:t}static{this.\u0275fac=function(s){return new(s||a)(e.rXU(O.c$),e.rXU(Ge),e.rXU(Ui),e.rXU(le.u),e.rXU(X.eD),e.rXU(k.vh),e.rXU(F.Bq))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["sales-operation"]],inputs:{form:"form",orderCode:"orderCode",mobile:"mobile",cityCode:"cityCode",agentName:"agentName",pendingCode:"pendingCode",isInner:"isInner",isOrderEdit:"isOrderEdit",isReopen:"isReopen"},decls:124,vars:83,consts:[["formEntity","ngForm"],["customNav","ngbNav"],["notes","ngModel"],["RequestModal",""],["discountAmount","ngModel"],["cost","ngModel"],[1,"row"],[1,"col-xl-12"],[1,"checkout-tab"],[1,"col-12","col-lg-8","col-md-12",3,"ngStyle"],[1,"card","card-summary","card-order-operation","m-0","ribbon-box","material-shadow",2,"border-radius","20px"],[1,"card-body",2,"padding","2rem 2rem .1rem 2rem"],[1,"ribbon-three","ribbon-three-warning"],["fgsColor","rgba(255,255,255,0)",3,"loaderId"],[1,"step-arrow-nav","mt-n3","mx-n3","mb-3"],["ngbNav","","role","tablist",1,"nav","nav-pills","custom-nav","nav-justified",3,"navChange","activeId"],[3,"ngbNavItem"],["ngbNavLink","","data-bs-toggle","tab","role","tab",1,"nav-link","fs-15","p-3"],[1,"ri-user-3-fill","fs-16","p-2","bg-primary-subtle","text-primary","rounded-circle","align-middle","mx-2"],[1,"d-inline","mt-2"],["ngbNavContent",""],[1,"ri-user-location-fill","fs-16","p-2","bg-primary-subtle","text-primary","rounded-circle","align-middle","mx-2"],[1,"ri-shopping-cart-fill","fs-16","p-2","bg-primary-subtle","text-primary","rounded-circle","align-middle","mx-2"],[1,"ri-check-double-fill","fs-16","p-2","bg-primary-subtle","text-primary","rounded-circle","align-middle","mx-2"],[1,"tab-content"],[3,"ngbNavOutlet"],[1,"card-footer","text-center",2,"padding",".5rem","position","relative"],[1,"row","justify-content-center"],[1,"col-12","col-md-3"],["type","button","class","btn btn-primary btn-label waves-effect waves-light rounded-pill mx-1",3,"click",4,"ngIf"],["type","button","class","btn btn-primary btn-label waves-effect right waves-light rounded-pill",3,"click",4,"ngIf"],["class","col-12 col-md-3",4,"ngIf"],[1,"col-12","col-lg-4","col-md-12","mt-3","mt-lg-0","mt-md-3","summary"],[1,"card","card-summary","card-summary-pos","card-order-operation","m-0","ribbon-box","material-shadow","right"],[1,"card-body","card-order-operation",2,"padding","2rem"],[1,"table-responsive","table-card","mt-3","overflow-hidden"],[1,"table","table-borderless","align-middle","mb-0"],[4,"ngIf"],["lass","py-0",2,"border-top","hsl(226, 36%, 80%) solid 1px!important"],["colspan","3"],[1,"d-flex","justify-content-between","align-items-center","mb-2"],[1,"w-75","fw-semibold"],[1,"w-25","fw-semibold","text-end"],["class","col-6 input-group",4,"hasPermission"],[1,"d-flex","justify-content-between","align-items-center"],[1,"fw-semibold"],[1,"fw-semibold","text-end"],[1,"table-active","py-0"],[1,"py-0",2,"border-top","hsl(226, 36%, 80%) solid 1px!important"],["colspan","2",1,"fw-semibold"],[1,"fw-semibold","text-end","text-danger"],["colspan","3",1,"py-0"],["InputTirmFilter","","name","notes","type","text","id","notes","required","",1,"form-control","fs-6",3,"ngModelChange","placeholder","ngModel"],[3,"calacTotal","setFormByOrderCode","isOrderEdit","isInner","form"],[3,"isOrderEdit","form"],[3,"CalcTotal","isOrderEdit","form"],[3,"editOrderActiveTab","newOrder","statusOrder","orderCode","form"],["type","button",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill","mx-1",3,"click"],[1,"ri-arrow-left-circle-fill","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.back"],["type","button",1,"btn","btn-primary","btn-label","waves-effect","right","waves-light","rounded-pill",3,"click"],[1,"ri-arrow-right-circle-fill","label-icon","align-middle","rounded-pill","fs-16","ms-2"],["translate","general.action.next"],[1,"d-inline-block"],[1,"dropdown-custom","d-inline-block"],["type","button",1,"btn","dropbtn","btn-primary","btn-label","waves-effect","right","waves-light","rounded-pill"],[1,"ri-more-2-fill","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.actions"],[1,"dropdown-menu","dropdown-menu-end","dropdown-content",2,"left","0"],[3,"click"],[1,"dropdown-item"],[1,"text-success","ri-add-box-fill","align-bottom","me-2"],["translate","orderManagement.order.orderSaved"],[1,"text-warning","ri-add-box-fill","align-bottom","me-2"],["translate","orderManagement.order.orderSavedAsDraft"],[1,"text-info","ri-add-box-fill","align-bottom","me-2"],["translate","sales.salesOrder.addRequestLimit"],[1,"text-start","text-muted","fw-semibold","mt-3"],[4,"ngFor","ngForOf"],[3,"ngStyle"],["colspan","3",1,"p-1","m-1"],[1,"row","justify-content-between","align-items-center"],[1,"col-12","col-md-4","h6","d-flex","justify-content-start","align-items-center"],[1,"badge","bg-success-subtle","text-success","me-2"],[1,"d-block","mb-1"],[1,"d-block","mt-1"],[1,"col-12","col-md-4","text-mute","text-center"],[1,"input-step","my-2"],["type","button",1,"minus",3,"click"],["disabled","","type","number","min","1","max","100",1,"product-quantity",3,"change","id","value"],["type","button",1,"plus",3,"click"],[1,"col-12","col-md-4","text-mute","text-right"],[1,"ri-close-fill","text-danger","cursor-pointer",3,"click"],["colspan","3",1,"text-center","text-danger"],[1,"text-start","text-muted","fw-semibold"],["colspan","2",1,"text-end"],[1,"col-6","input-group"],["type","button",1,"btn","btn-danger"],["tooltipPosition","top",1,"input-group-text","d-inline",3,"pTooltip"],["type","checkbox","aria-label","Checkbox for following text input",1,"form-check-input",3,"change","checked"],[1,"p-1"],["min","0","InputTirmFilter","","name","discountAmount","type","text","id","discountAmount","required","",1,"form-control","text-right",3,"change","ngModelChange","ngModel"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"hasProgressBar","fgsType","loaderId"],[3,"submit"],[1,"mb-2"],["for","cost","translate","",1,"fw-bold","form-label"],["InputTirmFilter","","name","cost","type","text","id","cost",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["class","text-danger text-center  ","translate","",4,"ngIf"],["for","notes","translate","",1,"fw-bold","form-label"],["rows","2","InputTirmFilter","","name","notes","type","text","id","notes",1,"form-control","fs-6",3,"ngModelChange","ngModel"],[1,"text-center"],["type","submit","type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],["translate","",1,"text-danger","text-center"]],template:function(s,i){if(1&s){const l=e.RV6();e.j41(0,"div",6)(1,"div",7)(2,"div")(3,"div",8)(4,"div",6)(5,"div",9)(6,"div",10)(7,"div",11)(8,"span",12)(9,"span"),e.EFF(10),e.nI1(11,"translate"),e.k0s()(),e.nrm(12,"ngx-ui-loader",13),e.j41(13,"div",14)(14,"form",null,0)(16,"ul",15,1),e.bIt("navChange",function(c){return e.eBV(l),e.Njj(i.onNavChange(c))}),e.j41(18,"li",16)(19,"a",17),e.nrm(20,"i",18),e.j41(21,"span",19),e.EFF(22),e.nI1(23,"translate"),e.k0s()(),e.DNE(24,Ja,1,3,"ng-template",20),e.k0s(),e.j41(25,"li",16)(26,"a",17),e.nrm(27,"i",21),e.j41(28,"span",19),e.EFF(29),e.nI1(30,"translate"),e.k0s()(),e.DNE(31,Wa,1,2,"ng-template",20),e.k0s(),e.j41(32,"li",16)(33,"a",17),e.nrm(34,"i",22),e.j41(35,"span",19),e.EFF(36),e.nI1(37,"translate"),e.k0s()(),e.DNE(38,Wr,1,2,"ng-template",20),e.k0s(),e.j41(39,"li",16)(40,"a",17),e.nrm(41,"i",23),e.j41(42,"span",19),e.EFF(43),e.nI1(44,"translate"),e.k0s()(),e.DNE(45,Kr,1,3,"ng-template",20),e.k0s()(),e.j41(46,"div",24),e.nrm(47,"div",25),e.k0s()()()(),e.j41(48,"div",26)(49,"div",27)(50,"div",28),e.DNE(51,Ka,3,0,"button",29),e.k0s(),e.j41(52,"div",28),e.DNE(53,Za,3,0,"button",30),e.k0s(),e.DNE(54,eo,19,0,"div",31),e.k0s()()()(),e.j41(55,"div",32)(56,"div",33)(57,"div",34)(58,"span",12)(59,"span"),e.EFF(60),e.nI1(61,"translate"),e.k0s()(),e.j41(62,"div",35)(63,"table",36)(64,"tbody"),e.DNE(65,Zr,5,4,"ng-container",37)(66,no,4,3,"tr",37)(67,io,6,3,"tr",37),e.j41(68,"tr",38)(69,"td",39)(70,"div",40)(71,"div",41),e.EFF(72),e.nI1(73,"translate"),e.k0s(),e.j41(74,"div",42),e.EFF(75),e.nI1(76,"translate"),e.k0s()(),e.DNE(77,ro,11,8,"div",43),e.k0s()(),e.j41(78,"tr",38)(79,"td",39)(80,"div",44)(81,"div",45),e.EFF(82),e.nI1(83,"translate"),e.k0s(),e.j41(84,"div",46),e.EFF(85),e.nI1(86,"translate"),e.k0s()(),e.j41(87,"div",44)(88,"div",45),e.EFF(89),e.nI1(90,"translate"),e.k0s(),e.j41(91,"div",46),e.EFF(92),e.nI1(93,"translate"),e.k0s()(),e.j41(94,"div",44)(95,"div",45),e.EFF(96),e.nI1(97,"translate"),e.k0s(),e.j41(98,"div",46),e.EFF(99),e.nI1(100,"translate"),e.k0s()()()(),e.j41(101,"tr",47)(102,"td",39)(103,"div",40)(104,"div",45),e.EFF(105),e.nI1(106,"translate"),e.k0s(),e.j41(107,"div",46),e.EFF(108),e.nI1(109,"translate"),e.k0s()()()(),e.j41(110,"tr",48)(111,"td",49),e.EFF(112),e.nI1(113,"translate"),e.k0s(),e.j41(114,"td",50),e.EFF(115),e.nI1(116,"translate"),e.k0s()(),e.j41(117,"tr",47)(118,"td",51)(119,"textarea",52,2),e.nI1(121,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.form.notes,c)||(i.form.notes=c),e.Njj(c)}),e.k0s()()()()()()()()()()()()()(),e.DNE(122,so,24,7,"ng-template",null,3,e.C5r)}if(2&s){const l=e.sdS(17);e.R7$(5),e.Y8G("ngStyle",e.l_i(79,Ki,"en"==i.language,"en"==i.language)),e.R7$(5),e.JRh(e.bMT(11,41,"orderManagement.order.addOrders")),e.R7$(2),e.Y8G("loaderId","order"),e.R7$(4),e.Y8G("activeId",i.active),e.R7$(2),e.Y8G("ngbNavItem",1),e.R7$(4),e.SpI(" ",e.bMT(23,43,"orderManagement.order.clientInfo")," "),e.R7$(3),e.Y8G("ngbNavItem",2),e.R7$(4),e.SpI(" ",e.bMT(30,45,"orderManagement.order.locations")," "),e.R7$(3),e.Y8G("ngbNavItem",3),e.R7$(4),e.SpI(" ",e.bMT(37,47,"orderManagement.order.items")," "),e.R7$(3),e.Y8G("ngbNavItem",6),e.R7$(4),e.SpI(" ",e.bMT(44,49,"orderManagement.order.finish")," "),e.R7$(4),e.Y8G("ngbNavOutlet",l),e.R7$(4),e.Y8G("ngIf",i.active>1),e.R7$(2),e.Y8G("ngIf",i.active<3),e.R7$(),e.Y8G("ngIf",!i.disabledStatus&&i.form.clientId>0),e.R7$(6),e.JRh(e.bMT(61,51,"orderManagement.order.orderSummary")),e.R7$(5),e.Y8G("ngIf",i.form.items.length>0),e.R7$(),e.Y8G("ngIf",0==i.form.items.length),e.R7$(),e.Y8G("ngIf",0==i.form.items.length),e.R7$(5),e.JRh(e.bMT(73,53,"orderManagement.order.SubTotal")),e.R7$(3),e.Lme("",i.subtotal," ",e.bMT(76,55,"orderManagement.order.currancy"),""),e.R7$(2),e.Y8G("hasPermission",e.lJ4(82,Zi)),e.R7$(5),e.JRh(e.bMT(83,57,"orderManagement.order.PriceAfterDisaccount")),e.R7$(3),e.Lme(" ",i.beforeVatTotal.toFixed(2)," ",e.bMT(86,59,"orderManagement.order.currancy")," "),e.R7$(4),e.JRh(e.bMT(90,61,"orderManagement.order.PriceBeforeVat")),e.R7$(3),e.Lme(" ",i.beforeVatTotal.toFixed(2)," ",e.bMT(93,63,"orderManagement.order.currancy")," "),e.R7$(4),e.SpI("",e.bMT(97,65,"orderManagement.order.tax")," (15%)"),e.R7$(3),e.Lme("",(i.VATTotal-i.beforeVatTotal).toFixed(2)," ",e.bMT(100,67,"orderManagement.order.currancy")," "),e.R7$(6),e.JRh(e.bMT(106,69,"orderManagement.order.VAT")),e.R7$(3),e.Lme("",i.VATTotal.toFixed(2)," ",e.bMT(109,71,"orderManagement.order.currancy"),""),e.R7$(4),e.SpI("",e.bMT(113,73,"orderManagement.order.creditLimit"),": "),e.R7$(3),e.Lme("",i.form.creditLimit," ",e.bMT(116,75,"orderManagement.order.currancy"),""),e.R7$(4),e.FS9("placeholder",e.bMT(121,77,"orderManagement.order.notes")),e.R50("ngModel",i.form.notes)}},dependencies:[k.Sq,k.bT,k.B3,F.Um,F.X9,F.sy,F.Gx,F.Ri,F.WA,F.m_,g.qT,g.me,g.BC,g.cb,g.YS,g.vS,g.cV,O.Mm,Se.m,Be.p,X.Cv,gt.m,Rn,_t,ti,Wi,O.D9],encapsulation:2})}}return a})(),ao=(()=>{class a{constructor(){this.breadCrumbItems=[],this.addOrders="orderManagement.order.addOrders"}ngOnInit(){}static{this.\u0275fac=function(s){return new(s||a)}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["order-register"]],decls:1,vars:0,template:function(s,i){1&s&&e.nrm(0,"sales-operation")},dependencies:[tr],encapsulation:2})}}return a})();var Nt=x(56701),ni=x(26364),De=x(75622);let oo=(()=>{class a extends Qt.d{constructor(t){super(t,nt.c.apiUrl+"ShippingTruck/")}static{this.\u0275fac=function(s){return new(s||a)(e.KVO(Ot.Qq))}}static{this.\u0275prov=e.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})();var He=x(91426),It=x(53928),Ye=x(40724),$e=x(88148),qe=x(91580);const lo=()=>["salesSetting.register"],co=()=>["salesSetting.edit"],mo=()=>["salesSetting.delete"];function po(a,u){1&a&&(e.j41(0,"tr",25)(1,"th",26),e.EFF(2,"#"),e.k0s(),e.j41(3,"th",27),e.nrm(4,"i",28),e.EFF(5," sales.shippingTruck.name "),e.k0s(),e.j41(6,"th",29),e.nrm(7,"i",28),e.EFF(8," sales.shippingTruck.truckNumber "),e.k0s(),e.j41(9,"th",30),e.nrm(10,"i",28),e.EFF(11," sales.shippingTruck.truckDriverName "),e.k0s(),e.j41(12,"th",31),e.EFF(13," sales.shippingTruck.cityName "),e.k0s(),e.j41(14,"th",32),e.nrm(15,"i",28),e.EFF(16," general.table.isActive "),e.k0s(),e.nrm(17,"th",31),e.k0s())}function uo(a,u){if(1&a&&(e.qex(0),e.j41(1,"span",40),e.EFF(2),e.k0s(),e.bVm()),2&a){const t=u.$implicit;e.R7$(2),e.JRh(t.cityName)}}function ii(a,u){1&a&&e.nrm(0,"span",41)}function go(a,u){1&a&&e.nrm(0,"span",42)}function ri(a,u){if(1&a&&(e.nrm(0,"i",43),e.EFF(1),e.nI1(2,"date"),e.nrm(3,"br")(4,"i",44),e.EFF(5),e.nI1(6,"date"),e.nrm(7,"br")(8,"i",45),e.EFF(9)),2&a){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",e.i5U(2,3,t.createdDate,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",e.i5U(6,6,t.updatedDate,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",t.creatorName," ")}}function ho(a,u){if(1&a){const t=e.RV6();e.j41(0,"button",46),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,l=e.XpG(),m=e.sdS(20);return e.Njj(l.EditModel(i.id,m))}),e.nrm(1,"i",47),e.k0s()}}function _o(a,u){if(1&a){const t=e.RV6();e.j41(0,"button",48),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,l=e.XpG(),m=e.sdS(22);return e.Njj(l.openModal(i.id,m))}),e.nrm(1,"i",49),e.k0s()}}function fo(a,u){if(1&a&&(e.j41(0,"tr",33)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td"),e.DNE(10,uo,3,1,"ng-container",34),e.k0s(),e.j41(11,"td"),e.DNE(12,ii,1,0,"span",35)(13,go,1,0,"span",36),e.k0s(),e.j41(14,"td"),e.DNE(15,ri,10,9,"ng-template",null,3,e.C5r),e.nrm(17,"i",37),e.DNE(18,ho,2,0,"button",38)(19,_o,2,0,"button",39),e.k0s()()),2&a){const t=u.$implicit,s=u.rowIndex,i=e.sdS(16);e.R7$(2),e.JRh(s+1),e.R7$(2),e.JRh(t.name),e.R7$(2),e.JRh(t.truckNumber),e.R7$(2),e.JRh(t.truckDriverName),e.R7$(2),e.Y8G("ngForOf",t.cities),e.R7$(2),e.Y8G("ngIf",t.isActive),e.R7$(),e.Y8G("ngIf",!t.isActive),e.R7$(4),e.Y8G("ngbTooltip",i),e.R7$(),e.Y8G("hasPermission",e.lJ4(10,co)),e.R7$(),e.Y8G("hasPermission",e.lJ4(11,mo))}}function es(a,u){1&a&&(e.j41(0,"div",50),e.EFF(1," general.table.noData "),e.k0s())}function ts(a,u){if(1&a){const t=e.RV6();e.j41(0,"div",51)(1,"div",52),e.nrm(2,"ngb-pagination-info",53),e.j41(3,"table-length",54),e.bIt("lengthChange",function(i){e.eBV(t);const l=e.XpG();return e.Njj(l.ListItemChange(i))}),e.k0s()(),e.j41(4,"div",55)(5,"ngb-pagination",56),e.bIt("pageChange",function(i){e.eBV(t);const l=e.XpG();return e.Njj(l.pageChanged(i))}),e.mxI("pageChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.pagination.pageNumber,i)||(l.pagination.pageNumber=i),e.Njj(i)}),e.k0s()()()}if(2&a){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function ns(a,u){1&a&&(e.j41(0,"span",82),e.EFF(1,"general.action.register "),e.k0s())}function bo(a,u){1&a&&(e.j41(0,"span",82),e.EFF(1,"general.action.edit "),e.k0s())}function vo(a,u){1&a&&(e.j41(0,"div",83),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function Co(a,u){1&a&&(e.j41(0,"div",83),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function So(a,u){1&a&&(e.j41(0,"div",83),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function is(a,u){if(1&a){const t=e.RV6();e.j41(0,"div",57)(1,"div",58)(2,"h4",59),e.DNE(3,ns,2,0,"span",60)(4,bo,2,0,"span",60),e.j41(5,"span",61),e.EFF(6),e.k0s()(),e.j41(7,"button",62),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss("Cross click"))}),e.k0s()(),e.j41(8,"div",63),e.nrm(9,"ngx-ui-loader",18),e.j41(10,"form",64,4),e.bIt("submit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.OnSubmit())}),e.j41(12,"div",65)(13,"label",66),e.EFF(14,"sales.shippingTruck.name"),e.k0s(),e.j41(15,"input",67,5),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.form.name,i)||(l.form.name=i),e.Njj(i)}),e.k0s(),e.DNE(17,vo,2,0,"div",68),e.k0s(),e.j41(18,"div",65)(19,"label",69),e.EFF(20,"sales.shippingTruck.truckNumber"),e.k0s(),e.j41(21,"input",70,6),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.form.truckNumber,i)||(l.form.truckNumber=i),e.Njj(i)}),e.k0s(),e.DNE(23,Co,2,0,"div",68),e.k0s(),e.j41(24,"div",65)(25,"label",71),e.EFF(26,"sales.shippingTruck.driver"),e.k0s(),e.j41(27,"ng-select",72,7),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.form.truckDriverId,i)||(l.form.truckDriverId=i),e.Njj(i)}),e.k0s(),e.DNE(29,So,2,0,"div",68),e.k0s(),e.j41(30,"div",73)(31,"label",71),e.EFF(32,"sales.shippingTruck.cities"),e.k0s(),e.j41(33,"ng-select",74),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.form.cities,i)||(l.form.cities=i),e.Njj(i)}),e.k0s()(),e.j41(34,"div",75)(35,"label",76),e.EFF(36,"general.table.isActive"),e.k0s(),e.j41(37,"p-inputSwitch",77),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.form.isActive,i)||(l.form.isActive=i),e.Njj(i)}),e.k0s()(),e.j41(38,"div",78)(39,"button",79),e.nrm(40,"i",80)(41,"span",81),e.k0s()()()()()}if(2&a){const t=e.sdS(11),s=e.sdS(16),i=e.sdS(22),l=e.sdS(28),m=e.XpG();e.R7$(3),e.Y8G("ngIf",!m.isEditForm),e.R7$(),e.Y8G("ngIf",m.isEditForm),e.R7$(2),e.JRh(m.titleOperation),e.R7$(3),e.Y8G("hasProgressBar",!1)("fgsType",m.loaderOperationShap)("loaderId",m.operationLoader),e.R7$(6),e.R50("ngModel",m.form.name),e.R7$(2),e.Y8G("ngIf",s.invalid&&s.touched),e.R7$(4),e.R50("ngModel",m.form.truckNumber),e.R7$(2),e.Y8G("ngIf",i.invalid&&i.touched),e.R7$(4),e.Y8G("items",m.employees)("multiple",!1),e.R50("ngModel",m.form.truckDriverId),e.R7$(2),e.Y8G("ngIf",l.invalid&&l.touched),e.R7$(4),e.Y8G("items",m.cities)("multiple",!0),e.R50("ngModel",m.form.cities),e.R7$(4),e.R50("ngModel",m.form.isActive),e.R7$(2),e.Y8G("disabled",!t.valid)}}function rs(a,u){if(1&a){const t=e.RV6();e.j41(0,"delete-modal",84),e.bIt("deleteConfirm",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.DeleteConfirmSoft())})("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}}let ss=(()=>{class a extends De.w{constructor(t,s,i,l,m,c,E,P,q,D,J){super(t,s,E,i,l,m,c),this.baseService=i,this.excelService=q,this.employeeService=D,this.cityService=J,this.title="sales.shippingTruck.title",this.titleOperation="sales.shippingTruck.titleOperation",this.keySelected="",this.assignUsers=[],this.times=[],this.employees=[],this.searchForm={},this.cities=[],this.configRoute(),this.getEmployees(),this.getCities()}OnSearch(t){this.ngxLoader.startLoader(N.a7),this.loadentities()}onSearch(){this.ngxLoader.startLoader(N.a7),this.loadentities()}configRoute(){this.routerActive.data.pipe((0,R.Q)(this.notifier)).subscribe(t=>{this.entities=t.data.data,this.pagination.totalItems=t.data.totalItems},()=>{this.alertService.error()})}getEmployees(){this.employeeService.getDropDown().pipe((0,R.Q)(this.notifier)).subscribe(t=>{this.employees=t.data},()=>{this.alertService.error()})}getCities(){this.cityService.getDropDown().pipe((0,R.Q)(this.notifier)).subscribe(t=>{this.cities=t.data},()=>{this.alertService.error()})}mapExcel(){let t=[];return this.entities?.forEach(s=>{t.push({workTime:s.workTime,isActive:this.getTranslationText("general.table.active")})}),t}mapRegisterForm(t){let s={...t};return s.id=0,s.cities=s.cities.map(i=>({cityId:i,shippingTruckId:0})),s}mapForm(t){let s={...t};return s.cities=s.cities.map(i=>({cityId:i,shippingTruckId:s.id})),s}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,"Service Type",[])}editEntity(){let t=this.mapForm(this.form);this.baseService.editPut(t.id,t).pipe((0,me.O)(),(0,se.c)(this.mainDelay),(0,pe.Z)(),(0,R.Q)(this.notifier),(0,ie.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(s=>{s.success?this.submitFunished():this.alertService.error("general.message."+s.message)},s=>{this.alertService.error("general.message."+s)})}static{this.\u0275fac=function(s){return new(s||a)(e.rXU(A.nX),e.rXU(O.c$),e.rXU(oo),e.rXU(le.u),e.rXU(k.vh),e.rXU(X.eD),e.rXU(F.Bq),e.rXU(e.gRc),e.rXU(He.V),e.rXU(It.O),e.rXU(Ue.h))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["app-shipping-trucks"]],features:[e.Vt3],decls:23,vars:18,consts:[["tableMaster",""],["operation",""],["deleteModal",""],["tooltipContent",""],["formEntity","ngForm"],["name","ngModel"],["truckNumber","ngModel"],["truckDriverId","ngModel"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],[3,"reset","search","addNew","addPermission","showExport","totalItems","title"],["control",""],[1,"col-md-3","mb-2"],[1,"search-box"],["InputTirmFilter","","type","search","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],[1,"card-body"],[3,"hasProgressBar","fgsType","loaderId"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["translate","",2,"width",".5%"],["pSortableColumn","name","translate","",2,"width","10%"],[1,"ri-expand-up-down-line"],["pSortableColumn","truckNumber","translate","",2,"width","10%"],["pSortableColumn","truckDriverId","translate","",2,"width","10%"],["translate","",2,"width","10%"],["pSortableColumn","isActive","translate","",2,"width","8%"],[1,"fs-5"],[4,"ngFor","ngForOf"],["class","badge bg-success-subtle text-success p-2","translate","general.table.active",4,"ngIf"],["class","badge bg-danger-subtle text-danger p-2","translate","general.table.noActive",4,"ngIf"],["tooltipPosition","top",1,"mdi","mdi-cog-outline","text-muted","fs-16","align-middle","me-1",3,"ngbTooltip"],["class","btn btn-sm btn-soft-info edit-list mx-2",3,"click",4,"hasPermission"],["class","btn btn-sm btn-soft-danger remove-list",3,"click",4,"hasPermission"],[1,"badge","badge-pill","bg-primary","mx-1"],["translate","general.table.active",1,"badge","bg-success-subtle","text-success","p-2"],["translate","general.table.noActive",1,"badge","bg-danger-subtle","text-danger","p-2"],[1,"ri-history-fill","text-warning"],[1,"ri-history-fill","text-danger"],[1,"ri-user-location-fill","text-primary"],[1,"btn","btn-sm","btn-soft-info","edit-list","mx-2",3,"click"],[1,"ri-pencil-fill","align-bottom","mx-1"],[1,"btn","btn-sm","btn-soft-danger","remove-list",3,"click"],[1,"ri-delete-bin-5-fill","align-bottom"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["class","fw-bold fs-4","translate","",4,"ngIf"],["translate",""],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"submit"],[1,"mb-3"],["for","name","translate","",1,"fw-bold","form-label"],["InputTirmFilter","","name","name","type","text","id","name",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["class","text-danger text-center  ","translate","",4,"ngIf"],["for","truckNumber","translate","",1,"fw-bold","form-label"],["InputTirmFilter","","name","truckNumber","type","text","id","truckNumber",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["translate","",1,"required","fw-bold","form-label","w-100"],["name","truckDriverId","bindValue","code","bindLabel","name","required","",3,"ngModelChange","items","multiple","ngModel"],[1,"col-12","mb-1"],["name","cities","bindValue","code","bindLabel","name",3,"ngModelChange","items","multiple","ngModel"],[1,"form-check"],["for","isActive","translate","",1,"fw-bold","form-label","w-100"],["name","isActive","inputId","isActive",3,"ngModelChange","ngModel"],[1,"text-center"],["type","submit","type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],["translate","",1,"fw-bold","fs-4"],["translate","",1,"text-danger","text-center"],[3,"deleteConfirm","dismiss"]],template:function(s,i){if(1&s){const l=e.RV6();e.j41(0,"div",8)(1,"div",9)(2,"div",10)(3,"base-filter",11),e.bIt("reset",function(){return e.eBV(l),e.Njj(i.onReset())})("search",function(){return e.eBV(l),e.Njj(i.onSearch())})("addNew",function(){e.eBV(l);const c=e.sdS(20);return e.Njj(i.openModalTitle(c,"md"))}),e.qex(4,12),e.j41(5,"div",13)(6,"div",14)(7,"input",15),e.nI1(8,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.filterValue,c)||(i.pagination.filterValue=c),e.Njj(c)}),e.k0s(),e.nrm(9,"i",16),e.k0s()(),e.bVm(),e.k0s(),e.j41(10,"div",17),e.nrm(11,"ngx-ui-loader",18),e.j41(12,"div",19)(13,"p-table",20,0),e.bIt("onLazyLoad",function(c){return e.eBV(l),e.Njj(i.tableChange(c))})("selectionChange",function(c){return e.eBV(l),e.Njj(i.onSelectionChange(c))}),e.DNE(15,po,18,0,"ng-template",21)(16,fo,20,12,"ng-template",22),e.k0s()(),e.DNE(17,es,2,0,"div",23)(18,ts,6,8,"div",24),e.k0s()()()(),e.DNE(19,is,42,19,"ng-template",null,1,e.C5r)(21,rs,1,0,"ng-template",null,2,e.C5r)}2&s&&(e.R7$(3),e.Y8G("addPermission",e.lJ4(17,lo))("showExport",!1)("totalItems",i.pagination.totalItems)("title",i.title),e.R7$(4),e.FS9("placeholder",e.bMT(8,15,"task.tasklist.subject")),e.R50("ngModel",i.pagination.filterValue),e.R7$(4),e.Y8G("hasProgressBar",!1)("fgsType",i.loaderSearchShap)("loaderId",i.searchLoader),e.R7$(2),e.Y8G("value",i.entities)("rows",i.pagination.pageSize)("lazy",!0)("totalRecords",i.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",i.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",i.pagination.totalItems>0))},dependencies:[k.Sq,k.bT,g.qT,g.me,g.BC,g.cb,g.YS,g.vS,g.cV,F.s5,Ye.b,rt.w,$e.p,qe.g,O.Mm,Y.XI,Te.Ei,Y.Tg,Yt.HW,X.Cv,fe.vr,F.md,Se.m,Be.p,k.vh,O.D9],encapsulation:2})}}return a})();function nr(a,u){1&a&&e.nrm(0,"app-shipping-trucks")}let jo=(()=>{class a{constructor(){this.title="sales.salesSetting.title"}ngOnInit(){this.breadCrumbItems=[]}static{this.\u0275fac=function(s){return new(s||a)}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["app-sales-setting"]],decls:15,vars:7,consts:[["Arrow","ngbNav"],[3,"title","breadcrumbItems"],[1,"col-12"],[1,"card"],[1,"card-body"],["ngbNav","",1,"nav","nav-pills","arrow-navtabs","nav-success","bg-light","mb-3",3,"activeId"],[3,"ngbNavItem"],["ngbNavLink",""],[1,"d-block","d-sm-none"],[1,"mdi","mdi-home-variant"],["translate","sales.shippingTruck.title",1,"d-sm-block"],["ngbNavContent",""],[1,"tab-content","text-muted"],[3,"ngbNavOutlet"]],template:function(s,i){if(1&s&&(e.nrm(0,"app-breadcrumbs",1),e.nI1(1,"translate"),e.j41(2,"div",2)(3,"div",3)(4,"div",4)(5,"ul",5,0)(7,"li",6)(8,"a",7)(9,"span",8),e.nrm(10,"i",9),e.k0s(),e.nrm(11,"span",10),e.k0s(),e.DNE(12,nr,1,0,"ng-template",11),e.k0s()(),e.j41(13,"div",12),e.nrm(14,"div",13),e.k0s()()()()),2&s){const l=e.sdS(6);e.FS9("title",e.bMT(1,5,i.title)),e.Y8G("breadcrumbItems",i.breadCrumbItems),e.R7$(5),e.Y8G("activeId",1),e.R7$(2),e.Y8G("ngbNavItem",1),e.R7$(7),e.Y8G("ngbNavOutlet",l)}},dependencies:[F.Um,F.X9,F.sy,F.Gx,F.Ri,F.WA,F.m_,ni.m,O.Mm,ss,O.D9],encapsulation:2})}}return a})();var ft=x(62984),Ht=x(70053),Et=x(35419);function yo(a,u){1&a&&(e.j41(0,"p",15),e.nrm(1,"span",16),e.k0s())}function as(a,u){if(1&a&&(e.j41(0,"span",17),e.nrm(1,"i",18),e.EFF(2),e.k0s()),2&a){const t=e.XpG();e.R7$(2),e.SpI(" ",t.client.clientName,"")}}function os(a,u){1&a&&(e.j41(0,"p",15),e.nrm(1,"span",19),e.k0s())}function ir(a,u){if(1&a&&(e.j41(0,"span",20),e.nrm(1,"i",18),e.EFF(2),e.nI1(3,"date"),e.k0s()),2&a){const t=e.XpG();e.R7$(2),e.SpI("",e.i5U(3,1,t.client.lastTransactionDate,"yyyy-MM-dd ")," ")}}function Io(a,u){1&a&&(e.j41(0,"p",15),e.nrm(1,"span",21),e.k0s())}function ls(a,u){if(1&a&&(e.j41(0,"span",22),e.nrm(1,"i",18),e.EFF(2),e.k0s()),2&a){const t=e.XpG();e.R7$(2),e.Lme(" ",t.client.clientQuantity," - ",t.client.clientInvoiceCost," ")}}function rr(a,u){1&a&&(e.j41(0,"p",15),e.nrm(1,"span",23),e.k0s())}function sr(a,u){if(1&a&&(e.j41(0,"span",24),e.nrm(1,"i",18),e.EFF(2),e.k0s()),2&a){const t=e.XpG();e.R7$(2),e.SpI("",t.client.totalDebt," ")}}let Gt=(()=>{class a{constructor(t){this.clientService=t,this.dismiss=new e.bkB,this.clientId=0,this.client={},this.objectKeys=Object.keys}ngOnInit(){this.getClientSummary()}getClientSummary(){0!=this.clientId&&this.clientService.GetClientSummary(this.clientId).subscribe(t=>{this.client=t.data})}dismissFn(){this.dismiss.emit(!0)}static{this.\u0275fac=function(s){return new(s||a)(e.rXU(it.X))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["client-summary"]],inputs:{clientId:"clientId"},outputs:{dismiss:"dismiss"},decls:23,vars:8,consts:[[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"row","justify-content-between"],["translate","client.client.clientName",1,"col-12","col-md-6"],[1,"col-12","col-md-6"],["class","card-text placeholder-glow",4,"ngIf"],["class","badge badge-label bg-primary fs-5",4,"ngIf"],[1,"row","my-2","justify-content-between"],["translate","client.client.lastTransactionDate",1,"col-12","col-md-6"],["class","badge badge-label bg-info fs-5",4,"ngIf"],["translate","client.client.numberInvoiceQuantity",1,"col-12","col-md-6"],["class","badge badge-label bg-success fs-5",4,"ngIf"],["translate","client.client.totalDebt",1,"col-12","col-md-6"],["class","badge badge-label bg-danger fs-5",4,"ngIf"],[1,"card-text","placeholder-glow"],[1,"placeholder","col-12","bg-primary"],[1,"badge","badge-label","bg-primary","fs-5"],[1,"mdi","mdi-circle-medium"],[1,"placeholder","col-12","bg-info"],[1,"badge","badge-label","bg-info","fs-5"],[1,"placeholder","col-12","bg-success"],[1,"badge","badge-label","bg-success","fs-5"],[1,"placeholder","col-12","bg-danger"],[1,"badge","badge-label","bg-danger","fs-5"]],template:function(s,i){1&s&&(e.j41(0,"div",0)(1,"button",1),e.bIt("click",function(){return i.dismissFn()}),e.k0s()(),e.j41(2,"div",2)(3,"div",3),e.nrm(4,"div",4),e.j41(5,"div",5),e.DNE(6,yo,2,0,"p",6)(7,as,3,1,"span",7),e.k0s()(),e.j41(8,"div",8),e.nrm(9,"div",9),e.j41(10,"div",5),e.DNE(11,os,2,0,"p",6)(12,ir,4,4,"span",10),e.k0s()(),e.j41(13,"div",3),e.nrm(14,"div",11),e.j41(15,"div",5),e.DNE(16,Io,2,0,"p",6)(17,ls,3,2,"span",12),e.k0s()(),e.j41(18,"div",8),e.nrm(19,"div",13),e.j41(20,"div",5),e.DNE(21,rr,2,0,"p",6)(22,sr,3,1,"span",14),e.k0s()()()),2&s&&(e.R7$(6),e.Y8G("ngIf",!i.client.clientName),e.R7$(),e.Y8G("ngIf",i.client.clientName),e.R7$(4),e.Y8G("ngIf",!i.client.lastTransactionDate),e.R7$(),e.Y8G("ngIf",i.client.lastTransactionDate),e.R7$(4),e.Y8G("ngIf",!i.client.clientQuantity),e.R7$(),e.Y8G("ngIf",i.client.clientQuantity),e.R7$(4),e.Y8G("ngIf",!i.client.totalDebt),e.R7$(),e.Y8G("ngIf",i.client.totalDebt))},dependencies:[k.bT,O.Mm,k.vh],encapsulation:2})}}return a})();const ln=a=>[a];function ds(a,u){if(1&a&&(e.j41(0,"span"),e.nrm(1,"span",67),e.k0s()),2&a){const t=e.XpG();e.ZvI(" badge ",t.getStatus(t.form),""),e.R7$(),e.FS9("translate","sales.salesOrder."+t.form.offerOrderStatusName)}}function To(a,u){if(1&a){const t=e.RV6();e.j41(0,"div",22)(1,"label",68),e.EFF(2,"sales.salesOrder.changeQuantityMessage"),e.k0s(),e.j41(3,"textarea",69,1),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.form.changeQuantityMessage,i)||(l.form.changeQuantityMessage=i),e.Njj(i)}),e.k0s()()}if(2&a){const t=e.XpG();e.R7$(3),e.R50("ngModel",t.form.changeQuantityMessage)}}function cs(a,u){1&a&&e.nrm(0,"th",70)}function ms(a,u){1&a&&e.nrm(0,"th",71)}function ps(a,u){if(1&a){const t=e.RV6();e.j41(0,"td")(1,"ng-select",73),e.bIt("ngModelChange",function(i){e.eBV(t);const l=e.XpG().$index,m=e.XpG();return e.Njj(m.discountSelect(i,l,2))}),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG().$implicit;return e.DH7(l.discountType,i)||(l.discountType=i),e.Njj(i)}),e.k0s()()}if(2&a){const t=e.XpG(),s=t.$implicit,i=t.$index,l=e.XpG();e.R7$(),e.Y8G("name","discountType"+e.eq3(3,ln,i))("items",l.discountTypes),e.R50("ngModel",s.discountType)}}function us(a,u){if(1&a){const t=e.RV6();e.j41(0,"td")(1,"input",79),e.bIt("ngModelChange",function(i){e.eBV(t);const l=e.XpG().$index,m=e.XpG();return e.Njj(m.discountSelect(i,l))}),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG().$implicit;return e.DH7(l.discount,i)||(l.discount=i),e.Njj(i)}),e.k0s()()}if(2&a){const t=e.XpG(),s=t.$implicit,i=t.$index;e.R7$(),e.Y8G("name","discount"+e.eq3(2,ln,i)),e.R50("ngModel",s.discount)}}function xo(a,u){if(1&a){const t=e.RV6();e.j41(0,"tr")(1,"td")(2,"ng-select",72),e.bIt("change",function(i){const l=e.eBV(t).$index,m=e.XpG();return e.Njj(m.itemSelected(i,l))}),e.mxI("ngModelChange",function(i){const l=e.eBV(t).$implicit;return e.DH7(l.itemId,i)||(l.itemId=i),e.Njj(i)}),e.k0s()(),e.j41(3,"td")(4,"ng-select",73),e.mxI("ngModelChange",function(i){const l=e.eBV(t).$implicit;return e.DH7(l.unitId,i)||(l.unitId=i),e.Njj(i)}),e.k0s()(),e.j41(5,"td")(6,"input",74),e.mxI("ngModelChange",function(i){const l=e.eBV(t).$implicit;return e.DH7(l.clientQuantity,i)||(l.clientQuantity=i),e.Njj(i)}),e.k0s()(),e.j41(7,"td")(8,"input",75),e.bIt("ngModelChange",function(i){const l=e.eBV(t).$index,m=e.XpG();return e.Njj(m.quantitySelect(i,l))}),e.mxI("ngModelChange",function(i){const l=e.eBV(t).$implicit;return e.DH7(l.quantity,i)||(l.quantity=i),e.Njj(i)}),e.k0s()(),e.j41(9,"td"),e.EFF(10),e.k0s(),e.DNE(11,ps,2,5,"td",76)(12,us,2,4,"td",76),e.j41(13,"td"),e.EFF(14),e.k0s(),e.j41(15,"td")(16,"span",77),e.bIt("click",function(){const i=e.eBV(t).$index,l=e.XpG();return e.Njj(l.deleteRow(i))}),e.nrm(17,"i",78),e.k0s()()()}if(2&a){const t=u.$implicit,s=u.$index,i=e.XpG();e.R7$(2),e.Y8G("name","itemId"+e.eq3(14,ln,s))("items",i.items),e.R50("ngModel",t.itemId),e.R7$(2),e.Y8G("name","unitId"+e.eq3(16,ln,s))("items",t.units),e.R50("ngModel",t.unitId),e.R7$(2),e.Y8G("name","clientQuantity"+e.eq3(18,ln,s)),e.R50("ngModel",t.clientQuantity),e.R7$(2),e.Y8G("name","quantity"+e.eq3(20,ln,s)),e.R50("ngModel",t.quantity),e.R7$(2),e.SpI(" ",t.price," "),e.R7$(),e.Y8G("ngIf",!i.isChangeQuantity&&!i.isDraft),e.R7$(),e.Y8G("ngIf",!i.isChangeQuantity&&!i.isDraft),e.R7$(2),e.SpI("",t.net," ")}}let si=(()=>{class a{constructor(t,s,i,l,m,c,E,P){this.translateService=t,this.offerOrderService=s,this.itemsService=i,this.clientService=l,this.employeeService=m,this.alertService=c,this.datePipe=E,this.ngxLoader=P,this.orderSelected=0,this.isDraft=!1,this.isChangeQuantity=!1,this.isShipping=!1,this.loaderOperationShap=N.$$,this.operationLoader=N.ZW,this.form={},this.truncks=[],this.locations=[],this.discountTypes=[],this.items=[],this.employees=[],this.notifier=new ut.B,this.dismiss=new e.bkB}ngOnInit(){this.GetPersones(),this.getItemsServices(),this.discountTypes=this.offerOrderService.discountTypes,this.discountTypes.forEach(t=>{t.name=this.getTranslationText("sales.salesOrder."+t.name)}),this.getOrder()}getItemsServices(){this.itemsService.getItemDropDown().subscribe(t=>{this.items=t.data})}getLocations(t){this.clientService.GetClientLocations(t).subscribe(s=>{this.locations=s.data})}GetPersones(){this.employeeService.GetAllByType(9).subscribe(t=>{this.employees=t.data})}getTranslationText(t){let s="";return this.translateService.get(t).pipe((0,R.Q)(this.notifier)).subscribe(i=>{s=i}),s}getOrder(){this.offerOrderService.GetOrderDetail(this.orderSelected).subscribe(t=>{this.form=t.data,this.getLocations(this.form.clientId),this.getTotal()},t=>{this.alertService.error(t)})}update(){}getTotal(){let t=0,s=0,i=0;this.form.details.forEach(l=>{l.discount<0&&(l.discoun=0);let m=l.quantity*l.price,c=0;1===l.discountType?c=l.discount:2===l.discountType&&(c=m*l.discount/100),s+=+c;let E=m-c;l.net=E.toFixed(2),t+=+E}),1===this.form.totalAddDiscountType?i=this.form.totalAddDiscount:2===this.form.totalAddDiscountType&&(i=t*this.form.totalAddDiscount/100),this.form.total=t,this.form.totalAddDiscount=this.form.totalAddDiscount,this.form.tax=15*this.form.total/100,this.form.totalNet=this.form.total-i+this.form.tax,this.form.total=this.form.total.toFixed(2),this.form.totalAddDiscount=this.form.totalAddDiscount.toFixed(2),this.form.tax=this.form.tax.toFixed(2),this.form.totalNet=this.form.totalNet.toFixed(2)}quantitySelect(t,s){t&&(t<=0&&(t=1),this.form.details[s].quantity=parseInt(t),this.form.details[s].net=this.form.details[s].price*this.form.details[s].quantity,this.discountSelect(this.form.details[s].discount,s),this.getTotal())}discountSelect(t,s,i=1){if(t){(t=parseInt(t))<=0&&(this.form.details[s].discount=0),1==i&&(this.form.details[s].discount=t);let l=0;1==this.form.details[s].discountType?l=this.form.details[s].discount:(l=this.form.details[s].price*this.form.details[s].quantity*this.form.details[s].discount/100,l=+l.toFixed(2)),this.form.details[s].net=this.form.details[s].price*this.form.details[s].quantity-l,this.form.details[s].net=this.form.details[s].net.toFixed(2),this.getTotal()}}dismissFn(){this.dismiss.emit(!0)}getStatus(t){return 10==t.offerOrderStatus||20==t.offerOrderStatus?"bg-warning-subtle text-warning":30==t.offerOrderStatus?"bg-success-subtle text-success":40==t.offerOrderStatus?"bg-danger-subtle text-danger":50==t.offerOrderStatus?"bg-danger-success text-success":"bg-warning-subtle text-warning"}addRow(){this.form.details.push({itemId:0,unitId:null,units:[],clientQuantity:1,quantity:1,priceUnit:null,discount:0,discountType:1,net:0})}itemSelected(t,s){t&&(this.form.details[s].unitId=t.units.length>0?t.units[0].id:null,this.form.details[s].units=t.units,this.form.details[s].price=t.price,this.quantitySelect(this.form.details[s].quantity,s),this.getTotal())}deleteRow(t){this.form.details.length<=1||(this.form.details.splice(t,1),this.getTotal())}orderFinished(){let t={id:this.form.id,clientId:this.form.clientId,clientVisitDate:this.datePipe.transform(this.form.clientVisitDate,"yyyy-MM-ddTHH:mm:ss.000"),acutalVisitDate:this.datePipe.transform(this.form.acutalVisitDate,"yyyy-MM-ddTHH:mm:ss.000"),offerOrderStatus:this.form.offerOrderStatus,notes:this.form.notes,terms:this.form.terms,changeQuantityMessage:this.form.changeQuantityMessage,salsePersonId:this.form.salsePersonId,clientLocationId:this.form.clientLocationId,totalAddDiscount:this.form.discountAmount,totalAddDiscountType:this.form.isPrecentage?2:1,offerOrderDetails:this.form.details.map(s=>({discount:s.discount,discountType:s.discountType,itemId:s.itemId,clientQuantity:s.clientQuantity,approvedQuantity:s.quantity,id:s.id,price:s.price,unitId:s.unitId,offerOrderMasterId:this.form.id}))};this.ngxLoader.startLoader("operationLoader"),this.offerOrderService.edit(t.id,t).subscribe(s=>{s.success?(this.ngxLoader.stopLoader("operationLoader"),this.alertService.success()):(this.alertService.error(),this.ngxLoader.stopLoader("operationLoader"))},()=>{this.alertService.error(),this.ngxLoader.stopLoader("operationLoader")})}ngOnDestroy(){this.notifier.next(),this.notifier.complete()}static{this.\u0275fac=function(s){return new(s||a)(e.rXU(O.c$),e.rXU(Ge),e.rXU(Jr.N),e.rXU(it.X),e.rXU(It.O),e.rXU(le.u),e.rXU(k.vh),e.rXU(X.eD))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["sales-edit-order"]],inputs:{orderSelected:"orderSelected",isDraft:"isDraft",isChangeQuantity:"isChangeQuantity",isShipping:"isShipping"},outputs:{dismiss:"dismiss"},decls:91,vars:38,consts:[["formEntity","ngForm"],["notes","ngModel"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-dark-subtle"],[1,"card-title","mb-0"],[1,"badge","bg-primary-subtle","text-primary","fs-4"],[1,"badge","bg-danger-subtle","text-danger","fs-4","mx-2"],[3,"class",4,"ngIf"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"hasProgressBar","fgsType","loaderId"],[3,"submit"],[1,"row"],[1,"col-12","col-md-3"],["for","name","translate","",1,"fw-bold","form-label"],["name","clientVisitDate","type","text","mwlFlatpickr","","altFormat","Y-m-d H:i","required","",1,"form-control","flatpickr-input",3,"ngModelChange","ngModel","altInput","enableTime","convertModelValue","dateFormat"],["for","name","translate","",1,"required","fw-bold","form-label"],["name","acutalVisitDate","type","text","mwlFlatpickr","","altFormat","Y-m-d H:i","required","",1,"form-control","flatpickr-input",3,"ngModelChange","ngModel","altInput","enableTime","convertModelValue","dateFormat"],["for","name","translate","orderManagement.order.savedAddress",1,"required","fw-bold","form-label"],["name","clientLocationId","bindValue","id","bindLabel","name","required","",2,"width","100%",3,"ngModelChange","items","ngModel"],["for","name","translate","sales.salesOrder.salsePerson",1,"fw-bold","form-label"],["name","salsePersonId","bindValue","id","bindLabel","name",2,"width","100%",3,"ngModelChange","disabled","items","ngModel"],[1,"col-12","col-md-6"],["for","notes","translate","",1,"fw-bold","form-label"],["rows","1","InputTirmFilter","","name","notes","type","text","id","notes",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["class","col-12 col-md-6",4,"ngIf"],["rows","1","name","terms","type","text",1,"form-control",3,"ngModelChange","placeholder","ngModel"],[1,"row","justify-content-center","my-0"],[1,"card"],[1,"card-header","p-0"],[1,"d-flex","align-items-center"],["translate","sales.salesRequests.items",1,"card-title","flex-grow-1","mb-0"],[1,"card-body"],[1,"table-responsive","table-card"],[1,"table","table-nowrap","align-middle","table-borderless","mb-0"],[1,"table-light","text-muted","p-1"],["translate","sales.salesRequests.itemName",2,"width","20%"],["translate","sales.salesRequests.unit",2,"width","12%"],["translate","sales.salesRequests.clientQuantity",2,"width","10%"],["translate","sales.salesRequests.quantity",2,"width","12%"],["translate","sales.salesRequests.priceUnit",2,"width","12%"],["style","width:12%","translate","sales.salesRequests.discountType",4,"ngIf"],["style","width:12%","translate","sales.salesRequests.discount",4,"ngIf"],["translate","sales.salesRequests.net",2,"width","12%"],[2,"width","5%"],[1,"body-orderEdit"],[1,"border-top","border-top-dashed"],["colspan","5",2,"vertical-align","top"],[1,"cursor-pointer","p-2","mb-0","badge","bg-success-subtle","text-success",3,"click"],[1,"ri-add-fill"],["translate","sales.salesRequests.addItem"],["colspan","3",1,"fw-medium","p-0"],[1,"table","table-borderless","mb-0"],["translate","sales.salesOrder.total",1,"m-0","p-0"],[1,"text-end","m-0","p-0"],["translate","sales.salesOrder.extraDiscount",1,"m-0","p-0"],[1,"input-group","mx-4","my-1",2,"width","80%"],["clearable","false","clearOnBackspace","false","name","totalAddDiscountType","bindValue","id","bindLabel","name",3,"change","ngModelChange","disabled","items","ngModel"],["InputTirmFilter","","name","totalAddDiscount","type","text","id","totalAddDiscount",1,"form-control","fs-6",2,"width","20%",3,"change","ngModelChange","disabled","ngModel"],[1,"m-0","p-0"],["translate","sales.salesOrder.tax",1,"m-0","p-0"],[1,"border-top","border-top-dashed","m-0","p-0"],["scope","row","translate","sales.salesOrder.net",1,"m-0","p-0"],[1,"d-flex","justify-content-center","m-0"],["type","submit","type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],[3,"translate"],["for","changeQuantityMessage","translate","",1,"fw-bold","form-label"],["rows","1","InputTirmFilter","","name","changeQuantityMessage","type","text","id","changeQuantityMessage",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["translate","sales.salesRequests.discountType",2,"width","12%"],["translate","sales.salesRequests.discount",2,"width","12%"],["clearable","false","clearOnBackspace","false","bindValue","id","bindLabel","name",2,"width","100%",3,"change","ngModelChange","name","items","ngModel"],["clearable","false","clearOnBackspace","false","bindValue","id","bindLabel","name",2,"width","100%",3,"ngModelChange","name","items","ngModel"],["type","text","id","clientQuantity",1,"form-control","fs-6",3,"ngModelChange","name","ngModel"],["type","text","id","quantity",1,"form-control","fs-6",3,"ngModelChange","name","ngModel"],[4,"ngIf"],[1,"cursor-pointer","mb-0","p-2","badge","bg-danger-subtle","text-danger",3,"click"],[1,"ri-delete-bin-2-fill"],["InputTirmFilter","","type","text","id","discount",1,"form-control","fs-6",3,"ngModelChange","name","ngModel"]],template:function(s,i){if(1&s){const l=e.RV6();e.j41(0,"div",2)(1,"div",3)(2,"h4",4)(3,"span",5),e.EFF(4),e.k0s(),e.j41(5,"span",6),e.EFF(6),e.k0s(),e.DNE(7,ds,2,4,"span",7),e.k0s(),e.j41(8,"button",8),e.bIt("click",function(){return e.eBV(l),e.Njj(i.dismissFn())}),e.k0s()(),e.j41(9,"div",9),e.nrm(10,"ngx-ui-loader",10),e.j41(11,"form",11,0),e.bIt("submit",function(){return e.eBV(l),e.Njj(i.orderFinished())}),e.j41(13,"div",12)(14,"div",13)(15,"label",14),e.EFF(16,"sales.salesOrder.clientDeliveryDate"),e.k0s(),e.j41(17,"input",15),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.form.clientVisitDate,c)||(i.form.clientVisitDate=c),e.Njj(c)}),e.k0s()(),e.j41(18,"div",13)(19,"label",16),e.EFF(20,"sales.salesOrder.acutalDeliveryDate"),e.k0s(),e.j41(21,"input",17),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.form.acutalVisitDate,c)||(i.form.acutalVisitDate=c),e.Njj(c)}),e.k0s()(),e.j41(22,"div",13),e.nrm(23,"label",18),e.j41(24,"ng-select",19),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.form.clientLocationId,c)||(i.form.clientLocationId=c),e.Njj(c)}),e.k0s()(),e.j41(25,"div",13),e.nrm(26,"label",20),e.j41(27,"ng-select",21),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.form.salsePersonId,c)||(i.form.salsePersonId=c),e.Njj(c)}),e.k0s()(),e.j41(28,"div",22)(29,"label",23),e.EFF(30,"sales.clientCollection.notes"),e.k0s(),e.j41(31,"textarea",24,1),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.form.notes,c)||(i.form.notes=c),e.Njj(c)}),e.k0s()(),e.DNE(33,To,5,1,"div",25),e.j41(34,"div",22)(35,"label",14),e.EFF(36,"sales.salesOrder.terms"),e.k0s(),e.j41(37,"textarea",26),e.nI1(38,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.form.terms,c)||(i.form.terms=c),e.Njj(c)}),e.k0s()()(),e.j41(39,"div",27)(40,"div",28)(41,"div",29)(42,"div",30),e.nrm(43,"h5",31),e.k0s()(),e.j41(44,"div",32)(45,"div",33)(46,"table",34)(47,"thead",35)(48,"tr"),e.nrm(49,"th",36)(50,"th",37)(51,"th",38)(52,"th",39)(53,"th",40),e.DNE(54,cs,1,0,"th",41)(55,ms,1,0,"th",42),e.nrm(56,"th",43)(57,"th",44),e.k0s()(),e.j41(58,"tbody",45),e.Z7z(59,xo,18,22,"tr",null,e.Vm6),e.j41(61,"tr",46)(62,"td",47)(63,"span",48),e.bIt("click",function(){return e.eBV(l),e.Njj(i.addRow())}),e.nrm(64,"i",49)(65,"span",50),e.k0s()(),e.j41(66,"td",51)(67,"table",52)(68,"tbody")(69,"tr"),e.nrm(70,"td",53),e.j41(71,"td",54),e.EFF(72),e.k0s()(),e.j41(73,"tr"),e.nrm(74,"td",55),e.j41(75,"td",54)(76,"div",56)(77,"ng-select",57),e.bIt("change",function(){return e.eBV(l),e.Njj(i.getTotal())}),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.form.totalAddDiscountType,c)||(i.form.totalAddDiscountType=c),e.Njj(c)}),e.k0s(),e.j41(78,"input",58),e.bIt("change",function(){return e.eBV(l),e.Njj(i.getTotal())}),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.form.totalAddDiscount,c)||(i.form.totalAddDiscount=c),e.Njj(c)}),e.k0s()()()(),e.j41(79,"tr",59),e.nrm(80,"td",60),e.j41(81,"td",54),e.EFF(82),e.k0s()(),e.j41(83,"tr",61),e.nrm(84,"th",62),e.j41(85,"th",54),e.EFF(86),e.k0s()()()()()()()()()()()(),e.j41(87,"div",63)(88,"button",64),e.nrm(89,"i",65)(90,"span",66),e.k0s()()()()()}if(2&s){const l=e.sdS(12);e.R7$(4),e.SpI("#SO#",i.form.id," "),e.R7$(2),e.SpI("",i.form.clientName," "),e.R7$(),e.Y8G("ngIf",i.form.offerOrderStatus>=0),e.R7$(3),e.Y8G("hasProgressBar",!1)("fgsType",i.loaderOperationShap)("loaderId",i.operationLoader),e.R7$(7),e.R50("ngModel",i.form.clientVisitDate),e.Y8G("altInput",!0)("enableTime",!0)("convertModelValue",!0)("dateFormat","Y-m-d H:i"),e.R7$(4),e.R50("ngModel",i.form.acutalVisitDate),e.Y8G("altInput",!0)("enableTime",!0)("convertModelValue",!0)("dateFormat","Y-m-d H:i"),e.R7$(3),e.Y8G("items",i.locations),e.R50("ngModel",i.form.clientLocationId),e.R7$(3),e.Y8G("disabled",i.isDraft)("items",i.employees),e.R50("ngModel",i.form.salsePersonId),e.R7$(4),e.R50("ngModel",i.form.notes),e.R7$(2),e.Y8G("ngIf",i.isChangeQuantity),e.R7$(4),e.Y8G("placeholder",e.bMT(38,36,"sales.salesOrder.termsPlaceholder")),e.R50("ngModel",i.form.terms),e.R7$(17),e.Y8G("ngIf",!i.isChangeQuantity&&!i.isDraft),e.R7$(),e.Y8G("ngIf",!i.isChangeQuantity&&!i.isDraft),e.R7$(4),e.Dyx(i.form.details),e.R7$(13),e.JRh(i.form.total),e.R7$(5),e.Y8G("disabled",i.isChangeQuantity)("items",i.discountTypes),e.R50("ngModel",i.form.totalAddDiscountType),e.R7$(),e.Y8G("disabled",i.isChangeQuantity),e.R50("ngModel",i.form.totalAddDiscount),e.R7$(4),e.JRh(i.form.tax),e.R7$(4),e.JRh(i.form.totalNet),e.R7$(2),e.Y8G("disabled",!l.valid)}},dependencies:[k.bT,g.qT,g.me,g.BC,g.cb,g.YS,g.vS,g.cV,Ce.kL,O.Mm,X.Cv,fe.vr,Se.m,O.D9],encapsulation:2})}}return a})();const ko=()=>["salesOrder.register"],gs=()=>["salesOrder.edit"];function Fo(a,u){1&a&&(e.j41(0,"tr",28),e.nrm(1,"th",29),e.j41(2,"th",30),e.EFF(3,"#"),e.k0s(),e.j41(4,"th",31),e.nrm(5,"i",32),e.EFF(6," orderManagement.order.orderCode "),e.k0s(),e.j41(7,"th",33),e.nrm(8,"i",32),e.EFF(9," orderManagement.order.creation "),e.k0s(),e.j41(10,"th",34),e.EFF(11," orderManagement.order.status "),e.k0s(),e.j41(12,"th",35),e.nrm(13,"i",32),e.EFF(14," orderManagement.order.agentName "),e.k0s(),e.j41(15,"th",36),e.EFF(16," sales.salesOrder.salsePerson "),e.k0s(),e.j41(17,"th",37),e.nrm(18,"i",32),e.EFF(19," sales.salesOrder.clientVisitDate "),e.k0s(),e.j41(20,"th",38),e.nrm(21,"i",32),e.EFF(22," sales.salesOrder.totalQuantity "),e.k0s(),e.j41(23,"th",39),e.nrm(24,"i",32),e.EFF(25," sales.salesOrder.totalDiscount "),e.k0s(),e.j41(26,"th",40),e.nrm(27,"i",32),e.EFF(28," sales.salesOrder.netPrice "),e.k0s(),e.nrm(29,"th",41),e.k0s())}function Ro(a,u){if(1&a){const t=e.RV6();e.j41(0,"button",51),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,l=e.XpG(),m=e.sdS(48);return e.Njj(l.openModal(i.id,m,"xl"))}),e.nrm(1,"i",52)(2,"span",53),e.k0s()}}function Mo(a,u){if(1&a){const t=e.RV6();e.j41(0,"tr",42)(1,"td"),e.nrm(2,"button",43),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td",44),e.bIt("click",function(){const i=e.eBV(t).$implicit,l=e.XpG(),m=e.sdS(46);return e.Njj(l.openModalClient(i,m,"lg"))}),e.j41(6,"bdi",45),e.EFF(7),e.k0s()(),e.j41(8,"td")(9,"span",46),e.EFF(10),e.k0s(),e.EFF(11),e.nI1(12,"date"),e.k0s(),e.j41(13,"td")(14,"span"),e.nrm(15,"span",47),e.k0s()(),e.j41(16,"td",44),e.bIt("click",function(){const i=e.eBV(t).$implicit,l=e.XpG(),m=e.sdS(50);return e.Njj(l.openModal(i.clientId,m,"md"))}),e.j41(17,"a",48),e.EFF(18),e.k0s()(),e.j41(19,"td"),e.EFF(20),e.k0s(),e.j41(21,"td"),e.EFF(22),e.nI1(23,"date"),e.k0s(),e.j41(24,"td"),e.EFF(25),e.k0s(),e.j41(26,"td"),e.EFF(27),e.k0s(),e.j41(28,"td"),e.EFF(29),e.k0s(),e.j41(30,"td"),e.nrm(31,"i",49),e.DNE(32,Ro,3,0,"button",50),e.k0s()()}if(2&a){const t=u.$implicit,s=u.rowIndex,i=u.expanded,l=e.XpG();e.R7$(2),e.Y8G("pRowToggler",t)("ngClass",i?" ri-arrow-down-s-line":"  ri-arrow-up-s-line"),e.R7$(2),e.JRh(s+1),e.R7$(3),e.SpI("#SO#",t.id,""),e.R7$(3),e.SpI("",t.creatorName," "),e.R7$(),e.SpI(" ",e.i5U(12,17,t.creationTime,"yyyy-MM-dd")," "),e.R7$(3),e.ZvI("badge ",l.getStatus(t),""),e.R7$(),e.FS9("translate","sales.salesOrder."+t.offerOrderStatusValue),e.R7$(3),e.SpI(" ",t.clientName," "),e.R7$(2),e.JRh(t.salsePersonName),e.R7$(2),e.SpI(" ",e.i5U(23,20,t.clientVisitDate,"yyyy-MM-dd"),""),e.R7$(3),e.JRh(t.totalQuantity),e.R7$(2),e.JRh(t.totalDiscount),e.R7$(2),e.JRh(t.netPrice),e.R7$(3),e.Y8G("hasPermission",e.lJ4(23,gs))}}function Oo(a,u){if(1&a&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td"),e.EFF(10),e.nI1(11,"translate"),e.k0s(),e.j41(12,"td"),e.EFF(13),e.k0s(),e.j41(14,"td"),e.EFF(15),e.k0s()()),2&a){const t=u.$implicit;e.R7$(2),e.JRh(t.itemName),e.R7$(2),e.JRh(t.unitName),e.R7$(2),e.JRh(t.clientQuantity),e.R7$(2),e.JRh(t.approvedQuantity),e.R7$(2),e.SpI("",e.bMT(11,7,"sales.salesOrder."+t.discountTypeValue)," "),e.R7$(3),e.JRh(t.discount),e.R7$(2),e.JRh(t.price)}}function ar(a,u){if(1&a&&(e.j41(0,"tr")(1,"td",54)(2,"div")(3,"table",55)(4,"thead")(5,"tr",56),e.nrm(6,"th",57)(7,"th",58)(8,"th",59)(9,"th",60)(10,"th",61)(11,"th",62)(12,"th",63),e.k0s()(),e.j41(13,"tbody"),e.DNE(14,Oo,16,9,"tr",64),e.k0s()()()()()),2&a){const t=u.$implicit;e.R7$(14),e.Y8G("ngForOf",t.offerOrderDetails)}}function wo(a,u){1&a&&(e.j41(0,"div",65),e.EFF(1," general.table.noData "),e.k0s())}function No(a,u){if(1&a){const t=e.RV6();e.j41(0,"div",66)(1,"div",67),e.nrm(2,"ngb-pagination-info",68),e.j41(3,"table-length",69),e.bIt("lengthChange",function(i){e.eBV(t);const l=e.XpG();return e.Njj(l.ListItemChange(i))}),e.k0s()(),e.j41(4,"div",70)(5,"ngb-pagination",71),e.bIt("pageChange",function(i){e.eBV(t);const l=e.XpG();return e.Njj(l.pageChanged(i))}),e.mxI("pageChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.pagination.pageNumber,i)||(l.pagination.pageNumber=i),e.Njj(i)}),e.k0s()()()}if(2&a){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function Eo(a,u){if(1&a){const t=e.RV6();e.j41(0,"delete-modal",72),e.bIt("deleteConfirm",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.DeleteConfirm())})("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}}function Go(a,u){if(1&a){const t=e.RV6();e.j41(0,"app-all-orders-details",73),e.bIt("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&a){const t=e.XpG();e.Y8G("orderDetails",t.orderSelected)}}function Do(a,u){if(1&a){const t=e.RV6();e.j41(0,"sales-edit-order",74),e.bIt("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&a){const t=e.XpG();e.Y8G("orderSelected",t.operationId)}}function ve(a,u){if(1&a){const t=e.RV6();e.j41(0,"client-summary",75),e.bIt("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&a){const t=e.XpG();e.Y8G("clientId",t.operationId)}}let be=(()=>{class a extends De.w{constructor(t,s,i,l,m,c,E,P,q,D,J,ee,W,Q){super(t,s,E,i,l,m,c),this.baseService=i,this.authDaamService=P,this.teamService=q,this.employeeService=D,this.regionService=J,this.cityService=ee,this.excelService=W,this.router=Q,this.title="orderManagement.order.title",this.titleOperation="orderManagement.order.titleOperation",this.keySelected="",this.searchForm={},this.isResolveList=!0,this.employeeGroups=[],this.activeindex="2",this.active=2,this.clientSelected=0,this.status=[],this.countLoad=2,this.isOrderEdit=!1,this.orderSelected={},this.users=[],this.statusCount={},this.salesPersons=[],this.regions=[],this.cities=[],this.setDates=(V,z,ge)=>{if(V?.from||V?.to){const Oe=V.to||V.from;this.pagination[z]=this.datePipe.transform(V.from||V.to,"yyyy-MM-ddT00:00:00"),this.pagination[ge]=this.datePipe.transform(Oe,"yyyy-MM-ddT23:59:59.999")}else this.pagination[z]=null,this.pagination[ge]=null},this.configRoute(),this.GetSalesPersons(),this.GetRegions(),this.GetCities()}GetRegions(){this.regionService.getDropDown().subscribe(t=>{this.regions=t.data},t=>{console.log(t)})}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetSalesPersons(){this.employeeService.GetAllByType(9).subscribe(t=>{this.salesPersons=t.data},t=>{console.log(t)})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,R.Q)(this.notifier)).subscribe(s=>{s?this.alertService.success():this.alertService.error("general.message."+s)},s=>{this.alertService.error()})}mapRegisterForm(t){let s={...t};return s.employeeCode=0,s}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader("allLoader"),this.setDates(t.dates,"visitDateFrom","visitDateTo"),this.setDates(t.creationDates,"creationTimeFrom","creationTimeTo"),this.loadentities()}LoadSuccess(){this.ngxLoader.stopLoader("allLoader")}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems},this.loadentities()}configRoute(){this.routerActive.data.pipe((0,R.Q)(this.notifier)).subscribe(t=>{this.entities=t.data,this.pagination.totalItems=t.data?.totalItems},()=>{this.alertService.error()})}mapExcel(){let t=[];return this.entities.forEach(s=>{t.push({"Order Code":s.orderCode,"Created Date":s.createdDate,"City Name":s.cityName,"District Name":s.districtName?s.districtName:"--",Status:this.translateService.instant(this.getTrnslate(s)),"Agent Name":s.agentName,Mobile:s.mobile,"Channel Name":s.channelName,"Assigned To":s.teamNames,Times:s.workTimes,"Visit Date":s.visitDate,Services:s.services})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}getStatus(t){return 10==t.offerOrderStatus||20==t.offerOrderStatus?"bg-warning-subtle text-warning":30==t.offerOrderStatus?"bg-success-subtle text-success":40==t.offerOrderStatus?"bg-danger-subtle text-danger":50==t.offerOrderStatus?"bg-danger-success text-success":"bg-warning-subtle text-warning"}checkEdit(t){return!t.isCancel&&!t.isFinish}getTrnslate(t){return t.isCancel?"orderManagement.order.cancel":t.isFinish?"orderManagement.order.finish":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen?"orderManagement.order.reopen":t.isAssign?"orderManagement.order.assign":t.isConfirmed?"orderManagement.order.confirmed":t.isFree?"orderManagement.order.free":"orderManagement.order.new"}openModalClient(t,s,i="xl"){this.clientSelected=t.orderCode,this.orderSelected=t,this.isOrderEdit=!1,this.modalService.open(s,{centered:!0,size:i})}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}goNew(){this.router.navigateByUrl("/sales/new")}static{this.\u0275fac=function(s){return new(s||a)(e.rXU(A.nX),e.rXU(O.c$),e.rXU(Ge),e.rXU(le.u),e.rXU(k.vh),e.rXU(X.eD),e.rXU(F.Bq),e.rXU(ft.J),e.rXU(Ht.n),e.rXU(It.O),e.rXU(Et.S),e.rXU(Ue.h),e.rXU(He.V),e.rXU(A.Ix))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["app-all-sales-order"]],features:[e.Vt3],decls:51,vars:51,consts:[["tableMaster",""],["deleteModal",""],["orderViewModel",""],["SalesEditModel",""],["ClientInfo",""],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"addNew","reset","search","exportXlsx","addPermission","showAdd","showExport","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","id","name","id",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],["InputTirmFilter","","type","search","id","clientName","name","clientName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["name","regionId","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],["name","cityId","bindValue","code","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],[2,"width",".2%"],["translate","",2,"width",".5%"],["pSortableColumn","id","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["pSortableColumn","creationTime","translate","",2,"width","12%"],["pSortableColumn","status","translate","",2,"width","6%"],["pSortableColumn","clientId","translate","",2,"width","10%"],["translate","",2,"width","8%"],["pSortableColumn","clientVisitDate","translate","",2,"width","10%"],["pSortableColumn","totalQuantity","translate","",2,"width","8%"],["pSortableColumn","totalDiscount","translate","",2,"width","8%"],["pSortableColumn","netPrice","translate","",2,"width","8%"],["translate","",2,"width","10%"],[1,"fs-5"],["type","button","pRipple","",1,"border-0","p-button-text","p-button-rounded","p-button-plain",3,"pRowToggler","ngClass"],[3,"click"],[1,"code-pointer"],[1,"badge","bg-success-subtle","text-success"],[3,"translate"],["href","javascript:void(0)",1,"link-primary","link-offset-2","text-decoration-underline","link-underline-opacity-25","link-underline-opacity-100-hover"],[1,"ri-history-fill","d-inline","text-primary","fs-16","align-middle","me-1"],["type","button","class","btn px-4 w-auto btn-sm btn-primary btn-label  waves-effect waves-light rounded-pill",3,"click",4,"hasPermission"],["type","button",1,"btn","px-4","w-auto","btn-sm","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"click"],[1,"ri-edit-2-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.edit"],["colspan","17"],["dataKey","id"],[1,"bg-light"],["translate","sales.salesOrder.itemName",2,"width","10%"],["translate","sales.salesOrder.unit",2,"width","6%"],["translate","sales.salesOrder.clientQuantity",2,"width","8%"],["translate","sales.salesOrder.approvedQuantity",2,"width","8%"],["translate","sales.salesOrder.discountType",2,"width","5%"],["translate","sales.salesOrder.discount",2,"width","5%"],["translate","sales.salesOrder.price",2,"width","5%"],[4,"ngFor","ngForOf"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"deleteConfirm","dismiss"],[3,"dismiss","orderDetails"],[3,"dismiss","orderSelected"],[3,"dismiss","clientId"]],template:function(s,i){if(1&s){const l=e.RV6();e.j41(0,"div",5)(1,"div",6)(2,"div",7),e.nrm(3,"ngx-ui-loader",8),e.j41(4,"base-filter",9),e.bIt("addNew",function(){return e.eBV(l),e.Njj(i.goNew())})("reset",function(){return e.eBV(l),e.Njj(i.onReset())})("search",function(){return e.eBV(l),e.Njj(i.onSearch())})("exportXlsx",function(){return e.eBV(l),e.Njj(i.onExportXlsx())}),e.qex(5,10),e.j41(6,"div",11)(7,"div",12)(8,"input",13),e.nI1(9,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.id,c)||(i.pagination.id=c),e.Njj(c)}),e.k0s(),e.nrm(10,"i",14),e.k0s()(),e.j41(11,"div",11)(12,"input",15),e.nI1(13,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.searchForm.creationDates,c)||(i.searchForm.creationDates=c),e.Njj(c)}),e.k0s()(),e.j41(14,"div",11)(15,"div",12)(16,"input",16),e.nI1(17,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.clientName,c)||(i.pagination.clientName=c),e.Njj(c)}),e.k0s(),e.nrm(18,"i",14),e.k0s()(),e.j41(19,"div",11)(20,"div",12)(21,"ng-select",17),e.nI1(22,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.salesPersonId,c)||(i.pagination.salesPersonId=c),e.Njj(c)}),e.k0s()()(),e.j41(23,"div",11)(24,"input",15),e.nI1(25,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.searchForm.dates,c)||(i.searchForm.dates=c),e.Njj(c)}),e.k0s()(),e.j41(26,"div",11)(27,"div",12)(28,"ng-select",18),e.nI1(29,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.regionId,c)||(i.pagination.regionId=c),e.Njj(c)}),e.k0s()()(),e.j41(30,"div",11)(31,"div",12)(32,"ng-select",19),e.nI1(33,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.cityId,c)||(i.pagination.cityId=c),e.Njj(c)}),e.k0s()()(),e.bVm(),e.k0s(),e.j41(34,"div",20)(35,"div",21)(36,"p-table",22,0),e.bIt("onLazyLoad",function(c){return e.eBV(l),e.Njj(i.tableChange(c))})("selectionChange",function(c){return e.eBV(l),e.Njj(i.onSelectionChange(c))}),e.DNE(38,Fo,30,0,"ng-template",23)(39,Mo,33,24,"ng-template",24)(40,ar,15,1,"ng-template",25),e.k0s()(),e.DNE(41,wo,2,0,"div",26)(42,No,6,8,"div",27),e.k0s()()()(),e.DNE(43,Eo,1,0,"ng-template",null,1,e.C5r)(45,Go,1,1,"ng-template",null,2,e.C5r)(47,Do,1,1,"ng-template",null,3,e.C5r)(49,ve,1,1,"ng-template",null,4,e.C5r)}2&s&&(e.R7$(3),e.Y8G("loaderId","allLoader"),e.R7$(),e.Y8G("addPermission",e.lJ4(50,ko))("showAdd",!0)("showExport",!1)("totalItems",i.pagination.totalItems)("title",i.title),e.R7$(4),e.FS9("placeholder",e.bMT(9,36,"orderManagement.order.orderCode")),e.R50("ngModel",i.pagination.id),e.R7$(4),e.FS9("placeholder",e.bMT(13,38,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",i.searchForm.creationDates),e.R7$(4),e.FS9("placeholder",e.bMT(17,40,"orderManagement.order.agentName")),e.R50("ngModel",i.pagination.clientName),e.R7$(5),e.FS9("placeholder",e.bMT(22,42,"sales.salesOrder.salsePerson")),e.Y8G("items",i.salesPersons)("multiple",!1),e.R50("ngModel",i.pagination.salesPersonId),e.R7$(3),e.FS9("placeholder",e.bMT(25,44,"sales.salesOrder.clientVisitDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",i.searchForm.dates),e.R7$(4),e.FS9("placeholder",e.bMT(29,46,"client.client.regionName")),e.Y8G("items",i.regions)("multiple",!1),e.R50("ngModel",i.pagination.regionId),e.R7$(4),e.FS9("placeholder",e.bMT(33,48,"client.client.cityName")),e.Y8G("items",i.cities)("multiple",!1),e.R50("ngModel",i.pagination.cityId),e.R7$(4),e.Y8G("value",i.entities)("rows",i.pagination.pageSize)("lazy",!0)("totalRecords",i.pagination.totalItems),e.R7$(5),e.Y8G("ngIf",i.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",i.pagination.totalItems>0))},dependencies:[k.YU,k.Sq,k.bT,g.me,g.Q0,g.BC,g.vS,F.s5,Ce.kL,Ye.b,rt.w,$e.p,qe.g,Gt,O.Mm,Y.XI,Te.Ei,Y.Tg,Y.FP,X.Cv,fe.vr,Se.m,Be.p,si,k.vh,O.D9],encapsulation:2})}}return a})(),or=(()=>{class a extends Qt.d{getTrunckStatus(){return[{id:10,name:"WaitTrunk"},{id:20,name:"ArriveStore"},{id:30,name:"GoClient"},{id:40,name:"ArriveClient"},{id:50,name:"DeliveryClient"},{id:60,name:"DelayOrder"},{id:70,name:"CancelOrder"}]}constructor(t){super(t,nt.c.apiUrl+"OrderReceived/")}GetOrderAssignTrunk(t){return this.http.post(this.baseUrl+"OrderAssignTrunk",t)}changeStatus(t){return this.http.post(this.baseUrl+"changeStatus",t)}PrintOrderReceived(t){return this.http.get(this.baseUrl+"PrintOrderReceived/"+t,{responseType:"blob"})}static{this.\u0275fac=function(s){return new(s||a)(e.KVO(Ot.Qq))}}static{this.\u0275prov=e.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})();var Lo=x(91020);let Dn=(()=>{class a{constructor(t,s,i,l){this.cancelReasonService=t,this.orderService=s,this.ngxLoader=i,this.alertService=l,this.cancelReasons=[],this.form={},this.orderId=0,this.loaderOperationShap=N.$$,this.operationLoader=N.ZW,this.notifier=new ut.B,this.success=new e.bkB,this.dismiss=new e.bkB}ngOnInit(){this.GetReturnReasons()}GetReturnReasons(){this.cancelReasonService.getDropDown().subscribe(t=>{this.cancelReasons=t.data},t=>{console.log(t)})}onCancelOrder(){let t={cancelReasonId:this.form.cancelReasonCode,id:this.orderId};this.ngxLoader.startLoader(this.operationLoader),this.orderService.CancelOfferOrder(t).pipe((0,R.Q)(this.notifier)).subscribe(s=>{this.ngxLoader.stopLoader(this.operationLoader),s.success?(this.alertService.success(),this.success.emit(!0),this.dismiss.emit(!0)):this.alertService.error()},()=>{this.alertService.error(),this.ngxLoader.stopLoader(this.operationLoader)})}dismissFn(){this.dismiss.emit(!0)}static{this.\u0275fac=function(s){return new(s||a)(e.rXU(Lo.e),e.rXU(Ge),e.rXU(X.eD),e.rXU(le.u))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["cancel-sales-model"]],inputs:{orderId:"orderId"},outputs:{success:"success",dismiss:"dismiss"},decls:19,vars:10,consts:[["formEntity","ngForm"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["translate","orderManagement.order.cancelReasonName",1,"fw-bold","fs-4"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"hasProgressBar","fgsType","loaderId"],[3,"ngSubmit"],[1,"row"],[1,"mb-3"],["for","actionMismatch","translate","",1,"required","fw-bold","form-label"],["name","name","bindValue","code","bindLabel","name","required","",3,"ngModelChange","placeholder","items","multiple","ngModel"],[1,"text-center"],["type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"]],template:function(s,i){if(1&s){const l=e.RV6();e.j41(0,"div",1)(1,"div",2)(2,"h4",3),e.nrm(3,"span",4),e.k0s(),e.j41(4,"button",5),e.bIt("click",function(){return e.eBV(l),e.Njj(i.dismissFn())}),e.k0s()(),e.j41(5,"div",6),e.nrm(6,"ngx-ui-loader",7),e.j41(7,"form",8,0),e.bIt("ngSubmit",function(){return e.eBV(l),e.Njj(i.onCancelOrder())}),e.j41(9,"div",9)(10,"div",10)(11,"label",11),e.EFF(12,"orderManagement.order.cancelReasonName"),e.k0s(),e.j41(13,"ng-select",12),e.nI1(14,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.form.cancelReasonCode,c)||(i.form.cancelReasonCode=c),e.Njj(c)}),e.k0s()()(),e.j41(15,"div",13)(16,"button",14),e.nrm(17,"i",15)(18,"span",16),e.k0s()()()()()}if(2&s){const l=e.sdS(8);e.R7$(6),e.Y8G("hasProgressBar",!1)("fgsType",i.loaderOperationShap)("loaderId",i.operationLoader),e.R7$(7),e.FS9("placeholder",e.bMT(14,8,"orderManagement.order.cancelReasonName")),e.Y8G("items",i.cancelReasons)("multiple",!1),e.R50("ngModel",i.form.cancelReasonCode),e.R7$(3),e.Y8G("disabled",!l.valid)}},dependencies:[g.qT,g.BC,g.cb,g.YS,g.vS,g.cV,O.Mm,X.Cv,fe.vr,O.D9],encapsulation:2})}}return a})();const Vo=()=>["salesOrder.register"],Po=()=>["shippingOrder.completeOrder"],Bo=()=>["shippingOrder.printItem"],hs=()=>["shippingOrder.sureOrder"],$o=()=>["shippingOrder.cancel"];function Ne(a,u){1&a&&(e.j41(0,"tr",29),e.nrm(1,"th",30),e.j41(2,"th",31),e.EFF(3,"#"),e.k0s(),e.j41(4,"th",32),e.nrm(5,"i",33),e.EFF(6," orderManagement.order.orderCode "),e.k0s(),e.j41(7,"th",34),e.nrm(8,"i",33),e.EFF(9," orderManagement.order.creation "),e.k0s(),e.j41(10,"th",35),e.nrm(11,"i",33),e.EFF(12," orderManagement.order.agentName "),e.k0s(),e.j41(13,"th",36),e.nrm(14,"i",33),e.EFF(15," sales.salesOrder.clientVisitDate "),e.k0s(),e.j41(16,"th",37),e.EFF(17," sales.salesOrder.salsePerson "),e.k0s(),e.j41(18,"th",38),e.nrm(19,"i",33),e.EFF(20," sales.salesOrder.shippingTruckName "),e.k0s(),e.j41(21,"th",37),e.EFF(22," sales.salesOrder.totalQuantity "),e.k0s(),e.j41(23,"th",39),e.EFF(24," sales.salesOrder.clientLocationName "),e.k0s(),e.nrm(25,"th",40),e.k0s())}function _s(a,u){1&a&&e.nrm(0,"span",49)}function Ln(a,u){if(1&a&&(e.j41(0,"a",50),e.nrm(1,"i",51),e.k0s()),2&a){const t=e.XpG().$implicit,s=e.XpG();e.Y8G("href",s.mapUrl(null==t?null:t.lng,null==t?null:t.lat),e.B4B)}}function fs(a,u){1&a&&(e.j41(0,"td")(1,"button",52),e.nI1(2,"translate"),e.nrm(3,"i",53),e.k0s(),e.j41(4,"button",54),e.nI1(5,"translate"),e.nrm(6,"i",55),e.k0s()()),2&a&&(e.R7$(),e.FS9("pTooltip",e.bMT(2,2,"orderManagement.order.changeTeamStatus")),e.R7$(3),e.FS9("pTooltip",e.bMT(5,4,"orderManagement.order.finishOrder")))}function lr(a,u){if(1&a){const t=e.RV6();e.j41(0,"button",63),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2).$implicit,l=e.XpG(),m=e.sdS(50);return e.Njj(l.openStatusModal(i.id,m,60,"md"))}),e.nrm(2,"i",64),e.k0s()}2&a&&e.FS9("pTooltip",e.bMT(1,1,"sales.salesOrder.finihedOrder"))}function st(a,u){if(1&a){const t=e.RV6();e.j41(0,"li",65),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2).$implicit,l=e.XpG();return e.Njj(l.PrintOrderReceived(i.id))}),e.j41(1,"span",66),e.nrm(2,"i",67)(3,"span",68),e.k0s()()}}function bs(a,u){if(1&a){const t=e.RV6();e.j41(0,"li",65),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2).$implicit,l=e.XpG(),m=e.sdS(50);return e.Njj(l.openStatusModal(i.id,m,40,"md"))}),e.j41(1,"span",66),e.nrm(2,"i",69)(3,"span",70),e.k0s()()}}function vs(a,u){if(1&a){const t=e.RV6();e.j41(0,"li",65),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2).$implicit,l=e.XpG(),m=e.sdS(46);return e.Njj(l.openModal(i.id,m))}),e.j41(1,"span",66),e.nrm(2,"i",71)(3,"span",72),e.k0s()()}}function Cs(a,u){1&a&&(e.j41(0,"td")(1,"div",56),e.DNE(2,lr,3,3,"button",57),e.j41(3,"span",56)(4,"div",58)(5,"button",59),e.nrm(6,"i",60),e.k0s(),e.j41(7,"ul",61),e.DNE(8,st,4,0,"li",62)(9,bs,4,0,"li",62)(10,vs,4,0,"li",62),e.k0s()()()()()),2&a&&(e.R7$(2),e.Y8G("hasPermission",e.lJ4(4,Po)),e.R7$(6),e.Y8G("hasPermission",e.lJ4(5,Bo)),e.R7$(),e.Y8G("hasPermission",e.lJ4(6,hs)),e.R7$(),e.Y8G("hasPermission",e.lJ4(7,$o)))}function Ss(a,u){if(1&a&&(e.j41(0,"tr",41)(1,"td"),e.nrm(2,"button",42),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td")(6,"bdi",43),e.EFF(7),e.k0s()(),e.j41(8,"td")(9,"span",44),e.EFF(10),e.k0s(),e.EFF(11),e.nI1(12,"date"),e.k0s(),e.j41(13,"td")(14,"span",45),e.EFF(15),e.k0s()(),e.j41(16,"td"),e.EFF(17),e.nI1(18,"date"),e.k0s(),e.j41(19,"td"),e.EFF(20),e.k0s(),e.j41(21,"td"),e.EFF(22),e.k0s(),e.j41(23,"td"),e.EFF(24),e.k0s(),e.j41(25,"td"),e.DNE(26,_s,1,0,"span",46)(27,Ln,2,1,"a",47),e.k0s(),e.DNE(28,fs,7,6,"td",48)(29,Cs,11,8,"td",48),e.k0s()),2&a){const t=u.$implicit,s=u.rowIndex,i=u.expanded,l=e.XpG();e.R7$(2),e.Y8G("pRowToggler",t)("ngClass",i?" ri-arrow-down-s-line":"  ri-arrow-up-s-line"),e.R7$(2),e.JRh(s+1),e.R7$(3),e.SpI("#SO#",t.offerOrderMasterId,""),e.R7$(3),e.SpI("",t.creatorName," "),e.R7$(),e.SpI(" ",e.i5U(12,15,t.creationTime,"yyyy-MM-dd HH:mm")," "),e.R7$(4),e.SpI("",t.clientName," "),e.R7$(2),e.SpI(" ",e.i5U(18,18,t.deliveryDate,"yyyy-MM-dd HH:mm"),""),e.R7$(3),e.JRh(t.salsePersonName),e.R7$(2),e.JRh(t.shippingTruckName),e.R7$(2),e.JRh(t.totalQuantity),e.R7$(2),e.Y8G("ngIf",""==t.lng),e.R7$(),e.Y8G("ngIf",null==t?null:t.lng),e.R7$(),e.Y8G("ngIf",l.isTrunck),e.R7$(),e.Y8G("ngIf",!l.isTrunck)}}function js(a,u){1&a&&(e.j41(0,"tr"),e.nrm(1,"th",77)(2,"th",78)(3,"th",79)(4,"th",80),e.k0s())}function ys(a,u){if(1&a&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td")(8,"span"),e.EFF(9),e.k0s()()()),2&a){const t=u.$implicit;e.R7$(2),e.JRh(t.itemName),e.R7$(2),e.JRh(t.unitName),e.R7$(2),e.JRh(t.clientQuantity),e.R7$(3),e.JRh(t.approvedQuantity)}}function Je(a,u){1&a&&(e.j41(0,"tr"),e.nrm(1,"td",81),e.k0s())}function Xo(a,u){if(1&a&&(e.j41(0,"tr")(1,"td",73)(2,"div",74)(3,"p-table",75),e.DNE(4,js,5,0,"ng-template",24)(5,ys,10,4,"ng-template",25)(6,Je,2,0,"ng-template",76),e.k0s()()()()),2&a){const t=u.$implicit;e.R7$(3),e.Y8G("value",t.details)}}function at(a,u){1&a&&(e.j41(0,"div",82),e.EFF(1," general.table.noData "),e.k0s())}function Ao(a,u){if(1&a){const t=e.RV6();e.j41(0,"div",83)(1,"div",84),e.nrm(2,"ngb-pagination-info",85),e.j41(3,"table-length",86),e.bIt("lengthChange",function(i){e.eBV(t);const l=e.XpG();return e.Njj(l.ListItemChange(i))}),e.k0s()(),e.j41(4,"div",87)(5,"ngb-pagination",88),e.bIt("pageChange",function(i){e.eBV(t);const l=e.XpG();return e.Njj(l.pageChanged(i))}),e.mxI("pageChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.pagination.pageNumber,i)||(l.pagination.pageNumber=i),e.Njj(i)}),e.k0s()()()}if(2&a){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function Is(a,u){if(1&a){const t=e.RV6();e.j41(0,"form",89,5),e.bIt("ngSubmit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.cancelOrder())}),e.nrm(2,"ngx-ui-loader",90),e.j41(3,"div",91)(4,"div",92)(5,"button",93),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()(),e.j41(6,"div",94)(7,"div",95),e.nrm(8,"lord-icon",96),e.j41(9,"div",97),e.nrm(10,"h3",98)(11,"p",99),e.k0s()(),e.j41(12,"div",100),e.nrm(13,"button",101),e.j41(14,"button",102),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()()()()()}if(2&a){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}function Jt(a,u){if(1&a){const t=e.RV6();e.j41(0,"cancel-sales-model",103),e.bIt("success",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.reload())})("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&a){const t=e.XpG();e.Y8G("orderId",t.orderSelected)}}function ai(a,u){if(1&a){const t=e.RV6();e.j41(0,"order-timeline",104),e.bIt("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&a){const t=e.XpG();e.Y8G("orderSelected",t.orderSelected)}}function dr(a,u){if(1&a){const t=e.RV6();e.j41(0,"form",89,5),e.bIt("ngSubmit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.SubmitOrder())}),e.nrm(2,"ngx-ui-loader",90),e.j41(3,"div",91)(4,"div",92)(5,"button",93),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()(),e.j41(6,"div",94)(7,"div",95),e.nrm(8,"lord-icon",96),e.j41(9,"div",97),e.nrm(10,"h3",98)(11,"p",99),e.k0s()(),e.j41(12,"div",100),e.nrm(13,"button",101),e.j41(14,"button",102),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()()()()()}if(2&a){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}let je=(()=>{class a extends De.w{constructor(t,s,i,l,m,c,E,P,q,D,J,ee,W,Q){super(t,s,P,i,m,c,E),this.baseService=i,this.offerOrderService=l,this.authDaamService=q,this.employeeService=D,this.regionService=J,this.cityService=ee,this.router=W,this.excelService=Q,this.title="sales.salesOrder.assignOrder",this.titleOperation="sales.salesOrder.assignOrder",this.keySelected="",this.employees=[],this.searchForm={},this.roles=[],this.userTypes=[],this.clientSelected=0,this.status=[],this.countLoad=2,this.isOrderEdit=!1,this.orderSelected={},this.users=[],this.truncks=[],this.isTrunck=!1,this.salesPersons=[],this.regions=[],this.cities=[],this.setDates=(V,z,ge)=>{if(V?.from||V?.to){const Oe=V.to||V.from;this.pagination[z]=this.datePipe.transform(V.from||V.to,"yyyy-MM-ddT00:00:00"),this.pagination[ge]=this.datePipe.transform(Oe,"yyyy-MM-ddT23:59:59.999")}else this.pagination[z]=null,this.pagination[ge]=null},this.loadentities(),this.GetRegions(),this.GetCities()}GetRegions(){this.regionService.getDropDown().subscribe(t=>{this.regions=t.data},t=>{console.log(t)})}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetSalesPersons(){this.employeeService.GetAllByType(9).subscribe(t=>{this.salesPersons=t.data},t=>{console.log(t)})}loadentities(){this.countLoad=this.countLoad+1,(!this.isResolveList||1!==this.countLoad)&&(this.pagination.status=50,this.baseService.get(this.pagination).pipe((0,R.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader(N.a7),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader(N.a7),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}openModal(t,s,i="md"){this.isOrderEdit=!1,this.form={},this.orderSelected=t,this.modalService.open(s,{centered:!0,size:i})}SubmitOrder(){}cancelOrder(){}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,R.Q)(this.notifier)).subscribe(s=>{s?this.alertService.success():this.alertService.error("general.message."+s)},s=>{this.alertService.error()})}mapRegisterForm(t){let s={...t};return s.employeeCode=0,s}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader("allLoader"),this.setDates(t.dates,"visitDateFrom","visitDateTo"),this.setDates(t.creationDates,"creationTimeFrom","creationTimeTo"),this.loadentities()}LoadSuccess(){this.ngxLoader.stopLoader("allLoader")}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems}}configRoute(){this.routerActive.data.pipe((0,R.Q)(this.notifier)).subscribe(t=>{this.entities=t.data,this.pagination.totalItems=t.data?.totalItems},()=>{this.alertService.error()})}mapExcel(){let t=[];return this.entities.forEach(s=>{t.push({"Order Code":s.orderCode,"Created Date":s.createdDate,"City Name":s.cityName,"District Name":s.districtName?s.districtName:"--","Agent Name":s.agentName,Mobile:s.mobile,"Channel Name":s.channelName,"Assigned To":s.teamNames,Times:s.workTimes,"Visit Date":s.visitDate,Services:s.services})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}checkEdit(t){return!t.isCancel&&!t.isFinish}openStatusModal(t,s,i,l="md"){this.isEditForm=!1,this.form={},this.form={id:t,status:i},this.modalService.open(s,{centered:!0,size:l})}openModalClient(t,s,i="xl"){this.clientSelected=t.orderCode,this.form=t,this.isOrderEdit=!1,this.modalService.open(s,{centered:!0,size:i})}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}openEditOrderModal(t,s,i="md"){this.form={},this.isOrderEdit=!0,this.clientSelected=t,this.modalService.open(s,{centered:!0,size:i})}OpenOrderTimeLineModel(t,s,i="md"){this.orderSelected=t,this.modalService.open(s,{centered:!0,size:i})}mapUrl(t,s){return null===t||null==s?"":`https://www.google.com/maps/dir//${s},${t}/@${s},${t},17z?hl=en-US`}PrintOrderReceived(t){this.ngxLoader.startLoader("assignLoader"),this.baseService.PrintOrderReceived(t).pipe((0,me.O)(),(0,se.c)(100),(0,pe.Z)(),(0,R.Q)(this.notifier),(0,ie.j)(()=>this.ngxLoader.stopLoader("assignLoader"))).subscribe(s=>{this.openUrl(s)},s=>{this.alertService.error("general.message."+s)})}openUrl(t){let s=new Blob([t],{type:t.type});var i=URL.createObjectURL(s);window.open(i,"_blank")}reload(){this.offerOrderService.GetOrderCountSource.next(!0),this.loadentities()}goNew(){this.router.navigateByUrl("/sales/new")}static{this.\u0275fac=function(s){return new(s||a)(e.rXU(A.nX),e.rXU(O.c$),e.rXU(or),e.rXU(Ge),e.rXU(le.u),e.rXU(k.vh),e.rXU(X.eD),e.rXU(F.Bq),e.rXU(ft.J),e.rXU(It.O),e.rXU(Et.S),e.rXU(Ue.h),e.rXU(A.Ix),e.rXU(He.V))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["assign-order"]],inputs:{isTrunck:"isTrunck"},features:[e.Vt3],decls:51,vars:51,consts:[["tableMaster",""],["cancelOrderModal",""],["deleteModal",""],["OrderTimeLineModel",""],["StatusOrderModal",""],["formEntity","ngForm"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"addNew","reset","search","exportXlsx","addPermission","showAdd","showExport","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","id","name","id",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],["InputTirmFilter","","type","search","id","clientName","name","clientName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["name","regionId","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],["name","cityId","bindValue","code","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],[2,"width",".2%"],["translate","",2,"width",".5%"],["pSortableColumn","offerOrderMasterId","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["pSortableColumn","creationTime","translate","",2,"width","12%"],["pSortableColumn","clientId","translate","",2,"width","10%"],["pSortableColumn","clientVisitDate","translate","",2,"width","12%"],["translate","",2,"width","8%"],["pSortableColumn","shippingTruckName","translate","",2,"width","8%"],["translate","",2,"width","6%"],["translate","",2,"width","10%"],[1,"fs-5"],["type","button","pRipple","",1,"border-0","p-button-text","p-button-rounded","p-button-plain",3,"pRowToggler","ngClass"],[1,"code-pointer"],[1,"badge","bg-success-subtle","text-success"],[1,"badge","bg-primary-subtle","text-primary","my-1"],["class","badge bg-danger-subtle text-danger mx-1","translate","orderManagement.order.noMap",4,"ngIf"],["target","_blank","class","badge bg-success-subtle text-success mx-1","translate","orderManagement.order.viewMap",3,"href",4,"ngIf"],[4,"ngIf"],["translate","orderManagement.order.noMap",1,"badge","bg-danger-subtle","text-danger","mx-1"],["target","_blank","translate","orderManagement.order.viewMap",1,"badge","bg-success-subtle","text-success","mx-1",3,"href"],[1,"ri-map-pin-line"],["tooltipPosition","top",1,"btn","btn-sm","btn-warning","edit-list","mx-1",3,"pTooltip"],[1,"ri-swap-line","align-bottom"],["tooltipPosition","top",1,"btn","btn-sm","btn-success","edit-list","mx-1",3,"pTooltip"],[1,"ri-checkbox-circle-fill","align-bottom"],[1,"d-inline-block"],["class","btn btn-sm btn-primary edit-list mx-1","tooltipPosition","top",3,"pTooltip","click",4,"hasPermission"],[1,"dropdown-custom","d-inline-block"],["type","button",1,"btn","dropbtn","btn-soft-secondary","btn-sm","dropdown-custom","arrow-none"],[1,"ri-more-fill"],[1,"dropdown-menu","dropdown-menu-end","dropdown-content",2,"left","0"],[3,"click",4,"hasPermission"],["tooltipPosition","top",1,"btn","btn-sm","btn-primary","edit-list","mx-1",3,"click","pTooltip"],[1,"ri-checkbox-fill","align-bottom"],[3,"click"],[1,"dropdown-item"],[1,"text-primary","ri-printer-line","align-bottom","me-2"],["translate","sales.salesOrder.printBillOfLading"],[1,"text-warning","ri-skip-back-fill","align-bottom","me-2"],["translate","sales.salesOrder.sureOrder"],[1,"text-danger","ri-close-fill","align-bottom","me-2"],["translate","general.action.cancel"],["colspan","17"],[1,"table-detail"],["dataKey","id",3,"value"],["pTemplate","emptymessage"],["translate","sales.salesOrder.itemName",2,"width","10%"],["translate","sales.salesOrder.unit",2,"width","6%"],["translate","sales.salesOrder.clientQuantity",2,"width","8%"],["translate","sales.salesOrder.approvedQuantity",2,"width","8%"],["colspan","8"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"ngSubmit"],[3,"hasProgressBar","fgsType","loaderId"],[1,"modal-content"],[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mt-2","text-center"],["src","https://cdn.lordicon.com/gdfrsvpt.json","stroke","bold","state","hover-oscillate","trigger","loop","colors","primary:#f7b84b,secondary:#f06548",2,"width","130px","height","130px"],[1,"pt-2","fs-15","mx-4","mx-sm-5"],["translate","orderManagement.order.AreYouSureMessage"],[1,"text-muted","mx-4","mb-0"],[1,"d-flex","gap-2","justify-content-center","mt-4","mb-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],[3,"success","dismiss","orderId"],[3,"dismiss","orderSelected"]],template:function(s,i){if(1&s){const l=e.RV6();e.j41(0,"div",6)(1,"div",7)(2,"div",8),e.nrm(3,"ngx-ui-loader",9),e.j41(4,"base-filter",10),e.bIt("addNew",function(){return e.eBV(l),e.Njj(i.goNew())})("reset",function(){return e.eBV(l),e.Njj(i.onReset())})("search",function(){return e.eBV(l),e.Njj(i.onSearch())})("exportXlsx",function(){return e.eBV(l),e.Njj(i.onExportXlsx())}),e.qex(5,11),e.j41(6,"div",12)(7,"div",13)(8,"input",14),e.nI1(9,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.id,c)||(i.pagination.id=c),e.Njj(c)}),e.k0s(),e.nrm(10,"i",15),e.k0s()(),e.j41(11,"div",12)(12,"input",16),e.nI1(13,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.searchForm.creationDates,c)||(i.searchForm.creationDates=c),e.Njj(c)}),e.k0s()(),e.j41(14,"div",12)(15,"div",13)(16,"input",17),e.nI1(17,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.clientName,c)||(i.pagination.clientName=c),e.Njj(c)}),e.k0s(),e.nrm(18,"i",15),e.k0s()(),e.j41(19,"div",12)(20,"div",13)(21,"ng-select",18),e.nI1(22,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.salesPersonId,c)||(i.pagination.salesPersonId=c),e.Njj(c)}),e.k0s()()(),e.j41(23,"div",12)(24,"input",16),e.nI1(25,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.searchForm.dates,c)||(i.searchForm.dates=c),e.Njj(c)}),e.k0s()(),e.j41(26,"div",12)(27,"div",13)(28,"ng-select",19),e.nI1(29,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.regionId,c)||(i.pagination.regionId=c),e.Njj(c)}),e.k0s()()(),e.j41(30,"div",12)(31,"div",13)(32,"ng-select",20),e.nI1(33,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.cityId,c)||(i.pagination.cityId=c),e.Njj(c)}),e.k0s()()(),e.bVm(),e.k0s(),e.j41(34,"div",21)(35,"div",22)(36,"p-table",23,0),e.bIt("onLazyLoad",function(c){return e.eBV(l),e.Njj(i.tableChange(c))})("selectionChange",function(c){return e.eBV(l),e.Njj(i.onSelectionChange(c))}),e.DNE(38,Ne,26,0,"ng-template",24)(39,Ss,30,21,"ng-template",25)(40,Xo,7,1,"ng-template",26),e.k0s()(),e.DNE(41,at,2,0,"div",27)(42,Ao,6,8,"div",28),e.k0s()()()(),e.DNE(43,Is,15,3,"ng-template",null,1,e.C5r)(45,Jt,1,1,"ng-template",null,2,e.C5r)(47,ai,1,1,"ng-template",null,3,e.C5r)(49,dr,15,3,"ng-template",null,4,e.C5r)}2&s&&(e.R7$(3),e.Y8G("loaderId","assignLoader"),e.R7$(),e.Y8G("addPermission",e.lJ4(50,Vo))("showAdd",!0)("showExport",!1)("totalItems",i.pagination.totalItems)("title",i.title),e.R7$(4),e.FS9("placeholder",e.bMT(9,36,"orderManagement.order.orderCode")),e.R50("ngModel",i.pagination.id),e.R7$(4),e.FS9("placeholder",e.bMT(13,38,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",i.searchForm.creationDates),e.R7$(4),e.FS9("placeholder",e.bMT(17,40,"orderManagement.order.agentName")),e.R50("ngModel",i.pagination.clientName),e.R7$(5),e.FS9("placeholder",e.bMT(22,42,"sales.salesOrder.salsePerson")),e.Y8G("items",i.salesPersons)("multiple",!1),e.R50("ngModel",i.pagination.salesPersonId),e.R7$(3),e.FS9("placeholder",e.bMT(25,44,"sales.salesOrder.clientVisitDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",i.searchForm.dates),e.R7$(4),e.FS9("placeholder",e.bMT(29,46,"client.client.regionName")),e.Y8G("items",i.regions)("multiple",!1),e.R50("ngModel",i.pagination.regionId),e.R7$(4),e.FS9("placeholder",e.bMT(33,48,"client.client.cityName")),e.Y8G("items",i.cities)("multiple",!1),e.R50("ngModel",i.pagination.cityId),e.R7$(4),e.Y8G("value",i.entities)("rows",i.pagination.pageSize)("lazy",!0)("totalRecords",i.pagination.totalItems),e.R7$(5),e.Y8G("ngIf",i.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",i.pagination.totalItems>0))},dependencies:[k.YU,k.bT,g.qT,g.me,g.Q0,g.BC,g.cb,g.vS,g.cV,F.s5,Ce.kL,Ye.b,$e.p,qe.g,O.Mm,Y.XI,Te.Ei,Y.Tg,Y.FP,X.Cv,fe.vr,Se.m,Be.p,gt.m,Dn,k.vh,O.D9],encapsulation:2})}}return a})();var bt=x(79284),Vn=x(16229),oi=x(12822);const cr=()=>["salesOrder.register"],Uo=()=>["smApprove.sureOrder"],Yo=()=>["smApprove.salesChangeQTY"],qo=()=>["smApprove.cancel"];function Ts(a,u){1&a&&(e.j41(0,"tr",30),e.nrm(1,"th",31),e.j41(2,"th",32),e.EFF(3,"#"),e.k0s(),e.j41(4,"th",33),e.nrm(5,"i",34),e.EFF(6," orderManagement.order.orderCode "),e.k0s(),e.j41(7,"th",35),e.nrm(8,"i",34),e.EFF(9," orderManagement.order.creation "),e.k0s(),e.j41(10,"th",36),e.nrm(11,"i",34),e.EFF(12," orderManagement.order.agentName "),e.k0s(),e.j41(13,"th",37),e.EFF(14," sales.salesOrder.salsePerson "),e.k0s(),e.j41(15,"th",38),e.nrm(16,"i",34),e.EFF(17," sales.salesOrder.clientVisitDate "),e.k0s(),e.j41(18,"th",39),e.nrm(19,"i",34),e.EFF(20," sales.salesOrder.totalQuantity "),e.k0s(),e.j41(21,"th",40),e.nrm(22,"i",34),e.EFF(23," sales.salesOrder.netPrice "),e.k0s(),e.nrm(24,"th",41),e.k0s())}function li(a,u){if(1&a){const t=e.RV6();e.j41(0,"button",53),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,l=e.XpG(),m=e.sdS(44);return e.Njj(l.openModal(i.id,m))}),e.nrm(2,"i",54),e.k0s()}2&a&&e.FS9("pTooltip",e.bMT(1,1,"sales.salesOrder.approved"))}function bn(a,u){if(1&a){const t=e.RV6();e.j41(0,"button",55),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,l=e.XpG(),m=e.sdS(50);return e.Njj(l.openModal(i.id,m))}),e.nrm(2,"i",56),e.k0s()}2&a&&e.FS9("pTooltip",e.bMT(1,1,"sales.salesOrder.backToSales"))}function Qo(a,u){if(1&a){const t=e.RV6();e.j41(0,"button",57),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,l=e.XpG(),m=e.sdS(46);return e.Njj(l.openModal(i.id,m))}),e.nrm(2,"i",58),e.k0s()}2&a&&e.FS9("pTooltip",e.bMT(1,1,"general.action.cancel"))}function xs(a,u){if(1&a){const t=e.RV6();e.j41(0,"tr",42)(1,"td"),e.nrm(2,"button",43),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td")(6,"bdi",44),e.EFF(7),e.k0s()(),e.j41(8,"td")(9,"span",45),e.EFF(10),e.k0s(),e.EFF(11),e.nI1(12,"date"),e.k0s(),e.j41(13,"td",46),e.bIt("click",function(){const i=e.eBV(t).$implicit,l=e.XpG(),m=e.sdS(48);return e.Njj(l.openModal(i.clientId,m,"md"))}),e.j41(14,"a",47),e.EFF(15),e.k0s()(),e.j41(16,"td"),e.EFF(17),e.k0s(),e.j41(18,"td"),e.EFF(19),e.nI1(20,"date"),e.k0s(),e.j41(21,"td"),e.EFF(22),e.k0s(),e.j41(23,"td"),e.EFF(24),e.k0s(),e.j41(25,"td")(26,"div",48),e.nrm(27,"i",49),e.DNE(28,li,3,3,"button",50)(29,bn,3,3,"button",51)(30,Qo,3,3,"button",52),e.k0s()()()}if(2&a){const t=u.$implicit,s=u.rowIndex,i=u.expanded;e.R7$(2),e.Y8G("pRowToggler",t)("ngClass",i?" ri-arrow-down-s-line":"  ri-arrow-up-s-line"),e.R7$(2),e.JRh(s+1),e.R7$(3),e.SpI("#SO#",t.id,""),e.R7$(3),e.SpI("",t.creatorName," "),e.R7$(),e.SpI(" ",e.i5U(12,14,t.creationTime,"yyyy-MM-dd HH:mm")," "),e.R7$(4),e.SpI(" ",t.clientName," "),e.R7$(2),e.JRh(t.salsePersonName),e.R7$(2),e.SpI(" ",e.i5U(20,17,t.acutalVisitDate,"yyyy-MM-dd HH:mm"),""),e.R7$(3),e.JRh(t.totalQuantity),e.R7$(2),e.JRh(t.netPrice),e.R7$(4),e.Y8G("hasPermission",e.lJ4(20,Uo)),e.R7$(),e.Y8G("hasPermission",e.lJ4(21,Yo)),e.R7$(),e.Y8G("hasPermission",e.lJ4(22,qo))}}function ks(a,u){1&a&&(e.j41(0,"tr"),e.nrm(1,"th",63)(2,"th",64)(3,"th",65)(4,"th",66)(5,"th",67)(6,"th",68),e.k0s())}function mr(a,u){if(1&a&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&a){const t=e.XpG().$implicit;e.R7$(),e.JRh(t.approvedQuantity)}}function pr(a,u){if(1&a){const t=e.RV6();e.j41(0,"input",72),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG().$implicit;return e.DH7(l.approvedQuantity,i)||(l.approvedQuantity=i),e.Njj(i)}),e.k0s()}if(2&a){const t=e.XpG().$implicit;e.R50("ngModel",t.approvedQuantity)}}function Fs(a,u){if(1&a){const t=e.RV6();e.j41(0,"button",53),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,l=e.XpG(2);return e.Njj(l.saveQuantity(i.id,i))}),e.nrm(2,"i",54),e.k0s()}2&a&&e.FS9("pTooltip",e.bMT(1,1,"general.action.save"))}function zo(a,u){if(1&a&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.DNE(8,mr,2,1,"span",69)(9,pr,1,1,"input",70),e.k0s(),e.j41(10,"td"),e.EFF(11),e.k0s(),e.j41(12,"td"),e.DNE(13,Fs,3,3,"button",71),e.k0s()()),2&a){const t=u.$implicit;e.R7$(2),e.JRh(t.itemName),e.R7$(2),e.JRh(t.unitName),e.R7$(2),e.JRh(t.clientQuantity),e.R7$(2),e.Y8G("ngIf",!t.isEdit),e.R7$(),e.Y8G("ngIf",t.isEdit),e.R7$(2),e.JRh(t.price),e.R7$(2),e.Y8G("ngIf",t.isEdit)}}function ur(a,u){1&a&&(e.j41(0,"tr"),e.nrm(1,"td",73),e.k0s())}function gr(a,u){if(1&a&&(e.j41(0,"tr")(1,"td",59)(2,"div",60)(3,"p-table",61),e.DNE(4,ks,7,0,"ng-template",25)(5,zo,14,7,"ng-template",26)(6,ur,2,0,"ng-template",62),e.k0s()()()()),2&a){const t=u.$implicit;e.R7$(3),e.Y8G("value",t.offerOrderDetails)}}function Ho(a,u){1&a&&(e.j41(0,"div",74),e.EFF(1," general.table.noData "),e.k0s())}function Rs(a,u){if(1&a){const t=e.RV6();e.j41(0,"div",75)(1,"div",76),e.nrm(2,"ngb-pagination-info",77),e.j41(3,"table-length",78),e.bIt("lengthChange",function(i){e.eBV(t);const l=e.XpG();return e.Njj(l.ListItemChange(i))}),e.k0s()(),e.j41(4,"div",79)(5,"ngb-pagination",80),e.bIt("pageChange",function(i){e.eBV(t);const l=e.XpG();return e.Njj(l.pageChanged(i))}),e.mxI("pageChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.pagination.pageNumber,i)||(l.pagination.pageNumber=i),e.Njj(i)}),e.k0s()()()}if(2&a){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function We(a,u){if(1&a){const t=e.RV6();e.j41(0,"form",81,5),e.bIt("ngSubmit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.SubmitOrder())}),e.nrm(2,"ngx-ui-loader",82),e.j41(3,"div",83)(4,"div",84)(5,"button",85),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()(),e.j41(6,"div",86)(7,"div",87),e.nrm(8,"lord-icon",88),e.j41(9,"div",89),e.nrm(10,"h3",90)(11,"p",91),e.k0s()(),e.j41(12,"div",92),e.nrm(13,"button",93),e.j41(14,"button",94),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()()()()()}if(2&a){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}function hr(a,u){if(1&a){const t=e.RV6();e.j41(0,"cancel-sales-model",95),e.bIt("success",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.reload())})("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&a){const t=e.XpG();e.Y8G("orderId",t.operationId)}}function Pn(a,u){if(1&a){const t=e.RV6();e.j41(0,"client-summary",96),e.bIt("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&a){const t=e.XpG();e.Y8G("clientId",t.operationId)}}function Ms(a,u){1&a&&(e.j41(0,"div",102),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function Os(a,u){if(1&a){const t=e.RV6();e.j41(0,"form",81,5),e.bIt("ngSubmit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.RequestChangeQuantity())}),e.nrm(2,"ngx-ui-loader",82),e.j41(3,"div",83)(4,"div",84)(5,"button",85),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()(),e.j41(6,"div",86)(7,"div",97)(8,"label",98),e.EFF(9,"sales.salesOrder.changeQuantityMessage"),e.k0s(),e.j41(10,"textarea",99,6),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.form.changeQuantityMessage,i)||(l.form.changeQuantityMessage=i),e.Njj(i)}),e.k0s(),e.DNE(12,Ms,2,0,"div",100),e.k0s(),e.j41(13,"div",92),e.nrm(14,"button",101),e.j41(15,"button",94),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()()()()()}if(2&a){const t=e.sdS(1),s=e.sdS(11),i=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",i.loaderOperationShap)("loaderId",i.deleteLoader),e.R7$(8),e.R50("ngModel",i.form.changeQuantityMessage),e.R7$(2),e.Y8G("ngIf",s.invalid&&s.touched),e.R7$(2),e.Y8G("disabled",!t.valid)}}let Jo=(()=>{class a extends De.w{constructor(t,s,i,l,m,c,E,P,q,D,J,ee,W,Q,V,z,ge){super(t,s,E,i,l,m,c),this.baseService=i,this.authDaamService=P,this.teamService=q,this.workTimeService=D,this.excelService=J,this.cityService=ee,this.districtService=W,this.employeeService=Q,this.regionService=V,this.channelService=z,this.router=ge,this.title="sales.salesOrder.newOrders",this.titleOperation="sales.salesOrder.newOrders",this.keySelected="",this.employees=[],this.searchForm={},this.isResolveList=!0,this.activeindex="2",this.active=2,this.clientSelected=0,this.status=[],this.countLoad=2,this.isOrderEdit=!1,this.orderSelected={},this.users=[],this.salesPersons=[],this.regions=[],this.cities=[],this.setDates=(oe,Oe,we)=>{if(oe?.from||oe?.to){const Yr=oe.to||oe.from;this.pagination[Oe]=this.datePipe.transform(oe.from||oe.to,"yyyy-MM-ddT00:00:00"),this.pagination[we]=this.datePipe.transform(Yr,"yyyy-MM-ddT23:59:59.999")}else this.pagination[Oe]=null,this.pagination[we]=null},this.loadentities(),this.GetSalesPersons(),this.GetRegions(),this.GetCities()}GetRegions(){this.regionService.getDropDown().subscribe(t=>{this.regions=t.data},t=>{console.log(t)})}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetSalesPersons(){this.employeeService.GetAllByType(9).subscribe(t=>{this.salesPersons=t.data},t=>{console.log(t)})}loadentities(){this.countLoad=this.countLoad+1,(!this.isResolveList||1!==this.countLoad)&&(this.pagination.status=10,this.baseService.get(this.pagination).pipe((0,R.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader(N.a7),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader(N.a7),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}SubmitOrder(){this.ngxLoader.startLoader(N.Fq),console.log(this.operationId),this.baseService.changStatus({id:this.operationId,status:30}).pipe((0,me.O)(),(0,se.c)(this.mainDelay),(0,pe.Z)(),(0,R.Q)(this.notifier),(0,ie.j)(()=>this.ngxLoader.stopLoader(N.Fq))).subscribe({next:s=>{this.modalService.dismissAll(),this.reload(),this.alertService.success()}})}cancelOrder(){this.ngxLoader.startLoader(N.Fq),console.log(this.operationId),this.baseService.changStatus({id:this.operationId,status:40}).pipe((0,me.O)(),(0,se.c)(this.mainDelay),(0,pe.Z)(),(0,R.Q)(this.notifier),(0,ie.j)(()=>this.ngxLoader.stopLoader(N.Fq))).subscribe({next:s=>{this.modalService.dismissAll(),this.loadentities(),this.alertService.success()}})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,R.Q)(this.notifier)).subscribe(s=>{s?this.alertService.success():this.alertService.error("general.message."+s)},s=>{this.alertService.error()})}mapRegisterForm(t){let s={...t};return s.employeeCode=0,s}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader("allLoader"),this.setDates(t.dates,"visitDateFrom","visitDateTo"),this.setDates(t.creationDates,"creationTimeFrom","creationTimeTo"),this.loadentities()}LoadSuccess(){this.ngxLoader.stopLoader("allLoader")}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems}}mapExcel(){let t=[];return this.entities.forEach(s=>{t.push({"Order Code":s.orderCode,"Created Date":s.createdDate,"City Name":s.cityName,"District Name":s.districtName?s.districtName:"--",Status:this.translateService.instant(this.getTrnslate(s)),"Agent Name":s.agentName,Mobile:s.mobile,"Channel Name":s.channelName,"Assigned To":s.teamNames,Times:s.workTimes,"Visit Date":s.visitDate,Services:s.services})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}goRegister(){this.router.navigateByUrl("/managment/order/new")}goEdit(t){this.router.navigateByUrl("/managment/order/new")}getStatus(t){return 10==t.offerOrderStatus||20==t.offerOrderStatus?"bg-warning-subtle text-warning":30==t.offerOrderStatus?"bg-success-subtle text-success":40==t.offerOrderStatus?"bg-danger-subtle text-danger":50==t.offerOrderStatus?"bg-danger-success text-success":"bg-warning-subtle text-warning"}checkEdit(t){return!t.isCancel&&!t.isFinish}getTrnslate(t){return t.isCancel?"orderManagement.order.cancel":t.isFinish?"orderManagement.order.finish":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen?"orderManagement.order.reopen":t.isAssign?"orderManagement.order.assign":t.isConfirmed?"orderManagement.order.confirmed":t.isFree?"orderManagement.order.free":"orderManagement.order.new"}openModalClient(t,s,i="xl"){this.clientSelected=t.orderCode,this.orderSelected=t,this.isOrderEdit=!1,this.modalService.open(s,{centered:!0,size:i})}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}openEditOrderModal(t,s,i="md"){this.form={},this.isOrderEdit=!0,this.clientSelected=t,this.modalService.open(s,{centered:!0,size:i})}OpenOrderTimeLineModel(t,s,i="md"){this.orderSelected=t,this.modalService.open(s,{centered:!0,size:i})}saveQuantity(t,s){this.baseService.UpdateQuantity({id:t,quantity:s.approvedQuantity}).pipe((0,R.Q)(this.notifier)).subscribe(l=>{l.success?(this.alertService.success(),this.loadentities()):this.alertService.error("general.message."+l)},l=>{this.alertService.error()}),console.log("Saved Quantity:",s.approvedQuantity)}openModalSummaryClient(t,s,i="xl"){this.clientSelected=t,this.isOrderEdit=!1,this.modalService.open(s,{centered:!0,size:i})}RequestChangeQuantity(){this.ngxLoader.startLoader(N.Fq),console.log(this.operationId),this.baseService.RequestChangeQuantity({id:this.operationId,changeQuantityMessage:this.form.changeQuantityMessage}).pipe((0,me.O)(),(0,se.c)(this.mainDelay),(0,pe.Z)(),(0,R.Q)(this.notifier),(0,ie.j)(()=>this.ngxLoader.stopLoader(N.Fq))).subscribe({next:s=>{this.modalService.dismissAll(),this.reload(),this.alertService.success()}})}reload(){this.baseService.GetOrderCountSource.next(!0),this.loadentities()}goNew(){this.router.navigateByUrl("/sales/new")}static{this.\u0275fac=function(s){return new(s||a)(e.rXU(A.nX),e.rXU(O.c$),e.rXU(Ge),e.rXU(le.u),e.rXU(k.vh),e.rXU(X.eD),e.rXU(F.Bq),e.rXU(ft.J),e.rXU(Ht.n),e.rXU(bt.G),e.rXU(He.V),e.rXU(Ue.h),e.rXU(Vn.m),e.rXU(It.O),e.rXU(Et.S),e.rXU(oi.l),e.rXU(A.Ix))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["app-new-order"]],features:[e.Vt3],decls:51,vars:51,consts:[["tableMaster",""],["SubmitOrderModal",""],["deleteModal",""],["ClientInfo",""],["SubmitChangeQuantityModal",""],["formEntity","ngForm"],["changeQuantityMessage","ngModel"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"addNew","reset","search","exportXlsx","addPermission","showAdd","showExport","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","id","name","id",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],["InputTirmFilter","","type","search","id","clientName","name","clientName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["name","regionId","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],["name","cityId","bindValue","code","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],[2,"width",".2%"],["translate","",2,"width",".5%"],["pSortableColumn","id","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["pSortableColumn","creationTime","translate","",2,"width","12%"],["pSortableColumn","clientId","translate","",2,"width","10%"],["translate","",2,"width","8%"],["pSortableColumn","clientVisitDate","translate","",2,"width","8%"],["pSortableColumn","totalQuantity","translate","",2,"width","8%"],["pSortableColumn","netPrice","translate","",2,"width","6%"],["translate","",2,"width","10%"],[1,"fs-5"],["type","button","pRipple","",1,"border-0","p-button-text","p-button-rounded","p-button-plain",3,"pRowToggler","ngClass"],[1,"code-pointer"],[1,"badge","bg-success-subtle","text-success"],[3,"click"],["href","javascript:void(0)",1,"link-primary","link-offset-2","text-decoration-underline","link-underline-opacity-25","link-underline-opacity-100-hover"],[1,"d-inline"],[1,"ri-history-fill","d-inline","text-primary","fs-16","align-middle","me-1"],["class","btn btn-sm btn-success edit-list mx-1","tooltipPosition","top",3,"pTooltip","click",4,"hasPermission"],["class","btn btn-sm btn-warning edit-list mx-1","tooltipPosition","top",3,"pTooltip","click",4,"hasPermission"],["class","btn btn-sm btn-danger edit-list mx-1","tooltipPosition","top",3,"pTooltip","click",4,"hasPermission"],["tooltipPosition","top",1,"btn","btn-sm","btn-success","edit-list","mx-1",3,"click","pTooltip"],[1,"ri-check-double-fill","align-bottom"],["tooltipPosition","top",1,"btn","btn-sm","btn-warning","edit-list","mx-1",3,"click","pTooltip"],[1,"ri-logout-circle-r-line","align-bottom"],["tooltipPosition","top",1,"btn","btn-sm","btn-danger","edit-list","mx-1",3,"click","pTooltip"],[1,"ri-close-fill","align-bottom"],["colspan","17"],[1,"table-detail"],["dataKey","id",3,"value"],["pTemplate","emptymessage"],["translate","sales.salesOrder.itemName",2,"width","10%"],["translate","sales.salesOrder.unit",2,"width","6%"],["translate","sales.salesOrder.clientQuantity",2,"width","8%"],["translate","sales.salesOrder.approvedQuantity",2,"width","8%"],["translate","sales.salesOrder.price",2,"width","5%"],[2,"width","5%"],[4,"ngIf"],["type","number","class","form-control fs-6",3,"ngModel","ngModelChange",4,"ngIf"],["class","btn btn-sm btn-success edit-list mx-1","tooltipPosition","top",3,"pTooltip","click",4,"ngIf"],["type","number",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["colspan","8"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"ngSubmit"],[3,"hasProgressBar","fgsType","loaderId"],[1,"modal-content"],[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mt-2","text-center"],["src","https://cdn.lordicon.com/gdfrsvpt.json","stroke","bold","state","hover-oscillate","trigger","loop","colors","primary:#f7b84b,secondary:#f06548",2,"width","130px","height","130px"],[1,"pt-2","fs-15","mx-4","mx-sm-5"],["translate","orderManagement.order.AreYouSureMessage"],[1,"text-muted","mx-4","mb-0"],[1,"d-flex","gap-2","justify-content-center","mt-4","mb-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],[3,"success","dismiss","orderId"],[3,"dismiss","clientId"],[1,"mb-2"],["for","changeQuantityMessage","translate","",1,"required","text-bold","form-label"],["rows","5","InputTirmFilter","","name","changeQuantityMessage","type","text","id","changeQuantityMessage",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["class","text-danger text-center  ","translate","",4,"ngIf"],["t","","type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger",3,"disabled"],["translate","",1,"text-danger","text-center"]],template:function(s,i){if(1&s){const l=e.RV6();e.j41(0,"div",7)(1,"div",8)(2,"div",9),e.nrm(3,"ngx-ui-loader",10),e.j41(4,"base-filter",11),e.bIt("addNew",function(){return e.eBV(l),e.Njj(i.goNew())})("reset",function(){return e.eBV(l),e.Njj(i.onReset())})("search",function(){return e.eBV(l),e.Njj(i.onSearch())})("exportXlsx",function(){return e.eBV(l),e.Njj(i.onExportXlsx())}),e.qex(5,12),e.j41(6,"div",13)(7,"div",14)(8,"input",15),e.nI1(9,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.id,c)||(i.pagination.id=c),e.Njj(c)}),e.k0s(),e.nrm(10,"i",16),e.k0s()(),e.j41(11,"div",13)(12,"input",17),e.nI1(13,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.searchForm.creationDates,c)||(i.searchForm.creationDates=c),e.Njj(c)}),e.k0s()(),e.j41(14,"div",13)(15,"div",14)(16,"input",18),e.nI1(17,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.clientName,c)||(i.pagination.clientName=c),e.Njj(c)}),e.k0s(),e.nrm(18,"i",16),e.k0s()(),e.j41(19,"div",13)(20,"div",14)(21,"ng-select",19),e.nI1(22,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.salesPersonId,c)||(i.pagination.salesPersonId=c),e.Njj(c)}),e.k0s()()(),e.j41(23,"div",13)(24,"input",17),e.nI1(25,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.searchForm.dates,c)||(i.searchForm.dates=c),e.Njj(c)}),e.k0s()(),e.j41(26,"div",13)(27,"div",14)(28,"ng-select",20),e.nI1(29,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.regionId,c)||(i.pagination.regionId=c),e.Njj(c)}),e.k0s()()(),e.j41(30,"div",13)(31,"div",14)(32,"ng-select",21),e.nI1(33,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.cityId,c)||(i.pagination.cityId=c),e.Njj(c)}),e.k0s()()(),e.bVm(),e.k0s(),e.j41(34,"div",22)(35,"div",23)(36,"p-table",24,0),e.bIt("onLazyLoad",function(c){return e.eBV(l),e.Njj(i.tableChange(c))})("selectionChange",function(c){return e.eBV(l),e.Njj(i.onSelectionChange(c))}),e.DNE(38,Ts,25,0,"ng-template",25)(39,xs,31,23,"ng-template",26)(40,gr,7,1,"ng-template",27),e.k0s()(),e.DNE(41,Ho,2,0,"div",28)(42,Rs,6,8,"div",29),e.k0s()()()(),e.DNE(43,We,15,3,"ng-template",null,1,e.C5r)(45,hr,1,1,"ng-template",null,2,e.C5r)(47,Pn,1,1,"ng-template",null,3,e.C5r)(49,Os,16,6,"ng-template",null,4,e.C5r)}2&s&&(e.R7$(3),e.Y8G("loaderId","newLoader"),e.R7$(),e.Y8G("addPermission",e.lJ4(50,cr))("showAdd",!0)("showExport",!1)("totalItems",i.pagination.totalItems)("title",i.title),e.R7$(4),e.FS9("placeholder",e.bMT(9,36,"orderManagement.order.orderCode")),e.R50("ngModel",i.pagination.id),e.R7$(4),e.FS9("placeholder",e.bMT(13,38,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",i.searchForm.creationDates),e.R7$(4),e.FS9("placeholder",e.bMT(17,40,"orderManagement.order.agentName")),e.R50("ngModel",i.pagination.clientName),e.R7$(5),e.FS9("placeholder",e.bMT(22,42,"sales.salesOrder.salsePerson")),e.Y8G("items",i.salesPersons)("multiple",!1),e.R50("ngModel",i.pagination.salesPersonId),e.R7$(3),e.FS9("placeholder",e.bMT(25,44,"sales.salesOrder.clientVisitDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",i.searchForm.dates),e.R7$(4),e.FS9("placeholder",e.bMT(29,46,"client.client.regionName")),e.Y8G("items",i.regions)("multiple",!1),e.R50("ngModel",i.pagination.regionId),e.R7$(4),e.FS9("placeholder",e.bMT(33,48,"client.client.cityName")),e.Y8G("items",i.cities)("multiple",!1),e.R50("ngModel",i.pagination.cityId),e.R7$(4),e.Y8G("value",i.entities)("rows",i.pagination.pageSize)("lazy",!0)("totalRecords",i.pagination.totalItems),e.R7$(5),e.Y8G("ngIf",i.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",i.pagination.totalItems>0))},dependencies:[k.YU,k.bT,g.qT,g.me,g.Q0,g.BC,g.cb,g.vS,g.cV,F.s5,Ce.kL,Ye.b,$e.p,qe.g,Gt,O.Mm,Y.XI,Te.Ei,Y.Tg,Y.FP,X.Cv,fe.vr,Se.m,Be.p,gt.m,Dn,k.vh,O.D9],encapsulation:2})}}return a})();const Wo=()=>["salesOrder.register"],Ko=()=>["storePrepare.editTrunk"],Zo=()=>["storePrepare.shippingOrder"],el=()=>["storePrepare.newOrder"],vn=()=>["storePrepare.cancel"],ws=a=>[a];function tl(a,u){1&a&&(e.j41(0,"tr",31),e.nrm(1,"th",32),e.j41(2,"th",33),e.EFF(3,"#"),e.k0s(),e.j41(4,"th",34),e.nrm(5,"i",35),e.EFF(6," orderManagement.order.orderCode "),e.k0s(),e.j41(7,"th",36),e.nrm(8,"i",35),e.EFF(9," orderManagement.order.creation "),e.k0s(),e.j41(10,"th",37),e.nrm(11,"i",35),e.EFF(12," orderManagement.order.agentName "),e.k0s(),e.j41(13,"th",38),e.EFF(14," sales.salesOrder.salsePerson "),e.k0s(),e.j41(15,"th",39),e.nrm(16,"i",35),e.EFF(17," sales.salesOrder.clientVisitDate "),e.k0s(),e.j41(18,"th",40),e.EFF(19," sales.salesOrder.deliveryStatus "),e.k0s(),e.j41(20,"th",41),e.nrm(21,"i",35),e.EFF(22," sales.salesOrder.totalQuantity "),e.k0s(),e.j41(23,"th",42),e.EFF(24," sales.salesOrder.clientLocationName "),e.k0s(),e.nrm(25,"th",40),e.k0s())}function _r(a,u){1&a&&e.nrm(0,"span",60)}function Ns(a,u){1&a&&e.nrm(0,"span",61)}function Wt(a,u){1&a&&e.nrm(0,"span",62)}function di(a,u){1&a&&e.nrm(0,"span",63)}function nl(a,u){if(1&a&&(e.j41(0,"a",64),e.nrm(1,"i",65),e.k0s()),2&a){const t=e.XpG().$implicit,s=e.XpG();e.Y8G("href",s.mapUrl(null==t?null:t.lng,null==t?null:t.lat),e.B4B)}}function il(a,u){if(1&a){const t=e.RV6();e.j41(0,"button",67),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2).$implicit,l=e.XpG(),m=e.sdS(46);return e.Njj(l.openShippingModal(i.id,m,"lg"))}),e.nrm(2,"i",68),e.k0s()}2&a&&e.FS9("pTooltip",e.bMT(1,1,"sales.salesOrder.shipping"))}function rl(a,u){if(1&a&&(e.qex(0),e.DNE(1,il,3,3,"button",66),e.bVm()),2&a){const t=e.XpG().$implicit;e.R7$(),e.Y8G("ngIf",!(t.totalQuantityDelivery>0&&t.totalQuantityDelivery==t.totalQuantity))}}function Cn(a,u){if(1&a){const t=e.RV6();e.j41(0,"li",69),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,l=e.XpG(),m=e.sdS(52);return e.Njj(l.openStatusModal(i.id,m,50,"md"))}),e.j41(1,"span",70),e.nrm(2,"i",71)(3,"span",72),e.k0s()()}}function vt(a,u){if(1&a){const t=e.RV6();e.j41(0,"li",69),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,l=e.XpG(),m=e.sdS(52);return e.Njj(l.openStatusModal(i.id,m,10,"md"))}),e.j41(1,"span",70),e.nrm(2,"i",73)(3,"span",74),e.k0s()()}}function Es(a,u){if(1&a){const t=e.RV6();e.j41(0,"li",69),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,l=e.XpG(),m=e.sdS(48);return e.Njj(l.openModal(i.id,m))}),e.j41(1,"span",70),e.nrm(2,"i",75)(3,"span",76),e.k0s()()}}function sl(a,u){if(1&a&&(e.j41(0,"tr",43)(1,"td"),e.nrm(2,"button",44),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td")(6,"bdi",45),e.EFF(7),e.k0s()(),e.j41(8,"td")(9,"span",46),e.EFF(10),e.k0s(),e.EFF(11),e.nI1(12,"date"),e.k0s(),e.j41(13,"td")(14,"span",47),e.EFF(15),e.k0s()(),e.j41(16,"td"),e.EFF(17),e.k0s(),e.j41(18,"td"),e.DNE(19,_r,1,0,"span",48)(20,Ns,1,0,"span",49)(21,Wt,1,0,"span",50),e.k0s(),e.j41(22,"td"),e.EFF(23),e.nI1(24,"date"),e.k0s(),e.j41(25,"td"),e.EFF(26),e.k0s(),e.j41(27,"td"),e.DNE(28,di,1,0,"span",51)(29,nl,2,1,"a",52),e.k0s(),e.j41(30,"td")(31,"div",53),e.DNE(32,rl,2,1,"ng-container",54),e.j41(33,"span",53)(34,"div",55)(35,"button",56),e.nrm(36,"i",57),e.k0s(),e.j41(37,"ul",58),e.DNE(38,Cn,4,0,"li",59)(39,vt,4,0,"li",59)(40,Es,4,0,"li",59),e.k0s()()()()()()),2&a){const t=u.$implicit,s=u.rowIndex,i=u.expanded;e.R7$(2),e.Y8G("pRowToggler",t)("ngClass",i?" ri-arrow-down-s-line":"  ri-arrow-up-s-line"),e.R7$(2),e.JRh(s+1),e.R7$(3),e.SpI("#SO#",t.id,""),e.R7$(3),e.SpI("",t.creatorName," "),e.R7$(),e.SpI(" ",e.i5U(12,19,t.creationTime,"yyyy-MM-dd HH:mm")," "),e.R7$(4),e.SpI("",t.clientName," "),e.R7$(2),e.JRh(t.salsePersonName),e.R7$(2),e.Y8G("ngIf",t.totalQuantityDelivery<=0),e.R7$(),e.Y8G("ngIf",t.totalQuantityDelivery>0&&t.totalQuantityDelivery==t.totalQuantity),e.R7$(),e.Y8G("ngIf",t.totalQuantityDelivery>0&&t.totalQuantityDelivery<t.totalQuantity),e.R7$(2),e.SpI(" ",e.i5U(24,22,t.acutalVisitDate,"yyyy-MM-dd HH:mm"),""),e.R7$(3),e.JRh(t.totalQuantity),e.R7$(2),e.Y8G("ngIf",""==t.lng),e.R7$(),e.Y8G("ngIf",null==t?null:t.lng),e.R7$(3),e.Y8G("hasPermission",e.lJ4(25,Ko)),e.R7$(6),e.Y8G("hasPermission",e.lJ4(26,Zo)),e.R7$(),e.Y8G("hasPermission",e.lJ4(27,el)),e.R7$(),e.Y8G("hasPermission",e.lJ4(28,vn))}}function al(a,u){1&a&&(e.j41(0,"tr"),e.nrm(1,"th",81)(2,"th",82)(3,"th",83)(4,"th",84)(5,"th",85),e.k0s())}function ol(a,u){if(1&a&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td")(8,"span"),e.EFF(9),e.k0s()(),e.j41(10,"td")(11,"span"),e.EFF(12),e.k0s()()()),2&a){const t=u.$implicit;e.R7$(2),e.JRh(t.itemName),e.R7$(2),e.JRh(t.unitName),e.R7$(2),e.JRh(t.clientQuantity),e.R7$(3),e.JRh(t.approvedQuantity),e.R7$(3),e.JRh(t.deliveryQuantity)}}function ll(a,u){1&a&&(e.j41(0,"tr"),e.nrm(1,"td",86),e.k0s())}function dl(a,u){if(1&a&&(e.j41(0,"tr")(1,"td",77)(2,"div",78)(3,"p-table",79),e.DNE(4,al,6,0,"ng-template",26)(5,ol,13,5,"ng-template",27)(6,ll,2,0,"ng-template",80),e.k0s()()()()),2&a){const t=u.$implicit;e.R7$(3),e.Y8G("value",t.offerOrderDetails)}}function ci(a,u){1&a&&(e.j41(0,"div",87),e.EFF(1," general.table.noData "),e.k0s())}function v(a,u){if(1&a){const t=e.RV6();e.j41(0,"div",88)(1,"div",89),e.nrm(2,"ngb-pagination-info",90),e.j41(3,"table-length",91),e.bIt("lengthChange",function(i){e.eBV(t);const l=e.XpG();return e.Njj(l.ListItemChange(i))}),e.k0s()(),e.j41(4,"div",92)(5,"ngb-pagination",93),e.bIt("pageChange",function(i){e.eBV(t);const l=e.XpG();return e.Njj(l.pageChanged(i))}),e.mxI("pageChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.pagination.pageNumber,i)||(l.pagination.pageNumber=i),e.Njj(i)}),e.k0s()()()}if(2&a){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function j(a,u){if(1&a){const t=e.RV6();e.j41(0,"form",94,7),e.bIt("ngSubmit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.cancelOrder())}),e.nrm(2,"ngx-ui-loader",95),e.j41(3,"div",96)(4,"div",97)(5,"button",98),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()(),e.j41(6,"div",99)(7,"div",100),e.nrm(8,"lord-icon",101),e.j41(9,"div",102),e.nrm(10,"h3",103)(11,"p",104),e.k0s()(),e.j41(12,"div",105),e.nrm(13,"button",106),e.j41(14,"button",107),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()()()()()}if(2&a){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}function S(a,u){if(1&a){const t=e.RV6();e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td")(4,"ng-select",137),e.mxI("ngModelChange",function(i){const l=e.eBV(t).$implicit;return e.DH7(l.unitId,i)||(l.unitId=i),e.Njj(i)}),e.k0s()(),e.j41(5,"td")(6,"input",138),e.bIt("ngModelChange",function(i){const l=e.eBV(t).$index,m=e.XpG(2);return e.Njj(m.quantitySelect(i,l))}),e.mxI("ngModelChange",function(i){const l=e.eBV(t).$implicit;return e.DH7(l.quantity,i)||(l.quantity=i),e.Njj(i)}),e.k0s()()()}if(2&a){const t=u.$implicit,s=u.$index;e.R7$(2),e.SpI(" ",t.itemName," "),e.R7$(2),e.Y8G("name","unitId"+e.eq3(6,ws,s))("items",t.units),e.R50("ngModel",t.unitId),e.R7$(2),e.Y8G("name","quantity"+e.eq3(8,ws,s)),e.R50("ngModel",t.quantity)}}function w(a,u){if(1&a){const t=e.RV6();e.j41(0,"tr",139),e.nrm(1,"td",140),e.j41(2,"td",141)(3,"table",142)(4,"tbody")(5,"tr"),e.nrm(6,"td",143),e.j41(7,"td",144),e.EFF(8),e.nI1(9,"translate"),e.k0s()(),e.j41(10,"tr"),e.nrm(11,"td",145),e.j41(12,"td",144)(13,"div",146)(14,"ng-select",147),e.bIt("change",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.getTotal())}),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG(2);return e.DH7(l.form.totalAddDiscountType,i)||(l.form.totalAddDiscountType=i),e.Njj(i)}),e.k0s(),e.j41(15,"input",148),e.bIt("change",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.getTotal())}),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG(2);return e.DH7(l.form.totalAddDiscount,i)||(l.form.totalAddDiscount=i),e.Njj(i)}),e.k0s()()()(),e.j41(16,"tr",149),e.nrm(17,"td",150),e.j41(18,"td",144),e.EFF(19),e.nI1(20,"translate"),e.k0s()(),e.j41(21,"tr",151),e.nrm(22,"th",152),e.j41(23,"th",144),e.EFF(24),e.nI1(25,"translate"),e.k0s()()()()()()}if(2&a){const t=e.XpG(2);e.R7$(8),e.Lme("",t.form.total," ",e.bMT(9,9,"orderManagement.order.currancy"),""),e.R7$(6),e.Y8G("items",t.discountTypes),e.R50("ngModel",t.form.totalAddDiscountType),e.R7$(),e.R50("ngModel",t.form.totalAddDiscount),e.R7$(4),e.Lme("",t.form.tax," ",e.bMT(20,11,"orderManagement.order.currancy"),""),e.R7$(5),e.Lme("",t.form.totalNet," ",e.bMT(25,13,"orderManagement.order.currancy"),"")}}function U(a,u){if(1&a){const t=e.RV6();e.j41(0,"div",108)(1,"div",109)(2,"h4",110),e.nrm(3,"span",111),e.k0s(),e.j41(4,"button",112),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss("Cross click"))}),e.k0s()(),e.j41(5,"div",99),e.nrm(6,"ngx-ui-loader",95),e.j41(7,"form",113,7),e.bIt("submit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.updateTruck())}),e.j41(9,"div",8)(10,"div",114)(11,"label",115),e.EFF(12,"sales.salesOrder.acutalDeliveryDate"),e.k0s(),e.j41(13,"input",116),e.bIt("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.Njj(l.dateChangeModal(i))}),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.form.acutalVisitDate,i)||(l.form.acutalVisitDate=i),e.Njj(i)}),e.k0s()(),e.j41(14,"div",114),e.nrm(15,"label",117),e.j41(16,"ng-select",118),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.form.clientLocationId,i)||(l.form.clientLocationId=i),e.Njj(i)}),e.k0s()(),e.j41(17,"div",119)(18,"label",115),e.EFF(19,"sales.salesOrder.truncks"),e.k0s(),e.j41(20,"ng-select",120),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.form.shippingTruckId,i)||(l.form.shippingTruckId=i),e.Njj(i)}),e.k0s()()(),e.j41(21,"div",121)(22,"div",122)(23,"div",123)(24,"div",124),e.nrm(25,"h5",125),e.k0s()(),e.j41(26,"div",23)(27,"div",126)(28,"table",127)(29,"thead",128)(30,"tr"),e.nrm(31,"th",129)(32,"th",130)(33,"th",131),e.k0s()(),e.j41(34,"tbody"),e.Z7z(35,S,7,10,"tr",null,e.Vm6),e.DNE(37,w,26,15,"tr",132),e.k0s()()()()()(),e.j41(38,"div",133)(39,"button",134),e.nrm(40,"i",135)(41,"span",136),e.k0s()()()()()}if(2&a){const t=e.sdS(8),s=e.XpG();e.R7$(6),e.Y8G("hasProgressBar",!1)("fgsType",s.loaderOperationShap)("loaderId",s.operationLoader),e.R7$(7),e.R50("ngModel",s.form.acutalVisitDate),e.Y8G("altInput",!0)("enableTime",!0)("convertModelValue",!0)("dateFormat","d-m-Y H:i"),e.R7$(3),e.Y8G("disabled",!0)("items",s.locations),e.R50("ngModel",s.form.clientLocationId),e.R7$(4),e.Y8G("items",s.truncks),e.R50("ngModel",s.form.shippingTruckId),e.R7$(15),e.Dyx(s.form.details),e.R7$(2),e.Y8G("ngIf",!1),e.R7$(2),e.Y8G("disabled",!t.valid)}}function de(a,u){if(1&a){const t=e.RV6();e.j41(0,"cancel-sales-model",153),e.bIt("success",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.loadentities())})("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&a){const t=e.XpG();e.Y8G("orderId",t.orderSelected)}}function ke(a,u){if(1&a){const t=e.RV6();e.j41(0,"order-timeline",154),e.bIt("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&a){const t=e.XpG();e.Y8G("orderSelected",t.orderSelected)}}function _e(a,u){if(1&a){const t=e.RV6();e.j41(0,"form",94,7),e.bIt("ngSubmit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.SubmitOrder())}),e.nrm(2,"ngx-ui-loader",95),e.j41(3,"div",96)(4,"div",97)(5,"button",98),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()(),e.j41(6,"div",99)(7,"div",100),e.nrm(8,"lord-icon",101),e.j41(9,"div",102),e.nrm(10,"h3",103)(11,"p",104),e.k0s()(),e.j41(12,"div",105),e.nrm(13,"button",106),e.j41(14,"button",107),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()()()()()}if(2&a){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}function fr(a,u){if(1&a){const t=e.RV6();e.j41(0,"sales-edit-order",154),e.bIt("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&a){const t=e.XpG();e.Y8G("orderSelected",t.operationId)}}let cl=(()=>{class a extends De.w{constructor(t,s,i,l,m,c,E,P,q,D,J,ee,W,Q,V){super(t,s,E,i,l,m,c),this.baseService=i,this.authDaamService=P,this.teamService=q,this.excelService=D,this.employeeService=J,this.regionService=ee,this.cityService=W,this.router=Q,this.orderReceivedService=V,this.title="sales.salesOrder.sureOrder",this.titleOperation="sales.salesOrder.sureOrder",this.keySelected="",this.searchForm={},this.isResolveList=!0,this.activeindex="2",this.active=2,this.status=[],this.countLoad=2,this.isOrderEdit=!1,this.orderSelected={},this.users=[],this.truncks=[],this.locations=[],this.salesPersons=[],this.clientSelected=0,this.discountTypes=[],this.regions=[],this.cities=[],this.setDates=(z,ge,oe)=>{if(z?.from||z?.to){const we=z.to||z.from;this.pagination[ge]=this.datePipe.transform(z.from||z.to,"yyyy-MM-ddT00:00:00"),this.pagination[oe]=this.datePipe.transform(we,"yyyy-MM-ddT23:59:59.999")}else this.pagination[ge]=null,this.pagination[oe]=null},this.loadentities(),this.GetSalesPersons(),this.discountTypes=this.baseService.discountTypes,this.discountTypes.forEach(z=>{z.name=this.getTranslationText("sales.salesOrder."+z.name)}),this.GetRegions(),this.GetCities()}GetRegions(){this.regionService.getDropDown().subscribe(t=>{this.regions=t.data},t=>{console.log(t)})}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetSalesPersons(){this.employeeService.GetAllByType(9).subscribe(t=>{this.salesPersons=t.data},t=>{console.log(t)})}loadentities(){this.countLoad=this.countLoad+1,(!this.isResolveList||1!==this.countLoad)&&(this.pagination.status=30,this.baseService.get(this.pagination).pipe((0,R.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader(N.a7),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader(N.a7),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}openModal(t,s,i="md"){this.isOrderEdit=!1,this.form={},this.orderSelected=t,this.modalService.open(s,{centered:!0,size:i})}SubmitOrder(){this.ngxLoader.startLoader(N.Fq),this.baseService.changStatus({id:this.form.id,status:this.form.status}).pipe((0,me.O)(),(0,se.c)(this.mainDelay),(0,pe.Z)(),(0,R.Q)(this.notifier),(0,ie.j)(()=>this.ngxLoader.stopLoader(N.Fq))).subscribe({next:s=>{this.modalService.dismissAll(),this.loadentities(),this.alertService.success()}})}cancelOrder(){this.ngxLoader.startLoader(N.Fq),console.log(this.operationId),this.baseService.changStatus({id:this.operationId,status:40}).pipe((0,me.O)(),(0,se.c)(this.mainDelay),(0,pe.Z)(),(0,R.Q)(this.notifier),(0,ie.j)(()=>this.ngxLoader.stopLoader(N.Fq))).subscribe({next:s=>{this.modalService.dismissAll(),this.loadentities(),this.alertService.success()}})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,R.Q)(this.notifier)).subscribe(s=>{s?this.alertService.success():this.alertService.error("general.message."+s)},s=>{this.alertService.error()})}mapRegisterForm(t){let s={...t};return s.employeeCode=0,s}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader("allLoader"),this.setDates(t.dates,"visitDateFrom","visitDateTo"),this.setDates(t.creationDates,"creationTimeFrom","creationTimeTo"),this.loadentities()}LoadSuccess(){this.ngxLoader.stopLoader("allLoader")}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems}}configRoute(){this.routerActive.data.pipe((0,R.Q)(this.notifier)).subscribe(t=>{this.entities=t.data,this.pagination.totalItems=t.data?.totalItems},()=>{this.alertService.error()})}mapExcel(){let t=[];return this.entities.forEach(s=>{t.push({"Order Code":s.orderCode,"Created Date":s.createdDate,"City Name":s.cityName,"District Name":s.districtName?s.districtName:"--","Agent Name":s.agentName,Mobile:s.mobile,"Channel Name":s.channelName,"Assigned To":s.teamNames,Times:s.workTimes,"Visit Date":s.visitDate,Services:s.services})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}goRegister(){this.router.navigateByUrl("/managment/order/new")}goEdit(t){this.router.navigateByUrl("/managment/order/new")}getStatus(t){return 10==t.offerOrderStatus||20==t.offerOrderStatus?"bg-warning-subtle text-warning":30==t.offerOrderStatus?"bg-success-subtle text-success":40==t.offerOrderStatus?"bg-danger-subtle text-danger":50==t.offerOrderStatus?"bg-danger-success text-success":"bg-warning-subtle text-warning"}checkEdit(t){return!t.isCancel&&!t.isFinish}openStatusModal(t,s,i,l="md"){this.isEditForm=!1,this.form={},this.form={id:t,status:i},this.modalService.open(s,{centered:!0,size:l})}openModalClient(t,s,i="xl"){this.clientSelected=t.orderCode,this.form=t,this.isOrderEdit=!1,this.modalService.open(s,{centered:!0,size:i})}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}openEditOrderModal(t,s,i="md"){this.form={},this.isOrderEdit=!0,this.clientSelected=t,this.modalService.open(s,{centered:!0,size:i})}OpenOrderTimeLineModel(t,s,i="md"){this.orderSelected=t,this.modalService.open(s,{centered:!0,size:i})}selectTruck(t){this.truncks=this.truncks.map(s=>({...s,isSelected:s.id===t}))}getSelectedTruckId(){const t=this.truncks.find(s=>s.isSelected);return t?t.id:null}convertToISO(t){if(t instanceof Date)return t.toISOString();if("string"==typeof t){const[s,i,l,m,c]=t.split(/[-\s:]/);return`${l}-${i}-${s}T${m}:${c}:00`}}updateTruck(){this.form.acutalVisitDate=new Date(this.convertToISO(this.form.acutalVisitDate));let t={shippingTruckId:this.form.shippingTruckId,clientLocationId:this.form.clientLocationId,offerOrderMasterId:this.form.id,Notes:this.form.notes,terms:this.form.terms,deliveryDate:this.datePipe.transform(this.form.acutalVisitDate,"yyyy-MM-ddTHH:mm:00.000"),details:this.form.details.map(s=>({id:0,itemId:s.itemId,itemName:s.itemName,quantity:s.quantity,unitId:s.unitId,price:s.price,discount:s.discount,discountType:s.discountType,clientQuantity:s.clientQuantity,approvedQuantity:s.approvedQuantity}))};this.ngxLoader.startLoader(this.operationLoader),this.orderReceivedService.register(t).pipe((0,me.O)(),(0,se.c)(this.mainDelay),(0,pe.Z)(),(0,R.Q)(this.notifier),(0,ie.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(s=>{s.success?this.submitFunished():this.alertService.error("general.message."+s.message)},s=>{this.alertService.error("general.message."+s)})}openShippingModal(t,s,i="md"){this.baseService.GetTrucks({id:t,acutalVisitDate:null}).subscribe(m=>{m.success?(this.form=m.data.order,this.getTotal(),this.form.clientVisitDate=this.formatDate(this.form.clientVisitDate),this.form.acutalVisitDate=this.formatDate(this.form.acutalVisitDate),this.truncks=m.data.truncks,this.locations=m.data.locations,this.modalService.open(s,{centered:!0,size:i})):this.alertService.error("general.message."+m.message)},m=>{this.alertService.error("general.message."+m)})}dateChangeModal(t){t=new Date(t);let s={id:this.form.id,acutalVisitDate:this.datePipe.transform(t,"yyyy-MM-ddT00:00:00.000")};this.baseService.GetTrucks(s).subscribe(i=>{i.success?this.truncks=i.data.truncks:this.alertService.error("general.message."+i.message)},i=>{this.alertService.error("general.message."+i)})}formatDate(t){if(!t)return"";const s=new Date(t);return s.getDate().toString().padStart(2,"0")+"-"+(s.getMonth()+1).toString().padStart(2,"0")+"-"+s.getFullYear()+" "+s.getHours().toString().padStart(2,"0")+":"+s.getMinutes().toString().padStart(2,"0")}getTotal(){let t=0,s=0,i=0;this.form.details.forEach(l=>{l.discount<0&&(l.discoun=0);let m=l.quantity*l.price,c=0;1===l.discountType?c=l.discount:2===l.discountType&&(c=m*l.discount/100),s=+c;let E=m-c;l.net=E,t=+E}),1===this.form.totalAddDiscountType?i=this.form.totalAddDiscount:2===this.form.totalAddDiscountType&&(i=t*this.form.totalAddDiscount/100),this.form.total=t,this.form.totalAddDiscount=this.form.totalAddDiscount,this.form.tax=15*this.form.total/100,this.form.totalNet=this.form.total-i+this.form.tax}quantitySelect(t,s){t&&(t<=0&&(t=1),this.form.details[s].quantity=parseInt(t),this.form.details[s].net=this.form.details[s].price*this.form.details[s].quantity,this.discountSelect(this.form.details[s].discount,s),this.getTotal())}discountSelect(t,s,i=1){if(t){(t=parseInt(t))<=0&&(this.form.details[s].discount=0),1==i&&(this.form.details[s].discount=t);let l=0;1==this.form.details[s].discountType?l=this.form.details[s].discount:(l=this.form.details[s].price*this.form.details[s].quantity*this.form.details[s].discount/100,l=+l.toFixed(2)),this.form.details[s].net=this.form.details[s].price*this.form.details[s].quantity-l,this.form.details[s].net=this.form.details[s].net.toFixed(2),this.getTotal()}}goNew(){this.router.navigateByUrl("/sales/new")}mapUrl(t,s){return null===t||null==s?"":`https://www.google.com/maps/dir//${s},${t}/@${s},${t},17z?hl=en-US`}static{this.\u0275fac=function(s){return new(s||a)(e.rXU(A.nX),e.rXU(O.c$),e.rXU(Ge),e.rXU(le.u),e.rXU(k.vh),e.rXU(X.eD),e.rXU(F.Bq),e.rXU(ft.J),e.rXU(Ht.n),e.rXU(He.V),e.rXU(It.O),e.rXU(Et.S),e.rXU(Ue.h),e.rXU(A.Ix),e.rXU(or))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["app-sure-order"]],features:[e.Vt3],decls:55,vars:51,consts:[["tableMaster",""],["cancelOrderModal",""],["SubmitOrderModal",""],["deleteModal",""],["OrderTimeLineModel",""],["StatusOrderModal",""],["SalesEditModel",""],["formEntity","ngForm"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"addNew","reset","search","exportXlsx","addPermission","showAdd","showExport","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","id","name","id",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],["InputTirmFilter","","type","search","id","clientName","name","clientName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["name","regionId","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],["name","cityId","bindValue","code","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],[2,"width",".2%"],["translate","",2,"width",".5%"],["pSortableColumn","id","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["pSortableColumn","creationTime","translate","",2,"width","12%"],["pSortableColumn","clientId","translate","",2,"width","10%"],["translate","",2,"width","8%"],["pSortableColumn","clientVisitDate","translate","",2,"width","8%"],["translate","",2,"width","10%"],["pSortableColumn","totalQuantity","translate","",2,"width","8%"],["translate","",2,"width","5%"],[1,"fs-5"],["type","button","pRipple","",1,"border-0","p-button-text","p-button-rounded","p-button-plain",3,"pRowToggler","ngClass"],[1,"code-pointer"],[1,"badge","bg-success-subtle","text-success"],[1,"badge","bg-primary-subtle","text-primary","my-1"],["class","badge bg-warning-subtle text-warning my-1","translate","sales.salesOrder.noDelivery",4,"ngIf"],["class","badge bg-success-subtle text-success my-1","translate","sales.salesOrder.fullDelivery",4,"ngIf"],["class","badge bg-info-subtle text-info my-1","translate","sales.salesOrder.partialDelivery",4,"ngIf"],["class","badge bg-danger-subtle text-danger mx-1","translate","orderManagement.order.noMap",4,"ngIf"],["target","_blank","class","badge bg-success-subtle text-success mx-1","translate","orderManagement.order.viewMap",3,"href",4,"ngIf"],[1,"d-inline-block"],[4,"hasPermission"],[1,"dropdown-custom","d-inline-block"],["type","button",1,"btn","dropbtn","btn-soft-secondary","btn-sm","dropdown-custom","arrow-none"],[1,"ri-more-fill"],[1,"dropdown-menu","dropdown-menu-end","dropdown-content",2,"left","0"],[3,"click",4,"hasPermission"],["translate","sales.salesOrder.noDelivery",1,"badge","bg-warning-subtle","text-warning","my-1"],["translate","sales.salesOrder.fullDelivery",1,"badge","bg-success-subtle","text-success","my-1"],["translate","sales.salesOrder.partialDelivery",1,"badge","bg-info-subtle","text-info","my-1"],["translate","orderManagement.order.noMap",1,"badge","bg-danger-subtle","text-danger","mx-1"],["target","_blank","translate","orderManagement.order.viewMap",1,"badge","bg-success-subtle","text-success","mx-1",3,"href"],[1,"ri-map-pin-line"],["class","btn btn-sm btn-primary edit-list mx-1","tooltipPosition","top",3,"pTooltip","click",4,"ngIf"],["tooltipPosition","top",1,"btn","btn-sm","btn-primary","edit-list","mx-1",3,"click","pTooltip"],[1,"ri-truck-line","align-bottom"],[3,"click"],[1,"dropdown-item"],[1,"text-primary","ri-check-double-fill","align-bottom","me-2"],["translate","sales.shippingOrder.title"],[1,"text-warning","ri-skip-back-fill","align-bottom","me-2"],["translate","sales.smApprove.title"],[1,"text-danger","ri-close-fill","align-bottom","me-2"],["translate","general.action.cancel"],["colspan","17"],[1,"table-detail"],["dataKey","id",3,"value"],["pTemplate","emptymessage"],["translate","sales.salesOrder.itemName",2,"width","10%"],["translate","sales.salesOrder.unit",2,"width","6%"],["translate","sales.salesOrder.clientQuantity",2,"width","8%"],["translate","sales.salesOrder.approvedQuantity",2,"width","8%"],["translate","sales.salesOrder.deliveryQuantity",2,"width","8%"],["colspan","8"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"ngSubmit"],[3,"hasProgressBar","fgsType","loaderId"],[1,"modal-content"],[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mt-2","text-center"],["src","https://cdn.lordicon.com/gdfrsvpt.json","stroke","bold","state","hover-oscillate","trigger","loop","colors","primary:#f7b84b,secondary:#f06548",2,"width","130px","height","130px"],[1,"pt-2","fs-15","mx-4","mx-sm-5"],["translate","orderManagement.order.AreYouSureMessage"],[1,"text-muted","mx-4","mb-0"],[1,"d-flex","gap-2","justify-content-center","mt-4","mb-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["translate","sales.salesOrder.truckUpdate"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[3,"submit"],[1,"col-12","col-md-3"],["for","name","translate","",1,"required","fw-bold","form-label"],["name","acutalVisitDate","type","text","mwlFlatpickr","","altFormat","d-m-Y H:i","required","",1,"form-control","flatpickr-input",3,"ngModelChange","ngModel","altInput","enableTime","convertModelValue","dateFormat"],["for","name","translate","orderManagement.order.savedAddress",1,"required","fw-bold","form-label"],["name","clientLocationId","bindValue","id","bindLabel","name","required","",2,"width","100%",3,"ngModelChange","disabled","items","ngModel"],[1,"col-12","col-md-6"],["name","shippingTruckId","bindValue","id","bindLabel","name","required","",2,"width","100%",3,"ngModelChange","items","ngModel"],[1,"row","justify-content-center","my-0"],[1,"card"],[1,"card-header","p-0"],[1,"d-flex","align-items-center"],["translate","sales.salesRequests.items",1,"card-title","flex-grow-1","mb-0"],[1,"table-responsive","table-card",2,"overflow","visible"],[1,"table","table-nowrap","align-middle","table-borderless","mb-0"],[1,"table-light","text-muted","p-1"],["translate","sales.salesRequests.itemName",2,"width","20%"],["translate","sales.salesRequests.unit",2,"width","25%"],["translate","sales.salesRequests.quantity",2,"width","25%"],["class","border-top border-top-dashed",4,"ngIf"],[1,"d-flex","justify-content-center","m-0"],["type","submit","type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],["clearable","false","clearOnBackspace","false","bindValue","id","bindLabel","name",2,"width","100%",3,"ngModelChange","name","items","ngModel"],["type","text","id","quantity",1,"form-control","fs-6",3,"ngModelChange","name","ngModel"],[1,"border-top","border-top-dashed"],["colspan","3"],["colspan","4",1,"fw-medium","p-0"],[1,"table","table-borderless","mb-0"],["translate","sales.salesOrder.total",1,"m-0","p-0"],[1,"text-end","m-0","p-0"],["translate","sales.salesOrder.extraDiscount",1,"m-0","p-0"],[1,"input-group","mx-4",2,"width","80%"],["clearable","false","clearOnBackspace","false","name","totalAddDiscountType","bindValue","id","bindLabel","name",3,"change","ngModelChange","items","ngModel"],["InputTirmFilter","","name","totalAddDiscount","type","text","id","totalAddDiscount",1,"form-control","fs-6",2,"width","30%",3,"change","ngModelChange","ngModel"],[1,"m-0","p-0"],["translate","sales.salesOrder.tax",1,"m-0","p-0"],[1,"border-top","border-top-dashed","m-0","p-0"],["scope","row","translate","sales.salesOrder.net",1,"m-0","p-0"],[3,"success","dismiss","orderId"],[3,"dismiss","orderSelected"]],template:function(s,i){if(1&s){const l=e.RV6();e.j41(0,"div",8)(1,"div",9)(2,"div",10),e.nrm(3,"ngx-ui-loader",11),e.j41(4,"base-filter",12),e.bIt("addNew",function(){return e.eBV(l),e.Njj(i.goNew())})("reset",function(){return e.eBV(l),e.Njj(i.onReset())})("search",function(){return e.eBV(l),e.Njj(i.onSearch())})("exportXlsx",function(){return e.eBV(l),e.Njj(i.onExportXlsx())}),e.qex(5,13),e.j41(6,"div",14)(7,"div",15)(8,"input",16),e.nI1(9,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.id,c)||(i.pagination.id=c),e.Njj(c)}),e.k0s(),e.nrm(10,"i",17),e.k0s()(),e.j41(11,"div",14)(12,"input",18),e.nI1(13,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.searchForm.creationDates,c)||(i.searchForm.creationDates=c),e.Njj(c)}),e.k0s()(),e.j41(14,"div",14)(15,"div",15)(16,"input",19),e.nI1(17,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.clientName,c)||(i.pagination.clientName=c),e.Njj(c)}),e.k0s(),e.nrm(18,"i",17),e.k0s()(),e.j41(19,"div",14)(20,"div",15)(21,"ng-select",20),e.nI1(22,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.salesPersonId,c)||(i.pagination.salesPersonId=c),e.Njj(c)}),e.k0s()()(),e.j41(23,"div",14)(24,"input",18),e.nI1(25,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.searchForm.dates,c)||(i.searchForm.dates=c),e.Njj(c)}),e.k0s()(),e.j41(26,"div",14)(27,"div",15)(28,"ng-select",21),e.nI1(29,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.regionId,c)||(i.pagination.regionId=c),e.Njj(c)}),e.k0s()()(),e.j41(30,"div",14)(31,"div",15)(32,"ng-select",22),e.nI1(33,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.cityId,c)||(i.pagination.cityId=c),e.Njj(c)}),e.k0s()()(),e.bVm(),e.k0s(),e.j41(34,"div",23)(35,"div",24)(36,"p-table",25,0),e.bIt("onLazyLoad",function(c){return e.eBV(l),e.Njj(i.tableChange(c))})("selectionChange",function(c){return e.eBV(l),e.Njj(i.onSelectionChange(c))}),e.DNE(38,tl,26,0,"ng-template",26)(39,sl,41,29,"ng-template",27)(40,dl,7,1,"ng-template",28),e.k0s()(),e.DNE(41,ci,2,0,"div",29)(42,v,6,8,"div",30),e.k0s()()()(),e.DNE(43,j,15,3,"ng-template",null,1,e.C5r)(45,U,42,15,"ng-template",null,2,e.C5r)(47,de,1,1,"ng-template",null,3,e.C5r)(49,ke,1,1,"ng-template",null,4,e.C5r)(51,_e,15,3,"ng-template",null,5,e.C5r)(53,fr,1,1,"ng-template",null,6,e.C5r)}2&s&&(e.R7$(3),e.Y8G("loaderId","sureLoader"),e.R7$(),e.Y8G("addPermission",e.lJ4(50,Wo))("showAdd",!0)("showExport",!1)("totalItems",i.pagination.totalItems)("title",i.title),e.R7$(4),e.FS9("placeholder",e.bMT(9,36,"orderManagement.order.orderCode")),e.R50("ngModel",i.pagination.id),e.R7$(4),e.FS9("placeholder",e.bMT(13,38,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",i.searchForm.creationDates),e.R7$(4),e.FS9("placeholder",e.bMT(17,40,"orderManagement.order.agentName")),e.R50("ngModel",i.pagination.clientName),e.R7$(5),e.FS9("placeholder",e.bMT(22,42,"sales.salesOrder.salsePerson")),e.Y8G("items",i.salesPersons)("multiple",!1),e.R50("ngModel",i.pagination.salesPersonId),e.R7$(3),e.FS9("placeholder",e.bMT(25,44,"sales.salesOrder.clientVisitDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",i.searchForm.dates),e.R7$(4),e.FS9("placeholder",e.bMT(29,46,"client.client.regionName")),e.Y8G("items",i.regions)("multiple",!1),e.R50("ngModel",i.pagination.regionId),e.R7$(4),e.FS9("placeholder",e.bMT(33,48,"client.client.cityName")),e.Y8G("items",i.cities)("multiple",!1),e.R50("ngModel",i.pagination.cityId),e.R7$(4),e.Y8G("value",i.entities)("rows",i.pagination.pageSize)("lazy",!0)("totalRecords",i.pagination.totalItems),e.R7$(5),e.Y8G("ngIf",i.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",i.pagination.totalItems>0))},dependencies:[k.YU,k.bT,g.qT,g.me,g.Q0,g.BC,g.cb,g.YS,g.vS,g.cV,F.s5,Ce.kL,Ye.b,$e.p,qe.g,O.Mm,Y.XI,Te.Ei,Y.Tg,Y.FP,X.Cv,fe.vr,Se.m,Be.p,gt.m,Dn,si,k.vh,O.D9],encapsulation:2})}}return a})();var Ke=x(50204);const mi=()=>["completeOrder.print"];function ml(a,u){1&a&&(e.j41(0,"tr",31),e.nrm(1,"th",32),e.j41(2,"th",33),e.EFF(3,"#"),e.k0s(),e.j41(4,"th",34),e.nrm(5,"i",35),e.EFF(6," orderManagement.order.orderCode "),e.k0s(),e.j41(7,"th",36),e.nrm(8,"i",35),e.EFF(9," orderManagement.order.creation "),e.k0s(),e.j41(10,"th",37),e.nrm(11,"i",35),e.EFF(12," orderManagement.order.agentName "),e.k0s(),e.j41(13,"th",38),e.EFF(14," sales.salesOrder.salsePerson "),e.k0s(),e.j41(15,"th",39),e.nrm(16,"i",35),e.EFF(17," sales.salesOrder.clientVisitDate "),e.k0s(),e.j41(18,"th",40),e.nrm(19,"i",35),e.EFF(20," sales.salesOrder.totalQuantity "),e.k0s(),e.j41(21,"th",41),e.nrm(22,"i",35),e.EFF(23," sales.salesOrder.totalDiscount "),e.k0s(),e.j41(24,"th",42),e.nrm(25,"i",35),e.EFF(26," sales.salesOrder.netPrice "),e.k0s(),e.nrm(27,"th",43),e.k0s())}function Sn(a,u){1&a&&(e.j41(0,"button",51),e.nI1(1,"translate"),e.nrm(2,"i",52),e.k0s()),2&a&&e.FS9("pTooltip",e.bMT(1,1,"sales.salesOrder.printOrder"))}function pi(a,u){if(1&a){const t=e.RV6();e.j41(0,"tr",44)(1,"td"),e.nrm(2,"button",45),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td",46),e.bIt("click",function(){const i=e.eBV(t).$implicit,l=e.XpG(),m=e.sdS(50);return e.Njj(l.openModalClient(i,m,"lg"))}),e.j41(6,"bdi",47),e.EFF(7),e.k0s()(),e.j41(8,"td")(9,"span",48),e.EFF(10),e.k0s(),e.EFF(11),e.nI1(12,"date"),e.k0s(),e.j41(13,"td",46),e.bIt("click",function(){const i=e.eBV(t).$implicit,l=e.XpG(),m=e.sdS(48);return e.Njj(l.openModalClient(i,m))}),e.j41(14,"span",49),e.EFF(15),e.k0s()(),e.j41(16,"td"),e.EFF(17),e.k0s(),e.j41(18,"td"),e.EFF(19),e.nI1(20,"date"),e.k0s(),e.j41(21,"td"),e.EFF(22),e.k0s(),e.j41(23,"td"),e.EFF(24),e.k0s(),e.j41(25,"td"),e.EFF(26),e.k0s(),e.j41(27,"td"),e.DNE(28,Sn,3,3,"button",50),e.k0s()()}if(2&a){const t=u.$implicit,s=u.rowIndex,i=u.expanded;e.R7$(2),e.Y8G("pRowToggler",t)("ngClass",i?" ri-arrow-down-s-line":"  ri-arrow-up-s-line"),e.R7$(2),e.JRh(s+1),e.R7$(3),e.SpI("#SO#",t.id,""),e.R7$(3),e.SpI("",t.creatorName," "),e.R7$(),e.SpI(" ",e.i5U(12,13,t.creationTime,"yyyy-MM-dd")," "),e.R7$(4),e.SpI("",t.clientName," "),e.R7$(2),e.JRh(t.salsePersonName),e.R7$(2),e.SpI(" ",e.i5U(20,16,t.clientVisitDate,"yyyy-MM-dd"),""),e.R7$(3),e.JRh(t.totalQuantity),e.R7$(2),e.JRh(t.totalDiscount),e.R7$(2),e.JRh(t.netPrice),e.R7$(2),e.Y8G("hasPermission",e.lJ4(19,mi))}}function ui(a,u){1&a&&(e.j41(0,"tr"),e.nrm(1,"th",56)(2,"th",57)(3,"th",58)(4,"th",59)(5,"th",60)(6,"th",61)(7,"th",62),e.k0s())}function ue(a,u){if(1&a&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td"),e.EFF(10),e.nI1(11,"translate"),e.k0s(),e.j41(12,"td"),e.EFF(13),e.k0s(),e.j41(14,"td"),e.EFF(15),e.k0s()()),2&a){const t=u.$implicit;e.R7$(2),e.JRh(t.itemName),e.R7$(2),e.JRh(t.unitName),e.R7$(2),e.JRh(t.clientQuantity),e.R7$(2),e.JRh(t.approvedQuantity),e.R7$(2),e.JRh(e.bMT(11,7,"sales.salesOrder."+t.discountTypeValue)),e.R7$(3),e.JRh(t.discount),e.R7$(2),e.JRh(t.price)}}function pl(a,u){1&a&&(e.j41(0,"tr"),e.nrm(1,"td",63),e.k0s())}function Gs(a,u){if(1&a&&(e.j41(0,"tr")(1,"td",53)(2,"div")(3,"p-table",54),e.DNE(4,ui,8,0,"ng-template",26)(5,ue,16,9,"ng-template",27)(6,pl,2,0,"ng-template",55),e.k0s()()()()),2&a){const t=u.$implicit;e.R7$(3),e.Y8G("value",t.offerOrderDetails)}}function gi(a,u){1&a&&(e.j41(0,"div",64),e.EFF(1," general.table.noData "),e.k0s())}function ul(a,u){if(1&a){const t=e.RV6();e.j41(0,"div",65)(1,"div",66),e.nrm(2,"ngb-pagination-info",67),e.j41(3,"table-length",68),e.bIt("lengthChange",function(i){e.eBV(t);const l=e.XpG();return e.Njj(l.ListItemChange(i))}),e.k0s()(),e.j41(4,"div",69)(5,"ngb-pagination",70),e.bIt("pageChange",function(i){e.eBV(t);const l=e.XpG();return e.Njj(l.pageChanged(i))}),e.mxI("pageChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.pagination.pageNumber,i)||(l.pagination.pageNumber=i),e.Njj(i)}),e.k0s()()()}if(2&a){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function gl(a,u){if(1&a){const t=e.RV6();e.j41(0,"form",71,7),e.bIt("ngSubmit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.SubmitOrder())}),e.nrm(2,"ngx-ui-loader",72),e.j41(3,"div",73)(4,"div",74)(5,"button",75),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()(),e.j41(6,"div",76)(7,"div",77),e.nrm(8,"lord-icon",78),e.j41(9,"div",79),e.nrm(10,"h3",80)(11,"p",81),e.k0s()(),e.j41(12,"div",82),e.nrm(13,"button",83),e.j41(14,"button",84),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()()()()()}if(2&a){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}function hl(a,u){if(1&a){const t=e.RV6();e.j41(0,"delete-modal",85),e.bIt("deleteConfirm",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.DeleteConfirm())})("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}}function hi(a,u){}function Kt(a,u){if(1&a){const t=e.RV6();e.j41(0,"app-all-orders-details",86),e.bIt("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&a){const t=e.XpG();e.Y8G("orderDetails",t.orderSelected)}}function _i(a,u){if(1&a&&e.nrm(0,"order-operation",87),2&a){const t=e.XpG();e.Y8G("isOrderEdit",t.isOrderEdit)("isInner",!0)("orderCode",t.clientSelected)}}function Ds(a,u){if(1&a){const t=e.RV6();e.j41(0,"order-timeline",88),e.bIt("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&a){const t=e.XpG();e.Y8G("orderSelected",t.orderSelected)}}let fi=(()=>{class a extends De.w{constructor(t,s,i,l,m,c,E,P,q,D,J,ee,W,Q){super(t,s,E,i,l,m,c),this.baseService=i,this.authDaamService=P,this.workTimeService=q,this.excelService=D,this.employeeService=J,this.regionService=ee,this.cityService=W,this.router=Q,this.title="sales.salesOrder.completeOrder",this.titleOperation="sales.salesOrder.completeOrder",this.keySelected="",this.assignUsers=[],this.times=[],this.employees=[],this.searchForm={},this.isResolveList=!0,this.employeeTypes=[{id:1,name:"employeeTeam"},{id:2,name:"managment"},{id:3,name:"customerService"}],this.employeeGroups=[],this.activeindex="2",this.active=2,this.formPassword={},this.roles=[],this.teams=[],this.workTimes=[],this.userTypes=[],this.actives=[{id:!0,name:"active"},{id:!1,name:"noActive"}],this.clientSelected=0,this.districts=[],this.channels=[],this.status=[],this.countLoad=2,this.isOrderEdit=!1,this.orderSelected={},this.salesPersons=[],this.regions=[],this.cities=[],this.setDates=(V,z,ge)=>{if(V?.from||V?.to){const Oe=V.to||V.from;this.pagination[z]=this.datePipe.transform(V.from||V.to,"yyyy-MM-ddT00:00:00"),this.pagination[ge]=this.datePipe.transform(Oe,"yyyy-MM-ddT23:59:59.999")}else this.pagination[z]=null,this.pagination[ge]=null},this.loadentities(),this.GetSalesPersons(),this.GetRegions(),this.GetCities()}GetRegions(){this.regionService.getDropDown().subscribe(t=>{this.regions=t.data},t=>{console.log(t)})}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetSalesPersons(){this.employeeService.GetAllByType(9).subscribe(t=>{this.salesPersons=t.data},t=>{console.log(t)})}loadentities(){this.countLoad=this.countLoad+1,(!this.isResolveList||1!==this.countLoad)&&(this.pagination.status=60,this.baseService.get(this.pagination).pipe((0,R.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader(N.a7),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader(N.a7),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}SubmitOrder(){}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,R.Q)(this.notifier)).subscribe(s=>{s?this.alertService.success():this.alertService.error("general.message."+s)},s=>{this.alertService.error()})}mapRegisterForm(t){let s={...t};return s.employeeCode=0,s}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader("allLoader"),this.setDates(t.dates,"visitDateFrom","visitDateTo"),this.setDates(t.creationDates,"creationTimeFrom","creationTimeTo"),this.loadentities()}LoadSuccess(){this.ngxLoader.stopLoader("allLoader")}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems}}configRoute(){this.routerActive.data.pipe((0,R.Q)(this.notifier)).subscribe(t=>{this.entities=t.data,this.pagination.totalItems=t.data?.totalItems},()=>{this.alertService.error()})}mapExcel(){let t=[];return this.entities.forEach(s=>{t.push({"Order Code":s.orderCode,"Created Date":s.createdDate,"City Name":s.cityName,"District Name":s.districtName?s.districtName:"--",Status:this.translateService.instant(this.getTrnslate(s)),"Agent Name":s.agentName,Mobile:s.mobile,"Channel Name":s.channelName,"Assigned To":s.teamNames,Times:s.workTimes,"Visit Date":s.visitDate,Services:s.services})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}goRegister(){this.router.navigateByUrl("/managment/order/new")}goEdit(t){this.router.navigateByUrl("/managment/order/new")}getStatus(t){return 10==t.offerOrderStatus||20==t.offerOrderStatus?"bg-warning-subtle text-warning":30==t.offerOrderStatus?"bg-success-subtle text-success":40==t.offerOrderStatus?"bg-danger-subtle text-danger":50==t.offerOrderStatus?"bg-danger-success text-success":"bg-warning-subtle text-warning"}checkEdit(t){return!t.isCancel&&!t.isFinish}getTrnslate(t){return t.isCancel?"orderManagement.order.cancel":t.isFinish?"orderManagement.order.finish":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen?"orderManagement.order.reopen":t.isAssign?"orderManagement.order.assign":t.isConfirmed?"orderManagement.order.confirmed":t.isFree?"orderManagement.order.free":"orderManagement.order.new"}openModalClient(t,s,i="xl"){this.clientSelected=t.orderCode,this.orderSelected=t,this.isOrderEdit=!1,this.modalService.open(s,{centered:!0,size:i})}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}openEditOrderModal(t,s,i="md"){this.form={},this.isOrderEdit=!0,this.clientSelected=t,this.modalService.open(s,{centered:!0,size:i})}OpenOrderTimeLineModel(t,s,i="md"){this.orderSelected=t,this.modalService.open(s,{centered:!0,size:i})}static{this.\u0275fac=function(s){return new(s||a)(e.rXU(A.nX),e.rXU(O.c$),e.rXU(Ge),e.rXU(le.u),e.rXU(k.vh),e.rXU(X.eD),e.rXU(F.Bq),e.rXU(ft.J),e.rXU(bt.G),e.rXU(He.V),e.rXU(It.O),e.rXU(Et.S),e.rXU(Ue.h),e.rXU(A.Ix))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["app-complete-order"]],features:[e.Vt3],decls:55,vars:49,consts:[["tableMaster",""],["SubmitOrderModal",""],["deleteModal",""],["clientProfile",""],["orderViewModel",""],["orderModel",""],["OrderTimeLineModel",""],["formEntity","ngForm"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"reset","search","exportXlsx","showAdd","showExport","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","id","name","id",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],["InputTirmFilter","","type","search","id","clientName","name","clientName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["name","regionId","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],["name","cityId","bindValue","code","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],[2,"width",".2%"],["translate","",2,"width",".5%"],["pSortableColumn","id","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["pSortableColumn","creationTime","translate","",2,"width","12%"],["pSortableColumn","clientId","translate","",2,"width","10%"],["translate","",2,"width","8%"],["pSortableColumn","clientVisitDate","translate","",2,"width","10%"],["pSortableColumn","totalQuantity","translate","",2,"width","8%"],["pSortableColumn","totalDiscount","translate","",2,"width","8%"],["pSortableColumn","netPrice","translate","",2,"width","8%"],["translate","",2,"width","5%"],[1,"fs-5"],["type","button","pRipple","",1,"border-0","p-button-text","p-button-rounded","p-button-plain",3,"pRowToggler","ngClass"],[3,"click"],[1,"code-pointer"],[1,"badge","bg-success-subtle","text-success"],[1,"badge","bg-primary-subtle","text-primary","my-1"],["class","btn btn-sm btn-warning edit-list mx-1","tooltipPosition","top",3,"pTooltip",4,"hasPermission"],["tooltipPosition","top",1,"btn","btn-sm","btn-warning","edit-list","mx-1",3,"pTooltip"],[1,"ri-printer-line","align-bottom"],["colspan","17",1,"table-detail"],["dataKey","id",3,"value"],["pTemplate","emptymessage"],["translate","sales.salesOrder.itemName",2,"width","10%"],["translate","sales.salesOrder.unit",2,"width","6%"],["translate","sales.salesOrder.clientQuantity",2,"width","8%"],["translate","sales.salesOrder.approvedQuantity",2,"width","8%"],["translate","sales.salesOrder.discountType",2,"width","5%"],["translate","sales.salesOrder.discount",2,"width","5%"],["translate","sales.salesOrder.price",2,"width","5%"],["colspan","8"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"ngSubmit"],[3,"hasProgressBar","fgsType","loaderId"],[1,"modal-content"],[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mt-2","text-center"],["src","https://cdn.lordicon.com/gdfrsvpt.json","stroke","bold","state","hover-oscillate","trigger","loop","colors","primary:#f7b84b,secondary:#f06548",2,"width","130px","height","130px"],[1,"pt-2","fs-15","mx-4","mx-sm-5"],["translate","orderManagement.order.AreYouSureMessage"],[1,"text-muted","mx-4","mb-0"],[1,"d-flex","gap-2","justify-content-center","mt-4","mb-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],[3,"deleteConfirm","dismiss"],[3,"dismiss","orderDetails"],[3,"isOrderEdit","isInner","orderCode"],[3,"dismiss","orderSelected"]],template:function(s,i){if(1&s){const l=e.RV6();e.j41(0,"div",8)(1,"div",9)(2,"div",10),e.nrm(3,"ngx-ui-loader",11),e.j41(4,"base-filter",12),e.bIt("reset",function(){return e.eBV(l),e.Njj(i.onReset())})("search",function(){return e.eBV(l),e.Njj(i.onSearch())})("exportXlsx",function(){return e.eBV(l),e.Njj(i.onExportXlsx())}),e.qex(5,13),e.j41(6,"div",14)(7,"div",15)(8,"input",16),e.nI1(9,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.id,c)||(i.pagination.id=c),e.Njj(c)}),e.k0s(),e.nrm(10,"i",17),e.k0s()(),e.j41(11,"div",14)(12,"input",18),e.nI1(13,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.searchForm.creationDates,c)||(i.searchForm.creationDates=c),e.Njj(c)}),e.k0s()(),e.j41(14,"div",14)(15,"div",15)(16,"input",19),e.nI1(17,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.clientName,c)||(i.pagination.clientName=c),e.Njj(c)}),e.k0s(),e.nrm(18,"i",17),e.k0s()(),e.j41(19,"div",14)(20,"div",15)(21,"ng-select",20),e.nI1(22,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.salesPersonId,c)||(i.pagination.salesPersonId=c),e.Njj(c)}),e.k0s()()(),e.j41(23,"div",14)(24,"input",18),e.nI1(25,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.searchForm.dates,c)||(i.searchForm.dates=c),e.Njj(c)}),e.k0s()(),e.j41(26,"div",14)(27,"div",15)(28,"ng-select",21),e.nI1(29,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.regionId,c)||(i.pagination.regionId=c),e.Njj(c)}),e.k0s()()(),e.j41(30,"div",14)(31,"div",15)(32,"ng-select",22),e.nI1(33,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.cityId,c)||(i.pagination.cityId=c),e.Njj(c)}),e.k0s()()(),e.bVm(),e.k0s(),e.j41(34,"div",23)(35,"div",24)(36,"p-table",25,0),e.bIt("onLazyLoad",function(c){return e.eBV(l),e.Njj(i.tableChange(c))})("selectionChange",function(c){return e.eBV(l),e.Njj(i.onSelectionChange(c))}),e.DNE(38,ml,28,0,"ng-template",26)(39,pi,29,20,"ng-template",27)(40,Gs,7,1,"ng-template",28),e.k0s()(),e.DNE(41,gi,2,0,"div",29)(42,ul,6,8,"div",30),e.k0s()()()(),e.DNE(43,gl,15,3,"ng-template",null,1,e.C5r)(45,hl,1,0,"ng-template",null,2,e.C5r)(47,hi,0,0,"ng-template",null,3,e.C5r)(49,Kt,1,1,"ng-template",null,4,e.C5r)(51,_i,1,3,"ng-template",null,5,e.C5r)(53,Ds,1,1,"ng-template",null,6,e.C5r)}2&s&&(e.R7$(3),e.Y8G("loaderId","CompleteLoader"),e.R7$(),e.Y8G("showAdd",!1)("showExport",!1)("totalItems",i.pagination.totalItems)("title",i.title),e.R7$(4),e.FS9("placeholder",e.bMT(9,35,"orderManagement.order.orderCode")),e.R50("ngModel",i.pagination.id),e.R7$(4),e.FS9("placeholder",e.bMT(13,37,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",i.searchForm.creationDates),e.R7$(4),e.FS9("placeholder",e.bMT(17,39,"orderManagement.order.agentName")),e.R50("ngModel",i.pagination.clientName),e.R7$(5),e.FS9("placeholder",e.bMT(22,41,"sales.salesOrder.salsePerson")),e.Y8G("items",i.salesPersons)("multiple",!1),e.R50("ngModel",i.pagination.salesPersonId),e.R7$(3),e.FS9("placeholder",e.bMT(25,43,"sales.salesOrder.clientVisitDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",i.searchForm.dates),e.R7$(4),e.FS9("placeholder",e.bMT(29,45,"client.client.regionName")),e.Y8G("items",i.regions)("multiple",!1),e.R50("ngModel",i.pagination.regionId),e.R7$(4),e.FS9("placeholder",e.bMT(33,47,"client.client.cityName")),e.Y8G("items",i.cities)("multiple",!1),e.R50("ngModel",i.pagination.cityId),e.R7$(4),e.Y8G("value",i.entities)("rows",i.pagination.pageSize)("lazy",!0)("totalRecords",i.pagination.totalItems),e.R7$(5),e.Y8G("ngIf",i.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",i.pagination.totalItems>0))},dependencies:[k.YU,k.bT,g.qT,g.me,g.Q0,g.BC,g.cb,g.vS,g.cV,F.s5,Ce.kL,Ye.b,Ke.L,rt.w,$e.p,qe.g,O.Mm,Y.XI,Te.Ei,Y.Tg,Y.FP,X.Cv,fe.vr,Se.m,Be.p,gt.m,k.vh,O.D9],encapsulation:2})}}return a})();function Ls(a,u){1&a&&(e.j41(0,"tr",31),e.nrm(1,"th",32),e.j41(2,"th",33),e.EFF(3,"#"),e.k0s(),e.j41(4,"th",34),e.nrm(5,"i",35),e.EFF(6," orderManagement.order.orderCode "),e.k0s(),e.j41(7,"th",36),e.nrm(8,"i",35),e.EFF(9," orderManagement.order.creation "),e.k0s(),e.j41(10,"th",37),e.nrm(11,"i",35),e.EFF(12," orderManagement.order.agentName "),e.k0s(),e.j41(13,"th",38),e.nrm(14,"i",35),e.EFF(15," sales.salesOrder.clientVisitDate "),e.k0s(),e.j41(16,"th",39),e.nrm(17,"i",35),e.EFF(18," sales.salesOrder.totalQuantity "),e.k0s(),e.j41(19,"th",40),e.nrm(20,"i",35),e.EFF(21," sales.salesOrder.totalDiscount "),e.k0s(),e.j41(22,"th",41),e.nrm(23,"i",35),e.EFF(24," sales.salesOrder.netPrice "),e.k0s(),e.j41(25,"th",42),e.nrm(26,"i",35),e.EFF(27," sales.salesOrder.cancelReasonName "),e.k0s()())}function Vs(a,u){if(1&a){const t=e.RV6();e.j41(0,"tr",43)(1,"td"),e.nrm(2,"button",44),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td",45),e.bIt("click",function(){const i=e.eBV(t).$implicit,l=e.XpG(),m=e.sdS(50);return e.Njj(l.openModalClient(i,m,"lg"))}),e.j41(6,"bdi",46),e.EFF(7),e.k0s()(),e.j41(8,"td")(9,"span",47),e.EFF(10),e.k0s(),e.EFF(11),e.nI1(12,"date"),e.k0s(),e.j41(13,"td")(14,"span",48),e.EFF(15),e.k0s()(),e.j41(16,"td"),e.EFF(17),e.nI1(18,"date"),e.k0s(),e.j41(19,"td"),e.EFF(20),e.k0s(),e.j41(21,"td"),e.EFF(22),e.k0s(),e.j41(23,"td"),e.EFF(24),e.k0s(),e.j41(25,"td")(26,"span",49),e.EFF(27),e.k0s()()()}if(2&a){const t=u.$implicit,s=u.rowIndex,i=u.expanded;e.R7$(2),e.Y8G("pRowToggler",t)("ngClass",i?" ri-arrow-down-s-line":"  ri-arrow-up-s-line"),e.R7$(2),e.JRh(s+1),e.R7$(3),e.SpI("#SO#",t.id,""),e.R7$(3),e.SpI("",t.creatorName," "),e.R7$(),e.SpI(" ",e.i5U(12,12,t.creationTime,"yyyy-MM-dd")," "),e.R7$(4),e.SpI("",t.clientName," "),e.R7$(2),e.SpI(" ",e.i5U(18,15,t.acutalVisitDate,"yyyy-MM-dd"),""),e.R7$(3),e.JRh(t.totalQuantity),e.R7$(2),e.JRh(t.totalDiscount),e.R7$(2),e.JRh(t.netPrice),e.R7$(3),e.SpI("",t.cancelReasonName," ")}}function bi(a,u){1&a&&(e.j41(0,"tr"),e.nrm(1,"th",54)(2,"th",55)(3,"th",56)(4,"th",57)(5,"th",58)(6,"th",59)(7,"th",60),e.k0s())}function Ps(a,u){if(1&a&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td"),e.EFF(10),e.nI1(11,"translate"),e.k0s(),e.j41(12,"td"),e.EFF(13),e.k0s(),e.j41(14,"td"),e.EFF(15),e.k0s()()),2&a){const t=u.$implicit;e.R7$(2),e.JRh(t.itemName),e.R7$(2),e.JRh(t.unitName),e.R7$(2),e.JRh(t.clientQuantity),e.R7$(2),e.JRh(t.approvedQuantity),e.R7$(2),e.JRh(e.bMT(11,7,"sales.salesOrder."+t.discountTypeValue)),e.R7$(3),e.JRh(t.discount),e.R7$(2),e.JRh(t.price)}}function Bn(a,u){1&a&&(e.j41(0,"tr"),e.nrm(1,"td",61),e.k0s())}function dn(a,u){if(1&a&&(e.j41(0,"tr")(1,"td",50)(2,"div",51)(3,"p-table",52),e.DNE(4,bi,8,0,"ng-template",26)(5,Ps,16,9,"ng-template",27)(6,Bn,2,0,"ng-template",53),e.k0s()()()()),2&a){const t=u.$implicit;e.R7$(3),e.Y8G("value",t.offerOrderDetails)}}function vi(a,u){1&a&&(e.j41(0,"div",62),e.EFF(1," general.table.noData "),e.k0s())}function _l(a,u){if(1&a){const t=e.RV6();e.j41(0,"div",63)(1,"div",64),e.nrm(2,"ngb-pagination-info",65),e.j41(3,"table-length",66),e.bIt("lengthChange",function(i){e.eBV(t);const l=e.XpG();return e.Njj(l.ListItemChange(i))}),e.k0s()(),e.j41(4,"div",67)(5,"ngb-pagination",68),e.bIt("pageChange",function(i){e.eBV(t);const l=e.XpG();return e.Njj(l.pageChanged(i))}),e.mxI("pageChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.pagination.pageNumber,i)||(l.pagination.pageNumber=i),e.Njj(i)}),e.k0s()()()}if(2&a){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function fl(a,u){if(1&a){const t=e.RV6();e.j41(0,"form",69,7),e.bIt("ngSubmit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.SubmitOrder())}),e.nrm(2,"ngx-ui-loader",70),e.j41(3,"div",71)(4,"div",72)(5,"button",73),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()(),e.j41(6,"div",74)(7,"div",75),e.nrm(8,"lord-icon",76),e.j41(9,"div",77),e.nrm(10,"h3",78)(11,"p",79),e.k0s()(),e.j41(12,"div",80),e.nrm(13,"button",81),e.j41(14,"button",82),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()()()()()}if(2&a){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}function bl(a,u){if(1&a){const t=e.RV6();e.j41(0,"delete-modal",83),e.bIt("deleteConfirm",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.DeleteConfirm())})("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}}function Ci(a,u){}function Si(a,u){if(1&a){const t=e.RV6();e.j41(0,"app-all-orders-details",84),e.bIt("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&a){const t=e.XpG();e.Y8G("orderDetails",t.orderSelected)}}function br(a,u){if(1&a&&e.nrm(0,"order-operation",85),2&a){const t=e.XpG();e.Y8G("isOrderEdit",t.isOrderEdit)("isInner",!0)("orderCode",t.clientSelected)}}function vl(a,u){if(1&a){const t=e.RV6();e.j41(0,"order-timeline",86),e.bIt("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&a){const t=e.XpG();e.Y8G("orderSelected",t.orderSelected)}}let Bs=(()=>{class a extends De.w{constructor(t,s,i,l,m,c,E,P,q,D,J,ee,W,Q){super(t,s,E,i,l,m,c),this.baseService=i,this.authDaamService=P,this.excelService=q,this.employeeService=D,this.channelService=J,this.regionService=ee,this.cityService=W,this.router=Q,this.title="sales.salesOrder.cancelOrder",this.titleOperation="sales.salesOrder.cancelOrder",this.keySelected="",this.employees=[],this.isResolveList=!0,this.activeindex="2",this.active=2,this.clientSelected=0,this.status=[],this.countLoad=2,this.isOrderEdit=!1,this.orderSelected={},this.users=[],this.salesPersons=[],this.searchForm={},this.regions=[],this.cities=[],this.setDates=(V,z,ge)=>{if(V?.from||V?.to){const Oe=V.to||V.from;this.pagination[z]=this.datePipe.transform(V.from||V.to,"yyyy-MM-ddT00:00:00"),this.pagination[ge]=this.datePipe.transform(Oe,"yyyy-MM-ddT23:59:59.999")}else this.pagination[z]=null,this.pagination[ge]=null},this.loadentities(),this.GetSalesPersons(),this.GetRegions(),this.GetCities()}GetRegions(){this.regionService.getDropDown().subscribe(t=>{this.regions=t.data},t=>{console.log(t)})}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}loadentities(){this.countLoad=this.countLoad+1,(!this.isResolveList||1!==this.countLoad)&&(this.pagination.status=40,this.baseService.get(this.pagination).pipe((0,R.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader(N.a7),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader(N.a7),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}SubmitOrder(){}GetSalesPersons(){this.employeeService.GetAllByType(9).subscribe(t=>{this.salesPersons=t.data},t=>{console.log(t)})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,R.Q)(this.notifier)).subscribe(s=>{s?this.alertService.success():this.alertService.error("general.message."+s)},s=>{this.alertService.error()})}mapRegisterForm(t){let s={...t};return s.employeeCode=0,s}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader("allLoader"),this.setDates(t.dates,"visitDateFrom","visitDateTo"),this.setDates(t.creationDates,"creationTimeFrom","creationTimeTo"),this.loadentities()}LoadSuccess(){this.ngxLoader.stopLoader("allLoader")}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems}}configRoute(){this.routerActive.data.pipe((0,R.Q)(this.notifier)).subscribe(t=>{this.entities=t.data,this.pagination.totalItems=t.data?.totalItems},()=>{this.alertService.error()})}mapExcel(){let t=[];return this.entities.forEach(s=>{t.push({})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}goRegister(){this.router.navigateByUrl("/managment/order/new")}goEdit(t){this.router.navigateByUrl("/managment/order/new")}getStatus(t){return 10==t.offerOrderStatus||5==t.offerOrderStatus||20==t.offerOrderStatus?"bg-warning-subtle text-warning":30==t.offerOrderStatus?"bg-success-subtle text-success":40==t.offerOrderStatus?"bg-danger-subtle text-danger":50==t.offerOrderStatus?"bg-danger-success text-success":"bg-warning-subtle text-warning"}checkEdit(t){return!t.isCancel&&!t.isFinish}openModalClient(t,s,i="xl"){this.clientSelected=t.orderCode,this.orderSelected=t,this.isOrderEdit=!1,this.modalService.open(s,{centered:!0,size:i})}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}openEditOrderModal(t,s,i="md"){this.form={},this.isOrderEdit=!0,this.clientSelected=t,this.modalService.open(s,{centered:!0,size:i})}OpenOrderTimeLineModel(t,s,i="md"){this.orderSelected=t,this.modalService.open(s,{centered:!0,size:i})}static{this.\u0275fac=function(s){return new(s||a)(e.rXU(A.nX),e.rXU(O.c$),e.rXU(Ge),e.rXU(le.u),e.rXU(k.vh),e.rXU(X.eD),e.rXU(F.Bq),e.rXU(ft.J),e.rXU(He.V),e.rXU(It.O),e.rXU(oi.l),e.rXU(Et.S),e.rXU(Ue.h),e.rXU(A.Ix))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["app-cancel-order"]],features:[e.Vt3],decls:55,vars:49,consts:[["tableMaster",""],["SubmitOrderModal",""],["deleteModal",""],["clientProfile",""],["orderViewModel",""],["orderModel",""],["OrderTimeLineModel",""],["formEntity","ngForm"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"reset","search","exportXlsx","showAdd","showExport","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","id","name","id",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],["InputTirmFilter","","type","search","id","clientName","name","clientName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["name","regionId","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],["name","cityId","bindValue","code","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],[2,"width",".2%"],["translate","",2,"width",".5%"],["pSortableColumn","id","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["pSortableColumn","creationTime","translate","",2,"width","12%"],["pSortableColumn","clientId","translate","",2,"width","10%"],["pSortableColumn","clientVisitDate","translate","",2,"width","10%"],["pSortableColumn","totalQuantity","translate","",2,"width","8%"],["pSortableColumn","totalDiscount","translate","",2,"width","8%"],["pSortableColumn","netPrice","translate","",2,"width","8%"],["pSortableColumn","cancelReasonName","translate","",2,"width","15%"],[1,"fs-5"],["type","button","pRipple","",1,"border-0","p-button-text","p-button-rounded","p-button-plain",3,"pRowToggler","ngClass"],[3,"click"],[1,"code-pointer"],[1,"badge","bg-success-subtle","text-success"],[1,"badge","bg-primary-subtle","text-primary","my-1"],[1,"badge","bg-danger-subtle","text-danger"],["colspan","17"],[1,"table-detail"],["dataKey","id",3,"value"],["pTemplate","emptymessage"],["translate","sales.salesOrder.itemName",2,"width","10%"],["translate","sales.salesOrder.unit",2,"width","6%"],["translate","sales.salesOrder.clientQuantity",2,"width","8%"],["translate","sales.salesOrder.approvedQuantity",2,"width","8%"],["translate","sales.salesOrder.discountType",2,"width","5%"],["translate","sales.salesOrder.discount",2,"width","5%"],["translate","sales.salesOrder.price",2,"width","5%"],["colspan","8"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"ngSubmit"],[3,"hasProgressBar","fgsType","loaderId"],[1,"modal-content"],[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mt-2","text-center"],["src","https://cdn.lordicon.com/gdfrsvpt.json","stroke","bold","state","hover-oscillate","trigger","loop","colors","primary:#f7b84b,secondary:#f06548",2,"width","130px","height","130px"],[1,"pt-2","fs-15","mx-4","mx-sm-5"],["translate","orderManagement.order.AreYouSureMessage"],[1,"text-muted","mx-4","mb-0"],[1,"d-flex","gap-2","justify-content-center","mt-4","mb-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],[3,"deleteConfirm","dismiss"],[3,"dismiss","orderDetails"],[3,"isOrderEdit","isInner","orderCode"],[3,"dismiss","orderSelected"]],template:function(s,i){if(1&s){const l=e.RV6();e.j41(0,"div",8)(1,"div",9)(2,"div",10),e.nrm(3,"ngx-ui-loader",11),e.j41(4,"base-filter",12),e.bIt("reset",function(){return e.eBV(l),e.Njj(i.onReset())})("search",function(){return e.eBV(l),e.Njj(i.onSearch())})("exportXlsx",function(){return e.eBV(l),e.Njj(i.onExportXlsx())}),e.qex(5,13),e.j41(6,"div",14)(7,"div",15)(8,"input",16),e.nI1(9,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.id,c)||(i.pagination.id=c),e.Njj(c)}),e.k0s(),e.nrm(10,"i",17),e.k0s()(),e.j41(11,"div",14)(12,"input",18),e.nI1(13,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.searchForm.creationDates,c)||(i.searchForm.creationDates=c),e.Njj(c)}),e.k0s()(),e.j41(14,"div",14)(15,"div",15)(16,"input",19),e.nI1(17,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.clientName,c)||(i.pagination.clientName=c),e.Njj(c)}),e.k0s(),e.nrm(18,"i",17),e.k0s()(),e.j41(19,"div",14)(20,"div",15)(21,"ng-select",20),e.nI1(22,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.salesPersonId,c)||(i.pagination.salesPersonId=c),e.Njj(c)}),e.k0s()()(),e.j41(23,"div",14)(24,"input",18),e.nI1(25,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.searchForm.dates,c)||(i.searchForm.dates=c),e.Njj(c)}),e.k0s()(),e.j41(26,"div",14)(27,"div",15)(28,"ng-select",21),e.nI1(29,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.regionId,c)||(i.pagination.regionId=c),e.Njj(c)}),e.k0s()()(),e.j41(30,"div",14)(31,"div",15)(32,"ng-select",22),e.nI1(33,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.cityId,c)||(i.pagination.cityId=c),e.Njj(c)}),e.k0s()()(),e.bVm(),e.k0s(),e.j41(34,"div",23)(35,"div",24)(36,"p-table",25,0),e.bIt("onLazyLoad",function(c){return e.eBV(l),e.Njj(i.tableChange(c))})("selectionChange",function(c){return e.eBV(l),e.Njj(i.onSelectionChange(c))}),e.DNE(38,Ls,28,0,"ng-template",26)(39,Vs,28,18,"ng-template",27)(40,dn,7,1,"ng-template",28),e.k0s()(),e.DNE(41,vi,2,0,"div",29)(42,_l,6,8,"div",30),e.k0s()()()(),e.DNE(43,fl,15,3,"ng-template",null,1,e.C5r)(45,bl,1,0,"ng-template",null,2,e.C5r)(47,Ci,0,0,"ng-template",null,3,e.C5r)(49,Si,1,1,"ng-template",null,4,e.C5r)(51,br,1,3,"ng-template",null,5,e.C5r)(53,vl,1,1,"ng-template",null,6,e.C5r)}2&s&&(e.R7$(3),e.Y8G("loaderId","cancelLoader"),e.R7$(),e.Y8G("showAdd",!1)("showExport",!1)("totalItems",i.pagination.totalItems)("title",i.title),e.R7$(4),e.FS9("placeholder",e.bMT(9,35,"orderManagement.order.orderCode")),e.R50("ngModel",i.pagination.id),e.R7$(4),e.FS9("placeholder",e.bMT(13,37,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",i.searchForm.creationDates),e.R7$(4),e.FS9("placeholder",e.bMT(17,39,"orderManagement.order.agentName")),e.R50("ngModel",i.pagination.clientName),e.R7$(5),e.FS9("placeholder",e.bMT(22,41,"sales.salesOrder.salsePerson")),e.Y8G("items",i.salesPersons)("multiple",!1),e.R50("ngModel",i.pagination.salesPersonId),e.R7$(3),e.FS9("placeholder",e.bMT(25,43,"sales.salesOrder.clientVisitDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",i.searchForm.dates),e.R7$(4),e.FS9("placeholder",e.bMT(29,45,"client.client.regionName")),e.Y8G("items",i.regions)("multiple",!1),e.R50("ngModel",i.pagination.regionId),e.R7$(4),e.FS9("placeholder",e.bMT(33,47,"client.client.cityName")),e.Y8G("items",i.cities)("multiple",!1),e.R50("ngModel",i.pagination.cityId),e.R7$(4),e.Y8G("value",i.entities)("rows",i.pagination.pageSize)("lazy",!0)("totalRecords",i.pagination.totalItems),e.R7$(5),e.Y8G("ngIf",i.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",i.pagination.totalItems>0))},dependencies:[k.YU,k.bT,g.qT,g.me,g.Q0,g.BC,g.cb,g.vS,g.cV,F.s5,Ce.kL,Ye.b,Ke.L,rt.w,$e.p,qe.g,O.Mm,Y.XI,Te.Ei,Y.Tg,Y.FP,X.Cv,fe.vr,Se.m,k.vh,O.D9],encapsulation:2})}}return a})();const Cl=()=>["salesOrder.register"],Sl=()=>["orderDraft.newOrder"],Fe=()=>["orderDraft.edit"],Le=()=>["orderDraft.cancel"];function jl(a,u){1&a&&(e.j41(0,"tr",27),e.nrm(1,"th",28),e.j41(2,"th",29),e.EFF(3,"#"),e.k0s(),e.j41(4,"th",30),e.nrm(5,"i",31),e.EFF(6," orderManagement.order.orderCode "),e.k0s(),e.j41(7,"th",32),e.nrm(8,"i",31),e.EFF(9," orderManagement.order.creation "),e.k0s(),e.j41(10,"th",33),e.nrm(11,"i",31),e.EFF(12," orderManagement.order.agentName "),e.k0s(),e.j41(13,"th",34),e.EFF(14," sales.salesOrder.salsePerson "),e.k0s(),e.j41(15,"th",35),e.nrm(16,"i",31),e.EFF(17," sales.salesOrder.clientVisitDate "),e.k0s(),e.j41(18,"th",36),e.nrm(19,"i",31),e.EFF(20," sales.salesOrder.totalQuantity "),e.k0s(),e.j41(21,"th",37),e.nrm(22,"i",31),e.EFF(23," sales.salesOrder.totalDiscount "),e.k0s(),e.j41(24,"th",38),e.EFF(25," orderManagement.order.totalTax "),e.k0s(),e.j41(26,"th",39),e.nrm(27,"i",31),e.EFF(28," sales.salesOrder.netPrice "),e.k0s(),e.nrm(29,"th",40),e.k0s())}function yl(a,u){if(1&a){const t=e.RV6();e.j41(0,"button",54),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,l=e.XpG(),m=e.sdS(36);return e.Njj(l.openStatusModal(i.id,m,10,"md"))}),e.nrm(2,"i",55),e.k0s()}2&a&&e.FS9("pTooltip",e.bMT(1,1,"sales.salesOrder.newOrder"))}function $s(a,u){if(1&a){const t=e.RV6();e.j41(0,"li",45),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,l=e.XpG(),m=e.sdS(38);return e.Njj(l.openModal(i.id,m,"xl"))}),e.j41(1,"span",56),e.nrm(2,"i",57)(3,"span",58),e.k0s()()}}function Il(a,u){if(1&a){const t=e.RV6();e.j41(0,"li",45),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,l=e.XpG(),m=e.sdS(32);return e.Njj(l.openModal(i.id,m))}),e.j41(1,"span",56),e.nrm(2,"i",59)(3,"span",60),e.k0s()()}}function vr(a,u){if(1&a){const t=e.RV6();e.j41(0,"tr",41)(1,"td"),e.nrm(2,"button",42),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td")(6,"bdi",43),e.EFF(7),e.k0s()(),e.j41(8,"td")(9,"span",44),e.EFF(10),e.k0s(),e.EFF(11),e.nI1(12,"date"),e.k0s(),e.j41(13,"td",45),e.bIt("click",function(){const i=e.eBV(t).$implicit,l=e.XpG(),m=e.sdS(40);return e.Njj(l.openModal(i.clientId,m,"md"))}),e.j41(14,"a",46),e.EFF(15),e.k0s()(),e.j41(16,"td"),e.EFF(17),e.k0s(),e.j41(18,"td"),e.EFF(19),e.nI1(20,"date"),e.k0s(),e.j41(21,"td"),e.EFF(22),e.k0s(),e.j41(23,"td"),e.EFF(24),e.k0s(),e.j41(25,"td"),e.EFF(26),e.k0s(),e.j41(27,"td"),e.EFF(28),e.k0s(),e.j41(29,"td")(30,"div",47),e.DNE(31,yl,3,3,"button",48),e.j41(32,"span",47)(33,"div",49)(34,"button",50),e.nrm(35,"i",51),e.k0s(),e.j41(36,"ul",52),e.DNE(37,$s,4,0,"li",53)(38,Il,4,0,"li",53),e.k0s()()()()()()}if(2&a){const t=u.$implicit,s=u.rowIndex,i=u.expanded;e.R7$(2),e.Y8G("pRowToggler",t)("ngClass",i?" ri-arrow-down-s-line":"  ri-arrow-up-s-line"),e.R7$(2),e.JRh(s+1),e.R7$(3),e.SpI("#DO#",t.id,""),e.R7$(3),e.SpI("",t.creatorName," "),e.R7$(),e.SpI(" ",e.i5U(12,16,t.creationTime,"yyyy-MM-dd HH:mm")," "),e.R7$(4),e.SpI(" ",t.clientName," "),e.R7$(2),e.JRh(t.salsePersonName),e.R7$(2),e.SpI(" ",e.i5U(20,19,t.acutalVisitDate,"yyyy-MM-dd HH:mm"),""),e.R7$(3),e.JRh(t.totalQuantity),e.R7$(2),e.JRh(t.totalDiscount),e.R7$(2),e.JRh(t.totalTax),e.R7$(2),e.JRh(t.netPrice),e.R7$(3),e.Y8G("hasPermission",e.lJ4(22,Sl)),e.R7$(6),e.Y8G("hasPermission",e.lJ4(23,Fe)),e.R7$(),e.Y8G("hasPermission",e.lJ4(24,Le))}}function $n(a,u){1&a&&(e.j41(0,"tr"),e.nrm(1,"th",65)(2,"th",66)(3,"th",67)(4,"th",68)(5,"th",69)(6,"th",70)(7,"th",71),e.k0s())}function Cr(a,u){if(1&a&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td")(8,"span"),e.EFF(9),e.k0s()(),e.j41(10,"td"),e.EFF(11),e.nI1(12,"translate"),e.k0s(),e.j41(13,"td"),e.EFF(14),e.k0s(),e.j41(15,"td"),e.EFF(16),e.k0s()()),2&a){const t=u.$implicit;e.R7$(2),e.JRh(t.itemName),e.R7$(2),e.JRh(t.unitName),e.R7$(2),e.JRh(t.clientQuantity),e.R7$(3),e.JRh(t.approvedQuantity),e.R7$(2),e.JRh(e.bMT(12,7,"sales.salesOrder."+t.discountTypeValue)),e.R7$(3),e.SpI(" ",t.discount," "),e.R7$(2),e.JRh(t.price)}}function jn(a,u){1&a&&(e.j41(0,"tr"),e.nrm(1,"td",72),e.k0s())}function Xn(a,u){if(1&a&&(e.j41(0,"tr")(1,"td",61)(2,"div",62)(3,"p-table",63),e.DNE(4,$n,8,0,"ng-template",22)(5,Cr,17,9,"ng-template",23)(6,jn,2,0,"ng-template",64),e.k0s()()()()),2&a){const t=u.$implicit;e.R7$(3),e.Y8G("value",t.offerOrderDetails)}}function An(a,u){1&a&&(e.j41(0,"div",73),e.EFF(1," general.table.noData "),e.k0s())}function ji(a,u){if(1&a){const t=e.RV6();e.j41(0,"div",74)(1,"div",75),e.nrm(2,"ngb-pagination-info",76),e.j41(3,"table-length",77),e.bIt("lengthChange",function(i){e.eBV(t);const l=e.XpG();return e.Njj(l.ListItemChange(i))}),e.k0s()(),e.j41(4,"div",78)(5,"ngb-pagination",79),e.bIt("pageChange",function(i){e.eBV(t);const l=e.XpG();return e.Njj(l.pageChanged(i))}),e.mxI("pageChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.pagination.pageNumber,i)||(l.pagination.pageNumber=i),e.Njj(i)}),e.k0s()()()}if(2&a){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function yn(a,u){if(1&a){const t=e.RV6();e.j41(0,"cancel-sales-model",80),e.bIt("success",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.successCancel())})("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&a){const t=e.XpG();e.Y8G("orderId",t.orderSelected)}}function Tl(a,u){if(1&a){const t=e.RV6();e.j41(0,"order-timeline",81),e.bIt("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&a){const t=e.XpG();e.Y8G("orderSelected",t.orderSelected)}}function xl(a,u){if(1&a){const t=e.RV6();e.j41(0,"form",82,6),e.bIt("ngSubmit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.SubmitOrder())}),e.nrm(2,"ngx-ui-loader",83),e.j41(3,"div",84)(4,"div",85)(5,"button",86),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()(),e.j41(6,"div",87)(7,"div",88),e.nrm(8,"lord-icon",89),e.j41(9,"div",90),e.nrm(10,"h3",91)(11,"p",92),e.k0s()(),e.j41(12,"div",93),e.nrm(13,"button",94),e.j41(14,"button",95),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()()()()()}if(2&a){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}function kl(a,u){if(1&a){const t=e.RV6();e.j41(0,"sales-edit-order",96),e.bIt("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&a){const t=e.XpG();e.Y8G("isDraft",!0)("orderSelected",t.orderSelected)}}function Fl(a,u){if(1&a){const t=e.RV6();e.j41(0,"client-summary",97),e.bIt("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&a){const t=e.XpG();e.Y8G("clientId",t.orderSelected)}}let Rl=(()=>{class a extends De.w{constructor(t,s,i,l,m,c,E,P,q,D,J,ee,W,Q,V){super(t,s,E,i,l,m,c),this.baseService=i,this.authDaamService=P,this.teamService=q,this.workTimeService=D,this.excelService=J,this.cityService=ee,this.districtService=W,this.channelService=Q,this.router=V,this.title="sales.salesOrder.draftOrder",this.titleOperation="sales.salesOrder.draftOrder",this.keySelected="",this.assignUsers=[],this.times=[],this.employees=[],this.searchForm={},this.isResolveList=!0,this.employeeTypes=[{id:1,name:"employeeTeam"},{id:2,name:"managment"},{id:3,name:"customerService"}],this.employeeGroups=[],this.activeindex="2",this.active=2,this.formPassword={},this.roles=[],this.teams=[],this.workTimes=[],this.userTypes=[],this.actives=[{id:!0,name:"active"},{id:!1,name:"noActive"}],this.clientSelected=0,this.cities=[],this.districts=[],this.channels=[],this.status=[],this.countLoad=2,this.isOrderEdit=!1,this.orderSelected={},this.users=[],this.truncks=[],this.setDates=(z,ge,oe)=>{if(z?.from||z?.to){const we=z.to||z.from;this.pagination[ge]=this.datePipe.transform(z.from||z.to,"yyyy-MM-ddT00:00:00"),this.pagination[oe]=this.datePipe.transform(we,"yyyy-MM-ddT23:59:59.999")}else this.pagination[ge]=null,this.pagination[oe]=null},this.loadentities()}loadentities(){this.countLoad=this.countLoad+1,(!this.isResolveList||1!==this.countLoad)&&(this.pagination.status=0,this.baseService.get(this.pagination).pipe((0,R.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader(N.a7),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader(N.a7),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}openModal(t,s,i="md"){this.isOrderEdit=!1,this.form={},this.orderSelected=t,this.modalService.open(s,{centered:!0,size:i})}SubmitOrder(){this.ngxLoader.startLoader(N.Fq),this.baseService.changStatus({id:this.form.id,status:this.form.status}).pipe((0,me.O)(),(0,se.c)(this.mainDelay),(0,pe.Z)(),(0,R.Q)(this.notifier),(0,ie.j)(()=>this.ngxLoader.stopLoader(N.Fq))).subscribe({next:s=>{this.modalService.dismissAll(),this.loadentities(),this.baseService.GetOrderCountSource.next(!0),this.alertService.success()}})}cancelOrder(){this.ngxLoader.startLoader(N.Fq),console.log(this.operationId),this.baseService.changStatus({id:this.operationId,status:40}).pipe((0,me.O)(),(0,se.c)(this.mainDelay),(0,pe.Z)(),(0,R.Q)(this.notifier),(0,ie.j)(()=>this.ngxLoader.stopLoader(N.Fq))).subscribe({next:s=>{this.modalService.dismissAll(),this.loadentities(),this.alertService.success()}})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,R.Q)(this.notifier)).subscribe(s=>{s?this.alertService.success():this.alertService.error("general.message."+s)},s=>{this.alertService.error()})}mapRegisterForm(t){let s={...t};return s.employeeCode=0,s}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader("allLoader"),this.setDates(t.dates,"visitDateFrom","visitDateTo"),this.setDates(t.creationDates,"creationTimeFrom","creationTimeTo"),this.loadentities()}LoadSuccess(){this.ngxLoader.stopLoader("allLoader")}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems}}configRoute(){this.routerActive.data.pipe((0,R.Q)(this.notifier)).subscribe(t=>{this.entities=t.data,this.pagination.totalItems=t.data?.totalItems},()=>{this.alertService.error()})}mapExcel(){let t=[];return this.entities.forEach(s=>{t.push({"Order Code":s.orderCode,"Created Date":s.createdDate,"City Name":s.cityName,"District Name":s.districtName?s.districtName:"--","Agent Name":s.agentName,Mobile:s.mobile,"Channel Name":s.channelName,"Assigned To":s.teamNames,Times:s.workTimes,"Visit Date":s.visitDate,Services:s.services})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}goRegister(){this.router.navigateByUrl("/managment/order/new")}goEdit(t){this.router.navigateByUrl("/managment/order/new")}getStatus(t){return 10==t.offerOrderStatus||20==t.offerOrderStatus?"bg-warning-subtle text-warning":30==t.offerOrderStatus?"bg-success-subtle text-success":40==t.offerOrderStatus?"bg-danger-subtle text-danger":50==t.offerOrderStatus?"bg-danger-success text-success":"bg-warning-subtle text-warning"}checkEdit(t){return!t.isCancel&&!t.isFinish}openStatusModal(t,s,i,l="md"){this.isEditForm=!1,this.form={},this.form={id:t,status:i},this.modalService.open(s,{centered:!0,size:l})}openModalClient(t,s,i="xl"){this.clientSelected=t.orderCode,this.form=t,this.isOrderEdit=!1,this.modalService.open(s,{centered:!0,size:i})}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}openEditOrderModal(t,s,i="md"){this.form={},this.isOrderEdit=!0,this.clientSelected=t,this.modalService.open(s,{centered:!0,size:i})}OpenOrderTimeLineModel(t,s,i="md"){this.orderSelected=t,this.modalService.open(s,{centered:!0,size:i})}successCancel(){this.baseService.GetOrderCountSource.next(!0),this.loadentities()}goNew(){this.router.navigateByUrl("/sales/new")}static{this.\u0275fac=function(s){return new(s||a)(e.rXU(A.nX),e.rXU(O.c$),e.rXU(Ge),e.rXU(le.u),e.rXU(k.vh),e.rXU(X.eD),e.rXU(F.Bq),e.rXU(ft.J),e.rXU(Ht.n),e.rXU(bt.G),e.rXU(He.V),e.rXU(Ue.h),e.rXU(Vn.m),e.rXU(oi.l),e.rXU(A.Ix))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["draft-order"]],features:[e.Vt3],decls:41,vars:34,consts:[["tableMaster",""],["deleteModal",""],["OrderTimeLineModel",""],["StatusOrderModal",""],["SalesEditModel",""],["ClientInfo",""],["formEntity","ngForm"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"addNew","reset","search","exportXlsx","addPermission","showAdd","showExport","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","id","name","id",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","search","id","clientName","name","clientName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],[2,"width",".2%"],["translate","",2,"width",".5%"],["pSortableColumn","id","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["pSortableColumn","creationTime","translate","",2,"width","12%"],["pSortableColumn","clientId","translate","",2,"width","10%"],["translate","",2,"width","8%"],["pSortableColumn","clientVisitDate","translate","",2,"width","8%"],["pSortableColumn","totalQuantity","translate","",2,"width","8%"],["pSortableColumn","totalDiscount","translate","",2,"width","7%"],["translate","",2,"width","6%"],["pSortableColumn","netPrice","translate","",2,"width","6%"],["translate","",2,"width","10%"],[1,"fs-5"],["type","button","pRipple","",1,"border-0","p-button-text","p-button-rounded","p-button-plain",3,"pRowToggler","ngClass"],[1,"code-pointer"],[1,"badge","bg-success-subtle","text-success"],[3,"click"],["href","javascript:void(0)",1,"link-primary","link-offset-2","text-decoration-underline","link-underline-opacity-25","link-underline-opacity-100-hover"],[1,"d-inline-block"],["class","btn btn-sm btn-warning edit-list mx-1","tooltipPosition","top",3,"pTooltip","click",4,"hasPermission"],[1,"dropdown-custom","d-inline-block"],["type","button",1,"btn","dropbtn","btn-soft-secondary","btn-sm","dropdown-custom","arrow-none"],[1,"ri-more-fill"],[1,"dropdown-menu","dropdown-menu-end","dropdown-content",2,"left","0"],[3,"click",4,"hasPermission"],["tooltipPosition","top",1,"btn","btn-sm","btn-warning","edit-list","mx-1",3,"click","pTooltip"],[1,"ri-checkbox-fill","align-bottom"],[1,"dropdown-item"],[1,"text-success","ri-pencil-fill","align-bottom","me-2"],["translate","general.action.edit"],[1,"text-danger","ri-close-fill","align-bottom","me-2"],["translate","general.action.cancel"],["colspan","17"],[1,"table-detail"],["dataKey","id",3,"value"],["pTemplate","emptymessage"],["translate","sales.salesOrder.itemName",2,"width","10%"],["translate","sales.salesOrder.unit",2,"width","6%"],["translate","sales.salesOrder.clientQuantity",2,"width","8%"],["translate","sales.salesOrder.approvedQuantity",2,"width","8%"],["translate","sales.salesOrder.discountType",2,"width","5%"],["translate","sales.salesOrder.discount",2,"width","5%"],["translate","sales.salesOrder.price",2,"width","5%"],["colspan","8"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"success","dismiss","orderId"],[3,"dismiss","orderSelected"],[3,"ngSubmit"],[3,"hasProgressBar","fgsType","loaderId"],[1,"modal-content"],[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mt-2","text-center"],["src","https://cdn.lordicon.com/gdfrsvpt.json","stroke","bold","state","hover-oscillate","trigger","loop","colors","primary:#f7b84b,secondary:#f06548",2,"width","130px","height","130px"],[1,"pt-2","fs-15","mx-4","mx-sm-5"],["translate","orderManagement.order.AreYouSureMessage"],[1,"text-muted","mx-4","mb-0"],[1,"d-flex","gap-2","justify-content-center","mt-4","mb-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],[3,"dismiss","isDraft","orderSelected"],[3,"dismiss","clientId"]],template:function(s,i){if(1&s){const l=e.RV6();e.j41(0,"div",7)(1,"div",8)(2,"div",9),e.nrm(3,"ngx-ui-loader",10),e.j41(4,"base-filter",11),e.bIt("addNew",function(){return e.eBV(l),e.Njj(i.goNew())})("reset",function(){return e.eBV(l),e.Njj(i.onReset())})("search",function(){return e.eBV(l),e.Njj(i.onSearch())})("exportXlsx",function(){return e.eBV(l),e.Njj(i.onExportXlsx())}),e.qex(5,12),e.j41(6,"div",13)(7,"div",14)(8,"input",15),e.nI1(9,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.id,c)||(i.pagination.id=c),e.Njj(c)}),e.k0s(),e.nrm(10,"i",16),e.k0s()(),e.j41(11,"div",13)(12,"div",14)(13,"input",17),e.nI1(14,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.clientName,c)||(i.pagination.clientName=c),e.Njj(c)}),e.k0s(),e.nrm(15,"i",16),e.k0s()(),e.j41(16,"div",13)(17,"input",18),e.nI1(18,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.searchForm.dates,c)||(i.searchForm.dates=c),e.Njj(c)}),e.k0s()(),e.j41(19,"div",13)(20,"input",18),e.nI1(21,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.searchForm.creationDates,c)||(i.searchForm.creationDates=c),e.Njj(c)}),e.k0s()(),e.bVm(),e.k0s(),e.j41(22,"div",19)(23,"div",20)(24,"p-table",21,0),e.bIt("onLazyLoad",function(c){return e.eBV(l),e.Njj(i.tableChange(c))})("selectionChange",function(c){return e.eBV(l),e.Njj(i.onSelectionChange(c))}),e.DNE(26,jl,30,0,"ng-template",22)(27,vr,39,25,"ng-template",23)(28,Xn,7,1,"ng-template",24),e.k0s()(),e.DNE(29,An,2,0,"div",25)(30,ji,6,8,"div",26),e.k0s()()(),e.DNE(31,yn,1,1,"ng-template",null,1,e.C5r)(33,Tl,1,1,"ng-template",null,2,e.C5r)(35,xl,15,3,"ng-template",null,3,e.C5r)(37,kl,1,2,"ng-template",null,4,e.C5r)(39,Fl,1,1,"ng-template",null,5,e.C5r),e.k0s()}2&s&&(e.R7$(3),e.Y8G("loaderId","sureLoader"),e.R7$(),e.Y8G("addPermission",e.lJ4(33,Cl))("showAdd",!0)("showAdd",!1)("showExport",!1)("totalItems",i.pagination.totalItems)("title",i.title),e.R7$(4),e.FS9("placeholder",e.bMT(9,25,"orderManagement.order.orderCode")),e.R50("ngModel",i.pagination.id),e.R7$(5),e.FS9("placeholder",e.bMT(14,27,"orderManagement.order.agentName")),e.R50("ngModel",i.pagination.clientName),e.R7$(4),e.FS9("placeholder",e.bMT(18,29,"orderManagement.order.visitDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",i.searchForm.dates),e.R7$(3),e.FS9("placeholder",e.bMT(21,31,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",i.searchForm.creationDates),e.R7$(4),e.Y8G("value",i.entities)("rows",i.pagination.pageSize)("lazy",!0)("totalRecords",i.pagination.totalItems),e.R7$(5),e.Y8G("ngIf",i.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",i.pagination.totalItems>0))},dependencies:[k.YU,k.bT,g.qT,g.me,g.Q0,g.BC,g.cb,g.vS,g.cV,F.s5,Ce.kL,Ye.b,$e.p,qe.g,Gt,O.Mm,Y.XI,Te.Ei,Y.Tg,Y.FP,X.Cv,Se.m,Be.p,gt.m,Dn,si,k.vh,O.D9],encapsulation:2})}}return a})();const yi=()=>["salesOrder.register"],Un=()=>["changeQTY.newOrder"],Xs=()=>["changeQTY.edit"],h=()=>["changeQTY.cancel"];function In(a,u){1&a&&(e.j41(0,"tr",31),e.nrm(1,"th",32),e.j41(2,"th",33),e.EFF(3,"#"),e.k0s(),e.j41(4,"th",34),e.nrm(5,"i",35),e.EFF(6," orderManagement.order.orderCode "),e.k0s(),e.j41(7,"th",36),e.nrm(8,"i",35),e.EFF(9," orderManagement.order.creation "),e.k0s(),e.j41(10,"th",37),e.nrm(11,"i",35),e.EFF(12," orderManagement.order.agentName "),e.k0s(),e.j41(13,"th",38),e.EFF(14," sales.salesOrder.salsePerson "),e.k0s(),e.j41(15,"th",39),e.nrm(16,"i",35),e.EFF(17," sales.salesOrder.clientVisitDate "),e.k0s(),e.j41(18,"th",40),e.EFF(19," sales.salesOrder.changeQuantityMessage "),e.k0s(),e.j41(20,"th",41),e.nrm(21,"i",35),e.EFF(22," sales.salesOrder.netPrice "),e.k0s(),e.nrm(23,"th",42),e.k0s())}function Ii(a,u){if(1&a){const t=e.RV6();e.j41(0,"button",56),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,l=e.XpG(),m=e.sdS(50);return e.Njj(l.openStatusModal(i.id,m,10,"md"))}),e.nrm(2,"i",57),e.k0s()}2&a&&e.FS9("pTooltip",e.bMT(1,1,"sales.salesOrder.newOrder"))}function ot(a,u){if(1&a){const t=e.RV6();e.j41(0,"li",47),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,l=e.XpG(),m=e.sdS(52);return e.Njj(l.openModal(i.id,m,"xl"))}),e.j41(1,"span",58),e.nrm(2,"i",59)(3,"span",60),e.k0s()()}}function ne(a,u){if(1&a){const t=e.RV6();e.j41(0,"li",47),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,l=e.XpG(),m=e.sdS(46);return e.Njj(l.openModal(i.id,m))}),e.j41(1,"span",58),e.nrm(2,"i",61)(3,"span",62),e.k0s()()}}function Ml(a,u){if(1&a){const t=e.RV6();e.j41(0,"tr",43)(1,"td"),e.nrm(2,"button",44),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td")(6,"bdi",45),e.EFF(7),e.k0s()(),e.j41(8,"td")(9,"span",46),e.EFF(10),e.k0s(),e.EFF(11),e.nI1(12,"date"),e.k0s(),e.j41(13,"td",47),e.bIt("click",function(){const i=e.eBV(t).$implicit,l=e.XpG(),m=e.sdS(54);return e.Njj(l.openModal(i.clientId,m,"md"))}),e.j41(14,"a",48),e.EFF(15),e.k0s()(),e.j41(16,"td"),e.EFF(17),e.k0s(),e.j41(18,"td"),e.EFF(19),e.nI1(20,"date"),e.k0s(),e.j41(21,"td"),e.EFF(22),e.k0s(),e.j41(23,"td"),e.EFF(24),e.k0s(),e.j41(25,"td")(26,"div",49),e.DNE(27,Ii,3,3,"button",50),e.j41(28,"span",49)(29,"div",51)(30,"button",52),e.nrm(31,"i",53),e.k0s(),e.j41(32,"ul",54),e.DNE(33,ot,4,0,"li",55)(34,ne,4,0,"li",55),e.k0s()()()()()()}if(2&a){const t=u.$implicit,s=u.rowIndex,i=u.expanded;e.R7$(2),e.Y8G("pRowToggler",t)("ngClass",i?" ri-arrow-down-s-line":"  ri-arrow-up-s-line"),e.R7$(2),e.JRh(s+1),e.R7$(3),e.SpI("#SO#",t.id,""),e.R7$(3),e.SpI("",t.creatorName," "),e.R7$(),e.SpI(" ",e.i5U(12,14,t.creationTime,"yyyy-MM-dd HH:mm")," "),e.R7$(4),e.SpI(" ",t.clientName," "),e.R7$(2),e.JRh(t.salsePersonName),e.R7$(2),e.SpI(" ",e.i5U(20,17,t.acutalVisitDate,"yyyy-MM-dd HH:mm"),""),e.R7$(3),e.JRh(t.changeQuantityMessage),e.R7$(2),e.JRh(t.netPrice),e.R7$(3),e.Y8G("hasPermission",e.lJ4(20,Un)),e.R7$(6),e.Y8G("hasPermission",e.lJ4(21,Xs)),e.R7$(),e.Y8G("hasPermission",e.lJ4(22,h))}}function Ol(a,u){1&a&&(e.j41(0,"tr"),e.nrm(1,"th",67)(2,"th",68)(3,"th",69)(4,"th",70)(5,"th",71)(6,"th",72)(7,"th",73),e.k0s())}function wl(a,u){if(1&a&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td")(8,"span"),e.EFF(9),e.k0s()(),e.j41(10,"td"),e.EFF(11),e.nI1(12,"translate"),e.k0s(),e.j41(13,"td"),e.EFF(14),e.k0s(),e.j41(15,"td"),e.EFF(16),e.k0s()()),2&a){const t=u.$implicit;e.R7$(2),e.JRh(t.itemName),e.R7$(2),e.JRh(t.unitName),e.R7$(2),e.JRh(t.clientQuantity),e.R7$(3),e.JRh(t.approvedQuantity),e.R7$(2),e.JRh(e.bMT(12,7,"sales.salesOrder."+t.discountTypeValue)),e.R7$(3),e.SpI(" ",t.discount," "),e.R7$(2),e.JRh(t.price)}}function cn(a,u){1&a&&(e.j41(0,"tr"),e.nrm(1,"td",74),e.k0s())}function Nl(a,u){if(1&a&&(e.j41(0,"tr")(1,"td",63)(2,"div",64)(3,"p-table",65),e.DNE(4,Ol,8,0,"ng-template",26)(5,wl,17,9,"ng-template",27)(6,cn,2,0,"ng-template",66),e.k0s()()()()),2&a){const t=u.$implicit;e.R7$(3),e.Y8G("value",t.offerOrderDetails)}}function El(a,u){1&a&&(e.j41(0,"div",75),e.EFF(1," general.table.noData "),e.k0s())}function Gl(a,u){if(1&a){const t=e.RV6();e.j41(0,"div",76)(1,"div",77),e.nrm(2,"ngb-pagination-info",78),e.j41(3,"table-length",79),e.bIt("lengthChange",function(i){e.eBV(t);const l=e.XpG();return e.Njj(l.ListItemChange(i))}),e.k0s()(),e.j41(4,"div",80)(5,"ngb-pagination",81),e.bIt("pageChange",function(i){e.eBV(t);const l=e.XpG();return e.Njj(l.pageChanged(i))}),e.mxI("pageChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.pagination.pageNumber,i)||(l.pagination.pageNumber=i),e.Njj(i)}),e.k0s()()()}if(2&a){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function Dl(a,u){if(1&a){const t=e.RV6();e.j41(0,"form",82,7),e.bIt("ngSubmit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.cancelOrder())}),e.nrm(2,"ngx-ui-loader",83),e.j41(3,"div",84)(4,"div",85)(5,"button",86),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()(),e.j41(6,"div",87)(7,"div",88),e.nrm(8,"lord-icon",89),e.j41(9,"div",90),e.nrm(10,"h3",91)(11,"p",92),e.k0s()(),e.j41(12,"div",93),e.nrm(13,"button",94),e.j41(14,"button",95),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()()()()()}if(2&a){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}function Ll(a,u){if(1&a){const t=e.RV6();e.j41(0,"cancel-sales-model",96),e.bIt("success",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.reload())})("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&a){const t=e.XpG();e.Y8G("orderId",t.orderSelected)}}function Dt(a,u){if(1&a){const t=e.RV6();e.j41(0,"order-timeline",97),e.bIt("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&a){const t=e.XpG();e.Y8G("orderSelected",t.orderSelected)}}function Vl(a,u){if(1&a){const t=e.RV6();e.j41(0,"form",82,7),e.bIt("ngSubmit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.SubmitOrder())}),e.nrm(2,"ngx-ui-loader",83),e.j41(3,"div",84)(4,"div",85)(5,"button",86),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()(),e.j41(6,"div",87)(7,"div",88),e.nrm(8,"lord-icon",89),e.j41(9,"div",90),e.nrm(10,"h3",91)(11,"p",92),e.k0s()(),e.j41(12,"div",93),e.nrm(13,"button",94),e.j41(14,"button",95),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()()()()()}if(2&a){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}function Pl(a,u){if(1&a){const t=e.RV6();e.j41(0,"sales-edit-order",98),e.bIt("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&a){const t=e.XpG();e.Y8G("isChangeQuantity",!0)("isDraft",!0)("orderSelected",t.orderSelected)}}function Bl(a,u){if(1&a){const t=e.RV6();e.j41(0,"client-summary",99),e.bIt("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}if(2&a){const t=e.XpG();e.Y8G("clientId",t.orderSelected)}}let $l=(()=>{class a extends De.w{constructor(t,s,i,l,m,c,E,P,q,D,J,ee,W,Q,V,z,ge){super(t,s,E,i,l,m,c),this.baseService=i,this.authDaamService=P,this.teamService=q,this.workTimeService=D,this.excelService=J,this.districtService=ee,this.channelService=W,this.router=Q,this.employeeService=V,this.regionService=z,this.cityService=ge,this.title="sales.salesOrder.changeQuantity",this.titleOperation="sales.salesOrder.changeQuantity",this.keySelected="",this.searchForm={},this.isResolveList=!0,this.activeindex="2",this.active=2,this.countLoad=2,this.isOrderEdit=!1,this.orderSelected={},this.users=[],this.truncks=[],this.clientSelected={},this.salesPersons=[],this.regions=[],this.cities=[],this.setDates=(oe,Oe,we)=>{if(oe?.from||oe?.to){const Yr=oe.to||oe.from;this.pagination[Oe]=this.datePipe.transform(oe.from||oe.to,"yyyy-MM-ddT00:00:00"),this.pagination[we]=this.datePipe.transform(Yr,"yyyy-MM-ddT23:59:59.999")}else this.pagination[Oe]=null,this.pagination[we]=null},this.loadentities(),this.GetSalesPersons(),this.GetRegions(),this.GetCities()}GetRegions(){this.regionService.getDropDown().subscribe(t=>{this.regions=t.data},t=>{console.log(t)})}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetSalesPersons(){this.employeeService.GetAllByType(9).subscribe(t=>{this.salesPersons=t.data},t=>{console.log(t)})}loadentities(){this.countLoad=this.countLoad+1,(!this.isResolveList||1!==this.countLoad)&&(this.pagination.status=5,this.baseService.get(this.pagination).pipe((0,R.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader(N.a7),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader(N.a7),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}openModal(t,s,i="md"){this.isOrderEdit=!1,this.form={},this.orderSelected=t,this.modalService.open(s,{centered:!0,size:i})}SubmitOrder(){this.ngxLoader.startLoader(N.Fq),this.baseService.changStatus({id:this.form.id,status:this.form.status}).pipe((0,me.O)(),(0,se.c)(this.mainDelay),(0,pe.Z)(),(0,R.Q)(this.notifier),(0,ie.j)(()=>this.ngxLoader.stopLoader(N.Fq))).subscribe({next:s=>{this.modalService.dismissAll(),this.reload(),this.alertService.success()}})}cancelOrder(){this.ngxLoader.startLoader(N.Fq),console.log(this.operationId),this.baseService.changStatus({id:this.operationId,status:40}).pipe((0,me.O)(),(0,se.c)(this.mainDelay),(0,pe.Z)(),(0,R.Q)(this.notifier),(0,ie.j)(()=>this.ngxLoader.stopLoader(N.Fq))).subscribe({next:s=>{this.modalService.dismissAll(),this.loadentities(),this.alertService.success()}})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,R.Q)(this.notifier)).subscribe(s=>{s?this.alertService.success():this.alertService.error("general.message."+s)},s=>{this.alertService.error()})}mapRegisterForm(t){let s={...t};return s.employeeCode=0,s}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader("allLoader"),this.setDates(t.dates,"visitDateFrom","visitDateTo"),this.setDates(t.creationDates,"creationTimeFrom","creationTimeTo"),this.loadentities()}LoadSuccess(){this.ngxLoader.stopLoader("allLoader")}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems}}configRoute(){this.routerActive.data.pipe((0,R.Q)(this.notifier)).subscribe(t=>{this.entities=t.data,this.pagination.totalItems=t.data?.totalItems},()=>{this.alertService.error()})}mapExcel(){let t=[];return this.entities.forEach(s=>{t.push({"Order Code":s.orderCode,"Created Date":s.createdDate,"City Name":s.cityName,"District Name":s.districtName?s.districtName:"--","Agent Name":s.agentName,Mobile:s.mobile,"Channel Name":s.channelName,"Assigned To":s.teamNames,Times:s.workTimes,"Visit Date":s.visitDate,Services:s.services})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}goRegister(){this.router.navigateByUrl("/managment/order/new")}goEdit(t){this.router.navigateByUrl("/managment/order/new")}getStatus(t){return 10==t.offerOrderStatus||20==t.offerOrderStatus?"bg-warning-subtle text-warning":30==t.offerOrderStatus?"bg-success-subtle text-success":40==t.offerOrderStatus?"bg-danger-subtle text-danger":50==t.offerOrderStatus?"bg-danger-success text-success":"bg-warning-subtle text-warning"}checkEdit(t){return!t.isCancel&&!t.isFinish}openStatusModal(t,s,i,l="md"){this.isEditForm=!1,this.form={},this.form={id:t,status:i},this.modalService.open(s,{centered:!0,size:l})}openModalClient(t,s,i="xl"){this.clientSelected=t.orderCode,this.form=t,this.isOrderEdit=!1,this.modalService.open(s,{centered:!0,size:i})}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}openEditOrderModal(t,s,i="md"){this.form={},this.isOrderEdit=!0,this.clientSelected=t,this.modalService.open(s,{centered:!0,size:i})}OpenOrderTimeLineModel(t,s,i="md"){this.orderSelected=t,this.modalService.open(s,{centered:!0,size:i})}reload(){this.baseService.GetOrderCountSource.next(!0),this.loadentities()}goNew(){this.router.navigateByUrl("/sales/new")}static{this.\u0275fac=function(s){return new(s||a)(e.rXU(A.nX),e.rXU(O.c$),e.rXU(Ge),e.rXU(le.u),e.rXU(k.vh),e.rXU(X.eD),e.rXU(F.Bq),e.rXU(ft.J),e.rXU(Ht.n),e.rXU(bt.G),e.rXU(He.V),e.rXU(Vn.m),e.rXU(oi.l),e.rXU(A.Ix),e.rXU(It.O),e.rXU(Et.S),e.rXU(Ue.h))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["change-quantity-order"]],features:[e.Vt3],decls:55,vars:52,consts:[["tableMaster",""],["cancelOrderModal",""],["deleteModal",""],["OrderTimeLineModel",""],["StatusOrderModal",""],["SalesEditModel",""],["ClientInfo",""],["formEntity","ngForm"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"addNew","addPermission","showAdd","loaderId"],[3,"reset","search","exportXlsx","showAdd","showExport","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","id","name","id",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","search","id","clientName","name","clientName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],["name","name","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["name","regionId","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],["name","cityId","bindValue","code","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],[2,"width",".2%"],["translate","",2,"width",".5%"],["pSortableColumn","id","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["pSortableColumn","creationTime","translate","",2,"width","12%"],["pSortableColumn","clientId","translate","",2,"width","10%"],["translate","",2,"width","8%"],["pSortableColumn","clientVisitDate","translate","",2,"width","8%"],["translate","",2,"width","20%"],["pSortableColumn","netPrice","translate","",2,"width","5%"],["translate","",2,"width","10%"],[1,"fs-5"],["type","button","pRipple","",1,"border-0","p-button-text","p-button-rounded","p-button-plain",3,"pRowToggler","ngClass"],[1,"code-pointer"],[1,"badge","bg-success-subtle","text-success"],[3,"click"],["href","javascript:void(0)",1,"link-primary","link-offset-2","text-decoration-underline","link-underline-opacity-25","link-underline-opacity-100-hover"],[1,"d-inline-block"],["class","btn btn-sm btn-warning edit-list mx-1","tooltipPosition","top",3,"pTooltip","click",4,"hasPermission"],[1,"dropdown-custom","d-inline-block"],["type","button",1,"btn","dropbtn","btn-soft-secondary","btn-sm","dropdown-custom","arrow-none"],[1,"ri-more-fill"],[1,"dropdown-menu","dropdown-menu-end","dropdown-content",2,"left","0"],[3,"click",4,"hasPermission"],["tooltipPosition","top",1,"btn","btn-sm","btn-warning","edit-list","mx-1",3,"click","pTooltip"],[1,"ri-checkbox-fill","align-bottom"],[1,"dropdown-item"],[1,"text-success","ri-pencil-fill","align-bottom","me-2"],["translate","general.action.edit"],[1,"text-danger","ri-close-fill","align-bottom","me-2"],["translate","general.action.cancel"],["colspan","17"],[1,"table-detail"],["dataKey","id",3,"value"],["pTemplate","emptymessage"],["translate","sales.salesOrder.itemName",2,"width","10%"],["translate","sales.salesOrder.unit",2,"width","6%"],["translate","sales.salesOrder.clientQuantity",2,"width","8%"],["translate","sales.salesOrder.approvedQuantity",2,"width","8%"],["translate","sales.salesOrder.discountType",2,"width","5%"],["translate","sales.salesOrder.discount",2,"width","5%"],["translate","sales.salesOrder.price",2,"width","5%"],["colspan","8"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"ngSubmit"],[3,"hasProgressBar","fgsType","loaderId"],[1,"modal-content"],[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mt-2","text-center"],["src","https://cdn.lordicon.com/gdfrsvpt.json","stroke","bold","state","hover-oscillate","trigger","loop","colors","primary:#f7b84b,secondary:#f06548",2,"width","130px","height","130px"],[1,"pt-2","fs-15","mx-4","mx-sm-5"],["translate","orderManagement.order.AreYouSureMessage"],[1,"text-muted","mx-4","mb-0"],[1,"d-flex","gap-2","justify-content-center","mt-4","mb-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],[3,"success","dismiss","orderId"],[3,"dismiss","orderSelected"],[3,"dismiss","isChangeQuantity","isDraft","orderSelected"],[3,"dismiss","clientId"]],template:function(s,i){if(1&s){const l=e.RV6();e.j41(0,"div",8)(1,"div",9)(2,"div",10)(3,"ngx-ui-loader",11),e.bIt("addNew",function(){return e.eBV(l),e.Njj(i.goNew())}),e.k0s(),e.j41(4,"base-filter",12),e.bIt("reset",function(){return e.eBV(l),e.Njj(i.onReset())})("search",function(){return e.eBV(l),e.Njj(i.onSearch())})("exportXlsx",function(){return e.eBV(l),e.Njj(i.onExportXlsx())}),e.qex(5,13),e.j41(6,"div",14)(7,"div",15)(8,"input",16),e.nI1(9,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.id,c)||(i.pagination.id=c),e.Njj(c)}),e.k0s(),e.nrm(10,"i",17),e.k0s()(),e.j41(11,"div",14)(12,"div",15)(13,"input",18),e.nI1(14,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.clientName,c)||(i.pagination.clientName=c),e.Njj(c)}),e.k0s(),e.nrm(15,"i",17),e.k0s()(),e.j41(16,"div",14)(17,"input",19),e.nI1(18,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.searchForm.creationDates,c)||(i.searchForm.creationDates=c),e.Njj(c)}),e.k0s()(),e.j41(19,"div",14)(20,"div",15)(21,"ng-select",20),e.nI1(22,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.salesPersonId,c)||(i.pagination.salesPersonId=c),e.Njj(c)}),e.k0s()()(),e.j41(23,"div",14)(24,"input",19),e.nI1(25,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.searchForm.dates,c)||(i.searchForm.dates=c),e.Njj(c)}),e.k0s()(),e.j41(26,"div",14)(27,"div",15)(28,"ng-select",21),e.nI1(29,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.regionId,c)||(i.pagination.regionId=c),e.Njj(c)}),e.k0s()()(),e.j41(30,"div",14)(31,"div",15)(32,"ng-select",22),e.nI1(33,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.cityId,c)||(i.pagination.cityId=c),e.Njj(c)}),e.k0s()()(),e.bVm(),e.k0s(),e.j41(34,"div",23)(35,"div",24)(36,"p-table",25,0),e.bIt("onLazyLoad",function(c){return e.eBV(l),e.Njj(i.tableChange(c))})("selectionChange",function(c){return e.eBV(l),e.Njj(i.onSelectionChange(c))}),e.DNE(38,In,24,0,"ng-template",26)(39,Ml,35,23,"ng-template",27)(40,Nl,7,1,"ng-template",28),e.k0s()(),e.DNE(41,El,2,0,"div",29)(42,Gl,6,8,"div",30),e.k0s()()()(),e.DNE(43,Dl,15,3,"ng-template",null,1,e.C5r)(45,Ll,1,1,"ng-template",null,2,e.C5r)(47,Dt,1,1,"ng-template",null,3,e.C5r)(49,Vl,15,3,"ng-template",null,4,e.C5r)(51,Pl,1,3,"ng-template",null,5,e.C5r)(53,Bl,1,1,"ng-template",null,6,e.C5r)}2&s&&(e.R7$(3),e.Y8G("addPermission",e.lJ4(51,yi))("showAdd",!0)("loaderId","sureLoader"),e.R7$(),e.Y8G("showAdd",!1)("showExport",!1)("totalItems",i.pagination.totalItems)("title",i.title),e.R7$(4),e.FS9("placeholder",e.bMT(9,37,"orderManagement.order.orderCode")),e.R50("ngModel",i.pagination.id),e.R7$(5),e.FS9("placeholder",e.bMT(14,39,"orderManagement.order.agentName")),e.R50("ngModel",i.pagination.clientName),e.R7$(4),e.FS9("placeholder",e.bMT(18,41,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",i.searchForm.creationDates),e.R7$(4),e.FS9("placeholder",e.bMT(22,43,"sales.salesOrder.salsePerson")),e.Y8G("items",i.salesPersons)("multiple",!1),e.R50("ngModel",i.pagination.salesPersonId),e.R7$(3),e.FS9("placeholder",e.bMT(25,45,"sales.salesOrder.clientVisitDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",i.searchForm.dates),e.R7$(4),e.FS9("placeholder",e.bMT(29,47,"client.client.regionName")),e.Y8G("items",i.regions)("multiple",!1),e.R50("ngModel",i.pagination.regionId),e.R7$(4),e.FS9("placeholder",e.bMT(33,49,"client.client.cityName")),e.Y8G("items",i.cities)("multiple",!1),e.R50("ngModel",i.pagination.cityId),e.R7$(4),e.Y8G("value",i.entities)("rows",i.pagination.pageSize)("lazy",!0)("totalRecords",i.pagination.totalItems),e.R7$(5),e.Y8G("ngIf",i.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",i.pagination.totalItems>0))},dependencies:[k.YU,k.bT,g.qT,g.me,g.Q0,g.BC,g.cb,g.vS,g.cV,F.s5,Ce.kL,Ye.b,$e.p,qe.g,Gt,O.Mm,Y.XI,Te.Ei,Y.Tg,Y.FP,X.Cv,fe.vr,Se.m,Be.p,gt.m,Dn,si,k.vh,O.D9],encapsulation:2})}}return a})();const Xl=()=>["salesOrder.view"],Lt=()=>["orderDraft.view"],Al=()=>["changeQTY.view"],Ul=()=>["smApprove.view"],Yl=()=>["storePrepare.view"],ql=()=>["shippingOrder.view"],Ql=()=>["completeOrder.view"],mn=()=>["cancelOrder.view"];function zl(a,u){1&a&&e.nrm(0,"app-all-sales-order")}function Hl(a,u){1&a&&(e.j41(0,"li",6)(1,"a",7),e.nrm(2,"span",8),e.k0s(),e.DNE(3,zl,1,0,"ng-template",9),e.k0s()),2&a&&e.Y8G("ngbNavItem",1)}function Ct(a,u){1&a&&e.nrm(0,"draft-order")}function Jl(a,u){if(1&a&&(e.j41(0,"li",6)(1,"a",7),e.nrm(2,"span",10),e.j41(3,"span",11),e.EFF(4),e.k0s()(),e.DNE(5,Ct,1,0,"ng-template",9),e.k0s()),2&a){const t=e.XpG();e.Y8G("ngbNavItem",2),e.R7$(4),e.JRh(null==t.count?null:t.count.draft)}}function Wl(a,u){1&a&&e.nrm(0,"change-quantity-order")}function Kl(a,u){if(1&a&&(e.j41(0,"li",6)(1,"a",7),e.nrm(2,"span",12),e.j41(3,"span",11),e.EFF(4),e.k0s()(),e.DNE(5,Wl,1,0,"ng-template",9),e.k0s()),2&a){const t=e.XpG();e.Y8G("ngbNavItem",3),e.R7$(4),e.JRh(null==t.count?null:t.count.changeQuantity)}}function Zl(a,u){1&a&&e.nrm(0,"app-new-order")}function ed(a,u){if(1&a&&(e.j41(0,"li",6)(1,"a",7),e.nrm(2,"span",13),e.j41(3,"span",11),e.EFF(4),e.k0s()(),e.DNE(5,Zl,1,0,"ng-template",9),e.k0s()),2&a){const t=e.XpG();e.Y8G("ngbNavItem",4),e.R7$(4),e.JRh(null==t.count?null:t.count.pending)}}function As(a,u){1&a&&e.nrm(0,"app-sure-order")}function Us(a,u){if(1&a&&(e.j41(0,"li",6)(1,"a",7),e.nrm(2,"span",14),e.j41(3,"span",11),e.EFF(4),e.k0s()(),e.DNE(5,As,1,0,"ng-template",9),e.k0s()),2&a){const t=e.XpG();e.Y8G("ngbNavItem",5),e.R7$(4),e.JRh(null==t.count?null:t.count.approved)}}function td(a,u){1&a&&e.nrm(0,"assign-order")}function nd(a,u){if(1&a&&(e.j41(0,"li",6)(1,"a",7),e.nrm(2,"span",15),e.j41(3,"span",11),e.EFF(4),e.k0s()(),e.DNE(5,td,1,0,"ng-template",9),e.k0s()),2&a){const t=e.XpG();e.Y8G("ngbNavItem",6),e.R7$(4),e.JRh(null==t.count?null:t.count.assign)}}function Sr(a,u){1&a&&e.nrm(0,"app-complete-order")}function Yn(a,u){1&a&&(e.j41(0,"li",6)(1,"a",7),e.nrm(2,"span",16),e.k0s(),e.DNE(3,Sr,1,0,"ng-template",9),e.k0s()),2&a&&e.Y8G("ngbNavItem",7)}function Ti(a,u){1&a&&e.nrm(0,"app-cancel-order")}function id(a,u){1&a&&(e.j41(0,"li",6)(1,"a",7),e.nrm(2,"span",17),e.k0s(),e.DNE(3,Ti,1,0,"ng-template",9),e.k0s()),2&a&&e.Y8G("ngbNavItem",8)}let Ys=(()=>{class a extends De.w{constructor(t,s,i,l,m,c,E,P){super(t,s,E,i,l,m,c),this.baseService=i,this.authDaamService=P,this.title="orderManagement.order.title",this.titleOperation="orderManagement.order.titleOperation",this.active=4,this.activeindex="4",this.count={},this.GetOfferOrderCount()}ngOnInitMore(){this.baseService.GetOrderCount.subscribe(()=>{this.GetOfferOrderCount()})}onNavChange(t){}GetOfferOrderCount(){this.baseService.GetOfferOrderCount().subscribe(t=>{this.count=t.data})}static{this.\u0275fac=function(s){return new(s||a)(e.rXU(A.nX),e.rXU(O.c$),e.rXU(Ge),e.rXU(le.u),e.rXU(k.vh),e.rXU(X.eD),e.rXU(F.Bq),e.rXU(ft.J))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["app-order-layout"]],features:[e.Vt3],decls:13,vars:18,consts:[["nav","ngbNav"],[1,"row"],[1,"col-lg-12"],["ngbNav","",1,"nav","nav-tabs-custom","card-header-tabs","border-bottom-0","justify-content-center",3,"activeIdChange","navChange","activeId"],[3,"ngbNavItem",4,"hasPermission"],[1,"mt-2",3,"ngbNavOutlet"],[3,"ngbNavItem"],["ngbNavLink",""],["translate","sales.salesOrder.allOrders"],["ngbNavContent",""],["translate","sales.salesOrder.draftOrder"],[1,"ms-2","badge","bg-warning"],["translate","sales.salesOrder.changeQuantity"],["translate","sales.salesOrder.newOrders"],["translate","sales.salesOrder.sureOrder"],["translate","sales.salesOrder.assignTrunk"],["translate","sales.salesOrder.completeOrder"],["translate","sales.salesOrder.cancelOrder"]],template:function(s,i){if(1&s){const l=e.RV6();e.j41(0,"div",1)(1,"div",2)(2,"ul",3,0),e.mxI("activeIdChange",function(c){return e.eBV(l),e.DH7(i.active,c)||(i.active=c),e.Njj(c)}),e.bIt("navChange",function(c){return e.eBV(l),e.Njj(i.onNavChange(c))}),e.DNE(4,Hl,4,1,"li",4)(5,Jl,6,2,"li",4)(6,Kl,6,2,"li",4)(7,ed,6,2,"li",4)(8,Us,6,2,"li",4)(9,nd,6,2,"li",4)(10,Yn,4,1,"li",4)(11,id,4,1,"li",4),e.k0s(),e.nrm(12,"div",5),e.k0s()()}if(2&s){const l=e.sdS(3);e.R7$(2),e.R50("activeId",i.active),e.R7$(2),e.Y8G("hasPermission",e.lJ4(10,Xl)),e.R7$(),e.Y8G("hasPermission",e.lJ4(11,Lt)),e.R7$(),e.Y8G("hasPermission",e.lJ4(12,Al)),e.R7$(),e.Y8G("hasPermission",e.lJ4(13,Ul)),e.R7$(),e.Y8G("hasPermission",e.lJ4(14,Yl)),e.R7$(),e.Y8G("hasPermission",e.lJ4(15,ql)),e.R7$(),e.Y8G("hasPermission",e.lJ4(16,Ql)),e.R7$(),e.Y8G("hasPermission",e.lJ4(17,mn)),e.R7$(),e.Y8G("ngbNavOutlet",l)}},dependencies:[F.Um,F.X9,F.sy,F.Gx,F.Ri,F.WA,F.m_,O.Mm,Be.p,be,je,Jo,cl,fi,Bs,Rl,$l],encapsulation:2})}}return a})(),jr=(()=>{class a extends Qt.d{constructor(t){super(t,nt.c.apiUrl+"InvoiceMaster/")}register(t){return this.http.post(this.baseUrl+"AddPaymentToInvoice",t)}edit(t){return this.http.post(this.baseUrl+"EditPayment",t)}softDelete(t){return this.http.delete(this.baseUrl+`SoftDelete/${t}`)}finishOrder(t){return this.http.post(this.baseUrl+"finishOrder",t)}getInvoiceAttachments(t){return this.http.get(this.baseUrl+"GetInvoiceAttachments/"+t)}static{this.\u0275fac=function(s){return new(s||a)(e.KVO(Ot.Qq))}}static{this.\u0275prov=e.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})(),Tt=(()=>{class a extends Qt.d{constructor(t){super(t,nt.c.apiUrl+"PaymentType/")}getLookups(){return this.http.get(this.baseUrl+"Lookups")}changStatus(t){return this.http.put(this.baseUrl+"ChangeStatus/",t)}static{this.\u0275fac=function(s){return new(s||a)(e.KVO(Ot.Qq))}}static{this.\u0275prov=e.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})();var qn=x(99902),Zt=x(3200);const lt=()=>["salesInvoices.register"],rd=()=>["salesInvoices.odooSync","salesInvoices.printPill"],qs=()=>["salesInvoices.odooSync"],Qs=()=>["salesInvoices.printPill"];function Qn(a,u){1&a&&(e.j41(0,"tr",31)(1,"th",32),e.EFF(2,"#"),e.k0s(),e.j41(3,"th",33),e.nrm(4,"i",34),e.EFF(5," orderManagement.order.invoiceCode "),e.k0s(),e.j41(6,"th",35),e.nrm(7,"i",34),e.EFF(8," orderManagement.order.clientName "),e.k0s(),e.j41(9,"th",36),e.nrm(10,"i",34),e.EFF(11," orderManagement.order.orderCode "),e.k0s(),e.j41(12,"th",37),e.nrm(13,"i",34),e.EFF(14," orderManagement.order.creation "),e.k0s(),e.j41(15,"th",38),e.EFF(16," sales.salesOrder.salsePerson "),e.k0s(),e.j41(17,"th",39),e.nrm(18,"i",34),e.EFF(19," sales.salesInvoices.total "),e.k0s(),e.j41(20,"th",40),e.nrm(21,"i",34),e.EFF(22," sales.salesOrder.totalDiscount "),e.k0s(),e.j41(23,"th",41),e.nrm(24,"i",34),e.EFF(25," sales.salesInvoices.tax "),e.k0s(),e.j41(26,"th",42),e.nrm(27,"i",34),e.EFF(28," sales.salesOrder.netPrice "),e.k0s(),e.j41(29,"th",43),e.nrm(30,"i",34),e.EFF(31," sales.salesOrder.isSync "),e.k0s(),e.j41(32,"th",44),e.nrm(33,"i",34),e.EFF(34," sales.salesInvoices.notes "),e.k0s(),e.nrm(35,"th",45),e.k0s())}function en(a,u){if(1&a&&(e.j41(0,"span",56),e.EFF(1),e.k0s()),2&a){const t=e.XpG().$implicit;e.R7$(),e.JRh(t.creatorName)}}function zs(a,u){1&a&&e.nrm(0,"span",57)}function sd(a,u){1&a&&e.nrm(0,"span",58)}function xi(a,u){1&a&&(e.j41(0,"li")(1,"span",64),e.nrm(2,"i",65)(3,"span",66),e.k0s()())}function ad(a,u){1&a&&(e.j41(0,"li")(1,"span",64),e.nrm(2,"i",65)(3,"span",67),e.k0s()())}function Hs(a,u){1&a&&(e.j41(0,"span",54)(1,"div",59)(2,"button",60),e.nrm(3,"i",61),e.k0s(),e.j41(4,"ul",62),e.DNE(5,xi,4,0,"li",63)(6,ad,4,0,"li",63),e.k0s()()()),2&a&&(e.R7$(5),e.Y8G("hasPermission",e.lJ4(2,qs)),e.R7$(),e.Y8G("hasPermission",e.lJ4(3,Qs)))}function Ee(a,u){if(1&a){const t=e.RV6();e.j41(0,"tr",46)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td",47),e.bIt("click",function(){const i=e.eBV(t).$implicit,l=e.XpG(),m=e.sdS(49);return e.Njj(l.getInvoiceAttachments(i.id,m))}),e.j41(4,"bdi",48),e.EFF(5),e.k0s()(),e.j41(6,"td"),e.EFF(7),e.k0s(),e.j41(8,"td")(9,"bdi",48),e.EFF(10),e.k0s(),e.nrm(11,"i",49),e.k0s(),e.j41(12,"td"),e.DNE(13,en,2,1,"span",50),e.EFF(14),e.nI1(15,"date"),e.k0s(),e.j41(16,"td"),e.EFF(17),e.k0s(),e.j41(18,"td"),e.EFF(19),e.k0s(),e.j41(20,"td"),e.EFF(21),e.k0s(),e.j41(22,"td"),e.EFF(23),e.k0s(),e.j41(24,"td")(25,"span",51),e.EFF(26),e.k0s()(),e.j41(27,"td"),e.DNE(28,zs,1,0,"span",52)(29,sd,1,0,"span",53),e.k0s(),e.j41(30,"td"),e.EFF(31),e.k0s(),e.j41(32,"td")(33,"div",54),e.DNE(34,Hs,7,4,"span",55),e.k0s()()()}if(2&a){const t=u.$implicit,s=u.rowIndex;e.R7$(2),e.JRh(s+1),e.R7$(3),e.SpI("#INV#",t.id,""),e.R7$(2),e.JRh(t.clientName),e.R7$(3),e.SpI("#SO#",t.offerOrderId," "),e.R7$(3),e.Y8G("ngIf",t.creatorName),e.R7$(),e.SpI(" ",e.i5U(15,15,t.creationTime,"yyyy-MM-dd")," "),e.R7$(3),e.JRh(t.salsePersonName),e.R7$(2),e.JRh(t.total),e.R7$(2),e.JRh(t.totalDiscount),e.R7$(2),e.JRh(t.tax),e.R7$(3),e.JRh(t.net),e.R7$(2),e.Y8G("ngIf",t.isSync),e.R7$(),e.Y8G("ngIf",!t.isSync),e.R7$(2),e.JRh(t.notes),e.R7$(3),e.Y8G("hasPermission",e.lJ4(18,rd))}}function yr(a,u){1&a&&(e.j41(0,"div",68),e.EFF(1," general.table.noData "),e.k0s())}function Js(a,u){if(1&a){const t=e.RV6();e.j41(0,"div",69)(1,"div",70),e.nrm(2,"ngb-pagination-info",71),e.j41(3,"table-length",72),e.bIt("lengthChange",function(i){e.eBV(t);const l=e.XpG();return e.Njj(l.ListItemChange(i))}),e.k0s()(),e.j41(4,"div",73)(5,"ngb-pagination",74),e.bIt("pageChange",function(i){e.eBV(t);const l=e.XpG();return e.Njj(l.pageChanged(i))}),e.mxI("pageChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.pagination.pageNumber,i)||(l.pagination.pageNumber=i),e.Njj(i)}),e.k0s()()()}if(2&a){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function xt(a,u){1&a&&(e.j41(0,"span",101),e.EFF(1,"general.action.register "),e.k0s())}function Ir(a,u){1&a&&(e.j41(0,"span",101),e.EFF(1,"general.action.edit "),e.k0s())}function ki(a,u){1&a&&(e.j41(0,"div",102),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function pn(a,u){1&a&&(e.j41(0,"div",102),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function Ws(a,u){if(1&a){const t=e.RV6();e.j41(0,"div",105)(1,"i",106),e.bIt("click",function(){e.eBV(t);const i=e.XpG().index,l=e.XpG(2);return e.Njj(l.removeFile(i))}),e.k0s(),e.j41(2,"p-image",107),e.bIt("error",function(i){e.eBV(t);const l=e.XpG(3);return e.Njj(l.setDefaultImage(i,"assets/images/custom/no-img.jpg"))}),e.k0s()()}2&a&&(e.R7$(2),e.Y8G("src","assets/images/PDF.png")("preview",!1)("alt","pdf"))}function Xe(a,u){if(1&a){const t=e.RV6();e.j41(0,"div",105)(1,"i",106),e.bIt("click",function(){e.eBV(t);const i=e.XpG().index,l=e.XpG(2);return e.Njj(l.removeFile(i))}),e.k0s(),e.j41(2,"p-image",107),e.bIt("error",function(i){e.eBV(t);const l=e.XpG(3);return e.Njj(l.setDefaultImage(i,"assets/images/custom/no-img.jpg"))}),e.k0s()()}if(2&a){const t=e.XpG().$implicit,s=e.XpG(2);e.R7$(2),e.Y8G("src",t.isNew?t.attachment:s.serverPath+t.attachment)("preview",!0)("alt","image")}}function Tr(a,u){if(1&a&&(e.j41(0,"div",103),e.DNE(1,Ws,3,3,"div",104)(2,Xe,3,3,"div",104),e.k0s()),2&a){const t=u.index,s=e.XpG(2);e.R7$(),e.Y8G("ngIf","application/pdf"===s.filesNames[t]),e.R7$(),e.Y8G("ngIf","application/pdf"!==s.filesNames[t])}}function od(a,u){if(1&a){const t=e.RV6();e.j41(0,"div",75)(1,"div",76)(2,"h4",77),e.DNE(3,xt,2,0,"span",78)(4,Ir,2,0,"span",78),e.j41(5,"span",79),e.EFF(6),e.k0s()(),e.j41(7,"button",80),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss("Cross click"))}),e.k0s()(),e.j41(8,"div",81),e.nrm(9,"ngx-ui-loader",82),e.j41(10,"form",83,4),e.bIt("submit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.OnSubmit())}),e.j41(12,"div",84)(13,"label",85),e.EFF(14,"sales.salesInvoices.paymentTypeName"),e.k0s(),e.j41(15,"ng-select",86,5),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.form.paymentTypeId,i)||(l.form.paymentTypeId=i),e.Njj(i)}),e.k0s(),e.DNE(17,ki,2,0,"div",87),e.k0s(),e.j41(18,"div",84)(19,"label",88),e.EFF(20,"sales.salesInvoices.cost"),e.k0s(),e.j41(21,"input",89,6),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.form.cost,i)||(l.form.cost=i),e.Njj(i)}),e.k0s(),e.DNE(23,pn,2,0,"div",90),e.k0s(),e.j41(24,"div",84)(25,"label",91),e.EFF(26,"general.table.notes"),e.k0s(),e.j41(27,"textarea",92),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.form.notes,i)||(l.form.notes=i),e.Njj(i)}),e.EFF(28,"                    "),e.k0s()(),e.j41(29,"div",9)(30,"div",93)(31,"label",85),e.EFF(32," orderManagement.order.attachment"),e.k0s(),e.j41(33,"input",94,7),e.bIt("change",function(i){e.eBV(t);const l=e.XpG();return e.Njj(l.onFileSelected(i))}),e.k0s()(),e.j41(35,"div",95),e.DNE(36,Tr,3,2,"div",96),e.k0s()(),e.j41(37,"div",97)(38,"button",98),e.nrm(39,"i",99)(40,"span",100),e.k0s()()()()()}if(2&a){const t=e.sdS(11),s=e.sdS(16),i=e.sdS(22),l=e.XpG();e.R7$(3),e.Y8G("ngIf",!l.isEditForm),e.R7$(),e.Y8G("ngIf",l.isEditForm),e.R7$(2),e.JRh(l.titleOperation),e.R7$(3),e.Y8G("hasProgressBar",!1)("fgsType",l.loaderOperationShap)("loaderId",l.operationLoader),e.R7$(6),e.Y8G("items",l.paymentMethods)("multiple",!1),e.R50("ngModel",l.form.paymentTypeId),e.R7$(2),e.Y8G("ngIf",s.invalid&&s.touched),e.R7$(4),e.R50("ngModel",l.form.cost),e.R7$(2),e.Y8G("ngIf",i.invalid&&i.touched),e.R7$(4),e.R50("ngModel",l.form.notes),e.R7$(9),e.Y8G("ngForOf",l.filesToShow),e.R7$(2),e.Y8G("disabled",!t.valid)}}function ld(a,u){if(1&a){const t=e.RV6();e.j41(0,"delete-modal",108),e.bIt("deleteConfirm",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.DeleteConfirmSoft())})("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}}function dd(a,u){if(1&a){const t=e.RV6();e.j41(0,"div",111)(1,"p-image",112),e.bIt("error",function(i){e.eBV(t);const l=e.XpG(2);return e.Njj(l.setDefaultImage(i,"assets/images/custom/no-img.jpg"))}),e.k0s()()}if(2&a){const t=u.$implicit,s=e.XpG(2);e.R7$(),e.Y8G("src",s.serverPath+t.path)("preview",!0)}}function xr(a,u){if(1&a){const t=e.RV6();e.j41(0,"div",75)(1,"div",76)(2,"button",80),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss("Cross click"))}),e.k0s()(),e.j41(3,"div",109)(4,"div",9),e.DNE(5,dd,2,2,"div",110),e.k0s()()()}if(2&a){const t=e.XpG();e.R7$(5),e.Y8G("ngForOf",t.images)}}let cd=(()=>{class a extends De.w{constructor(t,s,i,l,m,c,E,P,q,D,J,ee){super(t,s,E,i,l,m,c),this.baseService=i,this.paymentTypesService=P,this.formData=q,this.employeeService=D,this.regionService=J,this.cityService=ee,this.title="sales.salesInvoices.title",this.titleOperation="sales.salesInvoices.payment",this.paymentMethods=[],this.searchForm={},this.form={file:""},this.filesToSend=[],this.filesToShow=[],this.filesNames=[],this.isResolveList=!0,this.serverPath=nt.c.mediaUrl,this.countLoad=0,this.isOrderEdit=!1,this.images=[],this.salesPersons=[],this.regions=[],this.cities=[],this.setDates=(W,Q,V)=>{if(W?.from||W?.to){const ge=W.to||W.from;this.pagination[Q]=this.datePipe.transform(W.from||W.to,"yyyy-MM-ddT00:00:00"),this.pagination[V]=this.datePipe.transform(ge,"yyyy-MM-ddT23:59:59.999")}else this.pagination[Q]=null,this.pagination[V]=null},this.configRoute(),this.GetSalesPersons(),this.GetRegions(),this.GetCities()}GetRegions(){this.regionService.getDropDown().subscribe(t=>{this.regions=t.data},t=>{console.log(t)})}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetSalesPersons(){this.employeeService.GetAllByType(9).subscribe(t=>{this.salesPersons=t.data},t=>{console.log(t)})}configRoute(){this.routerActive.data.pipe((0,R.Q)(this.notifier)).subscribe(t=>{this.entities=t.data.data,this.pagination.totalItems=t.data.totalItems},()=>{this.alertService.error()})}getInvoiceAttachments(t,s){this.baseService.getInvoiceAttachments(t).subscribe({next:i=>{this.images=i.data,this.modalService.open(s,{centered:!0,size:"md"})}})}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader("allLoader"),this.setDates(t.dates,"visitDateFrom","visitDateTo"),this.setDates(t.creationDates,"creationTimeFrom","creationTimeTo"),this.loadentities()}LoadSuccess(){this.ngxLoader.stopLoader("allLoader")}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems}}openInvoiceModal(t,s,i="md",l){if(this.isEditForm=l,this.form={},this.clearFiles(),this.operationId=t.id,l){this.form=t,console.log(this.form);let m="";t.path&&(m=t.path.split(".")[1]),this.filesToSend.push({id:0,isNew:!1,attachment:t.path}),this.filesToShow.push({id:0,isNew:!1,attachment:t.path}),this.filesNames.push("pdf"===m?"application/pdf":m),this.modalService.open(s,{centered:!0,size:i})}else this.form.invoiceMasterId=t.id,this.modalService.open(s,{centered:!0,size:i})}onFileSelected(t){this.clearFiles();const s=t.target;if(t.target.files&&t.target.files[0]){let i=t.target.files.length;for(let l=0;l<i;l++){let m=new FileReader;this.filesToSend.push({id:0,isNew:!0,attachment:t.target.files.item(l)}),this.filesNames.push(t.target.files[l].type),m.onload=c=>{this.filesToShow.push({id:0,isNew:!0,attachment:c.target.result}),console.log(this.filesToShow)},m.readAsDataURL(t.target?.files[l])}s.value=""}}setDefaultImage(t,s){t.target.src=s}checkExtension(t){const i=t.split("/").pop().split(".").pop();return console.log(),i}checkUrl(t){return null==t||""==t?"":t.startsWith("/upload")?t.replace("/upload","upload"):t}removeFile(t){this.filesToShow.splice(t,1),this.filesNames.splice(t,1),this.filesToSend.splice(t,1)}clearFiles(){this.filesNames=[],this.filesToShow=[],this.filesToSend=[]}registerEntity(){let t=this.mapRegisterForm(this.form);t.file=this.filesToSend&&this.filesToSend.length>0?this.filesToSend[0].attachment:null,this.baseService.register(this.formData.formatFormData(t)).pipe((0,me.O)(),(0,se.c)(this.mainDelay),(0,pe.Z)(),(0,R.Q)(this.notifier),(0,ie.j)(()=>this.ngxLoader.stopLoader(N.ZW)),(0,qt.W)(s=>(0,fn.$)(s))).subscribe(s=>{s.success?(this.modalService.dismissAll(),this.submitFunished()):this.alertService.error("general.message."+s.message)},s=>{this.alertService.error("general.message."+s)})}editEntity(){let t=this.mapForm(this.form);t.file=this.filesToSend&&this.filesToSend.length>0?this.filesToSend[0].attachment:null,this.baseService.edit(this.formData.formatFormData(t)).pipe((0,me.O)(),(0,se.c)(this.mainDelay),(0,pe.Z)(),(0,R.Q)(this.notifier),(0,ie.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(s=>{s.success?this.submitFunished():this.alertService.error("general.message."+s.message)},s=>{this.alertService.error("general.message."+s)})}static{this.\u0275fac=function(s){return new(s||a)(e.rXU(A.nX),e.rXU(O.c$),e.rXU(jr),e.rXU(le.u),e.rXU(k.vh),e.rXU(X.eD),e.rXU(F.Bq),e.rXU(Tt),e.rXU(qn.Q),e.rXU(It.O),e.rXU(Et.S),e.rXU(Ue.h))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["app-sales-invoices"]],features:[e.Vt3],decls:50,vars:55,consts:[["tableMaster",""],["addPaymentModal",""],["deleteModal",""],["viewMedia",""],["formEntity","ngForm"],["paymentTypeId","ngModel"],["cost","ngModel"],["fileInput",""],[3,"title","breadcrumbItems"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"reset","search","addPermission","showAdd","showExport","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","id","name","id",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","search","id","clientName","name","clientName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],["name","regionId","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],["name","cityId","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["translate","",2,"width",".3%"],["pSortableColumn","id","translate","",2,"width","3%"],[1,"ri-expand-up-down-line"],["pSortableColumn","clientId","translate","",2,"width","10%"],["pSortableColumn","id","translate","",2,"width","4%"],["pSortableColumn","creationTime","translate","",2,"width","5%"],["translate","",2,"width","8%"],["pSortableColumn","total","translate","",2,"width","5%"],["pSortableColumn","totalDiscount","translate","",2,"width","5%"],["pSortableColumn","tax","translate","",2,"width","4%"],["pSortableColumn","net","translate","",2,"width","4%"],["pSortableColumn","isSync","translate","",2,"width","5%"],["pSortableColumn","notes","translate","",2,"width","5%"],[2,"width","6%"],[1,"fs-5"],[3,"click"],[1,"code-pointer"],[1,"ri-share-circle-fill","label-icon","align-middle","rounded-pill","fs-16","me-2"],["class","badge bg-success-subtle text-success",4,"ngIf"],[1,"badge","fs-5","bg-success-subtle","text-success","badge-border"],["class","badge bg-success","translate","sales.salesOrder.syncSend",4,"ngIf"],["class","badge bg-warning","translate","sales.salesOrder.syncNotSend",4,"ngIf"],[1,"d-inline-block"],["class","d-inline-block",4,"hasPermission"],[1,"badge","bg-success-subtle","text-success"],["translate","sales.salesOrder.syncSend",1,"badge","bg-success"],["translate","sales.salesOrder.syncNotSend",1,"badge","bg-warning"],[1,"dropdown-custom","d-inline-block"],["type","button",1,"btn","dropbtn","btn-soft-secondary","btn-sm","dropdown-custom","arrow-none"],[1,"ri-more-fill"],[1,"dropdown-menu","dropdown-menu-end","dropdown-content",2,"left","0"],[4,"hasPermission"],[1,"dropdown-item"],[1,"ri-printer-line","align-bottom","me-2","text-muted"],["translate","sales.salesOrder.isSync"],["translate","orderManagement.order.printPill"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["class","fw-bold fs-4","translate","",4,"ngIf"],["translate",""],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"hasProgressBar","fgsType","loaderId"],[3,"submit"],[1,"mb-3"],["translate","",1,"required","fw-bold","form-label","w-100"],["name","paymentTypeId","bindValue","code","bindLabel","name","required","",3,"ngModelChange","items","multiple","ngModel"],["class","text-danger text-center","translate","",4,"ngIf"],["for","cost","translate","",1,"required","fw-bold","form-label"],["InputTirmFilter","","name","cost","type","text","id","employeeName","required","",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["class","text-danger text-center  ","translate","",4,"ngIf"],["for","notes","translate","",1,"fw-bold","form-label"],["rows","3","name","notes","type","text","id","notes",1,"form-control","fs-6",3,"ngModelChange","ngModel"],[1,"col-12","mb-2"],["accept","image/*, application/pdf","type","file","placeholder","dfd",1,"form-control","fs-6",3,"change"],[1,"my-3","row","row-cols-5"],["class","col",4,"ngFor","ngForOf"],[1,"text-center"],["type","submit","type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],["translate","",1,"fw-bold","fs-4"],["translate","",1,"text-danger","text-center"],[1,"col"],["class","position-relative",4,"ngIf"],[1,"position-relative"],[1,"ri-close-fill","position-absolute",2,"border-radius","50%","background-color","red","inset-inline-start","-14px","top","-8px","color","white",3,"click"],["width","50","height","50",3,"error","src","preview","alt"],[3,"deleteConfirm","dismiss"],[1,"modal-body","p-4"],["class","col-12 col-md-3",4,"ngFor","ngForOf"],[1,"col-12","col-md-3"],["width","80","height","100",3,"error","src","preview"]],template:function(s,i){if(1&s){const l=e.RV6();e.nrm(0,"app-breadcrumbs",8),e.nI1(1,"translate"),e.j41(2,"div",9)(3,"div",10)(4,"div",11),e.nrm(5,"ngx-ui-loader",12),e.j41(6,"base-filter",13),e.bIt("reset",function(){return e.eBV(l),e.Njj(i.onReset())})("search",function(){return e.eBV(l),e.Njj(i.onSearch())}),e.qex(7,14),e.j41(8,"div",15)(9,"div",16)(10,"input",17),e.nI1(11,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.id,c)||(i.pagination.id=c),e.Njj(c)}),e.k0s(),e.nrm(12,"i",18),e.k0s()(),e.j41(13,"div",15)(14,"div",16)(15,"input",19),e.nI1(16,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.clientName,c)||(i.pagination.clientName=c),e.Njj(c)}),e.k0s(),e.nrm(17,"i",18),e.k0s()(),e.j41(18,"div",15)(19,"div",16)(20,"ng-select",20),e.nI1(21,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.salesPersonId,c)||(i.pagination.salesPersonId=c),e.Njj(c)}),e.k0s()()(),e.j41(22,"div",15)(23,"input",21),e.nI1(24,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.searchForm.dates,c)||(i.searchForm.dates=c),e.Njj(c)}),e.k0s()(),e.j41(25,"div",15)(26,"input",21),e.nI1(27,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.searchForm.creationDates,c)||(i.searchForm.creationDates=c),e.Njj(c)}),e.k0s()(),e.j41(28,"div",15)(29,"div",16)(30,"ng-select",22),e.nI1(31,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.regionId,c)||(i.pagination.regionId=c),e.Njj(c)}),e.k0s()()(),e.j41(32,"div",15)(33,"div",16)(34,"ng-select",23),e.nI1(35,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.cityId,c)||(i.pagination.cityId=c),e.Njj(c)}),e.k0s()()(),e.bVm(),e.k0s(),e.j41(36,"div",24)(37,"div",25)(38,"p-table",26,0),e.bIt("onLazyLoad",function(c){return e.eBV(l),e.Njj(i.tableChange(c))})("selectionChange",function(c){return e.eBV(l),e.Njj(i.onSelectionChange(c))}),e.DNE(40,Qn,36,0,"ng-template",27)(41,Ee,35,19,"ng-template",28),e.k0s()(),e.DNE(42,yr,2,0,"div",29)(43,Js,6,8,"div",30),e.k0s()()()(),e.DNE(44,od,41,15,"ng-template",null,1,e.C5r)(46,ld,1,0,"ng-template",null,2,e.C5r)(48,xr,6,1,"ng-template",null,3,e.C5r)}2&s&&(e.FS9("title",e.bMT(1,38,i.title)),e.Y8G("breadcrumbItems",i.breadCrumbItems),e.R7$(5),e.Y8G("loaderId","newLoader"),e.R7$(),e.Y8G("addPermission",e.lJ4(54,lt))("showAdd",!1)("showExport",!1)("totalItems",i.pagination.totalItems)("title",i.title),e.R7$(4),e.FS9("placeholder",e.bMT(11,40,"orderManagement.order.orderCode")),e.R50("ngModel",i.pagination.id),e.R7$(5),e.FS9("placeholder",e.bMT(16,42,"orderManagement.order.agentName")),e.R50("ngModel",i.pagination.clientName),e.R7$(5),e.FS9("placeholder",e.bMT(21,44,"sales.salesOrder.salsePerson")),e.Y8G("items",i.salesPersons)("multiple",!1),e.R50("ngModel",i.pagination.salesPersonId),e.R7$(3),e.FS9("placeholder",e.bMT(24,46,"orderManagement.order.visitDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",i.searchForm.dates),e.R7$(3),e.FS9("placeholder",e.bMT(27,48,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",i.searchForm.creationDates),e.R7$(4),e.FS9("placeholder",e.bMT(31,50,"client.client.regionName")),e.Y8G("items",i.regions)("multiple",!1),e.R50("ngModel",i.pagination.regionId),e.R7$(4),e.FS9("placeholder",e.bMT(35,52,"client.client.cityName")),e.Y8G("items",i.cities)("multiple",!1),e.R50("ngModel",i.pagination.cityId),e.R7$(4),e.Y8G("value",i.entities)("rows",i.pagination.pageSize)("lazy",!0)("totalRecords",i.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",i.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",i.pagination.totalItems>0))},dependencies:[k.Sq,k.bT,g.qT,g.me,g.Q0,g.BC,g.cb,g.YS,g.vS,g.cV,F.s5,Ce.kL,ni.m,Ye.b,rt.w,$e.p,qe.g,O.Mm,Y.XI,Te.Ei,Y.Tg,X.Cv,fe.vr,Se.m,Be.p,Zt._,k.vh,O.D9],encapsulation:2})}}return a})();var tn=x(56131);let Ks=(()=>{class a extends tn.E{constructor(t,s,i){super(t,s,i)}static{this.\u0275fac=function(s){return new(s||a)(e.KVO(A.Ix),e.KVO(jr),e.KVO(le.u))}}static{this.\u0275prov=e.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})();x(67376);let ea=(()=>{class a extends Qt.d{constructor(t){super(t,nt.c.apiUrl+"ClientCollection/")}static{this.\u0275fac=function(s){return new(s||a)(e.KVO(Ot.Qq))}}static{this.\u0275prov=e.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})();const zn=()=>["clientCollection.register"],md=()=>["clientCollection.edit"],pd=()=>["clientCollection.delete"];function kr(a,u){1&a&&(e.j41(0,"tr",28)(1,"th",29),e.EFF(2,"#"),e.k0s(),e.j41(3,"th",30),e.nrm(4,"i",31),e.EFF(5," sales.clientCollection.clientName "),e.k0s(),e.j41(6,"th",32),e.nrm(7,"i",31),e.EFF(8," sales.clientCollection.paymentTypeName "),e.k0s(),e.j41(9,"th",33),e.nrm(10,"i",31),e.EFF(11," orderManagement.order.creation "),e.k0s(),e.j41(12,"th",34),e.nrm(13,"i",31),e.EFF(14," sales.clientCollection.cost "),e.k0s(),e.j41(15,"th",35),e.nrm(16,"i",31),e.EFF(17," sales.clientCollection.depositNumber "),e.k0s(),e.j41(18,"th",36),e.nrm(19,"i",31),e.EFF(20," sales.clientCollection.isSyncOdoo "),e.k0s(),e.j41(21,"th",37),e.nrm(22,"i",31),e.EFF(23," sales.clientCollection.syncDate "),e.k0s(),e.j41(24,"th",38),e.nrm(25,"i",31),e.EFF(26," sales.clientCollection.notes "),e.k0s(),e.nrm(27,"th",39),e.k0s())}function ta(a,u){1&a&&e.nrm(0,"span",49)}function ud(a,u){1&a&&e.nrm(0,"span",50)}function gd(a,u){if(1&a&&(e.nrm(0,"i",51),e.EFF(1),e.nI1(2,"date"),e.nrm(3,"br")(4,"i",52),e.EFF(5),e.nI1(6,"date"),e.nrm(7,"br")(8,"i",53),e.EFF(9)),2&a){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",e.i5U(2,3,t.creationTime,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",e.i5U(6,6,t.lastModificationTime,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",t.creatorName," ")}}function hd(a,u){if(1&a){const t=e.RV6();e.j41(0,"button",54),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,l=e.XpG(),m=e.sdS(22);return e.Njj(l.EditModel(i.id,m))}),e.nrm(1,"i",55),e.k0s()}}function na(a,u){if(1&a){const t=e.RV6();e.j41(0,"button",56),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,l=e.XpG(),m=e.sdS(24);return e.Njj(l.openModal(i.id,m))}),e.nrm(1,"i",57),e.k0s()}}function Fr(a,u){if(1&a&&(e.j41(0,"tr",40)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td")(8,"span",41),e.EFF(9),e.k0s(),e.EFF(10),e.nI1(11,"date"),e.k0s(),e.j41(12,"td"),e.EFF(13),e.k0s(),e.j41(14,"td"),e.EFF(15),e.k0s(),e.j41(16,"td"),e.DNE(17,ta,1,0,"span",42)(18,ud,1,0,"span",43),e.k0s(),e.j41(19,"td"),e.EFF(20),e.nI1(21,"date"),e.k0s(),e.j41(22,"td"),e.EFF(23),e.k0s(),e.j41(24,"td"),e.DNE(25,gd,10,9,"ng-template",null,3,e.C5r),e.nrm(27,"i",44),e.j41(28,"button",45),e.nrm(29,"i",46),e.k0s(),e.DNE(30,hd,2,0,"button",47)(31,na,2,0,"button",48),e.k0s()()),2&a){const t=u.$implicit,s=u.rowIndex,i=e.sdS(26);e.R7$(2),e.JRh(s+1),e.R7$(2),e.JRh(t.clientName),e.R7$(2),e.JRh(t.paymentTypeName),e.R7$(3),e.SpI("",t.creatorName," "),e.R7$(),e.SpI(" ",e.i5U(11,14,t.creationTime,"yyyy-MM-dd")," "),e.R7$(3),e.JRh(t.cost),e.R7$(2),e.JRh(t.depositNumber),e.R7$(2),e.Y8G("ngIf",t.isSyncOdoo),e.R7$(),e.Y8G("ngIf",!t.isSyncOdoo),e.R7$(2),e.JRh(e.i5U(21,17,t.syncDate,"yyyy-MM-dd HH:mm:ss")),e.R7$(3),e.JRh(t.notes),e.R7$(4),e.Y8G("ngbTooltip",i),e.R7$(3),e.Y8G("hasPermission",e.lJ4(20,md)),e.R7$(),e.Y8G("hasPermission",e.lJ4(21,pd))}}function _d(a,u){1&a&&(e.j41(0,"div",58),e.EFF(1," general.table.noData"),e.k0s())}function Rr(a,u){if(1&a){const t=e.RV6();e.j41(0,"div",59)(1,"div",60),e.nrm(2,"ngb-pagination-info",61),e.j41(3,"table-length",62),e.bIt("lengthChange",function(i){e.eBV(t);const l=e.XpG();return e.Njj(l.ListItemChange(i))}),e.k0s()(),e.j41(4,"div",63)(5,"ngb-pagination",64),e.bIt("pageChange",function(i){e.eBV(t);const l=e.XpG();return e.Njj(l.pageChanged(i))}),e.mxI("pageChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.pagination.pageNumber,i)||(l.pagination.pageNumber=i),e.Njj(i)}),e.k0s()()()}if(2&a){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function ia(a,u){1&a&&(e.j41(0,"span",104),e.EFF(1,"general.action.register "),e.k0s())}function ra(a,u){1&a&&(e.j41(0,"span",104),e.EFF(1,"general.action.edit "),e.k0s())}function sa(a,u){if(1&a){const t=e.RV6();e.j41(0,"i",105),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.removeMainImage())}),e.k0s()}}function Fi(a,u){1&a&&(e.j41(0,"div",106),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function fd(a,u){1&a&&(e.j41(0,"div",106),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function aa(a,u){if(1&a){const t=e.RV6();e.j41(0,"div",65)(1,"div",66)(2,"h4",67),e.DNE(3,ia,2,0,"span",68)(4,ra,2,0,"span",68),e.j41(5,"span",69),e.EFF(6),e.k0s()(),e.j41(7,"button",70),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss("Cross click"))}),e.k0s()(),e.j41(8,"div",71),e.nrm(9,"ngx-ui-loader",72),e.j41(10,"form",73,4),e.bIt("submit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.OnSubmit())}),e.j41(12,"div",74)(13,"div",75)(14,"div",76)(15,"div",77)(16,"label",78),e.bIt("click",function(){e.eBV(t);const i=e.sdS(21);return e.Njj(i.click())}),e.j41(17,"div",79)(18,"div",80),e.nrm(19,"i",81),e.k0s()()(),e.j41(20,"input",82,5),e.bIt("change",function(i){e.eBV(t);const l=e.XpG();return e.Njj(l.onFileChangedMain(i))}),e.k0s()(),e.j41(22,"div",83)(23,"div",84),e.DNE(24,sa,1,0,"i",85),e.j41(25,"div",86),e.nrm(26,"img",87),e.k0s()()()()()(),e.j41(27,"div",74)(28,"label",88),e.EFF(29,"sales.clientCollection.clientName"),e.k0s(),e.j41(30,"ng-select",89),e.bIt("scrollToEnd",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.scrollClient())}),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.form.clientId,i)||(l.form.clientId=i),e.Njj(i)}),e.k0s()(),e.j41(31,"div",74)(32,"label",90),e.EFF(33,"sales.salesInvoices.paymentTypeName"),e.k0s(),e.j41(34,"ng-select",91,6),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.form.paymentTypeId,i)||(l.form.paymentTypeId=i),e.Njj(i)}),e.k0s(),e.DNE(36,Fi,2,0,"div",92),e.k0s(),e.j41(37,"div",93)(38,"label",94),e.EFF(39,"sales.clientCollection.cost"),e.k0s(),e.j41(40,"input",95,7),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.form.cost,i)||(l.form.cost=i),e.Njj(i)}),e.k0s(),e.DNE(42,fd,2,0,"div",96),e.k0s(),e.j41(43,"div",93)(44,"label",97),e.EFF(45,"sales.clientCollection.depositNumber"),e.k0s(),e.j41(46,"input",98,8),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.form.depositNumber,i)||(l.form.depositNumber=i),e.Njj(i)}),e.k0s()(),e.j41(48,"div",93)(49,"label",99),e.EFF(50,"sales.clientCollection.notes"),e.k0s(),e.j41(51,"textarea",100,9),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.form.notes,i)||(l.form.notes=i),e.Njj(i)}),e.k0s()(),e.j41(53,"div",75)(54,"button",101),e.nrm(55,"i",102)(56,"span",103),e.k0s()()()()()}if(2&a){const t=e.sdS(11),s=e.sdS(35),i=e.sdS(41),l=e.XpG();e.R7$(3),e.Y8G("ngIf",!l.isEditForm),e.R7$(),e.Y8G("ngIf",l.isEditForm),e.R7$(2),e.JRh(l.titleOperation),e.R7$(3),e.Y8G("hasProgressBar",!1)("fgsType",l.loaderOperationShap)("loaderId",l.operationLoader),e.R7$(15),e.Y8G("ngIf",l.image.path),e.R7$(2),e.Y8G("src",l.image.isApi?l.serverPath+l.image.path:l.image.path,e.B4B),e.R7$(4),e.Y8G("virtualScroll",!0)("items",l.clients)("typeahead",l.searchClient)("loading",l.loading)("multiple",!1),e.R50("ngModel",l.form.clientId),e.R7$(4),e.Y8G("items",l.paymentMethods)("multiple",!1),e.R50("ngModel",l.form.paymentTypeId),e.R7$(2),e.Y8G("ngIf",s.invalid&&s.touched),e.R7$(4),e.R50("ngModel",l.form.cost),e.R7$(2),e.Y8G("ngIf",i.invalid&&i.touched),e.R7$(4),e.R50("ngModel",l.form.depositNumber),e.R7$(5),e.R50("ngModel",l.form.notes),e.R7$(3),e.Y8G("disabled",!t.valid)}}function oa(a,u){if(1&a){const t=e.RV6();e.j41(0,"delete-modal",107),e.bIt("deleteConfirm",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.DeleteConfirmSoft())})("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}}let bd=(()=>{class a extends De.w{constructor(t,s,i,l,m,c,E,P,q,D,J,ee){super(t,s,E,i,l,m,c),this.baseService=i,this.excelService=q,this.clientService=D,this.paymentTypesService=J,this._formDataService=ee,this.title="sales.clientCollection.title",this.titleOperation="sales.clientCollection.titleOperation",this.keySelected="",this.assignUsers=[],this.times=[],this.employees=[],this.searchForm={},this.isResolveList=!0,this.countLoad=2,this.clientParam={pageSize:50,pageNumber:1,search:"",clientId:null},this.clients=[],this.loading=!1,this.searchClient=new ut.B,this.paymentMethods=[],this.image={},this.serverPath=nt.c.mediaUrl,this.setDates=(W,Q,V)=>{if(W?.from||W?.to){const ge=W.to||W.from;this.pagination[Q]=this.datePipe.transform(W.from||W.to,"yyyy-MM-ddT00:00:00"),this.pagination[V]=this.datePipe.transform(ge,"yyyy-MM-ddT23:59:59.999")}else this.pagination[Q]=null,this.pagination[V]=null},this.configRoute()}ngOnInitMore(){this.searchClient.pipe((0,ze.B)(300),(0,Kn.F)(),(0,zt.n)(t=>this.loadClient(t))).subscribe(),this.getPaymentTypes()}getPaymentTypes(){this.paymentTypesService.getDropDown().subscribe({next:t=>{this.paymentMethods=t.data}})}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader("allLoader"),this.setDates(t.creationDates,"dateFrom","dateTo"),this.loadentities()}loadClient(t){return this.loading=!0,""==t||null==t?(this.loading=!1,(0,Zn.of)([])):this.getClientDropdwon(t)}getClientDropdwon(t=""){return this.clientParam.search=t,this.clientParam.clientId=null,this.clientParam.pageNumber=1,this.clientService.GetClientSearch(this.clientParam).pipe((0,zt.n)(s=>(this.clients=s.data,this.loading=!1,[])))}mapForm(t){let s={...t};return this._formDataService.formatFormData(s)}mapRegisterForm(t){let s={...t};return s.id=0,this._formDataService.formatFormData(s)}OnSearch(t){this.ngxLoader.startLoader(N.a7),this.loadentities()}configRoute(){}EditModel(t,s,i="md"){this.isEditForm=!0,this.image={},this.baseService.getById(t).pipe((0,R.Q)(this.notifier)).subscribe(l=>{l.success?(this.clientParam.clientId=l.data.clientId,this.clientParam.search="",this.clientService.GetClientSearch(this.clientParam).subscribe(m=>{this.clients=m.data}),this.image.path=l.data.path,this.image.isApi=!0,this.form=l.data):this.alertService.error("general.message."+l.message),this.modalService.open(s,{centered:!0,size:i})},l=>{this.alertService.error()})}mapExcel(){let t=[];return this.entities?.forEach(s=>{t.push({nameAr:s.nameAr,nameEn:s.nameEn,isActive:this.getTranslationText("general.table.active"),notes:s.notes})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.getTranslationText(this.title),[])}editEntity(){let t=this.mapForm(this.form);this.baseService.editPut(this.form.id,t).pipe((0,me.O)(),(0,se.c)(this.mainDelay),(0,pe.Z)(),(0,R.Q)(this.notifier),(0,ie.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(s=>{s.success?this.submitFunished():this.alertService.error("general.message."+s.message)},s=>{this.alertService.error("general.message."+s)})}scrollClient(){this.clientParam.pageNumber=this.clientParam.pageNumber+1,this.clientService.GetClientSearch(this.clientParam).subscribe(t=>{this.clients=[...this.clients,...t.data]})}onFileChangedMain(t){if(t.target.files&&t.target.files[0]){let s=t.target.files.length;for(let i=0;i<s;i++){let l=new FileReader;this.form.image=t.target.files.item(i),l.onload=m=>{this.image={isApi:!1,path:m.target.result}},l.readAsDataURL(t.target.files[i]),console.log(this.image)}}}removeMainImage(){this.form.image="",this.image={isApi:!1,path:""}}static{this.\u0275fac=function(s){return new(s||a)(e.rXU(A.nX),e.rXU(O.c$),e.rXU(ea),e.rXU(le.u),e.rXU(k.vh),e.rXU(X.eD),e.rXU(F.Bq),e.rXU(e.gRc),e.rXU(He.V),e.rXU(it.X),e.rXU(Tt),e.rXU(qn.Q))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["app-clientCollection"]],features:[e.Vt3],decls:25,vars:20,consts:[["tableMaster",""],["operation",""],["deleteModal",""],["tooltipContent",""],["formEntity","ngForm"],["FileInputMain",""],["paymentTypeId","ngModel"],["cost","ngModel"],["depositNumber","ngModel"],["notes","ngModel"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],[3,"reset","search","exportXlsx","addNew","addPermission","totalItems","title"],["control",""],[1,"col-md-4","mb-2"],[1,"search-box"],["type","search","id","name","name","name",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],[1,"col-12","col-md-3","mb-2"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["translate","",2,"width",".5%"],["pSortableColumn","clientId","translate","",2,"width","10%"],[1,"ri-expand-up-down-line"],["pSortableColumn","paymentTypeName","translate","",2,"width","8%"],["pSortableColumn","creationTime","translate","",2,"width","12%"],["pSortableColumn","cost","translate","",2,"width","5%"],["pSortableColumn","depositNumber","translate","",2,"width","8%"],["pSortableColumn","isSyncOdoo","translate","",2,"width","6%"],["pSortableColumn","syncDate","translate","",2,"width","8%"],["pSortableColumn","notes","translate","",2,"width","8%"],["translate","",2,"width","12%"],[1,"fs-5"],[1,"badge","bg-success-subtle","text-success"],["class","badge bg-success","translate","sales.salesOrder.syncSend",4,"ngIf"],["class","badge bg-warning","translate","sales.salesOrder.syncNotSend",4,"ngIf"],["tooltipPosition","top",1,"mdi","mdi-cog-outline","text-muted","fs-16","align-middle","me-1",3,"ngbTooltip"],[1,"btn","btn-sm","btn-soft-warning","edit-list","mx-2"],[1,"ri-refresh-fill","align-bottom","mx-1"],["class","btn btn-sm btn-soft-info edit-list mx-2",3,"click",4,"hasPermission"],["class","btn btn-sm btn-soft-danger remove-list",3,"click",4,"hasPermission"],["translate","sales.salesOrder.syncSend",1,"badge","bg-success"],["translate","sales.salesOrder.syncNotSend",1,"badge","bg-warning"],[1,"ri-history-fill","text-warning"],[1,"ri-history-fill","text-danger"],[1,"ri-user-location-fill","text-primary"],[1,"btn","btn-sm","btn-soft-info","edit-list","mx-2",3,"click"],[1,"ri-pencil-fill","align-bottom","mx-1"],[1,"btn","btn-sm","btn-soft-danger","remove-list",3,"click"],[1,"ri-delete-bin-5-fill","align-bottom"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["class","fw-bold fs-4","translate","",4,"ngIf"],["translate",""],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"hasProgressBar","fgsType","loaderId"],[3,"submit"],[1,"mb-3"],[1,"text-center"],[1,"position-relative","d-inline-block"],[1,"position-absolute","top-100","start-100","translate-middle"],["placement","right","ngbTooltip","Select Image",1,"mb-0",3,"click"],[1,"avatar-xs"],[1,"avatar-title","bg-light","border","rounded-circle","text-muted","cursor-pointer"],[1,"ri-image-fill"],["value","","type","file","accept","image/png, image/gif, image/jpeg",1,"form-control","d-none",3,"change"],[1,"d-flex"],[1,"avatar-lg","mx-2","position-relative"],["class","position-absolute bx bx-x-circle text-white","style","background: red; top: 1px; right: -4px; font-size: 1rem;\n                                                        border-radius: 50% ",3,"click",4,"ngIf"],[1,"avatar-title","bg-light","rounded"],["id","product-img2","alt","",1,"avatar-md","h-auto",3,"src"],["for","nameAr","translate","",1,"required","fw-bold","form-label"],["bindLabel","displayName","bindValue","id","name","clientId","required","",3,"scrollToEnd","ngModelChange","virtualScroll","items","typeahead","loading","multiple","ngModel"],["translate","",1,"required","fw-bold","form-label","w-100"],["name","paymentTypeId","bindValue","code","bindLabel","name","required","",3,"ngModelChange","items","multiple","ngModel"],["class","text-danger text-center","translate","",4,"ngIf"],[1,"mb-2"],["for","cost","translate","",1,"fw-bold","form-label"],["InputTirmFilter","","name","cost","type","text","id","cost",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["class","text-danger text-center  ","translate","",4,"ngIf"],["for","depositNumber","translate","",1,"fw-bold","form-label"],["InputTirmFilter","","name","depositNumber","type","text","id","depositNumber",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["for","notes","translate","",1,"fw-bold","form-label"],["rows","2","InputTirmFilter","","name","notes","type","text","id","notes",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["type","submit","type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],["translate","",1,"fw-bold","fs-4"],[1,"position-absolute","bx","bx-x-circle","text-white",2,"background","red","top","1px","right","-4px","font-size","1rem","border-radius","50%",3,"click"],["translate","",1,"text-danger","text-center"],[3,"deleteConfirm","dismiss"]],template:function(s,i){if(1&s){const l=e.RV6();e.j41(0,"div",10)(1,"div",11)(2,"div",12)(3,"base-filter",13),e.bIt("reset",function(){return e.eBV(l),e.Njj(i.onReset())})("search",function(){return e.eBV(l),e.Njj(i.onSearch())})("exportXlsx",function(){return e.eBV(l),e.Njj(i.onExportXlsx())})("addNew",function(){e.eBV(l);const c=e.sdS(22);return e.Njj(i.openModalTitle(c,"md"))}),e.qex(4,14),e.j41(5,"div",15)(6,"div",16)(7,"input",17),e.nI1(8,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.name,c)||(i.pagination.name=c),e.Njj(c)}),e.k0s(),e.nrm(9,"i",18),e.k0s()(),e.j41(10,"div",19)(11,"input",20),e.nI1(12,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.searchForm.creationDates,c)||(i.searchForm.creationDates=c),e.Njj(c)}),e.k0s()(),e.bVm(),e.k0s(),e.j41(13,"div",21)(14,"div",22)(15,"p-table",23,0),e.bIt("onLazyLoad",function(c){return e.eBV(l),e.Njj(i.tableChange(c))})("selectionChange",function(c){return e.eBV(l),e.Njj(i.onSelectionChange(c))}),e.DNE(17,kr,28,0,"ng-template",24)(18,Fr,32,22,"ng-template",25),e.k0s()(),e.DNE(19,_d,2,0,"div",26)(20,Rr,6,8,"div",27),e.k0s()()()(),e.DNE(21,aa,57,23,"ng-template",null,1,e.C5r)(23,oa,1,0,"ng-template",null,2,e.C5r)}2&s&&(e.R7$(3),e.Y8G("addPermission",e.lJ4(19,zn))("totalItems",i.pagination.totalItems)("title",i.title),e.R7$(4),e.FS9("placeholder",e.bMT(8,15,"general.table.name")),e.R50("ngModel",i.pagination.name),e.R7$(4),e.FS9("placeholder",e.bMT(12,17,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",i.searchForm.creationDates),e.R7$(4),e.Y8G("value",i.entities)("rows",i.pagination.pageSize)("lazy",!0)("totalRecords",i.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",i.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",i.pagination.totalItems>0))},dependencies:[k.bT,g.qT,g.me,g.BC,g.cb,g.YS,g.vS,g.cV,F.s5,Ce.kL,Ye.b,rt.w,$e.p,qe.g,O.Mm,Y.XI,Te.Ei,Y.Tg,X.Cv,fe.vr,F.md,Se.m,Be.p,k.vh,O.D9],encapsulation:2})}}return a})();const la=()=>["requestPersonSales.register"],vd=()=>["requestPersonSales.changeStatus"],Mr=()=>["requestPersonSales.edit"],da=()=>["requestPersonSales.delete"];function Or(a,u){1&a&&(e.j41(0,"tr",45)(1,"th",46),e.EFF(2,"#"),e.k0s(),e.j41(3,"th",47),e.nrm(4,"i",48),e.EFF(5," sales.clientCollection.clientName "),e.k0s(),e.j41(6,"th",49),e.nrm(7,"i",48),e.EFF(8," orderManagement.order.creation "),e.k0s(),e.j41(9,"th",50),e.nrm(10,"i",48),e.EFF(11," sales.clientCollection.cost "),e.k0s(),e.j41(12,"th",51),e.nrm(13,"i",48),e.EFF(14," sales.requestPersonSales.requestPersonStatus "),e.k0s(),e.j41(15,"th",52),e.nrm(16,"i",48),e.EFF(17," sales.clientCollection.notes "),e.k0s(),e.nrm(18,"th",53),e.k0s())}function Cd(a,u){if(1&a&&(e.nrm(0,"i",61),e.EFF(1),e.nI1(2,"date"),e.nrm(3,"br")(4,"i",62),e.EFF(5),e.nI1(6,"date"),e.nrm(7,"br")(8,"i",63),e.EFF(9)),2&a){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",e.i5U(2,3,t.creationTime,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",e.i5U(6,6,t.lastModificationTime,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",t.creatorName," ")}}function wr(a,u){if(1&a){const t=e.RV6();e.j41(0,"button",64),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,l=e.XpG(),m=e.sdS(89);return e.Njj(l.openModal(i.id,m))}),e.nrm(1,"i",65),e.k0s()}}function K(a,u){if(1&a){const t=e.RV6();e.j41(0,"button",66),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,l=e.XpG(),m=e.sdS(85);return e.Njj(l.EditModel(i.id,m))}),e.nrm(1,"i",67),e.k0s()}}function Sd(a,u){if(1&a){const t=e.RV6();e.j41(0,"button",68),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,l=e.XpG(),m=e.sdS(87);return e.Njj(l.openModal(i.id,m))}),e.nrm(1,"i",69),e.k0s()}}function jd(a,u){if(1&a&&(e.j41(0,"tr",54)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td")(6,"span",55),e.EFF(7),e.k0s(),e.EFF(8),e.nI1(9,"date"),e.k0s(),e.j41(10,"td"),e.EFF(11),e.k0s(),e.j41(12,"td")(13,"span"),e.nrm(14,"span",56),e.k0s()(),e.j41(15,"td"),e.EFF(16),e.k0s(),e.j41(17,"td"),e.DNE(18,Cd,10,9,"ng-template",null,4,e.C5r),e.nrm(20,"i",57),e.DNE(21,wr,2,0,"button",58)(22,K,2,0,"button",59)(23,Sd,2,0,"button",60),e.k0s()()),2&a){const t=u.$implicit,s=u.rowIndex,i=e.sdS(19),l=e.XpG();e.R7$(2),e.JRh(s+1),e.R7$(2),e.JRh(t.clientName),e.R7$(3),e.SpI("",t.creatorName," "),e.R7$(),e.SpI(" ",e.i5U(9,14,t.creationTime,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(3),e.JRh(t.cost),e.R7$(2),e.ZvI("badge ",l.getStatus(t.requestPersonStatus),""),e.R7$(),e.FS9("translate","sales.salesOrder."+t.requestPersonStatusName),e.R7$(2),e.JRh(t.notes),e.R7$(4),e.Y8G("ngbTooltip",i),e.R7$(),e.Y8G("hasPermission",e.lJ4(17,vd)),e.R7$(),e.Y8G("hasPermission",e.lJ4(18,Mr)),e.R7$(),e.Y8G("hasPermission",e.lJ4(19,da))}}function Hn(a,u){1&a&&(e.j41(0,"div",70),e.EFF(1," general.table.noData"),e.k0s())}function ca(a,u){if(1&a){const t=e.RV6();e.j41(0,"div",71)(1,"div",72),e.nrm(2,"ngb-pagination-info",73),e.j41(3,"table-length",74),e.bIt("lengthChange",function(i){e.eBV(t);const l=e.XpG();return e.Njj(l.ListItemChange(i))}),e.k0s()(),e.j41(4,"div",75)(5,"ngb-pagination",76),e.bIt("pageChange",function(i){e.eBV(t);const l=e.XpG();return e.Njj(l.pageChanged(i))}),e.mxI("pageChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.pagination.pageNumber,i)||(l.pagination.pageNumber=i),e.Njj(i)}),e.k0s()()()}if(2&a){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function yd(a,u){1&a&&(e.j41(0,"span",99),e.EFF(1,"general.action.register "),e.k0s())}function Id(a,u){1&a&&(e.j41(0,"span",99),e.EFF(1,"general.action.edit "),e.k0s())}function dt(a,u){1&a&&(e.j41(0,"div",100),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function Td(a,u){if(1&a){const t=e.RV6();e.j41(0,"div",77)(1,"div",78)(2,"h4",79),e.DNE(3,yd,2,0,"span",80)(4,Id,2,0,"span",80),e.j41(5,"span",81),e.EFF(6),e.k0s()(),e.j41(7,"button",82),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss("Cross click"))}),e.k0s()(),e.j41(8,"div",83),e.nrm(9,"ngx-ui-loader",84),e.j41(10,"form",85,5),e.bIt("submit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.OnSubmit())}),e.j41(12,"div",86)(13,"label",87),e.EFF(14,"sales.clientCollection.clientName"),e.k0s(),e.j41(15,"ng-select",88),e.bIt("scrollToEnd",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.scrollClient())}),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.form.clientId,i)||(l.form.clientId=i),e.Njj(i)}),e.k0s()(),e.j41(16,"div",89)(17,"label",90),e.EFF(18,"sales.clientCollection.cost"),e.k0s(),e.j41(19,"input",91,6),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.form.cost,i)||(l.form.cost=i),e.Njj(i)}),e.k0s(),e.DNE(21,dt,2,0,"div",92),e.k0s(),e.j41(22,"div",89)(23,"label",93),e.EFF(24,"sales.clientCollection.notes"),e.k0s(),e.j41(25,"textarea",94,7),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.form.notes,i)||(l.form.notes=i),e.Njj(i)}),e.k0s()(),e.j41(27,"div",95)(28,"button",96),e.nrm(29,"i",97)(30,"span",98),e.k0s()()()()()}if(2&a){const t=e.sdS(11),s=e.sdS(20),i=e.XpG();e.R7$(3),e.Y8G("ngIf",!i.isEditForm),e.R7$(),e.Y8G("ngIf",i.isEditForm),e.R7$(2),e.JRh(i.titleOperation),e.R7$(3),e.Y8G("hasProgressBar",!1)("fgsType",i.loaderOperationShap)("loaderId",i.operationLoader),e.R7$(6),e.Y8G("virtualScroll",!0)("items",i.clients)("typeahead",i.searchClient)("loading",i.loading)("multiple",!1),e.R50("ngModel",i.form.clientId),e.R7$(4),e.R50("ngModel",i.form.cost),e.R7$(2),e.Y8G("ngIf",s.invalid&&s.touched),e.R7$(4),e.R50("ngModel",i.form.notes),e.R7$(3),e.Y8G("disabled",!t.valid)}}function Ri(a,u){if(1&a){const t=e.RV6();e.j41(0,"delete-modal",101),e.bIt("deleteConfirm",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.DeleteConfirmSoft())})("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}}function Nr(a,u){if(1&a){const t=e.RV6();e.j41(0,"div",86)(1,"label",106),e.EFF(2,"sales.clientCollection.cost"),e.k0s(),e.j41(3,"input",107),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG(2);return e.DH7(l.form.cost,i)||(l.form.cost=i),e.Njj(i)}),e.k0s()()}if(2&a){const t=e.XpG(2);e.R7$(3),e.R50("ngModel",t.form.cost)}}function ma(a,u){if(1&a){const t=e.RV6();e.j41(0,"div",77)(1,"div",78)(2,"h4",79)(3,"span",81),e.EFF(4),e.k0s()(),e.j41(5,"button",82),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss("Cross click"))}),e.k0s()(),e.j41(6,"div",83),e.nrm(7,"ngx-ui-loader",84),e.j41(8,"form",85,5),e.bIt("submit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.OnStatusSubmit())}),e.j41(10,"div",28)(11,"div",86)(12,"label",102),e.EFF(13,"sales.requestPersonSales.requestPersonStatus"),e.k0s(),e.j41(14,"ng-select",103),e.nI1(15,"translate"),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.form.requestPersonStatus,i)||(l.form.requestPersonStatus=i),e.Njj(i)}),e.k0s()(),e.DNE(16,Nr,4,1,"div",104),e.k0s(),e.j41(17,"div",95)(18,"button",105),e.nrm(19,"i",97)(20,"span",98),e.k0s()()()()()}if(2&a){const t=e.sdS(9),s=e.XpG();e.R7$(4),e.JRh(s.titleOperation),e.R7$(3),e.Y8G("hasProgressBar",!1)("fgsType",s.loaderOperationShap)("loaderId",s.operationLoader),e.R7$(7),e.FS9("placeholder",e.bMT(15,10,"sales.requestPersonSales.requestPersonStatus")),e.Y8G("items",s.status)("multiple",!1),e.R50("ngModel",s.form.requestPersonStatus),e.R7$(2),e.Y8G("ngIf",30==s.form.requestPersonStatus),e.R7$(2),e.Y8G("disabled",!t.valid)}}let pa=(()=>{class a extends De.w{constructor(t,s,i,l,m,c,E,P,q,D){super(t,s,E,i,l,m,c),this.baseService=i,this.excelService=q,this.clientService=D,this.title="sales.requestPersonSales.title",this.titleOperation="sales.requestPersonSales.titleOperation",this.searchForm={},this.isResolveList=!0,this.countLoad=2,this.clientParam={pageSize:50,pageNumber:1,search:"",clientId:null},this.clients=[],this.loading=!1,this.searchClient=new ut.B,this.status=[],this.requestStatus={all:0,pending:0,underReview:0,accept:0,reject:0},this.option={startVal:0,useEasing:!0,duration:2,decimalPlaces:0},this.setDates=(J,ee,W)=>{if(J?.from||J?.to){const V=J.to||J.from;this.pagination[ee]=this.datePipe.transform(J.from||J.to,"yyyy-MM-ddT00:00:00"),this.pagination[W]=this.datePipe.transform(V,"yyyy-MM-ddT23:59:59.999")}else this.pagination[ee]=null,this.pagination[W]=null},this.configRoute()}ngOnInitMore(){this.searchClient.pipe((0,ze.B)(300),(0,Kn.F)(),(0,zt.n)(t=>this.loadClient(t))).subscribe(),this.GetRequestLookups()}GetRequestLookups(){this.baseService.GetRequestLookups().subscribe(t=>{let s=t.data.status;s.forEach(i=>{i.name=this.getTranslationText("sales.salesOrder."+i.name)}),this.status=s})}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader("allLoader"),this.setDates(t.creationDates,"dateFrom","dateTo"),this.loadentities()}loadClient(t){return this.loading=!0,""==t||null==t?(this.loading=!1,(0,Zn.of)([])):this.getClientDropdwon(t)}getClientDropdwon(t=""){return this.clientParam.search=t,this.clientParam.clientId=null,this.clientParam.pageNumber=1,this.clientService.GetClientSearch(this.clientParam).pipe((0,zt.n)(s=>(this.clients=s.data,this.loading=!1,[])))}mapForm(t){return{...t}}mapRegisterForm(t){let s={...t};return s.id=0,s}OnSearch(t){this.ngxLoader.startLoader(N.a7),this.loadentities()}configRoute(){}EditModel(t,s,i="md"){this.isEditForm=!0,this.baseService.getById(t).pipe((0,R.Q)(this.notifier)).subscribe(l=>{l.success?(this.clientParam.clientId=l.data.clientId,this.clientParam.search="",this.clientService.GetClientSearch(this.clientParam).subscribe(m=>{this.clients=m.data}),this.form=l.data):this.alertService.error("general.message."+l.message),this.modalService.open(s,{centered:!0,size:i})},l=>{this.alertService.error()})}mapExcel(){let t=[];return this.entities?.forEach(s=>{t.push({nameAr:s.nameAr,nameEn:s.nameEn,isActive:this.getTranslationText("general.table.active"),notes:s.notes})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.getTranslationText(this.title),[])}editEntity(){let t=this.mapForm(this.form);this.baseService.editPut(t.id,t).pipe((0,me.O)(),(0,se.c)(this.mainDelay),(0,pe.Z)(),(0,R.Q)(this.notifier),(0,ie.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(s=>{s.success?this.submitFunished():this.alertService.error("general.message."+s.message)},s=>{this.alertService.error("general.message."+s)})}scrollClient(){this.clientParam.pageNumber=this.clientParam.pageNumber+1,this.clientService.GetClientSearch(this.clientParam).subscribe(t=>{this.clients=[...this.clients,...t.data]})}getStatus(t){return 10==t||20==t?"bg-warning-subtle text-warning":30==t?"bg-success-subtle text-success":40==t?"bg-danger-subtle text-danger":"bg-warning-subtle text-warning"}OnStatusSubmit(){let t={requestPersonStatus:this.form.requestPersonStatus,id:this.operationId,cost:this.form.cost?this.form.cost:0};this.ngxLoader.start(this.operationLoader),this.baseService.UpdateLimit(t).pipe((0,me.O)(),(0,se.c)(this.mainDelay),(0,pe.Z)(),(0,R.Q)(this.notifier),(0,ie.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(s=>{s.success?(this.alertService.success(),this.modalService.dismissAll(),this.loadentities()):this.alertService.error("general.message."+s.message)},s=>{this.alertService.error("general.message."+s)})}onStatusSelect(t){this.pagination.requestPersonStatus=t,this.loadentities()}static{this.\u0275fac=function(s){return new(s||a)(e.rXU(A.nX),e.rXU(O.c$),e.rXU(Ui),e.rXU(le.u),e.rXU(k.vh),e.rXU(X.eD),e.rXU(F.Bq),e.rXU(e.gRc),e.rXU(He.V),e.rXU(it.X))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["app-requestPersonSales"]],features:[e.Vt3],decls:90,vars:34,consts:[["tableMaster",""],["operation",""],["deleteModal",""],["operationStatus",""],["tooltipContent",""],["formEntity","ngForm"],["cost","ngModel"],["notes","ngModel"],[3,"title","breadcrumbItems"],[1,"row","justify-content-around"],[1,"col-12","col-md-3","cursor-pointer"],[1,"card","card-animate",3,"click"],[1,"card-body"],[1,"d-flex","justify-content-between"],["translate","sales.salesOrder.all",1,"fw-medium","text-muted","mb-0"],[1,"mt-4","ff-secondary","fw-semibold"],[1,"counter-value",3,"countUp","options"],[1,"avatar-sm","flex-shrink-0"],[1,"avatar-title","bg-primary-subtle","text-primary","rounded-circle","fs-4"],[1,"ri-ticket-2-line"],[1,"col-12","col-md-2","cursor-pointer"],["translate","sales.salesOrder.Pending",1,"fw-medium","text-muted","mb-0"],[1,"avatar-title","bg-warning-subtle","text-warning","rounded-circle","fs-4"],["translate","sales.salesOrder.UnderReview",1,"fw-medium","text-muted","mb-0"],["translate","sales.salesOrder.Accept",1,"fw-medium","text-muted","mb-0"],[1,"avatar-title","bg-success-subtle","text-success","rounded-circle","fs-4"],["translate","sales.salesOrder.Reject",1,"fw-medium","text-muted","mb-0"],[1,"avatar-title","bg-danger-subtle","text-danger","rounded-circle","fs-4"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],[3,"reset","search","exportXlsx","addNew","addPermission","totalItems","title"],["control",""],[1,"col-md-4","mb-2"],[1,"search-box"],["type","search","id","name","name","name",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],[1,"col-12","col-md-3","mb-2"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["translate","",2,"width",".5%"],["pSortableColumn","clientId","translate","",2,"width","15%"],[1,"ri-expand-up-down-line"],["pSortableColumn","creationTime","translate","",2,"width","12%"],["pSortableColumn","cost","translate","",2,"width","5%"],["pSortableColumn","requestPersonStatus","translate","",2,"width","8%"],["pSortableColumn","notes","translate","",2,"width","10%"],["translate","",2,"width","15%"],[1,"fs-5"],[1,"badge","bg-success-subtle","text-success"],[3,"translate"],["tooltipPosition","top",1,"mdi","mdi-cog-outline","text-muted","fs-16","align-middle","me-1",3,"ngbTooltip"],["class","btn btn-sm btn-soft-warning edit-list mx-2 ",3,"click",4,"hasPermission"],["class","btn btn-sm btn-soft-info edit-list mx-2",3,"click",4,"hasPermission"],["class","btn btn-sm btn-soft-danger remove-list",3,"click",4,"hasPermission"],[1,"ri-history-fill","text-warning"],[1,"ri-history-fill","text-danger"],[1,"ri-user-location-fill","text-primary"],[1,"btn","btn-sm","btn-soft-warning","edit-list","mx-2",3,"click"],[1,"ri-exchange-line","align-bottom","mx-1"],[1,"btn","btn-sm","btn-soft-info","edit-list","mx-2",3,"click"],[1,"ri-pencil-fill","align-bottom","mx-1"],[1,"btn","btn-sm","btn-soft-danger","remove-list",3,"click"],[1,"ri-delete-bin-5-fill","align-bottom"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["class","fw-bold fs-4","translate","",4,"ngIf"],["translate",""],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"hasProgressBar","fgsType","loaderId"],[3,"submit"],[1,"mb-3"],["for","nameAr","translate","",1,"required","fw-bold","form-label"],["bindLabel","displayName","bindValue","id","name","clientId","required","",3,"scrollToEnd","ngModelChange","virtualScroll","items","typeahead","loading","multiple","ngModel"],[1,"mb-2"],["for","cost","translate","",1,"fw-bold","form-label"],["InputTirmFilter","","name","cost","type","text","id","cost",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["class","text-danger text-center  ","translate","",4,"ngIf"],["for","notes","translate","",1,"fw-bold","form-label"],["rows","2","InputTirmFilter","","name","notes","type","text","id","notes",1,"form-control","fs-6",3,"ngModelChange","ngModel"],[1,"text-center"],["type","submit","type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],["translate","",1,"fw-bold","fs-4"],["translate","",1,"text-danger","text-center"],[3,"deleteConfirm","dismiss"],["for","status","translate","",1,"required","fw-bold","form-label"],["name","name","bindValue","id","bindLabel","name","required","",3,"ngModelChange","placeholder","items","multiple","ngModel"],["class","mb-3",4,"ngIf"],["type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],["for","cost","translate","",1,"required","fw-bold","form-label"],["type","numbers","id","cost","name","cost",1,"form-control",3,"ngModelChange","ngModel"]],template:function(s,i){if(1&s){const l=e.RV6();e.nrm(0,"app-breadcrumbs",8),e.nI1(1,"translate"),e.j41(2,"div",9)(3,"div",10)(4,"div",11),e.bIt("click",function(){return e.eBV(l),e.Njj(i.onStatusSelect(0))}),e.j41(5,"div",12)(6,"div",13)(7,"div"),e.nrm(8,"p",14),e.j41(9,"h2",15),e.nrm(10,"span",16),e.k0s()(),e.j41(11,"div")(12,"div",17)(13,"span",18),e.nrm(14,"i",19),e.k0s()()()()()()(),e.j41(15,"div",20)(16,"div",11),e.bIt("click",function(){return e.eBV(l),e.Njj(i.onStatusSelect(10))}),e.j41(17,"div",12)(18,"div",13)(19,"div"),e.nrm(20,"p",21),e.j41(21,"h2",15),e.nrm(22,"span",16),e.k0s()(),e.j41(23,"div")(24,"div",17)(25,"span",22),e.nrm(26,"i",19),e.k0s()()()()()()(),e.j41(27,"div",20)(28,"div",11),e.bIt("click",function(){return e.eBV(l),e.Njj(i.onStatusSelect(20))}),e.j41(29,"div",12)(30,"div",13)(31,"div"),e.nrm(32,"p",23),e.j41(33,"h2",15),e.nrm(34,"span",16),e.k0s()(),e.j41(35,"div")(36,"div",17)(37,"span",22),e.nrm(38,"i",19),e.k0s()()()()()()(),e.j41(39,"div",20)(40,"div",11),e.bIt("click",function(){return e.eBV(l),e.Njj(i.onStatusSelect(30))}),e.j41(41,"div",12)(42,"div",13)(43,"div"),e.nrm(44,"p",24),e.j41(45,"h2",15),e.nrm(46,"span",16),e.k0s()(),e.j41(47,"div")(48,"div",17)(49,"span",25),e.nrm(50,"i",19),e.k0s()()()()()()(),e.j41(51,"div",20)(52,"div",11),e.bIt("click",function(){return e.eBV(l),e.Njj(i.onStatusSelect(40))}),e.j41(53,"div",12)(54,"div",13)(55,"div"),e.nrm(56,"p",26),e.j41(57,"h2",15),e.nrm(58,"span",16),e.k0s()(),e.j41(59,"div")(60,"div",17)(61,"span",27),e.nrm(62,"i",19),e.k0s()()()()()()()(),e.j41(63,"div",28)(64,"div",29)(65,"div",30)(66,"base-filter",31),e.bIt("reset",function(){return e.eBV(l),e.Njj(i.onReset())})("search",function(){return e.eBV(l),e.Njj(i.onSearch())})("exportXlsx",function(){return e.eBV(l),e.Njj(i.onExportXlsx())})("addNew",function(){e.eBV(l);const c=e.sdS(85);return e.Njj(i.openModalTitle(c,"md"))}),e.qex(67,32),e.j41(68,"div",33)(69,"div",34)(70,"input",35),e.nI1(71,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.name,c)||(i.pagination.name=c),e.Njj(c)}),e.k0s(),e.nrm(72,"i",36),e.k0s()(),e.j41(73,"div",37)(74,"input",38),e.nI1(75,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.searchForm.creationDates,c)||(i.searchForm.creationDates=c),e.Njj(c)}),e.k0s()(),e.bVm(),e.k0s(),e.j41(76,"div",12)(77,"div",39)(78,"p-table",40,0),e.bIt("onLazyLoad",function(c){return e.eBV(l),e.Njj(i.tableChange(c))})("selectionChange",function(c){return e.eBV(l),e.Njj(i.onSelectionChange(c))}),e.DNE(80,Or,19,0,"ng-template",41)(81,jd,24,20,"ng-template",42),e.k0s()(),e.DNE(82,Hn,2,0,"div",43)(83,ca,6,8,"div",44),e.k0s()()()(),e.DNE(84,Td,31,16,"ng-template",null,1,e.C5r)(86,Ri,1,0,"ng-template",null,2,e.C5r)(88,ma,21,12,"ng-template",null,3,e.C5r)}2&s&&(e.FS9("title",e.bMT(1,27,i.title)),e.Y8G("breadcrumbItems",i.breadCrumbItems),e.R7$(10),e.Y8G("countUp",null==i.requestStatus?null:i.requestStatus.all)("options",i.option),e.R7$(12),e.Y8G("countUp",null==i.requestStatus?null:i.requestStatus.pending)("options",i.option),e.R7$(12),e.Y8G("countUp",null==i.requestStatus?null:i.requestStatus.underReview)("options",i.option),e.R7$(12),e.Y8G("countUp",null==i.requestStatus?null:i.requestStatus.accept)("options",i.option),e.R7$(12),e.Y8G("countUp",null==i.requestStatus?null:i.requestStatus.reject)("options",i.option),e.R7$(8),e.Y8G("addPermission",e.lJ4(33,la))("totalItems",i.pagination.totalItems)("title",i.title),e.R7$(4),e.FS9("placeholder",e.bMT(71,29,"general.table.name")),e.R50("ngModel",i.pagination.name),e.R7$(4),e.FS9("placeholder",e.bMT(75,31,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",i.searchForm.creationDates),e.R7$(4),e.Y8G("value",i.entities)("rows",i.pagination.pageSize)("lazy",!0)("totalRecords",i.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",i.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",i.pagination.totalItems>0))},dependencies:[k.bT,g.qT,g.me,g.BC,g.cb,g.YS,g.vS,g.cV,F.s5,Ce.kL,Ut.G,ni.m,Ye.b,rt.w,$e.p,qe.g,O.Mm,Y.XI,Te.Ei,Y.Tg,X.Cv,fe.vr,F.md,Se.m,Be.p,k.vh,O.D9],encapsulation:2})}}return a})();x(39974),x(85343),x(54360),x(58750);let wi=(()=>{class a extends Qt.d{constructor(t){super(t,nt.c.apiUrl+"PriceList/")}UpdatePriceListItemUnit(t){return this.http.get(this.baseUrl+"UpdatePriceListItemUnit/"+t)}GetPriceListWithUnits(t){return this.http.get(this.baseUrl+"GetPriceListWithUnits/"+t)}EditPriceListItem(t){return this.http.post(this.baseUrl+"EditPriceListItem/",t)}static{this.\u0275fac=function(s){return new(s||a)(e.KVO(Ot.Qq))}}static{this.\u0275prov=e.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})();var Er=x(84205);const ga=()=>["priceList.register"],Ni=()=>["priceList.edit"],Gr=()=>["priceList.delete"];function rn(a,u){1&a&&(e.j41(0,"tr",28)(1,"th",29),e.EFF(2,"#"),e.k0s(),e.j41(3,"th",30),e.nrm(4,"i",31),e.EFF(5," sales.priceList.name "),e.k0s(),e.j41(6,"th",32),e.nrm(7,"i",31),e.EFF(8," sales.priceList.clientGroupName "),e.k0s(),e.j41(9,"th",33),e.nrm(10,"i",31),e.EFF(11," sales.clientCollection.clientName "),e.k0s(),e.j41(12,"th",34),e.nrm(13,"i",31),e.EFF(14," general.table.isActive "),e.k0s(),e.j41(15,"th",35),e.nrm(16,"i",31),e.EFF(17," sales.clientCollection.notes "),e.k0s(),e.nrm(18,"th",36),e.k0s())}function xd(a,u){1&a&&e.nrm(0,"span",45)}function sn(a,u){1&a&&e.nrm(0,"span",46)}function ha(a,u){if(1&a&&(e.nrm(0,"i",47),e.EFF(1),e.nI1(2,"date"),e.nrm(3,"br")(4,"i",48),e.EFF(5),e.nI1(6,"date"),e.nrm(7,"br")(8,"i",49),e.EFF(9)),2&a){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",e.i5U(2,3,t.creationTime,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",e.i5U(6,6,t.lastModificationTime,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",t.creatorName," ")}}function _a(a,u){if(1&a){const t=e.RV6();e.j41(0,"button",50),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,l=e.XpG();return e.Njj(l.goList(i.id))}),e.nrm(1,"i",51),e.k0s()}}function Dr(a,u){if(1&a){const t=e.RV6();e.j41(0,"button",52),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,l=e.XpG(),m=e.sdS(22);return e.Njj(l.EditModel(i.id,m))}),e.nrm(1,"i",53),e.k0s()}}function kd(a,u){if(1&a){const t=e.RV6();e.j41(0,"button",54),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,l=e.XpG(),m=e.sdS(24);return e.Njj(l.openModal(i.id,m))}),e.nrm(1,"i",55),e.k0s()}}function Fd(a,u){if(1&a){const t=e.RV6();e.j41(0,"tr",37)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td",38),e.bIt("click",function(){const i=e.eBV(t).$implicit,l=e.XpG();return e.Njj(l.goList(i.id))}),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td"),e.DNE(10,xd,1,0,"span",39)(11,sn,1,0,"span",40),e.k0s(),e.j41(12,"td"),e.EFF(13),e.k0s(),e.j41(14,"td"),e.DNE(15,ha,10,9,"ng-template",null,3,e.C5r),e.nrm(17,"i",41),e.DNE(18,_a,2,0,"button",42)(19,Dr,2,0,"button",43)(20,kd,2,0,"button",44),e.k0s()()}if(2&a){const t=u.$implicit,s=u.rowIndex,i=e.sdS(16);e.R7$(2),e.JRh(s+1),e.R7$(2),e.JRh(t.name),e.R7$(2),e.JRh(t.clientGroupName),e.R7$(2),e.JRh(t.clientName),e.R7$(2),e.Y8G("ngIf",t.isActive),e.R7$(),e.Y8G("ngIf",!t.isActive),e.R7$(2),e.JRh(t.notes),e.R7$(4),e.Y8G("ngbTooltip",i),e.R7$(),e.Y8G("hasPermission",e.lJ4(11,Ni)),e.R7$(),e.Y8G("hasPermission",e.lJ4(12,Ni)),e.R7$(),e.Y8G("hasPermission",e.lJ4(13,Gr))}}function Rd(a,u){1&a&&(e.j41(0,"div",56),e.EFF(1," general.table.noData"),e.k0s())}function fa(a,u){if(1&a){const t=e.RV6();e.j41(0,"div",57)(1,"div",58),e.nrm(2,"ngb-pagination-info",59),e.j41(3,"table-length",60),e.bIt("lengthChange",function(i){e.eBV(t);const l=e.XpG();return e.Njj(l.ListItemChange(i))}),e.k0s()(),e.j41(4,"div",61)(5,"ngb-pagination",62),e.bIt("pageChange",function(i){e.eBV(t);const l=e.XpG();return e.Njj(l.pageChanged(i))}),e.mxI("pageChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.pagination.pageNumber,i)||(l.pagination.pageNumber=i),e.Njj(i)}),e.k0s()()()}if(2&a){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function ba(a,u){1&a&&(e.j41(0,"span",94),e.EFF(1,"general.action.register "),e.k0s())}function Md(a,u){1&a&&(e.j41(0,"span",94),e.EFF(1,"general.action.edit "),e.k0s())}function va(a,u){1&a&&(e.j41(0,"div",95),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function Ca(a,u){1&a&&(e.j41(0,"div",95),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function Qe(a,u){if(1&a){const t=e.RV6();e.j41(0,"div",63)(1,"div",64)(2,"h4",65),e.DNE(3,ba,2,0,"span",66)(4,Md,2,0,"span",66),e.j41(5,"span",67),e.EFF(6),e.k0s()(),e.j41(7,"button",68),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss("Cross click"))}),e.k0s()(),e.j41(8,"div",69),e.nrm(9,"ngx-ui-loader",70),e.j41(10,"form",71,4),e.bIt("submit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.OnSubmit())}),e.j41(12,"div",10)(13,"div",72)(14,"label",73),e.EFF(15,"sales.priceList.name"),e.k0s(),e.j41(16,"input",74,5),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.form.name,i)||(l.form.name=i),e.Njj(i)}),e.k0s(),e.DNE(18,va,2,0,"div",75),e.k0s(),e.j41(19,"div",76)(20,"label",77),e.EFF(21,"sales.priceList.clientGroupName"),e.k0s(),e.j41(22,"ng-select",78,6),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.form.clientGroupId,i)||(l.form.clientGroupId=i),e.Njj(i)}),e.k0s(),e.DNE(24,Ca,2,0,"div",79),e.k0s(),e.j41(25,"div",80)(26,"label",77),e.EFF(27,"sales.priceList.discountType"),e.k0s(),e.j41(28,"ng-select",81,7),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.form.discountType,i)||(l.form.discountType=i),e.Njj(i)}),e.k0s()(),e.j41(30,"div",80)(31,"label",82),e.EFF(32,"sales.priceList.discount"),e.k0s(),e.j41(33,"input",83,8),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.form.discount,i)||(l.form.discount=i),e.Njj(i)}),e.k0s()(),e.j41(35,"div",76)(36,"label",84),e.EFF(37,"sales.clientCollection.clientName"),e.k0s(),e.j41(38,"ng-select",85),e.bIt("scrollToEnd",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.scrollClient())}),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.form.clientId,i)||(l.form.clientId=i),e.Njj(i)}),e.k0s()(),e.j41(39,"div",80)(40,"label",86),e.EFF(41,"stores.storesUnits.isActive"),e.k0s(),e.j41(42,"p-inputSwitch",87),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.form.isActive,i)||(l.form.isActive=i),e.Njj(i)}),e.k0s()(),e.j41(43,"div",76)(44,"label",88),e.EFF(45,"sales.clientCollection.notes"),e.k0s(),e.j41(46,"textarea",89,9),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.form.notes,i)||(l.form.notes=i),e.Njj(i)}),e.k0s()(),e.j41(48,"div",90)(49,"button",91),e.nrm(50,"i",92)(51,"span",93),e.k0s()()()()()()}if(2&a){const t=e.sdS(11),s=e.sdS(17),i=e.sdS(23),l=e.XpG();e.R7$(3),e.Y8G("ngIf",!l.isEditForm),e.R7$(),e.Y8G("ngIf",l.isEditForm),e.R7$(2),e.JRh(l.titleOperation),e.R7$(3),e.Y8G("hasProgressBar",!1)("fgsType",l.loaderOperationShap)("loaderId",l.operationLoader),e.R7$(7),e.R50("ngModel",l.form.name),e.R7$(2),e.Y8G("ngIf",s.invalid&&s.touched),e.R7$(4),e.Y8G("items",l.clientGroups)("multiple",!1),e.R50("ngModel",l.form.clientGroupId),e.R7$(2),e.Y8G("ngIf",i.invalid&&i.touched),e.R7$(4),e.Y8G("items",l.discountTypes),e.R50("ngModel",l.form.discountType),e.R7$(5),e.R50("ngModel",l.form.discount),e.R7$(5),e.Y8G("virtualScroll",!0)("items",l.clients)("typeahead",l.searchClient)("loading",l.loading)("multiple",!1),e.R50("ngModel",l.form.clientId),e.R7$(4),e.R50("ngModel",l.form.isActive),e.R7$(4),e.R50("ngModel",l.form.notes),e.R7$(3),e.Y8G("disabled",!t.valid)}}function kt(a,u){if(1&a){const t=e.RV6();e.j41(0,"delete-modal",96),e.bIt("deleteConfirm",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.DeleteConfirmSoft())})("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}}let Od=(()=>{class a extends De.w{constructor(t,s,i,l,m,c,E,P,q,D,J,ee,W){super(t,s,E,i,l,m,c),this.baseService=i,this.excelService=q,this.clientService=D,this.clientGroupsService=J,this.offerOrderService=ee,this.router=W,this.title="sales.priceList.title",this.titleOperation="sales.priceList.titleOperation",this.keySelected="",this.assignUsers=[],this.times=[],this.employees=[],this.searchForm={},this.isResolveList=!0,this.countLoad=2,this.clientParam={pageSize:50,pageNumber:1,search:"",clientId:null},this.clients=[],this.loading=!1,this.searchClient=new ut.B,this.clientGroups=[],this.discountTypes=[],this.setDates=(Q,V,z)=>{if(Q?.from||Q?.to){const oe=Q.to||Q.from;this.pagination[V]=this.datePipe.transform(Q.from||Q.to,"yyyy-MM-ddT00:00:00"),this.pagination[z]=this.datePipe.transform(oe,"yyyy-MM-ddT23:59:59.999")}else this.pagination[V]=null,this.pagination[z]=null},this.configRoute(),this.discountTypes=this.offerOrderService.discountTypes,this.discountTypes.forEach(Q=>{Q.name=this.getTranslationText("sales.salesOrder."+Q.name)})}ngOnInitMore(){this.searchClient.pipe((0,ze.B)(300),(0,Kn.F)(),(0,zt.n)(t=>this.loadClient(t))).subscribe(),this.getClientGroups()}getClientGroups(){this.clientGroupsService.getDropDown().subscribe({next:t=>{this.clientGroups=t.data}})}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader("allLoader"),this.setDates(t.creationDates,"dateFrom","dateTo"),this.loadentities()}loadClient(t){return this.loading=!0,""==t||null==t?(this.loading=!1,(0,Zn.of)([])):this.getClientDropdwon(t)}getClientDropdwon(t=""){return this.clientParam.search=t,this.clientParam.clientId=null,this.clientParam.pageNumber=1,this.clientService.GetClientSearch(this.clientParam).pipe((0,zt.n)(s=>(this.clients=s.data,this.loading=!1,[])))}mapForm(t){let s={...t};return s.clientId>0&&(s.clientGroupId=null),s}mapRegisterForm(t){let s={...t};return s.clientId>0&&(s.clientGroupId=null),s.id=0,s}OnSearch(t){this.ngxLoader.startLoader(N.a7),this.loadentities()}configRoute(){}EditModel(t,s,i="md"){this.isEditForm=!0,this.baseService.getById(t).pipe((0,R.Q)(this.notifier)).subscribe(l=>{l.success?(this.clientParam.clientId=l.data.clientId,this.clientParam.search="",this.clientService.GetClientSearch(this.clientParam).subscribe(m=>{this.clients=m.data}),this.form=l.data):this.alertService.error("general.message."+l.message),this.modalService.open(s,{centered:!0,size:i})},l=>{this.alertService.error()})}mapExcel(){let t=[];return this.entities?.forEach(s=>{t.push({nameAr:s.nameAr,nameEn:s.nameEn,isActive:this.getTranslationText("general.table.active"),notes:s.notes})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.getTranslationText(this.title),[])}editEntity(){let t=this.mapForm(this.form);this.baseService.editPut(t.id,t).pipe((0,me.O)(),(0,se.c)(this.mainDelay),(0,pe.Z)(),(0,R.Q)(this.notifier),(0,ie.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(s=>{s.success?this.submitFunished():this.alertService.error("general.message."+s.message)},s=>{this.alertService.error("general.message."+s)})}scrollClient(){this.clientParam.pageNumber=this.clientParam.pageNumber+1,this.clientService.GetClientSearch(this.clientParam).subscribe(t=>{this.clients=[...this.clients,...t.data]})}goList(t){this.router.navigateByUrl("/sales/PriceListItems/"+t)}static{this.\u0275fac=function(s){return new(s||a)(e.rXU(A.nX),e.rXU(O.c$),e.rXU(wi),e.rXU(le.u),e.rXU(k.vh),e.rXU(X.eD),e.rXU(F.Bq),e.rXU(e.gRc),e.rXU(He.V),e.rXU(it.X),e.rXU(Er.t),e.rXU(Ge),e.rXU(A.Ix))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["app-priceList"]],features:[e.Vt3],decls:25,vars:20,consts:[["tableMaster",""],["operation",""],["deleteModal",""],["tooltipContent",""],["formEntity","ngForm"],["name","ngModel"],["clientGroupId","ngModel"],["discountType","ngModel"],["discount","ngModel"],["notes","ngModel"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],[3,"reset","search","exportXlsx","addNew","addPermission","totalItems","title"],["control",""],[1,"col-md-4","mb-2"],[1,"search-box"],["type","search","id","name","name","name",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],[1,"col-12","col-md-3","mb-2"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["translate","",2,"width",".5%"],["pSortableColumn","paymentTypeName","translate","",2,"width","10%"],[1,"ri-expand-up-down-line"],["pSortableColumn","clientGroupId","translate","",2,"width","12%"],["pSortableColumn","clientId","translate","",2,"width","12%"],["pSortableColumn","isActive","translate","",2,"width","6%"],["pSortableColumn","notes","translate","",2,"width","8%"],["translate","",2,"width","12%"],[1,"fs-5"],[3,"click"],["class","badge bg-success-subtle text-success p-2","translate","general.table.active",4,"ngIf"],["class","badge bg-danger-subtle text-danger p-2","translate","general.table.noActive",4,"ngIf"],["tooltipPosition","top",1,"mdi","mdi-cog-outline","text-muted","fs-16","align-middle","me-1",3,"ngbTooltip"],["class","btn btn-sm btn-soft-warning edit-list mx-2 ",3,"click",4,"hasPermission"],["class","btn btn-sm btn-soft-info edit-list mx-2",3,"click",4,"hasPermission"],["class","btn btn-sm btn-soft-danger remove-list",3,"click",4,"hasPermission"],["translate","general.table.active",1,"badge","bg-success-subtle","text-success","p-2"],["translate","general.table.noActive",1,"badge","bg-danger-subtle","text-danger","p-2"],[1,"ri-history-fill","text-warning"],[1,"ri-history-fill","text-danger"],[1,"ri-user-location-fill","text-primary"],[1,"btn","btn-sm","btn-soft-warning","edit-list","mx-2",3,"click"],[1,"ri-refresh-fill","align-bottom","mx-1"],[1,"btn","btn-sm","btn-soft-info","edit-list","mx-2",3,"click"],[1,"ri-pencil-fill","align-bottom","mx-1"],[1,"btn","btn-sm","btn-soft-danger","remove-list",3,"click"],[1,"ri-delete-bin-5-fill","align-bottom"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["class","fw-bold fs-4","translate","",4,"ngIf"],["translate",""],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"hasProgressBar","fgsType","loaderId"],[3,"submit"],[1,"col-12"],["for","name","translate","",1,"fw-bold","form-label"],["InputTirmFilter","","name","name","type","text","id","name","required","",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["class","text-danger text-center  ","translate","",4,"ngIf"],[1,"col-12","my-1"],["translate","",1,"fw-bold","form-label","w-100"],["name","clientGroupId","id","clientGroupId","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","ngModel"],["class","text-danger text-center","translate","",4,"ngIf"],[1,"col-12","col-md-6"],["clearable","false","clearOnBackspace","false","name","discountType","bindValue","id","bindLabel","name",2,"width","100%",3,"ngModelChange","items","ngModel"],["for","discount","translate","",1,"fw-bold","form-label"],["InputTirmFilter","","name","name","type","number","id","discount",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["for","nameAr","translate","",1,"fw-bold","form-label"],["bindLabel","displayName","bindValue","id","name","clientId",3,"scrollToEnd","ngModelChange","virtualScroll","items","typeahead","loading","multiple","ngModel"],["for","isActive","translate","",1,"fw-bold","form-label","d-block"],["id","isActive","name","isActive","inputId","isActive",3,"ngModelChange","ngModel"],["for","notes","translate","",1,"fw-bold","form-label"],["rows","1","InputTirmFilter","","name","notes","type","text","id","notes",1,"form-control","fs-6",3,"ngModelChange","ngModel"],[1,"text-center"],["type","submit","type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],["translate","",1,"fw-bold","fs-4"],["translate","",1,"text-danger","text-center"],[3,"deleteConfirm","dismiss"]],template:function(s,i){if(1&s){const l=e.RV6();e.j41(0,"div",10)(1,"div",11)(2,"div",12)(3,"base-filter",13),e.bIt("reset",function(){return e.eBV(l),e.Njj(i.onReset())})("search",function(){return e.eBV(l),e.Njj(i.onSearch())})("exportXlsx",function(){return e.eBV(l),e.Njj(i.onExportXlsx())})("addNew",function(){e.eBV(l);const c=e.sdS(22);return e.Njj(i.openModalTitle(c,"md"))}),e.qex(4,14),e.j41(5,"div",15)(6,"div",16)(7,"input",17),e.nI1(8,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.name,c)||(i.pagination.name=c),e.Njj(c)}),e.k0s(),e.nrm(9,"i",18),e.k0s()(),e.j41(10,"div",19)(11,"input",20),e.nI1(12,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.searchForm.creationDates,c)||(i.searchForm.creationDates=c),e.Njj(c)}),e.k0s()(),e.bVm(),e.k0s(),e.j41(13,"div",21)(14,"div",22)(15,"p-table",23,0),e.bIt("onLazyLoad",function(c){return e.eBV(l),e.Njj(i.tableChange(c))})("selectionChange",function(c){return e.eBV(l),e.Njj(i.onSelectionChange(c))}),e.DNE(17,rn,19,0,"ng-template",24)(18,Fd,21,14,"ng-template",25),e.k0s()(),e.DNE(19,Rd,2,0,"div",26)(20,fa,6,8,"div",27),e.k0s()()()(),e.DNE(21,Qe,52,24,"ng-template",null,1,e.C5r)(23,kt,1,0,"ng-template",null,2,e.C5r)}2&s&&(e.R7$(3),e.Y8G("addPermission",e.lJ4(19,ga))("totalItems",i.pagination.totalItems)("title",i.title),e.R7$(4),e.FS9("placeholder",e.bMT(8,15,"general.table.name")),e.R50("ngModel",i.pagination.name),e.R7$(4),e.FS9("placeholder",e.bMT(12,17,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",i.searchForm.creationDates),e.R7$(4),e.Y8G("value",i.entities)("rows",i.pagination.pageSize)("lazy",!0)("totalRecords",i.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",i.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",i.pagination.totalItems>0))},dependencies:[k.bT,g.qT,g.me,g.Q0,g.BC,g.cb,g.YS,g.vS,g.cV,F.s5,Ce.kL,Ye.b,rt.w,$e.p,qe.g,O.Mm,Y.XI,Te.Ei,Y.Tg,Yt.HW,X.Cv,fe.vr,F.md,Se.m,Be.p,k.vh,O.D9],encapsulation:2})}}return a})(),wd=(()=>{class a extends tn.E{constructor(t,s,i){super(t,s,i)}static{this.\u0275fac=function(s){return new(s||a)(e.KVO(A.Ix),e.KVO(ea),e.KVO(le.u))}}static{this.\u0275prov=e.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})();const Ei=()=>["assignTruckOrder.changeStatus"],Tn=()=>["assignTruckOrder.print"],Sa=()=>["assignTruckOrder.finish"];function ja(a,u){1&a&&e.nrm(0,"span",45)}function Nd(a,u){if(1&a&&(e.j41(0,"a",46),e.nrm(1,"i",47),e.k0s()),2&a){const t=e.XpG().$implicit,s=e.XpG();e.Y8G("href",s.mapUrl(null==t?null:t.lng,null==t?null:t.lat),e.B4B)}}function ya(a,u){if(1&a&&(e.qex(0),e.j41(1,"div",48)(2,"div",49)(3,"div",50),e.EFF(4),e.k0s(),e.j41(5,"div",51)(6,"span",52),e.EFF(7),e.k0s(),e.j41(8,"span",53),e.EFF(9),e.k0s()()()(),e.bVm()),2&a){const t=u.$implicit,s=u.index;e.R7$(4),e.Lme(" ",s+1," - ",t.itemName," "),e.R7$(3),e.SpI("",t.unitName," "),e.R7$(2),e.SpI("",t.quantity," ")}}function xn(a,u){if(1&a){const t=e.RV6();e.j41(0,"div",51)(1,"span",54),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,l=e.XpG(),m=e.sdS(28);return e.Njj(l.openChangeStatusModal(i,m))}),e.nrm(2,"i",55)(3,"span",56),e.k0s()()}}function Jn(a,u){if(1&a){const t=e.RV6();e.j41(0,"div",51)(1,"span",57),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,l=e.XpG();return e.Njj(l.PrintOrderReceived(i.id))}),e.nrm(2,"i",58)(3,"span",59),e.k0s()()}}function Ed(a,u){if(1&a){const t=e.RV6();e.j41(0,"div",51)(1,"span",60),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,l=e.XpG(),m=e.sdS(30);return e.Njj(l.openFinishedModal(i.id,m,"md"))}),e.nrm(2,"i",61)(3,"span",62),e.k0s()()}}function Ia(a,u){if(1&a){const t=e.RV6();e.j41(0,"div",21)(1,"div",22)(2,"div",23)(3,"bdi")(4,"span")(5,"span"),e.EFF(6),e.nI1(7,"translate"),e.k0s()()(),e.j41(8,"div",24)(9,"p",25),e.nrm(10,"i",26),e.EFF(11),e.k0s(),e.j41(12,"p",25),e.nrm(13,"i",27),e.EFF(14),e.k0s()(),e.j41(15,"div",28)(16,"p",25),e.nrm(17,"i",29),e.EFF(18),e.nI1(19,"date"),e.k0s(),e.j41(20,"p",30),e.nrm(21,"i",31),e.EFF(22),e.k0s()(),e.j41(23,"div",28)(24,"h5",32),e.nrm(25,"i",33),e.EFF(26),e.k0s(),e.j41(27,"p",30),e.nrm(28,"i",34),e.EFF(29),e.k0s()(),e.j41(30,"div",35),e.DNE(31,ja,1,0,"span",36)(32,Nd,2,1,"a",37),e.j41(33,"div"),e.nrm(34,"i",38),e.j41(35,"span",39),e.bIt("click",function(){const i=e.eBV(t).$implicit,l=e.XpG();return e.Njj(l.copytext(i.mobile))}),e.EFF(36),e.nrm(37,"i",40),e.k0s()()(),e.nrm(38,"hr"),e.j41(39,"div",41),e.DNE(40,ya,10,4,"ng-container",42),e.k0s(),e.j41(41,"div",43),e.DNE(42,xn,4,0,"div",44)(43,Jn,4,0,"div",44)(44,Ed,4,0,"div",44),e.k0s()()()()}if(2&a){const t=u.$implicit;e.R7$(4),e.ZvI("ribbon ",t.trunckStatusName," round-shape "),e.R7$(2),e.JRh(e.bMT(7,17,"sales.salesOrder."+t.trunckStatusName)),e.R7$(5),e.SpI(" ",t.shippingTruckName," "),e.R7$(3),e.SpI(" ",t.shippingTruckNumber," "),e.R7$(4),e.SpI(" ",e.i5U(19,19,t.deliveryDate,"yyyy-MM-dd HH:mm")," "),e.R7$(4),e.SpI(" #SHO#",t.id," "),e.R7$(4),e.SpI(" ",t.clientName," "),e.R7$(3),e.SpI(" #SO#",t.offerOrderMasterId," "),e.R7$(2),e.Y8G("ngIf",""==t.lng),e.R7$(),e.Y8G("ngIf",null==t?null:t.lng),e.R7$(4),e.SpI("",t.mobile," "),e.R7$(4),e.Y8G("ngForOf",t.details),e.R7$(2),e.Y8G("hasPermission",e.lJ4(22,Ei)),e.R7$(),e.Y8G("hasPermission",e.lJ4(23,Tn)),e.R7$(),e.Y8G("hasPermission",e.lJ4(24,Sa))}}function Ta(a,u){1&a&&(e.j41(0,"div",63),e.EFF(1," general.table.noData "),e.k0s())}function Gi(a,u){if(1&a){const t=e.RV6();e.j41(0,"div",64)(1,"div",65),e.nrm(2,"ngb-pagination-info",66),e.j41(3,"table-length",67),e.bIt("lengthChange",function(i){e.eBV(t);const l=e.XpG();return e.Njj(l.ListItemChange(i))}),e.k0s()(),e.j41(4,"div",68)(5,"ngb-pagination",69),e.bIt("pageChange",function(i){e.eBV(t);const l=e.XpG();return e.Njj(l.pageChanged(i))}),e.mxI("pageChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.pagination.pageNumber,i)||(l.pagination.pageNumber=i),e.Njj(i)}),e.k0s()()()}if(2&a){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function xa(a,u){if(1&a){const t=e.RV6();e.j41(0,"div",70)(1,"div",71)(2,"h4",72),e.nrm(3,"span",73),e.k0s(),e.j41(4,"button",74),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()(),e.j41(5,"div",75),e.nrm(6,"ngx-ui-loader",76),e.j41(7,"form",77,2),e.bIt("ngSubmit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.changeStatus())}),e.j41(9,"div",17)(10,"div",78)(11,"label",79),e.EFF(12,"sales.salesOrder.trunckStatus"),e.k0s(),e.j41(13,"ng-select",80),e.nI1(14,"translate"),e.mxI("ngModelChange",function(i){e.eBV(t);const l=e.XpG();return e.DH7(l.form.trunckStatus,i)||(l.form.trunckStatus=i),e.Njj(i)}),e.k0s()()(),e.j41(15,"div",32)(16,"button",81),e.nrm(17,"i",82)(18,"span",83),e.k0s()()()()()}if(2&a){const t=e.sdS(8),s=e.XpG();e.R7$(6),e.Y8G("hasProgressBar",!1)("fgsType",s.loaderOperationShap)("loaderId",s.operationLoader),e.R7$(7),e.FS9("placeholder",e.bMT(14,8,"orderManagement.order.changeTeamStatus")),e.Y8G("items",s.statusList)("multiple",!1),e.R50("ngModel",s.form.trunckStatus),e.R7$(3),e.Y8G("disabled",!t.valid)}}function Di(a,u){if(1&a){const t=e.RV6();e.j41(0,"div",96)(1,"i",97),e.bIt("click",function(){const i=e.eBV(t),l=i.$implicit,m=i.index,c=e.XpG(2);return e.Njj(c.removeImage(l.id,m))}),e.k0s(),e.j41(2,"div",98),e.nrm(3,"img",99),e.k0s()()}if(2&a){const t=u.$implicit,s=e.XpG(2);e.R7$(3),e.Y8G("src",0==t.id?t.path:s.serverPath+t.path,e.B4B)}}function Lr(a,u){if(1&a){const t=e.RV6();e.j41(0,"div",71)(1,"h4",72),e.nrm(2,"span",84),e.k0s(),e.j41(3,"button",74),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()(),e.j41(4,"div",75)(5,"form",null,2),e.nrm(7,"ngx-ui-loader",76),e.j41(8,"div",85)(9,"div",86)(10,"div",87)(11,"div",88)(12,"button",89),e.bIt("click",function(){e.eBV(t);const i=e.sdS(17);return e.Njj(i.click())}),e.EFF(13," orderManagement.order.assignedOrders.select "),e.k0s(),e.j41(14,"div",90),e.DNE(15,Di,4,1,"div",91),e.k0s()(),e.j41(16,"input",92,3),e.bIt("change",function(i){e.eBV(t);const l=e.XpG();return e.Njj(l.onFileChanged(i))}),e.k0s()(),e.j41(18,"div",93)(19,"button",94),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.finishOrder())}),e.k0s(),e.j41(20,"button",95),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()()()()()()}if(2&a){const t=e.XpG();e.R7$(7),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader),e.R7$(8),e.Y8G("ngForOf",t.images)}}let Li=(()=>{class a extends De.w{constructor(t,s,i,l,m,c,E,P,q,D,J){super(t,s,P,i,m,c,E),this.baseService=i,this.salesInvoicesService=l,this.authDaamService=q,this.excelService=D,this._formDataService=J,this.title="sales.assignTruckOrder.title",this.titleOperation="sales.assignTruckOrder.title",this.config={infinite:!0,slidesToShow:5,slidesToScroll:1,autoplay:!1,arrows:!1},this.trunks=[],this.isFlagTime=!0,this.searchForm={},this.statusList=[],this.pagination={pageNumber:1,pageSize:30},this.images=[],this.serverPath=nt.c.mediaUrl,this.form={orderId:0,attachmens:[]},this.setDates=(ee,W,Q)=>{if(ee?.from||ee?.to){const z=ee.to||ee.from;this.pagination[W]=this.datePipe.transform(ee.from||ee.to,"yyyy-MM-ddT00:00:00"),this.pagination[Q]=this.datePipe.transform(z,"yyyy-MM-ddT23:59:59.999")}else this.pagination[W]=null,this.pagination[Q]=null}}loadentities(){this.ngxLoader.startLoader(N.a7),this.baseService.GetOrderAssignTrunk(this.pagination).pipe((0,R.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader(N.a7),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader(N.a7),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[]}ngOnInitMore(){this.loadentities(),this.checkStatus()}checkStatus(){let t=this.baseService.getTrunckStatus();t.forEach(s=>{s.name=this.getTranslationText("sales.salesOrder."+s.name)}),this.statusList=t}mapExcel(){let t=[];return this.entities.forEach(s=>{t.push({"Order Code":s.orderCode,"Created Date":s.createdDate,"City Name":s.cityName,"District Name":s.districtName?s.districtName:"--","Agent Name":s.agentName,Mobile:s.mobile,"Channel Name":s.channelName,"Assigned To":s.teamNames,Times:s.workTimes,"Visit Date":s.visitDate,Services:s.services})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader("allLoader"),this.setDates(t.dates,"visitDateFrom","visitDateTo"),this.setDates(t.creationDates,"creationTimeFrom","creationTimeTo"),this.loadentities()}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}openChangeStatusModal(t,s,i="md"){this.form={},this.form.trunckStatus=t.trunckStatus,this.form.id=t.id,this.modalService.open(s,{centered:!0,size:i})}changeStatus(){this.ngxLoader.startLoader(this.operationLoader),this.baseService.changeStatus({trunckStatus:this.form.trunckStatus,id:this.form.id}).pipe((0,R.Q)(this.notifier),(0,ie.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(s=>{this.loadentities(),this.alertService.success(),this.modalService.dismissAll()},()=>{this.alertService.error()})}mapUrl(t,s){return null===t||null==s?"":`https://www.google.com/maps/dir//${s},${t}/@${s},${t},17z?hl=en-US`}SubmitFinishOrder(){this.ngxLoader.startLoader(this.operationLoader),this.salesInvoicesService.finishOrder(this.form.id).pipe((0,R.Q)(this.notifier),(0,ie.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(t=>{this.loadentities(),this.alertService.success(),this.modalService.dismissAll()},()=>{this.alertService.error()})}PrintOrderReceived(t){this.ngxLoader.startLoader("searchLoader"),this.baseService.PrintOrderReceived(t).pipe((0,me.O)(),(0,se.c)(100),(0,pe.Z)(),(0,R.Q)(this.notifier),(0,ie.j)(()=>this.ngxLoader.stopLoader("searchLoader"))).subscribe(s=>{this.openUrl(s)},s=>{this.alertService.error("general.message."+s)})}openUrl(t){let s=new Blob([t],{type:t.type});var i=URL.createObjectURL(s);window.open(i,"_blank")}onFileChanged(t){if(t.target.files&&t.target.files[0]){let s=t.target.files.length;for(let i=0;i<s;i++){let l=new FileReader;this.form.attachmens.push({attachImage:t.target.files.item(i),type:"file"}),l.onload=m=>{this.images.push({id:0,path:m.target.result,completePath:m.target.result})},l.readAsDataURL(t.target.files[i])}}}removeImage(t,s){this.form.attachmens.splice(s,1),this.images.splice(s,1)}openFinishedModal(t,s,i="md"){this.form={},this.form.orderId=t,this.images=[],this.form.attachmens=[],this.modalService.open(s,{centered:!0,size:i})}finishOrder(){const t=new FormData;t.append("OrderId",this.form.orderId.toString()),this.form.attachmens.forEach(s=>{t.append("Attachmens",s.attachImage)}),this.salesInvoicesService.finishOrder(t).subscribe(s=>{this.ngxLoader.stopLoader(N.Fq),this.loadentities(),this.modalService.dismissAll()},s=>{console.log(s),this.ngxLoader.stopLoader(N.Fq)})}static{this.\u0275fac=function(s){return new(s||a)(e.rXU(A.nX),e.rXU(O.c$),e.rXU(or),e.rXU(jr),e.rXU(le.u),e.rXU(k.vh),e.rXU(X.eD),e.rXU(F.Bq),e.rXU(ft.J),e.rXU(He.V),e.rXU(qn.Q))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["assign-truck-order"]],features:[e.Vt3],decls:31,vars:26,consts:[["changeStatusModal",""],["finishOrderModal",""],["formEntity","ngForm"],["FileInput",""],[1,"card"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[1,"card-body","p-0"],[3,"reset","search","exportXlsx","showAdd","showExport","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","search","id","agentName","name","agentName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["InputTirmFilter","","type","tel","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"col-12","col-md-4","mb-2"],["type","text","mwlFlatpickr","","id","isDate","mode","range",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"row"],["class","col-12 col-md-4 my-2",4,"ngFor","ngForOf"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row text-center px-1 py-1 overflow-hidden",4,"ngIf"],[1,"col-12","col-md-4","my-2"],[1,"card","ribbon-box","border","shadow-none","mb-lg-0","material-shadow","card-item"],[1,"card-body","p-1"],[1,"d-flex","justify-content-between","mt-5"],[1,"text-muted"],[1,"ri-police-car-line","text-muted","me-1","align-bottom"],[1,"ri-truck-line","text-muted","me-1","align-bottom"],[1,"d-flex","justify-content-between"],[1,"ri-calendar-2-fill","text-muted","me-1","align-bottom"],[1,"text-muted","ms-2","text-muted","text-decoration-underline"],[1,"ri-order-play-fill","text-muted","me-1","align-bottom"],[1,"text-center"],[1,"ri-user-2-fill","text-muted","me-1","align-bottom"],[1,"ri-shopping-cart-fill","text-muted","me-1","align-bottom"],[1,"d-flex","gap-4","mb-1","justify-content-between"],["class","badge bg-danger-subtle text-danger mx-1","translate","orderManagement.order.noMap",4,"ngIf"],["target","_blank","class","badge bg-success-subtle text-success mx-1","translate","orderManagement.order.viewMap",3,"href",4,"ngIf"],[1,"ri-phone-fill","text-info","me-1","align-bottom"],[1,"cursor-pointer","badge","bg-info-subtle","text-info","fs-6",3,"click"],[1,"ri-clipboard-line"],[1,""],[4,"ngFor","ngForOf"],[1,"row","mt-3","justify-content-between"],["class","col-12 col-md-4",4,"hasPermission"],["translate","orderManagement.order.noMap",1,"badge","bg-danger-subtle","text-danger","mx-1"],["target","_blank","translate","orderManagement.order.viewMap",1,"badge","bg-success-subtle","text-success","mx-1",3,"href"],[1,"ri-map-pin-line"],[1,"card","p-0","m-0","card-item"],[1,"card-body","row","p-0"],[1,"col-12","col-md-8","fs-4"],[1,"col-12","col-md-4"],[1,"badge","bg-primary-subtle","text-primary","mx-2","fs-6"],[1,"badge","bg-danger-subtle","text-danger","fs-6"],[1,"btn","btn-sm","btn-soft-success",3,"click"],[1,"ri-swap-line","label-icon","align-bottom","rounded-pill","fs-16","me-2"],["translate","orderManagement.order.changeTeamStatus"],[1,"btn","btn-sm","btn-soft-info",3,"click"],[1,"ri-printer-fill","label-icon","align-bottom","rounded-pill","fs-16","me-2"],["translate","general.action.print"],[1,"btn","btn-sm","btn-soft-primary",3,"click"],[1,"ri-checkbox-circle-fill","align-bottom"],["translate","orderManagement.order.finishOrder"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","text-center","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["translate","orderManagement.order.changeTeamStatus",1,"fw-bold","fs-4"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"hasProgressBar","fgsType","loaderId"],[3,"ngSubmit"],[1,"mb-3"],["for","trunckStatus","translate","",1,"fw-bold","form-label"],["name","trunckStatus","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],["translate","orderManagement.order.finishOrder",1,"fw-bold","fs-4"],[1,"modal-content"],[1,"modal-body","p-1"],[1,"col-12","col-lg-12","d-flex"],[1,"w-75"],["translate","",1,"btn","btn-warning","px-5",3,"click"],[1,"my-3","d-flex"],["class","avatar-lg mx-2 position-relative",4,"ngFor","ngForOf"],["multiple","","value","","type","file","accept","image/png, image/gif, image/jpeg",1,"form-control","d-none",3,"change"],[1,"d-flex","gap-2","justify-content-center","my-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger",3,"click"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],[1,"avatar-lg","mx-2","position-relative"],[1,"position-absolute","bx","bx-x-circle","text-white",2,"background","red","top","1px","right","-4px","font-size","1rem","border-radius","50%",3,"click"],[1,"avatar-title","bg-light","rounded"],["id","product-img1","alt","",1,"avatar-md","h-auto",3,"src"]],template:function(s,i){if(1&s){const l=e.RV6();e.j41(0,"div",4),e.nrm(1,"ngx-ui-loader",5),e.j41(2,"div",6)(3,"base-filter",7),e.bIt("reset",function(){return e.eBV(l),e.Njj(i.onReset())})("search",function(){return e.eBV(l),e.Njj(i.onSearch())})("exportXlsx",function(){return e.eBV(l),e.Njj(i.onExportXlsx())}),e.qex(4,8),e.j41(5,"div",9)(6,"div",10)(7,"input",11),e.nI1(8,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.orderCode,c)||(i.pagination.orderCode=c),e.Njj(c)}),e.k0s(),e.nrm(9,"i",12),e.k0s()(),e.j41(10,"div",9)(11,"div",10)(12,"input",13),e.nI1(13,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.agentName,c)||(i.pagination.agentName=c),e.Njj(c)}),e.k0s(),e.nrm(14,"i",12),e.k0s()(),e.j41(15,"div",9)(16,"div",10)(17,"input",14),e.nI1(18,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.pagination.mobile,c)||(i.pagination.mobile=c),e.Njj(c)}),e.k0s(),e.nrm(19,"i",12),e.k0s()(),e.j41(20,"div",15)(21,"input",16),e.nI1(22,"translate"),e.mxI("ngModelChange",function(c){return e.eBV(l),e.DH7(i.searchForm.creationDates,c)||(i.searchForm.creationDates=c),e.Njj(c)}),e.k0s()(),e.bVm(),e.k0s()()(),e.j41(23,"div",17),e.DNE(24,Ia,45,25,"div",18),e.k0s(),e.DNE(25,Ta,2,0,"div",19)(26,Gi,6,8,"div",20)(27,xa,19,10,"ng-template",null,0,e.C5r)(29,Lr,21,4,"ng-template",null,1,e.C5r)}2&s&&(e.R7$(),e.Y8G("loaderId","searchLoader"),e.R7$(2),e.Y8G("showAdd",!1)("showExport",!1)("totalItems",i.pagination.totalItems)("title",i.title),e.R7$(4),e.FS9("placeholder",e.bMT(8,18,"orderManagement.order.orderCode")),e.R50("ngModel",i.pagination.orderCode),e.R7$(5),e.FS9("placeholder",e.bMT(13,20,"orderManagement.order.agentName")),e.R50("ngModel",i.pagination.agentName),e.R7$(5),e.FS9("placeholder",e.bMT(18,22,"orderManagement.order.mobile")),e.R50("ngModel",i.pagination.mobile),e.R7$(4),e.FS9("placeholder",e.bMT(22,24,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",i.searchForm.creationDates),e.R7$(3),e.Y8G("ngForOf",i.entities),e.R7$(),e.Y8G("ngIf",i.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",i.pagination.totalItems>0))},dependencies:[k.Sq,k.bT,g.qT,g.me,g.Q0,g.BC,g.cb,g.vS,g.cV,F.s5,Ce.kL,Ye.b,$e.p,qe.g,O.Mm,X.Cv,fe.vr,Se.m,Be.p,k.vh,O.D9],encapsulation:2})}}return a})();var Gd=x(54384);function ka(a,u){1&a&&(e.j41(0,"tr",20)(1,"th",21),e.EFF(2,"#"),e.k0s(),e.j41(3,"th",22),e.EFF(4," sales.priceList.itemName "),e.k0s(),e.j41(5,"th",22),e.EFF(6," sales.priceList.unitName "),e.k0s(),e.j41(7,"th",23),e.EFF(8," sales.priceList.itemPrice "),e.k0s(),e.j41(9,"th",23),e.EFF(10," sales.priceList.price "),e.k0s()())}function Vi(a,u){if(1&a){const t=e.RV6();e.j41(0,"tr",24)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td")(10,"input",25),e.nI1(11,"translate"),e.mxI("ngModelChange",function(i){const l=e.eBV(t).rowIndex,m=e.XpG();return e.DH7(m.form[l].price,i)||(m.form[l].price=i),e.Njj(i)}),e.k0s()()()}if(2&a){const t=u.$implicit,s=u.rowIndex,i=e.XpG();e.R7$(2),e.JRh(s+1),e.R7$(2),e.JRh(t.itemName),e.R7$(2),e.JRh(t.unitName),e.R7$(2),e.JRh(t.itemPrice),e.R7$(2),e.FS9("placeholder",e.bMT(11,6,"sales.priceList.price")),e.R50("ngModel",i.form[s].price)}}function Fa(a,u){1&a&&(e.j41(0,"div",26),e.EFF(1," general.table.noData "),e.k0s())}function Vr(a,u){if(1&a){const t=e.RV6();e.j41(0,"div",17)(1,"a",27),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.closeStock())}),e.nrm(2,"i",19),e.j41(3,"span"),e.EFF(4),e.nI1(5,"translate"),e.k0s()()()}2&a&&(e.R7$(4),e.JRh(e.bMT(5,1,"general.action.save")))}let Dd=(()=>{class a extends De.w{constructor(t,s,i,l,m,c,E,P,q){super(t,s,E,m,i,l,c),this.baseService=m,this.service=P,this.router=q,this.title="sales.priceList.priceListItems",this.submitted=!1,this.pagination={pageNumber:1,pageSize:1e3},this.form=[],this.listId=0}ngOnInitMore(){this.listId=this.routerActive.snapshot.paramMap.get("id"),this.loadentities()}addAllItems(){this.ngxLoader.startLoader(N.a7),this.baseService.UpdatePriceListItemUnit(this.listId).pipe((0,R.Q)(this.notifier)).subscribe(t=>{this.LoadSuccess(),this.ngxLoader.stopLoader(N.a7)},t=>{this.ngxLoader.stopLoader(N.a7),this.alertService.error(t)})}closeStock(){let t=[];this.form.forEach(s=>{t.push({id:s.id,UnitId:s.unitId,itemId:s.itemId,priceListMasterId:s.priceListMasterId,price:s.price})}),this.baseService.EditPriceListItem(t).pipe((0,me.O)(),(0,se.c)(this.mainDelay),(0,pe.Z)(),(0,R.Q)(this.notifier),(0,ie.j)(()=>this.ngxLoader.stopLoader(this.operationLoader)),(0,qt.W)(s=>(0,fn.$)(s))).subscribe(s=>{s.success?this.submitFunished():this.alertService.error("general.message."+s.message)},s=>{this.alertService.error("general.message."+s)})}loadentities(){this.baseService.GetPriceListWithUnits(this.listId).pipe((0,R.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader(N.a7),this.form=t.data,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader(N.a7),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[]}back(){this.router.navigate(["/sales/Prices-List/"])}static{this.\u0275fac=function(s){return new(s||a)(e.rXU(A.nX),e.rXU(O.c$),e.rXU(le.u),e.rXU(k.vh),e.rXU(wi),e.rXU(X.eD),e.rXU(F.Bq),e.rXU(Gd.m),e.rXU(A.Ix))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["app-priceList-operation"]],features:[e.Vt3],decls:27,vars:17,consts:[["tableMaster",""],[3,"title","breadcrumbItems"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],[1,"d-flex","justify-content-end","m-3"],["href","javascript:void(0);",1,"btn","btn-danger",3,"click"],[1,"ri-add-line","align-bottom"],[1,"card-body"],[3,"hasProgressBar","fgsType","loaderId"],[1,"table-responsive"],["dataKey","id",3,"value","rows"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],[1,"row","justify-content-center"],["class","text-center text-danger text-bold fs-6  col-2",4,"ngIf"],[1,"text-center","text-danger","text-bold","fs-6","col-2"],[1,"btn","btn-dark",3,"click"],[1,"ri-check-double-fill","align-bottom"],[1,""],["translate","",2,"width",".5%"],["translate","",2,"width","30%"],["translate","",2,"width","10%"],[1,"fs-5"],["type","number",1,"form-control","text-center",3,"ngModelChange","placeholder","ngModel"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],["href","javascript:void(0);",1,"btn","btn-success",3,"click"]],template:function(s,i){if(1&s){const l=e.RV6();e.nrm(0,"app-breadcrumbs",1),e.nI1(1,"translate"),e.j41(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"a",6),e.bIt("click",function(){return e.eBV(l),e.Njj(i.addAllItems())}),e.nrm(7,"i",7),e.j41(8,"span"),e.EFF(9),e.nI1(10,"translate"),e.k0s()()(),e.j41(11,"div",8),e.nrm(12,"ngx-ui-loader",9),e.j41(13,"div",10)(14,"p-table",11,0),e.DNE(16,ka,11,0,"ng-template",12)(17,Vi,12,8,"ng-template",13),e.k0s()(),e.DNE(18,Fa,2,0,"div",14),e.j41(19,"div",15),e.DNE(20,Vr,6,3,"div",16),e.j41(21,"div",17)(22,"a",18),e.bIt("click",function(){return e.eBV(l),e.Njj(i.back())}),e.nrm(23,"i",19),e.j41(24,"span"),e.EFF(25),e.nI1(26,"translate"),e.k0s()()()()()()()()}2&s&&(e.FS9("title",e.bMT(1,11,i.title)),e.Y8G("breadcrumbItems",i.breadCrumbItems),e.R7$(9),e.JRh(e.bMT(10,13,"sales.priceList.UpdateItems")),e.R7$(3),e.Y8G("hasProgressBar",!1)("fgsType",i.loaderSearchShap)("loaderId",i.searchLoader),e.R7$(2),e.Y8G("value",i.form)("rows",null==i.form?null:i.form.length),e.R7$(4),e.Y8G("ngIf",(null==i.form?null:i.form.length)<=0),e.R7$(2),e.Y8G("ngIf",(null==i.form?null:i.form.length)>0),e.R7$(5),e.JRh(e.bMT(26,15,"general.action.back")))},dependencies:[k.bT,g.me,g.Q0,g.BC,g.vS,ni.m,O.Mm,Y.XI,Te.Ei,X.Cv,O.D9],encapsulation:2})}}return a})();const an=a=>({"is-invalid":a}),Ma=(a,u)=>({left:a,top:u}),Ld=(a,u)=>({"text-success":a,"text-danger":u});function Oa(a,u){1&a&&(e.j41(0,"div",51),e.EFF(1," Order number is required "),e.k0s())}function Vd(a,u){1&a&&(e.j41(0,"div",51),e.EFF(1," Order date is required "),e.k0s())}function Pd(a,u){if(1&a&&(e.j41(0,"div",52),e.nrm(1,"img",53),e.j41(2,"div"),e.EFF(3),e.k0s()()),2&a){const t=u.item;e.R7$(),e.Y8G("src",(null==t?null:t.imgUrl)||"https://via.placeholder.com/30",e.B4B),e.R7$(2),e.JRh(null==t?null:t.name)}}function Pt(a,u){1&a&&e.EFF(0),2&a&&e.SpI(" ",u.item.category||"Unnamed category"," ")}function Pr(a,u){if(1&a&&(e.j41(0,"div",52),e.nrm(1,"img",53),e.j41(2,"div")(3,"strong"),e.EFF(4),e.k0s(),e.j41(5,"div",54),e.EFF(6),e.k0s()()()),2&a){const t=u.item;e.R7$(),e.Y8G("src",t.imgUrl||"https://via.placeholder.com/30",e.B4B),e.R7$(3),e.JRh(t.name),e.R7$(2),e.Lme("",t.category," \u2022 ",t.email,"")}}function Br(a,u){1&a&&(e.j41(0,"div",51),e.EFF(1," Customer is required "),e.k0s())}function $r(a,u){if(1&a&&(e.j41(0,"strong"),e.EFF(1),e.k0s()),2&a){const t=u.item;e.R7$(),e.JRh(t.pcategory||"Uncategorized")}}function Pi(a,u){1&a&&(e.j41(0,"span"),e.nrm(1,"i",77),e.EFF(2," Available"),e.k0s())}function kn(a,u){1&a&&(e.j41(0,"span"),e.nrm(1,"i",78),e.EFF(2," Out of stock"),e.k0s())}function L(a,u){if(1&a&&(e.j41(0,"div",79),e.EFF(1),e.k0s()),2&a){const t=e.XpG().item;e.R7$(),e.SpI(" ",t.description," ")}}function Bi(a,u){if(1&a&&(e.j41(0,"div",67),e.nrm(1,"img",68),e.j41(2,"div",69)(3,"div",70),e.EFF(4),e.k0s(),e.j41(5,"div",71)(6,"span"),e.nrm(7,"i",72),e.EFF(8),e.nI1(9,"currency"),e.k0s(),e.j41(10,"span"),e.nrm(11,"i",73),e.EFF(12),e.k0s(),e.j41(13,"span"),e.nrm(14,"i",74),e.EFF(15),e.k0s(),e.DNE(16,Pi,3,0,"span",75)(17,kn,3,0,"span",75),e.k0s(),e.DNE(18,L,2,1,"div",76),e.k0s()()),2&a){const t=u.item;e.R7$(),e.Y8G("src",t.imgUrl||"assets/images/default-product.png",e.B4B)("alt",t.name),e.R7$(3),e.JRh(t.name),e.R7$(4),e.SpI(" ",e.ii3(9,9,t.price,"SAR","symbol","1.2-2"),""),e.R7$(4),e.SpI(" ",t.pcategory,""),e.R7$(3),e.SpI(" Stock: ",t.stock,""),e.R7$(),e.Y8G("ngIf",t.available),e.R7$(),e.Y8G("ngIf",!t.available),e.R7$(),e.Y8G("ngIf",t.description)}}function Xr(a,u){if(1&a&&(e.j41(0,"div",52),e.nrm(1,"img",80),e.j41(2,"span"),e.EFF(3),e.k0s()()),2&a){const t=u.item,s=e.XpG(2);e.R7$(),e.Y8G("src",s.getProductImage(t),e.B4B),e.R7$(2),e.JRh(s.getProductName(t))}}function un(a,u){1&a&&(e.j41(0,"div",51),e.EFF(1," Product is required "),e.k0s())}function Bd(a,u){if(1&a&&(e.j41(0,"option",83),e.EFF(1),e.k0s()),2&a){let t;const s=u.$implicit,i=e.XpG(2).$implicit,l=e.XpG();e.Y8G("value",s.name),e.R7$(),e.E5c(" ",s.name," (",s.conversionRate," ",l.getProductBaseUnit(null==(t=i.get("product"))?null:t.value),") ")}}function Ar(a,u){if(1&a&&(e.j41(0,"select",81),e.DNE(1,Bd,2,4,"option",82),e.k0s()),2&a){let t,s;const i=e.XpG().$implicit,l=e.XpG();e.Y8G("ngClass",e.eq3(2,an,(null==(t=i.get("unit"))?null:t.invalid)&&(null==(t=i.get("unit"))?null:t.touched))),e.R7$(),e.Y8G("ngForOf",l.getProductUnits(null==(s=i.get("product"))?null:s.value))}}function wa(a,u){1&a&&(e.j41(0,"div",51),e.EFF(1," Unit is required "),e.k0s())}function Ve(a,u){1&a&&(e.j41(0,"div",51),e.EFF(1," Quantity must be at least 1 "),e.k0s())}function $d(a,u){if(1&a&&(e.j41(0,"small",84),e.EFF(1),e.k0s()),2&a){const t=e.XpG().index,s=e.XpG();e.R7$(),e.SpI(" Max: ",s.getMaxQuantity(t)," available ")}}function Xd(a,u){1&a&&(e.j41(0,"div",51),e.EFF(1," Discount must be between 0 and 100 "),e.k0s())}function Na(a,u){if(1&a){const t=e.RV6();e.j41(0,"tr",55)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td")(4,"ng-select",56),e.bIt("mouseenter",function(i){let l;const m=e.eBV(t).$implicit,c=e.XpG();return e.Njj((null==(l=m.get("product"))?null:l.value)&&c.showProductPopup(null==(l=m.get("product"))?null:l.value,i))})("mouseleave",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.hideProductPopup())}),e.DNE(5,$r,2,1,"ng-template",18)(6,Bi,19,14,"ng-template",19)(7,Xr,4,2,"ng-template",17),e.k0s(),e.DNE(8,un,2,0,"div",11),e.k0s(),e.j41(9,"td"),e.DNE(10,Ar,2,4,"select",57)(11,wa,2,0,"div",11),e.k0s(),e.j41(12,"td")(13,"div",58)(14,"span",59),e.EFF(15,"\u0631\u064a\u0627\u0644"),e.k0s(),e.nrm(16,"input",60),e.k0s()(),e.j41(17,"td"),e.nrm(18,"input",61),e.DNE(19,Ve,2,0,"div",11)(20,$d,2,1,"small",62),e.k0s(),e.j41(21,"td")(22,"div",58),e.nrm(23,"input",63),e.j41(24,"span",59),e.EFF(25,"%"),e.k0s()(),e.DNE(26,Xd,2,0,"div",11),e.k0s(),e.j41(27,"td")(28,"div",58)(29,"span",59),e.EFF(30,"\u0631\u064a\u0627\u0644"),e.k0s(),e.nrm(31,"input",64),e.k0s()(),e.j41(32,"td")(33,"button",65),e.bIt("click",function(){const i=e.eBV(t).index,l=e.XpG();return e.Njj(l.removeItem(i))}),e.nrm(34,"i",66),e.k0s()()()}if(2&a){let t,s,i,l,m,c,E,P,q;const D=u.$implicit,J=u.index,ee=e.XpG();e.Y8G("formGroupName",J),e.R7$(2),e.JRh(J+1),e.R7$(2),e.Mz_("id","product-",J,""),e.Y8G("items",ee.availableProducts)("searchable",!0)("ngClass",e.eq3(16,an,(null==(t=D.get("product"))?null:t.invalid)&&(null==(t=D.get("product"))?null:t.touched))),e.R7$(4),e.Y8G("ngIf",(null==(s=D.get("product"))?null:s.invalid)&&(null==(s=D.get("product"))?null:s.touched)),e.R7$(2),e.Y8G("ngIf",null==(i=D.get("product"))?null:i.value),e.R7$(),e.Y8G("ngIf",(null==(l=D.get("unit"))?null:l.invalid)&&(null==(l=D.get("unit"))?null:l.touched)),e.R7$(7),e.Y8G("ngClass",e.eq3(18,an,(null==(m=D.get("quantity"))?null:m.invalid)&&(null==(m=D.get("quantity"))?null:m.touched))),e.R7$(),e.Y8G("ngIf",(null==(c=D.get("quantity"))?null:c.invalid)&&(null==(c=D.get("quantity"))?null:c.touched)),e.R7$(),e.Y8G("ngIf",null==(E=D.get("product"))?null:E.value),e.R7$(3),e.Y8G("ngClass",e.eq3(20,an,(null==(P=D.get("discount"))?null:P.invalid)&&(null==(P=D.get("discount"))?null:P.touched))),e.R7$(3),e.Y8G("ngIf",(null==(q=D.get("discount"))?null:q.invalid)&&(null==(q=D.get("discount"))?null:q.touched)),e.R7$(7),e.Y8G("disabled",1===ee.itemsFormArray.length)}}function Ad(a,u){if(1&a&&(e.j41(0,"p")(1,"strong"),e.EFF(2,"Description:"),e.k0s(),e.EFF(3),e.k0s()),2&a){const t=e.XpG(2);e.R7$(3),e.SpI(" ",t.hoveredProduct.description,"")}}function Ea(a,u){if(1&a&&(e.j41(0,"div",85)(1,"div",86)(2,"div",87),e.nrm(3,"img",88),e.j41(4,"h5"),e.EFF(5),e.k0s()(),e.j41(6,"div",89)(7,"p")(8,"strong"),e.EFF(9,"Category:"),e.k0s(),e.EFF(10),e.k0s(),e.j41(11,"p")(12,"strong"),e.EFF(13,"Price:"),e.k0s(),e.EFF(14),e.nI1(15,"currency"),e.k0s(),e.j41(16,"p")(17,"strong"),e.EFF(18,"Stock:"),e.k0s(),e.EFF(19),e.k0s(),e.j41(20,"p")(21,"strong"),e.EFF(22,"Status:"),e.k0s(),e.j41(23,"span",90),e.EFF(24),e.k0s()(),e.DNE(25,Ad,4,1,"p",75),e.k0s()()()),2&a){const t=e.XpG();e.Y8G("ngStyle",e.l_i(16,Ma,t.popupPosition.x+"px",t.popupPosition.y+"px")),e.R7$(3),e.Y8G("src",t.hoveredProduct.imgUrl||"assets/images/default-product.png",e.B4B)("alt",t.hoveredProduct.name),e.R7$(2),e.JRh(t.hoveredProduct.name),e.R7$(5),e.SpI(" ",t.hoveredProduct.pcategory,""),e.R7$(4),e.SpI(" ",e.ii3(15,11,t.hoveredProduct.price,"SAR","symbol","1.2-2"),""),e.R7$(5),e.Lme(" ",t.hoveredProduct.stock," ",t.getProductBaseUnit(t.hoveredProduct.id),""),e.R7$(4),e.Y8G("ngClass",e.l_i(19,Ld,t.hoveredProduct.available,!t.hoveredProduct.available)),e.R7$(),e.SpI(" ",t.hoveredProduct.available?"Available":"Out of stock"," "),e.R7$(),e.Y8G("ngIf",t.hoveredProduct.description)}}const Yd=[{path:"sales-orders",component:Ys,canActivate:[Nt.g],data:{permission:["salesOrder.view"]}},{path:"setting",component:jo,canActivate:[Nt.g],data:{permission:["salesSetting.view"]}},{path:"new",component:ao},{path:"sales-invoices",component:cd,resolve:{data:Ks},canActivate:[Nt.g],data:{permission:["salesInvoices.view"]}},{path:"Client-Collections",component:bd,resolve:{data:wd},canActivate:[Nt.g],data:{permission:["clientCollection.view"]}},{path:"Requests-Limit",component:pa,resolve:{data:(()=>{class a extends tn.E{constructor(t,s,i){super(t,s,i)}static{this.\u0275fac=function(s){return new(s||a)(e.KVO(A.Ix),e.KVO(Ui),e.KVO(le.u))}}static{this.\u0275prov=e.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})()},canActivate:[Nt.g],data:{permission:["requestPersonSales.view"]}},{path:"Prices-List",component:Od,resolve:{data:(()=>{class a extends tn.E{constructor(t,s,i){super(t,s,i)}static{this.\u0275fac=function(s){return new(s||a)(e.KVO(A.Ix),e.KVO(wi),e.KVO(le.u))}}static{this.\u0275prov=e.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})()},canActivate:[Nt.g],data:{permission:["priceList.view"]}},{path:"PriceListItems/:id",component:Dd,canActivate:[Nt.g],data:{permission:["priceList.view"]}},{path:"assign-truck-orders",component:Li,canActivate:[Nt.g],data:{permission:["assignTruckOrder.view"]}},{path:"sales-order",component:(()=>{class a{onCustomerChange(t){this.selectedCustomer=this.customers.find(s=>s.id===t)||null}constructor(t){this.fb=t,this.selectedCustomer=null,this.customers=[],this.availableProducts=[],this.products=[],this.subtotal=0,this.tax=0,this.total=0,this.taxRate=.15,this.isSubmitting=!1,this.hoveredProduct=null,this.popupPosition={x:0,y:0},this.salesOrderForm=this.fb.group({orderNumber:["",g.k0.required],orderDate:[(new Date).toISOString().split("T")[0],g.k0.required],customer:[null,g.k0.required],items:this.fb.array([]),notes:[""]})}ngOnInit(){this.loadCustomers(),this.loadProducts(),console.log("Available customers:",this.products),this.addItem(),this.salesOrderForm.get("items")?.valueChanges.subscribe(()=>{this.calculateTotals()})}updateAvailableProducts(){this.availableProducts=this.products.filter(t=>t.available)}saveAndSend(){if(this.salesOrderForm.valid){const s={...this.salesOrderForm.getRawValue(),status:"sent",subtotal:this.subtotal,tax:this.tax,total:this.total};console.log("Submitting order:",s),alert("Order submitted and sent successfully!")}else this.markFormGroupTouched(this.salesOrderForm)}loadCustomers(){this.customers=[{id:1,name:"Acme Corporation",email:"contact@acme.com",address:"123 Main St, Anytown, USA",category:"Retail",imgUrl:"assets/images/logo-sm.png"},{id:2,name:"Globex Industries",email:"info@globex.com",address:"456 Commerce Ave, Business City, USA",category:"Wholesale",imgUrl:"assets/images/departments.png"},{id:3,name:"Tech Solutions Inc",email:"sales@techsolutions.com",address:"789 Innovation Blvd, Tech Valley, USA",category:"Corporate",imgUrl:"assets/images/logo-sm-1.png"}]}loadProducts(){this.products=[{id:1,name:"Product A",price:19.99,description:"Basic product",available:!0,stock:100,pcategory:"Electronics",baseUnit:"pcs",units:[{name:"pcs",conversionRate:1,isBaseUnit:!0},{name:"pack",conversionRate:10},{name:"box",conversionRate:50},{name:"pallet",conversionRate:500}],imgUrl:"https://media.zid.store/thumbs/f6895258-871b-4ec3-afec-a565de547b6b/05fe7e80-4bbb-4953-bb72-d05c4a0c1325-thumbnail-500x500-70.webp",priceList:{Retail:19.99,Wholesale:15.99,Corporate:17.99}},{id:2,name:"Product B",price:49.99,description:"Premium product",available:!0,stock:50,pcategory:"Electronics",baseUnit:"box",units:[{name:"pcs",conversionRate:1},{name:"pack",conversionRate:10,isBaseUnit:!0},{name:"box",conversionRate:50},{name:"pallet",conversionRate:500}],imgUrl:"https://media.zid.store/f6895258-871b-4ec3-afec-a565de547b6b/f28ac85f-8f76-4fdf-a94d-2a6f0da0cc2a.webp",priceList:{Retail:49.99,Wholesale:39.99,Corporate:44.99}}],this.updateAvailableProducts()}get itemsFormArray(){return this.salesOrderForm.get("items")}addItem(){const t=this.fb.group({product:[null,g.k0.required],unit:[null,g.k0.required],quantity:[1,[g.k0.required,g.k0.min(1)]],price:[{value:0,disabled:!0}],discount:[0,[g.k0.min(0),g.k0.max(100)]],lineTotal:[{value:0,disabled:!0}]});t.get("product")?.valueChanges.subscribe(s=>{if(s){const i=this.products.find(l=>l.id===s);i&&(t.get("unit")?.setValue(i.baseUnit),this.updatePriceForCustomer(t,i),t.get("quantity")?.setValue(1),this.updateLineTotal(t))}}),this.salesOrderForm.get("customer")?.valueChanges.subscribe(()=>{const s=t.get("product")?.value;if(s){const i=this.products.find(l=>l.id===s);i&&(this.updatePriceForCustomer(t,i),this.updateLineTotal(t))}}),t.get("quantity")?.valueChanges.subscribe(()=>this.updateLineTotal(t)),t.get("discount")?.valueChanges.subscribe(()=>this.updateLineTotal(t)),this.itemsFormArray.push(t)}removeItem(t){this.itemsFormArray.removeAt(t)}updatePriceForCustomer(t,s){const i=this.salesOrderForm.get("customer")?.value;if(i){const l=this.customers.find(m=>m.id===i);if(l&&s.priceList){const m=s.priceList[l.category];if(void 0!==m)return void t.get("price")?.setValue(m)}}t.get("price")?.setValue(s.price)}updateLineTotal(t){const s=t.get("product")?.value,i=t.get("unit")?.value,l=t.get("quantity")?.value||0,m=t.get("discount")?.value||0,c=this.salesOrderForm.get("customer")?.value;if(s&&c&&i){const E=this.products.find(D=>D.id===s),P=this.customers.find(D=>D.id===c),q=this.getSelectedUnitConversionRate(s,i);if(E&&P){let D=E.price;E.priceList&&P.category&&(D=E.priceList[P.category]||D);const J=D*q,ee=l*q,Q=J*l-J*l*(m/100);t.get("price")?.setValue(J),t.get("lineTotal")?.setValue(Q),t.get("baseUnitQuantity")?.setValue(ee),this.calculateTotals()}}}calculateTotals(){this.subtotal=0,this.itemsFormArray.controls.forEach(t=>{const s=t.get("lineTotal")?.value||0;this.subtotal+=s}),this.tax=this.subtotal*this.taxRate,this.total=this.subtotal+this.tax}markFormGroupTouched(t){Object.values(t.controls).forEach(s=>{s.markAsTouched(),s instanceof g.gE?this.markFormGroupTouched(s):s instanceof g.Yp&&s.controls.forEach(i=>{i instanceof g.gE&&this.markFormGroupTouched(i)})})}resetForm(){for(this.salesOrderForm.reset({orderDate:(new Date).toISOString().split("T")[0]});this.itemsFormArray.length;)this.itemsFormArray.removeAt(0);this.addItem(),this.calculateTotals()}getAvailableProducts(){return console.log("Available products:",this.products.filter(t=>t.available)),this.products.filter(t=>t.available)}onProductChange(t,s){const l=t.target.value;l&&this.updateProductDetails(Number(l),s)}updateProductDetails(t,s){const i=this.products.find(l=>l.id===t);i&&(this.itemsFormArray.at(s).patchValue({price:i.price,quantity:1,lineTotal:i.price}),this.calculateTotals())}getMaxQuantity(t){const s=this.itemsFormArray.at(t),i=s.get("product")?.value,l=s.get("unit")?.value,m=this.products.find(P=>P.id===i);if(!m||!l)return 0;const c=this.getSelectedUnitConversionRate(i,l);return Math.floor(m.stock/c)}onQuantityChange(t,s){const l=parseInt(t.target.value),m=this.getMaxQuantity(s);l>m&&this.itemsFormArray.at(s).patchValue({quantity:m});const c=this.itemsFormArray.at(s);this.updateLineTotal(c)}saveAsDraft(){if(this.salesOrderForm.valid){const s={...this.salesOrderForm.getRawValue(),status:"draft",subtotal:this.subtotal,tax:this.tax,total:this.total};console.log("Saving as draft:",s),alert("Order saved as draft successfully!")}else this.markFormGroupTouched(this.salesOrderForm)}onSubmit(){if(this.salesOrderForm.valid){const s={...this.salesOrderForm.getRawValue(),status:"sent",subtotal:this.subtotal,tax:this.tax,total:this.total};console.log("Submitting order:",s),alert("Order submitted and sent successfully!")}else this.markFormGroupTouched(this.salesOrderForm)}getProductImage(t){return t?"object"==typeof t?t.imgUrl||"assets/images/default-product.png":this.products.find(i=>i.id===t)?.imgUrl||"assets/images/default-product.png":"assets/images/default-product.png"}getProductName(t){return t?"object"==typeof t?t.name:this.products.find(i=>i.id===t)?.name||"":""}getProductUnits(t){return this.products.find(i=>i.id===t)?.units||[]}getProductBaseUnit(t){return this.products.find(i=>i.id===t)?.baseUnit||""}getSelectedUnitConversionRate(t,s){return this.products.find(m=>m.id===t)?.units.find(m=>m.name===s)?.conversionRate||1}showProductPopup(t,s){const i=this.products.find(l=>l.id===t);i&&(this.hoveredProduct=i,this.popupPosition={x:s.clientX+15,y:s.clientY+15},this.popupTimeout&&clearTimeout(this.popupTimeout))}hideProductPopup(){this.popupTimeout=setTimeout(()=>{this.hoveredProduct=null},200)}clearPopupTimeout(){this.popupTimeout&&clearTimeout(this.popupTimeout)}static{this.\u0275fac=function(s){return new(s||a)(e.rXU(g.ok))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["app-sales-order"]],decls:103,vars:22,consts:[[1,"container-fluid","py-4"],[1,"card"],[1,"card-header","bg-primary-subtle","d-flex","justify-content-between","align-items-center"],[1,"mb-0"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"row","mb-4"],[1,"col-md-4"],[1,"form-floating","mb-3"],["type","text","id","orderNumber","formControlName","orderNumber","placeholder","Order Number",1,"form-control",3,"ngClass"],["for","orderNumber"],["class","invalid-feedback",4,"ngIf"],["type","date","id","orderDate","formControlName","orderDate","placeholder","Order Date",1,"form-control",3,"ngClass"],["for","orderDate"],[1,"col-md-6"],["for","customer"],["id","customer","formControlName","customer","bindLabel","name","bindValue","id","placeholder","Select customer","groupBy","category",3,"items","searchable","ngClass"],["ng-label-tmp",""],["ng-optgroup-tmp",""],["ng-option-tmp",""],[1,"card","mb-4"],[1,"card-header","bg-light","d-flex","justify-content-between","align-items-center"],["type","button",1,"btn","btn-success",3,"click"],[1,"bi","bi-plus-circle"],[1,"card-body","p-0"],[1,"table-responsive"],[1,"table","table-striped","table-hover","mb-0"],[1,"table-light"],[2,"width","5%"],[2,"width","25%"],[2,"width","10%"],[2,"width","15%"],["formArrayName","items"],[3,"formGroupName",4,"ngFor","ngForOf"],[1,"form-floating"],["id","notes","formControlName","notes","placeholder","Notes",1,"form-control",2,"height","150px"],["for","notes"],[1,"card-header","bg-light"],[1,"d-flex","justify-content-between","mb-2"],[1,"d-flex","justify-content-between"],[1,"d-flex","justify-content-end","gap-2"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"bi","bi-arrow-counterclockwise"],["ngbDropdown","",1,"btn-group"],["type","button","ngbDropdownToggle","",1,"btn","btn-primary","dropdown-toggle","dropdown-toggle-split",3,"disabled"],[1,"ri-mail-send-fill"],["ngbDropdownMenu",""],["ngbDropdownItem","","href","#",3,"click"],[1,"ri-save-2-line","me-2"],[1,"ri-mail-send-line","me-2"],["class","product-popup",3,"ngStyle",4,"ngIf"],[1,"invalid-feedback"],[1,"d-flex","align-items-center"],["width","30","height","30",1,"rounded-circle","me-2",3,"src"],[1,"text-muted","small"],[3,"formGroupName"],["formControlName","product","bindLabel","name","bindValue","id","placeholder","Select product","groupBy","pcategory","appendTo","body",1,"full-width-dropdown","auto-grow",3,"mouseenter","mouseleave","items","searchable","ngClass","id"],["formControlName","unit","class","form-select",3,"ngClass",4,"ngIf"],[1,"input-group"],[1,"input-group-text"],["type","number","formControlName","price","readonly","",1,"form-control"],["type","number","formControlName","quantity","min","1",1,"form-control",3,"ngClass"],["class","text-muted",4,"ngIf"],["type","number","formControlName","discount","min","0","max","100",1,"form-control",3,"ngClass"],["type","number","formControlName","lineTotal","readonly","",1,"form-control"],["type","button",1,"btn","btn-sm","btn-danger",3,"click","disabled"],[1,"ri-delete-bin-line","trash-icon"],[1,"product-option"],[3,"src","alt"],[1,"product-option-details"],[1,"product-option-name"],[1,"product-option-meta"],[1,"ri-money-dollar-circle-line"],[1,"ri-price-tag-3-line"],[1,"ri-stack-line"],[4,"ngIf"],["class","text-muted mt-2",4,"ngIf"],[1,"ri-checkbox-circle-line","text-success"],[1,"ri-close-circle-line","text-danger"],[1,"text-muted","mt-2"],["width","24","height","24",1,"me-2","rounded",3,"src"],["formControlName","unit",1,"form-select",3,"ngClass"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"text-muted"],[1,"product-popup",3,"ngStyle"],[1,"popup-content"],[1,"popup-header"],[1,"popup-img",3,"src","alt"],[1,"popup-body"],[3,"ngClass"]],template:function(s,i){if(1&s&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),e.EFF(4,"New Sales Order"),e.k0s()(),e.j41(5,"div",4)(6,"form",5),e.bIt("ngSubmit",function(){return i.onSubmit()}),e.j41(7,"div",6)(8,"div",7)(9,"div",8),e.nrm(10,"input",9),e.j41(11,"label",10),e.EFF(12,"Order Number"),e.k0s(),e.DNE(13,Oa,2,0,"div",11),e.k0s()(),e.j41(14,"div",7)(15,"div",8),e.nrm(16,"input",12),e.j41(17,"label",13),e.EFF(18,"Order Date"),e.k0s(),e.DNE(19,Vd,2,0,"div",11),e.k0s()()(),e.j41(20,"div",14)(21,"label",15),e.EFF(22,"Customer"),e.k0s(),e.j41(23,"div",8)(24,"ng-select",16),e.DNE(25,Pd,4,2,"ng-template",17)(26,Pt,1,1,"ng-template",18)(27,Pr,7,4,"ng-template",19),e.k0s(),e.DNE(28,Br,2,0,"div",11),e.k0s()(),e.j41(29,"div",20)(30,"div",21)(31,"h4",3),e.EFF(32,"Order Items"),e.k0s(),e.j41(33,"button",22),e.bIt("click",function(){return i.addItem()}),e.nrm(34,"i",23),e.EFF(35," Add Item "),e.k0s()(),e.j41(36,"div",24)(37,"div",25)(38,"table",26)(39,"thead",27)(40,"tr")(41,"th",28),e.EFF(42,"#"),e.k0s(),e.j41(43,"th",29),e.EFF(44,"Product"),e.k0s(),e.j41(45,"th",30),e.EFF(46,"Unit"),e.k0s(),e.j41(47,"th",31),e.EFF(48,"Price"),e.k0s(),e.j41(49,"th",31),e.EFF(50,"Quantity"),e.k0s(),e.j41(51,"th",31),e.EFF(52,"Discount %"),e.k0s(),e.j41(53,"th",31),e.EFF(54,"Total"),e.k0s(),e.j41(55,"th",28),e.EFF(56,"Action"),e.k0s()()(),e.j41(57,"tbody",32),e.DNE(58,Na,35,22,"tr",33),e.k0s()()()()(),e.j41(59,"div",6)(60,"div",14)(61,"div",34),e.nrm(62,"textarea",35),e.j41(63,"label",36),e.EFF(64,"Order Notes"),e.k0s()()(),e.j41(65,"div",14)(66,"div",1)(67,"div",37)(68,"h4",3),e.EFF(69,"Order Summary"),e.k0s()(),e.j41(70,"div",4)(71,"div",38)(72,"span"),e.EFF(73,"Subtotal:"),e.k0s(),e.j41(74,"span"),e.EFF(75),e.k0s()(),e.j41(76,"div",38)(77,"span"),e.EFF(78),e.k0s(),e.j41(79,"span"),e.EFF(80),e.k0s()(),e.nrm(81,"hr"),e.j41(82,"div",39)(83,"strong"),e.EFF(84,"Total:"),e.k0s(),e.j41(85,"strong"),e.EFF(86),e.k0s()()()()()(),e.j41(87,"div",40)(88,"button",41),e.bIt("click",function(){return i.resetForm()}),e.nrm(89,"i",42),e.EFF(90," Reset "),e.k0s(),e.j41(91,"div",43)(92,"button",44),e.nrm(93,"i",45),e.EFF(94," Save "),e.k0s(),e.j41(95,"div",46)(96,"a",47),e.bIt("click",function(m){return i.saveAsDraft(),m.preventDefault()}),e.nrm(97,"i",48),e.EFF(98," Save as Draft "),e.k0s(),e.j41(99,"a",47),e.bIt("click",function(m){return i.saveAndSend(),m.preventDefault()}),e.nrm(100,"i",49),e.EFF(101," Save & Send "),e.k0s()()()()()()()(),e.DNE(102,Ea,26,22,"div",50)),2&s){let l,m,c,E,P,q;e.R7$(6),e.Y8G("formGroup",i.salesOrderForm),e.R7$(4),e.Y8G("ngClass",e.eq3(16,an,(null==(l=i.salesOrderForm.get("orderNumber"))?null:l.invalid)&&(null==(l=i.salesOrderForm.get("orderNumber"))?null:l.touched))),e.R7$(3),e.Y8G("ngIf",(null==(m=i.salesOrderForm.get("orderNumber"))?null:m.invalid)&&(null==(m=i.salesOrderForm.get("orderNumber"))?null:m.touched)),e.R7$(3),e.Y8G("ngClass",e.eq3(18,an,(null==(c=i.salesOrderForm.get("orderDate"))?null:c.invalid)&&(null==(c=i.salesOrderForm.get("orderDate"))?null:c.touched))),e.R7$(3),e.Y8G("ngIf",(null==(E=i.salesOrderForm.get("orderDate"))?null:E.invalid)&&(null==(E=i.salesOrderForm.get("orderDate"))?null:E.touched)),e.R7$(5),e.Y8G("items",i.customers)("searchable",!0)("ngClass",e.eq3(20,an,(null==(P=i.salesOrderForm.get("customer"))?null:P.invalid)&&(null==(P=i.salesOrderForm.get("customer"))?null:P.touched))),e.R7$(4),e.Y8G("ngIf",(null==(q=i.salesOrderForm.get("customer"))?null:q.invalid)&&(null==(q=i.salesOrderForm.get("customer"))?null:q.touched)),e.R7$(30),e.Y8G("ngForOf",i.itemsFormArray.controls),e.R7$(17),e.SpI("\u0631\u064a\u0627\u0644",i.subtotal.toFixed(2),""),e.R7$(3),e.SpI("Tax (",(100*i.taxRate).toFixed(0),"%):"),e.R7$(2),e.SpI("\u0631\u064a\u0627\u0644",i.tax.toFixed(2),""),e.R7$(6),e.SpI("\u0631\u064a\u0627\u0644",i.total.toFixed(2),""),e.R7$(6),e.Y8G("disabled",i.salesOrderForm.invalid),e.R7$(10),e.Y8G("ngIf",i.hoveredProduct)}},dependencies:[k.YU,k.Sq,k.bT,k.B3,g.qT,g.xH,g.y7,g.me,g.Q0,g.wz,g.BC,g.cb,g.VZ,g.zX,F.tg,F.do,F.U0,F._H,fe.vr,fe.bh,fe.Uq,fe.ZZ,g.j4,g.JD,g.$R,g.v8,k.oe],styles:['@media (max-width: 768px){.table-responsive[_ngcontent-%COMP%]{overflow-x:auto;-webkit-overflow-scrolling:touch}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(3):before{content:"Unit:"}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(3)   select[_ngcontent-%COMP%]{width:100%}.table[_ngcontent-%COMP%]{width:100%;margin-bottom:1rem;display:block}.table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{display:none}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]{display:block;width:100%}.table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{display:block;margin-bottom:1rem;border:1px solid #dee2e6;border-radius:.25rem}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:.75rem;border-bottom:1px solid #dee2e6}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:before{content:attr(data-label);font-weight:700;margin-right:1rem;flex:1}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{border-bottom:0}td[formGroupName][_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:2}}.btn-group[_ngcontent-%COMP%]{margin-left:10px}.dropdown-toggle-split[_ngcontent-%COMP%]{padding-left:.5rem;padding-right:.5rem}.dropdown-item[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;padding:.5rem 1rem}.dropdown-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem;margin-right:.5rem}.btn-primary[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.ng-dropdown-panel[_ngcontent-%COMP%]{width:auto!important;min-width:100%}.ng-dropdown-panel[_ngcontent-%COMP%]   .ng-option[_ngcontent-%COMP%]{white-space:normal!important}.ng-select.product-select[_ngcontent-%COMP%]   .ng-dropdown-panel[_ngcontent-%COMP%]{width:600px!important;max-width:100vw;left:0!important}.product-option[_ngcontent-%COMP%]{display:flex;align-items:center;padding:8px}.product-option-name[_ngcontent-%COMP%]{font-weight:700;margin-bottom:4px}.product-option-meta[_ngcontent-%COMP%]{font-size:.85em;color:#666}@media (max-width: 768px){.ng-select.product-select[_ngcontent-%COMP%]   .ng-dropdown-panel[_ngcontent-%COMP%]{width:100%!important;left:0!important}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(3):before{content:"Unit:"}.product-option[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.product-option[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}}.full-width-dropdown[_ngcontent-%COMP%]   .ng-dropdown-panel[_ngcontent-%COMP%]{left:0!important;margin-left:-16px;max-width:max-content!important;position:fixed!important;top:auto!important;bottom:auto!important}.full-width-dropdown[_ngcontent-%COMP%]   .ng-dropdown-panel[_ngcontent-%COMP%]   .ng-dropdown-panel-items[_ngcontent-%COMP%]{max-height:70vh!important}.product-option[_ngcontent-%COMP%]{display:flex;align-items:center;padding:12px;border-bottom:1px solid #f0f0f0}.product-option[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100px;height:100px;object-fit:contain;margin-right:15px;border-radius:4px;background:#f8f9fa}.product-option-details[_ngcontent-%COMP%]{flex:1}.product-option-name[_ngcontent-%COMP%]{font-weight:700;margin-bottom:5px;font-size:1.1rem}.product-option-meta[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px;font-size:.9em;color:#666}.product-option-meta[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:inline-flex;align-items:center}@media (max-width: 768px){.full-width-dropdown[_ngcontent-%COMP%]   .ng-dropdown-panel[_ngcontent-%COMP%]{margin-left:-12px!important}.product-option[_ngcontent-%COMP%]{padding:8px}.ng-select.auto-grow[_ngcontent-%COMP%]{display:flex!important}.ng-select.auto-grow[_ngcontent-%COMP%]   .ng-select-container[_ngcontent-%COMP%]{min-width:250px!important;width:auto!important}.ng-select.auto-grow[_ngcontent-%COMP%]   .ng-dropdown-panel[_ngcontent-%COMP%]{width:auto!important}.product-option[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%!important;height:100%!important;object-fit:cover}}@media (min-width: 769px){.full-width-dropdown[_ngcontent-%COMP%]   .ng-dropdown-panel[_ngcontent-%COMP%]{width:100%!important;min-width:100%!important;left:0!important;margin-left:0!important;position:absolute!important;top:100%!important;transform:none!important;box-shadow:0 5px 10px #0000001a;border:1px solid #ddd;border-top:none;border-radius:0 0 4px 4px}.ng-select.auto-grow[_ngcontent-%COMP%]{display:flex!important}.ng-select.auto-grow[_ngcontent-%COMP%]   .ng-select-container[_ngcontent-%COMP%]{min-width:350px!important;width:auto!important}.ng-select.auto-grow[_ngcontent-%COMP%]   .ng-dropdown-panel[_ngcontent-%COMP%]{width:auto!important}.full-width-dropdown[_ngcontent-%COMP%]   .ng-dropdown-panel[_ngcontent-%COMP%]   .ng-dropdown-panel-items[_ngcontent-%COMP%]{max-height:400px!important;overflow-y:auto}.product-option[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:150px;height:150px;object-fit:cover;margin-right:15px;border-radius:4px}}.product-popup[_ngcontent-%COMP%]{position:fixed;z-index:1050;width:300px;background:#fff;border:1px solid #ddd;border-radius:5px;box-shadow:0 5px 15px #0003;pointer-events:none;transition:opacity .3s}.popup-content[_ngcontent-%COMP%]{padding:15px}.popup-header[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:10px;border-bottom:1px solid #eee;padding-bottom:10px}.popup-header[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin:0 0 0 10px;font-size:1.1rem}.popup-img[_ngcontent-%COMP%]{width:100px;height:100px;object-fit:contain;border-radius:4px;border:1px solid #eee}.popup-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:5px;font-size:.9rem}.popup-body[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{display:inline-block;width:80px}@media (max-width: 768px){.product-popup[_ngcontent-%COMP%]{display:none}}']})}}return a})(),canActivate:[Nt.g],data:{permission:["assignTruckOrder.view"]}}];let qd=(()=>{class a{static{this.\u0275fac=function(s){return new(s||a)}}static{this.\u0275mod=e.$C({type:a})}static{this.\u0275inj=e.G2t({imports:[A.iI.forChild(Yd),A.iI]})}}return a})();var Bt=x(71144),Ae=x(81141),Ur=x(41198);let Qd=(()=>{class a{constructor(){(0,ce.eV)(Ie().loadAnimation)}static{this.\u0275fac=function(s){return new(s||a)}}static{this.\u0275mod=e.$C({type:a})}static{this.\u0275inj=e.G2t({imports:[k.MD,g.YN,F.zH,F.Pv,F.c9,Ce.ND,Ut.r,qd,on.G,O.h,Y.bG,Qr.q4,Yt.H_,F.c9,X.th,fe.MQ,F.n8,Bt.j,F._f,gt.S,Zt.U,Ae.tm,Ur.TV,g.X1]})}}return a})()},67376:function(Mt,tt,x){var k;Mt=x.nmd(Mt),function(){var g,ce="Expected a function",Ie="__lodash_hash_undefined__",O="__lodash_placeholder__",le=1/0,Se=9007199254740991,ze=4294967295,Zn=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],it="[object Arguments]",ei="[object Array]",Rn="[object Boolean]",Mn="[object Date]",Ue="[object Error]",rt="[object Function]",zr="[object GeneratorFunction]",ht="[object Map]",On="[object Number]",wt="[object Object]",Hr="[object Promise]",wn="[object RegExp]",_t="[object Set]",Nn="[object String]",ti="[object Symbol]",En="[object WeakMap]",Gn="[object ArrayBuffer]",Te="[object DataView]",Yi="[object Float32Array]",qi="[object Float64Array]",Qi="[object Int8Array]",zi="[object Int16Array]",Hi="[object Int32Array]",Ji="[object Uint8Array]",Wi="[object Uint8ClampedArray]",Ki="[object Uint16Array]",Zi="[object Uint32Array]",Ha=/\b__p \+= '';/g,Ja=/\b(__p \+=) '' \+/g,Wa=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Wr=/&(?:amp|lt|gt|quot|#39);/g,Kr=/[&<>"']/g,Ka=RegExp(Wr.source),Za=RegExp(Kr.source),eo=/<%-([\s\S]+?)%>/g,to=/<%([\s\S]+?)%>/g,Zr=/<%=([\s\S]+?)%>/g,no=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,io=/^\w*$/,ro=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,er=/[\\^$.*+?()[\]{}|]/g,so=RegExp(er.source),tr=/^\s+/,ao=/\s/,Nt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ni=/\{\n\/\* \[wrapped with (.+)\] \*/,De=/,? & /,oo=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,He=/[()=,{}\[\]\/\s]/,It=/\\(\\)?/g,Ye=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,$e=/\w*$/,qe=/^[-+]0x[0-9a-f]+$/i,lo=/^0b[01]+$/i,co=/^\[object .+?Constructor\]$/,mo=/^0o[0-7]+$/i,po=/^(?:0|[1-9]\d*)$/,uo=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ii=/($^)/,go=/['\n\r\u2028\u2029\\]/g,ri="\\ud800-\\udfff",es="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",ts="\\u2700-\\u27bf",ns="a-z\\xdf-\\xf6\\xf8-\\xff",is="A-Z\\xc0-\\xd6\\xd8-\\xde",rs="\\ufe0e\\ufe0f",ss="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",jo="["+ri+"]",ft="["+ss+"]",Ht="["+es+"]",Et="\\d+",yo="["+ts+"]",as="["+ns+"]",os="[^"+ri+ss+Et+ts+ns+is+"]",ir="\\ud83c[\\udffb-\\udfff]",ls="[^"+ri+"]",rr="(?:\\ud83c[\\udde6-\\uddff]){2}",sr="[\\ud800-\\udbff][\\udc00-\\udfff]",Gt="["+is+"]",ds="(?:"+as+"|"+os+")",To="(?:"+Gt+"|"+os+")",cs="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",ms="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",ps="(?:"+Ht+"|"+ir+")?",us="["+rs+"]?",gs=us+ps+"(?:\\u200d(?:"+[ls,rr,sr].join("|")+")"+us+ps+")*",Fo="(?:"+[yo,rr,sr].join("|")+")"+gs,Ro="(?:"+[ls+Ht+"?",Ht,rr,sr,jo].join("|")+")",Mo=RegExp("['\u2019]","g"),Oo=RegExp(Ht,"g"),ar=RegExp(ir+"(?="+ir+")|"+Ro+gs,"g"),wo=RegExp([Gt+"?"+as+"+"+cs+"(?="+[ft,Gt,"$"].join("|")+")",To+"+"+ms+"(?="+[ft,Gt+ds,"$"].join("|")+")",Gt+"?"+ds+"+"+cs,Gt+"+"+ms,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Et,Fo].join("|"),"g"),No=RegExp("[\\u200d"+ri+es+rs+"]"),Eo=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Go=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Do=-1,ve={};ve[Yi]=ve[qi]=ve[Qi]=ve[zi]=ve[Hi]=ve[Ji]=ve[Wi]=ve[Ki]=ve[Zi]=!0,ve[it]=ve[ei]=ve[Gn]=ve[Rn]=ve[Te]=ve[Mn]=ve[Ue]=ve[rt]=ve[ht]=ve[On]=ve[wt]=ve[wn]=ve[_t]=ve[Nn]=ve[En]=!1;var be={};be[it]=be[ei]=be[Gn]=be[Te]=be[Rn]=be[Mn]=be[Yi]=be[qi]=be[Qi]=be[zi]=be[Hi]=be[ht]=be[On]=be[wt]=be[wn]=be[_t]=be[Nn]=be[ti]=be[Ji]=be[Wi]=be[Ki]=be[Zi]=!0,be[Ue]=be[rt]=be[En]=!1;var Vo={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Po=parseFloat,Bo=parseInt,hs="object"==typeof global&&global&&global.Object===Object&&global,$o="object"==typeof self&&self&&self.Object===Object&&self,Ne=hs||$o||Function("return this")(),_s=tt&&!tt.nodeType&&tt,Ln=_s&&Mt&&!Mt.nodeType&&Mt,fs=Ln&&Ln.exports===_s,lr=fs&&hs.process,st=function(){try{return Ln&&Ln.require&&Ln.require("util").types||lr&&lr.binding&&lr.binding("util")}catch{}}(),bs=st&&st.isArrayBuffer,vs=st&&st.isDate,Cs=st&&st.isMap,Ss=st&&st.isRegExp,js=st&&st.isSet,ys=st&&st.isTypedArray;function Je(v,j,S){switch(S.length){case 0:return v.call(j);case 1:return v.call(j,S[0]);case 2:return v.call(j,S[0],S[1]);case 3:return v.call(j,S[0],S[1],S[2])}return v.apply(j,S)}function Xo(v,j,S,w){for(var U=-1,de=null==v?0:v.length;++U<de;){var ke=v[U];j(w,ke,S(ke),v)}return w}function at(v,j){for(var S=-1,w=null==v?0:v.length;++S<w&&!1!==j(v[S],S,v););return v}function Ao(v,j){for(var S=null==v?0:v.length;S--&&!1!==j(v[S],S,v););return v}function Is(v,j){for(var S=-1,w=null==v?0:v.length;++S<w;)if(!j(v[S],S,v))return!1;return!0}function Jt(v,j){for(var S=-1,w=null==v?0:v.length,U=0,de=[];++S<w;){var ke=v[S];j(ke,S,v)&&(de[U++]=ke)}return de}function ai(v,j){return!(null==v||!v.length)&&bn(v,j,0)>-1}function dr(v,j,S){for(var w=-1,U=null==v?0:v.length;++w<U;)if(S(j,v[w]))return!0;return!1}function je(v,j){for(var S=-1,w=null==v?0:v.length,U=Array(w);++S<w;)U[S]=j(v[S],S,v);return U}function bt(v,j){for(var S=-1,w=j.length,U=v.length;++S<w;)v[U+S]=j[S];return v}function Vn(v,j,S,w){var U=-1,de=null==v?0:v.length;for(w&&de&&(S=v[++U]);++U<de;)S=j(S,v[U],U,v);return S}function oi(v,j,S,w){var U=null==v?0:v.length;for(w&&U&&(S=v[--U]);U--;)S=j(S,v[U],U,v);return S}function cr(v,j){for(var S=-1,w=null==v?0:v.length;++S<w;)if(j(v[S],S,v))return!0;return!1}var Uo=mr("length");function Ts(v,j,S){var w;return S(v,function(U,de,ke){if(j(U,de,ke))return w=de,!1}),w}function li(v,j,S,w){for(var U=v.length,de=S+(w?1:-1);w?de--:++de<U;)if(j(v[de],de,v))return de;return-1}function bn(v,j,S){return j==j?function il(v,j,S){for(var w=S-1,U=v.length;++w<U;)if(v[w]===j)return w;return-1}(v,j,S):li(v,xs,S)}function Qo(v,j,S,w){for(var U=S-1,de=v.length;++U<de;)if(w(v[U],j))return U;return-1}function xs(v){return v!=v}function ks(v,j){var S=null==v?0:v.length;return S?ur(v,j)/S:NaN}function mr(v){return function(j){return null==j?g:j[v]}}function pr(v){return function(j){return null==v?g:v[j]}}function Fs(v,j,S,w,U){return U(v,function(de,ke,_e){S=w?(w=!1,de):j(S,de,ke,_e)}),S}function ur(v,j){for(var S,w=-1,U=v.length;++w<U;){var de=j(v[w]);de!==g&&(S=S===g?de:S+de)}return S}function gr(v,j){for(var S=-1,w=Array(v);++S<v;)w[S]=j(S);return w}function Rs(v){return v&&v.slice(0,Es(v)+1).replace(tr,"")}function We(v){return function(j){return v(j)}}function hr(v,j){return je(j,function(S){return v[S]})}function Pn(v,j){return v.has(j)}function Ms(v,j){for(var S=-1,w=v.length;++S<w&&bn(j,v[S],0)>-1;);return S}function Os(v,j){for(var S=v.length;S--&&bn(j,v[S],0)>-1;);return S}var Wo=pr({\u00c0:"A",\u00c1:"A",\u00c2:"A",\u00c3:"A",\u00c4:"A",\u00c5:"A",\u00e0:"a",\u00e1:"a",\u00e2:"a",\u00e3:"a",\u00e4:"a",\u00e5:"a",\u00c7:"C",\u00e7:"c",\u00d0:"D",\u00f0:"d",\u00c8:"E",\u00c9:"E",\u00ca:"E",\u00cb:"E",\u00e8:"e",\u00e9:"e",\u00ea:"e",\u00eb:"e",\u00cc:"I",\u00cd:"I",\u00ce:"I",\u00cf:"I",\u00ec:"i",\u00ed:"i",\u00ee:"i",\u00ef:"i",\u00d1:"N",\u00f1:"n",\u00d2:"O",\u00d3:"O",\u00d4:"O",\u00d5:"O",\u00d6:"O",\u00d8:"O",\u00f2:"o",\u00f3:"o",\u00f4:"o",\u00f5:"o",\u00f6:"o",\u00f8:"o",\u00d9:"U",\u00da:"U",\u00db:"U",\u00dc:"U",\u00f9:"u",\u00fa:"u",\u00fb:"u",\u00fc:"u",\u00dd:"Y",\u00fd:"y",\u00ff:"y",\u00c6:"Ae",\u00e6:"ae",\u00de:"Th",\u00fe:"th",\u00df:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010a:"C",\u010c:"C",\u0107:"c",\u0109:"c",\u010b:"c",\u010d:"c",\u010e:"D",\u0110:"D",\u010f:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011a:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011b:"e",\u011c:"G",\u011e:"G",\u0120:"G",\u0122:"G",\u011d:"g",\u011f:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012a:"I",\u012c:"I",\u012e:"I",\u0130:"I",\u0129:"i",\u012b:"i",\u012d:"i",\u012f:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013b:"L",\u013d:"L",\u013f:"L",\u0141:"L",\u013a:"l",\u013c:"l",\u013e:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014a:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014b:"n",\u014c:"O",\u014e:"O",\u0150:"O",\u014d:"o",\u014f:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015a:"S",\u015c:"S",\u015e:"S",\u0160:"S",\u015b:"s",\u015d:"s",\u015f:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016a:"U",\u016c:"U",\u016e:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016b:"u",\u016d:"u",\u016f:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017b:"Z",\u017d:"Z",\u017a:"z",\u017c:"z",\u017e:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017f:"s"}),Ko=pr({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Zo(v){return"\\"+Vo[v]}function vn(v){return No.test(v)}function _r(v){var j=-1,S=Array(v.size);return v.forEach(function(w,U){S[++j]=[U,w]}),S}function Ns(v,j){return function(S){return v(j(S))}}function Wt(v,j){for(var S=-1,w=v.length,U=0,de=[];++S<w;){var ke=v[S];(ke===j||ke===O)&&(v[S]=O,de[U++]=S)}return de}function di(v){var j=-1,S=Array(v.size);return v.forEach(function(w){S[++j]=w}),S}function Cn(v){return vn(v)?function al(v){for(var j=ar.lastIndex=0;ar.test(v);)++j;return j}(v):Uo(v)}function vt(v){return vn(v)?function ol(v){return v.match(ar)||[]}(v):function Yo(v){return v.split("")}(v)}function Es(v){for(var j=v.length;j--&&ao.test(v.charAt(j)););return j}var sl=pr({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),ci=function v(j){var n,S=(j=null==j?Ne:ci.defaults(Ne.Object(),j,ci.pick(Ne,Go))).Array,w=j.Date,U=j.Error,de=j.Function,ke=j.Math,_e=j.Object,fr=j.RegExp,cl=j.String,Ke=j.TypeError,mi=S.prototype,Sn=_e.prototype,pi=j["__core-js_shared__"],ui=de.prototype.toString,ue=Sn.hasOwnProperty,pl=0,Gs=(n=/[^.]+$/.exec(pi&&pi.keys&&pi.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",gi=Sn.toString,ul=ui.call(_e),gl=Ne._,hl=fr("^"+ui.call(ue).replace(er,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),hi=fs?j.Buffer:g,Kt=j.Symbol,_i=j.Uint8Array,Ds=hi?hi.allocUnsafe:g,fi=Ns(_e.getPrototypeOf,_e),Ls=_e.create,Vs=Sn.propertyIsEnumerable,bi=mi.splice,Ps=Kt?Kt.isConcatSpreadable:g,Bn=Kt?Kt.iterator:g,dn=Kt?Kt.toStringTag:g,vi=function(){try{var n=un(_e,"defineProperty");return n({},"",{}),n}catch{}}(),_l=j.clearTimeout!==Ne.clearTimeout&&j.clearTimeout,fl=w&&w.now!==Ne.Date.now&&w.now,bl=j.setTimeout!==Ne.setTimeout&&j.setTimeout,Ci=ke.ceil,Si=ke.floor,br=_e.getOwnPropertySymbols,vl=hi?hi.isBuffer:g,Bs=j.isFinite,Cl=mi.join,Sl=Ns(_e.keys,_e),Fe=ke.max,Le=ke.min,jl=w.now,yl=j.parseInt,$s=ke.random,Il=mi.reverse,vr=un(j,"DataView"),$n=un(j,"Map"),Cr=un(j,"Promise"),jn=un(j,"Set"),Xn=un(j,"WeakMap"),An=un(_e,"create"),ji=Xn&&new Xn,yn={},Tl=$t(vr),xl=$t($n),kl=$t(Cr),Fl=$t(jn),Rl=$t(Xn),yi=Kt?Kt.prototype:g,Un=yi?yi.valueOf:g,Xs=yi?yi.toString:g;function h(n){if(xe(n)&&!H(n)&&!(n instanceof ne)){if(n instanceof ot)return n;if(ue.call(n,"__wrapped__"))return dc(n)}return new ot(n)}var In=function(){function n(){}return function(r){if(!ye(r))return{};if(Ls)return Ls(r);n.prototype=r;var o=new n;return n.prototype=g,o}}();function Ii(){}function ot(n,r){this.__wrapped__=n,this.__actions__=[],this.__chain__=!!r,this.__index__=0,this.__values__=g}function ne(n){this.__wrapped__=n,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ze,this.__views__=[]}function cn(n){var r=-1,o=null==n?0:n.length;for(this.clear();++r<o;){var d=n[r];this.set(d[0],d[1])}}function Dt(n){var r=-1,o=null==n?0:n.length;for(this.clear();++r<o;){var d=n[r];this.set(d[0],d[1])}}function Lt(n){var r=-1,o=null==n?0:n.length;for(this.clear();++r<o;){var d=n[r];this.set(d[0],d[1])}}function mn(n){var r=-1,o=null==n?0:n.length;for(this.__data__=new Lt;++r<o;)this.add(n[r])}function Ct(n){var r=this.__data__=new Dt(n);this.size=r.size}function As(n,r){var o=H(n),d=!o&&Wn(n),p=!o&&!d&&Fn(n),_=!o&&!d&&!p&&$i(n),f=o||d||p||_,b=f?gr(n.length,cl):[],C=b.length;for(var y in n)(r||ue.call(n,y))&&(!f||!("length"==y||p&&("offset"==y||"parent"==y)||_&&("buffer"==y||"byteLength"==y||"byteOffset"==y)||Bt(y,C)))&&b.push(y);return b}function Us(n){var r=n.length;return r?n[Or(0,r-1)]:g}function td(n,r){return oe(Qe(n),Zt(r,0,n.length))}function nd(n){return oe(Qe(n))}function Sr(n,r,o){(o!==g&&!Xt(n[r],o)||o===g&&!(r in n))&&Tt(n,r,o)}function Yn(n,r,o){var d=n[r];(!ue.call(n,r)||!Xt(d,o)||o===g&&!(r in n))&&Tt(n,r,o)}function Ti(n,r){for(var o=n.length;o--;)if(Xt(n[o][0],r))return o;return-1}function id(n,r,o,d){return en(n,function(p,_,f){r(d,p,o(p),f)}),d}function Ys(n,r){return n&&kt(r,Pe(r),n)}function Tt(n,r,o){"__proto__"==r&&vi?vi(n,r,{configurable:!0,enumerable:!0,value:o,writable:!0}):n[r]=o}function qn(n,r){for(var o=-1,d=r.length,p=S(d),_=null==n;++o<d;)p[o]=_?g:ec(n,r[o]);return p}function Zt(n,r,o){return n==n&&(o!==g&&(n=n<=o?n:o),r!==g&&(n=n>=r?n:r)),n}function lt(n,r,o,d,p,_){var f,b=1&r,C=2&r,y=4&r;if(o&&(f=p?o(n,d,p,_):o(n)),f!==g)return f;if(!ye(n))return n;var I=H(n);if(I){if(f=function Ad(n){var r=n.length,o=new n.constructor(r);return r&&"string"==typeof n[0]&&ue.call(n,"index")&&(o.index=n.index,o.input=n.input),o}(n),!b)return Qe(n,f)}else{var T=Ve(n),M=T==rt||T==zr;if(Fn(n))return _a(n,b);if(T==wt||T==it||M&&!p){if(f=C||M?{}:Ea(n),!b)return C?function wd(n,r){return kt(n,wa(n),r)}(n,function jr(n,r){return n&&kt(r,mt(r),n)}(f,n)):function Od(n,r){return kt(n,Ar(n),r)}(n,Ys(f,n))}else{if(!be[T])return p?n:{};f=function Ud(n,r,o){var d=n.constructor;switch(r){case Gn:return Dr(n);case Rn:case Mn:return new d(+n);case Te:return function kd(n,r){var o=r?Dr(n.buffer):n.buffer;return new n.constructor(o,n.byteOffset,n.byteLength)}(n,o);case Yi:case qi:case Qi:case zi:case Hi:case Ji:case Wi:case Ki:case Zi:return fa(n,o);case ht:return new d;case On:case Nn:return new d(n);case wn:return function Fd(n){var r=new n.constructor(n.source,$e.exec(n));return r.lastIndex=n.lastIndex,r}(n);case _t:return new d;case ti:return function Rd(n){return Un?_e(Un.call(n)):{}}(n)}}(n,T,b)}}_||(_=new Ct);var G=_.get(n);if(G)return G;_.set(n,f),Rc(n)?n.forEach(function($){f.add(lt($,r,o,$,n,_))}):kc(n)&&n.forEach(function($,re){f.set(re,lt($,r,o,re,n,_))});var te=I?g:(y?C?Br:Pr:C?mt:Pe)(n);return at(te||n,function($,re){te&&($=n[re=$]),Yn(f,re,lt($,r,o,re,n,_))}),f}function qs(n,r,o){var d=o.length;if(null==n)return!d;for(n=_e(n);d--;){var p=o[d],f=n[p];if(f===g&&!(p in n)||!(0,r[p])(f))return!1}return!0}function Qs(n,r,o){if("function"!=typeof n)throw new Ke(ce);return Q(function(){n.apply(g,o)},r)}function Qn(n,r,o,d){var p=-1,_=ai,f=!0,b=n.length,C=[],y=r.length;if(!b)return C;o&&(r=je(r,We(o))),d?(_=dr,f=!1):r.length>=200&&(_=Pn,f=!1,r=new mn(r));e:for(;++p<b;){var I=n[p],T=null==o?I:o(I);if(I=d||0!==I?I:0,f&&T==T){for(var M=y;M--;)if(r[M]===T)continue e;C.push(I)}else _(r,T,d)||C.push(I)}return C}h.templateSettings={escape:eo,evaluate:to,interpolate:Zr,variable:"",imports:{_:h}},(h.prototype=Ii.prototype).constructor=h,(ot.prototype=In(Ii.prototype)).constructor=ot,(ne.prototype=In(Ii.prototype)).constructor=ne,cn.prototype.clear=function Nl(){this.__data__=An?An(null):{},this.size=0},cn.prototype.delete=function El(n){var r=this.has(n)&&delete this.__data__[n];return this.size-=r?1:0,r},cn.prototype.get=function Gl(n){var r=this.__data__;if(An){var o=r[n];return o===Ie?g:o}return ue.call(r,n)?r[n]:g},cn.prototype.has=function Dl(n){var r=this.__data__;return An?r[n]!==g:ue.call(r,n)},cn.prototype.set=function Ll(n,r){var o=this.__data__;return this.size+=this.has(n)?0:1,o[n]=An&&r===g?Ie:r,this},Dt.prototype.clear=function Vl(){this.__data__=[],this.size=0},Dt.prototype.delete=function Pl(n){var r=this.__data__,o=Ti(r,n);return!(o<0||(o==r.length-1?r.pop():bi.call(r,o,1),--this.size,0))},Dt.prototype.get=function Bl(n){var r=this.__data__,o=Ti(r,n);return o<0?g:r[o][1]},Dt.prototype.has=function $l(n){return Ti(this.__data__,n)>-1},Dt.prototype.set=function Xl(n,r){var o=this.__data__,d=Ti(o,n);return d<0?(++this.size,o.push([n,r])):o[d][1]=r,this},Lt.prototype.clear=function Al(){this.size=0,this.__data__={hash:new cn,map:new($n||Dt),string:new cn}},Lt.prototype.delete=function Ul(n){var r=Bi(this,n).delete(n);return this.size-=r?1:0,r},Lt.prototype.get=function Yl(n){return Bi(this,n).get(n)},Lt.prototype.has=function ql(n){return Bi(this,n).has(n)},Lt.prototype.set=function Ql(n,r){var o=Bi(this,n),d=o.size;return o.set(n,r),this.size+=o.size==d?0:1,this},mn.prototype.add=mn.prototype.push=function zl(n){return this.__data__.set(n,Ie),this},mn.prototype.has=function Hl(n){return this.__data__.has(n)},Ct.prototype.clear=function Jl(){this.__data__=new Dt,this.size=0},Ct.prototype.delete=function Wl(n){var r=this.__data__,o=r.delete(n);return this.size=r.size,o},Ct.prototype.get=function Kl(n){return this.__data__.get(n)},Ct.prototype.has=function Zl(n){return this.__data__.has(n)},Ct.prototype.set=function ed(n,r){var o=this.__data__;if(o instanceof Dt){var d=o.__data__;if(!$n||d.length<199)return d.push([n,r]),this.size=++o.size,this;o=this.__data__=new Lt(d)}return o.set(n,r),this.size=o.size,this};var en=Sa(xt),zs=Sa(Ir,!0);function sd(n,r){var o=!0;return en(n,function(d,p,_){return o=!!r(d,p,_)}),o}function xi(n,r,o){for(var d=-1,p=n.length;++d<p;){var _=n[d],f=r(_);if(null!=f&&(b===g?f==f&&!St(f):o(f,b)))var b=f,C=_}return C}function Hs(n,r){var o=[];return en(n,function(d,p,_){r(d,p,_)&&o.push(d)}),o}function Ee(n,r,o,d,p){var _=-1,f=n.length;for(o||(o=qd),p||(p=[]);++_<f;){var b=n[_];r>0&&o(b)?r>1?Ee(b,r-1,o,d,p):bt(p,b):d||(p[p.length]=b)}return p}var yr=ja(),Js=ja(!0);function xt(n,r){return n&&yr(n,r,Pe)}function Ir(n,r){return n&&Js(n,r,Pe)}function ki(n,r){return Jt(r,function(o){return gn(n[o])})}function pn(n,r){for(var o=0,d=(r=rn(r,n)).length;null!=n&&o<d;)n=n[we(r[o++])];return o&&o==d?n:g}function Ws(n,r,o){var d=r(n);return H(n)?d:bt(d,o(n))}function Xe(n){return null==n?n===g?"[object Undefined]":"[object Null]":dn&&dn in _e(n)?function Bd(n){var r=ue.call(n,dn),o=n[dn];try{n[dn]=g;var d=!0}catch{}var p=gi.call(n);return d&&(r?n[dn]=o:delete n[dn]),p}(n):function P(n){return gi.call(n)}(n)}function Tr(n,r){return n>r}function od(n,r){return null!=n&&ue.call(n,r)}function ld(n,r){return null!=n&&r in _e(n)}function xr(n,r,o){for(var d=o?dr:ai,p=n[0].length,_=n.length,f=_,b=S(_),C=1/0,y=[];f--;){var I=n[f];f&&r&&(I=je(I,We(r))),C=Le(I.length,C),b[f]=!o&&(r||p>=120&&I.length>=120)?new mn(f&&I):g}I=n[0];var T=-1,M=b[0];e:for(;++T<p&&y.length<C;){var G=I[T],B=r?r(G):G;if(G=o||0!==G?G:0,!(M?Pn(M,B):d(y,B,o))){for(f=_;--f;){var te=b[f];if(!(te?Pn(te,B):d(n[f],B,o)))continue e}M&&M.push(B),y.push(G)}}return y}function tn(n,r,o){var d=null==(n=D(n,r=rn(r,n)))?n:n[we(Ft(r))];return null==d?g:Je(d,n,o)}function Ks(n){return xe(n)&&Xe(n)==it}function zn(n,r,o,d,p){return n===r||(null==n||null==r||!xe(n)&&!xe(r)?n!=n&&r!=r:function md(n,r,o,d,p,_){var f=H(n),b=H(r),C=f?ei:Ve(n),y=b?ei:Ve(r),I=(C=C==it?wt:C)==wt,T=(y=y==it?wt:y)==wt,M=C==y;if(M&&Fn(n)){if(!Fn(r))return!1;f=!0,I=!1}if(M&&!I)return _||(_=new Ct),f||$i(n)?Oa(n,r,o,d,p,_):function Vd(n,r,o,d,p,_,f){switch(o){case Te:if(n.byteLength!=r.byteLength||n.byteOffset!=r.byteOffset)return!1;n=n.buffer,r=r.buffer;case Gn:return!(n.byteLength!=r.byteLength||!_(new _i(n),new _i(r)));case Rn:case Mn:case On:return Xt(+n,+r);case Ue:return n.name==r.name&&n.message==r.message;case wn:case Nn:return n==r+"";case ht:var b=_r;case _t:if(b||(b=di),n.size!=r.size&&!(1&d))return!1;var y=f.get(n);if(y)return y==r;d|=2,f.set(n,r);var I=Oa(b(n),b(r),d,p,_,f);return f.delete(n),I;case ti:if(Un)return Un.call(n)==Un.call(r)}return!1}(n,r,C,o,d,p,_);if(!(1&o)){var G=I&&ue.call(n,"__wrapped__"),B=T&&ue.call(r,"__wrapped__");if(G||B){var te=G?n.value():n,$=B?r.value():r;return _||(_=new Ct),p(te,$,o,d,_)}}return!!M&&(_||(_=new Ct),function Pd(n,r,o,d,p,_){var f=1&o,b=Pr(n),C=b.length;if(C!=Pr(r).length&&!f)return!1;for(var T=C;T--;){var M=b[T];if(!(f?M in r:ue.call(r,M)))return!1}var G=_.get(n),B=_.get(r);if(G&&B)return G==r&&B==n;var te=!0;_.set(n,r),_.set(r,n);for(var $=f;++T<C;){var re=n[M=b[T]],ae=r[M];if(d)var jt=f?d(ae,re,M,r,n,_):d(re,ae,M,n,r,_);if(!(jt===g?re===ae||p(re,ae,o,d,_):jt)){te=!1;break}$||($="constructor"==M)}if(te&&!$){var et=n.constructor,yt=r.constructor;et!=yt&&"constructor"in n&&"constructor"in r&&!("function"==typeof et&&et instanceof et&&"function"==typeof yt&&yt instanceof yt)&&(te=!1)}return _.delete(n),_.delete(r),te}(n,r,o,d,p,_))}(n,r,o,d,zn,p))}function kr(n,r,o,d){var p=o.length,_=p,f=!d;if(null==n)return!_;for(n=_e(n);p--;){var b=o[p];if(f&&b[2]?b[1]!==n[b[0]]:!(b[0]in n))return!1}for(;++p<_;){var C=(b=o[p])[0],y=n[C],I=b[1];if(f&&b[2]){if(y===g&&!(C in n))return!1}else{var T=new Ct;if(d)var M=d(y,I,C,n,r,T);if(!(M===g?zn(I,y,3,d,T):M))return!1}}return!0}function ta(n){return!(!ye(n)||function u(n){return!!Gs&&Gs in n}(n))&&(gn(n)?hl:co).test($t(n))}function na(n){return"function"==typeof n?n:null==n?pt:"object"==typeof n?H(n)?sa(n[0],n[1]):ra(n):Xc(n)}function Fr(n){if(!s(n))return Sl(n);var r=[];for(var o in _e(n))ue.call(n,o)&&"constructor"!=o&&r.push(o);return r}function Rr(n,r){return n<r}function ia(n,r){var o=-1,d=ct(n)?S(n.length):[];return en(n,function(p,_,f){d[++o]=r(p,_,f)}),d}function ra(n){var r=Xr(n);return 1==r.length&&r[0][2]?l(r[0][0],r[0][1]):function(o){return o===n||kr(o,n,r)}}function sa(n,r){return Ur(n)&&i(r)?l(we(n),r):function(o){var d=ec(o,n);return d===g&&d===r?tc(o,n):zn(r,d,3)}}function Fi(n,r,o,d,p){n!==r&&yr(r,function(_,f){if(p||(p=new Ct),ye(_))!function fd(n,r,o,d,p,_,f){var b=ee(n,o),C=ee(r,o),y=f.get(C);if(y)Sr(n,o,y);else{var I=_?_(b,C,o+"",n,r,f):g,T=I===g;if(T){var M=H(C),G=!M&&Fn(C),B=!M&&!G&&$i(C);I=C,M||G||B?H(b)?I=b:Re(b)?I=Qe(b):G?(T=!1,I=_a(C,!0)):B?(T=!1,I=fa(C,!0)):I=[]:qr(C)||Wn(C)?(I=b,Wn(b)?I=wc(b):(!ye(b)||gn(b))&&(I=Ea(C))):T=!1}T&&(f.set(C,I),p(I,C,d,_,f),f.delete(C)),Sr(n,o,I)}}(n,r,f,o,Fi,d,p);else{var b=d?d(ee(n,f),_,f+"",n,r,p):g;b===g&&(b=_),Sr(n,f,b)}},mt)}function aa(n,r){var o=n.length;if(o)return Bt(r+=r<0?o:0,o)?n[r]:g}function oa(n,r,o){r=r.length?je(r,function(_){return H(_)?function(f){return pn(f,1===_.length?_[0]:_)}:_}):[pt];var d=-1;return r=je(r,We(L())),function zo(v,j){var S=v.length;for(v.sort(j);S--;)v[S]=v[S].value;return v}(ia(n,function(_,f,b){return{criteria:je(r,function(y){return y(_)}),index:++d,value:_}}),function(_,f){return function Md(n,r,o){for(var d=-1,p=n.criteria,_=r.criteria,f=p.length,b=o.length;++d<f;){var C=ba(p[d],_[d]);if(C)return d>=b?C:C*("desc"==o[d]?-1:1)}return n.index-r.index}(_,f,o)})}function la(n,r,o){for(var d=-1,p=r.length,_={};++d<p;){var f=r[d],b=pn(n,f);o(b,f)&&Hn(_,rn(f,n),b)}return _}function Mr(n,r,o,d){var p=d?Qo:bn,_=-1,f=r.length,b=n;for(n===r&&(r=Qe(r)),o&&(b=je(n,We(o)));++_<f;)for(var C=0,y=r[_],I=o?o(y):y;(C=p(b,I,C,d))>-1;)b!==n&&bi.call(b,C,1),bi.call(n,C,1);return n}function da(n,r){for(var o=n?r.length:0,d=o-1;o--;){var p=r[o];if(o==d||p!==_){var _=p;Bt(p)?bi.call(n,p,1):Mi(n,p)}}return n}function Or(n,r){return n+Si($s()*(r-n+1))}function wr(n,r){var o="";if(!n||r<1||r>Se)return o;do{r%2&&(o+=n),(r=Si(r/2))&&(n+=n)}while(r);return o}function K(n,r){return V(q(n,r,pt),n+"")}function Sd(n){return Us(Xi(n))}function jd(n,r){var o=Xi(n);return oe(o,Zt(r,0,o.length))}function Hn(n,r,o,d){if(!ye(n))return n;for(var p=-1,_=(r=rn(r,n)).length,f=_-1,b=n;null!=b&&++p<_;){var C=we(r[p]),y=o;if("__proto__"===C||"constructor"===C||"prototype"===C)return n;if(p!=f){var I=b[C];(y=d?d(I,C,b):g)===g&&(y=ye(I)?I:Bt(r[p+1])?[]:{})}Yn(b,C,y),b=b[C]}return n}var ca=ji?function(n,r){return ji.set(n,r),n}:pt,yd=vi?function(n,r){return vi(n,"toString",{configurable:!0,enumerable:!1,value:ic(r),writable:!0})}:pt;function Id(n){return oe(Xi(n))}function dt(n,r,o){var d=-1,p=n.length;r<0&&(r=-r>p?0:p+r),(o=o>p?p:o)<0&&(o+=p),p=r>o?0:o-r>>>0,r>>>=0;for(var _=S(p);++d<p;)_[d]=n[d+r];return _}function Td(n,r){var o;return en(n,function(d,p,_){return!(o=r(d,p,_))}),!!o}function Ri(n,r,o){var d=0,p=null==n?d:n.length;if("number"==typeof r&&r==r&&p<=2147483647){for(;d<p;){var _=d+p>>>1,f=n[_];null!==f&&!St(f)&&(o?f<=r:f<r)?d=_+1:p=_}return p}return Nr(n,r,pt,o)}function Nr(n,r,o,d){var p=0,_=null==n?0:n.length;if(0===_)return 0;for(var f=(r=o(r))!=r,b=null===r,C=St(r),y=r===g;p<_;){var I=Si((p+_)/2),T=o(n[I]),M=T!==g,G=null===T,B=T==T,te=St(T);if(f)var $=d||B;else $=y?B&&(d||M):b?B&&M&&(d||!G):C?B&&M&&!G&&(d||!te):!G&&!te&&(d?T<=r:T<r);$?p=I+1:_=I}return Le(_,4294967294)}function ma(n,r){for(var o=-1,d=n.length,p=0,_=[];++o<d;){var f=n[o],b=r?r(f):f;if(!o||!Xt(b,C)){var C=b;_[p++]=0===f?0:f}}return _}function pa(n){return"number"==typeof n?n:St(n)?NaN:+n}function Ze(n){if("string"==typeof n)return n;if(H(n))return je(n,Ze)+"";if(St(n))return Xs?Xs.call(n):"";var r=n+"";return"0"==r&&1/n==-le?"-0":r}function nn(n,r,o){var d=-1,p=ai,_=n.length,f=!0,b=[],C=b;if(o)f=!1,p=dr;else if(_>=200){var y=r?null:Dd(n);if(y)return di(y);f=!1,p=Pn,C=new mn}else C=r?[]:b;e:for(;++d<_;){var I=n[d],T=r?r(I):I;if(I=o||0!==I?I:0,f&&T==T){for(var M=C.length;M--;)if(C[M]===T)continue e;r&&C.push(T),b.push(I)}else p(C,T,o)||(C!==b&&C.push(T),b.push(I))}return b}function Mi(n,r){return null==(n=D(n,r=rn(r,n)))||delete n[we(Ft(r))]}function ua(n,r,o,d){return Hn(n,r,o(pn(n,r)),d)}function Oi(n,r,o,d){for(var p=n.length,_=d?p:-1;(d?_--:++_<p)&&r(n[_],_,n););return o?dt(n,d?0:_,d?_+1:p):dt(n,d?_+1:0,d?p:_)}function wi(n,r){var o=n;return o instanceof ne&&(o=o.value()),Vn(r,function(d,p){return p.func.apply(p.thisArg,bt([d],p.args))},o)}function Er(n,r,o){var d=n.length;if(d<2)return d?nn(n[0]):[];for(var p=-1,_=S(d);++p<d;)for(var f=n[p],b=-1;++b<d;)b!=p&&(_[p]=Qn(_[p]||f,n[b],r,o));return nn(Ee(_,1),r,o)}function ga(n,r,o){for(var d=-1,p=n.length,_=r.length,f={};++d<p;)o(f,n[d],d<_?r[d]:g);return f}function Ni(n){return Re(n)?n:[]}function Gr(n){return"function"==typeof n?n:pt}function rn(n,r){return H(n)?n:Ur(n,r)?[n]:Oe(he(n))}var xd=K;function sn(n,r,o){var d=n.length;return o=o===g?d:o,!r&&o>=d?n:dt(n,r,o)}var ha=_l||function(n){return Ne.clearTimeout(n)};function _a(n,r){if(r)return n.slice();var o=n.length,d=Ds?Ds(o):new n.constructor(o);return n.copy(d),d}function Dr(n){var r=new n.constructor(n.byteLength);return new _i(r).set(new _i(n)),r}function fa(n,r){var o=r?Dr(n.buffer):n.buffer;return new n.constructor(o,n.byteOffset,n.length)}function ba(n,r){if(n!==r){var o=n!==g,d=null===n,p=n==n,_=St(n),f=r!==g,b=null===r,C=r==r,y=St(r);if(!b&&!y&&!_&&n>r||_&&f&&C&&!b&&!y||d&&f&&C||!o&&C||!p)return 1;if(!d&&!_&&!y&&n<r||y&&o&&p&&!d&&!_||b&&o&&p||!f&&p||!C)return-1}return 0}function va(n,r,o,d){for(var p=-1,_=n.length,f=o.length,b=-1,C=r.length,y=Fe(_-f,0),I=S(C+y),T=!d;++b<C;)I[b]=r[b];for(;++p<f;)(T||p<_)&&(I[o[p]]=n[p]);for(;y--;)I[b++]=n[p++];return I}function Ca(n,r,o,d){for(var p=-1,_=n.length,f=-1,b=o.length,C=-1,y=r.length,I=Fe(_-b,0),T=S(I+y),M=!d;++p<I;)T[p]=n[p];for(var G=p;++C<y;)T[G+C]=r[C];for(;++f<b;)(M||p<_)&&(T[G+o[f]]=n[p++]);return T}function Qe(n,r){var o=-1,d=n.length;for(r||(r=S(d));++o<d;)r[o]=n[o];return r}function kt(n,r,o,d){var p=!o;o||(o={});for(var _=-1,f=r.length;++_<f;){var b=r[_],C=d?d(o[b],n[b],b,o,n):g;C===g&&(C=n[b]),p?Tt(o,b,C):Yn(o,b,C)}return o}function Ei(n,r){return function(o,d){var p=H(o)?Xo:id,_=r?r():{};return p(o,n,L(d,2),_)}}function Tn(n){return K(function(r,o){var d=-1,p=o.length,_=p>1?o[p-1]:g,f=p>2?o[2]:g;for(_=n.length>3&&"function"==typeof _?(p--,_):g,f&&Ae(o[0],o[1],f)&&(_=p<3?g:_,p=1),r=_e(r);++d<p;){var b=o[d];b&&n(r,b,d,_)}return r})}function Sa(n,r){return function(o,d){if(null==o)return o;if(!ct(o))return n(o,d);for(var p=o.length,_=r?p:-1,f=_e(o);(r?_--:++_<p)&&!1!==d(f[_],_,f););return o}}function ja(n){return function(r,o,d){for(var p=-1,_=_e(r),f=d(r),b=f.length;b--;){var C=f[n?b:++p];if(!1===o(_[C],C,_))break}return r}}function ya(n){return function(r){var o=vn(r=he(r))?vt(r):g,d=o?o[0]:r.charAt(0),p=o?sn(o,1).join(""):r.slice(1);return d[n]()+p}}function xn(n){return function(r){return Vn(Bc(Pc(r).replace(Mo,"")),n,"")}}function Jn(n){return function(){var r=arguments;switch(r.length){case 0:return new n;case 1:return new n(r[0]);case 2:return new n(r[0],r[1]);case 3:return new n(r[0],r[1],r[2]);case 4:return new n(r[0],r[1],r[2],r[3]);case 5:return new n(r[0],r[1],r[2],r[3],r[4]);case 6:return new n(r[0],r[1],r[2],r[3],r[4],r[5]);case 7:return new n(r[0],r[1],r[2],r[3],r[4],r[5],r[6])}var o=In(n.prototype),d=n.apply(o,r);return ye(d)?d:o}}function Ia(n){return function(r,o,d){var p=_e(r);if(!ct(r)){var _=L(o,3);r=Pe(r),o=function(b){return _(p[b],b,p)}}var f=n(r,o,d);return f>-1?p[_?r[f]:f]:g}}function Ta(n){return Pt(function(r){var o=r.length,d=o,p=ot.prototype.thru;for(n&&r.reverse();d--;){var _=r[d];if("function"!=typeof _)throw new Ke(ce);if(p&&!f&&"wrapper"==Pi(_))var f=new ot([],!0)}for(d=f?d:o;++d<o;){var b=Pi(_=r[d]),C="wrapper"==b?$r(_):g;f=C&&a(C[0])&&424==C[1]&&!C[4].length&&1==C[9]?f[Pi(C[0])].apply(f,C[3]):1==_.length&&a(_)?f[b]():f.thru(_)}return function(){var y=arguments,I=y[0];if(f&&1==y.length&&H(I))return f.plant(I).value();for(var T=0,M=o?r[T].apply(this,y):I;++T<o;)M=r[T].call(this,M);return M}})}function Gi(n,r,o,d,p,_,f,b,C,y){var I=128&r,T=1&r,M=2&r,G=24&r,B=512&r,te=M?g:Jn(n);return function $(){for(var re=arguments.length,ae=S(re),jt=re;jt--;)ae[jt]=arguments[jt];if(G)var et=kn($),yt=function Jo(v,j){for(var S=v.length,w=0;S--;)v[S]===j&&++w;return w}(ae,et);if(d&&(ae=va(ae,d,p,G)),_&&(ae=Ca(ae,_,f,G)),re-=yt,G&&re<y){var Me=Wt(ae,et);return Fa(n,r,Gi,$.placeholder,o,ae,Me,b,C,y-re)}var At=T?o:this,_n=M?At[n]:n;return re=ae.length,b?ae=function J(n,r){for(var o=n.length,d=Le(r.length,o),p=Qe(n);d--;){var _=r[d];n[d]=Bt(_,o)?p[_]:g}return n}(ae,b):B&&re>1&&ae.reverse(),I&&C<re&&(ae.length=C),this&&this!==Ne&&this instanceof $&&(_n=te||Jn(_n)),_n.apply(At,ae)}}function xa(n,r){return function(o,d){return function cd(n,r,o,d){return xt(n,function(p,_,f){r(d,o(p),_,f)}),d}(o,n,r(d),{})}}function Di(n,r){return function(o,d){var p;if(o===g&&d===g)return r;if(o!==g&&(p=o),d!==g){if(p===g)return d;"string"==typeof o||"string"==typeof d?(o=Ze(o),d=Ze(d)):(o=pa(o),d=pa(d)),p=n(o,d)}return p}}function Lr(n){return Pt(function(r){return r=je(r,We(L())),K(function(o){var d=this;return n(r,function(p){return Je(p,d,o)})})})}function Li(n,r){var o=(r=r===g?" ":Ze(r)).length;if(o<2)return o?wr(r,n):r;var d=wr(r,Ci(n/Cn(r)));return vn(r)?sn(vt(d),0,n).join(""):d.slice(0,n)}function ka(n){return function(r,o,d){return d&&"number"!=typeof d&&Ae(r,o,d)&&(o=d=g),r=hn(r),o===g?(o=r,r=0):o=hn(o),function Cd(n,r,o,d){for(var p=-1,_=Fe(Ci((r-n)/(o||1)),0),f=S(_);_--;)f[d?_:++p]=n,n+=o;return f}(r,o,d=d===g?r<o?1:-1:hn(d),n)}}function Vi(n){return function(r,o){return"string"==typeof r&&"string"==typeof o||(r=Rt(r),o=Rt(o)),n(r,o)}}function Fa(n,r,o,d,p,_,f,b,C,y){var I=8&r;r|=I?32:64,4&(r&=~(I?64:32))||(r&=-4);var te=[n,r,p,I?_:g,I?f:g,I?g:_,I?g:f,b,C,y],$=o.apply(g,te);return a(n)&&W($,te),$.placeholder=d,z($,n,r)}function Vr(n){var r=ke[n];return function(o,d){if(o=Rt(o),(d=null==d?0:Le(Z(d),292))&&Bs(o)){var p=(he(o)+"e").split("e");return+((p=(he(r(p[0]+"e"+(+p[1]+d)))+"e").split("e"))[0]+"e"+(+p[1]-d))}return r(o)}}var Dd=jn&&1/di(new jn([,-0]))[1]==le?function(n){return new jn(n)}:ac;function Ra(n){return function(r){var o=Ve(r);return o==ht?_r(r):o==_t?function nl(v){var j=-1,S=Array(v.size);return v.forEach(function(w){S[++j]=[w,w]}),S}(r):function Ho(v,j){return je(j,function(S){return[S,v[S]]})}(r,n(r))}}function Vt(n,r,o,d,p,_,f,b){var C=2&r;if(!C&&"function"!=typeof n)throw new Ke(ce);var y=d?d.length:0;if(y||(r&=-97,d=p=g),f=f===g?f:Fe(Z(f),0),b=b===g?b:Z(b),y-=p?p.length:0,64&r){var I=d,T=p;d=p=g}var M=C?g:$r(n),G=[n,r,o,d,p,I,T,_,f,b];if(M&&function c(n,r){var o=n[1],d=r[1],p=o|d;if(!(p<131)&&!(128==d&&8==o||128==d&&256==o&&n[7].length<=r[8]||384==d&&r[7].length<=r[8]&&8==o))return n;1&d&&(n[2]=r[2],p|=1&o?0:4);var b=r[3];if(b){var C=n[3];n[3]=C?va(C,b,r[4]):b,n[4]=C?Wt(n[3],O):r[4]}(b=r[5])&&(n[5]=(C=n[5])?Ca(C,b,r[6]):b,n[6]=C?Wt(n[5],O):r[6]),(b=r[7])&&(n[7]=b),128&d&&(n[8]=null==n[8]?r[8]:Le(n[8],r[8])),null==n[9]&&(n[9]=r[9]),n[0]=r[0],n[1]=p}(G,M),n=G[0],r=G[1],o=G[2],d=G[3],p=G[4],!(b=G[9]=G[9]===g?C?0:n.length:Fe(G[9]-y,0))&&24&r&&(r&=-25),r&&1!=r)B=8==r||16==r?function Ed(n,r,o){var d=Jn(n);return function p(){for(var _=arguments.length,f=S(_),b=_,C=kn(p);b--;)f[b]=arguments[b];var y=_<3&&f[0]!==C&&f[_-1]!==C?[]:Wt(f,C);return(_-=y.length)<o?Fa(n,r,Gi,p.placeholder,g,f,y,g,g,o-_):Je(this&&this!==Ne&&this instanceof p?d:n,this,f)}}(n,r,b):32!=r&&33!=r||p.length?Gi.apply(g,G):function Gd(n,r,o,d){var p=1&r,_=Jn(n);return function f(){for(var b=-1,C=arguments.length,y=-1,I=d.length,T=S(I+C),M=this&&this!==Ne&&this instanceof f?_:n;++y<I;)T[y]=d[y];for(;C--;)T[y++]=arguments[++b];return Je(M,p?o:this,T)}}(n,r,o,d);else var B=function Nd(n,r,o){var d=1&r,p=Jn(n);return function _(){return(this&&this!==Ne&&this instanceof _?p:n).apply(d?o:this,arguments)}}(n,r,o);return z((M?ca:W)(B,G),n,r)}function an(n,r,o,d){return n===g||Xt(n,Sn[o])&&!ue.call(d,o)?r:n}function Ma(n,r,o,d,p,_){return ye(n)&&ye(r)&&(_.set(r,n),Fi(n,r,g,Ma,_),_.delete(r)),n}function Ld(n){return qr(n)?g:n}function Oa(n,r,o,d,p,_){var f=1&o,b=n.length,C=r.length;if(b!=C&&!(f&&C>b))return!1;var y=_.get(n),I=_.get(r);if(y&&I)return y==r&&I==n;var T=-1,M=!0,G=2&o?new mn:g;for(_.set(n,r),_.set(r,n);++T<b;){var B=n[T],te=r[T];if(d)var $=f?d(te,B,T,r,n,_):d(B,te,T,n,r,_);if($!==g){if($)continue;M=!1;break}if(G){if(!cr(r,function(re,ae){if(!Pn(G,ae)&&(B===re||p(B,re,o,d,_)))return G.push(ae)})){M=!1;break}}else if(B!==te&&!p(B,te,o,d,_)){M=!1;break}}return _.delete(n),_.delete(r),M}function Pt(n){return V(q(n,g,pc),n+"")}function Pr(n){return Ws(n,Pe,Ar)}function Br(n){return Ws(n,mt,wa)}var $r=ji?function(n){return ji.get(n)}:ac;function Pi(n){for(var r=n.name+"",o=yn[r],d=ue.call(yn,r)?o.length:0;d--;){var p=o[d],_=p.func;if(null==_||_==n)return p.name}return r}function kn(n){return(ue.call(h,"placeholder")?h:n).placeholder}function L(){var n=h.iteratee||rc;return n=n===rc?na:n,arguments.length?n(arguments[0],arguments[1]):n}function Bi(n,r){var o=n.__data__;return function Qd(n){var r=typeof n;return"string"==r||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n}(r)?o["string"==typeof r?"string":"hash"]:o.map}function Xr(n){for(var r=Pe(n),o=r.length;o--;){var d=r[o],p=n[d];r[o]=[d,p,i(p)]}return r}function un(n,r){var o=function el(v,j){return null==v?g:v[j]}(n,r);return ta(o)?o:g}var Ar=br?function(n){return null==n?[]:(n=_e(n),Jt(br(n),function(r){return Vs.call(n,r)}))}:oc,wa=br?function(n){for(var r=[];n;)bt(r,Ar(n)),n=fi(n);return r}:oc,Ve=Xe;function Na(n,r,o){for(var d=-1,p=(r=rn(r,n)).length,_=!1;++d<p;){var f=we(r[d]);if(!(_=null!=n&&o(n,f)))break;n=n[f]}return _||++d!=p?_:!!(p=null==n?0:n.length)&&Ba(p)&&Bt(f,p)&&(H(n)||Wn(n))}function Ea(n){return"function"!=typeof n.constructor||s(n)?{}:In(fi(n))}function qd(n){return H(n)||Wn(n)||!!(Ps&&n&&n[Ps])}function Bt(n,r){var o=typeof n;return!!(r=r??Se)&&("number"==o||"symbol"!=o&&po.test(n))&&n>-1&&n%1==0&&n<r}function Ae(n,r,o){if(!ye(o))return!1;var d=typeof r;return!!("number"==d?ct(o)&&Bt(r,o.length):"string"==d&&r in o)&&Xt(o[r],n)}function Ur(n,r){if(H(n))return!1;var o=typeof n;return!("number"!=o&&"symbol"!=o&&"boolean"!=o&&null!=n&&!St(n))||io.test(n)||!no.test(n)||null!=r&&n in _e(r)}function a(n){var r=Pi(n),o=h[r];if("function"!=typeof o||!(r in ne.prototype))return!1;if(n===o)return!0;var d=$r(o);return!!d&&n===d[0]}(vr&&Ve(new vr(new ArrayBuffer(1)))!=Te||$n&&Ve(new $n)!=ht||Cr&&Ve(Cr.resolve())!=Hr||jn&&Ve(new jn)!=_t||Xn&&Ve(new Xn)!=En)&&(Ve=function(n){var r=Xe(n),o=r==wt?n.constructor:g,d=o?$t(o):"";if(d)switch(d){case Tl:return Te;case xl:return ht;case kl:return Hr;case Fl:return _t;case Rl:return En}return r});var t=pi?gn:lc;function s(n){var r=n&&n.constructor;return n===("function"==typeof r&&r.prototype||Sn)}function i(n){return n==n&&!ye(n)}function l(n,r){return function(o){return null!=o&&o[n]===r&&(r!==g||n in _e(o))}}function q(n,r,o){return r=Fe(r===g?n.length-1:r,0),function(){for(var d=arguments,p=-1,_=Fe(d.length-r,0),f=S(_);++p<_;)f[p]=d[r+p];p=-1;for(var b=S(r+1);++p<r;)b[p]=d[p];return b[r]=o(f),Je(n,this,b)}}function D(n,r){return r.length<2?n:pn(n,dt(r,0,-1))}function ee(n,r){if(("constructor"!==r||"function"!=typeof n[r])&&"__proto__"!=r)return n[r]}var W=ge(ca),Q=bl||function(n,r){return Ne.setTimeout(n,r)},V=ge(yd);function z(n,r,o){var d=r+"";return V(n,function Yd(n,r){var o=r.length;if(!o)return n;var d=o-1;return r[d]=(o>1?"& ":"")+r[d],r=r.join(o>2?", ":" "),n.replace(Nt,"{\n/* [wrapped with "+r+"] */\n")}(d,function Yr(n,r){return at(Zn,function(o){var d="_."+o[0];r&o[1]&&!ai(n,d)&&n.push(d)}),n.sort()}(function Xd(n){var r=n.match(ni);return r?r[1].split(De):[]}(d),o)))}function ge(n){var r=0,o=0;return function(){var d=jl(),p=16-(d-o);if(o=d,p>0){if(++r>=800)return arguments[0]}else r=0;return n.apply(g,arguments)}}function oe(n,r){var o=-1,d=n.length,p=d-1;for(r=r===g?d:r;++o<r;){var _=Or(o,p),f=n[_];n[_]=n[o],n[o]=f}return n.length=r,n}var Oe=function m(n){var r=Va(n,function(d){return 500===o.size&&o.clear(),d}),o=r.cache;return r}(function(n){var r=[];return 46===n.charCodeAt(0)&&r.push(""),n.replace(ro,function(o,d,p,_){r.push(p?_.replace(It,"$1"):d||o)}),r});function we(n){if("string"==typeof n||St(n))return n;var r=n+"";return"0"==r&&1/n==-le?"-0":r}function $t(n){if(null!=n){try{return ui.call(n)}catch{}try{return n+""}catch{}}return""}function dc(n){if(n instanceof ne)return n.clone();var r=new ot(n.__wrapped__,n.__chain__);return r.__actions__=Qe(n.__actions__),r.__index__=n.__index__,r.__values__=n.__values__,r}var Qc=K(function(n,r){return Re(n)?Qn(n,Ee(r,1,Re,!0)):[]}),zc=K(function(n,r){var o=Ft(r);return Re(o)&&(o=g),Re(n)?Qn(n,Ee(r,1,Re,!0),L(o,2)):[]}),Hc=K(function(n,r){var o=Ft(r);return Re(o)&&(o=g),Re(n)?Qn(n,Ee(r,1,Re,!0),g,o):[]});function cc(n,r,o){var d=null==n?0:n.length;if(!d)return-1;var p=null==o?0:Z(o);return p<0&&(p=Fe(d+p,0)),li(n,L(r,3),p)}function mc(n,r,o){var d=null==n?0:n.length;if(!d)return-1;var p=d-1;return o!==g&&(p=Z(o),p=o<0?Fe(d+p,0):Le(p,d-1)),li(n,L(r,3),p,!0)}function pc(n){return null!=n&&n.length?Ee(n,1):[]}function uc(n){return n&&n.length?n[0]:g}var am=K(function(n){var r=je(n,Ni);return r.length&&r[0]===n[0]?xr(r):[]}),om=K(function(n){var r=Ft(n),o=je(n,Ni);return r===Ft(o)?r=g:o.pop(),o.length&&o[0]===n[0]?xr(o,L(r,2)):[]}),lm=K(function(n){var r=Ft(n),o=je(n,Ni);return(r="function"==typeof r?r:g)&&o.pop(),o.length&&o[0]===n[0]?xr(o,g,r):[]});function Ft(n){var r=null==n?0:n.length;return r?n[r-1]:g}var pm=K(gc);function gc(n,r){return n&&n.length&&r&&r.length?Mr(n,r):n}var hm=Pt(function(n,r){var o=null==n?0:n.length,d=qn(n,r);return da(n,je(r,function(p){return Bt(p,o)?+p:p}).sort(ba)),d});function zd(n){return null==n?n:Il.call(n)}var Om=K(function(n){return nn(Ee(n,1,Re,!0))}),wm=K(function(n){var r=Ft(n);return Re(r)&&(r=g),nn(Ee(n,1,Re,!0),L(r,2))}),Nm=K(function(n){var r=Ft(n);return r="function"==typeof r?r:g,nn(Ee(n,1,Re,!0),g,r)});function Hd(n){if(!n||!n.length)return[];var r=0;return n=Jt(n,function(o){if(Re(o))return r=Fe(o.length,r),!0}),gr(r,function(o){return je(n,mr(o))})}function hc(n,r){if(!n||!n.length)return[];var o=Hd(n);return null==r?o:je(o,function(d){return Je(r,g,d)})}var Lm=K(function(n,r){return Re(n)?Qn(n,r):[]}),Vm=K(function(n){return Er(Jt(n,Re))}),Pm=K(function(n){var r=Ft(n);return Re(r)&&(r=g),Er(Jt(n,Re),L(r,2))}),Bm=K(function(n){var r=Ft(n);return r="function"==typeof r?r:g,Er(Jt(n,Re),g,r)}),$m=K(Hd),Um=K(function(n){var r=n.length,o=r>1?n[r-1]:g;return o="function"==typeof o?(n.pop(),o):g,hc(n,o)});function _c(n){var r=h(n);return r.__chain__=!0,r}function Ga(n,r){return r(n)}var qm=Pt(function(n){var r=n.length,o=r?n[0]:0,d=this.__wrapped__,p=function(_){return qn(_,n)};return!(r>1||this.__actions__.length)&&d instanceof ne&&Bt(o)?((d=d.slice(o,+o+(r?1:0))).__actions__.push({func:Ga,args:[p],thisArg:g}),new ot(d,this.__chain__).thru(function(_){return r&&!_.length&&_.push(g),_})):this.thru(p)}),ep=Ei(function(n,r,o){ue.call(n,o)?++n[o]:Tt(n,o,1)}),ip=Ia(cc),rp=Ia(mc);function fc(n,r){return(H(n)?at:en)(n,L(r,3))}function bc(n,r){return(H(n)?Ao:zs)(n,L(r,3))}var lp=Ei(function(n,r,o){ue.call(n,o)?n[o].push(r):Tt(n,o,[r])}),cp=K(function(n,r,o){var d=-1,p="function"==typeof r,_=ct(n)?S(n.length):[];return en(n,function(f){_[++d]=p?Je(r,f,o):tn(f,r,o)}),_}),mp=Ei(function(n,r,o){Tt(n,o,r)});function Da(n,r){return(H(n)?je:ia)(n,L(r,3))}var up=Ei(function(n,r,o){n[o?0:1].push(r)},function(){return[[],[]]}),jp=K(function(n,r){if(null==n)return[];var o=r.length;return o>1&&Ae(n,r[0],r[1])?r=[]:o>2&&Ae(r[0],r[1],r[2])&&(r=[r[0]]),oa(n,Ee(r,1),[])}),La=fl||function(){return Ne.Date.now()};function vc(n,r,o){return r=o?g:r,Vt(n,128,g,g,g,g,r=n&&null==r?n.length:r)}function Cc(n,r){var o;if("function"!=typeof r)throw new Ke(ce);return n=Z(n),function(){return--n>0&&(o=r.apply(this,arguments)),n<=1&&(r=g),o}}var Jd=K(function(n,r,o){var d=1;if(o.length){var p=Wt(o,kn(Jd));d|=32}return Vt(n,d,r,o,p)}),Sc=K(function(n,r,o){var d=3;if(o.length){var p=Wt(o,kn(Sc));d|=32}return Vt(r,d,n,o,p)});function Ic(n,r,o){var d,p,_,f,b,C,y=0,I=!1,T=!1,M=!0;if("function"!=typeof n)throw new Ke(ce);function G(Me){var At=d,_n=p;return d=p=g,y=Me,f=n.apply(_n,At)}function $(Me){var At=Me-C;return C===g||At>=r||At<0||T&&Me-y>=_}function re(){var Me=La();if($(Me))return ae(Me);b=Q(re,function te(Me){var Ac=r-(Me-C);return T?Le(Ac,_-(Me-y)):Ac}(Me))}function ae(Me){return b=g,M&&d?G(Me):(d=p=g,f)}function yt(){var Me=La(),At=$(Me);if(d=arguments,p=this,C=Me,At){if(b===g)return function B(Me){return y=Me,b=Q(re,r),I?G(Me):f}(C);if(T)return ha(b),b=Q(re,r),G(C)}return b===g&&(b=Q(re,r)),f}return r=Rt(r)||0,ye(o)&&(I=!!o.leading,_=(T="maxWait"in o)?Fe(Rt(o.maxWait)||0,r):_,M="trailing"in o?!!o.trailing:M),yt.cancel=function jt(){b!==g&&ha(b),y=0,d=C=p=b=g},yt.flush=function et(){return b===g?f:ae(La())},yt}var Ip=K(function(n,r){return Qs(n,1,r)}),Tp=K(function(n,r,o){return Qs(n,Rt(r)||0,o)});function Va(n,r){if("function"!=typeof n||null!=r&&"function"!=typeof r)throw new Ke(ce);var o=function(){var d=arguments,p=r?r.apply(this,d):d[0],_=o.cache;if(_.has(p))return _.get(p);var f=n.apply(this,d);return o.cache=_.set(p,f)||_,f};return o.cache=new(Va.Cache||Lt),o}function Pa(n){if("function"!=typeof n)throw new Ke(ce);return function(){var r=arguments;switch(r.length){case 0:return!n.call(this);case 1:return!n.call(this,r[0]);case 2:return!n.call(this,r[0],r[1]);case 3:return!n.call(this,r[0],r[1],r[2])}return!n.apply(this,r)}}Va.Cache=Lt;var Fp=xd(function(n,r){var o=(r=1==r.length&&H(r[0])?je(r[0],We(L())):je(Ee(r,1),We(L()))).length;return K(function(d){for(var p=-1,_=Le(d.length,o);++p<_;)d[p]=r[p].call(this,d[p]);return Je(n,this,d)})}),Wd=K(function(n,r){var o=Wt(r,kn(Wd));return Vt(n,32,g,r,o)}),Tc=K(function(n,r){var o=Wt(r,kn(Tc));return Vt(n,64,g,r,o)}),Rp=Pt(function(n,r){return Vt(n,256,g,g,g,r)});function Xt(n,r){return n===r||n!=n&&r!=r}var $p=Vi(Tr),Xp=Vi(function(n,r){return n>=r}),Wn=Ks(function(){return arguments}())?Ks:function(n){return xe(n)&&ue.call(n,"callee")&&!Vs.call(n,"callee")},H=S.isArray,Ap=bs?We(bs):function Zs(n){return xe(n)&&Xe(n)==Gn};function ct(n){return null!=n&&Ba(n.length)&&!gn(n)}function Re(n){return xe(n)&&ct(n)}var Fn=vl||lc,Yp=vs?We(vs):function ea(n){return xe(n)&&Xe(n)==Mn};function Kd(n){if(!xe(n))return!1;var r=Xe(n);return r==Ue||"[object DOMException]"==r||"string"==typeof n.message&&"string"==typeof n.name&&!qr(n)}function gn(n){if(!ye(n))return!1;var r=Xe(n);return r==rt||r==zr||"[object AsyncFunction]"==r||"[object Proxy]"==r}function xc(n){return"number"==typeof n&&n==Z(n)}function Ba(n){return"number"==typeof n&&n>-1&&n%1==0&&n<=Se}function ye(n){var r=typeof n;return null!=n&&("object"==r||"function"==r)}function xe(n){return null!=n&&"object"==typeof n}var kc=Cs?We(Cs):function pd(n){return xe(n)&&Ve(n)==ht};function Fc(n){return"number"==typeof n||xe(n)&&Xe(n)==On}function qr(n){if(!xe(n)||Xe(n)!=wt)return!1;var r=fi(n);if(null===r)return!0;var o=ue.call(r,"constructor")&&r.constructor;return"function"==typeof o&&o instanceof o&&ui.call(o)==ul}var Zd=Ss?We(Ss):function ud(n){return xe(n)&&Xe(n)==wn},Rc=js?We(js):function gd(n){return xe(n)&&Ve(n)==_t};function $a(n){return"string"==typeof n||!H(n)&&xe(n)&&Xe(n)==Nn}function St(n){return"symbol"==typeof n||xe(n)&&Xe(n)==ti}var $i=ys?We(ys):function hd(n){return xe(n)&&Ba(n.length)&&!!ve[Xe(n)]},ou=Vi(Rr),lu=Vi(function(n,r){return n<=r});function Mc(n){if(!n)return[];if(ct(n))return $a(n)?vt(n):Qe(n);if(Bn&&n[Bn])return function tl(v){for(var j,S=[];!(j=v.next()).done;)S.push(j.value);return S}(n[Bn]());var r=Ve(n);return(r==ht?_r:r==_t?di:Xi)(n)}function hn(n){return n?(n=Rt(n))===le||n===-le?17976931348623157e292*(n<0?-1:1):n==n?n:0:0===n?n:0}function Z(n){var r=hn(n),o=r%1;return r==r?o?r-o:r:0}function Oc(n){return n?Zt(Z(n),0,ze):0}function Rt(n){if("number"==typeof n)return n;if(St(n))return NaN;if(ye(n)){var r="function"==typeof n.valueOf?n.valueOf():n;n=ye(r)?r+"":r}if("string"!=typeof n)return 0===n?n:+n;n=Rs(n);var o=lo.test(n);return o||mo.test(n)?Bo(n.slice(2),o?2:8):qe.test(n)?NaN:+n}function wc(n){return kt(n,mt(n))}function he(n){return null==n?"":Ze(n)}var cu=Tn(function(n,r){if(s(r)||ct(r))kt(r,Pe(r),n);else for(var o in r)ue.call(r,o)&&Yn(n,o,r[o])}),Nc=Tn(function(n,r){kt(r,mt(r),n)}),Xa=Tn(function(n,r,o,d){kt(r,mt(r),n,d)}),mu=Tn(function(n,r,o,d){kt(r,Pe(r),n,d)}),pu=Pt(qn),gu=K(function(n,r){n=_e(n);var o=-1,d=r.length,p=d>2?r[2]:g;for(p&&Ae(r[0],r[1],p)&&(d=1);++o<d;)for(var _=r[o],f=mt(_),b=-1,C=f.length;++b<C;){var y=f[b],I=n[y];(I===g||Xt(I,Sn[y])&&!ue.call(n,y))&&(n[y]=_[y])}return n}),hu=K(function(n){return n.push(g,Ma),Je(Ec,g,n)});function ec(n,r,o){var d=null==n?g:pn(n,r);return d===g?o:d}function tc(n,r){return null!=n&&Na(n,r,ld)}var Tu=xa(function(n,r,o){null!=r&&"function"!=typeof r.toString&&(r=gi.call(r)),n[r]=o},ic(pt)),xu=xa(function(n,r,o){null!=r&&"function"!=typeof r.toString&&(r=gi.call(r)),ue.call(n,r)?n[r].push(o):n[r]=[o]},L),ku=K(tn);function Pe(n){return ct(n)?As(n):Fr(n)}function mt(n){return ct(n)?As(n,!0):function _d(n){if(!ye(n))return function E(n){var r=[];if(null!=n)for(var o in _e(n))r.push(o);return r}(n);var r=s(n),o=[];for(var d in n)"constructor"==d&&(r||!ue.call(n,d))||o.push(d);return o}(n)}var Mu=Tn(function(n,r,o){Fi(n,r,o)}),Ec=Tn(function(n,r,o,d){Fi(n,r,o,d)}),Ou=Pt(function(n,r){var o={};if(null==n)return o;var d=!1;r=je(r,function(_){return _=rn(_,n),d||(d=_.length>1),_}),kt(n,Br(n),o),d&&(o=lt(o,7,Ld));for(var p=r.length;p--;)Mi(o,r[p]);return o}),Nu=Pt(function(n,r){return null==n?{}:function bd(n,r){return la(n,r,function(o,d){return tc(n,d)})}(n,r)});function Gc(n,r){if(null==n)return{};var o=je(Br(n),function(d){return[d]});return r=L(r),la(n,o,function(d,p){return r(d,p[0])})}var Dc=Ra(Pe),Lc=Ra(mt);function Xi(n){return null==n?[]:hr(n,Pe(n))}var Yu=xn(function(n,r,o){return r=r.toLowerCase(),n+(o?Vc(r):r)});function Vc(n){return nc(he(n).toLowerCase())}function Pc(n){return(n=he(n))&&n.replace(uo,Wo).replace(Oo,"")}var Hu=xn(function(n,r,o){return n+(o?"-":"")+r.toLowerCase()}),Ju=xn(function(n,r,o){return n+(o?" ":"")+r.toLowerCase()}),Wu=ya("toLowerCase"),rg=xn(function(n,r,o){return n+(o?"_":"")+r.toLowerCase()}),ag=xn(function(n,r,o){return n+(o?" ":"")+nc(r)}),_g=xn(function(n,r,o){return n+(o?" ":"")+r.toUpperCase()}),nc=ya("toUpperCase");function Bc(n,r,o){return n=he(n),(r=o?g:r)===g?function ws(v){return Eo.test(v)}(n)?function ll(v){return v.match(wo)||[]}(n):function qo(v){return v.match(oo)||[]}(n):n.match(r)||[]}var $c=K(function(n,r){try{return Je(n,g,r)}catch(o){return Kd(o)?o:new U(o)}}),fg=Pt(function(n,r){return at(r,function(o){o=we(o),Tt(n,o,Jd(n[o],n))}),n});function ic(n){return function(){return n}}var Sg=Ta(),jg=Ta(!0);function pt(n){return n}function rc(n){return na("function"==typeof n?n:lt(n,1))}var Tg=K(function(n,r){return function(o){return tn(o,n,r)}}),xg=K(function(n,r){return function(o){return tn(n,o,r)}});function sc(n,r,o){var d=Pe(r),p=ki(r,d);null==o&&(!ye(r)||!p.length&&d.length)&&(o=r,r=n,n=this,p=ki(r,Pe(r)));var _=!(ye(o)&&"chain"in o&&!o.chain),f=gn(n);return at(p,function(b){var C=r[b];n[b]=C,f&&(n.prototype[b]=function(){var y=this.__chain__;if(_||y){var I=n(this.__wrapped__);return(I.__actions__=Qe(this.__actions__)).push({func:C,args:arguments,thisArg:n}),I.__chain__=y,I}return C.apply(n,bt([this.value()],arguments))})}),n}function ac(){}var Rg=Lr(je),Mg=Lr(Is),Og=Lr(cr);function Xc(n){return Ur(n)?mr(we(n)):function vd(n){return function(r){return pn(r,n)}}(n)}var Ng=ka(),Eg=ka(!0);function oc(){return[]}function lc(){return!1}var $g=Di(function(n,r){return n+r},0),Xg=Vr("ceil"),Ag=Di(function(n,r){return n/r},1),Ug=Vr("floor"),Wg=Di(function(n,r){return n*r},1),Kg=Vr("round"),Zg=Di(function(n,r){return n-r},0);return h.after=function yp(n,r){if("function"!=typeof r)throw new Ke(ce);return n=Z(n),function(){if(--n<1)return r.apply(this,arguments)}},h.ary=vc,h.assign=cu,h.assignIn=Nc,h.assignInWith=Xa,h.assignWith=mu,h.at=pu,h.before=Cc,h.bind=Jd,h.bindAll=fg,h.bindKey=Sc,h.castArray=function Gp(){if(!arguments.length)return[];var n=arguments[0];return H(n)?n:[n]},h.chain=_c,h.chunk=function Uc(n,r,o){r=(o?Ae(n,r,o):r===g)?1:Fe(Z(r),0);var d=null==n?0:n.length;if(!d||r<1)return[];for(var p=0,_=0,f=S(Ci(d/r));p<d;)f[_++]=dt(n,p,p+=r);return f},h.compact=function Yc(n){for(var r=-1,o=null==n?0:n.length,d=0,p=[];++r<o;){var _=n[r];_&&(p[d++]=_)}return p},h.concat=function qc(){var n=arguments.length;if(!n)return[];for(var r=S(n-1),o=arguments[0],d=n;d--;)r[d-1]=arguments[d];return bt(H(o)?Qe(o):[o],Ee(r,1))},h.cond=function bg(n){var r=null==n?0:n.length,o=L();return n=r?je(n,function(d){if("function"!=typeof d[1])throw new Ke(ce);return[o(d[0]),d[1]]}):[],K(function(d){for(var p=-1;++p<r;){var _=n[p];if(Je(_[0],this,d))return Je(_[1],this,d)}})},h.conforms=function vg(n){return function rd(n){var r=Pe(n);return function(o){return qs(o,n,r)}}(lt(n,1))},h.constant=ic,h.countBy=ep,h.create=function uu(n,r){var o=In(n);return null==r?o:Ys(o,r)},h.curry=function jc(n,r,o){var d=Vt(n,8,g,g,g,g,g,r=o?g:r);return d.placeholder=jc.placeholder,d},h.curryRight=function yc(n,r,o){var d=Vt(n,16,g,g,g,g,g,r=o?g:r);return d.placeholder=yc.placeholder,d},h.debounce=Ic,h.defaults=gu,h.defaultsDeep=hu,h.defer=Ip,h.delay=Tp,h.difference=Qc,h.differenceBy=zc,h.differenceWith=Hc,h.drop=function Jc(n,r,o){var d=null==n?0:n.length;return d?dt(n,(r=o||r===g?1:Z(r))<0?0:r,d):[]},h.dropRight=function Wc(n,r,o){var d=null==n?0:n.length;return d?dt(n,0,(r=d-(r=o||r===g?1:Z(r)))<0?0:r):[]},h.dropRightWhile=function Kc(n,r){return n&&n.length?Oi(n,L(r,3),!0,!0):[]},h.dropWhile=function Zc(n,r){return n&&n.length?Oi(n,L(r,3),!0):[]},h.fill=function em(n,r,o,d){var p=null==n?0:n.length;return p?(o&&"number"!=typeof o&&Ae(n,r,o)&&(o=0,d=p),function ad(n,r,o,d){var p=n.length;for((o=Z(o))<0&&(o=-o>p?0:p+o),(d=d===g||d>p?p:Z(d))<0&&(d+=p),d=o>d?0:Oc(d);o<d;)n[o++]=r;return n}(n,r,o,d)):[]},h.filter=function np(n,r){return(H(n)?Jt:Hs)(n,L(r,3))},h.flatMap=function sp(n,r){return Ee(Da(n,r),1)},h.flatMapDeep=function ap(n,r){return Ee(Da(n,r),le)},h.flatMapDepth=function op(n,r,o){return o=o===g?1:Z(o),Ee(Da(n,r),o)},h.flatten=pc,h.flattenDeep=function tm(n){return null!=n&&n.length?Ee(n,le):[]},h.flattenDepth=function nm(n,r){return null!=n&&n.length?Ee(n,r=r===g?1:Z(r)):[]},h.flip=function xp(n){return Vt(n,512)},h.flow=Sg,h.flowRight=jg,h.fromPairs=function im(n){for(var r=-1,o=null==n?0:n.length,d={};++r<o;){var p=n[r];d[p[0]]=p[1]}return d},h.functions=function ju(n){return null==n?[]:ki(n,Pe(n))},h.functionsIn=function yu(n){return null==n?[]:ki(n,mt(n))},h.groupBy=lp,h.initial=function sm(n){return null!=n&&n.length?dt(n,0,-1):[]},h.intersection=am,h.intersectionBy=om,h.intersectionWith=lm,h.invert=Tu,h.invertBy=xu,h.invokeMap=cp,h.iteratee=rc,h.keyBy=mp,h.keys=Pe,h.keysIn=mt,h.map=Da,h.mapKeys=function Fu(n,r){var o={};return r=L(r,3),xt(n,function(d,p,_){Tt(o,r(d,p,_),d)}),o},h.mapValues=function Ru(n,r){var o={};return r=L(r,3),xt(n,function(d,p,_){Tt(o,p,r(d,p,_))}),o},h.matches=function yg(n){return ra(lt(n,1))},h.matchesProperty=function Ig(n,r){return sa(n,lt(r,1))},h.memoize=Va,h.merge=Mu,h.mergeWith=Ec,h.method=Tg,h.methodOf=xg,h.mixin=sc,h.negate=Pa,h.nthArg=function Fg(n){return n=Z(n),K(function(r){return aa(r,n)})},h.omit=Ou,h.omitBy=function wu(n,r){return Gc(n,Pa(L(r)))},h.once=function kp(n){return Cc(2,n)},h.orderBy=function pp(n,r,o,d){return null==n?[]:(H(r)||(r=null==r?[]:[r]),H(o=d?g:o)||(o=null==o?[]:[o]),oa(n,r,o))},h.over=Rg,h.overArgs=Fp,h.overEvery=Mg,h.overSome=Og,h.partial=Wd,h.partialRight=Tc,h.partition=up,h.pick=Nu,h.pickBy=Gc,h.property=Xc,h.propertyOf=function wg(n){return function(r){return null==n?g:pn(n,r)}},h.pull=pm,h.pullAll=gc,h.pullAllBy=function um(n,r,o){return n&&n.length&&r&&r.length?Mr(n,r,L(o,2)):n},h.pullAllWith=function gm(n,r,o){return n&&n.length&&r&&r.length?Mr(n,r,g,o):n},h.pullAt=hm,h.range=Ng,h.rangeRight=Eg,h.rearg=Rp,h.reject=function _p(n,r){return(H(n)?Jt:Hs)(n,Pa(L(r,3)))},h.remove=function _m(n,r){var o=[];if(!n||!n.length)return o;var d=-1,p=[],_=n.length;for(r=L(r,3);++d<_;){var f=n[d];r(f,d,n)&&(o.push(f),p.push(d))}return da(n,p),o},h.rest=function Mp(n,r){if("function"!=typeof n)throw new Ke(ce);return K(n,r=r===g?r:Z(r))},h.reverse=zd,h.sampleSize=function bp(n,r,o){return r=(o?Ae(n,r,o):r===g)?1:Z(r),(H(n)?td:jd)(n,r)},h.set=function Gu(n,r,o){return null==n?n:Hn(n,r,o)},h.setWith=function Du(n,r,o,d){return d="function"==typeof d?d:g,null==n?n:Hn(n,r,o,d)},h.shuffle=function vp(n){return(H(n)?nd:Id)(n)},h.slice=function fm(n,r,o){var d=null==n?0:n.length;return d?(o&&"number"!=typeof o&&Ae(n,r,o)?(r=0,o=d):(r=null==r?0:Z(r),o=o===g?d:Z(o)),dt(n,r,o)):[]},h.sortBy=jp,h.sortedUniq=function Im(n){return n&&n.length?ma(n):[]},h.sortedUniqBy=function Tm(n,r){return n&&n.length?ma(n,L(r,2)):[]},h.split=function sg(n,r,o){return o&&"number"!=typeof o&&Ae(n,r,o)&&(r=o=g),(o=o===g?ze:o>>>0)?(n=he(n))&&("string"==typeof r||null!=r&&!Zd(r))&&!(r=Ze(r))&&vn(n)?sn(vt(n),0,o):n.split(r,o):[]},h.spread=function Op(n,r){if("function"!=typeof n)throw new Ke(ce);return r=null==r?0:Fe(Z(r),0),K(function(o){var d=o[r],p=sn(o,0,r);return d&&bt(p,d),Je(n,this,p)})},h.tail=function xm(n){var r=null==n?0:n.length;return r?dt(n,1,r):[]},h.take=function km(n,r,o){return n&&n.length?dt(n,0,(r=o||r===g?1:Z(r))<0?0:r):[]},h.takeRight=function Fm(n,r,o){var d=null==n?0:n.length;return d?dt(n,(r=d-(r=o||r===g?1:Z(r)))<0?0:r,d):[]},h.takeRightWhile=function Rm(n,r){return n&&n.length?Oi(n,L(r,3),!1,!0):[]},h.takeWhile=function Mm(n,r){return n&&n.length?Oi(n,L(r,3)):[]},h.tap=function Ym(n,r){return r(n),n},h.throttle=function wp(n,r,o){var d=!0,p=!0;if("function"!=typeof n)throw new Ke(ce);return ye(o)&&(d="leading"in o?!!o.leading:d,p="trailing"in o?!!o.trailing:p),Ic(n,r,{leading:d,maxWait:r,trailing:p})},h.thru=Ga,h.toArray=Mc,h.toPairs=Dc,h.toPairsIn=Lc,h.toPath=function Pg(n){return H(n)?je(n,we):St(n)?[n]:Qe(Oe(he(n)))},h.toPlainObject=wc,h.transform=function Lu(n,r,o){var d=H(n),p=d||Fn(n)||$i(n);if(r=L(r,4),null==o){var _=n&&n.constructor;o=p?d?new _:[]:ye(n)&&gn(_)?In(fi(n)):{}}return(p?at:xt)(n,function(f,b,C){return r(o,f,b,C)}),o},h.unary=function Np(n){return vc(n,1)},h.union=Om,h.unionBy=wm,h.unionWith=Nm,h.uniq=function Em(n){return n&&n.length?nn(n):[]},h.uniqBy=function Gm(n,r){return n&&n.length?nn(n,L(r,2)):[]},h.uniqWith=function Dm(n,r){return r="function"==typeof r?r:g,n&&n.length?nn(n,g,r):[]},h.unset=function Vu(n,r){return null==n||Mi(n,r)},h.unzip=Hd,h.unzipWith=hc,h.update=function Pu(n,r,o){return null==n?n:ua(n,r,Gr(o))},h.updateWith=function Bu(n,r,o,d){return d="function"==typeof d?d:g,null==n?n:ua(n,r,Gr(o),d)},h.values=Xi,h.valuesIn=function $u(n){return null==n?[]:hr(n,mt(n))},h.without=Lm,h.words=Bc,h.wrap=function Ep(n,r){return Wd(Gr(r),n)},h.xor=Vm,h.xorBy=Pm,h.xorWith=Bm,h.zip=$m,h.zipObject=function Xm(n,r){return ga(n||[],r||[],Yn)},h.zipObjectDeep=function Am(n,r){return ga(n||[],r||[],Hn)},h.zipWith=Um,h.entries=Dc,h.entriesIn=Lc,h.extend=Nc,h.extendWith=Xa,sc(h,h),h.add=$g,h.attempt=$c,h.camelCase=Yu,h.capitalize=Vc,h.ceil=Xg,h.clamp=function Xu(n,r,o){return o===g&&(o=r,r=g),o!==g&&(o=(o=Rt(o))==o?o:0),r!==g&&(r=(r=Rt(r))==r?r:0),Zt(Rt(n),r,o)},h.clone=function Dp(n){return lt(n,4)},h.cloneDeep=function Vp(n){return lt(n,5)},h.cloneDeepWith=function Pp(n,r){return lt(n,5,r="function"==typeof r?r:g)},h.cloneWith=function Lp(n,r){return lt(n,4,r="function"==typeof r?r:g)},h.conformsTo=function Bp(n,r){return null==r||qs(n,r,Pe(r))},h.deburr=Pc,h.defaultTo=function Cg(n,r){return null==n||n!=n?r:n},h.divide=Ag,h.endsWith=function qu(n,r,o){n=he(n),r=Ze(r);var d=n.length,p=o=o===g?d:Zt(Z(o),0,d);return(o-=r.length)>=0&&n.slice(o,p)==r},h.eq=Xt,h.escape=function Qu(n){return(n=he(n))&&Za.test(n)?n.replace(Kr,Ko):n},h.escapeRegExp=function zu(n){return(n=he(n))&&so.test(n)?n.replace(er,"\\$&"):n},h.every=function tp(n,r,o){var d=H(n)?Is:sd;return o&&Ae(n,r,o)&&(r=g),d(n,L(r,3))},h.find=ip,h.findIndex=cc,h.findKey=function _u(n,r){return Ts(n,L(r,3),xt)},h.findLast=rp,h.findLastIndex=mc,h.findLastKey=function fu(n,r){return Ts(n,L(r,3),Ir)},h.floor=Ug,h.forEach=fc,h.forEachRight=bc,h.forIn=function bu(n,r){return null==n?n:yr(n,L(r,3),mt)},h.forInRight=function vu(n,r){return null==n?n:Js(n,L(r,3),mt)},h.forOwn=function Cu(n,r){return n&&xt(n,L(r,3))},h.forOwnRight=function Su(n,r){return n&&Ir(n,L(r,3))},h.get=ec,h.gt=$p,h.gte=Xp,h.has=function Iu(n,r){return null!=n&&Na(n,r,od)},h.hasIn=tc,h.head=uc,h.identity=pt,h.includes=function dp(n,r,o,d){n=ct(n)?n:Xi(n),o=o&&!d?Z(o):0;var p=n.length;return o<0&&(o=Fe(p+o,0)),$a(n)?o<=p&&n.indexOf(r,o)>-1:!!p&&bn(n,r,o)>-1},h.indexOf=function rm(n,r,o){var d=null==n?0:n.length;if(!d)return-1;var p=null==o?0:Z(o);return p<0&&(p=Fe(d+p,0)),bn(n,r,p)},h.inRange=function Au(n,r,o){return r=hn(r),o===g?(o=r,r=0):o=hn(o),function dd(n,r,o){return n>=Le(r,o)&&n<Fe(r,o)}(n=Rt(n),r,o)},h.invoke=ku,h.isArguments=Wn,h.isArray=H,h.isArrayBuffer=Ap,h.isArrayLike=ct,h.isArrayLikeObject=Re,h.isBoolean=function Up(n){return!0===n||!1===n||xe(n)&&Xe(n)==Rn},h.isBuffer=Fn,h.isDate=Yp,h.isElement=function qp(n){return xe(n)&&1===n.nodeType&&!qr(n)},h.isEmpty=function Qp(n){if(null==n)return!0;if(ct(n)&&(H(n)||"string"==typeof n||"function"==typeof n.splice||Fn(n)||$i(n)||Wn(n)))return!n.length;var r=Ve(n);if(r==ht||r==_t)return!n.size;if(s(n))return!Fr(n).length;for(var o in n)if(ue.call(n,o))return!1;return!0},h.isEqual=function zp(n,r){return zn(n,r)},h.isEqualWith=function Hp(n,r,o){var d=(o="function"==typeof o?o:g)?o(n,r):g;return d===g?zn(n,r,g,o):!!d},h.isError=Kd,h.isFinite=function Jp(n){return"number"==typeof n&&Bs(n)},h.isFunction=gn,h.isInteger=xc,h.isLength=Ba,h.isMap=kc,h.isMatch=function Wp(n,r){return n===r||kr(n,r,Xr(r))},h.isMatchWith=function Kp(n,r,o){return o="function"==typeof o?o:g,kr(n,r,Xr(r),o)},h.isNaN=function Zp(n){return Fc(n)&&n!=+n},h.isNative=function eu(n){if(t(n))throw new U("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return ta(n)},h.isNil=function nu(n){return null==n},h.isNull=function tu(n){return null===n},h.isNumber=Fc,h.isObject=ye,h.isObjectLike=xe,h.isPlainObject=qr,h.isRegExp=Zd,h.isSafeInteger=function iu(n){return xc(n)&&n>=-Se&&n<=Se},h.isSet=Rc,h.isString=$a,h.isSymbol=St,h.isTypedArray=$i,h.isUndefined=function ru(n){return n===g},h.isWeakMap=function su(n){return xe(n)&&Ve(n)==En},h.isWeakSet=function au(n){return xe(n)&&"[object WeakSet]"==Xe(n)},h.join=function dm(n,r){return null==n?"":Cl.call(n,r)},h.kebabCase=Hu,h.last=Ft,h.lastIndexOf=function cm(n,r,o){var d=null==n?0:n.length;if(!d)return-1;var p=d;return o!==g&&(p=(p=Z(o))<0?Fe(d+p,0):Le(p,d-1)),r==r?function rl(v,j,S){for(var w=S+1;w--;)if(v[w]===j)return w;return w}(n,r,p):li(n,xs,p,!0)},h.lowerCase=Ju,h.lowerFirst=Wu,h.lt=ou,h.lte=lu,h.max=function Yg(n){return n&&n.length?xi(n,pt,Tr):g},h.maxBy=function qg(n,r){return n&&n.length?xi(n,L(r,2),Tr):g},h.mean=function Qg(n){return ks(n,pt)},h.meanBy=function zg(n,r){return ks(n,L(r,2))},h.min=function Hg(n){return n&&n.length?xi(n,pt,Rr):g},h.minBy=function Jg(n,r){return n&&n.length?xi(n,L(r,2),Rr):g},h.stubArray=oc,h.stubFalse=lc,h.stubObject=function Gg(){return{}},h.stubString=function Dg(){return""},h.stubTrue=function Lg(){return!0},h.multiply=Wg,h.nth=function mm(n,r){return n&&n.length?aa(n,Z(r)):g},h.noConflict=function kg(){return Ne._===this&&(Ne._=gl),this},h.noop=ac,h.now=La,h.pad=function Ku(n,r,o){n=he(n);var d=(r=Z(r))?Cn(n):0;if(!r||d>=r)return n;var p=(r-d)/2;return Li(Si(p),o)+n+Li(Ci(p),o)},h.padEnd=function Zu(n,r,o){n=he(n);var d=(r=Z(r))?Cn(n):0;return r&&d<r?n+Li(r-d,o):n},h.padStart=function eg(n,r,o){n=he(n);var d=(r=Z(r))?Cn(n):0;return r&&d<r?Li(r-d,o)+n:n},h.parseInt=function tg(n,r,o){return o||null==r?r=0:r&&(r=+r),yl(he(n).replace(tr,""),r||0)},h.random=function Uu(n,r,o){if(o&&"boolean"!=typeof o&&Ae(n,r,o)&&(r=o=g),o===g&&("boolean"==typeof r?(o=r,r=g):"boolean"==typeof n&&(o=n,n=g)),n===g&&r===g?(n=0,r=1):(n=hn(n),r===g?(r=n,n=0):r=hn(r)),n>r){var d=n;n=r,r=d}if(o||n%1||r%1){var p=$s();return Le(n+p*(r-n+Po("1e-"+((p+"").length-1))),r)}return Or(n,r)},h.reduce=function gp(n,r,o){var d=H(n)?Vn:Fs,p=arguments.length<3;return d(n,L(r,4),o,p,en)},h.reduceRight=function hp(n,r,o){var d=H(n)?oi:Fs,p=arguments.length<3;return d(n,L(r,4),o,p,zs)},h.repeat=function ng(n,r,o){return r=(o?Ae(n,r,o):r===g)?1:Z(r),wr(he(n),r)},h.replace=function ig(){var n=arguments,r=he(n[0]);return n.length<3?r:r.replace(n[1],n[2])},h.result=function Eu(n,r,o){var d=-1,p=(r=rn(r,n)).length;for(p||(p=1,n=g);++d<p;){var _=null==n?g:n[we(r[d])];_===g&&(d=p,_=o),n=gn(_)?_.call(n):_}return n},h.round=Kg,h.runInContext=v,h.sample=function fp(n){return(H(n)?Us:Sd)(n)},h.size=function Cp(n){if(null==n)return 0;if(ct(n))return $a(n)?Cn(n):n.length;var r=Ve(n);return r==ht||r==_t?n.size:Fr(n).length},h.snakeCase=rg,h.some=function Sp(n,r,o){var d=H(n)?cr:Td;return o&&Ae(n,r,o)&&(r=g),d(n,L(r,3))},h.sortedIndex=function bm(n,r){return Ri(n,r)},h.sortedIndexBy=function vm(n,r,o){return Nr(n,r,L(o,2))},h.sortedIndexOf=function Cm(n,r){var o=null==n?0:n.length;if(o){var d=Ri(n,r);if(d<o&&Xt(n[d],r))return d}return-1},h.sortedLastIndex=function Sm(n,r){return Ri(n,r,!0)},h.sortedLastIndexBy=function jm(n,r,o){return Nr(n,r,L(o,2),!0)},h.sortedLastIndexOf=function ym(n,r){if(null!=n&&n.length){var d=Ri(n,r,!0)-1;if(Xt(n[d],r))return d}return-1},h.startCase=ag,h.startsWith=function og(n,r,o){return n=he(n),o=null==o?0:Zt(Z(o),0,n.length),r=Ze(r),n.slice(o,o+r.length)==r},h.subtract=Zg,h.sum=function e1(n){return n&&n.length?ur(n,pt):0},h.sumBy=function t1(n,r){return n&&n.length?ur(n,L(r,2)):0},h.template=function lg(n,r,o){var d=h.templateSettings;o&&Ae(n,r,o)&&(r=g),n=he(n),r=Xa({},r,d,an);var b,C,p=Xa({},r.imports,d.imports,an),_=Pe(p),f=hr(p,_),y=0,I=r.interpolate||ii,T="__p += '",M=fr((r.escape||ii).source+"|"+I.source+"|"+(I===Zr?Ye:ii).source+"|"+(r.evaluate||ii).source+"|$","g"),G="//# sourceURL="+(ue.call(r,"sourceURL")?(r.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Do+"]")+"\n";n.replace(M,function($,re,ae,jt,et,yt){return ae||(ae=jt),T+=n.slice(y,yt).replace(go,Zo),re&&(b=!0,T+="' +\n__e("+re+") +\n'"),et&&(C=!0,T+="';\n"+et+";\n__p += '"),ae&&(T+="' +\n((__t = ("+ae+")) == null ? '' : __t) +\n'"),y=yt+$.length,$}),T+="';\n";var B=ue.call(r,"variable")&&r.variable;if(B){if(He.test(B))throw new U("Invalid `variable` option passed into `_.template`")}else T="with (obj) {\n"+T+"\n}\n";T=(C?T.replace(Ha,""):T).replace(Ja,"$1").replace(Wa,"$1;"),T="function("+(B||"obj")+") {\n"+(B?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(b?", __e = _.escape":"")+(C?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+T+"return __p\n}";var te=$c(function(){return de(_,G+"return "+T).apply(g,f)});if(te.source=T,Kd(te))throw te;return te},h.times=function Vg(n,r){if((n=Z(n))<1||n>Se)return[];var o=ze,d=Le(n,ze);r=L(r),n-=ze;for(var p=gr(d,r);++o<n;)r(o);return p},h.toFinite=hn,h.toInteger=Z,h.toLength=Oc,h.toLower=function dg(n){return he(n).toLowerCase()},h.toNumber=Rt,h.toSafeInteger=function du(n){return n?Zt(Z(n),-Se,Se):0===n?n:0},h.toString=he,h.toUpper=function cg(n){return he(n).toUpperCase()},h.trim=function mg(n,r,o){if((n=he(n))&&(o||r===g))return Rs(n);if(!n||!(r=Ze(r)))return n;var d=vt(n),p=vt(r);return sn(d,Ms(d,p),Os(d,p)+1).join("")},h.trimEnd=function pg(n,r,o){if((n=he(n))&&(o||r===g))return n.slice(0,Es(n)+1);if(!n||!(r=Ze(r)))return n;var d=vt(n);return sn(d,0,Os(d,vt(r))+1).join("")},h.trimStart=function ug(n,r,o){if((n=he(n))&&(o||r===g))return n.replace(tr,"");if(!n||!(r=Ze(r)))return n;var d=vt(n);return sn(d,Ms(d,vt(r))).join("")},h.truncate=function gg(n,r){var o=30,d="...";if(ye(r)){var p="separator"in r?r.separator:p;o="length"in r?Z(r.length):o,d="omission"in r?Ze(r.omission):d}var _=(n=he(n)).length;if(vn(n)){var f=vt(n);_=f.length}if(o>=_)return n;var b=o-Cn(d);if(b<1)return d;var C=f?sn(f,0,b).join(""):n.slice(0,b);if(p===g)return C+d;if(f&&(b+=C.length-b),Zd(p)){if(n.slice(b).search(p)){var y,I=C;for(p.global||(p=fr(p.source,he($e.exec(p))+"g")),p.lastIndex=0;y=p.exec(I);)var T=y.index;C=C.slice(0,T===g?b:T)}}else if(n.indexOf(Ze(p),b)!=b){var M=C.lastIndexOf(p);M>-1&&(C=C.slice(0,M))}return C+d},h.unescape=function hg(n){return(n=he(n))&&Ka.test(n)?n.replace(Wr,sl):n},h.uniqueId=function Bg(n){var r=++pl;return he(n)+r},h.upperCase=_g,h.upperFirst=nc,h.each=fc,h.eachRight=bc,h.first=uc,sc(h,function(){var n={};return xt(h,function(r,o){ue.call(h.prototype,o)||(n[o]=r)}),n}(),{chain:!1}),h.VERSION="4.17.21",at(["bind","bindKey","curry","curryRight","partial","partialRight"],function(n){h[n].placeholder=h}),at(["drop","take"],function(n,r){ne.prototype[n]=function(o){o=o===g?1:Fe(Z(o),0);var d=this.__filtered__&&!r?new ne(this):this.clone();return d.__filtered__?d.__takeCount__=Le(o,d.__takeCount__):d.__views__.push({size:Le(o,ze),type:n+(d.__dir__<0?"Right":"")}),d},ne.prototype[n+"Right"]=function(o){return this.reverse()[n](o).reverse()}}),at(["filter","map","takeWhile"],function(n,r){var o=r+1,d=1==o||3==o;ne.prototype[n]=function(p){var _=this.clone();return _.__iteratees__.push({iteratee:L(p,3),type:o}),_.__filtered__=_.__filtered__||d,_}}),at(["head","last"],function(n,r){var o="take"+(r?"Right":"");ne.prototype[n]=function(){return this[o](1).value()[0]}}),at(["initial","tail"],function(n,r){var o="drop"+(r?"":"Right");ne.prototype[n]=function(){return this.__filtered__?new ne(this):this[o](1)}}),ne.prototype.compact=function(){return this.filter(pt)},ne.prototype.find=function(n){return this.filter(n).head()},ne.prototype.findLast=function(n){return this.reverse().find(n)},ne.prototype.invokeMap=K(function(n,r){return"function"==typeof n?new ne(this):this.map(function(o){return tn(o,n,r)})}),ne.prototype.reject=function(n){return this.filter(Pa(L(n)))},ne.prototype.slice=function(n,r){n=Z(n);var o=this;return o.__filtered__&&(n>0||r<0)?new ne(o):(n<0?o=o.takeRight(-n):n&&(o=o.drop(n)),r!==g&&(o=(r=Z(r))<0?o.dropRight(-r):o.take(r-n)),o)},ne.prototype.takeRightWhile=function(n){return this.reverse().takeWhile(n).reverse()},ne.prototype.toArray=function(){return this.take(ze)},xt(ne.prototype,function(n,r){var o=/^(?:filter|find|map|reject)|While$/.test(r),d=/^(?:head|last)$/.test(r),p=h[d?"take"+("last"==r?"Right":""):r],_=d||/^find/.test(r);p&&(h.prototype[r]=function(){var f=this.__wrapped__,b=d?[1]:arguments,C=f instanceof ne,y=b[0],I=C||H(f),T=function(re){var ae=p.apply(h,bt([re],b));return d&&M?ae[0]:ae};I&&o&&"function"==typeof y&&1!=y.length&&(C=I=!1);var M=this.__chain__,B=_&&!M,te=C&&!this.__actions__.length;if(!_&&I){f=te?f:new ne(this);var $=n.apply(f,b);return $.__actions__.push({func:Ga,args:[T],thisArg:g}),new ot($,M)}return B&&te?n.apply(this,b):($=this.thru(T),B?d?$.value()[0]:$.value():$)})}),at(["pop","push","shift","sort","splice","unshift"],function(n){var r=mi[n],o=/^(?:push|sort|unshift)$/.test(n)?"tap":"thru",d=/^(?:pop|shift)$/.test(n);h.prototype[n]=function(){var p=arguments;if(d&&!this.__chain__){var _=this.value();return r.apply(H(_)?_:[],p)}return this[o](function(f){return r.apply(H(f)?f:[],p)})}}),xt(ne.prototype,function(n,r){var o=h[r];if(o){var d=o.name+"";ue.call(yn,d)||(yn[d]=[]),yn[d].push({name:r,func:o})}}),yn[Gi(g,2).name]=[{name:"wrapper",func:g}],ne.prototype.clone=function Ml(){var n=new ne(this.__wrapped__);return n.__actions__=Qe(this.__actions__),n.__dir__=this.__dir__,n.__filtered__=this.__filtered__,n.__iteratees__=Qe(this.__iteratees__),n.__takeCount__=this.__takeCount__,n.__views__=Qe(this.__views__),n},ne.prototype.reverse=function Ol(){if(this.__filtered__){var n=new ne(this);n.__dir__=-1,n.__filtered__=!0}else(n=this.clone()).__dir__*=-1;return n},ne.prototype.value=function wl(){var n=this.__wrapped__.value(),r=this.__dir__,o=H(n),d=r<0,p=o?n.length:0,_=function $d(n,r,o){for(var d=-1,p=o.length;++d<p;){var _=o[d],f=_.size;switch(_.type){case"drop":n+=f;break;case"dropRight":r-=f;break;case"take":r=Le(r,n+f);break;case"takeRight":n=Fe(n,r-f)}}return{start:n,end:r}}(0,p,this.__views__),f=_.start,b=_.end,C=b-f,y=d?b:f-1,I=this.__iteratees__,T=I.length,M=0,G=Le(C,this.__takeCount__);if(!o||!d&&p==C&&G==C)return wi(n,this.__actions__);var B=[];e:for(;C--&&M<G;){for(var te=-1,$=n[y+=r];++te<T;){var re=I[te],jt=re.type,et=(0,re.iteratee)($);if(2==jt)$=et;else if(!et){if(1==jt)continue e;break e}}B[M++]=$}return B},h.prototype.at=qm,h.prototype.chain=function Qm(){return _c(this)},h.prototype.commit=function zm(){return new ot(this.value(),this.__chain__)},h.prototype.next=function Hm(){this.__values__===g&&(this.__values__=Mc(this.value()));var n=this.__index__>=this.__values__.length;return{done:n,value:n?g:this.__values__[this.__index__++]}},h.prototype.plant=function Wm(n){for(var r,o=this;o instanceof Ii;){var d=dc(o);d.__index__=0,d.__values__=g,r?p.__wrapped__=d:r=d;var p=d;o=o.__wrapped__}return p.__wrapped__=n,r},h.prototype.reverse=function Km(){var n=this.__wrapped__;if(n instanceof ne){var r=n;return this.__actions__.length&&(r=new ne(this)),(r=r.reverse()).__actions__.push({func:Ga,args:[zd],thisArg:g}),new ot(r,this.__chain__)}return this.thru(zd)},h.prototype.toJSON=h.prototype.valueOf=h.prototype.value=function Zm(){return wi(this.__wrapped__,this.__actions__)},h.prototype.first=h.prototype.head,Bn&&(h.prototype[Bn]=function Jm(){return this}),h}();Ne._=ci,(k=function(){return ci}.call(tt,x,tt,Mt))!==g&&(Mt.exports=k)}.call(this)}}]);