"use strict";(self.webpackChunkvelzon=self.webpackChunkvelzon||[]).push([[76],{94562:(E,l,s)=>{s.d(l,{c:()=>u});var t=s(67569),_=s(45312),i=s(54438),c=s(21626);let u=(()=>{class r extends t.d{constructor(e){super(e,_.c.apiUrl+"Position/")}deleteTarget(e){return this.http.delete(this.baseUrl+e)}GetPositionsByDepartment(e){return this.http.get(this.baseUrl+"GetPositionsByDepartment/"+e)}GetHeadDropDown(){return this.http.get(this.baseUrl+"GetHeadDropDown")}GetDropDown(){return this.http.get(this.baseUrl+"GetDropDown")}GetManagementChainAsync(e){return this.http.get(this.baseUrl+"GetManagementChainAsync/"+e)}delete(e){return this.http.delete(`${this.baseUrl}SoftDelete/${e}`,this.httpOptions)}static{this.\u0275fac=function(n){return new(n||r)(i.KVO(c.Qq))}}static{this.\u0275prov=i.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})()},91020:(E,l,s)=>{s.d(l,{e:()=>u});var t=s(67569),_=s(45312),i=s(54438),c=s(21626);let u=(()=>{class r extends t.d{constructor(e){super(e,_.c.apiUrl+"CancelReason/")}static{this.\u0275fac=function(n){return new(n||r)(i.KVO(c.Qq))}}static{this.\u0275prov=i.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})()},35419:(E,l,s)=>{s.d(l,{S:()=>u});var t=s(67569),_=s(45312),i=s(54438),c=s(21626);let u=(()=>{class r extends t.d{constructor(e){super(e,_.c.apiUrl+"Region/")}static{this.\u0275fac=function(n){return new(n||r)(i.KVO(c.Qq))}}static{this.\u0275prov=i.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})()},75312:(E,l,s)=>{s.d(l,{Y:()=>u});var t=s(67569),_=s(45312),i=s(54438),c=s(21626);let u=(()=>{class r extends t.d{constructor(e){super(e,_.c.apiUrl+"ReturnReason/")}static{this.\u0275fac=function(n){return new(n||r)(i.KVO(c.Qq))}}static{this.\u0275prov=i.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})()},84205:(E,l,s)=>{s.d(l,{t:()=>u});var t=s(67569),_=s(45312),i=s(54438),c=s(21626);let u=(()=>{class r extends t.d{constructor(e){super(e,_.c.apiUrl+"ClientGroup/")}static{this.\u0275fac=function(n){return new(n||r)(i.KVO(c.Qq))}}static{this.\u0275prov=i.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})()},34578:(E,l,s)=>{s.d(l,{N:()=>u});var t=s(67569),_=s(45312),i=s(54438),c=s(21626);let u=(()=>{class r extends t.d{constructor(e){super(e,_.c.apiUrl+"PositionName/")}static{this.\u0275fac=function(n){return new(n||r)(i.KVO(c.Qq))}}static{this.\u0275prov=i.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})()},45943:(E,l,s)=>{s.d(l,{L:()=>u});var t=s(67569),_=s(45312),i=s(54438),c=s(21626);let u=(()=>{class r extends t.d{constructor(e){super(e,_.c.apiUrl+"ProductOffer/")}GetLookups(){return this.http.get(this.baseUrl+"GetLookups")}GetActiveOffer(){return this.http.get(this.baseUrl+"GetActiveOffer")}checkItemOffer(e,n){return this.checkOffers(e,n)}checkOffers(e,n){const d=n.filter(o=>{const m=o.productServicesX.map(v=>v.id),O=e.items.filter(v=>m.includes(v.itemId)&&!v.isFree).reduce((v,a)=>v+a.quantity,0);if(6===o.offerType){const v=o.productOfferQuantities.filter(a=>O>=a.quantityX);if(v.length){const a=v.reduce((f,p)=>p.quantityX>f.quantityX?p:f);return o.quantityX=a.quantityX,o.quantityY=a.quantityY,!0}return!1}return O>=o.quantityX});return 0===d.length?(e.itemsOffers=[],e.items=e.items.filter(o=>!o.isFree),e):(e.itemsOffers=[],e.offerNames=[],d.forEach(o=>{[1,6].includes(o.offerType)&&this.checkOfferXToY(e,o)}),e)}checkOfferXToY(e,n){const d=e.items.reduce((m,h)=>m+(n.productServicesX.some(v=>v.id===h.itemId&&!h.isFree)?h.quantity:0),0);if(n.quantityY=this.getBestQuantity(d,n),e.items.some(m=>n.productServicesX.some(h=>h.id===m.itemId))&&d>=n.quantityX){n.productServicesY.forEach(h=>{h.isSelected=!1,h.quantityY=n.quantityY}),e.offerNames.push({id:n.id,title:n.title,isSelected:!1,count:n.productServicesY.length});const m=6===n.offerType?this.resetQuantityX(n.quantityY,n.productServicesY):n.productServicesY;e.itemsOffers.push(...m)}else e.itemsOffers=[];return this.updateLimit(e)}updateLimit(e){return e.items.filter(n=>n.isFree).forEach(n=>{const d=e.itemsOffers.find(o=>o.id===n.itemId);d&&(n.quantityY=d.quantityY,n.quantity=Math.min(n.quantity,d.quantityY))}),e.items=this.removeExceededOfferItems(e.items),e}removeExceededOfferItems(e){const n={};e.forEach(o=>{const m=o.offerId;n[m]||(n[m]={total:0,max:o.quantityY}),n[m].total+=o.quantity});const d=Object.entries(n).filter(([o,m])=>m.total>m.max).map(([o])=>+o);return e.filter(o=>!d.includes(o.offerId))}resetQuantityX(e,n){return n.map(d=>({...d,quantityY:e}))}getBestQuantity(e,n){let d=e,o=0;const m=[...n.productOfferQuantities].sort((h,O)=>O.quantityX-h.quantityX);for(let h of m){const O=Math.floor(d/h.quantityX);O>0&&(o+=O*h.quantityY,d-=O*h.quantityX)}return o}static{this.\u0275fac=function(n){return new(n||r)(i.KVO(c.Qq))}}static{this.\u0275prov=i.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})()},63022:(E,l,s)=>{s.d(l,{U:()=>u});var t=s(67569),_=s(45312),i=s(54438),c=s(21626);let u=(()=>{class r extends t.d{constructor(e){super(e,_.c.apiUrl+"Invoice/")}SaveInvoice(e){return this.http.post(this.baseUrl+"SaveInvoice",e)}GetOrderServiceAndPayment(e){return this.http.get(this.baseUrl+`GetOrderServiceAndPayment/${e}`)}GetByCode(e){return this.http.get(this.baseUrl+`GetByCode/${e}`)}static{this.\u0275fac=function(n){return new(n||r)(i.KVO(c.Qq))}}static{this.\u0275prov=i.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})()},70072:(E,l,s)=>{s.d(l,{A:()=>r});var t=s(84412),_=s(67569),i=s(45312),c=s(54438),u=s(21626);let r=(()=>{class g extends _.d{constructor(n){super(n,i.c.apiUrl+"OfferOrder/"),this.checkValidationSource=new t.t(!0),this.checkValidation=this.checkValidationSource.asObservable(),this.GetOrderCountSource=new t.t(!0),this.GetOrderCount=this.GetOrderCountSource.asObservable(),this.removeServiceQ=new t.t(0),this.removeService=this.removeServiceQ.asObservable(),this.removeServiceOfferQ=new t.t(0),this.removeServiceOffer=this.removeServiceOfferQ.asObservable(),this.discountTypes=[{id:1,name:"Cost"},{id:2,name:"Precentage"}],this.salesOrderForm={itemsOffers:[],id:null,clientLocationId:0,clientVisitDate:new Date,clientId:0,notes:"",items:[],discountAmount:0,discountAmountAdd:0,total:0,agent:{},orderLocations:{},discountType:1,discountTypeAdd:1,isPrecentage:!0,isPrecentageAdd:!1,totalAddDiscountType:0,totalAddDiscount:0,serviceCategoryCode:0,isCustomerDataValid:!1},this.requesturl=i.c.apiUrl+"salesRequest/"}getLookups(){return this.http.get(this.baseUrl+"Lookups")}changStatus(n){return this.http.put(this.baseUrl+"ChangeStatus/",n)}UpdateQuantity(n){return this.http.put(this.baseUrl+"UpdateQuantity",n)}updateTruck(n){return this.http.put(this.baseUrl+"updateTruck",n)}GetTrucks(n){return this.http.post(this.baseUrl+"GetTrucks/",n)}CancelOfferOrder(n){return this.http.post(this.baseUrl+"CancelOfferOrder",n)}GetOfferOrderCount(){return this.http.get(this.baseUrl+"OfferOrderCount")}GetOfferOrderStoreCount(){return this.http.get(this.baseUrl+"GetOfferOrderStoreCount")}GetAssignSalesOrder(){return this.http.get(this.baseUrl+"GetAssignSalesOrder")}GetOrderDetail(n){return this.http.get(this.baseUrl+"GetOrderDetail/"+n)}RequestChangeQuantity(n){return this.http.post(this.baseUrl+"RequestChangeQuantity/",n)}GetOrderStore(n){return this.http.post(this.baseUrl+"GetOrderStore/",n)}PrintSalesOrder(n){return this.http.get(this.baseUrl+"PrintSalesOrder/"+n,{responseType:"blob"})}PrintStoreReport(n){return this.http.get(this.baseUrl+"PrintStoreReport/"+n,{responseType:"blob"})}registerRequestSales(n){return this.http.post(this.requesturl+"register",n)}static{this.\u0275fac=function(d){return new(d||g)(c.KVO(u.Qq))}}static{this.\u0275prov=c.jDH({token:g,factory:g.\u0275fac,providedIn:"root"})}}return g})()},34618:(E,l,s)=>{s.d(l,{S:()=>u});var t=s(67569),_=s(45312),i=s(54438),c=s(21626);let u=(()=>{class r extends t.d{constructor(e){super(e,_.c.apiUrl+"Unit/")}ToDelete(e){return this.http.delete(`${this.baseUrl}${e}`)}ToEdit(e,n){return this.http.put(this.baseUrl+"Edit/"+e,n)}static{this.\u0275fac=function(n){return new(n||r)(i.KVO(c.Qq))}}static{this.\u0275prov=i.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})()},69433:(E,l,s)=>{s.d(l,{a:()=>u});var t=s(67569),_=s(45312),i=s(54438),c=s(21626);let u=(()=>{class r extends t.d{constructor(e){super(e,_.c.apiUrl+"Store/")}ToDelete(e){return this.http.delete(`${this.baseUrl}${e}`)}ToEdit(e,n){return this.http.put(this.baseUrl+"Edit/"+e,n)}static{this.\u0275fac=function(n){return new(n||r)(i.KVO(c.Qq))}}static{this.\u0275prov=i.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})()},90094:(E,l,s)=>{s.d(l,{_:()=>i});var t=s(45312),_=s(54438);let i=(()=>{class c{constructor(){this.key=t.c.cryptKey}encode(r){return r}decode(r){return r}static{this.\u0275fac=function(g){return new(g||c)}}static{this.\u0275prov=_.jDH({token:c,factory:c.\u0275fac,providedIn:"root"})}}return c})()},26366:(E,l,s)=>{s.d(l,{x:()=>v});var t=s(54438),_=s(75922),i=s(60177),c=s(8147);function u(a,f){1&a&&(t.j41(0,"p",18),t.nrm(1,"span",19),t.k0s())}function r(a,f){if(1&a&&(t.j41(0,"span",20),t.nrm(1,"i",21),t.EFF(2),t.k0s()),2&a){const p=t.XpG();t.R7$(2),t.SpI(" ",p.client.clientName,"")}}function g(a,f){1&a&&(t.j41(0,"p",18),t.nrm(1,"span",19),t.k0s())}function e(a,f){if(1&a&&(t.j41(0,"span",22),t.nrm(1,"i",21),t.EFF(2),t.k0s()),2&a){const p=t.XpG();t.R7$(2),t.SpI(" ",p.client.creditLimit,"")}}function n(a,f){1&a&&(t.j41(0,"p",18),t.nrm(1,"span",23),t.k0s())}function d(a,f){if(1&a&&(t.j41(0,"span",24),t.nrm(1,"i",21),t.EFF(2),t.nI1(3,"date"),t.k0s()),2&a){const p=t.XpG();t.R7$(2),t.SpI("",t.i5U(3,1,p.client.lastTransactionDate,"yyyy-MM-dd ")," ")}}function o(a,f){1&a&&(t.j41(0,"p",18),t.nrm(1,"span",25),t.k0s())}function m(a,f){if(1&a&&(t.j41(0,"span",26),t.nrm(1,"i",21),t.EFF(2),t.k0s()),2&a){const p=t.XpG();t.R7$(2),t.Lme(" ",p.client.clientQuantity," - ",p.client.clientInvoiceCost," ")}}function h(a,f){1&a&&(t.j41(0,"p",18),t.nrm(1,"span",27),t.k0s())}function O(a,f){if(1&a&&(t.j41(0,"span",28),t.nrm(1,"i",21),t.EFF(2),t.k0s()),2&a){const p=t.XpG();t.R7$(2),t.SpI("",p.client.totalDebt," ")}}let v=(()=>{class a{constructor(p){this.clientService=p,this.dismiss=new t.bkB,this.clientId=0,this.client={},this.objectKeys=Object.keys}ngOnInit(){this.getClientSummary()}getClientSummary(){0!=this.clientId&&this.clientService.GetClientSummary(this.clientId).subscribe(p=>{this.client=p.data})}dismissFn(){this.dismiss.emit(!0)}static{this.\u0275fac=function(y){return new(y||a)(t.rXU(_.X))}}static{this.\u0275cmp=t.VBU({type:a,selectors:[["client-summary"]],inputs:{clientId:"clientId"},outputs:{dismiss:"dismiss"},decls:28,vars:10,consts:[[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"row","justify-content-between","my-2"],["translate","client.client.clientName",1,"col-12","col-md-6"],[1,"col-12","col-md-6"],["class","card-text placeholder-glow",4,"ngIf"],["class","badge badge-label bg-primary fs-5",4,"ngIf"],[1,"row","justify-content-between"],["translate","client.client.CreditLimit",1,"col-12","col-md-6"],["class","badge badge-label bg-warning fs-5",4,"ngIf"],[1,"row","my-2","justify-content-between"],["translate","client.client.lastTransactionDate",1,"col-12","col-md-6"],["class","badge badge-label bg-info fs-5",4,"ngIf"],["translate","client.client.numberInvoiceQuantity",1,"col-12","col-md-6"],["class","badge badge-label bg-success fs-5",4,"ngIf"],["translate","client.client.totalDebt",1,"col-12","col-md-6"],["class","badge badge-label bg-danger fs-5",4,"ngIf"],[1,"card-text","placeholder-glow"],[1,"placeholder","col-12","bg-primary"],[1,"badge","badge-label","bg-primary","fs-5"],[1,"mdi","mdi-circle-medium"],[1,"badge","badge-label","bg-warning","fs-5"],[1,"placeholder","col-12","bg-info"],[1,"badge","badge-label","bg-info","fs-5"],[1,"placeholder","col-12","bg-success"],[1,"badge","badge-label","bg-success","fs-5"],[1,"placeholder","col-12","bg-danger"],[1,"badge","badge-label","bg-danger","fs-5"]],template:function(y,D){1&y&&(t.j41(0,"div",0)(1,"button",1),t.bIt("click",function(){return D.dismissFn()}),t.k0s()(),t.j41(2,"div",2)(3,"div",3),t.nrm(4,"div",4),t.j41(5,"div",5),t.DNE(6,u,2,0,"p",6)(7,r,3,1,"span",7),t.k0s()(),t.j41(8,"div",8),t.nrm(9,"div",9),t.j41(10,"div",5),t.DNE(11,g,2,0,"p",6)(12,e,3,1,"span",10),t.k0s()(),t.j41(13,"div",11),t.nrm(14,"div",12),t.j41(15,"div",5),t.DNE(16,n,2,0,"p",6)(17,d,4,4,"span",13),t.k0s()(),t.j41(18,"div",8),t.nrm(19,"div",14),t.j41(20,"div",5),t.DNE(21,o,2,0,"p",6)(22,m,3,2,"span",15),t.k0s()(),t.j41(23,"div",11),t.nrm(24,"div",16),t.j41(25,"div",5),t.DNE(26,h,2,0,"p",6)(27,O,3,1,"span",17),t.k0s()()()),2&y&&(t.R7$(6),t.Y8G("ngIf",!D.client.clientName),t.R7$(),t.Y8G("ngIf",D.client.clientName),t.R7$(4),t.Y8G("ngIf",!D.client.creditLimit),t.R7$(),t.Y8G("ngIf",D.client.creditLimit),t.R7$(4),t.Y8G("ngIf",!D.client.lastTransactionDate),t.R7$(),t.Y8G("ngIf",D.client.lastTransactionDate),t.R7$(4),t.Y8G("ngIf",!D.client.clientQuantity),t.R7$(),t.Y8G("ngIf",D.client.clientQuantity),t.R7$(4),t.Y8G("ngIf",!D.client.totalDebt),t.R7$(),t.Y8G("ngIf",D.client.totalDebt))},dependencies:[i.bT,c.Mm,i.vh],encapsulation:2})}}return a})()}}]);