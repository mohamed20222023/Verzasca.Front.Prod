"use strict";(self.webpackChunkvelzon=self.webpackChunkvelzon||[]).push([[316],{12822:(Re,ae,c)=>{c.d(ae,{l:()=>oe});var m=c(67569),d=c(45312),_=c(54438),D=c(21626);let oe=(()=>{class B extends m.d{constructor($){super($,d.c.apiUrl+"Channel/")}static{this.\u0275fac=function(de){return new(de||B)(_.KVO(D.Qq))}}static{this.\u0275prov=_.jDH({token:B,factory:B.\u0275fac,providedIn:"root"})}}return B})()},16229:(Re,ae,c)=>{c.d(ae,{m:()=>oe});var m=c(67569),d=c(45312),_=c(54438),D=c(21626);let oe=(()=>{class B extends m.d{constructor($){super($,d.c.apiUrl+"District/")}getByCityId($){return this.http.get(this.baseUrl+"getByCityId/"+$)}static{this.\u0275fac=function(de){return new(de||B)(_.KVO(D.Qq))}}static{this.\u0275prov=_.jDH({token:B,factory:B.\u0275fac,providedIn:"root"})}}return B})()},96402:(Re,ae,c)=>{c.d(ae,{N:()=>oe});var m=c(67569),d=c(45312),_=c(54438),D=c(21626);let oe=(()=>{class B extends m.d{constructor($){super($,d.c.apiUrl+"Service/"),this.ServiceStatus=[{name:"Published",id:1},{name:"NotPublish",id:2},{name:"Draft",id:3}]}deleteImage($){return this.http.delete(this.baseUrl+"deleteImage/"+$,this.httpOptions)}deleteUnit($){return this.http.delete(this.baseUrl+"deleteUnit/"+$,this.httpOptions)}getItemDropDown(){return this.http.get(this.baseUrl+"GetItemDropDown")}servicesByCategory($){return this.http.post(this.baseUrl+"servicesByCategory",$)}GetServiceList($){return this.http.get(this.baseUrl+"GetServiceList/"+$)}static{this.\u0275fac=function(de){return new(de||B)(_.KVO(D.Qq))}}static{this.\u0275prov=_.jDH({token:B,factory:B.\u0275fac,providedIn:"root"})}}return B})()},32316:(Re,ae,c)=>{c.r(ae),c.d(ae,{SalesModule:()=>kc});var m=c(60177),d=c(89417),_=c(69005),D=c(91022),oe=c(70255),B=c(63789),Je=c(98982),$=c.n(Je),de=c(53978),u=c(8147),S=c(45286),Ke=c(65430),ve=c(41631),C=c(1530),E=c(72510),y=c(51188),e=c(54438),se=c(21413),je=c(70152),Ie=c(23294),le=c(25558),p=c(56977),T=c(37021),N=c(35335),x=c(45236),I=c(70980),be=c(99437),Ce=c(18810),ye=c(7673),g=c(36158),J=c(45312),Oe=c(84412),ce=c(67569),me=c(21626);let P=(()=>{class r extends ce.d{constructor(t){super(t,J.c.apiUrl+"OfferOrder/"),this.checkValidationSource=new Oe.t(!0),this.checkValidation=this.checkValidationSource.asObservable(),this.GetOrderCountSource=new Oe.t(!0),this.GetOrderCount=this.GetOrderCountSource.asObservable(),this.removeServiceQ=new Oe.t(0),this.removeService=this.removeServiceQ.asObservable(),this.discountTypes=[{id:1,name:"Cost"},{id:2,name:"Precentage"}],this.salesOrderForm={id:null,clientLocationId:0,clientVisitDate:new Date,clientId:0,notes:"",items:[],discountAmount:0,discountAmountAdd:0,total:0,agent:{},orderLocations:{},discountType:1,discountTypeAdd:1,isPrecentage:!0,isPrecentageAdd:!1,totalAddDiscountType:0,totalAddDiscount:0,serviceCategoryCode:0,isCustomerDataValid:!1}}getLookups(){return this.http.get(this.baseUrl+"Lookups")}changStatus(t){return this.http.put(this.baseUrl+"ChangeStatus/",t)}UpdateQuantity(t){return this.http.put(this.baseUrl+"UpdateQuantity",t)}updateTruck(t){return this.http.put(this.baseUrl+"updateTruck",t)}GetTrucks(t){return this.http.post(this.baseUrl+"GetTrucks/",t)}CancelOfferOrder(t){return this.http.post(this.baseUrl+"CancelOfferOrder",t)}GetOfferOrderCount(){return this.http.get(this.baseUrl+"OfferOrderCount")}GetOfferOrderStoreCount(){return this.http.get(this.baseUrl+"GetOfferOrderStoreCount")}GetAssignSalesOrder(){return this.http.get(this.baseUrl+"GetAssignSalesOrder")}GetOrderDetail(t){return this.http.get(this.baseUrl+"GetOrderDetail/"+t)}RequestChangeQuantity(t){return this.http.post(this.baseUrl+"RequestChangeQuantity/",t)}GetOrderStore(t){return this.http.post(this.baseUrl+"GetOrderStore/",t)}static{this.\u0275fac=function(i){return new(i||r)(e.KVO(me.Qq))}}static{this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var Fe=c(17478),V=c(3888),pe=c(75922),Le=c(96402),X=c(29935),U=c(94575),ie=c(38542);function Ze(r,o){if(1&r&&(e.j41(0,"div",17),e.nrm(1,"i",18),e.EFF(2),e.k0s()),2&r){const t=e.XpG();e.R7$(2),e.SpI(" ",null==t.clientInfo?null:t.clientInfo.alertMessage," ")}}let We=(()=>{class r{constructor(t){this.offerOrder=t,this.form={},this.errorMessage="",this.mediaUrl=J.c.mediaUrl,this.isOrderEdit=!0}ngOnInit(){this.form=this.offerOrder.salesOrderForm}setDefaultImage(t,i){t.target.src=i}ngOnDestroy(){}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(P))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-client-info-salse"]],inputs:{form:"form",isOrderEdit:"isOrderEdit",clientInfo:"clientInfo"},decls:32,vars:12,consts:[[1,"row"],["role","alert",1,"col-12","mt-2","alert","alert-primary","alert-dismissible","material-shadow","alert-label-icon","rounded-label","fade","show"],[1,"row","align-items-center"],[1,"col-12","col-md-1"],["width","50","height","50","alt","Image",2,"border-radius","15px",3,"error","src"],[1,"col-12","col-md-5"],["translate","sales.salesOrder.clientName"],["translate","sales.salesOrder.vatNumber"],["translate","sales.salesOrder.mobile"],["translate","sales.salesOrder.creditLimit"],["translate","sales.salesOrder.nationalAddress"],["translate","sales.salesOrder.clientGroupName"],["class","alert alert-danger alert-border-left alert-dismissible material-shadow fade show","role","alert",4,"ngIf"],[1,"row","mt-4"],[1,"col-12","mb-3"],["for","name","translate","",1,"fw-bold","form-label"],["rows","2","name","terms","type","text",1,"form-control",3,"ngModelChange","placeholder","ngModel"],["role","alert",1,"alert","alert-danger","alert-border-left","alert-dismissible","material-shadow","fade","show"],[1,"ri-alert-line","me-3","align-middle"]],template:function(i,n){1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"img",4),e.bIt("error",function(l){return n.setDefaultImage(l,"assets/images/custom/no-img.jpg")}),e.k0s()(),e.j41(5,"div",5)(6,"div"),e.nrm(7,"strong",6),e.EFF(8),e.k0s(),e.j41(9,"div"),e.nrm(10,"strong",7),e.EFF(11),e.k0s(),e.j41(12,"div"),e.nrm(13,"strong",8),e.EFF(14),e.k0s()(),e.j41(15,"div",5)(16,"div"),e.nrm(17,"strong",9),e.EFF(18),e.k0s(),e.j41(19,"div"),e.nrm(20,"strong",10),e.EFF(21),e.k0s(),e.j41(22,"div"),e.nrm(23,"strong",11),e.EFF(24),e.k0s()()()(),e.DNE(25,Ze,3,1,"div",12),e.k0s(),e.j41(26,"div",13)(27,"div",14)(28,"label",15),e.EFF(29,"sales.salesOrder.terms"),e.k0s(),e.j41(30,"textarea",16),e.nI1(31,"translate"),e.mxI("ngModelChange",function(l){return e.DH7(n.form.terms,l)||(n.form.terms=l),l}),e.k0s()()()),2&i&&(e.R7$(4),e.Y8G("src",n.mediaUrl+(null==n.clientInfo?null:n.clientInfo.externalPhotoPath),e.B4B),e.R7$(4),e.SpI(" : ",null==n.clientInfo?null:n.clientInfo.name,""),e.R7$(3),e.SpI(" : ",null==n.clientInfo?null:n.clientInfo.vatNumber,""),e.R7$(3),e.SpI(" : ",null==n.clientInfo?null:n.clientInfo.mobile,""),e.R7$(4),e.SpI(" : ",null==n.clientInfo?null:n.clientInfo.creditLimit,""),e.R7$(3),e.SpI(" : ",null==n.clientInfo?null:n.clientInfo.nationalAddress,""),e.R7$(3),e.SpI(" : ",null==n.clientInfo?null:n.clientInfo.clientGroupName,""),e.R7$(),e.Y8G("ngIf",!1),e.R7$(5),e.Y8G("placeholder",e.bMT(31,10,"sales.salesOrder.termsPlaceholder")),e.R50("ngModel",n.form.terms))},dependencies:[m.bT,d.me,d.BC,d.vS,u.Mm,u.D9],encapsulation:2})}}return r})();var et=c(25947),tt=c(33121),K=c(12260),te=c(15084);function nt(r,o){if(1&r){const t=e.RV6();e.qex(0),e.j41(1,"div",21)(2,"div",22)(3,"input",23),e.bIt("change",function(){const n=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.locationChange(n))}),e.k0s(),e.j41(4,"label",24)(5,"span",25),e.EFF(6),e.k0s(),e.j41(7,"span",26),e.EFF(8),e.k0s()()(),e.j41(9,"div",27)(10,"div")(11,"a",28),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(),l=e.sdS(14);return e.Njj(s.openEditModal(n,l))}),e.nrm(12,"i",29)(13,"span",30),e.k0s()(),e.j41(14,"div")(15,"a",31),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(),l=e.sdS(16);return e.Njj(s.confirm(n.id,l))}),e.nrm(16,"i",32)(17,"span",33),e.k0s()()()(),e.bVm()}if(2&r){const t=o.$implicit;e.R7$(3),e.Mz_("id","S",t.id,""),e.Y8G("checked",t.isSelected),e.R7$(),e.Mz_("for","S",t.id,""),e.R7$(2),e.Lme(" ",t.cityName,"- ",t.name,""),e.R7$(2),e.SpI(" ",t.address,"")}}function it(r,o){1&r&&(e.j41(0,"span",61),e.EFF(1,"general.action.register "),e.k0s())}function rt(r,o){1&r&&(e.j41(0,"span",61),e.EFF(1,"general.action.edit "),e.k0s())}function st(r,o){1&r&&(e.j41(0,"div",62),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function at(r,o){1&r&&(e.j41(0,"div",62),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function ot(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",34)(1,"div",35)(2,"h4",36),e.DNE(3,it,2,0,"span",37)(4,rt,2,0,"span",37),e.k0s(),e.j41(5,"button",38),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss("Cross click"))}),e.k0s()(),e.j41(6,"div",39),e.nrm(7,"ngx-ui-loader",40),e.j41(8,"form",41,2),e.bIt("submit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.OnSubmit())}),e.j41(10,"div",42),e.nrm(11,"label",43),e.j41(12,"ng-select",44,3),e.nI1(14,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.formEdit.cityCode,n)||(s.formEdit.cityCode=n),e.Njj(n)}),e.k0s()(),e.j41(15,"div",42),e.nrm(16,"label",45),e.j41(17,"input",46,4),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.formEdit.name,n)||(s.formEdit.name=n),e.Njj(n)}),e.k0s(),e.DNE(19,st,2,0,"div",47),e.k0s(),e.j41(20,"div",42),e.nrm(21,"label",48),e.j41(22,"textarea",49,5),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.formEdit.address,n)||(s.formEdit.address=n),e.Njj(n)}),e.k0s(),e.DNE(24,at,2,0,"div",47),e.k0s(),e.j41(25,"div",42),e.nrm(26,"label",50),e.j41(27,"input",51,6),e.bIt("change",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.onUrlChange(n))}),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.formEdit.mapURL,n)||(s.formEdit.mapURL=n),e.Njj(n)}),e.k0s()(),e.j41(29,"div",52)(30,"div",11),e.nrm(31,"label",53),e.j41(32,"input",54,7),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.formEdit.lat,n)||(s.formEdit.lat=n),e.Njj(n)}),e.k0s()(),e.j41(34,"div",11),e.nrm(35,"label",55),e.j41(36,"input",56,8),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.formEdit.lng,n)||(s.formEdit.lng=n),e.Njj(n)}),e.k0s()()(),e.j41(38,"div",57)(39,"button",58),e.nrm(40,"i",59)(41,"span",60),e.k0s()()()()()}if(2&r){const t=e.sdS(9),i=e.sdS(18),n=e.sdS(23),s=e.XpG();e.R7$(3),e.Y8G("ngIf",!s.isEditForm),e.R7$(),e.Y8G("ngIf",s.isEditForm),e.R7$(3),e.Y8G("hasProgressBar",!1)("fgsType",s.loaderOperationShap)("loaderId","locationOperation"),e.R7$(5),e.FS9("placeholder",e.bMT(14,17,"orderManagement.order.cityName")),e.R50("ngModel",s.formEdit.cityCode),e.Y8G("items",s.cities)("multiple",!1),e.R7$(5),e.R50("ngModel",s.formEdit.name),e.R7$(2),e.Y8G("ngIf",i.invalid&&i.touched),e.R7$(3),e.R50("ngModel",s.formEdit.address),e.R7$(2),e.Y8G("ngIf",n.invalid&&n.touched),e.R7$(3),e.R50("ngModel",s.formEdit.mapURL),e.R7$(5),e.R50("ngModel",s.formEdit.lat),e.R7$(4),e.R50("ngModel",s.formEdit.lng),e.R7$(3),e.Y8G("disabled",!t.valid)}}function lt(r,o){if(1&r){const t=e.RV6();e.j41(0,"delete-modal",63),e.bIt("deleteConfirm",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.DeleteConfirm())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}}let ct=(()=>{class r{constructor(t,i,n,s,l,a,f,M){this.modalService=t,this.baseService=i,this.alertService=n,this.ngxLoader=s,this.whatsupService=l,this.whatsAppMessagesService=a,this.cityService=f,this.offerOrder=M,this.submitted=!1,this.form={},this.mainDelay=20,this.notifier=new se.B,this.operationLoader=g.ZW,this.isEditForm=!1,this.loaderOperationShap=g.$$,this.isLoad=!1,this.formEdit={},this.cities=[],this.idSelected=0,this.isOrderEdit=!0,this.modalRefs={}}ngOnInit(){this.form=this.offerOrder.salesOrderForm,this.form.clientId&&this.checkLocation(),this.form.clientLocationId&&this.checkSelected(this.form.clientLocationId),this.GetCities()}confirm(t,i){this.idSelected=t,this.modalService.open(i,{centered:!0})}openModal(t){this.ngxLoader.stopLoader(this.operationLoader),this.submitted=!1,this.modalRefs=this.modalService.open(t,{size:"md",centered:!0})}openEditModal(t,i){this.submitted=!1,this.formEdit=t,this.isEditForm=!0,this.modalRefs=this.modalService.open(i,{size:"md",centered:!0})}changeActiveTab(t){this.nav.select(t)}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}registerEntity(t=!1){this.ngxLoader.startLoader("locationOperation");let i=this.mapRegisterForm(this.formEdit);i.isSend=t,this.baseService.AddLocation(i).pipe((0,T.O)(),(0,N.c)(this.mainDelay),(0,x.Z)(),(0,p.Q)(this.notifier),(0,I.j)(()=>this.ngxLoader.stopLoader("locationOperation")),(0,be.W)(n=>(0,Ce.$)(n))).subscribe(n=>{n.success?(this.alertService.success(),this.modalRefs.dismiss(),this.refresh()):this.alertService.error("general.message."+n.message)},n=>{this.alertService.error("general.message."+n)})}editEntity(t=!1){this.ngxLoader.startLoader("locationOperation");let i=this.mapForm(this.formEdit);i.isSend=t,this.baseService.EditLocation(i).pipe((0,T.O)(),(0,N.c)(this.mainDelay),(0,x.Z)(),(0,p.Q)(this.notifier),(0,I.j)(()=>this.ngxLoader.stopLoader("locationOperation"))).subscribe(n=>{n.success?(this.alertService.success(),this.modalRefs.dismiss(),this.refresh()):this.alertService.error("general.message."+n.message)},n=>{this.alertService.error("general.message."+n)})}mapForm(t){let i={...t};return i.agentCode=this.form.clientId,i.cityCode=i.cityCode,i.agentName="",i.mobile="",i.mapURL=i.mapURL,i.lat=i.lat?i.lat.toString():"",i.lng=i.lng?i.lng.toString():"",i}mapRegisterForm(t){let i={...t};return i.id=0,i.cityCode=i.cityCode,i.agentName="",i.mobile="",i.agentCode=this.form.clientId,i.mapURL=i.mapURL,i.lat=i.lat?i.lat.toString():"",i.lng=i.lng?i.lng.toString():"",i}submitFunished(){this.alertService.success(),this.modalService?.dismissAll()}OnSubmit(t=!1){this.ngxLoader.startLoader(this.operationLoader),!0===this.isEditForm?this.editEntity(t):this.registerEntity(t)}getFromClient(){this.form.agent.mobile||this.alertService.error("orderManagement.order.mustEnterNumber"),this.isLoad=!0,this.whatsupService.GetLocationFromClient(this.form.agent.mobile).pipe((0,p.Q)(this.notifier),(0,I.j)(()=>this.isLoad=!1)).subscribe(t=>{t.success?this.alertService.success("orderManagement.order.successSendLocation"):this.alertService.error("orderManagement.order.failSendLocation")},()=>{this.alertService.error("orderManagement.order.failSendLocation")})}DeleteConfirm(){this.baseService.DeleteLocation(this.idSelected).pipe((0,T.O)(),(0,N.c)(this.mainDelay),(0,x.Z)(),(0,p.Q)(this.notifier),(0,I.j)(()=>this.ngxLoader.stopLoader("deleteLoader"))).subscribe(t=>{if(t.success){const i=this.form.locations.findIndex(n=>n.id===this.idSelected);-1!==i&&this.form.locations.splice(i,1),this.alertService.success(),this.modalService.dismissAll()}else this.alertService.error("general.message."+t)},()=>{this.alertService.error()})}getClientLocations(t){this.baseService.GetClientLocations(t).subscribe(i=>{this.form.locations=i.data,this.offerOrder.salesOrderForm.locations=i.data})}refresh(){this.getClientLocations(this.offerOrder.salesOrderForm.clientId),this.checkLocation()}locationChange(t){this.form.clientLocationId=t.id;let i=this.form.locations.find(n=>n.id==t.id);i.isSelected=!i.isSelected,this.offerOrder.salesOrderForm.clientLocationId=this.form.clientLocationId,this.offerOrder.checkValidationSource.next(!0)}checkSelected(t){this.offerOrder.checkValidationSource.next(!0),this.form.locations.find(n=>n.id==t).isSelected=!0}checkLocation(){this.offerOrder.checkValidationSource.next(!0)}ngOnDestroy(){this.notifier.next(),this.notifier.complete()}onUrlChange(t){let i=t.target.value.trim(),n=null;try{n=new URL(i).searchParams.get("q")}catch{n=i}if(n){let[s,l]=n.split(",").map(a=>Number(a.trim()));!isNaN(s)&&!isNaN(l)&&(this.formEdit.lat=s,this.formEdit.lng=l)}}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(_.Bq),e.rXU(pe.X),e.rXU(V.u),e.rXU(C.eD),e.rXU(et.A),e.rXU(tt.Q),e.rXU(K.h),e.rXU(P))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["client-location-salse"]],viewQuery:function(i,n){if(1&i&&e.GBs(_.X9,5),2&i){let s;e.mGM(s=e.lsd())&&(n.nav=s.first)}},inputs:{form:"form",isOrderEdit:"isOrderEdit"},features:[e.Jv_([_.X9])],decls:17,vars:7,consts:[["content",""],["deleteModal",""],["formEntity","ngForm"],["cityCode","ngModel"],["name","ngModel"],["address","ngModel"],["mapURL","ngModel"],["lat","ngModel"],["lng","ngModel"],[1,"mt-4"],[1,"row"],[1,"col-12","col-md-6"],["for","name","translate","",1,"fw-bold","form-label"],["name","clientVisitDate","type","text","mwlFlatpickr","","altFormat","d-m-Y H:i",1,"form-control","flatpickr-input",3,"ngModelChange","ngModel","altInput","enableTime","convertModelValue","dateFormat"],[1,"d-flex","align-items-center","mb-2"],[1,"flex-grow-1"],["translate","orderManagement.order.savedAddress",1,"fs-4","mb-0"],[1,"flex-shrink-0"],["type","button","translate","orderManagement.order.sendToClient",1,"btn","fs-4","btn-sm","btn-success","mb-1",3,"click","disabled"],[1,"row","gy-3"],[4,"ngFor","ngForOf"],[1,"col-lg-4","col-sm-6"],[1,"form-check","card-radio"],["name","location","type","radio",1,"form-check-input",3,"change","id","checked"],[1,"form-check-label",3,"for"],[1,"mb-4","fw-bold","d-block","text-muted","text-uppercase"],[1,"text-muted","fw-normal","text-wrap","mb-1","d-block"],[1,"d-flex","flex-wrap","p-2","py-1","bg-light","rounded-bottom","border","mt-n1"],["href","javascript:void(0);","data-bs-toggle","modal","data-bs-target","#addAddressModal",1,"d-block","text-body","p-1","px-2",3,"click"],[1,"ri-pencil-fill","text-muted","align-bottom","me-1"],["translate","general.action.edit"],["href","javascript:void(0);","data-bs-toggle","modal","data-bs-target","#removeItemModal",1,"d-block","text-body","p-1","px-2",3,"click"],[1,"ri-delete-bin-fill","text-muted","align-bottom","me-1"],["translate","general.action.delete"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["class","fw-bold fs-4","translate","",4,"ngIf"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"hasProgressBar","fgsType","loaderId"],[3,"submit"],[1,"mb-1"],["for","name","translate","orderManagement.order.cityName",1,"required","fw-bold","form-label"],["name","cityCode","id","cityCode","bindValue","code","bindLabel","name",3,"ngModelChange","ngModel","placeholder","items","multiple"],["for","name","translate","orderManagement.order.name",1,"required","fw-bold","form-label"],["InputTirmFilter","","name","name","type","text","id","name","required","",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["class","text-danger text-center  ","translate","",4,"ngIf"],["for","address","translate","orderManagement.order.address",1,"fw-bold","form-label"],["rows","2","InputTirmFilter","","name","address","type","text","id","address",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["for","mapURL","translate","orderManagement.order.mapURL",1,"fw-bold","form-label"],["InputTirmFilter","","name","mapURL","type","text","id","mapURL",1,"form-control","fs-6",3,"change","ngModelChange","ngModel"],[1,"row","my-2"],["for","lat","translate","orderManagement.order.lat",1,"fw-bold","form-label"],["disabled","","InputTirmFilter","","name","lat","type","text","id","lat",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["for","lng","translate","orderManagement.order.lng",1,"fw-bold","form-label"],["disabled","","InputTirmFilter","","name","lng","type","text","id","lng",1,"form-control","fs-6",3,"ngModelChange","ngModel"],[1,"text-center"],["type","submit","type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],["translate","",1,"fw-bold","fs-4"],["translate","",1,"text-danger","text-center"],[3,"deleteConfirm","dismiss"]],template:function(i,n){if(1&i){const s=e.RV6();e.j41(0,"div",9)(1,"div",10)(2,"div",11)(3,"label",12),e.EFF(4,"sales.salesOrder.acutalVisitDate"),e.k0s(),e.j41(5,"input",13),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.form.clientVisitDate,a)||(n.form.clientVisitDate=a),e.Njj(a)}),e.k0s()()(),e.j41(6,"div",14)(7,"div",15),e.nrm(8,"h3",16),e.k0s(),e.j41(9,"div",17)(10,"button",18),e.bIt("click",function(){e.eBV(s);const a=e.sdS(14);return e.Njj(n.openModal(a))}),e.k0s()()(),e.j41(11,"div",19),e.DNE(12,nt,18,8,"ng-container",20),e.k0s()(),e.DNE(13,ot,42,19,"ng-template",null,0,e.C5r)(15,lt,1,0,"ng-template",null,1,e.C5r)}2&i&&(e.R7$(5),e.R50("ngModel",n.form.clientVisitDate),e.Y8G("altInput",!0)("enableTime",!0)("convertModelValue",!0)("dateFormat","d-m-Y H:i"),e.R7$(5),e.Y8G("disabled",n.isLoad),e.R7$(2),e.Y8G("ngForOf",n.form.locations))},dependencies:[m.Sq,m.bT,d.qT,d.me,d.BC,d.cb,d.YS,d.vS,d.cV,u.Mm,X.m,E.vr,D.kL,C.Cv,te.w,u.D9],encapsulation:2})}}return r})(),mt=(()=>{class r{constructor(t){this.router=t,this.form={},this.orderCode=0,this.statusOrder=0,this.newOrder=new e.bkB,this.editOrderActiveTab=new e.bkB}ngOnDestroy(){}ngOnInit(){}newOrderAgain(){this.newOrder.next(!0)}goOrders(){this.router.navigateByUrl("/sales/sales-order")}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(y.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-finish-order-salse"]],inputs:{form:"form",orderCode:"orderCode",statusOrder:"statusOrder"},outputs:{newOrder:"newOrder",editOrderActiveTab:"editOrderActiveTab"},decls:12,vars:1,consts:[[1,"text-center","py-5"],[1,"mb-4"],["src","https://cdn.lordicon.com/lupuorrc.json","trigger","loop","colors","primary:#0ab39c,secondary:#405189",2,"width","120px","height","120px"],["translate","orderManagement.order.orderSaveSuccess"],[1,"fw-semibold"],["translate","orderManagement.order.orderCode"],["routerLink","/ecommerce/order-details",1,"text-decoration-underline",3,"click"],[1,"d-flex","align-items-start","gap-3","mt-4"],["type","button","data-nexttab","pills-finish-tab",1,"btn","btn-primary","btn-label","right","ms-auto","nexttab",3,"click"],[1,"ri-chat-new-line","label-icon","align-middle","fs-16","ms-2"],["translate","orderManagement.order.newOrderAgain"]],template:function(i,n){1&i&&(e.j41(0,"div",0)(1,"div",1),e.nrm(2,"lord-icon",2),e.k0s(),e.nrm(3,"h5",3),e.j41(4,"h3",4),e.nrm(5,"span",5),e.j41(6,"a",6),e.bIt("click",function(){return n.goOrders()}),e.EFF(7),e.k0s()()(),e.j41(8,"div",7)(9,"button",8),e.bIt("click",function(){return n.newOrderAgain()}),e.nrm(10,"i",9)(11,"span",10),e.k0s()()),2&i&&(e.R7$(7),e.SpI("#SO#",n.orderCode,""))},dependencies:[u.Mm,y.Wk],encapsulation:2})}}return r})();const pt=r=>({" border-service ":r});function gt(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",20),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.chooseCategory(n))}),e.EFF(1),e.k0s()}if(2&r){const t=o.$implicit;e.AVh("active",t.isSelected),e.R7$(),e.SpI(" ",t.name," ")}}function _t(r,o){if(1&r&&(e.j41(0,"span",21),e.EFF(1),e.k0s()),2&r){const t=e.XpG();e.R7$(),e.JRh(t.seviceCount)}}function ut(r,o){1&r&&(e.j41(0,"div",22),e.nrm(1,"button",23),e.k0s())}function ht(r,o){if(1&r){const t=e.RV6();e.qex(0),e.j41(1,"div",24)(2,"div",25)(3,"div",26),e.bIt("click",function(n){const s=e.eBV(t).$implicit,l=e.XpG();return e.Njj(l.onServiceChange(s.id,n))}),e.j41(4,"div",27)(5,"div",28),e.nrm(6,"img",29),e.k0s(),e.j41(7,"div",30)(8,"h5",31),e.EFF(9),e.k0s()()(),e.j41(10,"div",32),e.nrm(11,"div",33),e.j41(12,"div",34),e.EFF(13),e.k0s()(),e.j41(14,"div",32),e.nrm(15,"div",35),e.j41(16,"div",36),e.EFF(17),e.k0s()(),e.j41(18,"div",32),e.nrm(19,"div",37),e.j41(20,"div",36),e.EFF(21),e.k0s()(),e.j41(22,"div",32),e.nrm(23,"div",38),e.j41(24,"div",36),e.EFF(25),e.nI1(26,"translate"),e.k0s()()(),e.j41(27,"div",32),e.nrm(28,"div",39),e.j41(29,"div",36)(30,"ng-select",40),e.bIt("change",function(n){const s=e.eBV(t).$implicit,l=e.XpG();return e.Njj(l.unitChange(s,n))}),e.mxI("ngModelChange",function(n){const s=e.eBV(t).$implicit;return e.DH7(s.unitId,n)||(s.unitId=n),e.Njj(n)}),e.k0s()()()()(),e.bVm()}if(2&r){const t=o.$implicit,i=e.XpG();e.R7$(2),e.Y8G("ngClass",e.eq3(13,pt,t.isSelected)),e.R7$(4),e.Y8G("src",i.serverImage+t.image,e.B4B),e.R7$(3),e.JRh(t.name),e.R7$(4),e.SpI(" ",t.categoryName," "),e.R7$(4),e.JRh(t.stock),e.R7$(4),e.JRh(t.status),e.R7$(4),e.Lme(" ",t.price," ",e.bMT(26,11,"orderManagement.order.currancy")," "),e.R7$(5),e.Y8G("clearable",!1)("items",t.units),e.R50("ngModel",t.unitId)}}let ft=(()=>{class r{constructor(t,i){this.translateService=t,this.offerOrder=i,this.form={},this.selectedServices=[],this.notifier=new se.B,this.mainDelay=100,this.loaderSearchShap=g.cX,this.loaderOperationShap=g.$$,this.operationLoader=g.ZW,this.isEditForm=!1,this.showEdit=!1,this.serviceCategories=[],this.services=[],this.currentLang=this.translateService.currentLang,this.subtotal=0,this.total=0,this.serverImage=J.c.mediaUrl,this.filteredServices=[],this.seviceCount=0,this.serviceSelected=[],this.allItems=this.getTranslationText("basicData.item.allItems"),this.CalcTotal=new e.bkB,this.isOrderEdit=!0,this.productsLookUp=[],this.init=0,this.responsiveOptions=[{breakpoint:"1400px",numVisible:4,numScroll:3},{breakpoint:"1220px",numVisible:4,numScroll:2},{breakpoint:"1100px",numVisible:4,numScroll:1}]}ngOnDestroy(){this.notifier.next(),this.notifier.complete()}ngOnInit(){this.getCategory(),this.getServicesByCategory(),this.offerOrder.removeServiceQ.pipe((0,p.Q)(this.notifier)).subscribe(t=>{if(0==this.init)return void(this.init=1);const i=this.filteredServices[t];i&&(i.isSelected=!i.isSelected),this.seviceCount=this.filteredServices.filter(n=>n.isSelected).length})}getCategory(){let t=this.offerOrder.salesOrderForm.serviceCategoryCode;this.serviceCategories=this.productsLookUp.categories,this.serviceCategories=this.serviceCategories.map(i=>({...i,isSelected:i.id===t}))}addService(t){const i=this.form.items.findIndex(n=>n.itemId===t.id);i>-1?this.form.items.splice(i,1):this.form.items.push({itemGroup:null,itemName:t.name,itemId:t.id,image:t.image,description:t.description,unitId:t.units[0].id,units:t.units,quantity:t.quantity,priceUnit:t.units[0].price,discount:0,discountType:1,price:t.units[0].price,net:t.price*t.quantity}),this.checkTotal(),this.offerOrder.checkValidationSource.next(!0)}updatePrice(t){const i=this.form.orderServices.find(n=>n.serviceCode===t.code);i.quantity=t.quantity,i.price=t.price}checkTotal(){this.CalcTotal.next(!0)}deleteService(t){this.form.orderServices.splice(t,1)}deletePayment(t){this.form.orderPayments.splice(t,1)}resetServiceForm(){let t=this.form.formServices;t.serviceCode=void 0,t.price=null,t.notes=null}resetPaymentForm(){let t=this.form.formPayment;t.paymentTypeCode=null,t.value=null,t.attachRecietPath=null,t.fileName=null}configRoute(){}getServicesByCategory(){this.services=this.setupUnit(this.productsLookUp.servies),this.filteredServices=this.services}setupUnit(t){return t.forEach(i=>{i.units.length>0&&(i.unitId=i.units[0].id,i.price=i.units[0].price)}),t}unitChange(t,i){if(!t.isSelected)return;let n=this.form.items.find(l=>l.itemId===t.id),s=this.filteredServices.find(l=>l.id===t.id);n.unitId=i.id,n.unitPrice=i.price,n.price=i.price,s.unitPrice=i.price,s.price=i.price,s.unitId=i.id,this.checkTotal()}checkSelected(){this.form.items.forEach(t=>{let i=this.filteredServices.find(n=>n.id===t.itemId);i&&(i.isSelected=!0)})}getTranslationText(t){let i="";return this.translateService.get(t).pipe((0,p.Q)(this.notifier)).subscribe(n=>{i=n}),i}onTimeSelected(t){this.form.orderTeams=t}chooseCategory(t){this.serviceCategories=this.serviceCategories.map(i=>({...i,isSelected:i.id===t.id})),this.offerOrder.salesOrderForm.serviceCategoryCode=t.id,this.filteredServices=0==t.id?this.services:this.services?.filter(i=>i?.categoryId===t?.id)??[]}onServiceChange(t,i){i.stopPropagation();const n=this.filteredServices.find(s=>s.id===t);n&&(n.isSelected=!n.isSelected),this.seviceCount=this.filteredServices.filter(s=>s.isSelected).length,this.addService(n)}btnPlus(t,i){i.stopPropagation();const n=this.filteredServices.find(s=>s.code===t);n&&(n.quantity++,this.updatePrice(n),this.checkTotal())}btnMinus(t,i){i.stopPropagation();const n=this.filteredServices.find(s=>s.code===t);n&&n.quantity>1?n.quantity-=1:n.quantity=1,this.updatePrice(n),this.checkTotal()}searchChange(t){const i=t.target.value.toLowerCase();this.filteredServices=""===i?[...this.services]:this.services.filter(n=>n.name.toLowerCase().includes(i)||n.sku.toLowerCase().includes(i))}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(u.c$),e.rXU(P))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["order-products"]],inputs:{form:"form",serviceCategories:"serviceCategories",isOrderEdit:"isOrderEdit",productsLookUp:"productsLookUp"},outputs:{CalcTotal:"CalcTotal"},decls:26,vars:13,consts:[["categoriesContainer",""],[1,"service-container"],[1,"mt-2"],[1,"categories-container"],[1,"categories-title"],[1,"categories-slider-container"],[1,"categories-slider"],["class","category-btn",3,"active","click",4,"ngFor","ngForOf"],[1,"row","justify-content-center","align-items-center","border-bottom"],[1,"col-12","col-md-12","mx-5"],[1,"search-box","mb-3"],["type","search","id","filterValue","name","filterValue",1,"form-control","search","bg-light","rounded-pill",3,"keyup","placeholder"],[1,"ri-search-line","search-icon"],[1,"row","justify-content-between","align-items-center"],[1,"col-12","col-md-5"],[1,"mb-0","d-inline-block","position-relative"],["class","badge bg-primary mx-1",4,"ngIf"],["class","d-flex justify-content-center",4,"ngIf"],[1,"mt-3","row","row-cols-3"],[4,"ngFor","ngForOf"],[1,"category-btn",3,"click"],[1,"badge","bg-primary","mx-1"],[1,"d-flex","justify-content-center"],["type","button","translate","orderManagement.order.noProduct",1,"btn","btn-sm","my-2","btn-danger","fs-4","mb-3"],[1,"col-12","col-md-4","text-center"],[1,"card","card-service","card-body",3,"ngClass"],[1,"row",3,"click"],[1,"row","align-items-center","p-0"],[1,"col-12","col-md-6"],["onerror","this.onerror=null;this.src='assets/images/custom/no-img.jpg';",1,"avatar-sm",2,"width","100%","height","120px",3,"src"],[1,"col-12","col-md-6","2"],[1,"card-title","mb-1"],[1,"row","p-1"],["translate","sales.salesOrder.category",1,"col-12","col-md-5","m-0","text-left"],[1,"col-12","col-md-7","m-0"],["translate","sales.salesOrder.stock",1,"col-12","col-md-5","text-left"],[1,"col-12","col-md-7"],["translate","sales.salesOrder.status",1,"col-12","col-md-5","text-left"],["translate","sales.salesOrder.price",1,"col-12","col-md-5","text-left"],["translate","sales.salesOrder.unit",1,"col-12","col-md-5","text-left"],["bindValue","id","bindLabel","name",2,"width","100%",3,"change","ngModelChange","clearable","items","ngModel"]],template:function(i,n){if(1&i){const s=e.RV6();e.j41(0,"div",1)(1,"div",2)(2,"bdi")(3,"div",3)(4,"h4",4),e.EFF(5),e.nI1(6,"translate"),e.k0s(),e.j41(7,"div",5,0)(9,"div",6),e.DNE(10,gt,2,3,"button",7),e.k0s()()()()(),e.j41(11,"div",8)(12,"div",9)(13,"div",10)(14,"input",11),e.nI1(15,"translate"),e.bIt("keyup",function(a){return e.eBV(s),e.Njj(n.searchChange(a))}),e.k0s(),e.nrm(16,"i",12),e.k0s()()(),e.j41(17,"div",13)(18,"div",14)(19,"h4",15),e.EFF(20),e.nI1(21,"translate"),e.k0s(),e.DNE(22,_t,2,1,"span",16),e.k0s()(),e.DNE(23,ut,2,0,"div",17),e.j41(24,"div",18),e.DNE(25,ht,31,15,"ng-container",19),e.k0s()()}2&i&&(e.R7$(5),e.SpI(" ",e.bMT(6,7,"orderManagement.order.serviceProduct"),""),e.R7$(5),e.Y8G("ngForOf",n.serviceCategories),e.R7$(4),e.FS9("placeholder",e.bMT(15,9,"orderManagement.order.searchProduct")),e.R7$(6),e.SpI(" ",e.bMT(21,11,"orderManagement.order.selectedProducts")," "),e.R7$(2),e.Y8G("ngIf",n.seviceCount>0),e.R7$(),e.Y8G("ngIf",0==n.filteredServices.length),e.R7$(2),e.Y8G("ngForOf",n.filteredServices))},dependencies:[m.YU,m.Sq,m.bT,d.BC,d.vS,u.Mm,E.vr,u.D9],styles:[".categories-container[_ngcontent-%COMP%]{padding:16px;direction:rtl}.categories-title[_ngcontent-%COMP%]{font-weight:700;margin-bottom:12px;text-align:right}.categories-slider-container[_ngcontent-%COMP%]{width:100%;overflow-x:auto;padding-bottom:8px;scroll-behavior:smooth;-ms-overflow-style:none;scrollbar-width:none}.categories-slider-container[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.categories-slider[_ngcontent-%COMP%]{display:flex;gap:8px;padding:4px 0;width:max-content}.category-btn[_ngcontent-%COMP%]{padding:8px 16px;border-radius:20px;border:1px solid #ddd;background:#fff;white-space:nowrap;font-size:14px;cursor:pointer;transition:all .3s ease}.category-btn.active[_ngcontent-%COMP%]{background:#3f51b5;color:#fff;border-color:#3f51b5}.category-btn[_ngcontent-%COMP%]:hover{background:#f5f5f5}.category-btn[_ngcontent-%COMP%]:hover.active{background:#303f9f}"]})}}return r})();var bt=c(53132);const Ct=["clientModal"],St=()=>["salesOrder.editTotalDiscont"];function vt(r,o){if(1&r){const t=e.RV6();e.j41(0,"app-client-info-salse",68),e.bIt("calacTotal",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.checkTotal())})("setFormByOrderCode",function(n){e.eBV(t);const s=e.XpG(2);return e.Njj(s.setFormByOrderCode(n))}),e.k0s()}if(2&r){const t=e.XpG(2);e.Y8G("isOrderEdit",t.isOrderEdit)("isInner",t.isInner)("clientInfo",t.clientInfo)("form",t.form)}}function jt(r,o){if(1&r){const t=e.RV6();e.j41(0,"order-products",69),e.bIt("CalcTotal",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.checkTotal())}),e.k0s()}if(2&r){const t=e.XpG(2);e.Y8G("isOrderEdit",t.isOrderEdit)("productsLookUp",t.productsLookUp)("form",t.form)}}function It(r,o){if(1&r&&e.nrm(0,"client-location-salse",70),2&r){const t=e.XpG(2);e.Y8G("isOrderEdit",t.isOrderEdit)("form",t.form)}}function yt(r,o){if(1&r){const t=e.RV6();e.j41(0,"app-finish-order-salse",71),e.bIt("editOrderActiveTab",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.editOrder())})("newOrder",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.newOrder())}),e.k0s()}if(2&r){const t=e.XpG(2);e.Y8G("statusOrder",t.statusOrder)("orderCode",t.orderCode)("form",t.form)}}function kt(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",72),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.back())}),e.nrm(1,"i",73)(2,"span",74),e.k0s()}}function Tt(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",75),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.next())}),e.nrm(1,"i",76)(2,"span",77),e.k0s()}}function xt(r,o){if(1&r){const t=e.RV6();e.j41(0,"li",85),e.bIt("click",function(){e.eBV(t);const n=e.XpG(3);return e.Njj(n.orderFinished())}),e.j41(1,"span",86),e.nrm(2,"i",87)(3,"span",88),e.k0s()()}}function Mt(r,o){if(1&r){const t=e.RV6();e.j41(0,"li",85),e.bIt("click",function(){e.eBV(t);const n=e.XpG(3);return e.Njj(n.orderFinished(0))}),e.j41(1,"span",86),e.nrm(2,"i",89)(3,"span",90),e.k0s()()}}function Rt(r,o){if(1&r){const t=e.RV6();e.j41(0,"li",85),e.bIt("click",function(){e.eBV(t);const n=e.XpG(3),s=e.sdS(6);return e.Njj(n.openModalRequest(s))}),e.j41(1,"span",86),e.nrm(2,"i",91)(3,"span",92),e.k0s()()}}function Ot(r,o){if(1&r&&(e.j41(0,"div",36)(1,"span",78)(2,"div",79)(3,"button",80),e.nrm(4,"i",81)(5,"span",82),e.k0s(),e.j41(6,"ul",83),e.DNE(7,xt,4,0,"li",84)(8,Mt,4,0,"li",84)(9,Rt,4,0,"li",84),e.k0s()()()()),2&r){const t=e.XpG(2);e.R7$(7),e.Y8G("ngIf",t.form.creditLimit>t.VATTotal),e.R7$(),e.Y8G("ngIf",t.form.creditLimit<t.VATTotal),e.R7$(),e.Y8G("ngIf",t.form.creditLimit<t.VATTotal)}}function Ft(r,o){if(1&r){const t=e.RV6();e.qex(0),e.j41(1,"tr")(2,"td")(3,"div",94),e.nrm(4,"img",95),e.k0s()(),e.j41(5,"td")(6,"h5",96)(7,"a",97),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(3);return e.Njj(s.goEdit(n.itemId))}),e.EFF(8),e.k0s()(),e.j41(9,"p",98),e.EFF(10),e.nI1(11,"translate"),e.k0s(),e.j41(12,"div",99)(13,"div",100)(14,"button",101),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(3);return e.Njj(s.decrement(n))}),e.EFF(15," \u2013 "),e.k0s(),e.j41(16,"input",102),e.bIt("change",function(n){const s=e.eBV(t).$implicit,l=e.XpG(3);return e.Njj(l.quantityChange(n,s))}),e.k0s(),e.j41(17,"button",103),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(3);return e.Njj(s.increment(n))}),e.EFF(18," + "),e.k0s()()()(),e.j41(19,"td"),e.EFF(20),e.nI1(21,"translate"),e.j41(22,"div",104)(23,"i",105),e.bIt("click",function(){const n=e.eBV(t).index,s=e.XpG(3);return s.removeService(n),e.Njj(s.checkTotal())}),e.k0s()()()(),e.bVm()}if(2&r){const t=o.$implicit,i=e.XpG(3);e.R7$(4),e.Y8G("src",i.serverImage+t.image,e.B4B),e.R7$(4),e.JRh(t.itemName),e.R7$(2),e.E5c(" ",t.price," ",e.bMT(11,10,"orderManagement.order.currancy")," x ",t.quantity," "),e.R7$(6),e.Mz_("id","cart-",t.code,""),e.FS9("value",t.quantity),e.R7$(4),e.Lme(" ",t.price*t.quantity-t.discount," ",e.bMT(21,12,"orderManagement.order.currancy")," ")}}function Nt(r,o){if(1&r&&(e.qex(0),e.DNE(1,Ft,24,14,"ng-container",93),e.bVm()),2&r){const t=e.XpG(2);e.R7$(),e.Y8G("ngForOf",t.form.items)}}function wt(r,o){1&r&&(e.j41(0,"tr")(1,"td",106)(2,"div",107)(3,"div",108)(4,"div",109),e.nrm(5,"i",110),e.k0s()(),e.j41(6,"h5",111),e.EFF(7),e.nI1(8,"translate"),e.k0s()()()()),2&r&&(e.R7$(7),e.SpI(" ",e.bMT(8,1,"orderManagement.order.noProducts")," "))}function Gt(r,o){1&r&&(e.j41(0,"tr")(1,"td",112),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.j41(4,"td",113),e.EFF(5,"0"),e.k0s()()),2&r&&(e.R7$(2),e.SpI(" ",e.bMT(3,1,"orderManagement.order.ServicePrice")," "))}function Vt(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",114)(1,"button",115),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.j41(4,"div",116),e.nI1(5,"translate"),e.j41(6,"input",117),e.bIt("change",function(n){e.eBV(t);const s=e.XpG(2);return e.Njj(s.checkPrecentageChange(n))}),e.k0s(),e.j41(7,"span",118),e.EFF(8,"%"),e.k0s()(),e.j41(9,"input",119,4),e.bIt("change",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.validateDiscount())}),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG(2);return e.DH7(s.form.discountAmount,n)||(s.form.discountAmount=n),e.Njj(n)}),e.k0s()()}if(2&r){const t=e.XpG(2);e.R7$(2),e.SpI(" ",e.bMT(3,5,"orderManagement.order.Discount")," "),e.R7$(2),e.FS9("pTooltip",e.bMT(5,7,"orderManagement.order.discount")),e.R7$(2),e.Y8G("checked",t.form.isPrecentage),e.R7$(3),e.Y8G("max",t.form.isPrecentage?100:t.subtotal),e.R50("ngModel",t.form.discountAmount)}}function Dt(r,o){if(1&r&&(e.j41(0,"div",120),e.EFF(1),e.nI1(2,"translate"),e.nI1(3,"translate"),e.k0s()),2&r){const t=e.XpG(2);e.R7$(),e.E5c(" ",e.bMT(2,3,"orderManagement.order.discountValue"),": ",(t.subtotal*t.form.discountAmount/100).toFixed(2)," ",e.bMT(3,5,"orderManagement.order.currancy")," ")}}function Et(r,o){if(1&r&&(e.j41(0,"div",121),e.EFF(1),e.nI1(2,"translate"),e.EFF(3),e.nI1(4,"translate"),e.nI1(5,"translate"),e.k0s()),2&r){const t=e.XpG(2);e.R7$(),e.Lme(" ",e.bMT(2,5,"orderManagement.order.discountValue"),": ",t.form.discountAmount||0," "),e.R7$(2),e.E5c(" ",e.bMT(4,7,"orderManagement.order.currancy")," ",e.bMT(5,9,"orderManagement.order.discountPercentage"),": ",t.getDiscountPercentage()," ")}}function Lt(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",12)(1,"div",13)(2,"div",14)(3,"div",15)(4,"div",16)(5,"div",17)(6,"label",18),e.EFF(7,"orderManagement.order.clientSearch"),e.k0s(),e.j41(8,"ng-select",19),e.bIt("scrollToEnd",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.scrollClient())}),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.clientId,n)||(s.form.clientId=n),e.Njj(n)}),e.bIt("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.getClientInfo(n))}),e.k0s()()(),e.nrm(9,"ngx-ui-loader",20),e.j41(10,"form",null,2)(12,"div",21)(13,"ul",22,3),e.bIt("navChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.onNavChange(n))}),e.j41(15,"li",23)(16,"a",24),e.nrm(17,"i",25),e.j41(18,"span",26),e.EFF(19),e.nI1(20,"translate"),e.k0s()(),e.DNE(21,vt,1,4,"ng-template",27),e.k0s(),e.j41(22,"li",23)(23,"a",28),e.nrm(24,"i",29),e.j41(25,"span",26),e.EFF(26),e.nI1(27,"translate"),e.k0s()(),e.DNE(28,jt,1,3,"ng-template",27),e.k0s(),e.j41(29,"li",23)(30,"a",28),e.nrm(31,"i",30),e.j41(32,"span",26),e.EFF(33),e.nI1(34,"translate"),e.k0s()(),e.DNE(35,It,1,2,"ng-template",27),e.k0s(),e.j41(36,"li",23)(37,"a",28),e.nrm(38,"i",31),e.j41(39,"span",26),e.EFF(40),e.nI1(41,"translate"),e.k0s()(),e.DNE(42,yt,1,3,"ng-template",27),e.k0s()(),e.j41(43,"div",32),e.nrm(44,"div",33),e.k0s()()()(),e.j41(45,"div",34)(46,"div",35)(47,"div",36),e.DNE(48,kt,3,0,"button",37),e.k0s(),e.j41(49,"div",36),e.DNE(50,Tt,3,0,"button",38),e.k0s(),e.DNE(51,Ot,10,3,"div",39),e.k0s()()()(),e.j41(52,"div",40)(53,"div",14)(54,"div",41)(55,"div",42)(56,"div",43)(57,"h5",44),e.EFF(58),e.nI1(59,"translate"),e.k0s()()()(),e.j41(60,"div",45)(61,"div",46)(62,"table",47)(63,"thead",48)(64,"tr")(65,"th",49),e.EFF(66),e.nI1(67,"translate"),e.k0s(),e.j41(68,"th",50),e.EFF(69),e.nI1(70,"translate"),e.k0s(),e.j41(71,"th",51),e.EFF(72),e.nI1(73,"translate"),e.k0s()()(),e.j41(74,"tbody"),e.DNE(75,Nt,2,1,"ng-container",11)(76,wt,9,3,"tr",11)(77,Gt,6,3,"tr",11),e.j41(78,"tr",52)(79,"td",53)(80,"div",54)(81,"div",55),e.EFF(82),e.nI1(83,"translate"),e.k0s(),e.j41(84,"div",56),e.EFF(85),e.nI1(86,"translate"),e.k0s()(),e.DNE(87,Vt,11,9,"div",57),e.j41(88,"div",58),e.DNE(89,Dt,4,7,"div",59)(90,Et,6,11,"div",60),e.k0s()()(),e.j41(91,"tr",52)(92,"td",53)(93,"div",61)(94,"div",62),e.EFF(95),e.nI1(96,"translate"),e.k0s(),e.j41(97,"div",63),e.EFF(98),e.nI1(99,"translate"),e.k0s()(),e.j41(100,"div",61)(101,"div",62),e.EFF(102),e.nI1(103,"translate"),e.k0s(),e.j41(104,"div",63),e.EFF(105),e.nI1(106,"translate"),e.k0s()(),e.j41(107,"div",61)(108,"div",62),e.EFF(109),e.nI1(110,"translate"),e.k0s(),e.j41(111,"div",63),e.EFF(112),e.nI1(113,"translate"),e.k0s()()()(),e.j41(114,"tr",64)(115,"td",53)(116,"div",54)(117,"div",62),e.EFF(118),e.nI1(119,"translate"),e.k0s(),e.j41(120,"div",63),e.EFF(121),e.nI1(122,"translate"),e.k0s()()()(),e.j41(123,"tr",65)(124,"td",66),e.EFF(125),e.nI1(126,"translate"),e.k0s(),e.j41(127,"td",67),e.EFF(128),e.nI1(129,"translate"),e.k0s()()()()()()()()()}if(2&r){const t=e.sdS(14),i=e.XpG();e.R7$(8),e.Y8G("virtualScroll",!0)("items",i.clients)("typeahead",i.searchClient)("loading",i.loading)("multiple",!1),e.R50("ngModel",i.form.clientId),e.Y8G("disabled",!i.isOrderEdit),e.R7$(),e.Y8G("loaderId","order"),e.R7$(4),e.Y8G("activeId",i.active),e.R7$(2),e.Y8G("ngbNavItem",1),e.R7$(4),e.SpI(" ",e.bMT(20,49,"orderManagement.order.clientInfo")," "),e.R7$(3),e.Y8G("ngbNavItem",2),e.R7$(4),e.SpI(" ",e.bMT(27,51,"orderManagement.order.items")," "),e.R7$(3),e.Y8G("ngbNavItem",3),e.R7$(4),e.SpI(" ",e.bMT(34,53,"orderManagement.order.shipping")," "),e.R7$(3),e.Y8G("ngbNavItem",4),e.R7$(4),e.SpI(" ",e.bMT(41,55,"orderManagement.order.finish")," "),e.R7$(4),e.Y8G("ngbNavOutlet",t),e.R7$(4),e.Y8G("ngIf",i.active>1),e.R7$(2),e.Y8G("ngIf",i.active<3),e.R7$(),e.Y8G("ngIf",!i.disabledStatus&&i.form.clientId>0),e.R7$(7),e.SpI(" ",e.bMT(59,57,"orderManagement.order.orderSummary")," "),e.R7$(8),e.SpI(" ",e.bMT(67,59,"sales.salesOrder.product")," "),e.R7$(3),e.SpI(" ",e.bMT(70,61,"sales.salesOrder.productInfo")," "),e.R7$(3),e.SpI(" ",e.bMT(73,63,"sales.salesOrder.price")," "),e.R7$(3),e.Y8G("ngIf",i.form.items.length>0),e.R7$(),e.Y8G("ngIf",0==i.form.items.length),e.R7$(),e.Y8G("ngIf",0==i.form.items.length),e.R7$(5),e.SpI(" ",e.bMT(83,65,"orderManagement.order.SubTotal")," "),e.R7$(3),e.Lme(" ",i.subtotal," ",e.bMT(86,67,"orderManagement.order.currancy")," "),e.R7$(2),e.Y8G("hasPermission",e.lJ4(89,St)),e.R7$(2),e.Y8G("ngIf",i.form.isPrecentage),e.R7$(),e.Y8G("ngIf",!i.form.isPrecentage),e.R7$(5),e.SpI(" ",e.bMT(96,69,"orderManagement.order.PriceAfterDisaccount")," "),e.R7$(3),e.Lme(" ",i.beforeVatTotal.toFixed(2)," ",e.bMT(99,71,"orderManagement.order.currancy")," "),e.R7$(4),e.SpI(" ",e.bMT(103,73,"orderManagement.order.PriceBeforeVat")," "),e.R7$(3),e.Lme(" ",i.beforeVatTotal.toFixed(2)," ",e.bMT(106,75,"orderManagement.order.currancy")," "),e.R7$(4),e.SpI(" ",e.bMT(110,77,"orderManagement.order.tax")," (15%) "),e.R7$(3),e.Lme(" ",(i.VATTotal-i.beforeVatTotal).toFixed(2)," ",e.bMT(113,79,"orderManagement.order.currancy")," "),e.R7$(6),e.SpI(" ",e.bMT(119,81,"orderManagement.order.VAT")," "),e.R7$(3),e.Lme(" ",i.VATTotal.toFixed(2)," ",e.bMT(122,83,"orderManagement.order.currancy")," "),e.R7$(4),e.SpI(" ",e.bMT(126,85,"orderManagement.order.creditLimit"),": "),e.R7$(3),e.Lme(" ",i.form.creditLimit," ",e.bMT(129,87,"orderManagement.order.currancy")," ")}}function $t(r,o){if(1&r){const t=e.RV6();e.j41(0,"div")(1,"requestNewCustomer",122),e.bIt("OnStepChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.onStepChange(n))}),e.k0s()()}if(2&r){const t=e.XpG();e.R7$(),e.Y8G("showBreadcrumbs",!1)("form",t.customer)("isEdit",!0)("errors",t.errors)}}function Xt(r,o){1&r&&(e.j41(0,"div",139),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function Bt(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",123)(1,"div",124)(2,"h4",44),e.nrm(3,"span",92),e.k0s(),e.j41(4,"button",125),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss("Cross click"))}),e.k0s()(),e.j41(5,"div",126),e.nrm(6,"ngx-ui-loader",127),e.j41(7,"form",128,2),e.bIt("submit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.OnRequestSubmit())}),e.j41(9,"div",129)(10,"label",130),e.EFF(11,"sales.clientCollection.cost"),e.k0s(),e.j41(12,"input",131,5),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.formRequest.cost,n)||(s.formRequest.cost=n),e.Njj(n)}),e.k0s(),e.DNE(14,Xt,2,0,"div",132),e.k0s(),e.j41(15,"div",129)(16,"label",133),e.EFF(17,"sales.clientCollection.notes"),e.k0s(),e.j41(18,"textarea",134,6),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.formRequest.notes,n)||(s.formRequest.notes=n),e.Njj(n)}),e.k0s()(),e.j41(20,"div",135)(21,"button",136),e.nrm(22,"i",137)(23,"span",138),e.k0s()()()()()}if(2&r){const t=e.sdS(8),i=e.sdS(13),n=e.XpG();e.R7$(6),e.Y8G("hasProgressBar",!1)("fgsType",n.loaderOperationShap)("loaderId",n.operationLoader),e.R7$(6),e.R50("ngModel",n.formRequest.cost),e.R7$(2),e.Y8G("ngIf",i.invalid&&i.touched),e.R7$(4),e.R50("ngModel",n.formRequest.notes),e.R7$(3),e.Y8G("disabled",!t.valid)}}function Pt(r,o){if(1&r&&(e.j41(0,"span"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&r){const t=o.$implicit;e.R7$(),e.SpI(" ",e.bMT(2,1,"approvals.customerRequest."+t)," , ")}}function Yt(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",140)(1,"div",141)(2,"button",142),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(3,"div",126)(4,"div",143),e.nrm(5,"lord-icon",144)(6,"div",145),e.j41(7,"div",146),e.nrm(8,"i",147),e.DNE(9,Pt,3,3,"span",93),e.k0s()(),e.j41(10,"div",148)(11,"button",149),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.goUpdate())}),e.k0s(),e.j41(12,"button",150),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()}if(2&r){const t=e.XpG();e.R7$(9),e.Y8G("ngForOf",t.errors)}}let Ut=(()=>{class r{constructor(t,i,n,s,l,a,f,M,R,O){this.translateService=t,this.baseService=i,this.requestPersonSalesService=n,this.alertService=s,this.ngxLoader=l,this.datePipe=a,this.modalService=f,this.router=M,this.clientService=R,this.serviceService=O,this.editOrders="orderManagement.order.editOrders",this.addOrders="orderManagement.order.addOrders",this.titleOperation="orderManagement.order.titleOperation",this.keySelected="",this.active=1,this.language=this.translateService.currentLang,this.searchForm="",this.breadCrumbItems=[],this.serverImage=J.c.mediaUrl,this.disabledStatus=!0,this.form={clientVisitDate:new Date,id:null,cityCode:0,clientLocationId:0,clientId:0,isUrgent:!1,notes:"",items:[],discountAmount:0,discountAmountAdd:0,total:0,agent:{},orderPayments:[],orderLocations:{},discountType:1,discountTypeAdd:1,isPrecentage:!0,isPrecentageAdd:!1,totalAddDiscountType:0,totalAddDiscount:0,creditLimit:0,terms:"",serviceCategoryCode:0},this.orderCode=0,this.mobile=0,this.cityCode=0,this.agentName="",this.pendingCode=0,this.isInner=!1,this.isOrderEdit=!0,this.idForm=0,this.totalPaid=0,this.priceModel=0,this.priceModelIndex=0,this.subtotal=0,this.paidTotal=0,this.VATTotal=0,this.beforeVatTotal=0,this.total=0,this.isResolveList=!0,this.extraDiscountCalc=!1,this.employeeGroups=[],this.notifier=new se.B,this.mainDelay=100,this.loaderSearchShap=g.cX,this.loaderOperationShap=g.$$,this.operationLoader=g.ZW,this.isEditForm=!1,this.showEdit=!1,this.orderTypes=[],this.serviceCategories=[],this.services=[],this.paymentTypes=[],this.isFinished=!1,this.isUpdate=!1,this.isReopen=!1,this.formRequest={},this.statusOrder=10,this.clients=[],this.searchClient=new se.B,this.clientParam={pageSize:50,pageNumber:1,search:""},this.loading=!1,this.productsLookUp=[],this.step=1,this.customer={},this.errors={},this.isCustomerDataValid=!1,this.form=this.baseService.salesOrderForm}OpenChangInput(t,i){this.showEdit=!0,this.priceModel=i.price,this.priceModelIndex=t}ChangInput(){this.form.orderServices[`${this.priceModelIndex}`].price=this.priceModel,this.showEdit=!1}ngOnDestroy(){this.notifier.next(),this.notifier.complete()}ngOnInit(){localStorage.getItem("isReopen")&&(this.isReopen=!0),this.resetForm(),this.breadCrumbItems=[{label:"layout.sidebar.orders"},{label:"orderManagement.order.title",active:!0,url:"order/list"},{label:this.isEditForm?"general.action.edit":"general.action.register",active:!0}],this.checkTotal(),this.baseService.checkValidation.subscribe(i=>{this.checkdisableForm()}),this.form.clientId&&(this.getClientSearchDropdwon(this.form.clientId),this.getClientInfo(this.form.clientId)),this.searchClient.pipe((0,je.B)(300),(0,Ie.F)(),(0,le.n)(i=>this.loadClient(i))).subscribe()}GetServiceList(t){this.serviceService.GetServiceList(t).subscribe(i=>{i.data.categories.unshift({id:0,name:this.getTranslationText("general.table.all"),isSelected:!0}),this.productsLookUp=i.data})}getTranslationText(t){let i="";return this.translateService.get(t).pipe((0,p.Q)(this.notifier)).subscribe(n=>{i=n}),i}checkTotal(){this.subtotal=this.form.items.reduce((i,n)=>i+(n.price*n.quantity-n.discount||0),0),this.form.discountAmount<0&&(this.form.discountAmount=0),this.form.discountAmountAdd<0&&(this.form.discountAmountAdd=0);let t=0;this.form.isPrecentage?(this.form.discountAmount=this.form.discountAmount>100?100:this.form.discountAmount,t=this.subtotal-this.subtotal*(+this.form.discountAmount||0)*.01):t=this.subtotal-(+this.form.discountAmount||0),this.form.isPrecentageAdd?(this.form.discountAmountAdd=this.form.discountAmountAdd>100?100:this.form.discountAmountAdd,t-=this.subtotal*(+this.form.discountAmount||0)*.01):t-=+this.form.discountAmountAdd||0,this.beforeVatTotal=t,this.VATTotal=0==t?0:t+.15*t,this.form.total=this.total=this.VATTotal}setFormByOrderCode(t){this.form=t,this.checkTotal(),this.form.isFree&&(this.form.isPrecentage=!0,this.form.discountAmount=100)}onTimeSelected(t){this.form.visitDate=t.dataVisit,this.form.orderTeams=t.selectedTimes}onNavChange(t){this.baseService.salesOrderForm.isCustomerDataValid?2===t.nextId||3===t.nextId?this.baseService.salesOrderForm.clientId||(this.alertService.error("orderManagement.order.mustSelectClient"),t.preventDefault()):4===t.nextId?this.isFinished?this.active=t.nextId:t.preventDefault():this.active=t.nextId:(this.alertService.error("orderManagement.order.mustSelectClient"),t.preventDefault())}changeTab(){}finishedOrder(t){this.isFinished=!0,this.orderCode=t,this.active=4,this.resetForm()}finishedUpdateOrder(t){this.isFinished=!0,this.orderCode=t,this.active=6}newOrder(){this.resetForm(),this.active=1,this.total=0,this.subtotal=0,this.isFinished=!1}editOrder(){this.active=1}resetForm(){this.form=this.baseService.salesOrderForm={clientVisitDate:new Date,id:null,clientLocationId:0,clientId:0,notes:"",items:[],discountAmount:0,discountAmountAdd:0,total:0,agent:{},orderLocations:{},discountType:1,discountTypeAdd:1,isPrecentage:!0,isPrecentageAdd:!1,totalAddDiscountType:0,totalAddDiscount:0,creditLimit:0,terms:"",serviceCategoryCode:0,isCustomerDataValid:!1},this.clientInfo={}}removeService(t){this.form.items.splice(t,1),this.baseService.removeServiceQ.next(t)}updatePrice(t,i){this.form.items[i].price=t.price*t.quantity}decrement(t){let i=this.form.items.find(n=>n.itemId==t.itemId);i.quantity<=1||(i&&(i.quantity=i.quantity-1),this.checkTotal())}increment(t){let i=this.form.items.find(n=>n.itemId==t.itemId);i&&(i.quantity=i.quantity+1),this.checkTotal()}quantityChange(t,i){parseInt(t.target.value)<=0&&(this.form.orderServices.find(l=>l.serviceCode==i.serviceCode).quantity=1),this.checkTotal(),this.form.orderServices=[...this.form.orderServices]}checkPrecentageChange(t){this.form.isPrecentage=t.target.checked,this.checkTotal()}checkPrecentageAddChange(t){this.form.isPrecentageAdd=t.target.checked,this.checkTotal()}onIsFreeChange(t){t?(this.form.isPrecentage=!0,this.form.discountAmount=100):(this.form.isPrecentage=!1,this.form.discountAmount=0),this.checkTotal()}orderFinished(t=20){let i={id:0,clientId:this.form.clientId,clientVisitDate:this.datePipe.transform(this.form.clientVisitDate,"yyyy-MM-ddTHH:mm:ss.000"),offerOrderStatus:t,notes:this.form.notes,terms:this.form.terms,clientLocationId:this.form.clientLocationId,totalAddDiscount:this.form.discountAmount,totalAddDiscountType:this.form.isPrecentage?2:1,offerOrderDetails:this.form.items.map(n=>({discount:n.discount,discountType:n.discountType,itemId:n.itemId,clientQuantity:n.quantity,id:0,price:n.price,unitId:n.unitId}))};this.ngxLoader.startLoader("order"),this.baseService.register(i).subscribe(n=>{n.success?(this.ngxLoader.stopLoader("order"),this.statusOrder=t,this.orderCode=n.data.id,this.finishedOrder(n.data.id),this.subtotal=0,this.beforeVatTotal=0,this.VATTotal=0,this.alertService.success(),this.checkdisableForm()):(this.alertService.error(),this.ngxLoader.stopLoader("order"))},()=>{this.alertService.error(),this.ngxLoader.stopLoader("order")})}checkdisableForm(){let t=!1;null==this.form.clientId||0==this.form.clientId||null==this.form.clientId||null==this.form.clientLocationId||0==this.form.clientLocationId||null==this.form.clientLocationId||this.form.items.length<=0?t=!0:this.form.items.length>0?(this.form.items.forEach(i=>{0!=i.itemId||(t=!0)}),t=!!t):t=!1,this.disabledStatus=t}openModalRequest(t,i="md"){this.formRequest={id:0,clientId:this.form.clientId},this.modalService.open(t,{centered:!0,size:i})}OnRequestSubmit(){this.ngxLoader.start(this.operationLoader),this.requestPersonSalesService.register(this.formRequest).pipe((0,T.O)(),(0,N.c)(this.mainDelay),(0,x.Z)(),(0,p.Q)(this.notifier),(0,I.j)(()=>this.ngxLoader.stopLoader(this.operationLoader)),(0,be.W)(t=>(0,Ce.$)(t))).subscribe(t=>{t.success?(this.alertService.success(),this.modalService.dismissAll()):this.alertService.error(t.message)},t=>{this.alertService.error("general.message."+t)})}next(){const t=this.active+1;this.baseService.salesOrderForm.isCustomerDataValid&&(2!==t&&3!==t||this.baseService.salesOrderForm.clientId)?4===t&&!this.isFinished||(this.active=Math.min(t,3)):this.alertService.error("orderManagement.order.mustSelectClient")}back(){let t=this.active-1;this.active=t<=0?1:t}goEdit(t){this.router.navigateByUrl("/basicData/products/edit",{state:{id:t}})}getClientSearchDropdwon(t){this.clientParam.search=t,this.clientParam.pageNumber=1,this.clientService.GetClientSearch(this.clientParam).subscribe(i=>{this.clients=i.data})}scrollClient(){this.clientParam.pageNumber=this.clientParam.pageNumber+1,this.clientService.GetClientSearch(this.clientParam).subscribe(t=>{this.clients=[...this.clients,...t.data]})}getClientInfo(t){null!=t&&(this.baseService.salesOrderForm.clientId=t,this.baseService.salesOrderForm.clientVisitDate=this.form.clientVisitDate,this.clientService.GetClientInfo(t).subscribe(i=>{if(i.data.isValid){this.baseService.salesOrderForm.isCustomerDataValid=!0;let n=i.data.client;this.form.creditLimit=n.creditLimit,this.baseService.salesOrderForm.terms=n.terms,this.baseService.salesOrderForm.clientGroupId=n.clientGroupId,this.baseService.checkValidationSource.next(!0),this.clientInfo=n,this.GetServiceList(this.baseService.salesOrderForm.clientGroupId),this.getClientLocations(t)}else{this.baseService.salesOrderForm.isCustomerDataValid=!1;let n=i.data.client;n.postalCode=+n.postalCode,n.subNumber=+n.subNumber,n.buildingNumber=+n.buildingNumber,this.customer=n,this.errors=i.data.errors,this.modalService.open(this.clientModal,{centered:!0,size:"md"})}}))}getClientDropdwon(t){return this.clientParam.search=t,this.clientParam.pageNumber=1,this.clientService.GetClientSearch(this.clientParam).pipe((0,le.n)(i=>(this.clients=i.data,this.loading=!1,[])))}loadClient(t){return this.loading=!0,""==t||null==t?(this.loading=!1,(0,ye.of)([])):this.getClientDropdwon(t)}getClientLocations(t){this.clientService.GetClientLocations(t).subscribe(i=>{this.form.locations=i.data,this.baseService.salesOrderForm.locations=i.data})}onStepChange(t=1){this.resetForm(),this.step=t}goUpdate(){this.modalService.dismissAll(),this.step=2}validateDiscount(){!this.form.isPrecentage&&this.form.discountAmount>this.subtotal&&(this.form.discountAmount=this.subtotal),this.checkTotal()}getDiscountPercentage(){return this.form.discountAmount&&0!==this.subtotal?((this.form.discountAmount||0)/this.subtotal*100).toFixed(2)+"%":"0%"}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(u.c$),e.rXU(P),e.rXU(Fe.u),e.rXU(V.u),e.rXU(C.eD),e.rXU(m.vh),e.rXU(_.Bq),e.rXU(y.Ix),e.rXU(pe.X),e.rXU(Le.N))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["sales-operation"]],viewQuery:function(i,n){if(1&i&&e.GBs(Ct,5),2&i){let s;e.mGM(s=e.lsd())&&(n.clientModal=s.first)}},inputs:{form:"form",orderCode:"orderCode",mobile:"mobile",cityCode:"cityCode",agentName:"agentName",pendingCode:"pendingCode",isInner:"isInner",isOrderEdit:"isOrderEdit",isReopen:"isReopen",clients:"clients"},decls:9,vars:6,consts:[["RequestModal",""],["clientModal",""],["formEntity","ngForm"],["customNav","ngbNav"],["discountAmount","ngModel"],["cost","ngModel"],["notes","ngModel"],[1,"step-wizard"],["translate","sales.salesOrder.salesOrderNew",1,"step",3,"click"],["translate","sales.salesOrder.completeCustomerData",1,"step"],["class","row",4,"ngIf"],[4,"ngIf"],[1,"row"],[1,"col-xl-8"],[1,"card"],[1,"card-body","checkout-tab"],[1,"row","my-2"],[1,"col-12"],["for","mobile","translate","",1,"fw-bold","form-label"],["bindLabel","displayName","bindValue","id","required","",3,"scrollToEnd","ngModelChange","virtualScroll","items","typeahead","loading","multiple","ngModel","disabled"],["fgsColor","rgba(255,255,255,0)",3,"loaderId"],[1,"step-arrow-nav"],["ngbNav","","role","tablist",1,"nav","nav-pills","nav-justified","custom-nav",3,"navChange","activeId"],[3,"ngbNavItem"],["ngbNavLink","","id","pills-bill-info-tab","data-bs-toggle","pill","data-bs-target","#pills-bill-info","role","tab","aria-controls","pills-bill-info","aria-selected","true","data-position","0",1,"nav-link","fs-15","p-3"],[1,"ri-user-3-fill","fs-16","p-2","bg-primary-subtle","text-primary","rounded-circle","align-middle","mx-2"],[1,"d-inline","mt-2"],["ngbNavContent",""],["ngbNavLink","","data-bs-toggle","tab","role","tab",1,"nav-link","fs-15","p-3"],[1,"ri-shopping-cart-fill","fs-16","p-2","bg-primary-subtle","text-primary","rounded-circle","align-middle","mx-2"],[1,"ri-user-location-fill","fs-16","p-2","bg-primary-subtle","text-primary","rounded-circle","align-middle","mx-2"],[1,"ri-check-double-fill","fs-16","p-2","bg-primary-subtle","text-primary","rounded-circle","align-middle","mx-2"],[1,"tab-content"],[3,"ngbNavOutlet"],[1,"card-footer","text-center",2,"padding","0.5rem","position","relative"],[1,"row","justify-content-center"],[1,"col-12","col-md-3"],["type","button","class","btn btn-primary btn-label waves-effect waves-light rounded-pill mx-1",3,"click",4,"ngIf"],["type","button","class","btn btn-primary btn-label waves-effect right waves-light rounded-pill",3,"click",4,"ngIf"],["class","col-12 col-md-3",4,"ngIf"],[1,"col-xl-4"],[1,"card-header"],[1,"d-flex"],[1,"flex-grow-1"],[1,"card-title","mb-0"],[1,"card-body"],[1,"table-responsive","table-card"],[1,"table","table-borderless","align-middle","mb-0"],[1,"table-light","text-muted"],["scope","col",2,"width","90px"],["scope","col"],["scope","col",1,"text-end"],["lass","py-0",2,"border-top","hsl(226, 36%, 80%) solid 1px !important"],["colspan","3"],[1,"d-flex","justify-content-between","align-items-center","mb-2"],[1,"w-75","fw-semibold"],[1,"w-25","fw-semibold","text-end"],["class","col-6 input-group",4,"hasPermission"],[1,"mt-2","text-left"],["class","text-danger small",4,"ngIf"],["class","small text-danger",4,"ngIf"],[1,"d-flex","justify-content-between","align-items-center"],[1,"fw-semibold"],[1,"fw-semibold","text-end"],[1,"table-active","py-0"],[1,"py-0",2,"border-top","hsl(226, 36%, 80%) solid 1px !important"],["colspan","2",1,"fw-semibold"],[1,"fw-semibold","text-end","text-danger"],[3,"calacTotal","setFormByOrderCode","isOrderEdit","isInner","clientInfo","form"],[3,"CalcTotal","isOrderEdit","productsLookUp","form"],[3,"isOrderEdit","form"],[3,"editOrderActiveTab","newOrder","statusOrder","orderCode","form"],["type","button",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill","mx-1",3,"click"],[1,"ri-arrow-left-circle-fill","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.back"],["type","button",1,"btn","btn-primary","btn-label","waves-effect","right","waves-light","rounded-pill",3,"click"],[1,"ri-arrow-right-circle-fill","label-icon","align-middle","rounded-pill","fs-16","ms-2"],["translate","general.action.next"],[1,"d-inline-block"],[1,"dropdown-custom","d-inline-block"],["type","button",1,"btn","dropbtn","btn-primary","btn-label","waves-effect","right","waves-light","rounded-pill"],[1,"ri-more-2-fill","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.actions"],[1,"dropdown-menu","dropdown-menu-end","dropdown-content",2,"left","0"],[3,"click",4,"ngIf"],[3,"click"],[1,"dropdown-item"],[1,"text-success","ri-add-box-fill","align-bottom","me-2"],["translate","orderManagement.order.orderSaved"],[1,"text-warning","ri-add-box-fill","align-bottom","me-2"],["translate","orderManagement.order.orderSavedAsDraft"],[1,"text-info","ri-add-box-fill","align-bottom","me-2"],["translate","sales.salesOrder.addRequestLimit"],[4,"ngFor","ngForOf"],[1,"avatar-container","bg-light","rounded","p-1"],["alt","",1,"img-fluid","d-block",3,"src"],[1,"fs-14"],["href","javascript: void(0);",1,"text-body",3,"click"],[1,"text-muted","mb-0"],[1,"col-12","col-md-4","text-mute","text-center"],[1,"input-step","my-2"],["type","button",1,"minus","btn-success",3,"click"],["disabled","","type","number","min","1","max","100",1,"product-quantity",3,"change","id","value"],["type","button",1,"plus","btn-success",3,"click"],[1,"col-12","col-md-4","text-mute","text-right"],[1,"ri-close-fill","text-danger","cursor-pointer",3,"click"],["colspan","3",1,"text-center","text-danger"],["id","empty-cart",1,"text-center","empty-cart",2,"display","block"],[1,"avatar-md","mx-auto","my-3"],[1,"avatar-title","bg-info-subtle","text-info","fs-36","rounded-circle"],[1,"bx","bx-cart"],[1,"mb-3","text-danger"],[1,"text-start","text-muted","fw-semibold"],["colspan","2",1,"text-end"],[1,"col-6","input-group"],["type","button",1,"btn","btn-danger"],["tooltipPosition","top",1,"input-group-text","d-inline",3,"pTooltip"],["type","checkbox","aria-label","Checkbox for following text input",1,"form-check-input",3,"change","checked"],[1,"p-1"],["min","0","InputTirmFilter","","name","discountAmount","type","number","id","discountAmount","required","",1,"form-control","text-right",3,"change","ngModelChange","max","ngModel"],[1,"text-danger","small"],[1,"small","text-danger"],[3,"OnStepChange","showBreadcrumbs","form","isEdit","errors"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"hasProgressBar","fgsType","loaderId"],[3,"submit"],[1,"mb-2"],["for","cost","translate","",1,"fw-bold","form-label"],["InputTirmFilter","","name","cost","type","number","id","cost",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["class","text-danger text-center","translate","",4,"ngIf"],["for","notes","translate","",1,"fw-bold","form-label"],["rows","2","InputTirmFilter","","name","notes","type","text","id","notes",1,"form-control","fs-6",3,"ngModelChange","ngModel"],[1,"text-center"],["type","submit","type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],["translate","",1,"text-danger","text-center"],[1,"modal-content"],[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"mt-2","text-center"],["src","https://cdn.lordicon.com/gdfrsvpt.json","stroke","bold","state","hover-oscillate","trigger","loop","colors","primary:#f7b84b,secondary:#f06548",2,"width","130px","height","130px"],["translate","approvals.customerRequest.requiedFields",1,"fs-5"],["role","alert",1,"alert","alert-danger","alert-dismissible","material-shadow","alert-label-icon","rounded-label","fade","show"],[1,"ri-error-warning-line","label-icon"],[1,"d-flex","gap-2","justify-content-center","mt-4","mb-2"],["type","button","id","save","translate","general.action.update",1,"btn","w-sm","btn-success","fs-4",3,"click"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light","fs-4",3,"click"]],template:function(i,n){if(1&i){const s=e.RV6();e.j41(0,"div",7)(1,"div",8),e.bIt("click",function(){return e.eBV(s),e.Njj(n.step=1)}),e.k0s(),e.nrm(2,"div",9),e.k0s(),e.DNE(3,Lt,130,90,"div",10)(4,$t,2,4,"div",11)(5,Bt,24,7,"ng-template",null,0,e.C5r)(7,Yt,13,1,"ng-template",null,1,e.C5r)}2&i&&(e.R7$(),e.AVh("active",1==n.step),e.R7$(),e.AVh("active",2==n.step),e.R7$(),e.Y8G("ngIf",1==n.step),e.R7$(),e.Y8G("ngIf",2==n.step))},dependencies:[m.Sq,m.bT,_.Um,_.X9,_.sy,_.Gx,_.Ri,_.WA,_.m_,d.qT,d.me,d.Q0,d.BC,d.cb,d.YS,d.VZ,d.zX,d.vS,d.cV,u.Mm,X.m,U.p,E.vr,C.Cv,ie.m,We,ct,mt,ft,bt.z,u.D9],styles:[".avatar-container[_ngcontent-%COMP%]{width:60px;height:60px;background-color:#f8f9fa;display:flex;align-items:center;justify-content:center}@media (max-width: 768px){.avatar-container[_ngcontent-%COMP%]{width:40px;height:40px}}"]})}}return r})(),At=(()=>{class r{constructor(){this.breadCrumbItems=[],this.addOrders="orderManagement.order.addOrders"}ngOnInit(){}static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["order-register"]],decls:1,vars:0,template:function(i,n){1&i&&e.nrm(0,"sales-operation")},dependencies:[Ut],encapsulation:2})}}return r})();var ne=c(56701),ke=c(26364),Y=c(75622);let Qt=(()=>{class r extends ce.d{constructor(t){super(t,J.c.apiUrl+"ShippingTruck/")}static{this.\u0275fac=function(i){return new(i||r)(e.KVO(me.Qq))}}static{this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var H=c(91426),Z=c(53928),A=c(40724),Q=c(88148),q=c(91580),z=c(5779);const qt=()=>["salesSetting.register"],zt=()=>["salesSetting.edit"],Ht=()=>["salesSetting.delete"];function Jt(r,o){1&r&&(e.j41(0,"tr",25)(1,"th",26),e.EFF(2,"#"),e.k0s(),e.j41(3,"th",27),e.nrm(4,"i",28),e.EFF(5," sales.shippingTruck.name "),e.k0s(),e.j41(6,"th",29),e.nrm(7,"i",28),e.EFF(8," sales.shippingTruck.truckNumber "),e.k0s(),e.j41(9,"th",30),e.nrm(10,"i",28),e.EFF(11," sales.shippingTruck.truckDriverName "),e.k0s(),e.j41(12,"th",31),e.EFF(13," sales.shippingTruck.cityName "),e.k0s(),e.j41(14,"th",32),e.nrm(15,"i",28),e.EFF(16," general.table.isActive "),e.k0s(),e.nrm(17,"th",31),e.k0s())}function Kt(r,o){if(1&r&&(e.qex(0),e.j41(1,"span",40),e.EFF(2),e.k0s(),e.bVm()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t.cityName)}}function Zt(r,o){1&r&&e.nrm(0,"span",41)}function Wt(r,o){1&r&&e.nrm(0,"span",42)}function en(r,o){if(1&r&&(e.nrm(0,"i",43),e.EFF(1),e.nI1(2,"date"),e.nrm(3,"br")(4,"i",44),e.EFF(5),e.nI1(6,"date"),e.nrm(7,"br")(8,"i",45),e.EFF(9)),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",e.i5U(2,3,t.createdDate,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",e.i5U(6,6,t.updatedDate,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",t.creatorName," ")}}function tn(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",46),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,s=e.XpG(),l=e.sdS(20);return e.Njj(s.EditModel(n.id,l))}),e.nrm(1,"i",47),e.k0s()}}function nn(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",48),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,s=e.XpG(),l=e.sdS(22);return e.Njj(s.openModal(n.id,l))}),e.nrm(1,"i",49),e.k0s()}}function rn(r,o){if(1&r&&(e.j41(0,"tr",33)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td"),e.DNE(10,Kt,3,1,"ng-container",34),e.k0s(),e.j41(11,"td"),e.DNE(12,Zt,1,0,"span",35)(13,Wt,1,0,"span",36),e.k0s(),e.j41(14,"td"),e.DNE(15,en,10,9,"ng-template",null,3,e.C5r),e.nrm(17,"i",37),e.DNE(18,tn,2,0,"button",38)(19,nn,2,0,"button",39),e.k0s()()),2&r){const t=o.$implicit,i=o.rowIndex,n=e.sdS(16);e.R7$(2),e.JRh(i+1),e.R7$(2),e.JRh(t.name),e.R7$(2),e.JRh(t.truckNumber),e.R7$(2),e.JRh(t.truckDriverName),e.R7$(2),e.Y8G("ngForOf",t.cities),e.R7$(2),e.Y8G("ngIf",t.isActive),e.R7$(),e.Y8G("ngIf",!t.isActive),e.R7$(4),e.Y8G("ngbTooltip",n),e.R7$(),e.Y8G("hasPermission",e.lJ4(10,zt)),e.R7$(),e.Y8G("hasPermission",e.lJ4(11,Ht))}}function sn(r,o){1&r&&(e.j41(0,"div",50),e.EFF(1," general.table.noData "),e.k0s())}function an(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",51)(1,"div",52),e.nrm(2,"ngb-pagination-info",53),e.j41(3,"table-length",54),e.bIt("lengthChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",55)(5,"ngb-pagination",56),e.bIt("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.pagination.pageNumber,n)||(s.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function on(r,o){1&r&&(e.j41(0,"span",82),e.EFF(1,"general.action.register "),e.k0s())}function ln(r,o){1&r&&(e.j41(0,"span",82),e.EFF(1,"general.action.edit "),e.k0s())}function dn(r,o){1&r&&(e.j41(0,"div",83),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function cn(r,o){1&r&&(e.j41(0,"div",83),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function mn(r,o){1&r&&(e.j41(0,"div",83),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function pn(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",57)(1,"div",58)(2,"h4",59),e.DNE(3,on,2,0,"span",60)(4,ln,2,0,"span",60),e.j41(5,"span",61),e.EFF(6),e.k0s()(),e.j41(7,"button",62),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss("Cross click"))}),e.k0s()(),e.j41(8,"div",63),e.nrm(9,"ngx-ui-loader",18),e.j41(10,"form",64,4),e.bIt("submit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.OnSubmit())}),e.j41(12,"div",65)(13,"label",66),e.EFF(14,"sales.shippingTruck.name"),e.k0s(),e.j41(15,"input",67,5),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.name,n)||(s.form.name=n),e.Njj(n)}),e.k0s(),e.DNE(17,dn,2,0,"div",68),e.k0s(),e.j41(18,"div",65)(19,"label",69),e.EFF(20,"sales.shippingTruck.truckNumber"),e.k0s(),e.j41(21,"input",70,6),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.truckNumber,n)||(s.form.truckNumber=n),e.Njj(n)}),e.k0s(),e.DNE(23,cn,2,0,"div",68),e.k0s(),e.j41(24,"div",65)(25,"label",71),e.EFF(26,"sales.shippingTruck.driver"),e.k0s(),e.j41(27,"ng-select",72,7),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.truckDriverId,n)||(s.form.truckDriverId=n),e.Njj(n)}),e.k0s(),e.DNE(29,mn,2,0,"div",68),e.k0s(),e.j41(30,"div",73)(31,"label",71),e.EFF(32,"sales.shippingTruck.cities"),e.k0s(),e.j41(33,"ng-select",74),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.cities,n)||(s.form.cities=n),e.Njj(n)}),e.k0s()(),e.j41(34,"div",75)(35,"label",76),e.EFF(36,"general.table.isActive"),e.k0s(),e.j41(37,"p-inputSwitch",77),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.isActive,n)||(s.form.isActive=n),e.Njj(n)}),e.k0s()(),e.j41(38,"div",78)(39,"button",79),e.nrm(40,"i",80)(41,"span",81),e.k0s()()()()()}if(2&r){const t=e.sdS(11),i=e.sdS(16),n=e.sdS(22),s=e.sdS(28),l=e.XpG();e.R7$(3),e.Y8G("ngIf",!l.isEditForm),e.R7$(),e.Y8G("ngIf",l.isEditForm),e.R7$(2),e.JRh(l.titleOperation),e.R7$(3),e.Y8G("hasProgressBar",!1)("fgsType",l.loaderOperationShap)("loaderId",l.operationLoader),e.R7$(6),e.R50("ngModel",l.form.name),e.R7$(2),e.Y8G("ngIf",i.invalid&&i.touched),e.R7$(4),e.R50("ngModel",l.form.truckNumber),e.R7$(2),e.Y8G("ngIf",n.invalid&&n.touched),e.R7$(4),e.Y8G("items",l.employees)("multiple",!1),e.R50("ngModel",l.form.truckDriverId),e.R7$(2),e.Y8G("ngIf",s.invalid&&s.touched),e.R7$(4),e.Y8G("items",l.cities)("multiple",!0),e.R50("ngModel",l.form.cities),e.R7$(4),e.R50("ngModel",l.form.isActive),e.R7$(2),e.Y8G("disabled",!t.valid)}}function gn(r,o){if(1&r){const t=e.RV6();e.j41(0,"delete-modal",84),e.bIt("deleteConfirm",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.DeleteConfirmSoft())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}}let _n=(()=>{class r extends Y.w{constructor(t,i,n,s,l,a,f,M,R,O,w){super(t,i,f,n,s,l,a),this.baseService=n,this.excelService=R,this.employeeService=O,this.cityService=w,this.title="sales.shippingTruck.title",this.titleOperation="sales.shippingTruck.titleOperation",this.keySelected="",this.assignUsers=[],this.times=[],this.employees=[],this.searchForm={},this.cities=[],this.configRoute(),this.getEmployees(),this.getCities()}OnSearch(t){this.ngxLoader.startLoader(g.a7),this.loadentities()}onSearch(){this.ngxLoader.startLoader(g.a7),this.loadentities()}configRoute(){this.routerActive.data.pipe((0,p.Q)(this.notifier)).subscribe(t=>{this.entities=t.data.data,this.pagination.totalItems=t.data.totalItems},()=>{this.alertService.error()})}getEmployees(){this.employeeService.getDropDown().pipe((0,p.Q)(this.notifier)).subscribe(t=>{this.employees=t.data},()=>{this.alertService.error()})}getCities(){this.cityService.getDropDown().pipe((0,p.Q)(this.notifier)).subscribe(t=>{this.cities=t.data},()=>{this.alertService.error()})}mapExcel(){let t=[];return this.entities?.forEach(i=>{t.push({workTime:i.workTime,isActive:this.getTranslationText("general.table.active")})}),t}mapRegisterForm(t){let i={...t};return i.id=0,i.cities=i.cities.map(n=>({cityId:n,shippingTruckId:0})),i}mapForm(t){let i={...t};return i.cities=i.cities.map(n=>({cityId:n,shippingTruckId:i.id})),i}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,"Service Type",[])}editEntity(){let t=this.mapForm(this.form);this.baseService.editPut(t.id,t).pipe((0,T.O)(),(0,N.c)(this.mainDelay),(0,x.Z)(),(0,p.Q)(this.notifier),(0,I.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(i=>{i.success?this.submitFunished():this.alertService.error("general.message."+i.message)},i=>{this.alertService.error("general.message."+i)})}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(y.nX),e.rXU(u.c$),e.rXU(Qt),e.rXU(V.u),e.rXU(m.vh),e.rXU(C.eD),e.rXU(_.Bq),e.rXU(e.gRc),e.rXU(H.V),e.rXU(Z.O),e.rXU(K.h))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-shipping-trucks"]],features:[e.Vt3],decls:23,vars:18,consts:[["tableMaster",""],["operation",""],["deleteModal",""],["tooltipContent",""],["formEntity","ngForm"],["name","ngModel"],["truckNumber","ngModel"],["truckDriverId","ngModel"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],[3,"reset","search","addNew","addPermission","showExport","totalItems","title"],["control",""],[1,"col-md-3","mb-2"],[1,"search-box"],["InputTirmFilter","","type","search","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],[1,"card-body"],[3,"hasProgressBar","fgsType","loaderId"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["translate","",2,"width",".5%"],["pSortableColumn","name","translate","",2,"width","10%"],[1,"ri-expand-up-down-line"],["pSortableColumn","truckNumber","translate","",2,"width","10%"],["pSortableColumn","truckDriverId","translate","",2,"width","10%"],["translate","",2,"width","10%"],["pSortableColumn","isActive","translate","",2,"width","8%"],[1,"fs-5"],[4,"ngFor","ngForOf"],["class","badge bg-success-subtle text-success p-2","translate","general.table.active",4,"ngIf"],["class","badge bg-danger-subtle text-danger p-2","translate","general.table.noActive",4,"ngIf"],["tooltipPosition","top",1,"mdi","mdi-cog-outline","text-muted","fs-16","align-middle","me-1",3,"ngbTooltip"],["class","btn btn-sm btn-soft-info edit-list mx-2",3,"click",4,"hasPermission"],["class","btn btn-sm btn-soft-danger remove-list",3,"click",4,"hasPermission"],[1,"badge","badge-pill","bg-primary","mx-1"],["translate","general.table.active",1,"badge","bg-success-subtle","text-success","p-2"],["translate","general.table.noActive",1,"badge","bg-danger-subtle","text-danger","p-2"],[1,"ri-history-fill","text-warning"],[1,"ri-history-fill","text-danger"],[1,"ri-user-location-fill","text-primary"],[1,"btn","btn-sm","btn-soft-info","edit-list","mx-2",3,"click"],[1,"ri-pencil-fill","align-bottom","mx-1"],[1,"btn","btn-sm","btn-soft-danger","remove-list",3,"click"],[1,"ri-delete-bin-5-fill","align-bottom"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["class","fw-bold fs-4","translate","",4,"ngIf"],["translate",""],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"submit"],[1,"mb-3"],["for","name","translate","",1,"fw-bold","form-label"],["InputTirmFilter","","name","name","type","text","id","name",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["class","text-danger text-center  ","translate","",4,"ngIf"],["for","truckNumber","translate","",1,"fw-bold","form-label"],["InputTirmFilter","","name","truckNumber","type","text","id","truckNumber",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["translate","",1,"required","fw-bold","form-label","w-100"],["name","truckDriverId","bindValue","code","bindLabel","name","required","",3,"ngModelChange","items","multiple","ngModel"],[1,"col-12","mb-1"],["name","cities","bindValue","code","bindLabel","name",3,"ngModelChange","items","multiple","ngModel"],[1,"form-check"],["for","isActive","translate","",1,"fw-bold","form-label","w-100"],["name","isActive","inputId","isActive",3,"ngModelChange","ngModel"],[1,"text-center"],["type","submit","type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],["translate","",1,"fw-bold","fs-4"],["translate","",1,"text-danger","text-center"],[3,"deleteConfirm","dismiss"]],template:function(i,n){if(1&i){const s=e.RV6();e.j41(0,"div",8)(1,"div",9)(2,"div",10)(3,"base-filter",11),e.bIt("reset",function(){return e.eBV(s),e.Njj(n.onReset())})("search",function(){return e.eBV(s),e.Njj(n.onSearch())})("addNew",function(){e.eBV(s);const a=e.sdS(20);return e.Njj(n.openModalTitle(a,"md"))}),e.qex(4,12),e.j41(5,"div",13)(6,"div",14)(7,"input",15),e.nI1(8,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.filterValue,a)||(n.pagination.filterValue=a),e.Njj(a)}),e.k0s(),e.nrm(9,"i",16),e.k0s()(),e.bVm(),e.k0s(),e.j41(10,"div",17),e.nrm(11,"ngx-ui-loader",18),e.j41(12,"div",19)(13,"p-table",20,0),e.bIt("onLazyLoad",function(a){return e.eBV(s),e.Njj(n.tableChange(a))})("selectionChange",function(a){return e.eBV(s),e.Njj(n.onSelectionChange(a))}),e.DNE(15,Jt,18,0,"ng-template",21)(16,rn,20,12,"ng-template",22),e.k0s()(),e.DNE(17,sn,2,0,"div",23)(18,an,6,8,"div",24),e.k0s()()()(),e.DNE(19,pn,42,19,"ng-template",null,1,e.C5r)(21,gn,1,0,"ng-template",null,2,e.C5r)}2&i&&(e.R7$(3),e.Y8G("addPermission",e.lJ4(17,qt))("showExport",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(8,15,"task.tasklist.subject")),e.R50("ngModel",n.pagination.filterValue),e.R7$(4),e.Y8G("hasProgressBar",!1)("fgsType",n.loaderSearchShap)("loaderId",n.searchLoader),e.R7$(2),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[m.Sq,m.bT,d.qT,d.me,d.BC,d.cb,d.YS,d.vS,d.cV,_.s5,A.b,te.w,Q.p,q.g,u.Mm,S.XI,z.Ei,S.Tg,ve.HW,C.Cv,E.vr,_.md,X.m,U.p,m.vh,u.D9],encapsulation:2})}}return r})();function un(r,o){1&r&&e.nrm(0,"app-shipping-trucks")}let hn=(()=>{class r{constructor(){this.title="sales.salesSetting.title"}ngOnInit(){this.breadCrumbItems=[]}static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-sales-setting"]],decls:15,vars:7,consts:[["Arrow","ngbNav"],[3,"title","breadcrumbItems"],[1,"col-12"],[1,"card"],[1,"card-body"],["ngbNav","",1,"nav","nav-pills","arrow-navtabs","nav-success","bg-light","mb-3",3,"activeId"],[3,"ngbNavItem"],["ngbNavLink",""],[1,"d-block","d-sm-none"],[1,"mdi","mdi-home-variant"],["translate","sales.shippingTruck.title",1,"d-sm-block"],["ngbNavContent",""],[1,"tab-content","text-muted"],[3,"ngbNavOutlet"]],template:function(i,n){if(1&i&&(e.nrm(0,"app-breadcrumbs",1),e.nI1(1,"translate"),e.j41(2,"div",2)(3,"div",3)(4,"div",4)(5,"ul",5,0)(7,"li",6)(8,"a",7)(9,"span",8),e.nrm(10,"i",9),e.k0s(),e.nrm(11,"span",10),e.k0s(),e.DNE(12,un,1,0,"ng-template",11),e.k0s()(),e.j41(13,"div",12),e.nrm(14,"div",13),e.k0s()()()()),2&i){const s=e.sdS(6);e.FS9("title",e.bMT(1,5,n.title)),e.Y8G("breadcrumbItems",n.breadCrumbItems),e.R7$(5),e.Y8G("activeId",1),e.R7$(2),e.Y8G("ngbNavItem",1),e.R7$(7),e.Y8G("ngbNavOutlet",s)}},dependencies:[_.Um,_.X9,_.sy,_.Gx,_.Ri,_.WA,_.m_,ke.m,u.Mm,_n,u.D9],encapsulation:2})}}return r})();var ee=c(62984),ge=c(70053),re=c(35419);function fn(r,o){1&r&&(e.j41(0,"p",18),e.nrm(1,"span",19),e.k0s())}function bn(r,o){if(1&r&&(e.j41(0,"span",20),e.nrm(1,"i",21),e.EFF(2),e.k0s()),2&r){const t=e.XpG();e.R7$(2),e.SpI(" ",t.client.clientName,"")}}function Cn(r,o){1&r&&(e.j41(0,"p",18),e.nrm(1,"span",19),e.k0s())}function Sn(r,o){if(1&r&&(e.j41(0,"span",22),e.nrm(1,"i",21),e.EFF(2),e.k0s()),2&r){const t=e.XpG();e.R7$(2),e.SpI(" ",t.client.creditLimit,"")}}function vn(r,o){1&r&&(e.j41(0,"p",18),e.nrm(1,"span",23),e.k0s())}function jn(r,o){if(1&r&&(e.j41(0,"span",24),e.nrm(1,"i",21),e.EFF(2),e.nI1(3,"date"),e.k0s()),2&r){const t=e.XpG();e.R7$(2),e.SpI("",e.i5U(3,1,t.client.lastTransactionDate,"yyyy-MM-dd ")," ")}}function In(r,o){1&r&&(e.j41(0,"p",18),e.nrm(1,"span",25),e.k0s())}function yn(r,o){if(1&r&&(e.j41(0,"span",26),e.nrm(1,"i",21),e.EFF(2),e.k0s()),2&r){const t=e.XpG();e.R7$(2),e.Lme(" ",t.client.clientQuantity," - ",t.client.clientInvoiceCost," ")}}function kn(r,o){1&r&&(e.j41(0,"p",18),e.nrm(1,"span",27),e.k0s())}function Tn(r,o){if(1&r&&(e.j41(0,"span",28),e.nrm(1,"i",21),e.EFF(2),e.k0s()),2&r){const t=e.XpG();e.R7$(2),e.SpI("",t.client.totalDebt," ")}}let ue=(()=>{class r{constructor(t){this.clientService=t,this.dismiss=new e.bkB,this.clientId=0,this.client={},this.objectKeys=Object.keys}ngOnInit(){this.getClientSummary()}getClientSummary(){0!=this.clientId&&this.clientService.GetClientSummary(this.clientId).subscribe(t=>{this.client=t.data})}dismissFn(){this.dismiss.emit(!0)}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(pe.X))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["client-summary"]],inputs:{clientId:"clientId"},outputs:{dismiss:"dismiss"},decls:28,vars:10,consts:[[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"row","justify-content-between","my-2"],["translate","client.client.clientName",1,"col-12","col-md-6"],[1,"col-12","col-md-6"],["class","card-text placeholder-glow",4,"ngIf"],["class","badge badge-label bg-primary fs-5",4,"ngIf"],[1,"row","justify-content-between"],["translate","client.client.CreditLimit",1,"col-12","col-md-6"],["class","badge badge-label bg-warning fs-5",4,"ngIf"],[1,"row","my-2","justify-content-between"],["translate","client.client.lastTransactionDate",1,"col-12","col-md-6"],["class","badge badge-label bg-info fs-5",4,"ngIf"],["translate","client.client.numberInvoiceQuantity",1,"col-12","col-md-6"],["class","badge badge-label bg-success fs-5",4,"ngIf"],["translate","client.client.totalDebt",1,"col-12","col-md-6"],["class","badge badge-label bg-danger fs-5",4,"ngIf"],[1,"card-text","placeholder-glow"],[1,"placeholder","col-12","bg-primary"],[1,"badge","badge-label","bg-primary","fs-5"],[1,"mdi","mdi-circle-medium"],[1,"badge","badge-label","bg-warning","fs-5"],[1,"placeholder","col-12","bg-info"],[1,"badge","badge-label","bg-info","fs-5"],[1,"placeholder","col-12","bg-success"],[1,"badge","badge-label","bg-success","fs-5"],[1,"placeholder","col-12","bg-danger"],[1,"badge","badge-label","bg-danger","fs-5"]],template:function(i,n){1&i&&(e.j41(0,"div",0)(1,"button",1),e.bIt("click",function(){return n.dismissFn()}),e.k0s()(),e.j41(2,"div",2)(3,"div",3),e.nrm(4,"div",4),e.j41(5,"div",5),e.DNE(6,fn,2,0,"p",6)(7,bn,3,1,"span",7),e.k0s()(),e.j41(8,"div",8),e.nrm(9,"div",9),e.j41(10,"div",5),e.DNE(11,Cn,2,0,"p",6)(12,Sn,3,1,"span",10),e.k0s()(),e.j41(13,"div",11),e.nrm(14,"div",12),e.j41(15,"div",5),e.DNE(16,vn,2,0,"p",6)(17,jn,4,4,"span",13),e.k0s()(),e.j41(18,"div",8),e.nrm(19,"div",14),e.j41(20,"div",5),e.DNE(21,In,2,0,"p",6)(22,yn,3,2,"span",15),e.k0s()(),e.j41(23,"div",11),e.nrm(24,"div",16),e.j41(25,"div",5),e.DNE(26,kn,2,0,"p",6)(27,Tn,3,1,"span",17),e.k0s()()()),2&i&&(e.R7$(6),e.Y8G("ngIf",!n.client.clientName),e.R7$(),e.Y8G("ngIf",n.client.clientName),e.R7$(4),e.Y8G("ngIf",!n.client.creditLimit),e.R7$(),e.Y8G("ngIf",n.client.creditLimit),e.R7$(4),e.Y8G("ngIf",!n.client.lastTransactionDate),e.R7$(),e.Y8G("ngIf",n.client.lastTransactionDate),e.R7$(4),e.Y8G("ngIf",!n.client.clientQuantity),e.R7$(),e.Y8G("ngIf",n.client.clientQuantity),e.R7$(4),e.Y8G("ngIf",!n.client.totalDebt),e.R7$(),e.Y8G("ngIf",n.client.totalDebt))},dependencies:[m.bT,u.Mm,m.vh],encapsulation:2})}}return r})();const he=r=>[r];function xn(r,o){if(1&r&&(e.j41(0,"span"),e.nrm(1,"span",62),e.k0s()),2&r){const t=e.XpG(2);e.ZvI(" badge ",t.getStatus(t.form),""),e.R7$(),e.FS9("translate","sales.salesOrder."+t.form.offerOrderStatusName)}}function Mn(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",15)(1,"label",22),e.EFF(2,"sales.salesOrder.clientDeliveryDate"),e.k0s(),e.j41(3,"input",63),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG(2);return e.DH7(s.form.clientVisitDate,n)||(s.form.clientVisitDate=n),e.Njj(n)}),e.k0s()()}if(2&r){const t=e.XpG(2);e.R7$(3),e.R50("ngModel",t.form.clientVisitDate),e.Y8G("altInput",!0)("enableTime",!0)("convertModelValue",!0)("dateFormat","Y-m-d H:i")}}function Rn(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",15),e.EFF(1),e.nrm(2,"label",64),e.j41(3,"ng-select",65),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG(2);return e.DH7(s.form.salsePersonId,n)||(s.form.salsePersonId=n),e.Njj(n)}),e.k0s()()}if(2&r){const t=e.XpG(2);e.R7$(),e.SpI(" ",t.form.offerOrderStatus," "),e.R7$(2),e.Y8G("disabled",t.isDraft)("items",t.employees),e.R50("ngModel",t.form.salsePersonId)}}function On(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",21)(1,"label",66),e.EFF(2,"sales.salesOrder.changeQuantityMessage"),e.k0s(),e.j41(3,"textarea",67,1),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG(2);return e.DH7(s.form.changeQuantityMessage,n)||(s.form.changeQuantityMessage=n),e.Njj(n)}),e.k0s()()}if(2&r){const t=e.XpG(2);e.R7$(3),e.Y8G("disabled",t.isDraft),e.R50("ngModel",t.form.changeQuantityMessage)}}function Fn(r,o){1&r&&e.nrm(0,"th",68)}function Nn(r,o){1&r&&e.nrm(0,"th",69)}function wn(r,o){1&r&&e.nrm(0,"th",70)}function Gn(r,o){if(1&r){const t=e.RV6();e.j41(0,"td")(1,"input",77),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG().$implicit;return e.DH7(s.clientQuantity,n)||(s.clientQuantity=n),e.Njj(n)}),e.k0s()()}if(2&r){const t=e.XpG(),i=t.$implicit,n=t.$index;e.R7$(),e.Y8G("name","clientQuantity"+e.eq3(2,he,n)),e.R50("ngModel",i.clientQuantity)}}function Vn(r,o){if(1&r){const t=e.RV6();e.j41(0,"td")(1,"ng-select",72),e.bIt("ngModelChange",function(n){e.eBV(t);const s=e.XpG().$index,l=e.XpG(2);return e.Njj(l.discountSelect(n,s,2))}),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG().$implicit;return e.DH7(s.discountType,n)||(s.discountType=n),e.Njj(n)}),e.k0s()()}if(2&r){const t=e.XpG(),i=t.$implicit,n=t.$index,s=e.XpG(2);e.R7$(),e.Y8G("name","discountType"+e.eq3(3,he,n))("items",s.discountTypes),e.R50("ngModel",i.discountType)}}function Dn(r,o){if(1&r){const t=e.RV6();e.j41(0,"td")(1,"input",78),e.bIt("ngModelChange",function(n){e.eBV(t);const s=e.XpG().$index,l=e.XpG(2);return e.Njj(l.discountSelect(n,s))}),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG().$implicit;return e.DH7(s.discount,n)||(s.discount=n),e.Njj(n)}),e.k0s()()}if(2&r){const t=e.XpG(),i=t.$implicit,n=t.$index;e.R7$(),e.Y8G("name","discount"+e.eq3(2,he,n)),e.R50("ngModel",i.discount)}}function En(r,o){if(1&r){const t=e.RV6();e.j41(0,"tr")(1,"td")(2,"ng-select",71),e.bIt("change",function(n){const s=e.eBV(t).$index,l=e.XpG(2);return e.Njj(l.itemSelected(n,s))}),e.mxI("ngModelChange",function(n){const s=e.eBV(t).$implicit;return e.DH7(s.itemId,n)||(s.itemId=n),e.Njj(n)}),e.k0s()(),e.j41(3,"td")(4,"ng-select",72),e.mxI("ngModelChange",function(n){const s=e.eBV(t).$implicit;return e.DH7(s.unitId,n)||(s.unitId=n),e.Njj(n)}),e.k0s()(),e.DNE(5,Gn,2,4,"td",73),e.j41(6,"td")(7,"input",74),e.bIt("ngModelChange",function(n){const s=e.eBV(t).$index,l=e.XpG(2);return e.Njj(l.quantitySelect(n,s))}),e.mxI("ngModelChange",function(n){const s=e.eBV(t).$implicit;return e.DH7(s.quantity,n)||(s.quantity=n),e.Njj(n)}),e.k0s()(),e.j41(8,"td"),e.EFF(9),e.k0s(),e.DNE(10,Vn,2,5,"td",73)(11,Dn,2,4,"td",73),e.j41(12,"td"),e.EFF(13),e.k0s(),e.j41(14,"td")(15,"span",75),e.bIt("click",function(){const n=e.eBV(t).$index,s=e.XpG(2);return e.Njj(s.deleteRow(n))}),e.nrm(16,"i",76),e.k0s()()()}if(2&r){const t=o.$implicit,i=o.$index,n=e.XpG(2);e.R7$(2),e.Y8G("name","itemId"+e.eq3(13,he,i))("items",n.items),e.R50("ngModel",t.itemId),e.R7$(2),e.Y8G("name","unitId"+e.eq3(15,he,i))("items",t.units),e.R50("ngModel",t.unitId),e.R7$(),e.Y8G("ngIf",!(0==n.form.offerOrderStatus||5==n.form.offerOrderStatus)),e.R7$(2),e.Y8G("name","quantity"+e.eq3(17,he,i)),e.R50("ngModel",t.quantity),e.R7$(2),e.SpI(" ",t.price," "),e.R7$(),e.Y8G("ngIf",!n.isChangeQuantity&&!n.isDraft),e.R7$(),e.Y8G("ngIf",!n.isChangeQuantity&&!n.isDraft),e.R7$(2),e.SpI("",t.net," ")}}function Ln(r,o){if(1&r){const t=e.RV6();e.j41(0,"td",51)(1,"div",79)(2,"ng-select",80),e.bIt("change",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.getTotal())}),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG(2);return e.DH7(s.form.totalAddDiscountType,n)||(s.form.totalAddDiscountType=n),e.Njj(n)}),e.k0s(),e.j41(3,"input",81),e.bIt("change",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.getTotal())}),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG(2);return e.DH7(s.form.totalAddDiscount,n)||(s.form.totalAddDiscount=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG(2);e.R7$(2),e.Y8G("disabled",t.isChangeQuantity)("items",t.discountTypes),e.R50("ngModel",t.form.totalAddDiscountType),e.R7$(),e.Y8G("disabled",t.isChangeQuantity),e.R50("ngModel",t.form.totalAddDiscount)}}function $n(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",3)(1,"div",4)(2,"h4",5)(3,"span",6),e.EFF(4),e.k0s(),e.j41(5,"span",7),e.EFF(6),e.k0s(),e.DNE(7,xn,2,4,"span",8),e.k0s(),e.j41(8,"button",9),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.dismissFn())}),e.k0s()(),e.j41(9,"div",10),e.nrm(10,"ngx-ui-loader",11),e.j41(11,"form",12,0),e.bIt("submit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.orderFinished())}),e.j41(13,"div",13),e.DNE(14,Mn,4,5,"div",14),e.j41(15,"div",15)(16,"label",16),e.EFF(17,"sales.salesOrder.acutalDeliveryDate"),e.k0s(),e.j41(18,"input",17),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.acutalVisitDate,n)||(s.form.acutalVisitDate=n),e.Njj(n)}),e.k0s()(),e.j41(19,"div",15),e.nrm(20,"label",18),e.j41(21,"ng-select",19),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.clientLocationId,n)||(s.form.clientLocationId=n),e.Njj(n)}),e.k0s()(),e.DNE(22,Rn,4,4,"div",14)(23,On,5,2,"div",20),e.j41(24,"div",21)(25,"label",22),e.EFF(26,"sales.salesOrder.terms"),e.k0s(),e.j41(27,"textarea",23),e.nI1(28,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.terms,n)||(s.form.terms=n),e.Njj(n)}),e.k0s()()(),e.j41(29,"div",24)(30,"div",25)(31,"div",26)(32,"div",27),e.nrm(33,"h5",28),e.k0s()(),e.j41(34,"div",29)(35,"div",30)(36,"table",31)(37,"thead",32)(38,"tr"),e.nrm(39,"th",33)(40,"th",34),e.DNE(41,Fn,1,0,"th",35),e.nrm(42,"th",36)(43,"th",37),e.DNE(44,Nn,1,0,"th",38)(45,wn,1,0,"th",39),e.nrm(46,"th",40)(47,"th",41),e.k0s()(),e.j41(48,"tbody",42),e.Z7z(49,En,17,19,"tr",null,e.Vm6),e.j41(51,"tr",43)(52,"td",44)(53,"span",45),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.addRow())}),e.nrm(54,"i",46)(55,"span",47),e.k0s()(),e.j41(56,"td",48)(57,"table",49)(58,"tbody")(59,"tr"),e.nrm(60,"td",50),e.j41(61,"td",51),e.EFF(62),e.k0s()(),e.j41(63,"tr"),e.nrm(64,"td",52),e.DNE(65,Ln,4,5,"td",53),e.k0s(),e.j41(66,"tr",54),e.nrm(67,"td",55),e.j41(68,"td",51),e.EFF(69),e.k0s()(),e.j41(70,"tr",56),e.nrm(71,"th",57),e.j41(72,"th",51),e.EFF(73),e.k0s()()()()()()()()()()()(),e.j41(74,"div",58)(75,"button",59),e.nrm(76,"i",60)(77,"span",61),e.k0s()()()()()}if(2&r){const t=e.sdS(12),i=e.XpG();e.R7$(4),e.SpI("#SO#",i.form.id," "),e.R7$(2),e.SpI("",i.form.clientName," "),e.R7$(),e.Y8G("ngIf",i.form.offerOrderStatus>=0),e.R7$(3),e.Y8G("hasProgressBar",!1)("fgsType",i.loaderOperationShap)("loaderId",i.operationLoader),e.R7$(4),e.Y8G("ngIf",!(0==i.form.offerOrderStatus||5==i.form.offerOrderStatus)),e.R7$(4),e.R50("ngModel",i.form.acutalVisitDate),e.Y8G("altInput",!0)("enableTime",!0)("convertModelValue",!0)("dateFormat","Y-m-d H:i"),e.R7$(3),e.Y8G("items",i.locations),e.R50("ngModel",i.form.clientLocationId),e.R7$(),e.Y8G("ngIf",!(0==i.form.offerOrderStatus||5==i.form.offerOrderStatus)),e.R7$(),e.Y8G("ngIf",5==i.form.offerOrderStatus),e.R7$(4),e.Y8G("placeholder",e.bMT(28,28,"sales.salesOrder.termsPlaceholder")),e.R50("ngModel",i.form.terms),e.R7$(14),e.Y8G("ngIf",!(0==i.form.offerOrderStatus||5==i.form.offerOrderStatus)),e.R7$(3),e.Y8G("ngIf",!i.isChangeQuantity&&!i.isDraft),e.R7$(),e.Y8G("ngIf",!i.isChangeQuantity&&!i.isDraft),e.R7$(4),e.Dyx(i.form.details),e.R7$(3),e.BMQ("colspan",0==i.form.offerOrderStatus||5==i.form.offerOrderStatus?3:4),e.R7$(4),e.BMQ("colspan",0==i.form.offerOrderStatus||5==i.form.offerOrderStatus?1:2),e.R7$(6),e.JRh(i.form.total),e.R7$(3),e.Y8G("ngIf",!(0==i.form.offerOrderStatus||5==i.form.offerOrderStatus)),e.R7$(4),e.JRh(i.form.tax),e.R7$(4),e.JRh(i.form.totalNet),e.R7$(2),e.Y8G("disabled",!t.valid)}}function Xn(r,o){1&r&&e.nrm(0,"span",83)}function Bn(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",3)(1,"div",4)(2,"h4",5)(3,"p",82),e.nrm(4,"span",83),e.k0s()(),e.j41(5,"button",9),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.dismissFn())}),e.k0s()(),e.j41(6,"p",82),e.DNE(7,Xn,1,0,"span",84),e.k0s()()}if(2&r){const t=e.XpG();e.R7$(7),e.Y8G("ngForOf",t.repeat22)}}let fe=(()=>{class r{constructor(t,i,n,s,l,a,f,M){this.translateService=t,this.offerOrderService=i,this.itemsService=n,this.clientService=s,this.employeeService=l,this.alertService=a,this.datePipe=f,this.ngxLoader=M,this.orderSelected=0,this.isDraft=!1,this.isChangeQuantity=!1,this.isShipping=!1,this.loaderOperationShap=g.$$,this.operationLoader=g.ZW,this.form={},this.truncks=[],this.locations=[],this.discountTypes=[],this.items=[],this.employees=[],this.isHiden=!0,this.notifier=new se.B,this.repeat22=Array.from({length:19}),this.dismiss=new e.bkB}ngOnInit(){this.GetPersones(),this.getItemsServices(),this.discountTypes=this.offerOrderService.discountTypes,this.discountTypes.forEach(t=>{t.name=this.getTranslationText("sales.salesOrder."+t.name)}),this.getOrder()}getItemsServices(){this.itemsService.getItemDropDown().subscribe(t=>{this.items=t.data})}getLocations(t){this.clientService.GetClientLocations(t).subscribe(i=>{this.locations=i.data})}GetPersones(){this.employeeService.GetAllByType(9).subscribe(t=>{this.employees=t.data})}getTranslationText(t){let i="";return this.translateService.get(t).pipe((0,p.Q)(this.notifier)).subscribe(n=>{i=n}),i}getOrder(){this.offerOrderService.GetOrderDetail(this.orderSelected).subscribe(t=>{this.isHiden=!1,this.form=t.data,this.getLocations(this.form.clientId),this.getTotal()},t=>{this.alertService.error(t)})}update(){}getTotal(){let t=0,i=0,n=0;this.form.details.forEach(s=>{s.discount<0&&(s.discoun=0);let l=s.quantity*s.price,a=0;1===s.discountType?a=s.discount:2===s.discountType&&(a=l*s.discount/100),i+=+a;let f=l-a;s.net=f.toFixed(2),t+=+f}),1===this.form.totalAddDiscountType?n=this.form.totalAddDiscount:2===this.form.totalAddDiscountType&&(n=t*this.form.totalAddDiscount/100),this.form.total=t,this.form.totalAddDiscount=this.form.totalAddDiscount,this.form.tax=15*this.form.total/100,this.form.totalNet=this.form.total-n+this.form.tax,this.form.total=this.form.total.toFixed(2),this.form.totalAddDiscount=this.form.totalAddDiscount.toFixed(2),this.form.tax=this.form.tax.toFixed(2),this.form.totalNet=this.form.totalNet.toFixed(2)}quantitySelect(t,i){t&&(t<=0&&(t=1),this.form.details[i].quantity=parseInt(t),this.form.details[i].net=this.form.details[i].price*this.form.details[i].quantity,this.discountSelect(this.form.details[i].discount,i),this.getTotal())}discountSelect(t,i,n=1){if(t){(t=parseInt(t))<=0&&(this.form.details[i].discount=0),1==n&&(this.form.details[i].discount=t);let s=0;1==this.form.details[i].discountType?s=this.form.details[i].discount:(s=this.form.details[i].price*this.form.details[i].quantity*this.form.details[i].discount/100,s=+s.toFixed(2)),this.form.details[i].net=this.form.details[i].price*this.form.details[i].quantity-s,this.form.details[i].net=this.form.details[i].net.toFixed(2),this.getTotal()}}dismissFn(){this.dismiss.emit(!0)}getStatus(t){return 10==t.offerOrderStatus||20==t.offerOrderStatus?"bg-warning-subtle text-warning":30==t.offerOrderStatus?"bg-success-subtle text-success":40==t.offerOrderStatus?"bg-danger-subtle text-danger":50==t.offerOrderStatus?"bg-danger-success text-success":"bg-warning-subtle text-warning"}addRow(){this.form.details.push({itemId:0,unitId:null,units:[],clientQuantity:1,quantity:1,priceUnit:null,discount:0,discountType:1,net:0})}itemSelected(t,i){t&&(this.form.details[i].unitId=t.units.length>0?t.units[0].id:null,this.form.details[i].units=t.units,this.form.details[i].price=t.price,this.quantitySelect(this.form.details[i].quantity,i),this.getTotal())}deleteRow(t){this.form.details.length<=1||(this.form.details.splice(t,1),this.getTotal())}orderFinished(){let t={id:this.form.id,clientId:this.form.clientId,clientVisitDate:this.datePipe.transform(this.form.clientVisitDate,"yyyy-MM-ddTHH:mm:ss.000"),acutalVisitDate:this.datePipe.transform(this.form.acutalVisitDate,"yyyy-MM-ddTHH:mm:ss.000"),offerOrderStatus:this.form.offerOrderStatus,notes:this.form.notes,terms:this.form.terms,changeQuantityMessage:this.form.changeQuantityMessage,salsePersonId:this.form.salsePersonId,clientLocationId:this.form.clientLocationId,totalAddDiscount:this.form.discountAmount,totalAddDiscountType:this.form.isPrecentage?2:1,offerOrderDetails:this.form.details.map(i=>({discount:i.discount,discountType:i.discountType,itemId:i.itemId,clientQuantity:i.clientQuantity,approvedQuantity:i.quantity,id:i.id,price:i.price,unitId:i.unitId,offerOrderMasterId:this.form.id}))};this.ngxLoader.startLoader("operationLoader"),this.offerOrderService.edit(t.id,t).subscribe(i=>{i.success?(this.ngxLoader.stopLoader("operationLoader"),this.alertService.success()):(this.alertService.error(),this.ngxLoader.stopLoader("operationLoader"))},()=>{this.alertService.error(),this.ngxLoader.stopLoader("operationLoader")})}ngOnDestroy(){this.notifier.next(),this.notifier.complete()}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(u.c$),e.rXU(P),e.rXU(Le.N),e.rXU(pe.X),e.rXU(Z.O),e.rXU(V.u),e.rXU(m.vh),e.rXU(C.eD))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["sales-edit-order"]],inputs:{orderSelected:"orderSelected",isDraft:"isDraft",isChangeQuantity:"isChangeQuantity",isShipping:"isShipping"},outputs:{dismiss:"dismiss"},decls:2,vars:2,consts:[["formEntity","ngForm"],["notes","ngModel"],["class","modal-content border-0  ",4,"ngIf"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-dark-subtle"],[1,"card-title","mb-0"],[1,"badge","bg-primary-subtle","text-primary","fs-4"],[1,"badge","bg-danger-subtle","text-danger","fs-4","mx-2"],[3,"class",4,"ngIf"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"hasProgressBar","fgsType","loaderId"],[3,"submit"],[1,"row"],["class","col-12 col-md-3",4,"ngIf"],[1,"col-12","col-md-3"],["for","name","translate","",1,"required","fw-bold","form-label"],["name","acutalVisitDate","type","text","mwlFlatpickr","","altFormat","Y-m-d H:i","required","",1,"form-control","flatpickr-input",3,"ngModelChange","ngModel","altInput","enableTime","convertModelValue","dateFormat"],["for","name","translate","orderManagement.order.savedAddress",1,"required","fw-bold","form-label"],["name","clientLocationId","bindValue","id","bindLabel","name","required","",2,"width","100%",3,"ngModelChange","items","ngModel"],["class","col-12 col-md-6",4,"ngIf"],[1,"col-12","col-md-6"],["for","name","translate","",1,"fw-bold","form-label"],["rows","1","name","terms","type","text",1,"form-control",3,"ngModelChange","placeholder","ngModel"],[1,"row","justify-content-center","my-0"],[1,"card"],[1,"card-header","p-0"],[1,"d-flex","align-items-center"],["translate","sales.salesRequests.items",1,"card-title","flex-grow-1","mb-0"],[1,"card-body"],[1,"table-responsive","table-card"],[1,"table","table-nowrap","align-middle","table-borderless","mb-0"],[1,"table-light","text-muted","p-1"],["translate","sales.salesRequests.itemName",2,"width","20%"],["translate","sales.salesRequests.unit",2,"width","12%"],["style","width:10%","translate","sales.salesRequests.clientQuantity",4,"ngIf"],["translate","sales.salesRequests.quantity",2,"width","12%"],["translate","sales.salesRequests.priceUnit",2,"width","12%"],["style","width:12%","translate","sales.salesRequests.discountType",4,"ngIf"],["style","width:12%","translate","sales.salesRequests.discount",4,"ngIf"],["translate","sales.salesRequests.net",2,"width","12%"],[2,"width","5%"],[1,"body-orderEdit"],[1,"border-top","border-top-dashed"],[2,"vertical-align","top"],[1,"cursor-pointer","p-2","mb-0","badge","bg-success-subtle","text-success",3,"click"],[1,"ri-add-fill"],["translate","sales.salesRequests.addItem"],[1,"fw-medium","p-0"],[1,"table","table-borderless","mb-0"],["translate","sales.salesOrder.total",1,"m-0","p-0"],[1,"text-end","m-0","p-0"],["translate","sales.salesOrder.extraDiscount",1,"m-0","p-0"],["class","text-end m-0 p-0",4,"ngIf"],[1,"m-0","p-0"],["translate","sales.salesOrder.tax",1,"m-0","p-0"],[1,"border-top","border-top-dashed","m-0","p-0"],["scope","row","translate","sales.salesOrder.net",1,"m-0","p-0"],[1,"d-flex","justify-content-center","m-0"],["type","submit","type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],[3,"translate"],["name","clientVisitDate","type","text","mwlFlatpickr","","altFormat","Y-m-d H:i","required","",1,"form-control","flatpickr-input",3,"ngModelChange","ngModel","altInput","enableTime","convertModelValue","dateFormat"],["for","name","translate","sales.salesOrder.salsePerson",1,"fw-bold","form-label"],["name","salsePersonId","bindValue","id","bindLabel","name",2,"width","100%",3,"ngModelChange","disabled","items","ngModel"],["for","changeQuantityMessage","translate","",1,"fw-bold","form-label"],["rows","1","InputTirmFilter","","name","changeQuantityMessage","type","text","id","changeQuantityMessage",1,"form-control","fs-6",3,"ngModelChange","disabled","ngModel"],["translate","sales.salesRequests.clientQuantity",2,"width","10%"],["translate","sales.salesRequests.discountType",2,"width","12%"],["translate","sales.salesRequests.discount",2,"width","12%"],["clearable","false","clearOnBackspace","false","bindValue","id","bindLabel","name",2,"width","100%",3,"change","ngModelChange","name","items","ngModel"],["clearable","false","clearOnBackspace","false","bindValue","id","bindLabel","name",2,"width","100%",3,"ngModelChange","name","items","ngModel"],[4,"ngIf"],["type","text","id","quantity",1,"form-control","fs-6",3,"ngModelChange","name","ngModel"],[1,"cursor-pointer","mb-0","p-2","badge","bg-danger-subtle","text-danger",3,"click"],[1,"ri-delete-bin-2-fill"],["type","text","id","clientQuantity",1,"form-control","fs-6",3,"ngModelChange","name","ngModel"],["InputTirmFilter","","type","text","id","discount",1,"form-control","fs-6",3,"ngModelChange","name","ngModel"],[1,"input-group","mx-4","my-1",2,"width","80%"],["clearable","false","clearOnBackspace","false","name","totalAddDiscountType","bindValue","id","bindLabel","name",3,"change","ngModelChange","disabled","items","ngModel"],["InputTirmFilter","","name","totalAddDiscount","type","text","id","totalAddDiscount",1,"form-control","fs-6",2,"width","20%",3,"change","ngModelChange","disabled","ngModel"],[1,"card-text","placeholder-glow"],[1,"placeholder","col-12"],["class","placeholder col-12",4,"ngFor","ngForOf"]],template:function(i,n){1&i&&e.DNE(0,$n,78,30,"div",2)(1,Bn,8,1,"div",2),2&i&&(e.Y8G("ngIf",!n.isHiden),e.R7$(),e.Y8G("ngIf",n.isHiden))},dependencies:[m.Sq,m.bT,d.qT,d.me,d.BC,d.cb,d.YS,d.vS,d.cV,D.kL,u.Mm,C.Cv,E.vr,X.m,u.D9],encapsulation:2})}}return r})();const Pn=()=>["salesOrder.register"],Yn=()=>["salesOrder.edit"];function Un(r,o){1&r&&(e.j41(0,"tr",28),e.nrm(1,"th",29),e.j41(2,"th",30),e.EFF(3,"#"),e.k0s(),e.j41(4,"th",31),e.nrm(5,"i",32),e.EFF(6," orderManagement.order.orderCode "),e.k0s(),e.j41(7,"th",33),e.nrm(8,"i",32),e.EFF(9," orderManagement.order.creation "),e.k0s(),e.j41(10,"th",34),e.EFF(11," orderManagement.order.status "),e.k0s(),e.j41(12,"th",35),e.nrm(13,"i",32),e.EFF(14," orderManagement.order.agentName "),e.k0s(),e.j41(15,"th",36),e.EFF(16," sales.salesOrder.salsePerson "),e.k0s(),e.j41(17,"th",37),e.nrm(18,"i",32),e.EFF(19," sales.salesOrder.clientVisitDate "),e.k0s(),e.j41(20,"th",38),e.nrm(21,"i",32),e.EFF(22," sales.salesOrder.totalQuantity "),e.k0s(),e.j41(23,"th",39),e.nrm(24,"i",32),e.EFF(25," sales.salesOrder.totalDiscount "),e.k0s(),e.j41(26,"th",40),e.nrm(27,"i",32),e.EFF(28," sales.salesOrder.netPrice "),e.k0s(),e.nrm(29,"th",41),e.k0s())}function An(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",51),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,s=e.XpG(),l=e.sdS(48);return e.Njj(s.openModal(n.id,l,"xl"))}),e.nrm(1,"i",52)(2,"span",53),e.k0s()}}function Qn(r,o){if(1&r){const t=e.RV6();e.j41(0,"tr",42)(1,"td"),e.nrm(2,"button",43),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td",44),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(),l=e.sdS(46);return e.Njj(s.openModalClient(n,l,"lg"))}),e.j41(6,"bdi",45),e.EFF(7),e.k0s()(),e.j41(8,"td")(9,"span",46),e.EFF(10),e.k0s(),e.EFF(11),e.nI1(12,"date"),e.k0s(),e.j41(13,"td")(14,"span"),e.nrm(15,"span",47),e.k0s()(),e.j41(16,"td",44),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(),l=e.sdS(50);return e.Njj(s.openModal(n.clientId,l,"md"))}),e.j41(17,"a",48),e.EFF(18),e.k0s()(),e.j41(19,"td"),e.EFF(20),e.k0s(),e.j41(21,"td"),e.EFF(22),e.nI1(23,"date"),e.k0s(),e.j41(24,"td"),e.EFF(25),e.k0s(),e.j41(26,"td"),e.EFF(27),e.k0s(),e.j41(28,"td"),e.EFF(29),e.k0s(),e.j41(30,"td"),e.nrm(31,"i",49),e.DNE(32,An,3,0,"button",50),e.k0s()()}if(2&r){const t=o.$implicit,i=o.rowIndex,n=o.expanded,s=e.XpG();e.R7$(2),e.Y8G("pRowToggler",t)("ngClass",n?" ri-arrow-down-s-line":"  ri-arrow-up-s-line"),e.R7$(2),e.JRh(i+1),e.R7$(3),e.SpI("#SO#",t.id,""),e.R7$(3),e.SpI("",t.creatorName," "),e.R7$(),e.SpI(" ",e.i5U(12,17,t.creationTime,"yyyy-MM-dd")," "),e.R7$(3),e.ZvI("badge ",s.getStatus(t),""),e.R7$(),e.FS9("translate","sales.salesOrder."+t.offerOrderStatusValue),e.R7$(3),e.SpI(" ",t.clientName," "),e.R7$(2),e.JRh(t.salsePersonName),e.R7$(2),e.SpI(" ",e.i5U(23,20,t.clientVisitDate,"yyyy-MM-dd"),""),e.R7$(3),e.JRh(t.totalQuantity),e.R7$(2),e.JRh(t.totalDiscount),e.R7$(2),e.JRh(t.netPrice),e.R7$(3),e.Y8G("hasPermission",e.lJ4(23,Yn))}}function qn(r,o){if(1&r&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td"),e.EFF(10),e.nI1(11,"translate"),e.k0s(),e.j41(12,"td"),e.EFF(13),e.k0s(),e.j41(14,"td"),e.EFF(15),e.k0s()()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t.itemName),e.R7$(2),e.JRh(t.unitName),e.R7$(2),e.JRh(t.clientQuantity),e.R7$(2),e.JRh(t.approvedQuantity),e.R7$(2),e.SpI("",e.bMT(11,7,"sales.salesOrder."+t.discountTypeValue)," "),e.R7$(3),e.JRh(t.discount),e.R7$(2),e.JRh(t.price)}}function zn(r,o){if(1&r&&(e.j41(0,"tr")(1,"td",54)(2,"div")(3,"table",55)(4,"thead")(5,"tr",56),e.nrm(6,"th",57)(7,"th",58)(8,"th",59)(9,"th",60)(10,"th",61)(11,"th",62)(12,"th",63),e.k0s()(),e.j41(13,"tbody"),e.DNE(14,qn,16,9,"tr",64),e.k0s()()()()()),2&r){const t=o.$implicit;e.R7$(14),e.Y8G("ngForOf",t.offerOrderDetails)}}function Hn(r,o){1&r&&(e.j41(0,"div",65),e.EFF(1," general.table.noData "),e.k0s())}function Jn(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",66)(1,"div",67),e.nrm(2,"ngb-pagination-info",68),e.j41(3,"table-length",69),e.bIt("lengthChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",70)(5,"ngb-pagination",71),e.bIt("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.pagination.pageNumber,n)||(s.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function Kn(r,o){if(1&r){const t=e.RV6();e.j41(0,"delete-modal",72),e.bIt("deleteConfirm",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.DeleteConfirm())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}}function Zn(r,o){if(1&r){const t=e.RV6();e.j41(0,"app-all-orders-details",73),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderDetails",t.orderSelected)}}function Wn(r,o){if(1&r){const t=e.RV6();e.j41(0,"sales-edit-order",74),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderSelected",t.operationId)}}function ei(r,o){if(1&r){const t=e.RV6();e.j41(0,"client-summary",75),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("clientId",t.operationId)}}let ti=(()=>{class r extends Y.w{constructor(t,i,n,s,l,a,f,M,R,O,w,k,v,j){super(t,i,f,n,s,l,a),this.baseService=n,this.authDaamService=M,this.teamService=R,this.employeeService=O,this.regionService=w,this.cityService=k,this.excelService=v,this.router=j,this.title="orderManagement.order.title",this.titleOperation="orderManagement.order.titleOperation",this.keySelected="",this.searchForm={},this.isResolveList=!0,this.employeeGroups=[],this.activeindex="2",this.active=2,this.clientSelected=0,this.status=[],this.countLoad=2,this.isOrderEdit=!1,this.orderSelected={},this.users=[],this.statusCount={},this.salesPersons=[],this.regions=[],this.cities=[],this.setDates=(b,h,G)=>{if(b?.from||b?.to){const L=b.to||b.from;this.pagination[h]=this.datePipe.transform(b.from||b.to,"yyyy-MM-ddT00:00:00"),this.pagination[G]=this.datePipe.transform(L,"yyyy-MM-ddT23:59:59.999")}else this.pagination[h]=null,this.pagination[G]=null},this.configRoute(),this.GetSalesPersons(),this.GetRegions(),this.GetCities()}GetRegions(){this.regionService.getDropDown().subscribe(t=>{this.regions=t.data},t=>{console.log(t)})}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetSalesPersons(){this.employeeService.GetAllByType(9).subscribe(t=>{this.salesPersons=t.data},t=>{console.log(t)})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,p.Q)(this.notifier)).subscribe(i=>{i?this.alertService.success():this.alertService.error("general.message."+i)},i=>{this.alertService.error()})}mapRegisterForm(t){let i={...t};return i.employeeCode=0,i}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader("allLoader"),this.setDates(t.dates,"visitDateFrom","visitDateTo"),this.setDates(t.creationDates,"creationTimeFrom","creationTimeTo"),this.loadentities()}LoadSuccess(){this.ngxLoader.stopLoader("allLoader")}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems},this.loadentities()}configRoute(){this.routerActive.data.pipe((0,p.Q)(this.notifier)).subscribe(t=>{this.entities=t.data,this.pagination.totalItems=t.data?.totalItems},()=>{this.alertService.error()})}mapExcel(){let t=[];return this.entities.forEach(i=>{t.push({Code:i.id,CreatorName:i.creatorName,creationTime:i.creationTime,clientName:i.clientName,Status:this.getTranslationText("sales.salesOrder."+i.offerOrderStatusValue),salse_Person:i.salsePersonName,"Delivery.Date":i.acutalVisitDate,"T.Quantity":i.totalQuantity," T.Discount":i.totalDiscount,Tax:i.totalTax,Net:i.netPrice,Reason:i.cancelReasonName})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}getStatus(t){return 10==t.offerOrderStatus||20==t.offerOrderStatus?"bg-warning-subtle text-warning":30==t.offerOrderStatus?"bg-success-subtle text-success":40==t.offerOrderStatus?"bg-danger-subtle text-danger":50==t.offerOrderStatus?"bg-danger-success text-success":"bg-warning-subtle text-warning"}checkEdit(t){return!t.isCancel&&!t.isFinish}getTrnslate(t){return t.isCancel?"orderManagement.order.cancel":t.isFinish?"orderManagement.order.finish":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen?"orderManagement.order.reopen":t.isAssign?"orderManagement.order.assign":t.isConfirmed?"orderManagement.order.confirmed":t.isFree?"orderManagement.order.free":"orderManagement.order.new"}openModalClient(t,i,n="xl"){this.clientSelected=t.orderCode,this.orderSelected=t,this.isOrderEdit=!1,this.modalService.open(i,{centered:!0,size:n})}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}goNew(){this.router.navigateByUrl("/sales/new")}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(y.nX),e.rXU(u.c$),e.rXU(P),e.rXU(V.u),e.rXU(m.vh),e.rXU(C.eD),e.rXU(_.Bq),e.rXU(ee.J),e.rXU(ge.n),e.rXU(Z.O),e.rXU(re.S),e.rXU(K.h),e.rXU(H.V),e.rXU(y.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-all-sales-order"]],features:[e.Vt3],decls:51,vars:51,consts:[["tableMaster",""],["deleteModal",""],["orderViewModel",""],["SalesEditModel",""],["ClientInfo",""],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"addNew","reset","search","exportXlsx","addPermission","showAdd","showExport","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","id","name","id",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],["InputTirmFilter","","type","search","id","clientName","name","clientName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["name","regionId","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],["name","cityId","bindValue","code","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],[2,"width",".2%"],["translate","",2,"width",".5%"],["pSortableColumn","id","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["pSortableColumn","creationTime","translate","",2,"width","12%"],["pSortableColumn","status","translate","",2,"width","6%"],["pSortableColumn","clientId","translate","",2,"width","10%"],["translate","",2,"width","8%"],["pSortableColumn","clientVisitDate","translate","",2,"width","10%"],["pSortableColumn","totalQuantity","translate","",2,"width","8%"],["pSortableColumn","totalDiscount","translate","",2,"width","8%"],["pSortableColumn","netPrice","translate","",2,"width","8%"],["translate","",2,"width","10%"],[1,"fs-5"],["type","button","pRipple","",1,"border-0","p-button-text","p-button-rounded","p-button-plain",3,"pRowToggler","ngClass"],[3,"click"],[1,"code-pointer"],[1,"badge","bg-success-subtle","text-success"],[3,"translate"],["href","javascript:void(0)",1,"link-primary","link-offset-2","text-decoration-underline","link-underline-opacity-25","link-underline-opacity-100-hover"],[1,"ri-history-fill","d-inline","text-primary","fs-16","align-middle","me-1"],["type","button","class","btn px-4 w-auto btn-sm btn-primary btn-label  waves-effect waves-light rounded-pill",3,"click",4,"hasPermission"],["type","button",1,"btn","px-4","w-auto","btn-sm","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"click"],[1,"ri-edit-2-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.edit"],["colspan","17"],["dataKey","id"],[1,"bg-light"],["translate","sales.salesOrder.itemName",2,"width","10%"],["translate","sales.salesOrder.unit",2,"width","6%"],["translate","sales.salesOrder.clientQuantity",2,"width","8%"],["translate","sales.salesOrder.approvedQuantity",2,"width","8%"],["translate","sales.salesOrder.discountType",2,"width","5%"],["translate","sales.salesOrder.discount",2,"width","5%"],["translate","sales.salesOrder.price",2,"width","5%"],[4,"ngFor","ngForOf"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"deleteConfirm","dismiss"],[3,"dismiss","orderDetails"],[3,"dismiss","orderSelected"],[3,"dismiss","clientId"]],template:function(i,n){if(1&i){const s=e.RV6();e.j41(0,"div",5)(1,"div",6)(2,"div",7),e.nrm(3,"ngx-ui-loader",8),e.j41(4,"base-filter",9),e.bIt("addNew",function(){return e.eBV(s),e.Njj(n.goNew())})("reset",function(){return e.eBV(s),e.Njj(n.onReset())})("search",function(){return e.eBV(s),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(s),e.Njj(n.onExportXlsx())}),e.qex(5,10),e.j41(6,"div",11)(7,"div",12)(8,"input",13),e.nI1(9,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.id,a)||(n.pagination.id=a),e.Njj(a)}),e.k0s(),e.nrm(10,"i",14),e.k0s()(),e.j41(11,"div",11)(12,"input",15),e.nI1(13,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.searchForm.creationDates,a)||(n.searchForm.creationDates=a),e.Njj(a)}),e.k0s()(),e.j41(14,"div",11)(15,"div",12)(16,"input",16),e.nI1(17,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.clientName,a)||(n.pagination.clientName=a),e.Njj(a)}),e.k0s(),e.nrm(18,"i",14),e.k0s()(),e.j41(19,"div",11)(20,"div",12)(21,"ng-select",17),e.nI1(22,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.salesPersonId,a)||(n.pagination.salesPersonId=a),e.Njj(a)}),e.k0s()()(),e.j41(23,"div",11)(24,"input",15),e.nI1(25,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.searchForm.dates,a)||(n.searchForm.dates=a),e.Njj(a)}),e.k0s()(),e.j41(26,"div",11)(27,"div",12)(28,"ng-select",18),e.nI1(29,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.regionId,a)||(n.pagination.regionId=a),e.Njj(a)}),e.k0s()()(),e.j41(30,"div",11)(31,"div",12)(32,"ng-select",19),e.nI1(33,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.cityId,a)||(n.pagination.cityId=a),e.Njj(a)}),e.k0s()()(),e.bVm(),e.k0s(),e.j41(34,"div",20)(35,"div",21)(36,"p-table",22,0),e.bIt("onLazyLoad",function(a){return e.eBV(s),e.Njj(n.tableChange(a))})("selectionChange",function(a){return e.eBV(s),e.Njj(n.onSelectionChange(a))}),e.DNE(38,Un,30,0,"ng-template",23)(39,Qn,33,24,"ng-template",24)(40,zn,15,1,"ng-template",25),e.k0s()(),e.DNE(41,Hn,2,0,"div",26)(42,Jn,6,8,"div",27),e.k0s()()()(),e.DNE(43,Kn,1,0,"ng-template",null,1,e.C5r)(45,Zn,1,1,"ng-template",null,2,e.C5r)(47,Wn,1,1,"ng-template",null,3,e.C5r)(49,ei,1,1,"ng-template",null,4,e.C5r)}2&i&&(e.R7$(3),e.Y8G("loaderId","allLoader"),e.R7$(),e.Y8G("addPermission",e.lJ4(50,Pn))("showAdd",!0)("showExport",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(9,36,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.id),e.R7$(4),e.FS9("placeholder",e.bMT(13,38,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(4),e.FS9("placeholder",e.bMT(17,40,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.clientName),e.R7$(5),e.FS9("placeholder",e.bMT(22,42,"sales.salesOrder.salsePerson")),e.Y8G("items",n.salesPersons)("multiple",!1),e.R50("ngModel",n.pagination.salesPersonId),e.R7$(3),e.FS9("placeholder",e.bMT(25,44,"sales.salesOrder.clientVisitDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.dates),e.R7$(4),e.FS9("placeholder",e.bMT(29,46,"client.client.regionName")),e.Y8G("items",n.regions)("multiple",!1),e.R50("ngModel",n.pagination.regionId),e.R7$(4),e.FS9("placeholder",e.bMT(33,48,"client.client.cityName")),e.Y8G("items",n.cities)("multiple",!1),e.R50("ngModel",n.pagination.cityId),e.R7$(4),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(5),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[m.YU,m.Sq,m.bT,d.me,d.Q0,d.BC,d.vS,_.s5,D.kL,A.b,te.w,Q.p,q.g,ue,u.Mm,S.XI,z.Ei,S.Tg,S.FP,C.Cv,E.vr,X.m,U.p,fe,m.vh,u.D9],encapsulation:2})}}return r})(),Se=(()=>{class r extends ce.d{getTrunckStatus(){return[{id:20,name:"ArriveStore"},{id:30,name:"GoClient"},{id:50,name:"DeliveryClient"}]}constructor(t){super(t,J.c.apiUrl+"OrderReceived/")}GetOrderAssignTrunk(t){return this.http.post(this.baseUrl+"OrderAssignTrunk",t)}changeStatus(t){return this.http.post(this.baseUrl+"changeStatus",t)}PrintOrderReceived(t){return this.http.get(this.baseUrl+"PrintOrderReceived/"+t,{responseType:"blob"})}static{this.\u0275fac=function(i){return new(i||r)(e.KVO(me.Qq))}}static{this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var ni=c(91020);let _e=(()=>{class r{constructor(t,i,n,s){this.cancelReasonService=t,this.orderService=i,this.ngxLoader=n,this.alertService=s,this.cancelReasons=[],this.form={},this.orderId=0,this.loaderOperationShap=g.$$,this.operationLoader=g.ZW,this.notifier=new se.B,this.success=new e.bkB,this.dismiss=new e.bkB}ngOnInit(){this.GetReturnReasons()}GetReturnReasons(){this.cancelReasonService.getDropDown().subscribe(t=>{this.cancelReasons=t.data},t=>{console.log(t)})}onCancelOrder(){let t={cancelReasonId:this.form.cancelReasonCode,id:this.orderId};this.ngxLoader.startLoader(this.operationLoader),this.orderService.CancelOfferOrder(t).pipe((0,p.Q)(this.notifier)).subscribe(i=>{this.ngxLoader.stopLoader(this.operationLoader),i.success?(this.alertService.success(),this.success.emit(!0),this.dismiss.emit(!0)):this.alertService.error()},()=>{this.alertService.error(),this.ngxLoader.stopLoader(this.operationLoader)})}dismissFn(){this.dismiss.emit(!0)}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(ni.e),e.rXU(P),e.rXU(C.eD),e.rXU(V.u))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["cancel-sales-model"]],inputs:{orderId:"orderId"},outputs:{success:"success",dismiss:"dismiss"},decls:19,vars:10,consts:[["formEntity","ngForm"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["translate","orderManagement.order.cancelReasonName",1,"fw-bold","fs-4"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"hasProgressBar","fgsType","loaderId"],[3,"ngSubmit"],[1,"row"],[1,"mb-3"],["for","actionMismatch","translate","",1,"required","fw-bold","form-label"],["name","name","bindValue","code","bindLabel","name","required","",3,"ngModelChange","placeholder","items","multiple","ngModel"],[1,"text-center"],["type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"]],template:function(i,n){if(1&i){const s=e.RV6();e.j41(0,"div",1)(1,"div",2)(2,"h4",3),e.nrm(3,"span",4),e.k0s(),e.j41(4,"button",5),e.bIt("click",function(){return e.eBV(s),e.Njj(n.dismissFn())}),e.k0s()(),e.j41(5,"div",6),e.nrm(6,"ngx-ui-loader",7),e.j41(7,"form",8,0),e.bIt("ngSubmit",function(){return e.eBV(s),e.Njj(n.onCancelOrder())}),e.j41(9,"div",9)(10,"div",10)(11,"label",11),e.EFF(12,"orderManagement.order.cancelReasonName"),e.k0s(),e.j41(13,"ng-select",12),e.nI1(14,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.form.cancelReasonCode,a)||(n.form.cancelReasonCode=a),e.Njj(a)}),e.k0s()()(),e.j41(15,"div",13)(16,"button",14),e.nrm(17,"i",15)(18,"span",16),e.k0s()()()()()}if(2&i){const s=e.sdS(8);e.R7$(6),e.Y8G("hasProgressBar",!1)("fgsType",n.loaderOperationShap)("loaderId",n.operationLoader),e.R7$(7),e.FS9("placeholder",e.bMT(14,8,"orderManagement.order.cancelReasonName")),e.Y8G("items",n.cancelReasons)("multiple",!1),e.R50("ngModel",n.form.cancelReasonCode),e.R7$(3),e.Y8G("disabled",!s.valid)}},dependencies:[d.qT,d.BC,d.cb,d.YS,d.vS,d.cV,u.Mm,C.Cv,E.vr,u.D9],encapsulation:2})}}return r})();const ii=()=>["salesOrder.register"],ri=()=>["shippingOrder.completeOrder"],si=()=>["shippingOrder.printItem"],ai=()=>["shippingOrder.sureOrder"],oi=()=>["shippingOrder.cancel"];function li(r,o){1&r&&(e.j41(0,"tr",29),e.nrm(1,"th",30),e.j41(2,"th",31),e.EFF(3,"#"),e.k0s(),e.j41(4,"th",32),e.nrm(5,"i",33),e.EFF(6," orderManagement.order.orderCode "),e.k0s(),e.j41(7,"th",34),e.nrm(8,"i",33),e.EFF(9," orderManagement.order.creation "),e.k0s(),e.j41(10,"th",35),e.nrm(11,"i",33),e.EFF(12," orderManagement.order.agentName "),e.k0s(),e.j41(13,"th",36),e.nrm(14,"i",33),e.EFF(15," sales.salesOrder.clientVisitDate "),e.k0s(),e.j41(16,"th",37),e.EFF(17," sales.salesOrder.salsePerson "),e.k0s(),e.j41(18,"th",38),e.nrm(19,"i",33),e.EFF(20," sales.salesOrder.shippingTruckName "),e.k0s(),e.j41(21,"th",37),e.EFF(22," sales.salesOrder.totalQuantity "),e.k0s(),e.j41(23,"th",39),e.EFF(24," sales.salesOrder.clientLocationName "),e.k0s(),e.nrm(25,"th",40),e.k0s())}function di(r,o){1&r&&e.nrm(0,"span",49)}function ci(r,o){if(1&r&&(e.j41(0,"a",50),e.nrm(1,"i",51),e.k0s()),2&r){const t=e.XpG().$implicit,i=e.XpG();e.Y8G("href",i.mapUrl(null==t?null:t.lng,null==t?null:t.lat),e.B4B)}}function mi(r,o){1&r&&(e.j41(0,"td")(1,"button",52),e.nI1(2,"translate"),e.nrm(3,"i",53),e.k0s(),e.j41(4,"button",54),e.nI1(5,"translate"),e.nrm(6,"i",55),e.k0s()()),2&r&&(e.R7$(),e.FS9("pTooltip",e.bMT(2,2,"orderManagement.order.changeTeamStatus")),e.R7$(3),e.FS9("pTooltip",e.bMT(5,4,"orderManagement.order.finishOrder")))}function pi(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",63),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2).$implicit,s=e.XpG(),l=e.sdS(50);return e.Njj(s.openStatusModal(n.id,l,60,"md"))}),e.nrm(2,"i",64),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"sales.salesOrder.finihedOrder"))}function gi(r,o){if(1&r){const t=e.RV6();e.j41(0,"li",65),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2).$implicit,s=e.XpG();return e.Njj(s.PrintOrderReceived(n.id))}),e.j41(1,"span",66),e.nrm(2,"i",67)(3,"span",68),e.k0s()()}}function _i(r,o){if(1&r){const t=e.RV6();e.j41(0,"li",65),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2).$implicit,s=e.XpG(),l=e.sdS(50);return e.Njj(s.openStatusModal(n.id,l,40,"md"))}),e.j41(1,"span",66),e.nrm(2,"i",69)(3,"span",70),e.k0s()()}}function ui(r,o){if(1&r){const t=e.RV6();e.j41(0,"li",65),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2).$implicit,s=e.XpG(),l=e.sdS(46);return e.Njj(s.openModal(n.id,l))}),e.j41(1,"span",66),e.nrm(2,"i",71)(3,"span",72),e.k0s()()}}function hi(r,o){1&r&&(e.j41(0,"td")(1,"div",56),e.DNE(2,pi,3,3,"button",57),e.j41(3,"span",56)(4,"div",58)(5,"button",59),e.nrm(6,"i",60),e.k0s(),e.j41(7,"ul",61),e.DNE(8,gi,4,0,"li",62)(9,_i,4,0,"li",62)(10,ui,4,0,"li",62),e.k0s()()()()()),2&r&&(e.R7$(2),e.Y8G("hasPermission",e.lJ4(4,ri)),e.R7$(6),e.Y8G("hasPermission",e.lJ4(5,si)),e.R7$(),e.Y8G("hasPermission",e.lJ4(6,ai)),e.R7$(),e.Y8G("hasPermission",e.lJ4(7,oi)))}function fi(r,o){if(1&r&&(e.j41(0,"tr",41)(1,"td"),e.nrm(2,"button",42),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td")(6,"bdi",43),e.EFF(7),e.k0s()(),e.j41(8,"td")(9,"span",44),e.EFF(10),e.k0s(),e.EFF(11),e.nI1(12,"date"),e.k0s(),e.j41(13,"td")(14,"span",45),e.EFF(15),e.k0s()(),e.j41(16,"td"),e.EFF(17),e.nI1(18,"date"),e.k0s(),e.j41(19,"td"),e.EFF(20),e.k0s(),e.j41(21,"td"),e.EFF(22),e.k0s(),e.j41(23,"td"),e.EFF(24),e.k0s(),e.j41(25,"td"),e.DNE(26,di,1,0,"span",46)(27,ci,2,1,"a",47),e.k0s(),e.DNE(28,mi,7,6,"td",48)(29,hi,11,8,"td",48),e.k0s()),2&r){const t=o.$implicit,i=o.rowIndex,n=o.expanded,s=e.XpG();e.R7$(2),e.Y8G("pRowToggler",t)("ngClass",n?" ri-arrow-down-s-line":"  ri-arrow-up-s-line"),e.R7$(2),e.JRh(i+1),e.R7$(3),e.SpI("#SO#",t.offerOrderMasterId,""),e.R7$(3),e.SpI("",t.creatorName," "),e.R7$(),e.SpI(" ",e.i5U(12,15,t.creationTime,"yyyy-MM-dd HH:mm")," "),e.R7$(4),e.SpI("",t.clientName," "),e.R7$(2),e.SpI(" ",e.i5U(18,18,t.deliveryDate,"yyyy-MM-dd HH:mm"),""),e.R7$(3),e.JRh(t.salsePersonName),e.R7$(2),e.JRh(t.shippingTruckName),e.R7$(2),e.JRh(t.totalQuantity),e.R7$(2),e.Y8G("ngIf",""==t.lng),e.R7$(),e.Y8G("ngIf",null==t?null:t.lng),e.R7$(),e.Y8G("ngIf",s.isTrunck),e.R7$(),e.Y8G("ngIf",!s.isTrunck)}}function bi(r,o){1&r&&(e.j41(0,"tr"),e.nrm(1,"th",77)(2,"th",78)(3,"th",79)(4,"th",80),e.k0s())}function Ci(r,o){if(1&r&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td")(8,"span"),e.EFF(9),e.k0s()()()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t.itemName),e.R7$(2),e.JRh(t.unitName),e.R7$(2),e.JRh(t.clientQuantity),e.R7$(3),e.JRh(t.approvedQuantity)}}function Si(r,o){1&r&&(e.j41(0,"tr"),e.nrm(1,"td",81),e.k0s())}function vi(r,o){if(1&r&&(e.j41(0,"tr")(1,"td",73)(2,"div",74)(3,"p-table",75),e.DNE(4,bi,5,0,"ng-template",24)(5,Ci,10,4,"ng-template",25)(6,Si,2,0,"ng-template",76),e.k0s()()()()),2&r){const t=o.$implicit;e.R7$(3),e.Y8G("value",t.details)}}function ji(r,o){1&r&&(e.j41(0,"div",82),e.EFF(1," general.table.noData "),e.k0s())}function Ii(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",83)(1,"div",84),e.nrm(2,"ngb-pagination-info",85),e.j41(3,"table-length",86),e.bIt("lengthChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",87)(5,"ngb-pagination",88),e.bIt("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.pagination.pageNumber,n)||(s.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function yi(r,o){if(1&r){const t=e.RV6();e.j41(0,"form",89,5),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.cancelOrder())}),e.nrm(2,"ngx-ui-loader",90),e.j41(3,"div",91)(4,"div",92)(5,"button",93),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"div",94)(7,"div",95),e.nrm(8,"lord-icon",96),e.j41(9,"div",97),e.nrm(10,"h3",98)(11,"p",99),e.k0s()(),e.j41(12,"div",100),e.nrm(13,"button",101),e.j41(14,"button",102),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}function ki(r,o){if(1&r){const t=e.RV6();e.j41(0,"cancel-sales-model",103),e.bIt("success",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.reload())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderId",t.orderSelected)}}function Ti(r,o){if(1&r){const t=e.RV6();e.j41(0,"order-timeline",104),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderSelected",t.orderSelected)}}function xi(r,o){if(1&r){const t=e.RV6();e.j41(0,"form",89,5),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.SubmitOrder())}),e.nrm(2,"ngx-ui-loader",90),e.j41(3,"div",91)(4,"div",92)(5,"button",93),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"div",94)(7,"div",95),e.nrm(8,"lord-icon",96),e.j41(9,"div",97),e.nrm(10,"h3",98)(11,"p",99),e.k0s()(),e.j41(12,"div",100),e.nrm(13,"button",101),e.j41(14,"button",102),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}let Mi=(()=>{class r extends Y.w{constructor(t,i,n,s,l,a,f,M,R,O,w,k,v,j){super(t,i,M,n,l,a,f),this.baseService=n,this.offerOrderService=s,this.authDaamService=R,this.employeeService=O,this.regionService=w,this.cityService=k,this.router=v,this.excelService=j,this.title="sales.salesOrder.assignOrder",this.titleOperation="sales.salesOrder.assignOrder",this.keySelected="",this.employees=[],this.searchForm={},this.roles=[],this.userTypes=[],this.clientSelected=0,this.status=[],this.countLoad=2,this.isOrderEdit=!1,this.orderSelected={},this.users=[],this.truncks=[],this.isTrunck=!1,this.salesPersons=[],this.regions=[],this.cities=[],this.setDates=(b,h,G)=>{if(b?.from||b?.to){const L=b.to||b.from;this.pagination[h]=this.datePipe.transform(b.from||b.to,"yyyy-MM-ddT00:00:00"),this.pagination[G]=this.datePipe.transform(L,"yyyy-MM-ddT23:59:59.999")}else this.pagination[h]=null,this.pagination[G]=null},this.loadentities(),this.GetRegions(),this.GetCities()}GetRegions(){this.regionService.getDropDown().subscribe(t=>{this.regions=t.data},t=>{console.log(t)})}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetSalesPersons(){this.employeeService.GetAllByType(9).subscribe(t=>{this.salesPersons=t.data},t=>{console.log(t)})}loadentities(){this.countLoad=this.countLoad+1,(!this.isResolveList||1!==this.countLoad)&&(this.pagination.status=50,this.baseService.get(this.pagination).pipe((0,p.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader(g.a7),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader(g.a7),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}openModal(t,i,n="md"){this.isOrderEdit=!1,this.form={},this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}SubmitOrder(){}cancelOrder(){}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,p.Q)(this.notifier)).subscribe(i=>{i?this.alertService.success():this.alertService.error("general.message."+i)},i=>{this.alertService.error()})}mapRegisterForm(t){let i={...t};return i.employeeCode=0,i}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader("allLoader"),this.setDates(t.dates,"visitDateFrom","visitDateTo"),this.setDates(t.creationDates,"creationTimeFrom","creationTimeTo"),this.loadentities()}LoadSuccess(){this.ngxLoader.stopLoader("allLoader")}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems}}configRoute(){this.routerActive.data.pipe((0,p.Q)(this.notifier)).subscribe(t=>{this.entities=t.data,this.pagination.totalItems=t.data?.totalItems},()=>{this.alertService.error()})}mapExcel(){let t=[];return this.entities.forEach(i=>{t.push({"Order Code":i.orderCode,"Created Date":i.createdDate,"City Name":i.cityName,"District Name":i.districtName?i.districtName:"--","Agent Name":i.agentName,Mobile:i.mobile,"Channel Name":i.channelName,"Assigned To":i.teamNames,Times:i.workTimes,"Visit Date":i.visitDate,Services:i.services})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}checkEdit(t){return!t.isCancel&&!t.isFinish}openStatusModal(t,i,n,s="md"){this.isEditForm=!1,this.form={},this.form={id:t,status:n},this.modalService.open(i,{centered:!0,size:s})}openModalClient(t,i,n="xl"){this.clientSelected=t.orderCode,this.form=t,this.isOrderEdit=!1,this.modalService.open(i,{centered:!0,size:n})}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}openEditOrderModal(t,i,n="md"){this.form={},this.isOrderEdit=!0,this.clientSelected=t,this.modalService.open(i,{centered:!0,size:n})}OpenOrderTimeLineModel(t,i,n="md"){this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}mapUrl(t,i){return null===t||null==i?"":`https://www.google.com/maps/dir//${i},${t}/@${i},${t},17z?hl=en-US`}PrintOrderReceived(t){this.ngxLoader.startLoader("assignLoader"),this.baseService.PrintOrderReceived(t).pipe((0,T.O)(),(0,N.c)(100),(0,x.Z)(),(0,p.Q)(this.notifier),(0,I.j)(()=>this.ngxLoader.stopLoader("assignLoader"))).subscribe(i=>{this.openUrl(i)},i=>{this.alertService.error("general.message."+i)})}openUrl(t){let i=new Blob([t],{type:t.type});var n=URL.createObjectURL(i);window.open(n,"_blank")}reload(){this.offerOrderService.GetOrderCountSource.next(!0),this.loadentities()}goNew(){this.router.navigateByUrl("/sales/new")}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(y.nX),e.rXU(u.c$),e.rXU(Se),e.rXU(P),e.rXU(V.u),e.rXU(m.vh),e.rXU(C.eD),e.rXU(_.Bq),e.rXU(ee.J),e.rXU(Z.O),e.rXU(re.S),e.rXU(K.h),e.rXU(y.Ix),e.rXU(H.V))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["assign-order"]],inputs:{isTrunck:"isTrunck"},features:[e.Vt3],decls:51,vars:51,consts:[["tableMaster",""],["cancelOrderModal",""],["deleteModal",""],["OrderTimeLineModel",""],["StatusOrderModal",""],["formEntity","ngForm"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"addNew","reset","search","exportXlsx","addPermission","showAdd","showExport","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","id","name","id",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],["InputTirmFilter","","type","search","id","clientName","name","clientName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["name","regionId","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],["name","cityId","bindValue","code","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],[2,"width",".2%"],["translate","",2,"width",".5%"],["pSortableColumn","offerOrderMasterId","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["pSortableColumn","creationTime","translate","",2,"width","12%"],["pSortableColumn","clientId","translate","",2,"width","10%"],["pSortableColumn","clientVisitDate","translate","",2,"width","12%"],["translate","",2,"width","8%"],["pSortableColumn","shippingTruckName","translate","",2,"width","8%"],["translate","",2,"width","6%"],["translate","",2,"width","10%"],[1,"fs-5"],["type","button","pRipple","",1,"border-0","p-button-text","p-button-rounded","p-button-plain",3,"pRowToggler","ngClass"],[1,"code-pointer"],[1,"badge","bg-success-subtle","text-success"],[1,"badge","bg-primary-subtle","text-primary","my-1"],["class","badge bg-danger-subtle text-danger mx-1","translate","orderManagement.order.noMap",4,"ngIf"],["target","_blank","class","badge bg-success-subtle text-success mx-1","translate","orderManagement.order.viewMap",3,"href",4,"ngIf"],[4,"ngIf"],["translate","orderManagement.order.noMap",1,"badge","bg-danger-subtle","text-danger","mx-1"],["target","_blank","translate","orderManagement.order.viewMap",1,"badge","bg-success-subtle","text-success","mx-1",3,"href"],[1,"ri-map-pin-line"],["tooltipPosition","top",1,"btn","btn-sm","btn-warning","edit-list","mx-1",3,"pTooltip"],[1,"ri-swap-line","align-bottom"],["tooltipPosition","top",1,"btn","btn-sm","btn-success","edit-list","mx-1",3,"pTooltip"],[1,"ri-checkbox-circle-fill","align-bottom"],[1,"d-inline-block"],["class","btn btn-sm btn-primary edit-list mx-1","tooltipPosition","top",3,"pTooltip","click",4,"hasPermission"],[1,"dropdown-custom","d-inline-block"],["type","button",1,"btn","dropbtn","btn-soft-secondary","btn-sm","dropdown-custom","arrow-none"],[1,"ri-more-fill"],[1,"dropdown-menu","dropdown-menu-end","dropdown-content",2,"left","0"],[3,"click",4,"hasPermission"],["tooltipPosition","top",1,"btn","btn-sm","btn-primary","edit-list","mx-1",3,"click","pTooltip"],[1,"ri-checkbox-fill","align-bottom"],[3,"click"],[1,"dropdown-item"],[1,"text-primary","ri-printer-line","align-bottom","me-2"],["translate","sales.salesOrder.printBillOfLading"],[1,"text-warning","ri-skip-back-fill","align-bottom","me-2"],["translate","sales.salesOrder.sureOrder"],[1,"text-danger","ri-close-fill","align-bottom","me-2"],["translate","general.action.cancel"],["colspan","17"],[1,"table-detail"],["dataKey","id",3,"value"],["pTemplate","emptymessage"],["translate","sales.salesOrder.itemName",2,"width","10%"],["translate","sales.salesOrder.unit",2,"width","6%"],["translate","sales.salesOrder.clientQuantity",2,"width","8%"],["translate","sales.salesOrder.approvedQuantity",2,"width","8%"],["colspan","8"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"ngSubmit"],[3,"hasProgressBar","fgsType","loaderId"],[1,"modal-content"],[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mt-2","text-center"],["src","https://cdn.lordicon.com/gdfrsvpt.json","stroke","bold","state","hover-oscillate","trigger","loop","colors","primary:#f7b84b,secondary:#f06548",2,"width","130px","height","130px"],[1,"pt-2","fs-15","mx-4","mx-sm-5"],["translate","orderManagement.order.AreYouSureMessage"],[1,"text-muted","mx-4","mb-0"],[1,"d-flex","gap-2","justify-content-center","mt-4","mb-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],[3,"success","dismiss","orderId"],[3,"dismiss","orderSelected"]],template:function(i,n){if(1&i){const s=e.RV6();e.j41(0,"div",6)(1,"div",7)(2,"div",8),e.nrm(3,"ngx-ui-loader",9),e.j41(4,"base-filter",10),e.bIt("addNew",function(){return e.eBV(s),e.Njj(n.goNew())})("reset",function(){return e.eBV(s),e.Njj(n.onReset())})("search",function(){return e.eBV(s),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(s),e.Njj(n.onExportXlsx())}),e.qex(5,11),e.j41(6,"div",12)(7,"div",13)(8,"input",14),e.nI1(9,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.id,a)||(n.pagination.id=a),e.Njj(a)}),e.k0s(),e.nrm(10,"i",15),e.k0s()(),e.j41(11,"div",12)(12,"input",16),e.nI1(13,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.searchForm.creationDates,a)||(n.searchForm.creationDates=a),e.Njj(a)}),e.k0s()(),e.j41(14,"div",12)(15,"div",13)(16,"input",17),e.nI1(17,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.clientName,a)||(n.pagination.clientName=a),e.Njj(a)}),e.k0s(),e.nrm(18,"i",15),e.k0s()(),e.j41(19,"div",12)(20,"div",13)(21,"ng-select",18),e.nI1(22,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.salesPersonId,a)||(n.pagination.salesPersonId=a),e.Njj(a)}),e.k0s()()(),e.j41(23,"div",12)(24,"input",16),e.nI1(25,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.searchForm.dates,a)||(n.searchForm.dates=a),e.Njj(a)}),e.k0s()(),e.j41(26,"div",12)(27,"div",13)(28,"ng-select",19),e.nI1(29,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.regionId,a)||(n.pagination.regionId=a),e.Njj(a)}),e.k0s()()(),e.j41(30,"div",12)(31,"div",13)(32,"ng-select",20),e.nI1(33,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.cityId,a)||(n.pagination.cityId=a),e.Njj(a)}),e.k0s()()(),e.bVm(),e.k0s(),e.j41(34,"div",21)(35,"div",22)(36,"p-table",23,0),e.bIt("onLazyLoad",function(a){return e.eBV(s),e.Njj(n.tableChange(a))})("selectionChange",function(a){return e.eBV(s),e.Njj(n.onSelectionChange(a))}),e.DNE(38,li,26,0,"ng-template",24)(39,fi,30,21,"ng-template",25)(40,vi,7,1,"ng-template",26),e.k0s()(),e.DNE(41,ji,2,0,"div",27)(42,Ii,6,8,"div",28),e.k0s()()()(),e.DNE(43,yi,15,3,"ng-template",null,1,e.C5r)(45,ki,1,1,"ng-template",null,2,e.C5r)(47,Ti,1,1,"ng-template",null,3,e.C5r)(49,xi,15,3,"ng-template",null,4,e.C5r)}2&i&&(e.R7$(3),e.Y8G("loaderId","assignLoader"),e.R7$(),e.Y8G("addPermission",e.lJ4(50,ii))("showAdd",!0)("showExport",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(9,36,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.id),e.R7$(4),e.FS9("placeholder",e.bMT(13,38,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(4),e.FS9("placeholder",e.bMT(17,40,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.clientName),e.R7$(5),e.FS9("placeholder",e.bMT(22,42,"sales.salesOrder.salsePerson")),e.Y8G("items",n.salesPersons)("multiple",!1),e.R50("ngModel",n.pagination.salesPersonId),e.R7$(3),e.FS9("placeholder",e.bMT(25,44,"sales.salesOrder.clientVisitDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.dates),e.R7$(4),e.FS9("placeholder",e.bMT(29,46,"client.client.regionName")),e.Y8G("items",n.regions)("multiple",!1),e.R50("ngModel",n.pagination.regionId),e.R7$(4),e.FS9("placeholder",e.bMT(33,48,"client.client.cityName")),e.Y8G("items",n.cities)("multiple",!1),e.R50("ngModel",n.pagination.cityId),e.R7$(4),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(5),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[m.YU,m.bT,d.qT,d.me,d.Q0,d.BC,d.cb,d.vS,d.cV,_.s5,D.kL,A.b,Q.p,q.g,u.Mm,S.XI,z.Ei,S.Tg,S.FP,C.Cv,E.vr,X.m,U.p,ie.m,_e,m.vh,u.D9],encapsulation:2})}}return r})();var Te=c(79284),Ne=c(16229),xe=c(12822);const Ri=()=>["salesOrder.register"],Oi=()=>["smApprove.sureOrder"],Fi=()=>["smApprove.salesChangeQTY"],Ni=()=>["smApprove.cancel"];function wi(r,o){1&r&&(e.j41(0,"tr",30),e.nrm(1,"th",31),e.j41(2,"th",32),e.EFF(3,"#"),e.k0s(),e.j41(4,"th",33),e.nrm(5,"i",34),e.EFF(6," orderManagement.order.orderCode "),e.k0s(),e.j41(7,"th",35),e.nrm(8,"i",34),e.EFF(9," orderManagement.order.creation "),e.k0s(),e.j41(10,"th",36),e.nrm(11,"i",34),e.EFF(12," orderManagement.order.agentName "),e.k0s(),e.j41(13,"th",37),e.EFF(14," sales.salesOrder.salsePerson "),e.k0s(),e.j41(15,"th",38),e.nrm(16,"i",34),e.EFF(17," sales.salesOrder.clientVisitDate "),e.k0s(),e.j41(18,"th",39),e.nrm(19,"i",34),e.EFF(20," sales.salesOrder.totalQuantity "),e.k0s(),e.j41(21,"th",40),e.nrm(22,"i",34),e.EFF(23," sales.salesOrder.netPrice "),e.k0s(),e.nrm(24,"th",41),e.k0s())}function Gi(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",53),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,s=e.XpG(),l=e.sdS(44);return e.Njj(s.openModal(n.id,l))}),e.nrm(2,"i",54),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"sales.salesOrder.approved"))}function Vi(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",55),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,s=e.XpG(),l=e.sdS(50);return e.Njj(s.openModal(n.id,l))}),e.nrm(2,"i",56),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"sales.salesOrder.backToSales"))}function Di(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",57),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,s=e.XpG(),l=e.sdS(46);return e.Njj(s.openModal(n.id,l))}),e.nrm(2,"i",58),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"general.action.cancel"))}function Ei(r,o){if(1&r){const t=e.RV6();e.j41(0,"tr",42)(1,"td"),e.nrm(2,"button",43),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td")(6,"bdi",44),e.EFF(7),e.k0s()(),e.j41(8,"td")(9,"span",45),e.EFF(10),e.k0s(),e.EFF(11),e.nI1(12,"date"),e.k0s(),e.j41(13,"td",46),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(),l=e.sdS(48);return e.Njj(s.openModal(n.clientId,l,"md"))}),e.j41(14,"a",47),e.EFF(15),e.k0s()(),e.j41(16,"td"),e.EFF(17),e.k0s(),e.j41(18,"td"),e.EFF(19),e.nI1(20,"date"),e.k0s(),e.j41(21,"td"),e.EFF(22),e.k0s(),e.j41(23,"td"),e.EFF(24),e.k0s(),e.j41(25,"td")(26,"div",48),e.nrm(27,"i",49),e.DNE(28,Gi,3,3,"button",50)(29,Vi,3,3,"button",51)(30,Di,3,3,"button",52),e.k0s()()()}if(2&r){const t=o.$implicit,i=o.rowIndex,n=o.expanded;e.R7$(2),e.Y8G("pRowToggler",t)("ngClass",n?" ri-arrow-down-s-line":"  ri-arrow-up-s-line"),e.R7$(2),e.JRh(i+1),e.R7$(3),e.SpI("#SO#",t.id,""),e.R7$(3),e.SpI("",t.creatorName," "),e.R7$(),e.SpI(" ",e.i5U(12,14,t.creationTime,"yyyy-MM-dd HH:mm")," "),e.R7$(4),e.SpI(" ",t.clientName," "),e.R7$(2),e.JRh(t.salsePersonName),e.R7$(2),e.SpI(" ",e.i5U(20,17,t.acutalVisitDate,"yyyy-MM-dd HH:mm"),""),e.R7$(3),e.JRh(t.totalQuantity),e.R7$(2),e.JRh(t.netPrice),e.R7$(4),e.Y8G("hasPermission",e.lJ4(20,Oi)),e.R7$(),e.Y8G("hasPermission",e.lJ4(21,Fi)),e.R7$(),e.Y8G("hasPermission",e.lJ4(22,Ni))}}function Li(r,o){1&r&&(e.j41(0,"tr"),e.nrm(1,"th",63)(2,"th",64)(3,"th",65)(4,"th",66)(5,"th",67)(6,"th",68),e.k0s())}function $i(r,o){if(1&r&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&r){const t=e.XpG().$implicit;e.R7$(),e.JRh(t.approvedQuantity)}}function Xi(r,o){if(1&r){const t=e.RV6();e.j41(0,"input",72),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG().$implicit;return e.DH7(s.approvedQuantity,n)||(s.approvedQuantity=n),e.Njj(n)}),e.k0s()}if(2&r){const t=e.XpG().$implicit;e.R50("ngModel",t.approvedQuantity)}}function Bi(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",53),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,s=e.XpG(2);return e.Njj(s.saveQuantity(n.id,n))}),e.nrm(2,"i",54),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"general.action.save"))}function Pi(r,o){if(1&r&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.DNE(8,$i,2,1,"span",69)(9,Xi,1,1,"input",70),e.k0s(),e.j41(10,"td"),e.EFF(11),e.k0s(),e.j41(12,"td"),e.DNE(13,Bi,3,3,"button",71),e.k0s()()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t.itemName),e.R7$(2),e.JRh(t.unitName),e.R7$(2),e.JRh(t.clientQuantity),e.R7$(2),e.Y8G("ngIf",!t.isEdit),e.R7$(),e.Y8G("ngIf",t.isEdit),e.R7$(2),e.JRh(t.price),e.R7$(2),e.Y8G("ngIf",t.isEdit)}}function Yi(r,o){1&r&&(e.j41(0,"tr"),e.nrm(1,"td",73),e.k0s())}function Ui(r,o){if(1&r&&(e.j41(0,"tr")(1,"td",59)(2,"div",60)(3,"p-table",61),e.DNE(4,Li,7,0,"ng-template",25)(5,Pi,14,7,"ng-template",26)(6,Yi,2,0,"ng-template",62),e.k0s()()()()),2&r){const t=o.$implicit;e.R7$(3),e.Y8G("value",t.offerOrderDetails)}}function Ai(r,o){1&r&&(e.j41(0,"div",74),e.EFF(1," general.table.noData "),e.k0s())}function Qi(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",75)(1,"div",76),e.nrm(2,"ngb-pagination-info",77),e.j41(3,"table-length",78),e.bIt("lengthChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",79)(5,"ngb-pagination",80),e.bIt("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.pagination.pageNumber,n)||(s.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function qi(r,o){if(1&r){const t=e.RV6();e.j41(0,"form",81,5),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.SubmitOrder())}),e.nrm(2,"ngx-ui-loader",82),e.j41(3,"div",83)(4,"div",84)(5,"button",85),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"div",86)(7,"div",87),e.nrm(8,"lord-icon",88),e.j41(9,"div",89),e.nrm(10,"h3",90)(11,"p",91),e.k0s()(),e.j41(12,"div",92),e.nrm(13,"button",93),e.j41(14,"button",94),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}function zi(r,o){if(1&r){const t=e.RV6();e.j41(0,"cancel-sales-model",95),e.bIt("success",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.reload())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderId",t.operationId)}}function Hi(r,o){if(1&r){const t=e.RV6();e.j41(0,"client-summary",96),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("clientId",t.operationId)}}function Ji(r,o){1&r&&(e.j41(0,"div",102),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function Ki(r,o){if(1&r){const t=e.RV6();e.j41(0,"form",81,5),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.RequestChangeQuantity())}),e.nrm(2,"ngx-ui-loader",82),e.j41(3,"div",83)(4,"div",84)(5,"button",85),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"div",86)(7,"div",97)(8,"label",98),e.EFF(9,"sales.salesOrder.changeQuantityMessage"),e.k0s(),e.j41(10,"textarea",99,6),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.changeQuantityMessage,n)||(s.form.changeQuantityMessage=n),e.Njj(n)}),e.k0s(),e.DNE(12,Ji,2,0,"div",100),e.k0s(),e.j41(13,"div",92),e.nrm(14,"button",101),e.j41(15,"button",94),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()}if(2&r){const t=e.sdS(1),i=e.sdS(11),n=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",n.loaderOperationShap)("loaderId",n.deleteLoader),e.R7$(8),e.R50("ngModel",n.form.changeQuantityMessage),e.R7$(2),e.Y8G("ngIf",i.invalid&&i.touched),e.R7$(2),e.Y8G("disabled",!t.valid)}}let Zi=(()=>{class r extends Y.w{constructor(t,i,n,s,l,a,f,M,R,O,w,k,v,j,b,h,G){super(t,i,f,n,s,l,a),this.baseService=n,this.authDaamService=M,this.teamService=R,this.workTimeService=O,this.excelService=w,this.cityService=k,this.districtService=v,this.employeeService=j,this.regionService=b,this.channelService=h,this.router=G,this.title="sales.salesOrder.newOrders",this.titleOperation="sales.salesOrder.newOrders",this.keySelected="",this.employees=[],this.searchForm={},this.isResolveList=!0,this.activeindex="2",this.active=2,this.clientSelected=0,this.status=[],this.countLoad=2,this.isOrderEdit=!1,this.orderSelected={},this.users=[],this.salesPersons=[],this.regions=[],this.cities=[],this.setDates=(F,L,W)=>{if(F?.from||F?.to){const Ee=F.to||F.from;this.pagination[L]=this.datePipe.transform(F.from||F.to,"yyyy-MM-ddT00:00:00"),this.pagination[W]=this.datePipe.transform(Ee,"yyyy-MM-ddT23:59:59.999")}else this.pagination[L]=null,this.pagination[W]=null},this.loadentities(),this.GetSalesPersons(),this.GetRegions(),this.GetCities()}GetRegions(){this.regionService.getDropDown().subscribe(t=>{this.regions=t.data},t=>{console.log(t)})}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetSalesPersons(){this.employeeService.GetAllByType(9).subscribe(t=>{this.salesPersons=t.data},t=>{console.log(t)})}loadentities(){this.countLoad=this.countLoad+1,(!this.isResolveList||1!==this.countLoad)&&(this.pagination.status=20,this.baseService.get(this.pagination).pipe((0,p.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader(g.a7),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader(g.a7),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}SubmitOrder(){this.ngxLoader.startLoader(g.Fq),console.log(this.operationId),this.baseService.changStatus({id:this.operationId,status:30}).pipe((0,T.O)(),(0,N.c)(this.mainDelay),(0,x.Z)(),(0,p.Q)(this.notifier),(0,I.j)(()=>this.ngxLoader.stopLoader(g.Fq))).subscribe({next:i=>{this.modalService.dismissAll(),this.reload(),this.alertService.success()}})}cancelOrder(){this.ngxLoader.startLoader(g.Fq),console.log(this.operationId),this.baseService.changStatus({id:this.operationId,status:40}).pipe((0,T.O)(),(0,N.c)(this.mainDelay),(0,x.Z)(),(0,p.Q)(this.notifier),(0,I.j)(()=>this.ngxLoader.stopLoader(g.Fq))).subscribe({next:i=>{this.modalService.dismissAll(),this.loadentities(),this.alertService.success()}})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,p.Q)(this.notifier)).subscribe(i=>{i?this.alertService.success():this.alertService.error("general.message."+i)},i=>{this.alertService.error()})}mapRegisterForm(t){let i={...t};return i.employeeCode=0,i}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader("allLoader"),this.setDates(t.dates,"visitDateFrom","visitDateTo"),this.setDates(t.creationDates,"creationTimeFrom","creationTimeTo"),this.loadentities()}LoadSuccess(){this.ngxLoader.stopLoader("allLoader")}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems}}mapExcel(){let t=[];return this.entities.forEach(i=>{t.push({"Order Code":i.orderCode,"Created Date":i.createdDate,"City Name":i.cityName,"District Name":i.districtName?i.districtName:"--",Status:this.translateService.instant(this.getTrnslate(i)),"Agent Name":i.agentName,Mobile:i.mobile,"Channel Name":i.channelName,"Assigned To":i.teamNames,Times:i.workTimes,"Visit Date":i.visitDate,Services:i.services})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}goRegister(){this.router.navigateByUrl("/managment/order/new")}goEdit(t){this.router.navigateByUrl("/managment/order/new")}getStatus(t){return 10==t.offerOrderStatus||20==t.offerOrderStatus?"bg-warning-subtle text-warning":30==t.offerOrderStatus?"bg-success-subtle text-success":40==t.offerOrderStatus?"bg-danger-subtle text-danger":50==t.offerOrderStatus?"bg-danger-success text-success":"bg-warning-subtle text-warning"}checkEdit(t){return!t.isCancel&&!t.isFinish}getTrnslate(t){return t.isCancel?"orderManagement.order.cancel":t.isFinish?"orderManagement.order.finish":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen?"orderManagement.order.reopen":t.isAssign?"orderManagement.order.assign":t.isConfirmed?"orderManagement.order.confirmed":t.isFree?"orderManagement.order.free":"orderManagement.order.new"}openModalClient(t,i,n="xl"){this.clientSelected=t.orderCode,this.orderSelected=t,this.isOrderEdit=!1,this.modalService.open(i,{centered:!0,size:n})}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}openEditOrderModal(t,i,n="md"){this.form={},this.isOrderEdit=!0,this.clientSelected=t,this.modalService.open(i,{centered:!0,size:n})}OpenOrderTimeLineModel(t,i,n="md"){this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}saveQuantity(t,i){this.baseService.UpdateQuantity({id:t,quantity:i.approvedQuantity}).pipe((0,p.Q)(this.notifier)).subscribe(s=>{s.success?(this.alertService.success(),this.loadentities()):this.alertService.error("general.message."+s)},s=>{this.alertService.error()}),console.log("Saved Quantity:",i.approvedQuantity)}openModalSummaryClient(t,i,n="xl"){this.clientSelected=t,this.isOrderEdit=!1,this.modalService.open(i,{centered:!0,size:n})}RequestChangeQuantity(){this.ngxLoader.startLoader(g.Fq),console.log(this.operationId),this.baseService.RequestChangeQuantity({id:this.operationId,changeQuantityMessage:this.form.changeQuantityMessage}).pipe((0,T.O)(),(0,N.c)(this.mainDelay),(0,x.Z)(),(0,p.Q)(this.notifier),(0,I.j)(()=>this.ngxLoader.stopLoader(g.Fq))).subscribe({next:i=>{this.modalService.dismissAll(),this.reload(),this.alertService.success()}})}reload(){this.baseService.GetOrderCountSource.next(!0),this.loadentities()}goNew(){this.router.navigateByUrl("/sales/new")}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(y.nX),e.rXU(u.c$),e.rXU(P),e.rXU(V.u),e.rXU(m.vh),e.rXU(C.eD),e.rXU(_.Bq),e.rXU(ee.J),e.rXU(ge.n),e.rXU(Te.G),e.rXU(H.V),e.rXU(K.h),e.rXU(Ne.m),e.rXU(Z.O),e.rXU(re.S),e.rXU(xe.l),e.rXU(y.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-new-order"]],features:[e.Vt3],decls:51,vars:51,consts:[["tableMaster",""],["SubmitOrderModal",""],["deleteModal",""],["ClientInfo",""],["SubmitChangeQuantityModal",""],["formEntity","ngForm"],["changeQuantityMessage","ngModel"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"addNew","reset","search","exportXlsx","addPermission","showAdd","showExport","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","id","name","id",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],["InputTirmFilter","","type","search","id","clientName","name","clientName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["name","regionId","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],["name","cityId","bindValue","code","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],[2,"width",".2%"],["translate","",2,"width",".5%"],["pSortableColumn","id","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["pSortableColumn","creationTime","translate","",2,"width","12%"],["pSortableColumn","clientId","translate","",2,"width","10%"],["translate","",2,"width","8%"],["pSortableColumn","clientVisitDate","translate","",2,"width","8%"],["pSortableColumn","totalQuantity","translate","",2,"width","8%"],["pSortableColumn","netPrice","translate","",2,"width","6%"],["translate","",2,"width","10%"],[1,"fs-5"],["type","button","pRipple","",1,"border-0","p-button-text","p-button-rounded","p-button-plain",3,"pRowToggler","ngClass"],[1,"code-pointer"],[1,"badge","bg-success-subtle","text-success"],[3,"click"],["href","javascript:void(0)",1,"link-primary","link-offset-2","text-decoration-underline","link-underline-opacity-25","link-underline-opacity-100-hover"],[1,"d-inline"],[1,"ri-history-fill","d-inline","text-primary","fs-16","align-middle","me-1"],["class","btn btn-sm btn-success edit-list mx-1","tooltipPosition","top",3,"pTooltip","click",4,"hasPermission"],["class","btn btn-sm btn-warning edit-list mx-1","tooltipPosition","top",3,"pTooltip","click",4,"hasPermission"],["class","btn btn-sm btn-danger edit-list mx-1","tooltipPosition","top",3,"pTooltip","click",4,"hasPermission"],["tooltipPosition","top",1,"btn","btn-sm","btn-success","edit-list","mx-1",3,"click","pTooltip"],[1,"ri-check-double-fill","align-bottom"],["tooltipPosition","top",1,"btn","btn-sm","btn-warning","edit-list","mx-1",3,"click","pTooltip"],[1,"ri-logout-circle-r-line","align-bottom"],["tooltipPosition","top",1,"btn","btn-sm","btn-danger","edit-list","mx-1",3,"click","pTooltip"],[1,"ri-close-fill","align-bottom"],["colspan","17"],[1,"table-detail"],["dataKey","id",3,"value"],["pTemplate","emptymessage"],["translate","sales.salesOrder.itemName",2,"width","10%"],["translate","sales.salesOrder.unit",2,"width","6%"],["translate","sales.salesOrder.clientQuantity",2,"width","8%"],["translate","sales.salesOrder.approvedQuantity",2,"width","8%"],["translate","sales.salesOrder.price",2,"width","5%"],[2,"width","5%"],[4,"ngIf"],["type","number","class","form-control fs-6",3,"ngModel","ngModelChange",4,"ngIf"],["class","btn btn-sm btn-success edit-list mx-1","tooltipPosition","top",3,"pTooltip","click",4,"ngIf"],["type","number",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["colspan","8"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"ngSubmit"],[3,"hasProgressBar","fgsType","loaderId"],[1,"modal-content"],[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mt-2","text-center"],["src","https://cdn.lordicon.com/gdfrsvpt.json","stroke","bold","state","hover-oscillate","trigger","loop","colors","primary:#f7b84b,secondary:#f06548",2,"width","130px","height","130px"],[1,"pt-2","fs-15","mx-4","mx-sm-5"],["translate","orderManagement.order.AreYouSureMessage"],[1,"text-muted","mx-4","mb-0"],[1,"d-flex","gap-2","justify-content-center","mt-4","mb-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],[3,"success","dismiss","orderId"],[3,"dismiss","clientId"],[1,"mb-2"],["for","changeQuantityMessage","translate","",1,"required","text-bold","form-label"],["rows","5","InputTirmFilter","","name","changeQuantityMessage","type","text","id","changeQuantityMessage",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["class","text-danger text-center  ","translate","",4,"ngIf"],["t","","type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger",3,"disabled"],["translate","",1,"text-danger","text-center"]],template:function(i,n){if(1&i){const s=e.RV6();e.j41(0,"div",7)(1,"div",8)(2,"div",9),e.nrm(3,"ngx-ui-loader",10),e.j41(4,"base-filter",11),e.bIt("addNew",function(){return e.eBV(s),e.Njj(n.goNew())})("reset",function(){return e.eBV(s),e.Njj(n.onReset())})("search",function(){return e.eBV(s),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(s),e.Njj(n.onExportXlsx())}),e.qex(5,12),e.j41(6,"div",13)(7,"div",14)(8,"input",15),e.nI1(9,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.id,a)||(n.pagination.id=a),e.Njj(a)}),e.k0s(),e.nrm(10,"i",16),e.k0s()(),e.j41(11,"div",13)(12,"input",17),e.nI1(13,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.searchForm.creationDates,a)||(n.searchForm.creationDates=a),e.Njj(a)}),e.k0s()(),e.j41(14,"div",13)(15,"div",14)(16,"input",18),e.nI1(17,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.clientName,a)||(n.pagination.clientName=a),e.Njj(a)}),e.k0s(),e.nrm(18,"i",16),e.k0s()(),e.j41(19,"div",13)(20,"div",14)(21,"ng-select",19),e.nI1(22,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.salesPersonId,a)||(n.pagination.salesPersonId=a),e.Njj(a)}),e.k0s()()(),e.j41(23,"div",13)(24,"input",17),e.nI1(25,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.searchForm.dates,a)||(n.searchForm.dates=a),e.Njj(a)}),e.k0s()(),e.j41(26,"div",13)(27,"div",14)(28,"ng-select",20),e.nI1(29,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.regionId,a)||(n.pagination.regionId=a),e.Njj(a)}),e.k0s()()(),e.j41(30,"div",13)(31,"div",14)(32,"ng-select",21),e.nI1(33,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.cityId,a)||(n.pagination.cityId=a),e.Njj(a)}),e.k0s()()(),e.bVm(),e.k0s(),e.j41(34,"div",22)(35,"div",23)(36,"p-table",24,0),e.bIt("onLazyLoad",function(a){return e.eBV(s),e.Njj(n.tableChange(a))})("selectionChange",function(a){return e.eBV(s),e.Njj(n.onSelectionChange(a))}),e.DNE(38,wi,25,0,"ng-template",25)(39,Ei,31,23,"ng-template",26)(40,Ui,7,1,"ng-template",27),e.k0s()(),e.DNE(41,Ai,2,0,"div",28)(42,Qi,6,8,"div",29),e.k0s()()()(),e.DNE(43,qi,15,3,"ng-template",null,1,e.C5r)(45,zi,1,1,"ng-template",null,2,e.C5r)(47,Hi,1,1,"ng-template",null,3,e.C5r)(49,Ki,16,6,"ng-template",null,4,e.C5r)}2&i&&(e.R7$(3),e.Y8G("loaderId","newLoader"),e.R7$(),e.Y8G("addPermission",e.lJ4(50,Ri))("showAdd",!0)("showExport",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(9,36,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.id),e.R7$(4),e.FS9("placeholder",e.bMT(13,38,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(4),e.FS9("placeholder",e.bMT(17,40,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.clientName),e.R7$(5),e.FS9("placeholder",e.bMT(22,42,"sales.salesOrder.salsePerson")),e.Y8G("items",n.salesPersons)("multiple",!1),e.R50("ngModel",n.pagination.salesPersonId),e.R7$(3),e.FS9("placeholder",e.bMT(25,44,"sales.salesOrder.clientVisitDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.dates),e.R7$(4),e.FS9("placeholder",e.bMT(29,46,"client.client.regionName")),e.Y8G("items",n.regions)("multiple",!1),e.R50("ngModel",n.pagination.regionId),e.R7$(4),e.FS9("placeholder",e.bMT(33,48,"client.client.cityName")),e.Y8G("items",n.cities)("multiple",!1),e.R50("ngModel",n.pagination.cityId),e.R7$(4),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(5),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[m.YU,m.bT,d.qT,d.me,d.Q0,d.BC,d.cb,d.vS,d.cV,_.s5,D.kL,A.b,Q.p,q.g,ue,u.Mm,S.XI,z.Ei,S.Tg,S.FP,C.Cv,E.vr,X.m,U.p,ie.m,_e,m.vh,u.D9],encapsulation:2})}}return r})();const Wi=()=>["salesOrder.register"],er=()=>["storePrepare.editTrunk"],tr=()=>["storePrepare.shippingOrder"],nr=()=>["storePrepare.newOrder"],ir=()=>["storePrepare.cancel"],$e=r=>[r];function rr(r,o){1&r&&(e.j41(0,"tr",31),e.nrm(1,"th",32),e.j41(2,"th",33),e.EFF(3,"#"),e.k0s(),e.j41(4,"th",34),e.nrm(5,"i",35),e.EFF(6," orderManagement.order.orderCode "),e.k0s(),e.j41(7,"th",36),e.nrm(8,"i",35),e.EFF(9," orderManagement.order.creation "),e.k0s(),e.j41(10,"th",37),e.nrm(11,"i",35),e.EFF(12," orderManagement.order.agentName "),e.k0s(),e.j41(13,"th",38),e.EFF(14," sales.salesOrder.salsePerson "),e.k0s(),e.j41(15,"th",39),e.nrm(16,"i",35),e.EFF(17," sales.salesOrder.clientVisitDate "),e.k0s(),e.j41(18,"th",40),e.EFF(19," sales.salesOrder.deliveryStatus "),e.k0s(),e.j41(20,"th",41),e.nrm(21,"i",35),e.EFF(22," sales.salesOrder.totalQuantity "),e.k0s(),e.j41(23,"th",42),e.EFF(24," sales.salesOrder.clientLocationName "),e.k0s(),e.nrm(25,"th",40),e.k0s())}function sr(r,o){1&r&&e.nrm(0,"span",60)}function ar(r,o){1&r&&e.nrm(0,"span",61)}function or(r,o){1&r&&e.nrm(0,"span",62)}function lr(r,o){1&r&&e.nrm(0,"span",63)}function dr(r,o){if(1&r&&(e.j41(0,"a",64),e.nrm(1,"i",65),e.k0s()),2&r){const t=e.XpG().$implicit,i=e.XpG();e.Y8G("href",i.mapUrl(null==t?null:t.lng,null==t?null:t.lat),e.B4B)}}function cr(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",67),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2).$implicit,s=e.XpG(),l=e.sdS(46);return e.Njj(s.openShippingModal(n.id,l,"lg"))}),e.nrm(2,"i",68),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"sales.salesOrder.shipping"))}function mr(r,o){if(1&r&&(e.qex(0),e.DNE(1,cr,3,3,"button",66),e.bVm()),2&r){const t=e.XpG().$implicit;e.R7$(),e.Y8G("ngIf",!(t.totalQuantityDelivery>0&&t.totalQuantityDelivery==t.totalQuantity))}}function pr(r,o){if(1&r){const t=e.RV6();e.j41(0,"li",69),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,s=e.XpG(),l=e.sdS(52);return e.Njj(s.openStatusModal(n.id,l,50,"md"))}),e.j41(1,"span",70),e.nrm(2,"i",71)(3,"span",72),e.k0s()()}}function gr(r,o){if(1&r){const t=e.RV6();e.j41(0,"li",69),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,s=e.XpG(),l=e.sdS(52);return e.Njj(s.openStatusModal(n.id,l,10,"md"))}),e.j41(1,"span",70),e.nrm(2,"i",73)(3,"span",74),e.k0s()()}}function _r(r,o){if(1&r){const t=e.RV6();e.j41(0,"li",69),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,s=e.XpG(),l=e.sdS(48);return e.Njj(s.openModal(n.id,l))}),e.j41(1,"span",70),e.nrm(2,"i",75)(3,"span",76),e.k0s()()}}function ur(r,o){if(1&r&&(e.j41(0,"tr",43)(1,"td"),e.nrm(2,"button",44),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td")(6,"bdi",45),e.EFF(7),e.k0s()(),e.j41(8,"td")(9,"span",46),e.EFF(10),e.k0s(),e.EFF(11),e.nI1(12,"date"),e.k0s(),e.j41(13,"td")(14,"span",47),e.EFF(15),e.k0s()(),e.j41(16,"td"),e.EFF(17),e.k0s(),e.j41(18,"td"),e.DNE(19,sr,1,0,"span",48)(20,ar,1,0,"span",49)(21,or,1,0,"span",50),e.k0s(),e.j41(22,"td"),e.EFF(23),e.nI1(24,"date"),e.k0s(),e.j41(25,"td"),e.EFF(26),e.k0s(),e.j41(27,"td"),e.DNE(28,lr,1,0,"span",51)(29,dr,2,1,"a",52),e.k0s(),e.j41(30,"td")(31,"div",53),e.DNE(32,mr,2,1,"ng-container",54),e.j41(33,"span",53)(34,"div",55)(35,"button",56),e.nrm(36,"i",57),e.k0s(),e.j41(37,"ul",58),e.DNE(38,pr,4,0,"li",59)(39,gr,4,0,"li",59)(40,_r,4,0,"li",59),e.k0s()()()()()()),2&r){const t=o.$implicit,i=o.rowIndex,n=o.expanded;e.R7$(2),e.Y8G("pRowToggler",t)("ngClass",n?" ri-arrow-down-s-line":"  ri-arrow-up-s-line"),e.R7$(2),e.JRh(i+1),e.R7$(3),e.SpI("#SO#",t.id,""),e.R7$(3),e.SpI("",t.creatorName," "),e.R7$(),e.SpI(" ",e.i5U(12,19,t.creationTime,"yyyy-MM-dd HH:mm")," "),e.R7$(4),e.SpI("",t.clientName," "),e.R7$(2),e.JRh(t.salsePersonName),e.R7$(2),e.Y8G("ngIf",t.totalQuantityDelivery<=0),e.R7$(),e.Y8G("ngIf",t.totalQuantityDelivery>0&&t.totalQuantityDelivery==t.totalQuantity),e.R7$(),e.Y8G("ngIf",t.totalQuantityDelivery>0&&t.totalQuantityDelivery<t.totalQuantity),e.R7$(2),e.SpI(" ",e.i5U(24,22,t.acutalVisitDate,"yyyy-MM-dd HH:mm"),""),e.R7$(3),e.JRh(t.totalQuantity),e.R7$(2),e.Y8G("ngIf",""==t.lng),e.R7$(),e.Y8G("ngIf",null==t?null:t.lng),e.R7$(3),e.Y8G("hasPermission",e.lJ4(25,er)),e.R7$(6),e.Y8G("hasPermission",e.lJ4(26,tr)),e.R7$(),e.Y8G("hasPermission",e.lJ4(27,nr)),e.R7$(),e.Y8G("hasPermission",e.lJ4(28,ir))}}function hr(r,o){1&r&&(e.j41(0,"tr"),e.nrm(1,"th",81)(2,"th",82)(3,"th",83)(4,"th",84)(5,"th",85),e.k0s())}function fr(r,o){if(1&r&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td")(8,"span"),e.EFF(9),e.k0s()(),e.j41(10,"td")(11,"span"),e.EFF(12),e.k0s()()()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t.itemName),e.R7$(2),e.JRh(t.unitName),e.R7$(2),e.JRh(t.clientQuantity),e.R7$(3),e.JRh(t.approvedQuantity),e.R7$(3),e.JRh(t.deliveryQuantity)}}function br(r,o){1&r&&(e.j41(0,"tr"),e.nrm(1,"td",86),e.k0s())}function Cr(r,o){if(1&r&&(e.j41(0,"tr")(1,"td",77)(2,"div",78)(3,"p-table",79),e.DNE(4,hr,6,0,"ng-template",26)(5,fr,13,5,"ng-template",27)(6,br,2,0,"ng-template",80),e.k0s()()()()),2&r){const t=o.$implicit;e.R7$(3),e.Y8G("value",t.offerOrderDetails)}}function Sr(r,o){1&r&&(e.j41(0,"div",87),e.EFF(1," general.table.noData "),e.k0s())}function vr(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",88)(1,"div",89),e.nrm(2,"ngb-pagination-info",90),e.j41(3,"table-length",91),e.bIt("lengthChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",92)(5,"ngb-pagination",93),e.bIt("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.pagination.pageNumber,n)||(s.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function jr(r,o){if(1&r){const t=e.RV6();e.j41(0,"form",94,7),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.cancelOrder())}),e.nrm(2,"ngx-ui-loader",95),e.j41(3,"div",96)(4,"div",97)(5,"button",98),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"div",99)(7,"div",100),e.nrm(8,"lord-icon",101),e.j41(9,"div",102),e.nrm(10,"h3",103)(11,"p",104),e.k0s()(),e.j41(12,"div",105),e.nrm(13,"button",106),e.j41(14,"button",107),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}function Ir(r,o){if(1&r){const t=e.RV6();e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td")(4,"ng-select",137),e.mxI("ngModelChange",function(n){const s=e.eBV(t).$implicit;return e.DH7(s.unitId,n)||(s.unitId=n),e.Njj(n)}),e.k0s()(),e.j41(5,"td")(6,"input",138),e.bIt("ngModelChange",function(n){const s=e.eBV(t).$index,l=e.XpG(2);return e.Njj(l.quantitySelect(n,s))}),e.mxI("ngModelChange",function(n){const s=e.eBV(t).$implicit;return e.DH7(s.quantity,n)||(s.quantity=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=o.$implicit,i=o.$index;e.R7$(2),e.SpI(" ",t.itemName," "),e.R7$(2),e.Y8G("name","unitId"+e.eq3(6,$e,i))("items",t.units),e.R50("ngModel",t.unitId),e.R7$(2),e.Y8G("name","quantity"+e.eq3(8,$e,i)),e.R50("ngModel",t.quantity)}}function yr(r,o){if(1&r){const t=e.RV6();e.j41(0,"tr",139),e.nrm(1,"td",140),e.j41(2,"td",141)(3,"table",142)(4,"tbody")(5,"tr"),e.nrm(6,"td",143),e.j41(7,"td",144),e.EFF(8),e.nI1(9,"translate"),e.k0s()(),e.j41(10,"tr"),e.nrm(11,"td",145),e.j41(12,"td",144)(13,"div",146)(14,"ng-select",147),e.bIt("change",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.getTotal())}),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG(2);return e.DH7(s.form.totalAddDiscountType,n)||(s.form.totalAddDiscountType=n),e.Njj(n)}),e.k0s(),e.j41(15,"input",148),e.bIt("change",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.getTotal())}),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG(2);return e.DH7(s.form.totalAddDiscount,n)||(s.form.totalAddDiscount=n),e.Njj(n)}),e.k0s()()()(),e.j41(16,"tr",149),e.nrm(17,"td",150),e.j41(18,"td",144),e.EFF(19),e.nI1(20,"translate"),e.k0s()(),e.j41(21,"tr",151),e.nrm(22,"th",152),e.j41(23,"th",144),e.EFF(24),e.nI1(25,"translate"),e.k0s()()()()()()}if(2&r){const t=e.XpG(2);e.R7$(8),e.Lme("",t.form.total," ",e.bMT(9,9,"orderManagement.order.currancy"),""),e.R7$(6),e.Y8G("items",t.discountTypes),e.R50("ngModel",t.form.totalAddDiscountType),e.R7$(),e.R50("ngModel",t.form.totalAddDiscount),e.R7$(4),e.Lme("",t.form.tax," ",e.bMT(20,11,"orderManagement.order.currancy"),""),e.R7$(5),e.Lme("",t.form.totalNet," ",e.bMT(25,13,"orderManagement.order.currancy"),"")}}function kr(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",108)(1,"div",109)(2,"h4",110),e.nrm(3,"span",111),e.k0s(),e.j41(4,"button",112),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss("Cross click"))}),e.k0s()(),e.j41(5,"div",99),e.nrm(6,"ngx-ui-loader",95),e.j41(7,"form",113,7),e.bIt("submit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.updateTruck())}),e.j41(9,"div",8)(10,"div",114)(11,"label",115),e.EFF(12,"sales.salesOrder.acutalDeliveryDate"),e.k0s(),e.j41(13,"input",116),e.bIt("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.dateChangeModal(n))}),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.acutalVisitDate,n)||(s.form.acutalVisitDate=n),e.Njj(n)}),e.k0s()(),e.j41(14,"div",114),e.nrm(15,"label",117),e.j41(16,"ng-select",118),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.clientLocationId,n)||(s.form.clientLocationId=n),e.Njj(n)}),e.k0s()(),e.j41(17,"div",119)(18,"label",115),e.EFF(19,"sales.salesOrder.truncks"),e.k0s(),e.j41(20,"ng-select",120),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.shippingTruckId,n)||(s.form.shippingTruckId=n),e.Njj(n)}),e.k0s()()(),e.j41(21,"div",121)(22,"div",122)(23,"div",123)(24,"div",124),e.nrm(25,"h5",125),e.k0s()(),e.j41(26,"div",23)(27,"div",126)(28,"table",127)(29,"thead",128)(30,"tr"),e.nrm(31,"th",129)(32,"th",130)(33,"th",131),e.k0s()(),e.j41(34,"tbody"),e.Z7z(35,Ir,7,10,"tr",null,e.Vm6),e.DNE(37,yr,26,15,"tr",132),e.k0s()()()()()(),e.j41(38,"div",133)(39,"button",134),e.nrm(40,"i",135)(41,"span",136),e.k0s()()()()()}if(2&r){const t=e.sdS(8),i=e.XpG();e.R7$(6),e.Y8G("hasProgressBar",!1)("fgsType",i.loaderOperationShap)("loaderId",i.operationLoader),e.R7$(7),e.R50("ngModel",i.form.acutalVisitDate),e.Y8G("altInput",!0)("enableTime",!0)("convertModelValue",!0)("dateFormat","d-m-Y H:i"),e.R7$(3),e.Y8G("disabled",!0)("items",i.locations),e.R50("ngModel",i.form.clientLocationId),e.R7$(4),e.Y8G("items",i.truncks),e.R50("ngModel",i.form.shippingTruckId),e.R7$(15),e.Dyx(i.form.details),e.R7$(2),e.Y8G("ngIf",!1),e.R7$(2),e.Y8G("disabled",!t.valid)}}function Tr(r,o){if(1&r){const t=e.RV6();e.j41(0,"cancel-sales-model",153),e.bIt("success",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.loadentities())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderId",t.orderSelected)}}function xr(r,o){if(1&r){const t=e.RV6();e.j41(0,"order-timeline",154),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderSelected",t.orderSelected)}}function Mr(r,o){if(1&r){const t=e.RV6();e.j41(0,"form",94,7),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.SubmitOrder())}),e.nrm(2,"ngx-ui-loader",95),e.j41(3,"div",96)(4,"div",97)(5,"button",98),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"div",99)(7,"div",100),e.nrm(8,"lord-icon",101),e.j41(9,"div",102),e.nrm(10,"h3",103)(11,"p",104),e.k0s()(),e.j41(12,"div",105),e.nrm(13,"button",106),e.j41(14,"button",107),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}function Rr(r,o){if(1&r){const t=e.RV6();e.j41(0,"sales-edit-order",154),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderSelected",t.operationId)}}let Or=(()=>{class r extends Y.w{constructor(t,i,n,s,l,a,f,M,R,O,w,k,v,j,b){super(t,i,f,n,s,l,a),this.baseService=n,this.authDaamService=M,this.teamService=R,this.excelService=O,this.employeeService=w,this.regionService=k,this.cityService=v,this.router=j,this.orderReceivedService=b,this.title="sales.salesOrder.sureOrder",this.titleOperation="sales.salesOrder.sureOrder",this.keySelected="",this.searchForm={},this.isResolveList=!0,this.activeindex="2",this.active=2,this.status=[],this.countLoad=2,this.isOrderEdit=!1,this.orderSelected={},this.users=[],this.truncks=[],this.locations=[],this.salesPersons=[],this.clientSelected=0,this.discountTypes=[],this.regions=[],this.cities=[],this.setDates=(h,G,F)=>{if(h?.from||h?.to){const W=h.to||h.from;this.pagination[G]=this.datePipe.transform(h.from||h.to,"yyyy-MM-ddT00:00:00"),this.pagination[F]=this.datePipe.transform(W,"yyyy-MM-ddT23:59:59.999")}else this.pagination[G]=null,this.pagination[F]=null},this.loadentities(),this.GetSalesPersons(),this.discountTypes=this.baseService.discountTypes,this.discountTypes.forEach(h=>{h.name=this.getTranslationText("sales.salesOrder."+h.name)}),this.GetRegions(),this.GetCities()}GetRegions(){this.regionService.getDropDown().subscribe(t=>{this.regions=t.data},t=>{console.log(t)})}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetSalesPersons(){this.employeeService.GetAllByType(9).subscribe(t=>{this.salesPersons=t.data},t=>{console.log(t)})}loadentities(){this.countLoad=this.countLoad+1,(!this.isResolveList||1!==this.countLoad)&&(this.pagination.status=30,this.baseService.get(this.pagination).pipe((0,p.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader(g.a7),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader(g.a7),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}openModal(t,i,n="md"){this.isOrderEdit=!1,this.form={},this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}SubmitOrder(){this.ngxLoader.startLoader(g.Fq),this.baseService.changStatus({id:this.form.id,status:this.form.status}).pipe((0,T.O)(),(0,N.c)(this.mainDelay),(0,x.Z)(),(0,p.Q)(this.notifier),(0,I.j)(()=>this.ngxLoader.stopLoader(g.Fq))).subscribe({next:i=>{this.modalService.dismissAll(),this.loadentities(),this.alertService.success()}})}cancelOrder(){this.ngxLoader.startLoader(g.Fq),console.log(this.operationId),this.baseService.changStatus({id:this.operationId,status:40}).pipe((0,T.O)(),(0,N.c)(this.mainDelay),(0,x.Z)(),(0,p.Q)(this.notifier),(0,I.j)(()=>this.ngxLoader.stopLoader(g.Fq))).subscribe({next:i=>{this.modalService.dismissAll(),this.loadentities(),this.alertService.success()}})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,p.Q)(this.notifier)).subscribe(i=>{i?this.alertService.success():this.alertService.error("general.message."+i)},i=>{this.alertService.error()})}mapRegisterForm(t){let i={...t};return i.employeeCode=0,i}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader("allLoader"),this.setDates(t.dates,"visitDateFrom","visitDateTo"),this.setDates(t.creationDates,"creationTimeFrom","creationTimeTo"),this.loadentities()}LoadSuccess(){this.ngxLoader.stopLoader("allLoader")}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems}}configRoute(){this.routerActive.data.pipe((0,p.Q)(this.notifier)).subscribe(t=>{this.entities=t.data,this.pagination.totalItems=t.data?.totalItems},()=>{this.alertService.error()})}mapExcel(){let t=[];return this.entities.forEach(i=>{t.push({"Order Code":i.orderCode,"Created Date":i.createdDate,"City Name":i.cityName,"District Name":i.districtName?i.districtName:"--","Agent Name":i.agentName,Mobile:i.mobile,"Channel Name":i.channelName,"Assigned To":i.teamNames,Times:i.workTimes,"Visit Date":i.visitDate,Services:i.services})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}goRegister(){this.router.navigateByUrl("/managment/order/new")}goEdit(t){this.router.navigateByUrl("/managment/order/new")}getStatus(t){return 10==t.offerOrderStatus||20==t.offerOrderStatus?"bg-warning-subtle text-warning":30==t.offerOrderStatus?"bg-success-subtle text-success":40==t.offerOrderStatus?"bg-danger-subtle text-danger":50==t.offerOrderStatus?"bg-danger-success text-success":"bg-warning-subtle text-warning"}checkEdit(t){return!t.isCancel&&!t.isFinish}openStatusModal(t,i,n,s="md"){this.isEditForm=!1,this.form={},this.form={id:t,status:n},this.modalService.open(i,{centered:!0,size:s})}openModalClient(t,i,n="xl"){this.clientSelected=t.orderCode,this.form=t,this.isOrderEdit=!1,this.modalService.open(i,{centered:!0,size:n})}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}openEditOrderModal(t,i,n="md"){this.form={},this.isOrderEdit=!0,this.clientSelected=t,this.modalService.open(i,{centered:!0,size:n})}OpenOrderTimeLineModel(t,i,n="md"){this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}selectTruck(t){this.truncks=this.truncks.map(i=>({...i,isSelected:i.id===t}))}getSelectedTruckId(){const t=this.truncks.find(i=>i.isSelected);return t?t.id:null}convertToISO(t){if(t instanceof Date)return t.toISOString();if("string"==typeof t){const[i,n,s,l,a]=t.split(/[-\s:]/);return`${s}-${n}-${i}T${l}:${a}:00`}}updateTruck(){this.form.acutalVisitDate=new Date(this.convertToISO(this.form.acutalVisitDate));let t={shippingTruckId:this.form.shippingTruckId,clientLocationId:this.form.clientLocationId,offerOrderMasterId:this.form.id,Notes:this.form.notes,terms:this.form.terms,deliveryDate:this.datePipe.transform(this.form.acutalVisitDate,"yyyy-MM-ddTHH:mm:00.000"),details:this.form.details.map(i=>({id:0,itemId:i.itemId,itemName:i.itemName,quantity:i.quantity,unitId:i.unitId,price:i.price,discount:i.discount,discountType:i.discountType,clientQuantity:i.clientQuantity,approvedQuantity:i.approvedQuantity}))};this.ngxLoader.startLoader(this.operationLoader),this.orderReceivedService.register(t).pipe((0,T.O)(),(0,N.c)(this.mainDelay),(0,x.Z)(),(0,p.Q)(this.notifier),(0,I.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(i=>{i.success?this.submitFunished():this.alertService.error("general.message."+i.message)},i=>{this.alertService.error("general.message."+i)})}openShippingModal(t,i,n="md"){this.baseService.GetTrucks({id:t,acutalVisitDate:null}).subscribe(l=>{l.success?(this.form=l.data.order,this.getTotal(),this.form.clientVisitDate=this.formatDate(this.form.clientVisitDate),this.form.acutalVisitDate=this.formatDate(this.form.acutalVisitDate),this.truncks=l.data.truncks,this.locations=l.data.locations,this.modalService.open(i,{centered:!0,size:n})):this.alertService.error("general.message."+l.message)},l=>{this.alertService.error("general.message."+l)})}dateChangeModal(t){t=new Date(t);let i={id:this.form.id,acutalVisitDate:this.datePipe.transform(t,"yyyy-MM-ddT00:00:00.000")};this.baseService.GetTrucks(i).subscribe(n=>{n.success?this.truncks=n.data.truncks:this.alertService.error("general.message."+n.message)},n=>{this.alertService.error("general.message."+n)})}formatDate(t){if(!t)return"";const i=new Date(t);return i.getDate().toString().padStart(2,"0")+"-"+(i.getMonth()+1).toString().padStart(2,"0")+"-"+i.getFullYear()+" "+i.getHours().toString().padStart(2,"0")+":"+i.getMinutes().toString().padStart(2,"0")}getTotal(){let t=0,i=0,n=0;this.form.details.forEach(s=>{s.discount<0&&(s.discoun=0);let l=s.quantity*s.price,a=0;1===s.discountType?a=s.discount:2===s.discountType&&(a=l*s.discount/100),i=+a;let f=l-a;s.net=f,t=+f}),1===this.form.totalAddDiscountType?n=this.form.totalAddDiscount:2===this.form.totalAddDiscountType&&(n=t*this.form.totalAddDiscount/100),this.form.total=t,this.form.totalAddDiscount=this.form.totalAddDiscount,this.form.tax=15*this.form.total/100,this.form.totalNet=this.form.total-n+this.form.tax}quantitySelect(t,i){t&&(t<=0&&(t=1),this.form.details[i].quantity=parseInt(t),this.form.details[i].net=this.form.details[i].price*this.form.details[i].quantity,this.discountSelect(this.form.details[i].discount,i),this.getTotal())}discountSelect(t,i,n=1){if(t){(t=parseInt(t))<=0&&(this.form.details[i].discount=0),1==n&&(this.form.details[i].discount=t);let s=0;1==this.form.details[i].discountType?s=this.form.details[i].discount:(s=this.form.details[i].price*this.form.details[i].quantity*this.form.details[i].discount/100,s=+s.toFixed(2)),this.form.details[i].net=this.form.details[i].price*this.form.details[i].quantity-s,this.form.details[i].net=this.form.details[i].net.toFixed(2),this.getTotal()}}goNew(){this.router.navigateByUrl("/sales/new")}mapUrl(t,i){return null===t||null==i?"":`https://www.google.com/maps/dir//${i},${t}/@${i},${t},17z?hl=en-US`}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(y.nX),e.rXU(u.c$),e.rXU(P),e.rXU(V.u),e.rXU(m.vh),e.rXU(C.eD),e.rXU(_.Bq),e.rXU(ee.J),e.rXU(ge.n),e.rXU(H.V),e.rXU(Z.O),e.rXU(re.S),e.rXU(K.h),e.rXU(y.Ix),e.rXU(Se))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-sure-order"]],features:[e.Vt3],decls:55,vars:51,consts:[["tableMaster",""],["cancelOrderModal",""],["SubmitOrderModal",""],["deleteModal",""],["OrderTimeLineModel",""],["StatusOrderModal",""],["SalesEditModel",""],["formEntity","ngForm"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"addNew","reset","search","exportXlsx","addPermission","showAdd","showExport","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","id","name","id",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],["InputTirmFilter","","type","search","id","clientName","name","clientName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["name","regionId","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],["name","cityId","bindValue","code","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],[2,"width",".2%"],["translate","",2,"width",".5%"],["pSortableColumn","id","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["pSortableColumn","creationTime","translate","",2,"width","12%"],["pSortableColumn","clientId","translate","",2,"width","10%"],["translate","",2,"width","8%"],["pSortableColumn","clientVisitDate","translate","",2,"width","8%"],["translate","",2,"width","10%"],["pSortableColumn","totalQuantity","translate","",2,"width","8%"],["translate","",2,"width","5%"],[1,"fs-5"],["type","button","pRipple","",1,"border-0","p-button-text","p-button-rounded","p-button-plain",3,"pRowToggler","ngClass"],[1,"code-pointer"],[1,"badge","bg-success-subtle","text-success"],[1,"badge","bg-primary-subtle","text-primary","my-1"],["class","badge bg-warning-subtle text-warning my-1","translate","sales.salesOrder.noDelivery",4,"ngIf"],["class","badge bg-success-subtle text-success my-1","translate","sales.salesOrder.fullDelivery",4,"ngIf"],["class","badge bg-info-subtle text-info my-1","translate","sales.salesOrder.partialDelivery",4,"ngIf"],["class","badge bg-danger-subtle text-danger mx-1","translate","orderManagement.order.noMap",4,"ngIf"],["target","_blank","class","badge bg-success-subtle text-success mx-1","translate","orderManagement.order.viewMap",3,"href",4,"ngIf"],[1,"d-inline-block"],[4,"hasPermission"],[1,"dropdown-custom","d-inline-block"],["type","button",1,"btn","dropbtn","btn-soft-secondary","btn-sm","dropdown-custom","arrow-none"],[1,"ri-more-fill"],[1,"dropdown-menu","dropdown-menu-end","dropdown-content",2,"left","0"],[3,"click",4,"hasPermission"],["translate","sales.salesOrder.noDelivery",1,"badge","bg-warning-subtle","text-warning","my-1"],["translate","sales.salesOrder.fullDelivery",1,"badge","bg-success-subtle","text-success","my-1"],["translate","sales.salesOrder.partialDelivery",1,"badge","bg-info-subtle","text-info","my-1"],["translate","orderManagement.order.noMap",1,"badge","bg-danger-subtle","text-danger","mx-1"],["target","_blank","translate","orderManagement.order.viewMap",1,"badge","bg-success-subtle","text-success","mx-1",3,"href"],[1,"ri-map-pin-line"],["class","btn btn-sm btn-primary edit-list mx-1","tooltipPosition","top",3,"pTooltip","click",4,"ngIf"],["tooltipPosition","top",1,"btn","btn-sm","btn-primary","edit-list","mx-1",3,"click","pTooltip"],[1,"ri-truck-line","align-bottom"],[3,"click"],[1,"dropdown-item"],[1,"text-primary","ri-check-double-fill","align-bottom","me-2"],["translate","sales.shippingOrder.title"],[1,"text-warning","ri-skip-back-fill","align-bottom","me-2"],["translate","sales.smApprove.title"],[1,"text-danger","ri-close-fill","align-bottom","me-2"],["translate","general.action.cancel"],["colspan","17"],[1,"table-detail"],["dataKey","id",3,"value"],["pTemplate","emptymessage"],["translate","sales.salesOrder.itemName",2,"width","10%"],["translate","sales.salesOrder.unit",2,"width","6%"],["translate","sales.salesOrder.clientQuantity",2,"width","8%"],["translate","sales.salesOrder.approvedQuantity",2,"width","8%"],["translate","sales.salesOrder.deliveryQuantity",2,"width","8%"],["colspan","8"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"ngSubmit"],[3,"hasProgressBar","fgsType","loaderId"],[1,"modal-content"],[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mt-2","text-center"],["src","https://cdn.lordicon.com/gdfrsvpt.json","stroke","bold","state","hover-oscillate","trigger","loop","colors","primary:#f7b84b,secondary:#f06548",2,"width","130px","height","130px"],[1,"pt-2","fs-15","mx-4","mx-sm-5"],["translate","orderManagement.order.AreYouSureMessage"],[1,"text-muted","mx-4","mb-0"],[1,"d-flex","gap-2","justify-content-center","mt-4","mb-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["translate","sales.salesOrder.truckUpdate"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[3,"submit"],[1,"col-12","col-md-3"],["for","name","translate","",1,"required","fw-bold","form-label"],["name","acutalVisitDate","type","text","mwlFlatpickr","","altFormat","d-m-Y H:i","required","",1,"form-control","flatpickr-input",3,"ngModelChange","ngModel","altInput","enableTime","convertModelValue","dateFormat"],["for","name","translate","orderManagement.order.savedAddress",1,"required","fw-bold","form-label"],["name","clientLocationId","bindValue","id","bindLabel","name","required","",2,"width","100%",3,"ngModelChange","disabled","items","ngModel"],[1,"col-12","col-md-6"],["name","shippingTruckId","bindValue","id","bindLabel","name","required","",2,"width","100%",3,"ngModelChange","items","ngModel"],[1,"row","justify-content-center","my-0"],[1,"card"],[1,"card-header","p-0"],[1,"d-flex","align-items-center"],["translate","sales.salesRequests.items",1,"card-title","flex-grow-1","mb-0"],[1,"table-responsive","table-card",2,"overflow","visible"],[1,"table","table-nowrap","align-middle","table-borderless","mb-0"],[1,"table-light","text-muted","p-1"],["translate","sales.salesRequests.itemName",2,"width","20%"],["translate","sales.salesRequests.unit",2,"width","25%"],["translate","sales.salesRequests.quantity",2,"width","25%"],["class","border-top border-top-dashed",4,"ngIf"],[1,"d-flex","justify-content-center","m-0"],["type","submit","type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],["clearable","false","clearOnBackspace","false","bindValue","id","bindLabel","name",2,"width","100%",3,"ngModelChange","name","items","ngModel"],["type","text","id","quantity",1,"form-control","fs-6",3,"ngModelChange","name","ngModel"],[1,"border-top","border-top-dashed"],["colspan","3"],["colspan","4",1,"fw-medium","p-0"],[1,"table","table-borderless","mb-0"],["translate","sales.salesOrder.total",1,"m-0","p-0"],[1,"text-end","m-0","p-0"],["translate","sales.salesOrder.extraDiscount",1,"m-0","p-0"],[1,"input-group","mx-4",2,"width","80%"],["clearable","false","clearOnBackspace","false","name","totalAddDiscountType","bindValue","id","bindLabel","name",3,"change","ngModelChange","items","ngModel"],["InputTirmFilter","","name","totalAddDiscount","type","text","id","totalAddDiscount",1,"form-control","fs-6",2,"width","30%",3,"change","ngModelChange","ngModel"],[1,"m-0","p-0"],["translate","sales.salesOrder.tax",1,"m-0","p-0"],[1,"border-top","border-top-dashed","m-0","p-0"],["scope","row","translate","sales.salesOrder.net",1,"m-0","p-0"],[3,"success","dismiss","orderId"],[3,"dismiss","orderSelected"]],template:function(i,n){if(1&i){const s=e.RV6();e.j41(0,"div",8)(1,"div",9)(2,"div",10),e.nrm(3,"ngx-ui-loader",11),e.j41(4,"base-filter",12),e.bIt("addNew",function(){return e.eBV(s),e.Njj(n.goNew())})("reset",function(){return e.eBV(s),e.Njj(n.onReset())})("search",function(){return e.eBV(s),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(s),e.Njj(n.onExportXlsx())}),e.qex(5,13),e.j41(6,"div",14)(7,"div",15)(8,"input",16),e.nI1(9,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.id,a)||(n.pagination.id=a),e.Njj(a)}),e.k0s(),e.nrm(10,"i",17),e.k0s()(),e.j41(11,"div",14)(12,"input",18),e.nI1(13,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.searchForm.creationDates,a)||(n.searchForm.creationDates=a),e.Njj(a)}),e.k0s()(),e.j41(14,"div",14)(15,"div",15)(16,"input",19),e.nI1(17,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.clientName,a)||(n.pagination.clientName=a),e.Njj(a)}),e.k0s(),e.nrm(18,"i",17),e.k0s()(),e.j41(19,"div",14)(20,"div",15)(21,"ng-select",20),e.nI1(22,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.salesPersonId,a)||(n.pagination.salesPersonId=a),e.Njj(a)}),e.k0s()()(),e.j41(23,"div",14)(24,"input",18),e.nI1(25,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.searchForm.dates,a)||(n.searchForm.dates=a),e.Njj(a)}),e.k0s()(),e.j41(26,"div",14)(27,"div",15)(28,"ng-select",21),e.nI1(29,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.regionId,a)||(n.pagination.regionId=a),e.Njj(a)}),e.k0s()()(),e.j41(30,"div",14)(31,"div",15)(32,"ng-select",22),e.nI1(33,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.cityId,a)||(n.pagination.cityId=a),e.Njj(a)}),e.k0s()()(),e.bVm(),e.k0s(),e.j41(34,"div",23)(35,"div",24)(36,"p-table",25,0),e.bIt("onLazyLoad",function(a){return e.eBV(s),e.Njj(n.tableChange(a))})("selectionChange",function(a){return e.eBV(s),e.Njj(n.onSelectionChange(a))}),e.DNE(38,rr,26,0,"ng-template",26)(39,ur,41,29,"ng-template",27)(40,Cr,7,1,"ng-template",28),e.k0s()(),e.DNE(41,Sr,2,0,"div",29)(42,vr,6,8,"div",30),e.k0s()()()(),e.DNE(43,jr,15,3,"ng-template",null,1,e.C5r)(45,kr,42,15,"ng-template",null,2,e.C5r)(47,Tr,1,1,"ng-template",null,3,e.C5r)(49,xr,1,1,"ng-template",null,4,e.C5r)(51,Mr,15,3,"ng-template",null,5,e.C5r)(53,Rr,1,1,"ng-template",null,6,e.C5r)}2&i&&(e.R7$(3),e.Y8G("loaderId","sureLoader"),e.R7$(),e.Y8G("addPermission",e.lJ4(50,Wi))("showAdd",!0)("showExport",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(9,36,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.id),e.R7$(4),e.FS9("placeholder",e.bMT(13,38,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(4),e.FS9("placeholder",e.bMT(17,40,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.clientName),e.R7$(5),e.FS9("placeholder",e.bMT(22,42,"sales.salesOrder.salsePerson")),e.Y8G("items",n.salesPersons)("multiple",!1),e.R50("ngModel",n.pagination.salesPersonId),e.R7$(3),e.FS9("placeholder",e.bMT(25,44,"sales.salesOrder.clientVisitDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.dates),e.R7$(4),e.FS9("placeholder",e.bMT(29,46,"client.client.regionName")),e.Y8G("items",n.regions)("multiple",!1),e.R50("ngModel",n.pagination.regionId),e.R7$(4),e.FS9("placeholder",e.bMT(33,48,"client.client.cityName")),e.Y8G("items",n.cities)("multiple",!1),e.R50("ngModel",n.pagination.cityId),e.R7$(4),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(5),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[m.YU,m.bT,d.qT,d.me,d.Q0,d.BC,d.cb,d.YS,d.vS,d.cV,_.s5,D.kL,A.b,Q.p,q.g,u.Mm,S.XI,z.Ei,S.Tg,S.FP,C.Cv,E.vr,X.m,U.p,ie.m,_e,fe,m.vh,u.D9],encapsulation:2})}}return r})();var Xe=c(50204);const Fr=()=>["completeOrder.print"];function Nr(r,o){1&r&&(e.j41(0,"tr",31),e.nrm(1,"th",32),e.j41(2,"th",33),e.EFF(3,"#"),e.k0s(),e.j41(4,"th",34),e.nrm(5,"i",35),e.EFF(6," orderManagement.order.orderCode "),e.k0s(),e.j41(7,"th",36),e.nrm(8,"i",35),e.EFF(9," orderManagement.order.creation "),e.k0s(),e.j41(10,"th",37),e.nrm(11,"i",35),e.EFF(12," orderManagement.order.agentName "),e.k0s(),e.j41(13,"th",38),e.EFF(14," sales.salesOrder.salsePerson "),e.k0s(),e.j41(15,"th",39),e.nrm(16,"i",35),e.EFF(17," sales.salesOrder.clientVisitDate "),e.k0s(),e.j41(18,"th",40),e.nrm(19,"i",35),e.EFF(20," sales.salesOrder.totalQuantity "),e.k0s(),e.j41(21,"th",41),e.nrm(22,"i",35),e.EFF(23," sales.salesOrder.totalDiscount "),e.k0s(),e.j41(24,"th",42),e.nrm(25,"i",35),e.EFF(26," sales.salesOrder.netPrice "),e.k0s(),e.nrm(27,"th",43),e.k0s())}function wr(r,o){1&r&&(e.j41(0,"button",51),e.nI1(1,"translate"),e.nrm(2,"i",52),e.k0s()),2&r&&e.FS9("pTooltip",e.bMT(1,1,"sales.salesOrder.printOrder"))}function Gr(r,o){if(1&r){const t=e.RV6();e.j41(0,"tr",44)(1,"td"),e.nrm(2,"button",45),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td",46),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(),l=e.sdS(50);return e.Njj(s.openModalClient(n,l,"lg"))}),e.j41(6,"bdi",47),e.EFF(7),e.k0s()(),e.j41(8,"td")(9,"span",48),e.EFF(10),e.k0s(),e.EFF(11),e.nI1(12,"date"),e.k0s(),e.j41(13,"td",46),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(),l=e.sdS(48);return e.Njj(s.openModalClient(n,l))}),e.j41(14,"span",49),e.EFF(15),e.k0s()(),e.j41(16,"td"),e.EFF(17),e.k0s(),e.j41(18,"td"),e.EFF(19),e.nI1(20,"date"),e.k0s(),e.j41(21,"td"),e.EFF(22),e.k0s(),e.j41(23,"td"),e.EFF(24),e.k0s(),e.j41(25,"td"),e.EFF(26),e.k0s(),e.j41(27,"td"),e.DNE(28,wr,3,3,"button",50),e.k0s()()}if(2&r){const t=o.$implicit,i=o.rowIndex,n=o.expanded;e.R7$(2),e.Y8G("pRowToggler",t)("ngClass",n?" ri-arrow-down-s-line":"  ri-arrow-up-s-line"),e.R7$(2),e.JRh(i+1),e.R7$(3),e.SpI("#SO#",t.id,""),e.R7$(3),e.SpI("",t.creatorName," "),e.R7$(),e.SpI(" ",e.i5U(12,13,t.creationTime,"yyyy-MM-dd")," "),e.R7$(4),e.SpI("",t.clientName," "),e.R7$(2),e.JRh(t.salsePersonName),e.R7$(2),e.SpI(" ",e.i5U(20,16,t.clientVisitDate,"yyyy-MM-dd"),""),e.R7$(3),e.JRh(t.totalQuantity),e.R7$(2),e.JRh(t.totalDiscount),e.R7$(2),e.JRh(t.netPrice),e.R7$(2),e.Y8G("hasPermission",e.lJ4(19,Fr))}}function Vr(r,o){1&r&&(e.j41(0,"tr"),e.nrm(1,"th",56)(2,"th",57)(3,"th",58)(4,"th",59)(5,"th",60)(6,"th",61)(7,"th",62),e.k0s())}function Dr(r,o){if(1&r&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td"),e.EFF(10),e.nI1(11,"translate"),e.k0s(),e.j41(12,"td"),e.EFF(13),e.k0s(),e.j41(14,"td"),e.EFF(15),e.k0s()()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t.itemName),e.R7$(2),e.JRh(t.unitName),e.R7$(2),e.JRh(t.clientQuantity),e.R7$(2),e.JRh(t.approvedQuantity),e.R7$(2),e.JRh(e.bMT(11,7,"sales.salesOrder."+t.discountTypeValue)),e.R7$(3),e.JRh(t.discount),e.R7$(2),e.JRh(t.price)}}function Er(r,o){1&r&&(e.j41(0,"tr"),e.nrm(1,"td",63),e.k0s())}function Lr(r,o){if(1&r&&(e.j41(0,"tr")(1,"td",53)(2,"div")(3,"p-table",54),e.DNE(4,Vr,8,0,"ng-template",26)(5,Dr,16,9,"ng-template",27)(6,Er,2,0,"ng-template",55),e.k0s()()()()),2&r){const t=o.$implicit;e.R7$(3),e.Y8G("value",t.offerOrderDetails)}}function $r(r,o){1&r&&(e.j41(0,"div",64),e.EFF(1," general.table.noData "),e.k0s())}function Xr(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",65)(1,"div",66),e.nrm(2,"ngb-pagination-info",67),e.j41(3,"table-length",68),e.bIt("lengthChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",69)(5,"ngb-pagination",70),e.bIt("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.pagination.pageNumber,n)||(s.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function Br(r,o){if(1&r){const t=e.RV6();e.j41(0,"form",71,7),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.SubmitOrder())}),e.nrm(2,"ngx-ui-loader",72),e.j41(3,"div",73)(4,"div",74)(5,"button",75),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"div",76)(7,"div",77),e.nrm(8,"lord-icon",78),e.j41(9,"div",79),e.nrm(10,"h3",80)(11,"p",81),e.k0s()(),e.j41(12,"div",82),e.nrm(13,"button",83),e.j41(14,"button",84),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}function Pr(r,o){if(1&r){const t=e.RV6();e.j41(0,"delete-modal",85),e.bIt("deleteConfirm",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.DeleteConfirm())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}}function Yr(r,o){}function Ur(r,o){if(1&r){const t=e.RV6();e.j41(0,"app-all-orders-details",86),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderDetails",t.orderSelected)}}function Ar(r,o){if(1&r&&e.nrm(0,"order-operation",87),2&r){const t=e.XpG();e.Y8G("isOrderEdit",t.isOrderEdit)("isInner",!0)("orderCode",t.clientSelected)}}function Qr(r,o){if(1&r){const t=e.RV6();e.j41(0,"order-timeline",88),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderSelected",t.orderSelected)}}let qr=(()=>{class r extends Y.w{constructor(t,i,n,s,l,a,f,M,R,O,w,k,v,j){super(t,i,f,n,s,l,a),this.baseService=n,this.authDaamService=M,this.workTimeService=R,this.excelService=O,this.employeeService=w,this.regionService=k,this.cityService=v,this.router=j,this.title="sales.salesOrder.completeOrder",this.titleOperation="sales.salesOrder.completeOrder",this.keySelected="",this.assignUsers=[],this.times=[],this.employees=[],this.searchForm={},this.isResolveList=!0,this.employeeTypes=[{id:1,name:"employeeTeam"},{id:2,name:"managment"},{id:3,name:"customerService"}],this.employeeGroups=[],this.activeindex="2",this.active=2,this.formPassword={},this.roles=[],this.teams=[],this.workTimes=[],this.userTypes=[],this.actives=[{id:!0,name:"active"},{id:!1,name:"noActive"}],this.clientSelected=0,this.districts=[],this.channels=[],this.status=[],this.countLoad=2,this.isOrderEdit=!1,this.orderSelected={},this.salesPersons=[],this.regions=[],this.cities=[],this.setDates=(b,h,G)=>{if(b?.from||b?.to){const L=b.to||b.from;this.pagination[h]=this.datePipe.transform(b.from||b.to,"yyyy-MM-ddT00:00:00"),this.pagination[G]=this.datePipe.transform(L,"yyyy-MM-ddT23:59:59.999")}else this.pagination[h]=null,this.pagination[G]=null},this.loadentities(),this.GetSalesPersons(),this.GetRegions(),this.GetCities()}GetRegions(){this.regionService.getDropDown().subscribe(t=>{this.regions=t.data},t=>{console.log(t)})}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetSalesPersons(){this.employeeService.GetAllByType(9).subscribe(t=>{this.salesPersons=t.data},t=>{console.log(t)})}loadentities(){this.countLoad=this.countLoad+1,(!this.isResolveList||1!==this.countLoad)&&(this.pagination.status=60,this.baseService.get(this.pagination).pipe((0,p.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader(g.a7),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader(g.a7),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}SubmitOrder(){}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,p.Q)(this.notifier)).subscribe(i=>{i?this.alertService.success():this.alertService.error("general.message."+i)},i=>{this.alertService.error()})}mapRegisterForm(t){let i={...t};return i.employeeCode=0,i}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader("allLoader"),this.setDates(t.dates,"visitDateFrom","visitDateTo"),this.setDates(t.creationDates,"creationTimeFrom","creationTimeTo"),this.loadentities()}LoadSuccess(){this.ngxLoader.stopLoader("allLoader")}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems}}configRoute(){this.routerActive.data.pipe((0,p.Q)(this.notifier)).subscribe(t=>{this.entities=t.data,this.pagination.totalItems=t.data?.totalItems},()=>{this.alertService.error()})}mapExcel(){let t=[];return this.entities.forEach(i=>{t.push({"Order Code":i.orderCode,"Created Date":i.createdDate,"City Name":i.cityName,"District Name":i.districtName?i.districtName:"--",Status:this.translateService.instant(this.getTrnslate(i)),"Agent Name":i.agentName,Mobile:i.mobile,"Channel Name":i.channelName,"Assigned To":i.teamNames,Times:i.workTimes,"Visit Date":i.visitDate,Services:i.services})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}goRegister(){this.router.navigateByUrl("/managment/order/new")}goEdit(t){this.router.navigateByUrl("/managment/order/new")}getStatus(t){return 10==t.offerOrderStatus||20==t.offerOrderStatus?"bg-warning-subtle text-warning":30==t.offerOrderStatus?"bg-success-subtle text-success":40==t.offerOrderStatus?"bg-danger-subtle text-danger":50==t.offerOrderStatus?"bg-danger-success text-success":"bg-warning-subtle text-warning"}checkEdit(t){return!t.isCancel&&!t.isFinish}getTrnslate(t){return t.isCancel?"orderManagement.order.cancel":t.isFinish?"orderManagement.order.finish":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen?"orderManagement.order.reopen":t.isAssign?"orderManagement.order.assign":t.isConfirmed?"orderManagement.order.confirmed":t.isFree?"orderManagement.order.free":"orderManagement.order.new"}openModalClient(t,i,n="xl"){this.clientSelected=t.orderCode,this.orderSelected=t,this.isOrderEdit=!1,this.modalService.open(i,{centered:!0,size:n})}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}openEditOrderModal(t,i,n="md"){this.form={},this.isOrderEdit=!0,this.clientSelected=t,this.modalService.open(i,{centered:!0,size:n})}OpenOrderTimeLineModel(t,i,n="md"){this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(y.nX),e.rXU(u.c$),e.rXU(P),e.rXU(V.u),e.rXU(m.vh),e.rXU(C.eD),e.rXU(_.Bq),e.rXU(ee.J),e.rXU(Te.G),e.rXU(H.V),e.rXU(Z.O),e.rXU(re.S),e.rXU(K.h),e.rXU(y.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-complete-order"]],features:[e.Vt3],decls:55,vars:49,consts:[["tableMaster",""],["SubmitOrderModal",""],["deleteModal",""],["clientProfile",""],["orderViewModel",""],["orderModel",""],["OrderTimeLineModel",""],["formEntity","ngForm"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"reset","search","exportXlsx","showAdd","showExport","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","id","name","id",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],["InputTirmFilter","","type","search","id","clientName","name","clientName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["name","regionId","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],["name","cityId","bindValue","code","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],[2,"width",".2%"],["translate","",2,"width",".5%"],["pSortableColumn","id","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["pSortableColumn","creationTime","translate","",2,"width","12%"],["pSortableColumn","clientId","translate","",2,"width","10%"],["translate","",2,"width","8%"],["pSortableColumn","clientVisitDate","translate","",2,"width","10%"],["pSortableColumn","totalQuantity","translate","",2,"width","8%"],["pSortableColumn","totalDiscount","translate","",2,"width","8%"],["pSortableColumn","netPrice","translate","",2,"width","8%"],["translate","",2,"width","5%"],[1,"fs-5"],["type","button","pRipple","",1,"border-0","p-button-text","p-button-rounded","p-button-plain",3,"pRowToggler","ngClass"],[3,"click"],[1,"code-pointer"],[1,"badge","bg-success-subtle","text-success"],[1,"badge","bg-primary-subtle","text-primary","my-1"],["class","btn btn-sm btn-warning edit-list mx-1","tooltipPosition","top",3,"pTooltip",4,"hasPermission"],["tooltipPosition","top",1,"btn","btn-sm","btn-warning","edit-list","mx-1",3,"pTooltip"],[1,"ri-printer-line","align-bottom"],["colspan","17",1,"table-detail"],["dataKey","id",3,"value"],["pTemplate","emptymessage"],["translate","sales.salesOrder.itemName",2,"width","10%"],["translate","sales.salesOrder.unit",2,"width","6%"],["translate","sales.salesOrder.clientQuantity",2,"width","8%"],["translate","sales.salesOrder.approvedQuantity",2,"width","8%"],["translate","sales.salesOrder.discountType",2,"width","5%"],["translate","sales.salesOrder.discount",2,"width","5%"],["translate","sales.salesOrder.price",2,"width","5%"],["colspan","8"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"ngSubmit"],[3,"hasProgressBar","fgsType","loaderId"],[1,"modal-content"],[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mt-2","text-center"],["src","https://cdn.lordicon.com/gdfrsvpt.json","stroke","bold","state","hover-oscillate","trigger","loop","colors","primary:#f7b84b,secondary:#f06548",2,"width","130px","height","130px"],[1,"pt-2","fs-15","mx-4","mx-sm-5"],["translate","orderManagement.order.AreYouSureMessage"],[1,"text-muted","mx-4","mb-0"],[1,"d-flex","gap-2","justify-content-center","mt-4","mb-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],[3,"deleteConfirm","dismiss"],[3,"dismiss","orderDetails"],[3,"isOrderEdit","isInner","orderCode"],[3,"dismiss","orderSelected"]],template:function(i,n){if(1&i){const s=e.RV6();e.j41(0,"div",8)(1,"div",9)(2,"div",10),e.nrm(3,"ngx-ui-loader",11),e.j41(4,"base-filter",12),e.bIt("reset",function(){return e.eBV(s),e.Njj(n.onReset())})("search",function(){return e.eBV(s),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(s),e.Njj(n.onExportXlsx())}),e.qex(5,13),e.j41(6,"div",14)(7,"div",15)(8,"input",16),e.nI1(9,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.id,a)||(n.pagination.id=a),e.Njj(a)}),e.k0s(),e.nrm(10,"i",17),e.k0s()(),e.j41(11,"div",14)(12,"input",18),e.nI1(13,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.searchForm.creationDates,a)||(n.searchForm.creationDates=a),e.Njj(a)}),e.k0s()(),e.j41(14,"div",14)(15,"div",15)(16,"input",19),e.nI1(17,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.clientName,a)||(n.pagination.clientName=a),e.Njj(a)}),e.k0s(),e.nrm(18,"i",17),e.k0s()(),e.j41(19,"div",14)(20,"div",15)(21,"ng-select",20),e.nI1(22,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.salesPersonId,a)||(n.pagination.salesPersonId=a),e.Njj(a)}),e.k0s()()(),e.j41(23,"div",14)(24,"input",18),e.nI1(25,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.searchForm.dates,a)||(n.searchForm.dates=a),e.Njj(a)}),e.k0s()(),e.j41(26,"div",14)(27,"div",15)(28,"ng-select",21),e.nI1(29,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.regionId,a)||(n.pagination.regionId=a),e.Njj(a)}),e.k0s()()(),e.j41(30,"div",14)(31,"div",15)(32,"ng-select",22),e.nI1(33,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.cityId,a)||(n.pagination.cityId=a),e.Njj(a)}),e.k0s()()(),e.bVm(),e.k0s(),e.j41(34,"div",23)(35,"div",24)(36,"p-table",25,0),e.bIt("onLazyLoad",function(a){return e.eBV(s),e.Njj(n.tableChange(a))})("selectionChange",function(a){return e.eBV(s),e.Njj(n.onSelectionChange(a))}),e.DNE(38,Nr,28,0,"ng-template",26)(39,Gr,29,20,"ng-template",27)(40,Lr,7,1,"ng-template",28),e.k0s()(),e.DNE(41,$r,2,0,"div",29)(42,Xr,6,8,"div",30),e.k0s()()()(),e.DNE(43,Br,15,3,"ng-template",null,1,e.C5r)(45,Pr,1,0,"ng-template",null,2,e.C5r)(47,Yr,0,0,"ng-template",null,3,e.C5r)(49,Ur,1,1,"ng-template",null,4,e.C5r)(51,Ar,1,3,"ng-template",null,5,e.C5r)(53,Qr,1,1,"ng-template",null,6,e.C5r)}2&i&&(e.R7$(3),e.Y8G("loaderId","CompleteLoader"),e.R7$(),e.Y8G("showAdd",!1)("showExport",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(9,35,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.id),e.R7$(4),e.FS9("placeholder",e.bMT(13,37,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(4),e.FS9("placeholder",e.bMT(17,39,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.clientName),e.R7$(5),e.FS9("placeholder",e.bMT(22,41,"sales.salesOrder.salsePerson")),e.Y8G("items",n.salesPersons)("multiple",!1),e.R50("ngModel",n.pagination.salesPersonId),e.R7$(3),e.FS9("placeholder",e.bMT(25,43,"sales.salesOrder.clientVisitDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.dates),e.R7$(4),e.FS9("placeholder",e.bMT(29,45,"client.client.regionName")),e.Y8G("items",n.regions)("multiple",!1),e.R50("ngModel",n.pagination.regionId),e.R7$(4),e.FS9("placeholder",e.bMT(33,47,"client.client.cityName")),e.Y8G("items",n.cities)("multiple",!1),e.R50("ngModel",n.pagination.cityId),e.R7$(4),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(5),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[m.YU,m.bT,d.qT,d.me,d.Q0,d.BC,d.cb,d.vS,d.cV,_.s5,D.kL,A.b,Xe.L,te.w,Q.p,q.g,u.Mm,S.XI,z.Ei,S.Tg,S.FP,C.Cv,E.vr,X.m,U.p,ie.m,m.vh,u.D9],encapsulation:2})}}return r})();function zr(r,o){1&r&&(e.j41(0,"tr",31),e.nrm(1,"th",32),e.j41(2,"th",33),e.EFF(3,"#"),e.k0s(),e.j41(4,"th",34),e.nrm(5,"i",35),e.EFF(6," orderManagement.order.orderCode "),e.k0s(),e.j41(7,"th",36),e.nrm(8,"i",35),e.EFF(9," orderManagement.order.creation "),e.k0s(),e.j41(10,"th",37),e.nrm(11,"i",35),e.EFF(12," orderManagement.order.agentName "),e.k0s(),e.j41(13,"th",38),e.nrm(14,"i",35),e.EFF(15," sales.salesOrder.clientVisitDate "),e.k0s(),e.j41(16,"th",39),e.nrm(17,"i",35),e.EFF(18," sales.salesOrder.totalQuantity "),e.k0s(),e.j41(19,"th",40),e.nrm(20,"i",35),e.EFF(21," sales.salesOrder.totalDiscount "),e.k0s(),e.j41(22,"th",41),e.nrm(23,"i",35),e.EFF(24," sales.salesOrder.netPrice "),e.k0s(),e.j41(25,"th",42),e.nrm(26,"i",35),e.EFF(27," sales.salesOrder.cancelReasonName "),e.k0s()())}function Hr(r,o){if(1&r){const t=e.RV6();e.j41(0,"tr",43)(1,"td"),e.nrm(2,"button",44),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td",45),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(),l=e.sdS(50);return e.Njj(s.openModalClient(n,l,"lg"))}),e.j41(6,"bdi",46),e.EFF(7),e.k0s()(),e.j41(8,"td")(9,"span",47),e.EFF(10),e.k0s(),e.EFF(11),e.nI1(12,"date"),e.k0s(),e.j41(13,"td")(14,"span",48),e.EFF(15),e.k0s()(),e.j41(16,"td"),e.EFF(17),e.nI1(18,"date"),e.k0s(),e.j41(19,"td"),e.EFF(20),e.k0s(),e.j41(21,"td"),e.EFF(22),e.k0s(),e.j41(23,"td"),e.EFF(24),e.k0s(),e.j41(25,"td")(26,"span",49),e.EFF(27),e.k0s()()()}if(2&r){const t=o.$implicit,i=o.rowIndex,n=o.expanded;e.R7$(2),e.Y8G("pRowToggler",t)("ngClass",n?" ri-arrow-down-s-line":"  ri-arrow-up-s-line"),e.R7$(2),e.JRh(i+1),e.R7$(3),e.SpI("#SO#",t.id,""),e.R7$(3),e.SpI("",t.creatorName," "),e.R7$(),e.SpI(" ",e.i5U(12,12,t.creationTime,"yyyy-MM-dd")," "),e.R7$(4),e.SpI("",t.clientName," "),e.R7$(2),e.SpI(" ",e.i5U(18,15,t.acutalVisitDate,"yyyy-MM-dd"),""),e.R7$(3),e.JRh(t.totalQuantity),e.R7$(2),e.JRh(t.totalDiscount),e.R7$(2),e.JRh(t.netPrice),e.R7$(3),e.SpI("",t.cancelReasonName," ")}}function Jr(r,o){1&r&&(e.j41(0,"tr"),e.nrm(1,"th",54)(2,"th",55)(3,"th",56)(4,"th",57)(5,"th",58)(6,"th",59)(7,"th",60),e.k0s())}function Kr(r,o){if(1&r&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td"),e.EFF(10),e.nI1(11,"translate"),e.k0s(),e.j41(12,"td"),e.EFF(13),e.k0s(),e.j41(14,"td"),e.EFF(15),e.k0s()()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t.itemName),e.R7$(2),e.JRh(t.unitName),e.R7$(2),e.JRh(t.clientQuantity),e.R7$(2),e.JRh(t.approvedQuantity),e.R7$(2),e.JRh(e.bMT(11,7,"sales.salesOrder."+t.discountTypeValue)),e.R7$(3),e.JRh(t.discount),e.R7$(2),e.JRh(t.price)}}function Zr(r,o){1&r&&(e.j41(0,"tr"),e.nrm(1,"td",61),e.k0s())}function Wr(r,o){if(1&r&&(e.j41(0,"tr")(1,"td",50)(2,"div",51)(3,"p-table",52),e.DNE(4,Jr,8,0,"ng-template",26)(5,Kr,16,9,"ng-template",27)(6,Zr,2,0,"ng-template",53),e.k0s()()()()),2&r){const t=o.$implicit;e.R7$(3),e.Y8G("value",t.offerOrderDetails)}}function es(r,o){1&r&&(e.j41(0,"div",62),e.EFF(1," general.table.noData "),e.k0s())}function ts(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",63)(1,"div",64),e.nrm(2,"ngb-pagination-info",65),e.j41(3,"table-length",66),e.bIt("lengthChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",67)(5,"ngb-pagination",68),e.bIt("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.pagination.pageNumber,n)||(s.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function ns(r,o){if(1&r){const t=e.RV6();e.j41(0,"form",69,7),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.SubmitOrder())}),e.nrm(2,"ngx-ui-loader",70),e.j41(3,"div",71)(4,"div",72)(5,"button",73),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"div",74)(7,"div",75),e.nrm(8,"lord-icon",76),e.j41(9,"div",77),e.nrm(10,"h3",78)(11,"p",79),e.k0s()(),e.j41(12,"div",80),e.nrm(13,"button",81),e.j41(14,"button",82),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}function is(r,o){if(1&r){const t=e.RV6();e.j41(0,"delete-modal",83),e.bIt("deleteConfirm",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.DeleteConfirm())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}}function rs(r,o){}function ss(r,o){if(1&r){const t=e.RV6();e.j41(0,"app-all-orders-details",84),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderDetails",t.orderSelected)}}function as(r,o){if(1&r&&e.nrm(0,"order-operation",85),2&r){const t=e.XpG();e.Y8G("isOrderEdit",t.isOrderEdit)("isInner",!0)("orderCode",t.clientSelected)}}function os(r,o){if(1&r){const t=e.RV6();e.j41(0,"order-timeline",86),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderSelected",t.orderSelected)}}let ls=(()=>{class r extends Y.w{constructor(t,i,n,s,l,a,f,M,R,O,w,k,v,j){super(t,i,f,n,s,l,a),this.baseService=n,this.authDaamService=M,this.excelService=R,this.employeeService=O,this.channelService=w,this.regionService=k,this.cityService=v,this.router=j,this.title="sales.salesOrder.cancelOrder",this.titleOperation="sales.salesOrder.cancelOrder",this.keySelected="",this.employees=[],this.isResolveList=!0,this.activeindex="2",this.active=2,this.clientSelected=0,this.status=[],this.countLoad=2,this.isOrderEdit=!1,this.orderSelected={},this.users=[],this.salesPersons=[],this.searchForm={},this.regions=[],this.cities=[],this.setDates=(b,h,G)=>{if(b?.from||b?.to){const L=b.to||b.from;this.pagination[h]=this.datePipe.transform(b.from||b.to,"yyyy-MM-ddT00:00:00"),this.pagination[G]=this.datePipe.transform(L,"yyyy-MM-ddT23:59:59.999")}else this.pagination[h]=null,this.pagination[G]=null},this.loadentities(),this.GetSalesPersons(),this.GetRegions(),this.GetCities()}GetRegions(){this.regionService.getDropDown().subscribe(t=>{this.regions=t.data},t=>{console.log(t)})}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}loadentities(){this.countLoad=this.countLoad+1,(!this.isResolveList||1!==this.countLoad)&&(this.pagination.status=40,this.baseService.get(this.pagination).pipe((0,p.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader(g.a7),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader(g.a7),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}SubmitOrder(){}GetSalesPersons(){this.employeeService.GetAllByType(9).subscribe(t=>{this.salesPersons=t.data},t=>{console.log(t)})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,p.Q)(this.notifier)).subscribe(i=>{i?this.alertService.success():this.alertService.error("general.message."+i)},i=>{this.alertService.error()})}mapRegisterForm(t){let i={...t};return i.employeeCode=0,i}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader("allLoader"),this.setDates(t.dates,"visitDateFrom","visitDateTo"),this.setDates(t.creationDates,"creationTimeFrom","creationTimeTo"),this.loadentities()}LoadSuccess(){this.ngxLoader.stopLoader("allLoader")}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems}}configRoute(){this.routerActive.data.pipe((0,p.Q)(this.notifier)).subscribe(t=>{this.entities=t.data,this.pagination.totalItems=t.data?.totalItems},()=>{this.alertService.error()})}mapExcel(){let t=[];return this.entities.forEach(i=>{t.push({})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}goRegister(){this.router.navigateByUrl("/managment/order/new")}goEdit(t){this.router.navigateByUrl("/managment/order/new")}getStatus(t){return 10==t.offerOrderStatus||5==t.offerOrderStatus||20==t.offerOrderStatus?"bg-warning-subtle text-warning":30==t.offerOrderStatus?"bg-success-subtle text-success":40==t.offerOrderStatus?"bg-danger-subtle text-danger":50==t.offerOrderStatus?"bg-danger-success text-success":"bg-warning-subtle text-warning"}checkEdit(t){return!t.isCancel&&!t.isFinish}openModalClient(t,i,n="xl"){this.clientSelected=t.orderCode,this.orderSelected=t,this.isOrderEdit=!1,this.modalService.open(i,{centered:!0,size:n})}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}openEditOrderModal(t,i,n="md"){this.form={},this.isOrderEdit=!0,this.clientSelected=t,this.modalService.open(i,{centered:!0,size:n})}OpenOrderTimeLineModel(t,i,n="md"){this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(y.nX),e.rXU(u.c$),e.rXU(P),e.rXU(V.u),e.rXU(m.vh),e.rXU(C.eD),e.rXU(_.Bq),e.rXU(ee.J),e.rXU(H.V),e.rXU(Z.O),e.rXU(xe.l),e.rXU(re.S),e.rXU(K.h),e.rXU(y.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-cancel-order"]],features:[e.Vt3],decls:55,vars:49,consts:[["tableMaster",""],["SubmitOrderModal",""],["deleteModal",""],["clientProfile",""],["orderViewModel",""],["orderModel",""],["OrderTimeLineModel",""],["formEntity","ngForm"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"reset","search","exportXlsx","showAdd","showExport","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","id","name","id",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],["InputTirmFilter","","type","search","id","clientName","name","clientName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["name","regionId","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],["name","cityId","bindValue","code","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],[2,"width",".2%"],["translate","",2,"width",".5%"],["pSortableColumn","id","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["pSortableColumn","creationTime","translate","",2,"width","12%"],["pSortableColumn","clientId","translate","",2,"width","10%"],["pSortableColumn","clientVisitDate","translate","",2,"width","10%"],["pSortableColumn","totalQuantity","translate","",2,"width","8%"],["pSortableColumn","totalDiscount","translate","",2,"width","8%"],["pSortableColumn","netPrice","translate","",2,"width","8%"],["pSortableColumn","cancelReasonName","translate","",2,"width","15%"],[1,"fs-5"],["type","button","pRipple","",1,"border-0","p-button-text","p-button-rounded","p-button-plain",3,"pRowToggler","ngClass"],[3,"click"],[1,"code-pointer"],[1,"badge","bg-success-subtle","text-success"],[1,"badge","bg-primary-subtle","text-primary","my-1"],[1,"badge","bg-danger-subtle","text-danger"],["colspan","17"],[1,"table-detail"],["dataKey","id",3,"value"],["pTemplate","emptymessage"],["translate","sales.salesOrder.itemName",2,"width","10%"],["translate","sales.salesOrder.unit",2,"width","6%"],["translate","sales.salesOrder.clientQuantity",2,"width","8%"],["translate","sales.salesOrder.approvedQuantity",2,"width","8%"],["translate","sales.salesOrder.discountType",2,"width","5%"],["translate","sales.salesOrder.discount",2,"width","5%"],["translate","sales.salesOrder.price",2,"width","5%"],["colspan","8"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"ngSubmit"],[3,"hasProgressBar","fgsType","loaderId"],[1,"modal-content"],[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mt-2","text-center"],["src","https://cdn.lordicon.com/gdfrsvpt.json","stroke","bold","state","hover-oscillate","trigger","loop","colors","primary:#f7b84b,secondary:#f06548",2,"width","130px","height","130px"],[1,"pt-2","fs-15","mx-4","mx-sm-5"],["translate","orderManagement.order.AreYouSureMessage"],[1,"text-muted","mx-4","mb-0"],[1,"d-flex","gap-2","justify-content-center","mt-4","mb-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],[3,"deleteConfirm","dismiss"],[3,"dismiss","orderDetails"],[3,"isOrderEdit","isInner","orderCode"],[3,"dismiss","orderSelected"]],template:function(i,n){if(1&i){const s=e.RV6();e.j41(0,"div",8)(1,"div",9)(2,"div",10),e.nrm(3,"ngx-ui-loader",11),e.j41(4,"base-filter",12),e.bIt("reset",function(){return e.eBV(s),e.Njj(n.onReset())})("search",function(){return e.eBV(s),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(s),e.Njj(n.onExportXlsx())}),e.qex(5,13),e.j41(6,"div",14)(7,"div",15)(8,"input",16),e.nI1(9,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.id,a)||(n.pagination.id=a),e.Njj(a)}),e.k0s(),e.nrm(10,"i",17),e.k0s()(),e.j41(11,"div",14)(12,"input",18),e.nI1(13,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.searchForm.creationDates,a)||(n.searchForm.creationDates=a),e.Njj(a)}),e.k0s()(),e.j41(14,"div",14)(15,"div",15)(16,"input",19),e.nI1(17,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.clientName,a)||(n.pagination.clientName=a),e.Njj(a)}),e.k0s(),e.nrm(18,"i",17),e.k0s()(),e.j41(19,"div",14)(20,"div",15)(21,"ng-select",20),e.nI1(22,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.salesPersonId,a)||(n.pagination.salesPersonId=a),e.Njj(a)}),e.k0s()()(),e.j41(23,"div",14)(24,"input",18),e.nI1(25,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.searchForm.dates,a)||(n.searchForm.dates=a),e.Njj(a)}),e.k0s()(),e.j41(26,"div",14)(27,"div",15)(28,"ng-select",21),e.nI1(29,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.regionId,a)||(n.pagination.regionId=a),e.Njj(a)}),e.k0s()()(),e.j41(30,"div",14)(31,"div",15)(32,"ng-select",22),e.nI1(33,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.cityId,a)||(n.pagination.cityId=a),e.Njj(a)}),e.k0s()()(),e.bVm(),e.k0s(),e.j41(34,"div",23)(35,"div",24)(36,"p-table",25,0),e.bIt("onLazyLoad",function(a){return e.eBV(s),e.Njj(n.tableChange(a))})("selectionChange",function(a){return e.eBV(s),e.Njj(n.onSelectionChange(a))}),e.DNE(38,zr,28,0,"ng-template",26)(39,Hr,28,18,"ng-template",27)(40,Wr,7,1,"ng-template",28),e.k0s()(),e.DNE(41,es,2,0,"div",29)(42,ts,6,8,"div",30),e.k0s()()()(),e.DNE(43,ns,15,3,"ng-template",null,1,e.C5r)(45,is,1,0,"ng-template",null,2,e.C5r)(47,rs,0,0,"ng-template",null,3,e.C5r)(49,ss,1,1,"ng-template",null,4,e.C5r)(51,as,1,3,"ng-template",null,5,e.C5r)(53,os,1,1,"ng-template",null,6,e.C5r)}2&i&&(e.R7$(3),e.Y8G("loaderId","cancelLoader"),e.R7$(),e.Y8G("showAdd",!1)("showExport",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(9,35,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.id),e.R7$(4),e.FS9("placeholder",e.bMT(13,37,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(4),e.FS9("placeholder",e.bMT(17,39,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.clientName),e.R7$(5),e.FS9("placeholder",e.bMT(22,41,"sales.salesOrder.salsePerson")),e.Y8G("items",n.salesPersons)("multiple",!1),e.R50("ngModel",n.pagination.salesPersonId),e.R7$(3),e.FS9("placeholder",e.bMT(25,43,"sales.salesOrder.clientVisitDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.dates),e.R7$(4),e.FS9("placeholder",e.bMT(29,45,"client.client.regionName")),e.Y8G("items",n.regions)("multiple",!1),e.R50("ngModel",n.pagination.regionId),e.R7$(4),e.FS9("placeholder",e.bMT(33,47,"client.client.cityName")),e.Y8G("items",n.cities)("multiple",!1),e.R50("ngModel",n.pagination.cityId),e.R7$(4),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(5),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[m.YU,m.bT,d.qT,d.me,d.Q0,d.BC,d.cb,d.vS,d.cV,_.s5,D.kL,A.b,Xe.L,te.w,Q.p,q.g,u.Mm,S.XI,z.Ei,S.Tg,S.FP,C.Cv,E.vr,X.m,m.vh,u.D9],encapsulation:2})}}return r})();const ds=()=>["salesOrder.register"],cs=()=>["orderDraft.newOrder"],ms=()=>["orderDraft.edit"],ps=()=>["orderDraft.cancel"];function gs(r,o){1&r&&(e.j41(0,"tr",27),e.nrm(1,"th",28),e.j41(2,"th",29),e.EFF(3,"#"),e.k0s(),e.j41(4,"th",30),e.nrm(5,"i",31),e.EFF(6," orderManagement.order.orderCode "),e.k0s(),e.j41(7,"th",32),e.nrm(8,"i",31),e.EFF(9," orderManagement.order.creation "),e.k0s(),e.j41(10,"th",33),e.nrm(11,"i",31),e.EFF(12," orderManagement.order.agentName "),e.k0s(),e.j41(13,"th",34),e.EFF(14," sales.salesOrder.salsePerson "),e.k0s(),e.j41(15,"th",35),e.nrm(16,"i",31),e.EFF(17," sales.salesOrder.clientVisitDate "),e.k0s(),e.j41(18,"th",36),e.nrm(19,"i",31),e.EFF(20," sales.salesOrder.totalQuantity "),e.k0s(),e.j41(21,"th",37),e.nrm(22,"i",31),e.EFF(23," sales.salesOrder.totalDiscount "),e.k0s(),e.j41(24,"th",38),e.EFF(25," orderManagement.order.totalTax "),e.k0s(),e.j41(26,"th",39),e.nrm(27,"i",31),e.EFF(28," sales.salesOrder.netPrice "),e.k0s(),e.nrm(29,"th",40),e.k0s())}function _s(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",54),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,s=e.XpG(),l=e.sdS(36);return e.Njj(s.openStatusModal(n.id,l,10,"md"))}),e.nrm(2,"i",55),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"sales.salesOrder.sendApproval"))}function us(r,o){if(1&r){const t=e.RV6();e.j41(0,"li",45),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,s=e.XpG(),l=e.sdS(38);return e.Njj(s.openModal(n.id,l,"xl"))}),e.j41(1,"span",56),e.nrm(2,"i",57)(3,"span",58),e.k0s()()}}function hs(r,o){if(1&r){const t=e.RV6();e.j41(0,"li",45),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,s=e.XpG(),l=e.sdS(32);return e.Njj(s.openModal(n.id,l))}),e.j41(1,"span",56),e.nrm(2,"i",59)(3,"span",60),e.k0s()()}}function fs(r,o){if(1&r){const t=e.RV6();e.j41(0,"tr",41)(1,"td"),e.nrm(2,"button",42),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td")(6,"bdi",43),e.EFF(7),e.k0s()(),e.j41(8,"td")(9,"span",44),e.EFF(10),e.k0s(),e.EFF(11),e.nI1(12,"date"),e.k0s(),e.j41(13,"td",45),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(),l=e.sdS(40);return e.Njj(s.openModal(n.clientId,l,"md"))}),e.j41(14,"a",46),e.EFF(15),e.k0s()(),e.j41(16,"td"),e.EFF(17),e.k0s(),e.j41(18,"td"),e.EFF(19),e.nI1(20,"date"),e.k0s(),e.j41(21,"td"),e.EFF(22),e.k0s(),e.j41(23,"td"),e.EFF(24),e.k0s(),e.j41(25,"td"),e.EFF(26),e.k0s(),e.j41(27,"td"),e.EFF(28),e.k0s(),e.j41(29,"td")(30,"div",47),e.DNE(31,_s,3,3,"button",48),e.j41(32,"span",47)(33,"div",49)(34,"button",50),e.nrm(35,"i",51),e.k0s(),e.j41(36,"ul",52),e.DNE(37,us,4,0,"li",53)(38,hs,4,0,"li",53),e.k0s()()()()()()}if(2&r){const t=o.$implicit,i=o.rowIndex,n=o.expanded;e.R7$(2),e.Y8G("pRowToggler",t)("ngClass",n?" ri-arrow-down-s-line":"  ri-arrow-up-s-line"),e.R7$(2),e.JRh(i+1),e.R7$(3),e.SpI("#DO#",t.id,""),e.R7$(3),e.SpI("",t.creatorName," "),e.R7$(),e.SpI(" ",e.i5U(12,16,t.creationTime,"yyyy-MM-dd HH:mm")," "),e.R7$(4),e.SpI(" ",t.clientName," "),e.R7$(2),e.JRh(t.salsePersonName),e.R7$(2),e.SpI(" ",e.i5U(20,19,t.acutalVisitDate,"yyyy-MM-dd HH:mm"),""),e.R7$(3),e.JRh(t.totalQuantity),e.R7$(2),e.JRh(t.totalDiscount),e.R7$(2),e.JRh(t.totalTax),e.R7$(2),e.JRh(t.netPrice),e.R7$(3),e.Y8G("hasPermission",e.lJ4(22,cs)),e.R7$(6),e.Y8G("hasPermission",e.lJ4(23,ms)),e.R7$(),e.Y8G("hasPermission",e.lJ4(24,ps))}}function bs(r,o){1&r&&(e.j41(0,"tr"),e.nrm(1,"th",65)(2,"th",66)(3,"th",67)(4,"th",68)(5,"th",69)(6,"th",70)(7,"th",71),e.k0s())}function Cs(r,o){if(1&r&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td")(8,"span"),e.EFF(9),e.k0s()(),e.j41(10,"td"),e.EFF(11),e.nI1(12,"translate"),e.k0s(),e.j41(13,"td"),e.EFF(14),e.k0s(),e.j41(15,"td"),e.EFF(16),e.k0s()()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t.itemName),e.R7$(2),e.JRh(t.unitName),e.R7$(2),e.JRh(t.clientQuantity),e.R7$(3),e.JRh(t.approvedQuantity),e.R7$(2),e.JRh(e.bMT(12,7,"sales.salesOrder."+t.discountTypeValue)),e.R7$(3),e.SpI(" ",t.discount," "),e.R7$(2),e.JRh(t.price)}}function Ss(r,o){1&r&&(e.j41(0,"tr"),e.nrm(1,"td",72),e.k0s())}function vs(r,o){if(1&r&&(e.j41(0,"tr")(1,"td",61)(2,"div",62)(3,"p-table",63),e.DNE(4,bs,8,0,"ng-template",22)(5,Cs,17,9,"ng-template",23)(6,Ss,2,0,"ng-template",64),e.k0s()()()()),2&r){const t=o.$implicit;e.R7$(3),e.Y8G("value",t.offerOrderDetails)}}function js(r,o){1&r&&(e.j41(0,"div",73),e.EFF(1," general.table.noData "),e.k0s())}function Is(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",74)(1,"div",75),e.nrm(2,"ngb-pagination-info",76),e.j41(3,"table-length",77),e.bIt("lengthChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",78)(5,"ngb-pagination",79),e.bIt("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.pagination.pageNumber,n)||(s.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function ys(r,o){if(1&r){const t=e.RV6();e.j41(0,"cancel-sales-model",80),e.bIt("success",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.successCancel())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderId",t.orderSelected)}}function ks(r,o){if(1&r){const t=e.RV6();e.j41(0,"order-timeline",81),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderSelected",t.orderSelected)}}function Ts(r,o){if(1&r){const t=e.RV6();e.j41(0,"form",82,6),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.SubmitOrder())}),e.nrm(2,"ngx-ui-loader",83),e.j41(3,"div",84)(4,"div",85)(5,"button",86),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"div",87)(7,"div",88),e.nrm(8,"lord-icon",89),e.j41(9,"div",90),e.nrm(10,"h3",91)(11,"p",92),e.k0s()(),e.j41(12,"div",93),e.nrm(13,"button",94),e.j41(14,"button",95),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}function xs(r,o){if(1&r){const t=e.RV6();e.j41(0,"sales-edit-order",96),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("isChangeQuantity",!0)("isDraft",!0)("orderSelected",t.orderSelected)}}function Ms(r,o){if(1&r){const t=e.RV6();e.j41(0,"client-summary",97),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("clientId",t.orderSelected)}}let Rs=(()=>{class r extends Y.w{constructor(t,i,n,s,l,a,f,M,R,O,w,k,v,j,b){super(t,i,f,n,s,l,a),this.baseService=n,this.authDaamService=M,this.teamService=R,this.workTimeService=O,this.excelService=w,this.cityService=k,this.districtService=v,this.channelService=j,this.router=b,this.title="sales.salesOrder.draftOrder",this.titleOperation="sales.salesOrder.draftOrder",this.keySelected="",this.assignUsers=[],this.times=[],this.employees=[],this.searchForm={},this.isResolveList=!0,this.employeeTypes=[{id:1,name:"employeeTeam"},{id:2,name:"managment"},{id:3,name:"customerService"}],this.employeeGroups=[],this.activeindex="2",this.active=2,this.formPassword={},this.roles=[],this.teams=[],this.workTimes=[],this.userTypes=[],this.actives=[{id:!0,name:"active"},{id:!1,name:"noActive"}],this.clientSelected=0,this.cities=[],this.districts=[],this.channels=[],this.status=[],this.countLoad=2,this.isOrderEdit=!1,this.orderSelected={},this.users=[],this.truncks=[],this.setDates=(h,G,F)=>{if(h?.from||h?.to){const W=h.to||h.from;this.pagination[G]=this.datePipe.transform(h.from||h.to,"yyyy-MM-ddT00:00:00"),this.pagination[F]=this.datePipe.transform(W,"yyyy-MM-ddT23:59:59.999")}else this.pagination[G]=null,this.pagination[F]=null},this.loadentities()}loadentities(){this.countLoad=this.countLoad+1,(!this.isResolveList||1!==this.countLoad)&&(this.pagination.status=0,this.baseService.get(this.pagination).pipe((0,p.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader(g.a7),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader(g.a7),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}openModal(t,i,n="md"){this.isOrderEdit=!1,this.form={},this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}SubmitOrder(){this.ngxLoader.startLoader(g.Fq),this.baseService.changStatus({id:this.form.id,status:this.form.status}).pipe((0,T.O)(),(0,N.c)(this.mainDelay),(0,x.Z)(),(0,p.Q)(this.notifier),(0,I.j)(()=>this.ngxLoader.stopLoader(g.Fq))).subscribe({next:i=>{this.modalService.dismissAll(),this.loadentities(),this.baseService.GetOrderCountSource.next(!0),this.alertService.success()}})}cancelOrder(){this.ngxLoader.startLoader(g.Fq),console.log(this.operationId),this.baseService.changStatus({id:this.operationId,status:40}).pipe((0,T.O)(),(0,N.c)(this.mainDelay),(0,x.Z)(),(0,p.Q)(this.notifier),(0,I.j)(()=>this.ngxLoader.stopLoader(g.Fq))).subscribe({next:i=>{this.modalService.dismissAll(),this.loadentities(),this.alertService.success()}})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,p.Q)(this.notifier)).subscribe(i=>{i?this.alertService.success():this.alertService.error("general.message."+i)},i=>{this.alertService.error()})}mapRegisterForm(t){let i={...t};return i.employeeCode=0,i}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader("allLoader"),this.setDates(t.dates,"visitDateFrom","visitDateTo"),this.setDates(t.creationDates,"creationTimeFrom","creationTimeTo"),this.loadentities()}LoadSuccess(){this.ngxLoader.stopLoader("allLoader")}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems}}configRoute(){this.routerActive.data.pipe((0,p.Q)(this.notifier)).subscribe(t=>{this.entities=t.data,this.pagination.totalItems=t.data?.totalItems},()=>{this.alertService.error()})}mapExcel(){let t=[];return this.entities.forEach(i=>{t.push({"Order Code":i.orderCode,"Created Date":i.createdDate,"City Name":i.cityName,"District Name":i.districtName?i.districtName:"--","Agent Name":i.agentName,Mobile:i.mobile,"Channel Name":i.channelName,"Assigned To":i.teamNames,Times:i.workTimes,"Visit Date":i.visitDate,Services:i.services})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}goRegister(){this.router.navigateByUrl("/managment/order/new")}goEdit(t){this.router.navigateByUrl("/managment/order/new")}getStatus(t){return 10==t.offerOrderStatus||20==t.offerOrderStatus?"bg-warning-subtle text-warning":30==t.offerOrderStatus?"bg-success-subtle text-success":40==t.offerOrderStatus?"bg-danger-subtle text-danger":50==t.offerOrderStatus?"bg-danger-success text-success":"bg-warning-subtle text-warning"}checkEdit(t){return!t.isCancel&&!t.isFinish}openStatusModal(t,i,n,s="md"){this.isEditForm=!1,this.form={},this.form={id:t,status:n},this.modalService.open(i,{centered:!0,size:s})}openModalClient(t,i,n="xl"){this.clientSelected=t.orderCode,this.form=t,this.isOrderEdit=!1,this.modalService.open(i,{centered:!0,size:n})}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}openEditOrderModal(t,i,n="md"){this.form={},this.isOrderEdit=!0,this.clientSelected=t,this.modalService.open(i,{centered:!0,size:n})}OpenOrderTimeLineModel(t,i,n="md"){this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}successCancel(){this.baseService.GetOrderCountSource.next(!0),this.loadentities()}goNew(){this.router.navigateByUrl("/sales/new")}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(y.nX),e.rXU(u.c$),e.rXU(P),e.rXU(V.u),e.rXU(m.vh),e.rXU(C.eD),e.rXU(_.Bq),e.rXU(ee.J),e.rXU(ge.n),e.rXU(Te.G),e.rXU(H.V),e.rXU(K.h),e.rXU(Ne.m),e.rXU(xe.l),e.rXU(y.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["draft-order"]],features:[e.Vt3],decls:41,vars:34,consts:[["tableMaster",""],["deleteModal",""],["OrderTimeLineModel",""],["StatusOrderModal",""],["SalesEditModel",""],["ClientInfo",""],["formEntity","ngForm"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"addNew","reset","search","exportXlsx","addPermission","showAdd","showExport","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","id","name","id",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","search","id","clientName","name","clientName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],[2,"width",".2%"],["translate","",2,"width",".5%"],["pSortableColumn","id","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["pSortableColumn","creationTime","translate","",2,"width","12%"],["pSortableColumn","clientId","translate","",2,"width","10%"],["translate","",2,"width","8%"],["pSortableColumn","clientVisitDate","translate","",2,"width","8%"],["pSortableColumn","totalQuantity","translate","",2,"width","8%"],["pSortableColumn","totalDiscount","translate","",2,"width","7%"],["translate","",2,"width","6%"],["pSortableColumn","netPrice","translate","",2,"width","6%"],["translate","",2,"width","10%"],[1,"fs-5"],["type","button","pRipple","",1,"border-0","p-button-text","p-button-rounded","p-button-plain",3,"pRowToggler","ngClass"],[1,"code-pointer"],[1,"badge","bg-success-subtle","text-success"],[3,"click"],["href","javascript:void(0)",1,"link-primary","link-offset-2","text-decoration-underline","link-underline-opacity-25","link-underline-opacity-100-hover"],[1,"d-inline-block"],["class","btn btn-sm btn-warning edit-list mx-1","tooltipPosition","top",3,"pTooltip","click",4,"hasPermission"],[1,"dropdown-custom","d-inline-block"],["type","button",1,"btn","dropbtn","btn-soft-secondary","btn-sm","dropdown-custom","arrow-none"],[1,"ri-more-fill"],[1,"dropdown-menu","dropdown-menu-end","dropdown-content",2,"left","0"],[3,"click",4,"hasPermission"],["tooltipPosition","top",1,"btn","btn-sm","btn-warning","edit-list","mx-1",3,"click","pTooltip"],[1,"ri-checkbox-fill","align-bottom"],[1,"dropdown-item"],[1,"text-success","ri-pencil-fill","align-bottom","me-2"],["translate","general.action.edit"],[1,"text-danger","ri-close-fill","align-bottom","me-2"],["translate","general.action.cancel"],["colspan","17"],[1,"table-detail"],["dataKey","id",3,"value"],["pTemplate","emptymessage"],["translate","sales.salesOrder.itemName",2,"width","10%"],["translate","sales.salesOrder.unit",2,"width","6%"],["translate","sales.salesOrder.clientQuantity",2,"width","8%"],["translate","sales.salesOrder.approvedQuantity",2,"width","8%"],["translate","sales.salesOrder.discountType",2,"width","5%"],["translate","sales.salesOrder.discount",2,"width","5%"],["translate","sales.salesOrder.price",2,"width","5%"],["colspan","8"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"success","dismiss","orderId"],[3,"dismiss","orderSelected"],[3,"ngSubmit"],[3,"hasProgressBar","fgsType","loaderId"],[1,"modal-content"],[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mt-2","text-center"],["src","https://cdn.lordicon.com/gdfrsvpt.json","stroke","bold","state","hover-oscillate","trigger","loop","colors","primary:#f7b84b,secondary:#f06548",2,"width","130px","height","130px"],[1,"pt-2","fs-15","mx-4","mx-sm-5"],["translate","orderManagement.order.AreYouSureMessage"],[1,"text-muted","mx-4","mb-0"],[1,"d-flex","gap-2","justify-content-center","mt-4","mb-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],[3,"dismiss","isChangeQuantity","isDraft","orderSelected"],[3,"dismiss","clientId"]],template:function(i,n){if(1&i){const s=e.RV6();e.j41(0,"div",7)(1,"div",8)(2,"div",9),e.nrm(3,"ngx-ui-loader",10),e.j41(4,"base-filter",11),e.bIt("addNew",function(){return e.eBV(s),e.Njj(n.goNew())})("reset",function(){return e.eBV(s),e.Njj(n.onReset())})("search",function(){return e.eBV(s),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(s),e.Njj(n.onExportXlsx())}),e.qex(5,12),e.j41(6,"div",13)(7,"div",14)(8,"input",15),e.nI1(9,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.id,a)||(n.pagination.id=a),e.Njj(a)}),e.k0s(),e.nrm(10,"i",16),e.k0s()(),e.j41(11,"div",13)(12,"div",14)(13,"input",17),e.nI1(14,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.clientName,a)||(n.pagination.clientName=a),e.Njj(a)}),e.k0s(),e.nrm(15,"i",16),e.k0s()(),e.j41(16,"div",13)(17,"input",18),e.nI1(18,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.searchForm.dates,a)||(n.searchForm.dates=a),e.Njj(a)}),e.k0s()(),e.j41(19,"div",13)(20,"input",18),e.nI1(21,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.searchForm.creationDates,a)||(n.searchForm.creationDates=a),e.Njj(a)}),e.k0s()(),e.bVm(),e.k0s(),e.j41(22,"div",19)(23,"div",20)(24,"p-table",21,0),e.bIt("onLazyLoad",function(a){return e.eBV(s),e.Njj(n.tableChange(a))})("selectionChange",function(a){return e.eBV(s),e.Njj(n.onSelectionChange(a))}),e.DNE(26,gs,30,0,"ng-template",22)(27,fs,39,25,"ng-template",23)(28,vs,7,1,"ng-template",24),e.k0s()(),e.DNE(29,js,2,0,"div",25)(30,Is,6,8,"div",26),e.k0s()()(),e.DNE(31,ys,1,1,"ng-template",null,1,e.C5r)(33,ks,1,1,"ng-template",null,2,e.C5r)(35,Ts,15,3,"ng-template",null,3,e.C5r)(37,xs,1,3,"ng-template",null,4,e.C5r)(39,Ms,1,1,"ng-template",null,5,e.C5r),e.k0s()}2&i&&(e.R7$(3),e.Y8G("loaderId","sureLoader"),e.R7$(),e.Y8G("addPermission",e.lJ4(33,ds))("showAdd",!0)("showAdd",!1)("showExport",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(9,25,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.id),e.R7$(5),e.FS9("placeholder",e.bMT(14,27,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.clientName),e.R7$(4),e.FS9("placeholder",e.bMT(18,29,"orderManagement.order.visitDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.dates),e.R7$(3),e.FS9("placeholder",e.bMT(21,31,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(4),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(5),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[m.YU,m.bT,d.qT,d.me,d.Q0,d.BC,d.cb,d.vS,d.cV,_.s5,D.kL,A.b,Q.p,q.g,ue,u.Mm,S.XI,z.Ei,S.Tg,S.FP,C.Cv,X.m,U.p,ie.m,_e,fe,m.vh,u.D9],encapsulation:2})}}return r})();const Os=()=>["salesOrder.register"],Fs=()=>["changeQTY.newOrder"],Ns=()=>["changeQTY.edit"],ws=()=>["changeQTY.cancel"];function Gs(r,o){1&r&&(e.j41(0,"tr",31),e.nrm(1,"th",32),e.j41(2,"th",33),e.EFF(3,"#"),e.k0s(),e.j41(4,"th",34),e.nrm(5,"i",35),e.EFF(6," orderManagement.order.orderCode "),e.k0s(),e.j41(7,"th",36),e.nrm(8,"i",35),e.EFF(9," orderManagement.order.creation "),e.k0s(),e.j41(10,"th",37),e.nrm(11,"i",35),e.EFF(12," orderManagement.order.agentName "),e.k0s(),e.j41(13,"th",38),e.EFF(14," sales.salesOrder.salsePerson "),e.k0s(),e.j41(15,"th",39),e.nrm(16,"i",35),e.EFF(17," sales.salesOrder.clientVisitDate "),e.k0s(),e.j41(18,"th",40),e.EFF(19," sales.salesOrder.changeQuantityMessage "),e.k0s(),e.j41(20,"th",41),e.nrm(21,"i",35),e.EFF(22," sales.salesOrder.netPrice "),e.k0s(),e.nrm(23,"th",42),e.k0s())}function Vs(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",56),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,s=e.XpG(),l=e.sdS(50);return e.Njj(s.openStatusModal(n.id,l,10,"md"))}),e.nrm(2,"i",57),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"sales.salesOrder.sendApproval"))}function Ds(r,o){if(1&r){const t=e.RV6();e.j41(0,"li",47),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,s=e.XpG(),l=e.sdS(52);return e.Njj(s.openModal(n.id,l,"xl"))}),e.j41(1,"span",58),e.nrm(2,"i",59)(3,"span",60),e.k0s()()}}function Es(r,o){if(1&r){const t=e.RV6();e.j41(0,"li",47),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,s=e.XpG(),l=e.sdS(46);return e.Njj(s.openModal(n.id,l))}),e.j41(1,"span",58),e.nrm(2,"i",61)(3,"span",62),e.k0s()()}}function Ls(r,o){if(1&r){const t=e.RV6();e.j41(0,"tr",43)(1,"td"),e.nrm(2,"button",44),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td")(6,"bdi",45),e.EFF(7),e.k0s()(),e.j41(8,"td")(9,"span",46),e.EFF(10),e.k0s(),e.EFF(11),e.nI1(12,"date"),e.k0s(),e.j41(13,"td",47),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(),l=e.sdS(54);return e.Njj(s.openModal(n.clientId,l,"md"))}),e.j41(14,"a",48),e.EFF(15),e.k0s()(),e.j41(16,"td"),e.EFF(17),e.k0s(),e.j41(18,"td"),e.EFF(19),e.nI1(20,"date"),e.k0s(),e.j41(21,"td"),e.EFF(22),e.k0s(),e.j41(23,"td"),e.EFF(24),e.k0s(),e.j41(25,"td")(26,"div",49),e.DNE(27,Vs,3,3,"button",50),e.j41(28,"span",49)(29,"div",51)(30,"button",52),e.nrm(31,"i",53),e.k0s(),e.j41(32,"ul",54),e.DNE(33,Ds,4,0,"li",55)(34,Es,4,0,"li",55),e.k0s()()()()()()}if(2&r){const t=o.$implicit,i=o.rowIndex,n=o.expanded;e.R7$(2),e.Y8G("pRowToggler",t)("ngClass",n?" ri-arrow-down-s-line":"  ri-arrow-up-s-line"),e.R7$(2),e.JRh(i+1),e.R7$(3),e.SpI("#SO#",t.id,""),e.R7$(3),e.SpI("",t.creatorName," "),e.R7$(),e.SpI(" ",e.i5U(12,14,t.creationTime,"yyyy-MM-dd HH:mm")," "),e.R7$(4),e.SpI(" ",t.clientName," "),e.R7$(2),e.JRh(t.salsePersonName),e.R7$(2),e.SpI(" ",e.i5U(20,17,t.acutalVisitDate,"yyyy-MM-dd HH:mm"),""),e.R7$(3),e.JRh(t.changeQuantityMessage),e.R7$(2),e.JRh(t.netPrice),e.R7$(3),e.Y8G("hasPermission",e.lJ4(20,Fs)),e.R7$(6),e.Y8G("hasPermission",e.lJ4(21,Ns)),e.R7$(),e.Y8G("hasPermission",e.lJ4(22,ws))}}function $s(r,o){1&r&&(e.j41(0,"tr"),e.nrm(1,"th",67)(2,"th",68)(3,"th",69)(4,"th",70)(5,"th",71)(6,"th",72)(7,"th",73),e.k0s())}function Xs(r,o){if(1&r&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td")(8,"span"),e.EFF(9),e.k0s()(),e.j41(10,"td"),e.EFF(11),e.nI1(12,"translate"),e.k0s(),e.j41(13,"td"),e.EFF(14),e.k0s(),e.j41(15,"td"),e.EFF(16),e.k0s()()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t.itemName),e.R7$(2),e.JRh(t.unitName),e.R7$(2),e.JRh(t.clientQuantity),e.R7$(3),e.JRh(t.approvedQuantity),e.R7$(2),e.JRh(e.bMT(12,7,"sales.salesOrder."+t.discountTypeValue)),e.R7$(3),e.SpI(" ",t.discount," "),e.R7$(2),e.JRh(t.price)}}function Bs(r,o){1&r&&(e.j41(0,"tr"),e.nrm(1,"td",74),e.k0s())}function Ps(r,o){if(1&r&&(e.j41(0,"tr")(1,"td",63)(2,"div",64)(3,"p-table",65),e.DNE(4,$s,8,0,"ng-template",26)(5,Xs,17,9,"ng-template",27)(6,Bs,2,0,"ng-template",66),e.k0s()()()()),2&r){const t=o.$implicit;e.R7$(3),e.Y8G("value",t.offerOrderDetails)}}function Ys(r,o){1&r&&(e.j41(0,"div",75),e.EFF(1," general.table.noData "),e.k0s())}function Us(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",76)(1,"div",77),e.nrm(2,"ngb-pagination-info",78),e.j41(3,"table-length",79),e.bIt("lengthChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",80)(5,"ngb-pagination",81),e.bIt("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.pagination.pageNumber,n)||(s.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function As(r,o){if(1&r){const t=e.RV6();e.j41(0,"form",82,7),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.cancelOrder())}),e.nrm(2,"ngx-ui-loader",83),e.j41(3,"div",84)(4,"div",85)(5,"button",86),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"div",87)(7,"div",88),e.nrm(8,"lord-icon",89),e.j41(9,"div",90),e.nrm(10,"h3",91)(11,"p",92),e.k0s()(),e.j41(12,"div",93),e.nrm(13,"button",94),e.j41(14,"button",95),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}function Qs(r,o){if(1&r){const t=e.RV6();e.j41(0,"cancel-sales-model",96),e.bIt("success",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.reload())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderId",t.orderSelected)}}function qs(r,o){if(1&r){const t=e.RV6();e.j41(0,"order-timeline",97),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderSelected",t.orderSelected)}}function zs(r,o){if(1&r){const t=e.RV6();e.j41(0,"form",82,7),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.SubmitOrder())}),e.nrm(2,"ngx-ui-loader",83),e.j41(3,"div",84)(4,"div",85)(5,"button",86),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"div",87)(7,"div",88),e.nrm(8,"lord-icon",89),e.j41(9,"div",90),e.nrm(10,"h3",91)(11,"p",92),e.k0s()(),e.j41(12,"div",93),e.nrm(13,"button",94),e.j41(14,"button",95),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}function Hs(r,o){if(1&r){const t=e.RV6();e.j41(0,"sales-edit-order",98),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("isChangeQuantity",!0)("isDraft",!0)("orderSelected",t.orderSelected)}}function Js(r,o){if(1&r){const t=e.RV6();e.j41(0,"client-summary",99),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("clientId",t.orderSelected)}}let Ks=(()=>{class r extends Y.w{constructor(t,i,n,s,l,a,f,M,R,O,w,k,v,j,b,h,G){super(t,i,f,n,s,l,a),this.baseService=n,this.authDaamService=M,this.teamService=R,this.workTimeService=O,this.excelService=w,this.districtService=k,this.channelService=v,this.router=j,this.employeeService=b,this.regionService=h,this.cityService=G,this.title="sales.salesOrder.changeQuantity",this.titleOperation="sales.salesOrder.changeQuantity",this.keySelected="",this.searchForm={},this.isResolveList=!0,this.activeindex="2",this.active=2,this.countLoad=2,this.isOrderEdit=!1,this.orderSelected={},this.users=[],this.truncks=[],this.clientSelected={},this.salesPersons=[],this.regions=[],this.cities=[],this.setDates=(F,L,W)=>{if(F?.from||F?.to){const Ee=F.to||F.from;this.pagination[L]=this.datePipe.transform(F.from||F.to,"yyyy-MM-ddT00:00:00"),this.pagination[W]=this.datePipe.transform(Ee,"yyyy-MM-ddT23:59:59.999")}else this.pagination[L]=null,this.pagination[W]=null},this.loadentities(),this.GetSalesPersons(),this.GetRegions(),this.GetCities()}GetRegions(){this.regionService.getDropDown().subscribe(t=>{this.regions=t.data},t=>{console.log(t)})}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetSalesPersons(){this.employeeService.GetAllByType(9).subscribe(t=>{this.salesPersons=t.data},t=>{console.log(t)})}loadentities(){this.countLoad=this.countLoad+1,(!this.isResolveList||1!==this.countLoad)&&(this.pagination.status=5,this.baseService.get(this.pagination).pipe((0,p.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader(g.a7),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader(g.a7),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}openModal(t,i,n="md"){this.isOrderEdit=!1,this.form={},this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}SubmitOrder(){this.ngxLoader.startLoader(g.Fq),this.baseService.changStatus({id:this.form.id,status:this.form.status}).pipe((0,T.O)(),(0,N.c)(this.mainDelay),(0,x.Z)(),(0,p.Q)(this.notifier),(0,I.j)(()=>this.ngxLoader.stopLoader(g.Fq))).subscribe({next:i=>{this.modalService.dismissAll(),this.reload(),this.alertService.success()}})}cancelOrder(){this.ngxLoader.startLoader(g.Fq),console.log(this.operationId),this.baseService.changStatus({id:this.operationId,status:40}).pipe((0,T.O)(),(0,N.c)(this.mainDelay),(0,x.Z)(),(0,p.Q)(this.notifier),(0,I.j)(()=>this.ngxLoader.stopLoader(g.Fq))).subscribe({next:i=>{this.modalService.dismissAll(),this.loadentities(),this.alertService.success()}})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,p.Q)(this.notifier)).subscribe(i=>{i?this.alertService.success():this.alertService.error("general.message."+i)},i=>{this.alertService.error()})}mapRegisterForm(t){let i={...t};return i.employeeCode=0,i}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader("allLoader"),this.setDates(t.dates,"visitDateFrom","visitDateTo"),this.setDates(t.creationDates,"creationTimeFrom","creationTimeTo"),this.loadentities()}LoadSuccess(){this.ngxLoader.stopLoader("allLoader")}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems}}configRoute(){this.routerActive.data.pipe((0,p.Q)(this.notifier)).subscribe(t=>{this.entities=t.data,this.pagination.totalItems=t.data?.totalItems},()=>{this.alertService.error()})}mapExcel(){let t=[];return this.entities.forEach(i=>{t.push({"Order Code":i.orderCode,"Created Date":i.createdDate,"City Name":i.cityName,"District Name":i.districtName?i.districtName:"--","Agent Name":i.agentName,Mobile:i.mobile,"Channel Name":i.channelName,"Assigned To":i.teamNames,Times:i.workTimes,"Visit Date":i.visitDate,Services:i.services})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}goRegister(){this.router.navigateByUrl("/managment/order/new")}goEdit(t){this.router.navigateByUrl("/managment/order/new")}getStatus(t){return 10==t.offerOrderStatus||20==t.offerOrderStatus?"bg-warning-subtle text-warning":30==t.offerOrderStatus?"bg-success-subtle text-success":40==t.offerOrderStatus?"bg-danger-subtle text-danger":50==t.offerOrderStatus?"bg-danger-success text-success":"bg-warning-subtle text-warning"}checkEdit(t){return!t.isCancel&&!t.isFinish}openStatusModal(t,i,n,s="md"){this.isEditForm=!1,this.form={},this.form={id:t,status:n},this.modalService.open(i,{centered:!0,size:s})}openModalClient(t,i,n="xl"){this.clientSelected=t.orderCode,this.form=t,this.isOrderEdit=!1,this.modalService.open(i,{centered:!0,size:n})}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}openEditOrderModal(t,i,n="md"){this.form={},this.isOrderEdit=!0,this.clientSelected=t,this.modalService.open(i,{centered:!0,size:n})}OpenOrderTimeLineModel(t,i,n="md"){this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}reload(){this.baseService.GetOrderCountSource.next(!0),this.loadentities()}goNew(){this.router.navigateByUrl("/sales/new")}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(y.nX),e.rXU(u.c$),e.rXU(P),e.rXU(V.u),e.rXU(m.vh),e.rXU(C.eD),e.rXU(_.Bq),e.rXU(ee.J),e.rXU(ge.n),e.rXU(Te.G),e.rXU(H.V),e.rXU(Ne.m),e.rXU(xe.l),e.rXU(y.Ix),e.rXU(Z.O),e.rXU(re.S),e.rXU(K.h))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["change-quantity-order"]],features:[e.Vt3],decls:55,vars:52,consts:[["tableMaster",""],["cancelOrderModal",""],["deleteModal",""],["OrderTimeLineModel",""],["StatusOrderModal",""],["SalesEditModel",""],["ClientInfo",""],["formEntity","ngForm"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"addNew","addPermission","showAdd","loaderId"],[3,"reset","search","exportXlsx","showAdd","showExport","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","id","name","id",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","search","id","clientName","name","clientName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],["name","name","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["name","regionId","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],["name","cityId","bindValue","code","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],[2,"width",".2%"],["translate","",2,"width",".5%"],["pSortableColumn","id","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["pSortableColumn","creationTime","translate","",2,"width","12%"],["pSortableColumn","clientId","translate","",2,"width","10%"],["translate","",2,"width","8%"],["pSortableColumn","clientVisitDate","translate","",2,"width","8%"],["translate","",2,"width","20%"],["pSortableColumn","netPrice","translate","",2,"width","5%"],["translate","",2,"width","10%"],[1,"fs-5"],["type","button","pRipple","",1,"border-0","p-button-text","p-button-rounded","p-button-plain",3,"pRowToggler","ngClass"],[1,"code-pointer"],[1,"badge","bg-success-subtle","text-success"],[3,"click"],["href","javascript:void(0)",1,"link-primary","link-offset-2","text-decoration-underline","link-underline-opacity-25","link-underline-opacity-100-hover"],[1,"d-inline-block"],["class","btn btn-sm btn-warning edit-list mx-1","tooltipPosition","top",3,"pTooltip","click",4,"hasPermission"],[1,"dropdown-custom","d-inline-block"],["type","button",1,"btn","dropbtn","btn-soft-secondary","btn-sm","dropdown-custom","arrow-none"],[1,"ri-more-fill"],[1,"dropdown-menu","dropdown-menu-end","dropdown-content",2,"left","0"],[3,"click",4,"hasPermission"],["tooltipPosition","top",1,"btn","btn-sm","btn-warning","edit-list","mx-1",3,"click","pTooltip"],[1,"ri-checkbox-fill","align-bottom"],[1,"dropdown-item"],[1,"text-success","ri-pencil-fill","align-bottom","me-2"],["translate","general.action.edit"],[1,"text-danger","ri-close-fill","align-bottom","me-2"],["translate","general.action.cancel"],["colspan","17"],[1,"table-detail"],["dataKey","id",3,"value"],["pTemplate","emptymessage"],["translate","sales.salesOrder.itemName",2,"width","10%"],["translate","sales.salesOrder.unit",2,"width","6%"],["translate","sales.salesOrder.clientQuantity",2,"width","8%"],["translate","sales.salesOrder.approvedQuantity",2,"width","8%"],["translate","sales.salesOrder.discountType",2,"width","5%"],["translate","sales.salesOrder.discount",2,"width","5%"],["translate","sales.salesOrder.price",2,"width","5%"],["colspan","8"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"ngSubmit"],[3,"hasProgressBar","fgsType","loaderId"],[1,"modal-content"],[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mt-2","text-center"],["src","https://cdn.lordicon.com/gdfrsvpt.json","stroke","bold","state","hover-oscillate","trigger","loop","colors","primary:#f7b84b,secondary:#f06548",2,"width","130px","height","130px"],[1,"pt-2","fs-15","mx-4","mx-sm-5"],["translate","orderManagement.order.AreYouSureMessage"],[1,"text-muted","mx-4","mb-0"],[1,"d-flex","gap-2","justify-content-center","mt-4","mb-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],[3,"success","dismiss","orderId"],[3,"dismiss","orderSelected"],[3,"dismiss","isChangeQuantity","isDraft","orderSelected"],[3,"dismiss","clientId"]],template:function(i,n){if(1&i){const s=e.RV6();e.j41(0,"div",8)(1,"div",9)(2,"div",10)(3,"ngx-ui-loader",11),e.bIt("addNew",function(){return e.eBV(s),e.Njj(n.goNew())}),e.k0s(),e.j41(4,"base-filter",12),e.bIt("reset",function(){return e.eBV(s),e.Njj(n.onReset())})("search",function(){return e.eBV(s),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(s),e.Njj(n.onExportXlsx())}),e.qex(5,13),e.j41(6,"div",14)(7,"div",15)(8,"input",16),e.nI1(9,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.id,a)||(n.pagination.id=a),e.Njj(a)}),e.k0s(),e.nrm(10,"i",17),e.k0s()(),e.j41(11,"div",14)(12,"div",15)(13,"input",18),e.nI1(14,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.clientName,a)||(n.pagination.clientName=a),e.Njj(a)}),e.k0s(),e.nrm(15,"i",17),e.k0s()(),e.j41(16,"div",14)(17,"input",19),e.nI1(18,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.searchForm.creationDates,a)||(n.searchForm.creationDates=a),e.Njj(a)}),e.k0s()(),e.j41(19,"div",14)(20,"div",15)(21,"ng-select",20),e.nI1(22,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.salesPersonId,a)||(n.pagination.salesPersonId=a),e.Njj(a)}),e.k0s()()(),e.j41(23,"div",14)(24,"input",19),e.nI1(25,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.searchForm.dates,a)||(n.searchForm.dates=a),e.Njj(a)}),e.k0s()(),e.j41(26,"div",14)(27,"div",15)(28,"ng-select",21),e.nI1(29,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.regionId,a)||(n.pagination.regionId=a),e.Njj(a)}),e.k0s()()(),e.j41(30,"div",14)(31,"div",15)(32,"ng-select",22),e.nI1(33,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.cityId,a)||(n.pagination.cityId=a),e.Njj(a)}),e.k0s()()(),e.bVm(),e.k0s(),e.j41(34,"div",23)(35,"div",24)(36,"p-table",25,0),e.bIt("onLazyLoad",function(a){return e.eBV(s),e.Njj(n.tableChange(a))})("selectionChange",function(a){return e.eBV(s),e.Njj(n.onSelectionChange(a))}),e.DNE(38,Gs,24,0,"ng-template",26)(39,Ls,35,23,"ng-template",27)(40,Ps,7,1,"ng-template",28),e.k0s()(),e.DNE(41,Ys,2,0,"div",29)(42,Us,6,8,"div",30),e.k0s()()()(),e.DNE(43,As,15,3,"ng-template",null,1,e.C5r)(45,Qs,1,1,"ng-template",null,2,e.C5r)(47,qs,1,1,"ng-template",null,3,e.C5r)(49,zs,15,3,"ng-template",null,4,e.C5r)(51,Hs,1,3,"ng-template",null,5,e.C5r)(53,Js,1,1,"ng-template",null,6,e.C5r)}2&i&&(e.R7$(3),e.Y8G("addPermission",e.lJ4(51,Os))("showAdd",!0)("loaderId","sureLoader"),e.R7$(),e.Y8G("showAdd",!1)("showExport",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(9,37,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.id),e.R7$(5),e.FS9("placeholder",e.bMT(14,39,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.clientName),e.R7$(4),e.FS9("placeholder",e.bMT(18,41,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(4),e.FS9("placeholder",e.bMT(22,43,"sales.salesOrder.salsePerson")),e.Y8G("items",n.salesPersons)("multiple",!1),e.R50("ngModel",n.pagination.salesPersonId),e.R7$(3),e.FS9("placeholder",e.bMT(25,45,"sales.salesOrder.clientVisitDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.dates),e.R7$(4),e.FS9("placeholder",e.bMT(29,47,"client.client.regionName")),e.Y8G("items",n.regions)("multiple",!1),e.R50("ngModel",n.pagination.regionId),e.R7$(4),e.FS9("placeholder",e.bMT(33,49,"client.client.cityName")),e.Y8G("items",n.cities)("multiple",!1),e.R50("ngModel",n.pagination.cityId),e.R7$(4),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(5),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[m.YU,m.bT,d.qT,d.me,d.Q0,d.BC,d.cb,d.vS,d.cV,_.s5,D.kL,A.b,Q.p,q.g,ue,u.Mm,S.XI,z.Ei,S.Tg,S.FP,C.Cv,E.vr,X.m,U.p,ie.m,_e,fe,m.vh,u.D9],encapsulation:2})}}return r})();const Zs=()=>["salesOrder.view"],Ws=()=>["orderDraft.view"],ea=()=>["changeQTY.view"],ta=()=>["smApprove.view"],na=()=>["storePrepare.view"],ia=()=>["shippingOrder.view"],ra=()=>["completeOrder.view"],sa=()=>["cancelOrder.view"];function aa(r,o){1&r&&e.nrm(0,"app-all-sales-order")}function oa(r,o){1&r&&(e.j41(0,"li",6)(1,"a",7),e.nrm(2,"span",8),e.k0s(),e.DNE(3,aa,1,0,"ng-template",9),e.k0s()),2&r&&e.Y8G("ngbNavItem",1)}function la(r,o){1&r&&e.nrm(0,"draft-order")}function da(r,o){if(1&r&&(e.j41(0,"li",6)(1,"a",7),e.nrm(2,"span",10),e.j41(3,"span",11),e.EFF(4),e.k0s()(),e.DNE(5,la,1,0,"ng-template",9),e.k0s()),2&r){const t=e.XpG();e.Y8G("ngbNavItem",2),e.R7$(4),e.JRh(null==t.count?null:t.count.draft)}}function ca(r,o){1&r&&e.nrm(0,"change-quantity-order")}function ma(r,o){if(1&r&&(e.j41(0,"li",6)(1,"a",7),e.nrm(2,"span",12),e.j41(3,"span",11),e.EFF(4),e.k0s()(),e.DNE(5,ca,1,0,"ng-template",9),e.k0s()),2&r){const t=e.XpG();e.Y8G("ngbNavItem",2),e.R7$(4),e.JRh(null==t.count?null:t.count.changeQuantity)}}function pa(r,o){1&r&&e.nrm(0,"app-new-order")}function ga(r,o){if(1&r&&(e.j41(0,"li",6)(1,"a",7),e.nrm(2,"span",13),e.j41(3,"span",11),e.EFF(4),e.k0s()(),e.DNE(5,pa,1,0,"ng-template",9),e.k0s()),2&r){const t=e.XpG();e.Y8G("ngbNavItem",4),e.R7$(4),e.JRh(null==t.count?null:t.count.underReview)}}function _a(r,o){1&r&&e.nrm(0,"app-sure-order")}function ua(r,o){if(1&r&&(e.j41(0,"li",6)(1,"a",7),e.nrm(2,"span",14),e.j41(3,"span",11),e.EFF(4),e.k0s()(),e.DNE(5,_a,1,0,"ng-template",9),e.k0s()),2&r){const t=e.XpG();e.Y8G("ngbNavItem",5),e.R7$(4),e.JRh(null==t.count?null:t.count.approved)}}function ha(r,o){1&r&&e.nrm(0,"assign-order")}function fa(r,o){if(1&r&&(e.j41(0,"li",6)(1,"a",7),e.nrm(2,"span",15),e.j41(3,"span",11),e.EFF(4),e.k0s()(),e.DNE(5,ha,1,0,"ng-template",9),e.k0s()),2&r){const t=e.XpG();e.Y8G("ngbNavItem",6),e.R7$(4),e.JRh(null==t.count?null:t.count.assign)}}function ba(r,o){1&r&&e.nrm(0,"app-complete-order")}function Ca(r,o){1&r&&(e.j41(0,"li",6)(1,"a",7),e.nrm(2,"span",16),e.k0s(),e.DNE(3,ba,1,0,"ng-template",9),e.k0s()),2&r&&e.Y8G("ngbNavItem",7)}function Sa(r,o){1&r&&e.nrm(0,"app-cancel-order")}function va(r,o){1&r&&(e.j41(0,"li",6)(1,"a",7),e.nrm(2,"span",17),e.k0s(),e.DNE(3,Sa,1,0,"ng-template",9),e.k0s()),2&r&&e.Y8G("ngbNavItem",8)}let ja=(()=>{class r extends Y.w{constructor(t,i,n,s,l,a,f,M){super(t,i,f,n,s,l,a),this.baseService=n,this.authDaamService=M,this.title="orderManagement.order.title",this.titleOperation="orderManagement.order.titleOperation",this.active=1,this.activeindex="1",this.count={}}ngOnInitMore(){this.baseService.GetOrderCount.subscribe(()=>{this.GetOfferOrderCount()})}onNavChange(t){}GetOfferOrderCount(){this.baseService.GetOfferOrderCount().subscribe(t=>{this.count=t.data})}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(y.nX),e.rXU(u.c$),e.rXU(P),e.rXU(V.u),e.rXU(m.vh),e.rXU(C.eD),e.rXU(_.Bq),e.rXU(ee.J))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-order-layout"]],features:[e.Vt3],decls:13,vars:18,consts:[["nav","ngbNav"],[1,"row"],[1,"col-lg-12"],["ngbNav","",1,"nav","nav-tabs-custom","card-header-tabs","border-bottom-0","justify-content-center",3,"activeIdChange","navChange","activeId"],[3,"ngbNavItem",4,"hasPermission"],[1,"mt-2",3,"ngbNavOutlet"],[3,"ngbNavItem"],["ngbNavLink",""],["translate","sales.salesOrder.allOrders"],["ngbNavContent",""],["translate","sales.salesOrder.draftOrder"],[1,"ms-2","badge","bg-warning"],["translate","sales.salesOrder.changeQuantity"],["translate","sales.salesOrder.newOrders"],["translate","sales.salesOrder.sureOrder"],["translate","sales.salesOrder.assignTrunk"],["translate","sales.salesOrder.completeOrder"],["translate","sales.salesOrder.cancelOrder"]],template:function(i,n){if(1&i){const s=e.RV6();e.j41(0,"div",1)(1,"div",2)(2,"ul",3,0),e.mxI("activeIdChange",function(a){return e.eBV(s),e.DH7(n.active,a)||(n.active=a),e.Njj(a)}),e.bIt("navChange",function(a){return e.eBV(s),e.Njj(n.onNavChange(a))}),e.DNE(4,oa,4,1,"li",4)(5,da,6,2,"li",4)(6,ma,6,2,"li",4)(7,ga,6,2,"li",4)(8,ua,6,2,"li",4)(9,fa,6,2,"li",4)(10,Ca,4,1,"li",4)(11,va,4,1,"li",4),e.k0s(),e.nrm(12,"div",5),e.k0s()()}if(2&i){const s=e.sdS(3);e.R7$(2),e.R50("activeId",n.active),e.R7$(2),e.Y8G("hasPermission",e.lJ4(10,Zs)),e.R7$(),e.Y8G("hasPermission",e.lJ4(11,Ws)),e.R7$(),e.Y8G("hasPermission",e.lJ4(12,ea)),e.R7$(),e.Y8G("hasPermission",e.lJ4(13,ta)),e.R7$(),e.Y8G("hasPermission",e.lJ4(14,na)),e.R7$(),e.Y8G("hasPermission",e.lJ4(15,ia)),e.R7$(),e.Y8G("hasPermission",e.lJ4(16,ra)),e.R7$(),e.Y8G("hasPermission",e.lJ4(17,sa)),e.R7$(),e.Y8G("ngbNavOutlet",s)}},dependencies:[_.Um,_.X9,_.sy,_.Gx,_.Ri,_.WA,_.m_,u.Mm,U.p,ti,Mi,Zi,Or,qr,ls,Rs,Ks],encapsulation:2})}}return r})(),we=(()=>{class r extends ce.d{constructor(t){super(t,J.c.apiUrl+"InvoiceMaster/")}register(t){return this.http.post(this.baseUrl+"AddPaymentToInvoice",t)}edit(t){return this.http.post(this.baseUrl+"EditPayment",t)}softDelete(t){return this.http.delete(this.baseUrl+`SoftDelete/${t}`)}finishOrder(t){return this.http.post(this.baseUrl+"finishOrder",t)}getInvoiceAttachments(t){return this.http.get(this.baseUrl+"GetInvoiceAttachments/"+t)}print(t){return this.http.get(this.baseUrl+"print/"+t,{responseType:"blob"})}static{this.\u0275fac=function(i){return new(i||r)(e.KVO(me.Qq))}}static{this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})(),Be=(()=>{class r extends ce.d{constructor(t){super(t,J.c.apiUrl+"PaymentType/")}getLookups(){return this.http.get(this.baseUrl+"Lookups")}changStatus(t){return this.http.put(this.baseUrl+"ChangeStatus/",t)}static{this.\u0275fac=function(i){return new(i||r)(e.KVO(me.Qq))}}static{this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var Ge=c(99902),Pe=c(3200);const Ia=()=>["salesInvoices.register"],ya=()=>["salesInvoices.odooSync","salesInvoices.printPill"],ka=()=>["salesInvoices.odooSync"],Ta=()=>["salesInvoices.printPill"];function xa(r,o){1&r&&(e.j41(0,"tr",36)(1,"th",37),e.EFF(2,"#"),e.k0s(),e.j41(3,"th",38),e.nrm(4,"i",39),e.EFF(5," orderManagement.order.invoiceCode "),e.k0s(),e.j41(6,"th",40),e.nrm(7,"i",39),e.EFF(8," orderManagement.order.clientName "),e.k0s(),e.j41(9,"th",41),e.nrm(10,"i",39),e.EFF(11," orderManagement.order.orderCode "),e.k0s(),e.j41(12,"th",42),e.nrm(13,"i",39),e.EFF(14," orderManagement.order.creation "),e.k0s(),e.j41(15,"th",43),e.EFF(16," sales.salesOrder.salsePerson "),e.k0s(),e.j41(17,"th",44),e.nrm(18,"i",39),e.EFF(19," sales.salesInvoices.total "),e.k0s(),e.j41(20,"th",45),e.nrm(21,"i",39),e.EFF(22," sales.salesOrder.totalDiscount "),e.k0s(),e.j41(23,"th",46),e.nrm(24,"i",39),e.EFF(25," sales.salesInvoices.tax "),e.k0s(),e.j41(26,"th",47),e.nrm(27,"i",39),e.EFF(28," sales.salesOrder.netPrice "),e.k0s(),e.j41(29,"th",48),e.nrm(30,"i",39),e.EFF(31," sales.salesOrder.invoiceStatus "),e.k0s(),e.j41(32,"th",49),e.nrm(33,"i",39),e.EFF(34," sales.salesOrder.isSync "),e.k0s(),e.j41(35,"th",50),e.nrm(36,"i",39),e.EFF(37," sales.salesInvoices.notes "),e.k0s(),e.nrm(38,"th",51),e.k0s())}function Ma(r,o){if(1&r&&(e.j41(0,"span",66),e.EFF(1),e.k0s()),2&r){const t=e.XpG().$implicit;e.R7$(),e.JRh(t.creatorName)}}function Ra(r,o){1&r&&e.nrm(0,"span",67)}function Oa(r,o){1&r&&e.nrm(0,"span",68)}function Fa(r,o){1&r&&e.nrm(0,"span",69)}function Na(r,o){1&r&&e.nrm(0,"span",70)}function wa(r,o){1&r&&e.nrm(0,"span",71)}function Ga(r,o){1&r&&(e.j41(0,"li")(1,"span",78),e.nrm(2,"i",79)(3,"span",80),e.k0s()())}function Va(r,o){if(1&r){const t=e.RV6();e.j41(0,"li",53),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2).$implicit,s=e.XpG();return e.Njj(s.Print(n.id))}),e.j41(1,"span",78),e.nrm(2,"i",79)(3,"span",81),e.k0s()()}}function Da(r,o){1&r&&(e.j41(0,"span",64)(1,"div",72)(2,"button",73),e.nrm(3,"i",74),e.k0s(),e.j41(4,"ul",75),e.DNE(5,Ga,4,0,"li",76)(6,Va,4,0,"li",77),e.k0s()()()),2&r&&(e.R7$(5),e.Y8G("hasPermission",e.lJ4(2,ka)),e.R7$(),e.Y8G("hasPermission",e.lJ4(3,Ta)))}function Ea(r,o){if(1&r){const t=e.RV6();e.j41(0,"tr",52)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td",53),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(),l=e.sdS(52);return e.Njj(s.getInvoiceAttachments(n.id,l))}),e.nrm(4,"i",54),e.j41(5,"bdi",55),e.EFF(6),e.k0s()(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td"),e.nrm(10,"i",54),e.j41(11,"bdi",56),e.EFF(12),e.k0s()(),e.j41(13,"td"),e.DNE(14,Ma,2,1,"span",57),e.EFF(15),e.nI1(16,"date"),e.k0s(),e.j41(17,"td"),e.EFF(18),e.k0s(),e.j41(19,"td"),e.EFF(20),e.k0s(),e.j41(21,"td"),e.EFF(22),e.k0s(),e.j41(23,"td"),e.EFF(24),e.k0s(),e.j41(25,"td")(26,"span",58),e.EFF(27),e.k0s()(),e.j41(28,"td"),e.DNE(29,Ra,1,0,"span",59)(30,Oa,1,0,"span",60)(31,Fa,1,0,"span",61),e.k0s(),e.j41(32,"td"),e.DNE(33,Na,1,0,"span",62)(34,wa,1,0,"span",63),e.k0s(),e.j41(35,"td"),e.EFF(36),e.k0s(),e.j41(37,"td")(38,"div",64),e.DNE(39,Da,7,4,"span",65),e.k0s()()()}if(2&r){const t=o.$implicit,i=o.rowIndex;e.R7$(2),e.JRh(i+1),e.R7$(4),e.SpI("#INV#",t.id,""),e.R7$(2),e.JRh(t.clientName),e.R7$(4),e.SpI("#SO#",t.offerOrderId," "),e.R7$(2),e.Y8G("ngIf",t.creatorName),e.R7$(),e.SpI(" ",e.i5U(16,18,t.creationTime,"yyyy-MM-dd")," "),e.R7$(3),e.JRh(t.salsePersonName),e.R7$(2),e.JRh(t.total),e.R7$(2),e.JRh(t.totalDiscount),e.R7$(2),e.JRh(t.tax),e.R7$(3),e.JRh(t.net),e.R7$(2),e.Y8G("ngIf",0==t.status),e.R7$(),e.Y8G("ngIf",2==t.status),e.R7$(),e.Y8G("ngIf",3==t.status),e.R7$(2),e.Y8G("ngIf",t.isSync),e.R7$(),e.Y8G("ngIf",!t.isSync),e.R7$(2),e.JRh(t.notes),e.R7$(3),e.Y8G("hasPermission",e.lJ4(21,ya))}}function La(r,o){1&r&&(e.j41(0,"div",82),e.EFF(1," general.table.noData "),e.k0s())}function $a(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",83)(1,"div",84),e.nrm(2,"ngb-pagination-info",85),e.j41(3,"table-length",86),e.bIt("lengthChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",87)(5,"ngb-pagination",88),e.bIt("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.pagination.pageNumber,n)||(s.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function Xa(r,o){1&r&&(e.j41(0,"span",114),e.EFF(1,"general.action.register "),e.k0s())}function Ba(r,o){1&r&&(e.j41(0,"span",114),e.EFF(1,"general.action.edit "),e.k0s())}function Pa(r,o){1&r&&(e.j41(0,"div",115),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function Ya(r,o){1&r&&(e.j41(0,"div",115),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function Ua(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",118)(1,"i",119),e.bIt("click",function(){e.eBV(t);const n=e.XpG().index,s=e.XpG(2);return e.Njj(s.removeFile(n))}),e.k0s(),e.j41(2,"p-image",120),e.bIt("error",function(n){e.eBV(t);const s=e.XpG(3);return e.Njj(s.setDefaultImage(n,"assets/images/custom/no-img.jpg"))}),e.k0s()()}2&r&&(e.R7$(2),e.Y8G("src","assets/images/PDF.png")("preview",!1)("alt","pdf"))}function Aa(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",118)(1,"i",119),e.bIt("click",function(){e.eBV(t);const n=e.XpG().index,s=e.XpG(2);return e.Njj(s.removeFile(n))}),e.k0s(),e.j41(2,"p-image",120),e.bIt("error",function(n){e.eBV(t);const s=e.XpG(3);return e.Njj(s.setDefaultImage(n,"assets/images/custom/no-img.jpg"))}),e.k0s()()}if(2&r){const t=e.XpG().$implicit,i=e.XpG(2);e.R7$(2),e.Y8G("src",t.isNew?t.attachment:i.serverPath+t.attachment)("preview",!0)("alt","image")}}function Qa(r,o){if(1&r&&(e.j41(0,"div",116),e.DNE(1,Ua,3,3,"div",117)(2,Aa,3,3,"div",117),e.k0s()),2&r){const t=o.index,i=e.XpG(2);e.R7$(),e.Y8G("ngIf","application/pdf"===i.filesNames[t]),e.R7$(),e.Y8G("ngIf","application/pdf"!==i.filesNames[t])}}function qa(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",89)(1,"div",90)(2,"h4",91),e.DNE(3,Xa,2,0,"span",92)(4,Ba,2,0,"span",92),e.j41(5,"span",93),e.EFF(6),e.k0s()(),e.j41(7,"button",94),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss("Cross click"))}),e.k0s()(),e.j41(8,"div",95),e.nrm(9,"ngx-ui-loader",29),e.j41(10,"form",96,4),e.bIt("submit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.OnSubmit())}),e.j41(12,"div",97)(13,"label",98),e.EFF(14,"sales.salesInvoices.paymentTypeName"),e.k0s(),e.j41(15,"ng-select",99,5),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.paymentTypeId,n)||(s.form.paymentTypeId=n),e.Njj(n)}),e.k0s(),e.DNE(17,Pa,2,0,"div",100),e.k0s(),e.j41(18,"div",97)(19,"label",101),e.EFF(20,"sales.salesInvoices.cost"),e.k0s(),e.j41(21,"input",102,6),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.cost,n)||(s.form.cost=n),e.Njj(n)}),e.k0s(),e.DNE(23,Ya,2,0,"div",103),e.k0s(),e.j41(24,"div",97)(25,"label",104),e.EFF(26,"general.table.notes"),e.k0s(),e.j41(27,"textarea",105),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.notes,n)||(s.form.notes=n),e.Njj(n)}),e.EFF(28,"                    "),e.k0s()(),e.j41(29,"div",9)(30,"div",106)(31,"label",98),e.EFF(32," orderManagement.order.attachment"),e.k0s(),e.j41(33,"input",107,7),e.bIt("change",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.onFileSelected(n))}),e.k0s()(),e.j41(35,"div",108),e.DNE(36,Qa,3,2,"div",109),e.k0s()(),e.j41(37,"div",110)(38,"button",111),e.nrm(39,"i",112)(40,"span",113),e.k0s()()()()()}if(2&r){const t=e.sdS(11),i=e.sdS(16),n=e.sdS(22),s=e.XpG();e.R7$(3),e.Y8G("ngIf",!s.isEditForm),e.R7$(),e.Y8G("ngIf",s.isEditForm),e.R7$(2),e.JRh(s.titleOperation),e.R7$(3),e.Y8G("hasProgressBar",!1)("fgsType",s.loaderOperationShap)("loaderId",s.operationLoader),e.R7$(6),e.Y8G("items",s.paymentMethods)("multiple",!1),e.R50("ngModel",s.form.paymentTypeId),e.R7$(2),e.Y8G("ngIf",i.invalid&&i.touched),e.R7$(4),e.R50("ngModel",s.form.cost),e.R7$(2),e.Y8G("ngIf",n.invalid&&n.touched),e.R7$(4),e.R50("ngModel",s.form.notes),e.R7$(9),e.Y8G("ngForOf",s.filesToShow),e.R7$(2),e.Y8G("disabled",!t.valid)}}function za(r,o){if(1&r){const t=e.RV6();e.j41(0,"delete-modal",121),e.bIt("deleteConfirm",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.DeleteConfirmSoft())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}}function Ha(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",124)(1,"p-image",125),e.bIt("error",function(n){e.eBV(t);const s=e.XpG(2);return e.Njj(s.setDefaultImage(n,"assets/images/custom/no-img.jpg"))}),e.k0s()()}if(2&r){const t=o.$implicit,i=e.XpG(2);e.R7$(),e.Y8G("src",i.serverPath+t.path)("preview",!0)}}function Ja(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",89)(1,"div",90)(2,"button",94),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss("Cross click"))}),e.k0s()(),e.j41(3,"div",122)(4,"div",9),e.DNE(5,Ha,2,2,"div",123),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(5),e.Y8G("ngForOf",t.images)}}let Ka=(()=>{class r extends Y.w{constructor(t,i,n,s,l,a,f,M,R,O,w,k){super(t,i,f,n,s,l,a),this.baseService=n,this.paymentTypesService=M,this.formData=R,this.employeeService=O,this.regionService=w,this.cityService=k,this.title="sales.salesInvoices.title",this.titleOperation="sales.salesInvoices.payment",this.paymentMethods=[],this.searchForm={},this.form={file:""},this.filesToSend=[],this.filesToShow=[],this.filesNames=[],this.isResolveList=!0,this.serverPath=J.c.mediaUrl,this.countLoad=0,this.isOrderEdit=!1,this.images=[],this.salesPersons=[],this.regions=[],this.cities=[],this.setDates=(v,j,b)=>{if(v?.from||v?.to){const G=v.to||v.from;this.pagination[j]=this.datePipe.transform(v.from||v.to,"yyyy-MM-ddT00:00:00"),this.pagination[b]=this.datePipe.transform(G,"yyyy-MM-ddT23:59:59.999")}else this.pagination[j]=null,this.pagination[b]=null},this.configRoute(),this.GetSalesPersons(),this.GetRegions(),this.GetCities()}GetRegions(){this.regionService.getDropDown().subscribe(t=>{this.regions=t.data},t=>{console.log(t)})}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetSalesPersons(){this.employeeService.GetAllByType(9).subscribe(t=>{this.salesPersons=t.data},t=>{console.log(t)})}configRoute(){this.routerActive.data.pipe((0,p.Q)(this.notifier)).subscribe(t=>{this.entities=t.data.data,this.pagination.totalItems=t.data.totalItems},()=>{this.alertService.error()})}getInvoiceAttachments(t,i){this.baseService.getInvoiceAttachments(t).subscribe({next:n=>{this.images=n.data,this.modalService.open(i,{centered:!0,size:"md"})}})}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader(g.a7),this.setDates(t.dates,"visitDateFrom","visitDateTo"),this.setDates(t.creationDates,"creationTimeFrom","creationTimeTo"),this.loadentities()}LoadSuccess(){this.ngxLoader.stopLoader(g.a7)}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems}}openInvoiceModal(t,i,n="md",s){if(this.isEditForm=s,this.form={},this.clearFiles(),this.operationId=t.id,s){this.form=t,console.log(this.form);let l="";t.path&&(l=t.path.split(".")[1]),this.filesToSend.push({id:0,isNew:!1,attachment:t.path}),this.filesToShow.push({id:0,isNew:!1,attachment:t.path}),this.filesNames.push("pdf"===l?"application/pdf":l),this.modalService.open(i,{centered:!0,size:n})}else this.form.invoiceMasterId=t.id,this.modalService.open(i,{centered:!0,size:n})}onFileSelected(t){this.clearFiles();const i=t.target;if(t.target.files&&t.target.files[0]){let n=t.target.files.length;for(let s=0;s<n;s++){let l=new FileReader;this.filesToSend.push({id:0,isNew:!0,attachment:t.target.files.item(s)}),this.filesNames.push(t.target.files[s].type),l.onload=a=>{this.filesToShow.push({id:0,isNew:!0,attachment:a.target.result}),console.log(this.filesToShow)},l.readAsDataURL(t.target?.files[s])}i.value=""}}setDefaultImage(t,i){t.target.src=i}checkExtension(t){const n=t.split("/").pop().split(".").pop();return console.log(),n}checkUrl(t){return null==t||""==t?"":t.startsWith("/upload")?t.replace("/upload","upload"):t}removeFile(t){this.filesToShow.splice(t,1),this.filesNames.splice(t,1),this.filesToSend.splice(t,1)}clearFiles(){this.filesNames=[],this.filesToShow=[],this.filesToSend=[]}registerEntity(){let t=this.mapRegisterForm(this.form);t.file=this.filesToSend&&this.filesToSend.length>0?this.filesToSend[0].attachment:null,this.baseService.register(this.formData.formatFormData(t)).pipe((0,T.O)(),(0,N.c)(this.mainDelay),(0,x.Z)(),(0,p.Q)(this.notifier),(0,I.j)(()=>this.ngxLoader.stopLoader(g.ZW)),(0,be.W)(i=>(0,Ce.$)(i))).subscribe(i=>{i.success?(this.modalService.dismissAll(),this.submitFunished()):this.alertService.error("general.message."+i.message)},i=>{this.alertService.error("general.message."+i)})}editEntity(){let t=this.mapForm(this.form);t.file=this.filesToSend&&this.filesToSend.length>0?this.filesToSend[0].attachment:null,this.baseService.edit(this.formData.formatFormData(t)).pipe((0,T.O)(),(0,N.c)(this.mainDelay),(0,x.Z)(),(0,p.Q)(this.notifier),(0,I.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(i=>{i.success?this.submitFunished():this.alertService.error("general.message."+i.message)},i=>{this.alertService.error("general.message."+i)})}Print(t){this.ngxLoader.startLoader("searchLoader"),this.baseService.print(t).pipe((0,T.O)(),(0,x.Z)(),(0,p.Q)(this.notifier),(0,I.j)(()=>this.ngxLoader.stopLoader("searchLoader"))).subscribe(i=>{this.openUrl(i)},i=>{this.alertService.error("general.message."+i)})}openUrl(t){let i=new Blob([t],{type:t.type});var n=URL.createObjectURL(i);window.open(n,"_blank")}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(y.nX),e.rXU(u.c$),e.rXU(we),e.rXU(V.u),e.rXU(m.vh),e.rXU(C.eD),e.rXU(_.Bq),e.rXU(Be),e.rXU(Ge.Q),e.rXU(Z.O),e.rXU(re.S),e.rXU(K.h))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-sales-invoices"]],features:[e.Vt3],decls:53,vars:56,consts:[["tableMaster",""],["addPaymentModal",""],["deleteModal",""],["viewMedia",""],["formEntity","ngForm"],["paymentTypeId","ngModel"],["cost","ngModel"],["fileInput",""],[3,"title","breadcrumbItems"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"reset","search","addPermission","showAdd","showExport","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","id","name","id",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","search","id","clientName","name","clientName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],["name","regionId","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],["name","cityId","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],["name","customerSize","id","customerSize","aria-label","Floating label select example",1,"form-select",3,"ngModelChange","ngModel"],["translate","sales.salesInvoices.Unpaid",3,"value"],["translate","sales.salesInvoices.PartiallyPaid",3,"value"],["translate","sales.salesInvoices.Paid",3,"value"],[1,"card-body"],[3,"hasProgressBar","fgsType","loaderId"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["translate","",2,"width",".3%"],["pSortableColumn","id","translate","",2,"width","3%"],[1,"ri-expand-up-down-line"],["pSortableColumn","clientId","translate","",2,"width","10%"],["pSortableColumn","id","translate","",2,"width","6%"],["pSortableColumn","creationTime","translate","",2,"width","5%"],["translate","",2,"width","8%"],["pSortableColumn","total","translate","",2,"width","5%"],["pSortableColumn","totalDiscount","translate","",2,"width","5%"],["pSortableColumn","tax","translate","",2,"width","4%"],["pSortableColumn","net","translate","",2,"width","4%"],["pSortableColumn","invoiceStatus","translate","",2,"width","6%"],["pSortableColumn","isSync","translate","",2,"width","5%"],["pSortableColumn","notes","translate","",2,"width","5%"],[2,"width","3%"],[1,"fs-5"],[3,"click"],[1,"ri-share-circle-fill","label-icon","align-middle","rounded-pill","fs-16","me-2"],[1,"code-pointer","text-decoration-underline"],[1,"code-pointer"],["class","badge bg-success-subtle text-success",4,"ngIf"],[1,"badge","fs-5","bg-success-subtle","text-success","badge-border"],["class","badge bg-danger","translate","sales.salesInvoices.Unpaid",4,"ngIf"],["class","badge bg-warning","translate","sales.salesInvoices.PartiallyPaid",4,"ngIf"],["class","badge bg-success","translate","sales.salesInvoices.Paid",4,"ngIf"],["class","badge bg-success","translate","sales.salesOrder.syncSend",4,"ngIf"],["class","badge bg-warning","translate","sales.salesOrder.syncNotSend",4,"ngIf"],[1,"d-inline-block"],["class","d-inline-block",4,"hasPermission"],[1,"badge","bg-success-subtle","text-success"],["translate","sales.salesInvoices.Unpaid",1,"badge","bg-danger"],["translate","sales.salesInvoices.PartiallyPaid",1,"badge","bg-warning"],["translate","sales.salesInvoices.Paid",1,"badge","bg-success"],["translate","sales.salesOrder.syncSend",1,"badge","bg-success"],["translate","sales.salesOrder.syncNotSend",1,"badge","bg-warning"],[1,"dropdown-custom","d-inline-block"],["type","button",1,"btn","dropbtn","btn-soft-secondary","btn-sm","dropdown-custom","arrow-none"],[1,"ri-more-fill"],[1,"dropdown-menu","dropdown-menu-end","dropdown-content",2,"left","0"],[4,"hasPermission"],[3,"click",4,"hasPermission"],[1,"dropdown-item"],[1,"ri-printer-line","align-bottom","me-2","text-muted"],["translate","sales.salesOrder.isSync"],["translate","orderManagement.order.printPill"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["class","fw-bold fs-4","translate","",4,"ngIf"],["translate",""],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"submit"],[1,"mb-3"],["translate","",1,"required","fw-bold","form-label","w-100"],["name","paymentTypeId","bindValue","code","bindLabel","name","required","",3,"ngModelChange","items","multiple","ngModel"],["class","text-danger text-center","translate","",4,"ngIf"],["for","cost","translate","",1,"required","fw-bold","form-label"],["InputTirmFilter","","name","cost","type","text","id","employeeName","required","",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["class","text-danger text-center  ","translate","",4,"ngIf"],["for","notes","translate","",1,"fw-bold","form-label"],["rows","3","name","notes","type","text","id","notes",1,"form-control","fs-6",3,"ngModelChange","ngModel"],[1,"col-12","mb-2"],["accept","image/*, application/pdf","type","file","placeholder","dfd",1,"form-control","fs-6",3,"change"],[1,"my-3","row","row-cols-5"],["class","col",4,"ngFor","ngForOf"],[1,"text-center"],["type","submit","type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],["translate","",1,"fw-bold","fs-4"],["translate","",1,"text-danger","text-center"],[1,"col"],["class","position-relative",4,"ngIf"],[1,"position-relative"],[1,"ri-close-fill","position-absolute",2,"border-radius","50%","background-color","red","inset-inline-start","-14px","top","-8px","color","white",3,"click"],["width","50","height","50",3,"error","src","preview","alt"],[3,"deleteConfirm","dismiss"],[1,"modal-body","p-4"],["class","col-12 col-md-3",4,"ngFor","ngForOf"],[1,"col-12","col-md-3"],["width","80","height","100",3,"error","src","preview"]],template:function(i,n){if(1&i){const s=e.RV6();e.nrm(0,"app-breadcrumbs",8),e.nI1(1,"translate"),e.j41(2,"div",9)(3,"div",10)(4,"div",11),e.nrm(5,"ngx-ui-loader",12),e.j41(6,"base-filter",13),e.bIt("reset",function(){return e.eBV(s),e.Njj(n.onReset())})("search",function(){return e.eBV(s),e.Njj(n.onSearch())}),e.qex(7,14),e.j41(8,"div",15)(9,"div",16)(10,"input",17),e.nI1(11,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.id,a)||(n.pagination.id=a),e.Njj(a)}),e.k0s(),e.nrm(12,"i",18),e.k0s()(),e.j41(13,"div",15)(14,"div",16)(15,"input",19),e.nI1(16,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.clientName,a)||(n.pagination.clientName=a),e.Njj(a)}),e.k0s(),e.nrm(17,"i",18),e.k0s()(),e.j41(18,"div",15)(19,"div",16)(20,"ng-select",20),e.nI1(21,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.salesPersonId,a)||(n.pagination.salesPersonId=a),e.Njj(a)}),e.k0s()()(),e.j41(22,"div",15)(23,"input",21),e.nI1(24,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.searchForm.creationDates,a)||(n.searchForm.creationDates=a),e.Njj(a)}),e.k0s()(),e.j41(25,"div",15)(26,"div",16)(27,"ng-select",22),e.nI1(28,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.regionId,a)||(n.pagination.regionId=a),e.Njj(a)}),e.k0s()()(),e.j41(29,"div",15)(30,"div",16)(31,"ng-select",23),e.nI1(32,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.cityId,a)||(n.pagination.cityId=a),e.Njj(a)}),e.k0s()()(),e.j41(33,"div",15)(34,"select",24),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.status,a)||(n.pagination.status=a),e.Njj(a)}),e.nrm(35,"option",25)(36,"option",26)(37,"option",27),e.k0s()(),e.bVm(),e.k0s(),e.j41(38,"div",28),e.nrm(39,"ngx-ui-loader",29),e.j41(40,"div",30)(41,"p-table",31,0),e.bIt("onLazyLoad",function(a){return e.eBV(s),e.Njj(n.tableChange(a))})("selectionChange",function(a){return e.eBV(s),e.Njj(n.onSelectionChange(a))}),e.DNE(43,xa,39,0,"ng-template",32)(44,Ea,40,22,"ng-template",33),e.k0s()(),e.DNE(45,La,2,0,"div",34)(46,$a,6,8,"div",35),e.k0s()()()(),e.DNE(47,qa,41,15,"ng-template",null,1,e.C5r)(49,za,1,0,"ng-template",null,2,e.C5r)(51,Ja,6,1,"ng-template",null,3,e.C5r)}2&i&&(e.FS9("title",e.bMT(1,41,n.title)),e.Y8G("breadcrumbItems",n.breadCrumbItems),e.R7$(5),e.Y8G("loaderId","newLoader"),e.R7$(),e.Y8G("addPermission",e.lJ4(55,Ia))("showAdd",!1)("showExport",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(11,43,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.id),e.R7$(5),e.FS9("placeholder",e.bMT(16,45,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.clientName),e.R7$(5),e.FS9("placeholder",e.bMT(21,47,"sales.salesOrder.salsePerson")),e.Y8G("items",n.salesPersons)("multiple",!1),e.R50("ngModel",n.pagination.salesPersonId),e.R7$(3),e.FS9("placeholder",e.bMT(24,49,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(4),e.FS9("placeholder",e.bMT(28,51,"client.client.regionName")),e.Y8G("items",n.regions)("multiple",!1),e.R50("ngModel",n.pagination.regionId),e.R7$(4),e.FS9("placeholder",e.bMT(32,53,"client.client.cityName")),e.Y8G("items",n.cities)("multiple",!1),e.R50("ngModel",n.pagination.cityId),e.R7$(3),e.R50("ngModel",n.pagination.status),e.R7$(),e.Y8G("value",0),e.R7$(),e.Y8G("value",2),e.R7$(),e.Y8G("value",3),e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",n.loaderSearchShap)("loaderId",n.searchLoader),e.R7$(2),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[m.Sq,m.bT,d.qT,d.xH,d.y7,d.me,d.Q0,d.wz,d.BC,d.cb,d.YS,d.vS,d.cV,_.s5,D.kL,ke.m,A.b,te.w,Q.p,q.g,u.Mm,S.XI,z.Ei,S.Tg,C.Cv,E.vr,X.m,U.p,Pe._,m.vh,u.D9],encapsulation:2})}}return r})();var Me=c(56131);let Za=(()=>{class r extends Me.E{constructor(t,i,n){super(t,i,n)}static{this.\u0275fac=function(i){return new(i||r)(e.KVO(y.Ix),e.KVO(we),e.KVO(V.u))}}static{this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();c(67376);let Ue=(()=>{class r extends ce.d{constructor(t){super(t,J.c.apiUrl+"ClientCollection/")}static{this.\u0275fac=function(i){return new(i||r)(e.KVO(me.Qq))}}static{this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();const Wa=()=>["clientCollection.register"],eo=()=>["clientCollection.edit"],to=()=>["clientCollection.delete"];function no(r,o){1&r&&(e.j41(0,"tr",33)(1,"th",34),e.EFF(2,"#"),e.k0s(),e.j41(3,"th",35),e.nrm(4,"i",36),e.EFF(5," sales.clientCollection.clientName "),e.k0s(),e.j41(6,"th",37),e.nrm(7,"i",36),e.EFF(8," sales.clientCollection.paymentTypeName "),e.k0s(),e.j41(9,"th",38),e.nrm(10,"i",36),e.EFF(11," orderManagement.order.creation "),e.k0s(),e.j41(12,"th",39),e.nrm(13,"i",36),e.EFF(14," sales.clientCollection.cost "),e.k0s(),e.j41(15,"th",40),e.nrm(16,"i",36),e.EFF(17," sales.clientCollection.depositNumber "),e.k0s(),e.j41(18,"th",41),e.nrm(19,"i",36),e.EFF(20," sales.clientCollection.isSyncOdoo "),e.k0s(),e.j41(21,"th",42),e.nrm(22,"i",36),e.EFF(23," sales.clientCollection.syncDate "),e.k0s(),e.j41(24,"th",43),e.nrm(25,"i",36),e.EFF(26," sales.clientCollection.notes "),e.k0s(),e.nrm(27,"th",44),e.k0s())}function io(r,o){1&r&&e.nrm(0,"span",54)}function ro(r,o){1&r&&e.nrm(0,"span",55)}function so(r,o){if(1&r&&(e.nrm(0,"i",56),e.EFF(1),e.nI1(2,"date"),e.nrm(3,"br")(4,"i",57),e.EFF(5),e.nI1(6,"date"),e.nrm(7,"br")(8,"i",58),e.EFF(9)),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",e.i5U(2,3,t.creationTime,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",e.i5U(6,6,t.lastModificationTime,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",t.creatorName," ")}}function ao(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",59),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,s=e.XpG(),l=e.sdS(29);return e.Njj(s.EditModel(n.id,l))}),e.nrm(1,"i",60),e.k0s()}}function oo(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",61),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,s=e.XpG(),l=e.sdS(31);return e.Njj(s.openModal(n.id,l))}),e.nrm(1,"i",62),e.k0s()}}function lo(r,o){if(1&r&&(e.j41(0,"tr",45)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td")(8,"span",46),e.EFF(9),e.k0s(),e.EFF(10),e.nI1(11,"date"),e.k0s(),e.j41(12,"td"),e.EFF(13),e.k0s(),e.j41(14,"td"),e.EFF(15),e.k0s(),e.j41(16,"td"),e.DNE(17,io,1,0,"span",47)(18,ro,1,0,"span",48),e.k0s(),e.j41(19,"td"),e.EFF(20),e.nI1(21,"date"),e.k0s(),e.j41(22,"td"),e.EFF(23),e.k0s(),e.j41(24,"td"),e.DNE(25,so,10,9,"ng-template",null,3,e.C5r),e.nrm(27,"i",49),e.j41(28,"button",50),e.nrm(29,"i",51),e.k0s(),e.DNE(30,ao,2,0,"button",52)(31,oo,2,0,"button",53),e.k0s()()),2&r){const t=o.$implicit,i=o.rowIndex,n=e.sdS(26);e.R7$(2),e.JRh(i+1),e.R7$(2),e.JRh(t.clientName),e.R7$(2),e.JRh(t.paymentTypeName),e.R7$(3),e.SpI("",t.creatorName," "),e.R7$(),e.SpI(" ",e.i5U(11,14,t.creationTime,"yyyy-MM-dd")," "),e.R7$(3),e.JRh(t.cost),e.R7$(2),e.JRh(t.depositNumber),e.R7$(2),e.Y8G("ngIf",t.isSyncOdoo),e.R7$(),e.Y8G("ngIf",!t.isSyncOdoo),e.R7$(2),e.JRh(e.i5U(21,17,t.syncDate,"yyyy-MM-dd HH:mm:ss")),e.R7$(3),e.JRh(t.notes),e.R7$(4),e.Y8G("ngbTooltip",n),e.R7$(3),e.Y8G("hasPermission",e.lJ4(20,eo)),e.R7$(),e.Y8G("hasPermission",e.lJ4(21,to))}}function co(r,o){1&r&&(e.j41(0,"div",63),e.EFF(1," general.table.noData"),e.k0s())}function mo(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",64)(1,"div",65),e.nrm(2,"ngb-pagination-info",66),e.j41(3,"table-length",67),e.bIt("lengthChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",68)(5,"ngb-pagination",69),e.bIt("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.pagination.pageNumber,n)||(s.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function po(r,o){1&r&&(e.j41(0,"span",108),e.EFF(1,"general.action.register "),e.k0s())}function go(r,o){1&r&&(e.j41(0,"span",108),e.EFF(1,"general.action.edit "),e.k0s())}function _o(r,o){if(1&r){const t=e.RV6();e.j41(0,"i",109),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.removeMainImage())}),e.k0s()}}function uo(r,o){1&r&&(e.j41(0,"div",110),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function ho(r,o){1&r&&(e.j41(0,"div",110),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function fo(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",70)(1,"div",71)(2,"h4",72),e.DNE(3,po,2,0,"span",73)(4,go,2,0,"span",73),e.j41(5,"span",74),e.EFF(6),e.k0s()(),e.j41(7,"button",75),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss("Cross click"))}),e.k0s()(),e.j41(8,"div",76),e.nrm(9,"ngx-ui-loader",26),e.j41(10,"form",77,4),e.bIt("submit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.OnSubmit())}),e.j41(12,"div",78)(13,"div",79)(14,"div",80)(15,"div",81)(16,"label",82),e.bIt("click",function(){e.eBV(t);const n=e.sdS(21);return e.Njj(n.click())}),e.j41(17,"div",83)(18,"div",84),e.nrm(19,"i",85),e.k0s()()(),e.j41(20,"input",86,5),e.bIt("change",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.onFileChangedMain(n))}),e.k0s()(),e.j41(22,"div",87)(23,"div",88),e.DNE(24,_o,1,0,"i",89),e.j41(25,"div",90),e.nrm(26,"img",91),e.k0s()()()()()(),e.j41(27,"div",78)(28,"label",92),e.EFF(29,"sales.clientCollection.clientName"),e.k0s(),e.j41(30,"ng-select",93),e.bIt("scrollToEnd",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.scrollClient())}),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.clientId,n)||(s.form.clientId=n),e.Njj(n)}),e.k0s()(),e.j41(31,"div",78)(32,"label",94),e.EFF(33,"sales.salesInvoices.paymentTypeName"),e.k0s(),e.j41(34,"ng-select",95,6),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.paymentTypeId,n)||(s.form.paymentTypeId=n),e.Njj(n)}),e.k0s(),e.DNE(36,uo,2,0,"div",96),e.k0s(),e.j41(37,"div",97)(38,"label",98),e.EFF(39,"sales.clientCollection.cost"),e.k0s(),e.j41(40,"input",99,7),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.cost,n)||(s.form.cost=n),e.Njj(n)}),e.k0s(),e.DNE(42,ho,2,0,"div",100),e.k0s(),e.j41(43,"div",97)(44,"label",101),e.EFF(45,"sales.clientCollection.depositNumber"),e.k0s(),e.j41(46,"input",102,8),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.depositNumber,n)||(s.form.depositNumber=n),e.Njj(n)}),e.k0s()(),e.j41(48,"div",97)(49,"label",103),e.EFF(50,"sales.clientCollection.notes"),e.k0s(),e.j41(51,"textarea",104,9),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.notes,n)||(s.form.notes=n),e.Njj(n)}),e.k0s()(),e.j41(53,"div",79)(54,"button",105),e.nrm(55,"i",106)(56,"span",107),e.k0s()()()()()}if(2&r){const t=e.sdS(11),i=e.sdS(35),n=e.sdS(41),s=e.XpG();e.R7$(3),e.Y8G("ngIf",!s.isEditForm),e.R7$(),e.Y8G("ngIf",s.isEditForm),e.R7$(2),e.JRh(s.titleOperation),e.R7$(3),e.Y8G("hasProgressBar",!1)("fgsType",s.loaderOperationShap)("loaderId",s.operationLoader),e.R7$(15),e.Y8G("ngIf",s.image.path),e.R7$(2),e.Y8G("src",s.image.isApi?s.serverPath+s.image.path:s.image.path,e.B4B),e.R7$(4),e.Y8G("virtualScroll",!0)("items",s.clients)("typeahead",s.searchClient)("loading",s.loading)("multiple",!1),e.R50("ngModel",s.form.clientId),e.R7$(4),e.Y8G("items",s.paymentMethods)("multiple",!1),e.R50("ngModel",s.form.paymentTypeId),e.R7$(2),e.Y8G("ngIf",i.invalid&&i.touched),e.R7$(4),e.R50("ngModel",s.form.cost),e.R7$(2),e.Y8G("ngIf",n.invalid&&n.touched),e.R7$(4),e.R50("ngModel",s.form.depositNumber),e.R7$(5),e.R50("ngModel",s.form.notes),e.R7$(3),e.Y8G("disabled",!t.valid)}}function bo(r,o){if(1&r){const t=e.RV6();e.j41(0,"delete-modal",111),e.bIt("deleteConfirm",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.DeleteConfirmSoft())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}}let Co=(()=>{class r extends Y.w{constructor(t,i,n,s,l,a,f,M,R,O,w,k){super(t,i,f,n,s,l,a),this.baseService=n,this.excelService=R,this.clientService=O,this.paymentTypesService=w,this._formDataService=k,this.title="sales.clientCollection.title",this.titleOperation="sales.clientCollection.titleOperation",this.keySelected="",this.assignUsers=[],this.times=[],this.employees=[],this.searchForm={},this.isResolveList=!0,this.countLoad=2,this.clientParam={pageSize:50,pageNumber:1,search:"",clientId:null},this.clients=[],this.loading=!1,this.searchClient=new se.B,this.paymentMethods=[],this.image={},this.serverPath=J.c.mediaUrl,this.setDates=(v,j,b)=>{if(v?.from||v?.to){const G=v.to||v.from;this.pagination[j]=this.datePipe.transform(v.from||v.to,"yyyy-MM-ddT00:00:00"),this.pagination[b]=this.datePipe.transform(G,"yyyy-MM-ddT23:59:59.999")}else this.pagination[j]=null,this.pagination[b]=null},this.configRoute()}ngOnInitMore(){this.searchClient.pipe((0,je.B)(300),(0,Ie.F)(),(0,le.n)(t=>this.loadClient(t))).subscribe(),this.getPaymentTypes()}getPaymentTypes(){this.paymentTypesService.getDropDown().subscribe({next:t=>{this.paymentMethods=t.data}})}onSearch(){this.ngxLoader.startLoader(g.a7);let t={...this.searchForm};this.pagination.depositNumber&&(this.pagination.depositNumber=this.pagination.depositNumber.toString()),this.setDates(t.creationDates,"dateFrom","dateTo"),this.loadentities()}loadClient(t){return this.loading=!0,""==t||null==t?(this.loading=!1,(0,ye.of)([])):this.getClientDropdwon(t)}getClientDropdwon(t=""){return this.clientParam.search=t,this.clientParam.clientId=null,this.clientParam.pageNumber=1,this.clientService.GetClientSearch(this.clientParam).pipe((0,le.n)(i=>(this.clients=i.data,this.loading=!1,[])))}mapForm(t){let i={...t};return this._formDataService.formatFormData(i)}mapRegisterForm(t){let i={...t};return i.id=0,this._formDataService.formatFormData(i)}OnSearch(t){this.ngxLoader.startLoader(g.a7),this.loadentities()}configRoute(){}EditModel(t,i,n="md"){this.isEditForm=!0,this.image={},this.baseService.getById(t).pipe((0,p.Q)(this.notifier)).subscribe(s=>{s.success?(this.clientParam.clientId=s.data.clientId,this.clientParam.search="",this.clientService.GetClientSearch(this.clientParam).subscribe(l=>{this.clients=l.data}),this.image.path=s.data.path,this.image.isApi=!0,this.form=s.data):this.alertService.error("general.message."+s.message),this.modalService.open(i,{centered:!0,size:n})},s=>{this.alertService.error()})}mapExcel(){let t=[];return this.entities?.forEach(i=>{t.push({Client_Name:i.clientName,Date:this.datePipe.transform(i.creationTime,"yyyy-MM-dd HH:mm"),User:i.creatorName,Payment_Name:i.paymentTypeName,Cost:i.cost,DepositNumber:i.depositNumber,Sync_Odoo:this.getTranslationText(i.isSyncOdoo?"sales.salesOrder.syncSend":"sales.salesOrder.syncNotSend"),Notes:i.notes})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.getTranslationText(this.title),[])}editEntity(){let t=this.mapForm(this.form);this.baseService.editPut(this.form.id,t).pipe((0,T.O)(),(0,N.c)(this.mainDelay),(0,x.Z)(),(0,p.Q)(this.notifier),(0,I.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(i=>{i.success?this.submitFunished():this.alertService.error("general.message."+i.message)},i=>{this.alertService.error("general.message."+i)})}scrollClient(){this.clientParam.pageNumber=this.clientParam.pageNumber+1,this.clientService.GetClientSearch(this.clientParam).subscribe(t=>{this.clients=[...this.clients,...t.data]})}onFileChangedMain(t){if(t.target.files&&t.target.files[0]){let i=t.target.files.length;for(let n=0;n<i;n++){let s=new FileReader;this.form.image=t.target.files.item(n),s.onload=l=>{this.image={isApi:!1,path:l.target.result}},s.readAsDataURL(t.target.files[n]),console.log(this.image)}}}removeMainImage(){this.form.image="",this.image={isApi:!1,path:""}}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(y.nX),e.rXU(u.c$),e.rXU(Ue),e.rXU(V.u),e.rXU(m.vh),e.rXU(C.eD),e.rXU(_.Bq),e.rXU(e.gRc),e.rXU(H.V),e.rXU(pe.X),e.rXU(Be),e.rXU(Ge.Q))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-clientCollection"]],features:[e.Vt3],decls:32,vars:33,consts:[["tableMaster",""],["operation",""],["deleteModal",""],["tooltipContent",""],["formEntity","ngForm"],["FileInputMain",""],["paymentTypeId","ngModel"],["cost","ngModel"],["depositNumber","ngModel"],["notes","ngModel"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],[3,"reset","search","exportXlsx","addNew","addPermission","totalItems","title"],["control",""],[1,"col-md-3","mb-2"],[1,"search-box"],["type","search","id","name","name","name",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],[1,"col-12","col-md-2","mb-2"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"col-12","col-md-2"],["name","paymentTypeId","bindValue","code","bindLabel","name","required","",3,"ngModelChange","items","multiple","placeholder","ngModel"],[1,"col-md-2","mb-2"],["type","number","id","depositNumber","name","depositNumber",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"card-body"],[3,"hasProgressBar","fgsType","loaderId"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["translate","",2,"width",".5%"],["pSortableColumn","clientId","translate","",2,"width","10%"],[1,"ri-expand-up-down-line"],["pSortableColumn","paymentTypeName","translate","",2,"width","8%"],["pSortableColumn","creationTime","translate","",2,"width","12%"],["pSortableColumn","cost","translate","",2,"width","5%"],["pSortableColumn","depositNumber","translate","",2,"width","8%"],["pSortableColumn","isSyncOdoo","translate","",2,"width","6%"],["pSortableColumn","syncDate","translate","",2,"width","8%"],["pSortableColumn","notes","translate","",2,"width","8%"],["translate","",2,"width","12%"],[1,"fs-5"],[1,"badge","bg-success-subtle","text-success"],["class","badge bg-success","translate","sales.salesOrder.syncSend",4,"ngIf"],["class","badge bg-warning","translate","sales.salesOrder.syncNotSend",4,"ngIf"],["tooltipPosition","top",1,"mdi","mdi-cog-outline","text-muted","fs-16","align-middle","me-1",3,"ngbTooltip"],[1,"btn","btn-sm","btn-soft-warning","edit-list","mx-2"],[1,"ri-refresh-fill","align-bottom","mx-1"],["class","btn btn-sm btn-soft-info edit-list mx-2",3,"click",4,"hasPermission"],["class","btn btn-sm btn-soft-danger remove-list",3,"click",4,"hasPermission"],["translate","sales.salesOrder.syncSend",1,"badge","bg-success"],["translate","sales.salesOrder.syncNotSend",1,"badge","bg-warning"],[1,"ri-history-fill","text-warning"],[1,"ri-history-fill","text-danger"],[1,"ri-user-location-fill","text-primary"],[1,"btn","btn-sm","btn-soft-info","edit-list","mx-2",3,"click"],[1,"ri-pencil-fill","align-bottom","mx-1"],[1,"btn","btn-sm","btn-soft-danger","remove-list",3,"click"],[1,"ri-delete-bin-5-fill","align-bottom"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["class","fw-bold fs-4","translate","",4,"ngIf"],["translate",""],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"submit"],[1,"mb-3"],[1,"text-center"],[1,"position-relative","d-inline-block"],[1,"position-absolute","top-100","start-100","translate-middle"],["placement","right","ngbTooltip","Select Image",1,"mb-0",3,"click"],[1,"avatar-xs"],[1,"avatar-title","bg-light","border","rounded-circle","text-muted","cursor-pointer"],[1,"ri-image-fill"],["value","","type","file","accept","image/png, image/gif, image/jpeg",1,"form-control","d-none",3,"change"],[1,"d-flex"],[1,"avatar-lg","mx-2","position-relative"],["class","position-absolute bx bx-x-circle text-white","style","background: red; top: 1px; right: -4px; font-size: 1rem;\n                                                        border-radius: 50% ",3,"click",4,"ngIf"],[1,"avatar-title","bg-light","rounded"],["id","product-img2","alt","",1,"avatar-md","h-auto",3,"src"],["for","nameAr","translate","",1,"required","fw-bold","form-label"],["bindLabel","displayName","bindValue","id","name","clientId","required","",3,"scrollToEnd","ngModelChange","virtualScroll","items","typeahead","loading","multiple","ngModel"],["translate","",1,"required","fw-bold","form-label","w-100"],["name","paymentTypeId","bindValue","code","bindLabel","name","required","",3,"ngModelChange","items","multiple","ngModel"],["class","text-danger text-center","translate","",4,"ngIf"],[1,"mb-2"],["for","cost","translate","",1,"fw-bold","form-label"],["InputTirmFilter","","name","cost","type","text","id","cost",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["class","text-danger text-center  ","translate","",4,"ngIf"],["for","depositNumber","translate","",1,"fw-bold","form-label"],["InputTirmFilter","","name","depositNumber","type","text","id","depositNumber",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["for","notes","translate","",1,"fw-bold","form-label"],["rows","2","InputTirmFilter","","name","notes","type","text","id","notes",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["type","submit","type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],["translate","",1,"fw-bold","fs-4"],[1,"position-absolute","bx","bx-x-circle","text-white",2,"background","red","top","1px","right","-4px","font-size","1rem","border-radius","50%",3,"click"],["translate","",1,"text-danger","text-center"],[3,"deleteConfirm","dismiss"]],template:function(i,n){if(1&i){const s=e.RV6();e.j41(0,"div",10)(1,"div",11)(2,"div",12)(3,"base-filter",13),e.bIt("reset",function(){return e.eBV(s),e.Njj(n.onReset())})("search",function(){return e.eBV(s),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(s),e.Njj(n.onExportXlsx())})("addNew",function(){e.eBV(s);const a=e.sdS(29);return e.Njj(n.openModalTitle(a,"md"))}),e.qex(4,14),e.j41(5,"div",15)(6,"div",16)(7,"input",17),e.nI1(8,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.name,a)||(n.pagination.name=a),e.Njj(a)}),e.k0s(),e.nrm(9,"i",18),e.k0s()(),e.j41(10,"div",19)(11,"input",20),e.nI1(12,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.searchForm.creationDates,a)||(n.searchForm.creationDates=a),e.Njj(a)}),e.k0s()(),e.j41(13,"div",21)(14,"ng-select",22),e.nI1(15,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.paymentTypeId,a)||(n.pagination.paymentTypeId=a),e.Njj(a)}),e.k0s()(),e.j41(16,"div",23)(17,"input",24),e.nI1(18,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.depositNumber,a)||(n.pagination.depositNumber=a),e.Njj(a)}),e.k0s()(),e.bVm(),e.k0s(),e.j41(19,"div",25),e.nrm(20,"ngx-ui-loader",26),e.j41(21,"div",27)(22,"p-table",28,0),e.bIt("onLazyLoad",function(a){return e.eBV(s),e.Njj(n.tableChange(a))})("selectionChange",function(a){return e.eBV(s),e.Njj(n.onSelectionChange(a))}),e.DNE(24,no,28,0,"ng-template",29)(25,lo,32,22,"ng-template",30),e.k0s()(),e.DNE(26,co,2,0,"div",31)(27,mo,6,8,"div",32),e.k0s()()()(),e.DNE(28,fo,57,23,"ng-template",null,1,e.C5r)(30,bo,1,0,"ng-template",null,2,e.C5r)}2&i&&(e.R7$(3),e.Y8G("addPermission",e.lJ4(32,Wa))("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(8,24,"general.table.name")),e.R50("ngModel",n.pagination.name),e.R7$(4),e.FS9("placeholder",e.bMT(12,26,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(3),e.FS9("placeholder",e.bMT(15,28,"sales.salesInvoices.paymentTypeName")),e.Y8G("items",n.paymentMethods)("multiple",!1),e.R50("ngModel",n.pagination.paymentTypeId),e.R7$(3),e.FS9("placeholder",e.bMT(18,30,"sales.clientCollection.depositNumber")),e.R50("ngModel",n.pagination.depositNumber),e.R7$(3),e.Y8G("hasProgressBar",!1)("fgsType",n.loaderSearchShap)("loaderId",n.searchLoader),e.R7$(2),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[m.bT,d.qT,d.me,d.Q0,d.BC,d.cb,d.YS,d.vS,d.cV,_.s5,D.kL,A.b,te.w,Q.p,q.g,u.Mm,S.XI,z.Ei,S.Tg,C.Cv,E.vr,_.md,X.m,U.p,m.vh,u.D9],encapsulation:2})}}return r})();const So=()=>["requestPersonSales.register"],vo=()=>["requestPersonSales.changeStatus"],jo=()=>["requestPersonSales.edit"],Io=()=>["requestPersonSales.delete"];function yo(r,o){1&r&&(e.j41(0,"tr",46)(1,"th",47),e.EFF(2,"#"),e.k0s(),e.j41(3,"th",48),e.nrm(4,"i",49),e.EFF(5," sales.clientCollection.clientName "),e.k0s(),e.j41(6,"th",50),e.nrm(7,"i",49),e.EFF(8," orderManagement.order.creation "),e.k0s(),e.j41(9,"th",51),e.EFF(10," sales.salesOrder.salsePerson "),e.k0s(),e.j41(11,"th",52),e.nrm(12,"i",49),e.EFF(13," sales.clientCollection.cost "),e.k0s(),e.j41(14,"th",53),e.nrm(15,"i",49),e.EFF(16," sales.requestPersonSales.requestPersonStatus "),e.k0s(),e.j41(17,"th",54),e.nrm(18,"i",49),e.EFF(19," sales.clientCollection.notes "),e.k0s(),e.nrm(20,"th",55),e.k0s())}function ko(r,o){if(1&r&&(e.nrm(0,"i",61),e.EFF(1),e.nI1(2,"date"),e.nrm(3,"br")(4,"i",62),e.EFF(5),e.nI1(6,"date"),e.nrm(7,"br")(8,"i",63),e.EFF(9)),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",e.i5U(2,3,t.creationTime,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",e.i5U(6,6,t.lastModificationTime,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",t.creatorName," ")}}function To(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",64),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,s=e.XpG(),l=e.sdS(83);return e.Njj(s.openModal(n.id,l))}),e.nrm(1,"i",65),e.k0s()}}function xo(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",68),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2).$implicit,s=e.XpG(),l=e.sdS(79);return e.Njj(s.EditModel(n.id,l))}),e.nrm(1,"i",69),e.k0s()}}function Mo(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",70),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2).$implicit,s=e.XpG(),l=e.sdS(81);return e.Njj(s.openModal(n.id,l))}),e.nrm(1,"i",71),e.k0s()}}function Ro(r,o){1&r&&(e.qex(0),e.DNE(1,xo,2,0,"button",66)(2,Mo,2,0,"button",67),e.bVm()),2&r&&(e.R7$(),e.Y8G("hasPermission",e.lJ4(2,jo)),e.R7$(),e.Y8G("hasPermission",e.lJ4(3,Io)))}function Oo(r,o){if(1&r&&(e.j41(0,"tr",56)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.nI1(7,"date"),e.k0s(),e.j41(8,"td"),e.EFF(9),e.k0s(),e.j41(10,"td"),e.EFF(11),e.k0s(),e.j41(12,"td")(13,"span"),e.nrm(14,"span",57),e.k0s()(),e.j41(15,"td"),e.EFF(16),e.k0s(),e.j41(17,"td"),e.DNE(18,ko,10,9,"ng-template",null,4,e.C5r),e.nrm(20,"i",58),e.DNE(21,To,2,0,"button",59)(22,Ro,3,4,"ng-container",60),e.k0s()()),2&r){const t=o.$implicit,i=o.rowIndex,n=e.sdS(19),s=e.XpG();e.R7$(2),e.JRh(i+1),e.R7$(2),e.JRh(t.clientName),e.R7$(2),e.SpI(" ",e.i5U(7,13,t.creationTime,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(3),e.JRh(t.creatorName),e.R7$(2),e.JRh(t.cost),e.R7$(2),e.ZvI("badge ",s.getStatus(t.requestPersonStatus),""),e.R7$(),e.FS9("translate","sales.salesOrder."+t.requestPersonStatusName),e.R7$(2),e.JRh(t.notes),e.R7$(4),e.Y8G("ngbTooltip",n),e.R7$(),e.Y8G("hasPermission",e.lJ4(16,vo)),e.R7$(),e.Y8G("ngIf",30!=t.requestPersonStatus)}}function Fo(r,o){1&r&&(e.j41(0,"div",72),e.EFF(1," general.table.noData"),e.k0s())}function No(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",73)(1,"div",74),e.nrm(2,"ngb-pagination-info",75),e.j41(3,"table-length",76),e.bIt("lengthChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",77)(5,"ngb-pagination",78),e.bIt("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.pagination.pageNumber,n)||(s.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function wo(r,o){1&r&&(e.j41(0,"span",101),e.EFF(1,"general.action.register "),e.k0s())}function Go(r,o){1&r&&(e.j41(0,"span",101),e.EFF(1,"general.action.edit "),e.k0s())}function Vo(r,o){1&r&&(e.j41(0,"div",102),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function Do(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",79)(1,"div",80)(2,"h4",81),e.DNE(3,wo,2,0,"span",82)(4,Go,2,0,"span",82),e.j41(5,"span",83),e.EFF(6),e.k0s()(),e.j41(7,"button",84),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss("Cross click"))}),e.k0s()(),e.j41(8,"div",85),e.nrm(9,"ngx-ui-loader",86),e.j41(10,"form",87,5),e.bIt("submit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.OnSubmit())}),e.j41(12,"div",88)(13,"label",89),e.EFF(14,"sales.clientCollection.clientName"),e.k0s(),e.j41(15,"ng-select",90),e.bIt("scrollToEnd",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.scrollClient())}),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.clientId,n)||(s.form.clientId=n),e.Njj(n)}),e.k0s()(),e.j41(16,"div",91)(17,"label",92),e.EFF(18,"sales.clientCollection.cost"),e.k0s(),e.j41(19,"input",93,6),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.cost,n)||(s.form.cost=n),e.Njj(n)}),e.k0s(),e.DNE(21,Vo,2,0,"div",94),e.k0s(),e.j41(22,"div",91)(23,"label",95),e.EFF(24,"sales.clientCollection.notes"),e.k0s(),e.j41(25,"textarea",96,7),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.notes,n)||(s.form.notes=n),e.Njj(n)}),e.k0s()(),e.j41(27,"div",97)(28,"button",98),e.nrm(29,"i",99)(30,"span",100),e.k0s()()()()()}if(2&r){const t=e.sdS(11),i=e.sdS(20),n=e.XpG();e.R7$(3),e.Y8G("ngIf",!n.isEditForm),e.R7$(),e.Y8G("ngIf",n.isEditForm),e.R7$(2),e.JRh(n.titleOperation),e.R7$(3),e.Y8G("hasProgressBar",!1)("fgsType",n.loaderOperationShap)("loaderId",n.operationLoader),e.R7$(6),e.Y8G("virtualScroll",!0)("items",n.clients)("typeahead",n.searchClient)("loading",n.loading)("multiple",!1),e.R50("ngModel",n.form.clientId),e.R7$(4),e.R50("ngModel",n.form.cost),e.R7$(2),e.Y8G("ngIf",i.invalid&&i.touched),e.R7$(4),e.R50("ngModel",n.form.notes),e.R7$(3),e.Y8G("disabled",!t.valid)}}function Eo(r,o){if(1&r){const t=e.RV6();e.j41(0,"delete-modal",103),e.bIt("deleteConfirm",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.DeleteConfirmSoft())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}}function Lo(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",88)(1,"label",108),e.EFF(2,"sales.clientCollection.cost"),e.k0s(),e.j41(3,"input",109),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG(2);return e.DH7(s.form.cost,n)||(s.form.cost=n),e.Njj(n)}),e.k0s()()}if(2&r){const t=e.XpG(2);e.R7$(3),e.R50("ngModel",t.form.cost)}}function $o(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",79)(1,"div",80)(2,"h4",81)(3,"span",83),e.EFF(4),e.k0s()(),e.j41(5,"button",84),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss("Cross click"))}),e.k0s()(),e.j41(6,"div",85),e.nrm(7,"ngx-ui-loader",86),e.j41(8,"form",87,5),e.bIt("submit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.OnStatusSubmit())}),e.j41(10,"div",27)(11,"div",88)(12,"label",104),e.EFF(13,"sales.requestPersonSales.requestPersonStatus"),e.k0s(),e.j41(14,"ng-select",105),e.nI1(15,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.requestPersonStatus,n)||(s.form.requestPersonStatus=n),e.Njj(n)}),e.k0s()(),e.DNE(16,Lo,4,1,"div",106),e.k0s(),e.j41(17,"div",97)(18,"button",107),e.nrm(19,"i",99)(20,"span",100),e.k0s()()()()()}if(2&r){const t=e.sdS(9),i=e.XpG();e.R7$(4),e.JRh(i.titleOperation),e.R7$(3),e.Y8G("hasProgressBar",!1)("fgsType",i.loaderOperationShap)("loaderId",i.operationLoader),e.R7$(7),e.FS9("placeholder",e.bMT(15,10,"sales.requestPersonSales.requestPersonStatus")),e.Y8G("items",i.status)("multiple",!1),e.R50("ngModel",i.form.requestPersonStatus),e.R7$(2),e.Y8G("ngIf",30==i.form.requestPersonStatus),e.R7$(2),e.Y8G("disabled",!t.valid)}}let Xo=(()=>{class r extends Y.w{constructor(t,i,n,s,l,a,f,M,R,O,w){super(t,i,f,n,s,l,a),this.baseService=n,this.excelService=R,this.clientService=O,this.employeeService=w,this.title="sales.requestPersonSales.title",this.titleOperation="sales.requestPersonSales.titleOperation",this.searchForm={},this.isResolveList=!0,this.countLoad=2,this.clientParam={pageSize:50,pageNumber:1,search:"",clientId:null},this.clients=[],this.loading=!1,this.searchClient=new se.B,this.status=[],this.requestStatus={all:0,pending:0,underReview:0,accept:0,reject:0},this.option={startVal:0,useEasing:!0,duration:2,decimalPlaces:0},this.salesPersons=[],this.setDates=(k,v,j)=>{if(k?.from||k?.to){const h=k.to||k.from;this.pagination[v]=this.datePipe.transform(k.from||k.to,"yyyy-MM-ddT00:00:00"),this.pagination[j]=this.datePipe.transform(h,"yyyy-MM-ddT23:59:59.999")}else this.pagination[v]=null,this.pagination[j]=null},this.configRoute(),this.GetSalesPersons()}ngOnInitMore(){this.GetRequestCount(),this.searchClient.pipe((0,je.B)(300),(0,Ie.F)(),(0,le.n)(t=>this.loadClient(t))).subscribe(),this.GetRequestLookups()}GetSalesPersons(){this.employeeService.GetAllByType(9).subscribe(t=>{this.salesPersons=t.data},t=>{console.log(t)})}GetRequestCount(){this.baseService.GetRequestCount().pipe((0,p.Q)(this.notifier)).subscribe(t=>{this.requestStatus=t.data})}GetRequestLookups(){this.baseService.GetRequestLookups().pipe((0,p.Q)(this.notifier)).subscribe(t=>{let i=t.data.status;i.forEach(n=>{n.name=this.getTranslationText("sales.salesOrder."+n.name)}),this.status=i})}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader("allLoader"),this.setDates(t.creationDates,"dateFrom","dateTo"),this.loadentities()}loadClient(t){return this.loading=!0,""==t||null==t?(this.loading=!1,(0,ye.of)([])):this.getClientDropdwon(t)}getClientDropdwon(t=""){return this.clientParam.search=t,this.clientParam.clientId=null,this.clientParam.pageNumber=1,this.clientService.GetClientSearch(this.clientParam).pipe((0,le.n)(i=>(this.clients=i.data,this.loading=!1,[])),(0,p.Q)(this.notifier))}mapForm(t){return{...t}}mapRegisterForm(t){let i={...t};return i.id=0,i}OnSearch(t){this.ngxLoader.startLoader(g.a7),this.loadentities()}configRoute(){}EditModel(t,i,n="md"){this.isEditForm=!0,this.baseService.getById(t).pipe((0,p.Q)(this.notifier)).subscribe(s=>{s.success?(this.clientParam.clientId=s.data.clientId,this.clientParam.search="",this.clientService.GetClientSearch(this.clientParam).pipe((0,p.Q)(this.notifier)).subscribe(l=>{this.clients=l.data}),this.form=s.data):this.alertService.error("general.message."+s.message),this.modalService.open(i,{centered:!0,size:n})},s=>{this.alertService.error()})}mapExcel(){let t=[];return this.entities?.forEach(i=>{t.push({nameAr:i.nameAr,nameEn:i.nameEn,isActive:this.getTranslationText("general.table.active"),notes:i.notes})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.getTranslationText(this.title),[])}editEntity(){let t=this.mapForm(this.form);this.baseService.editPut(t.id,t).pipe((0,T.O)(),(0,N.c)(this.mainDelay),(0,x.Z)(),(0,p.Q)(this.notifier),(0,I.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(i=>{i.success?this.submitFunished():this.alertService.error("general.message."+i.message)},i=>{this.alertService.error("general.message."+i)})}scrollClient(){this.clientParam.pageNumber=this.clientParam.pageNumber+1,this.clientService.GetClientSearch(this.clientParam).subscribe(t=>{this.clients=[...this.clients,...t.data]})}getStatus(t){return 10==t||20==t?"bg-warning-subtle text-warning":30==t?"bg-success-subtle text-success":40==t?"bg-danger-subtle text-danger":"bg-warning-subtle text-warning"}OnStatusSubmit(){let t={requestPersonStatus:this.form.requestPersonStatus,id:this.operationId,cost:this.form.cost?this.form.cost:0};this.ngxLoader.start(g.ZW),this.baseService.UpdateLimit(t).pipe((0,T.O)(),(0,N.c)(this.mainDelay),(0,x.Z)(),(0,p.Q)(this.notifier),(0,I.j)(()=>this.ngxLoader.stopLoader(g.ZW))).subscribe(i=>{i.success?(this.alertService.success(),this.modalService.dismissAll(),this.loadentities(),this.GetRequestCount()):this.alertService.error("general.message."+i.message)},i=>{this.alertService.error("general.message."+i)})}onStatusSelect(t){this.pagination.requestPersonStatus=0==t?null:t,this.loadentities()}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(y.nX),e.rXU(u.c$),e.rXU(Fe.u),e.rXU(V.u),e.rXU(m.vh),e.rXU(C.eD),e.rXU(_.Bq),e.rXU(e.gRc),e.rXU(H.V),e.rXU(pe.X),e.rXU(Z.O))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-requestPersonSales"]],features:[e.Vt3],decls:84,vars:44,consts:[["tableMaster",""],["operation",""],["deleteModal",""],["operationStatus",""],["tooltipContent",""],["formEntity","ngForm"],["cost","ngModel"],["notes","ngModel"],[3,"title","breadcrumbItems"],[1,"row","justify-content-around"],[1,"col-12","col-md-3","cursor-pointer"],[1,"card","card-animate",3,"click"],[1,"card-body"],[1,"d-flex","justify-content-between"],["translate","sales.salesOrder.all",1,"fw-medium","text-muted","mb-0"],[1,"mt-4","ff-secondary","fw-semibold"],[1,"counter-value",3,"countUp","options"],[1,"avatar-sm","flex-shrink-0"],[1,"avatar-title","bg-primary-subtle","text-primary","rounded-circle","fs-4"],[1,"ri-ticket-2-line"],[1,"col-12","col-md-2","cursor-pointer"],["translate","sales.salesOrder.UnderReview",1,"fw-medium","text-muted","mb-0"],[1,"avatar-title","bg-warning-subtle","text-warning","rounded-circle","fs-4"],["translate","sales.salesOrder.Accept",1,"fw-medium","text-muted","mb-0"],[1,"avatar-title","bg-success-subtle","text-success","rounded-circle","fs-4"],["translate","sales.salesOrder.Reject",1,"fw-medium","text-muted","mb-0"],[1,"avatar-title","bg-danger-subtle","text-danger","rounded-circle","fs-4"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],[3,"reset","search","exportXlsx","addNew","addPermission","totalItems","title"],["control",""],[1,"col-md-3","mb-2"],[1,"search-box"],["type","search","id","name","name","name",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],[1,"col-12","col-md-3","mb-2"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"col-12","col-md-2","mb-2"],["name","name","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["translate","",2,"width",".5%"],["pSortableColumn","clientId","translate","",2,"width","15%"],[1,"ri-expand-up-down-line"],["pSortableColumn","creationTime","translate","",2,"width","12%"],["translate","",2,"width","8%"],["pSortableColumn","cost","translate","",2,"width","5%"],["pSortableColumn","requestPersonStatus","translate","",2,"width","8%"],["pSortableColumn","notes","translate","",2,"width","10%"],["translate","",2,"width","15%"],[1,"fs-5"],[3,"translate"],["tooltipPosition","top",1,"mdi","mdi-cog-outline","text-muted","fs-16","align-middle","me-1",3,"ngbTooltip"],["class","btn btn-sm btn-soft-warning edit-list mx-2 ",3,"click",4,"hasPermission"],[4,"ngIf"],[1,"ri-history-fill","text-warning"],[1,"ri-history-fill","text-danger"],[1,"ri-user-location-fill","text-primary"],[1,"btn","btn-sm","btn-soft-warning","edit-list","mx-2",3,"click"],[1,"ri-exchange-line","align-bottom","mx-1"],["class","btn btn-sm btn-soft-info edit-list mx-2",3,"click",4,"hasPermission"],["class","btn btn-sm btn-soft-danger remove-list",3,"click",4,"hasPermission"],[1,"btn","btn-sm","btn-soft-info","edit-list","mx-2",3,"click"],[1,"ri-pencil-fill","align-bottom","mx-1"],[1,"btn","btn-sm","btn-soft-danger","remove-list",3,"click"],[1,"ri-delete-bin-5-fill","align-bottom"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["class","fw-bold fs-4","translate","",4,"ngIf"],["translate",""],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"hasProgressBar","fgsType","loaderId"],[3,"submit"],[1,"mb-3"],["for","nameAr","translate","",1,"required","fw-bold","form-label"],["bindLabel","displayName","bindValue","id","name","clientId","required","",3,"scrollToEnd","ngModelChange","virtualScroll","items","typeahead","loading","multiple","ngModel"],[1,"mb-2"],["for","cost","translate","",1,"fw-bold","form-label"],["InputTirmFilter","","name","cost","type","text","id","cost",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["class","text-danger text-center  ","translate","",4,"ngIf"],["for","notes","translate","",1,"fw-bold","form-label"],["rows","2","InputTirmFilter","","name","notes","type","text","id","notes",1,"form-control","fs-6",3,"ngModelChange","ngModel"],[1,"text-center"],["type","submit","type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],["translate","",1,"fw-bold","fs-4"],["translate","",1,"text-danger","text-center"],[3,"deleteConfirm","dismiss"],["for","status","translate","",1,"required","fw-bold","form-label"],["name","name","bindValue","id","bindLabel","name","required","",3,"ngModelChange","placeholder","items","multiple","ngModel"],["class","mb-3",4,"ngIf"],["type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],["for","cost","translate","",1,"required","fw-bold","form-label"],["type","numbers","id","cost","name","cost",1,"form-control",3,"ngModelChange","ngModel"]],template:function(i,n){if(1&i){const s=e.RV6();e.nrm(0,"app-breadcrumbs",8),e.nI1(1,"translate"),e.j41(2,"div",9)(3,"div",10)(4,"div",11),e.bIt("click",function(){return e.eBV(s),e.Njj(n.onStatusSelect(0))}),e.j41(5,"div",12)(6,"div",13)(7,"div"),e.nrm(8,"p",14),e.j41(9,"h2",15),e.nrm(10,"span",16),e.k0s()(),e.j41(11,"div")(12,"div",17)(13,"span",18),e.nrm(14,"i",19),e.k0s()()()()()()(),e.j41(15,"div",20)(16,"div",11),e.bIt("click",function(){return e.eBV(s),e.Njj(n.onStatusSelect(20))}),e.j41(17,"div",12)(18,"div",13)(19,"div"),e.nrm(20,"p",21),e.j41(21,"h2",15),e.nrm(22,"span",16),e.k0s()(),e.j41(23,"div")(24,"div",17)(25,"span",22),e.nrm(26,"i",19),e.k0s()()()()()()(),e.j41(27,"div",20)(28,"div",11),e.bIt("click",function(){return e.eBV(s),e.Njj(n.onStatusSelect(30))}),e.j41(29,"div",12)(30,"div",13)(31,"div"),e.nrm(32,"p",23),e.j41(33,"h2",15),e.nrm(34,"span",16),e.k0s()(),e.j41(35,"div")(36,"div",17)(37,"span",24),e.nrm(38,"i",19),e.k0s()()()()()()(),e.j41(39,"div",20)(40,"div",11),e.bIt("click",function(){return e.eBV(s),e.Njj(n.onStatusSelect(40))}),e.j41(41,"div",12)(42,"div",13)(43,"div"),e.nrm(44,"p",25),e.j41(45,"h2",15),e.nrm(46,"span",16),e.k0s()(),e.j41(47,"div")(48,"div",17)(49,"span",26),e.nrm(50,"i",19),e.k0s()()()()()()()(),e.j41(51,"div",27)(52,"div",28)(53,"div",29)(54,"base-filter",30),e.bIt("reset",function(){return e.eBV(s),e.Njj(n.onReset())})("search",function(){return e.eBV(s),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(s),e.Njj(n.onExportXlsx())})("addNew",function(){e.eBV(s);const a=e.sdS(79);return e.Njj(n.openModalTitle(a,"md"))}),e.qex(55,31),e.j41(56,"div",32)(57,"div",33)(58,"input",34),e.nI1(59,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.name,a)||(n.pagination.name=a),e.Njj(a)}),e.k0s(),e.nrm(60,"i",35),e.k0s()(),e.j41(61,"div",36)(62,"input",37),e.nI1(63,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.searchForm.creationDates,a)||(n.searchForm.creationDates=a),e.Njj(a)}),e.k0s()(),e.j41(64,"div",38)(65,"ng-select",39),e.nI1(66,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.salesPersonId,a)||(n.pagination.salesPersonId=a),e.Njj(a)}),e.k0s()(),e.j41(67,"div",38)(68,"ng-select",39),e.nI1(69,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.requestPersonStatus,a)||(n.pagination.requestPersonStatus=a),e.Njj(a)}),e.k0s()(),e.bVm(),e.k0s(),e.j41(70,"div",12)(71,"div",40)(72,"p-table",41,0),e.bIt("onLazyLoad",function(a){return e.eBV(s),e.Njj(n.tableChange(a))})("selectionChange",function(a){return e.eBV(s),e.Njj(n.onSelectionChange(a))}),e.DNE(74,yo,21,0,"ng-template",42)(75,Oo,23,17,"ng-template",43),e.k0s()(),e.DNE(76,Fo,2,0,"div",44)(77,No,6,8,"div",45),e.k0s()()()(),e.DNE(78,Do,31,16,"ng-template",null,1,e.C5r)(80,Eo,1,0,"ng-template",null,2,e.C5r)(82,$o,21,12,"ng-template",null,3,e.C5r)}2&i&&(e.FS9("title",e.bMT(1,33,n.title)),e.Y8G("breadcrumbItems",n.breadCrumbItems),e.R7$(10),e.Y8G("countUp",null==n.requestStatus?null:n.requestStatus.all)("options",n.option),e.R7$(12),e.Y8G("countUp",null==n.requestStatus?null:n.requestStatus.underReview)("options",n.option),e.R7$(12),e.Y8G("countUp",null==n.requestStatus?null:n.requestStatus.accept)("options",n.option),e.R7$(12),e.Y8G("countUp",null==n.requestStatus?null:n.requestStatus.reject)("options",n.option),e.R7$(8),e.Y8G("addPermission",e.lJ4(43,So))("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(59,35,"general.table.name")),e.R50("ngModel",n.pagination.name),e.R7$(4),e.FS9("placeholder",e.bMT(63,37,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(3),e.FS9("placeholder",e.bMT(66,39,"sales.salesOrder.salsePerson")),e.Y8G("items",n.salesPersons)("multiple",!1),e.R50("ngModel",n.pagination.salesPersonId),e.R7$(3),e.FS9("placeholder",e.bMT(69,41,"sales.requestPersonSales.requestPersonStatus")),e.Y8G("items",n.status)("multiple",!1),e.R50("ngModel",n.pagination.requestPersonStatus),e.R7$(4),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[m.bT,d.qT,d.me,d.BC,d.cb,d.YS,d.vS,d.cV,_.s5,D.kL,oe.G,ke.m,A.b,te.w,Q.p,q.g,u.Mm,S.XI,z.Ei,S.Tg,C.Cv,E.vr,_.md,X.m,U.p,m.vh,u.D9],encapsulation:2})}}return r})();c(39974),c(85343),c(54360),c(58750);let Ve=(()=>{class r extends ce.d{constructor(t){super(t,J.c.apiUrl+"PriceList/")}UpdatePriceListItemUnit(t){return this.http.get(this.baseUrl+"UpdatePriceListItemUnit/"+t)}GetPriceListWithUnits(t){return this.http.get(this.baseUrl+"GetPriceListWithUnits/"+t)}EditPriceListItem(t){return this.http.post(this.baseUrl+"EditPriceListItem/",t)}static{this.\u0275fac=function(i){return new(i||r)(e.KVO(me.Qq))}}static{this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var Qe=c(84205);const Ao=()=>["priceList.register"],Qo=()=>["priceList.edit"],qo=()=>["priceList.delete"];function zo(r,o){1&r&&(e.j41(0,"tr",28)(1,"th",29),e.EFF(2,"#"),e.k0s(),e.j41(3,"th",30),e.nrm(4,"i",31),e.EFF(5," sales.priceList.name "),e.k0s(),e.j41(6,"th",32),e.nrm(7,"i",31),e.EFF(8," sales.priceList.clientGroupName "),e.k0s(),e.j41(9,"th",33),e.nrm(10,"i",31),e.EFF(11," general.table.isActive "),e.k0s(),e.j41(12,"th",34),e.nrm(13,"i",31),e.EFF(14," sales.clientCollection.notes "),e.k0s(),e.nrm(15,"th",35),e.k0s())}function Ho(r,o){1&r&&e.nrm(0,"span",43)}function Jo(r,o){1&r&&e.nrm(0,"span",44)}function Ko(r,o){if(1&r&&(e.nrm(0,"i",45),e.EFF(1),e.nI1(2,"date"),e.nrm(3,"br")(4,"i",46),e.EFF(5),e.nI1(6,"date"),e.nrm(7,"br")(8,"i",47),e.EFF(9)),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",e.i5U(2,3,t.creationTime,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",e.i5U(6,6,t.lastModificationTime,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",t.creatorName," ")}}function Zo(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",48),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,s=e.XpG();return e.Njj(s.goList(n.id))}),e.nrm(1,"i",49),e.k0s()}}function Wo(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",50),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,s=e.XpG(),l=e.sdS(24);return e.Njj(s.openModal(n.id,l))}),e.nrm(1,"i",51),e.k0s()}}function el(r,o){if(1&r){const t=e.RV6();e.j41(0,"tr",36)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td",37),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.goList(n.id))}),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.DNE(8,Ho,1,0,"span",38)(9,Jo,1,0,"span",39),e.k0s(),e.j41(10,"td"),e.EFF(11),e.k0s(),e.j41(12,"td"),e.DNE(13,Ko,10,9,"ng-template",null,3,e.C5r),e.nrm(15,"i",40),e.DNE(16,Zo,2,0,"button",41)(17,Wo,2,0,"button",42),e.k0s()()}if(2&r){const t=o.$implicit,i=o.rowIndex,n=e.sdS(14);e.R7$(2),e.JRh(i+1),e.R7$(2),e.JRh(t.name),e.R7$(2),e.JRh(t.clientGroupName),e.R7$(2),e.Y8G("ngIf",t.isActive),e.R7$(),e.Y8G("ngIf",!t.isActive),e.R7$(2),e.JRh(t.notes),e.R7$(4),e.Y8G("ngbTooltip",n),e.R7$(),e.Y8G("hasPermission",e.lJ4(9,Qo)),e.R7$(),e.Y8G("hasPermission",e.lJ4(10,qo))}}function tl(r,o){1&r&&(e.j41(0,"div",52),e.EFF(1," general.table.noData"),e.k0s())}function nl(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",53)(1,"div",54),e.nrm(2,"ngb-pagination-info",55),e.j41(3,"table-length",56),e.bIt("lengthChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",57)(5,"ngb-pagination",58),e.bIt("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.pagination.pageNumber,n)||(s.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function il(r,o){1&r&&(e.j41(0,"span",90),e.EFF(1,"general.action.register "),e.k0s())}function rl(r,o){1&r&&(e.j41(0,"span",90),e.EFF(1,"general.action.edit "),e.k0s())}function sl(r,o){1&r&&(e.j41(0,"div",91),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function al(r,o){1&r&&(e.j41(0,"div",91),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function ol(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",59)(1,"div",60)(2,"h4",61),e.DNE(3,il,2,0,"span",62)(4,rl,2,0,"span",62),e.j41(5,"span",63),e.EFF(6),e.k0s()(),e.j41(7,"button",64),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss("Cross click"))}),e.k0s()(),e.j41(8,"div",65),e.nrm(9,"ngx-ui-loader",66),e.j41(10,"form",67,4),e.bIt("submit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.OnSubmit())}),e.j41(12,"div",10)(13,"div",68)(14,"label",69),e.EFF(15,"sales.priceList.name"),e.k0s(),e.j41(16,"input",70,5),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.name,n)||(s.form.name=n),e.Njj(n)}),e.k0s(),e.DNE(18,sl,2,0,"div",71),e.k0s(),e.j41(19,"div",72)(20,"label",73),e.EFF(21,"sales.priceList.clientGroupName"),e.k0s(),e.j41(22,"ng-select",74,6),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.clientGroupId,n)||(s.form.clientGroupId=n),e.Njj(n)}),e.k0s(),e.DNE(24,al,2,0,"div",75),e.k0s(),e.j41(25,"div",76)(26,"label",73),e.EFF(27,"sales.priceList.discountType"),e.k0s(),e.j41(28,"ng-select",77,7),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.discountType,n)||(s.form.discountType=n),e.Njj(n)}),e.k0s()(),e.j41(30,"div",76)(31,"label",78),e.EFF(32,"sales.priceList.discount"),e.k0s(),e.j41(33,"input",79,8),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.discount,n)||(s.form.discount=n),e.Njj(n)}),e.k0s()(),e.j41(35,"div",72)(36,"label",80),e.EFF(37,"sales.clientCollection.clientName"),e.k0s(),e.j41(38,"ng-select",81),e.bIt("scrollToEnd",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.scrollClient())}),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.clientId,n)||(s.form.clientId=n),e.Njj(n)}),e.k0s()(),e.j41(39,"div",76)(40,"label",82),e.EFF(41,"stores.storesUnits.isActive"),e.k0s(),e.j41(42,"p-inputSwitch",83),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.isActive,n)||(s.form.isActive=n),e.Njj(n)}),e.k0s()(),e.j41(43,"div",72)(44,"label",84),e.EFF(45,"sales.clientCollection.notes"),e.k0s(),e.j41(46,"textarea",85,9),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.notes,n)||(s.form.notes=n),e.Njj(n)}),e.k0s()(),e.j41(48,"div",86)(49,"button",87),e.nrm(50,"i",88)(51,"span",89),e.k0s()()()()()()}if(2&r){const t=e.sdS(11),i=e.sdS(17),n=e.sdS(23),s=e.XpG();e.R7$(3),e.Y8G("ngIf",!s.isEditForm),e.R7$(),e.Y8G("ngIf",s.isEditForm),e.R7$(2),e.JRh(s.titleOperation),e.R7$(3),e.Y8G("hasProgressBar",!1)("fgsType",s.loaderOperationShap)("loaderId",s.operationLoader),e.R7$(7),e.R50("ngModel",s.form.name),e.R7$(2),e.Y8G("ngIf",i.invalid&&i.touched),e.R7$(4),e.Y8G("items",s.clientGroups)("multiple",!1),e.R50("ngModel",s.form.clientGroupId),e.R7$(2),e.Y8G("ngIf",n.invalid&&n.touched),e.R7$(4),e.Y8G("items",s.discountTypes),e.R50("ngModel",s.form.discountType),e.R7$(5),e.R50("ngModel",s.form.discount),e.R7$(5),e.Y8G("virtualScroll",!0)("items",s.clients)("typeahead",s.searchClient)("loading",s.loading)("multiple",!1),e.R50("ngModel",s.form.clientId),e.R7$(4),e.R50("ngModel",s.form.isActive),e.R7$(4),e.R50("ngModel",s.form.notes),e.R7$(3),e.Y8G("disabled",!t.valid)}}function ll(r,o){if(1&r){const t=e.RV6();e.j41(0,"delete-modal",92),e.bIt("deleteConfirm",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.DeleteConfirmSoft())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}}let dl=(()=>{class r extends Y.w{constructor(t,i,n,s,l,a,f,M,R,O,w,k,v){super(t,i,f,n,s,l,a),this.baseService=n,this.excelService=R,this.clientService=O,this.clientGroupsService=w,this.offerOrderService=k,this.router=v,this.title="sales.priceList.title",this.titleOperation="sales.priceList.titleOperation",this.keySelected="",this.assignUsers=[],this.times=[],this.employees=[],this.searchForm={},this.isResolveList=!0,this.countLoad=2,this.clientParam={pageSize:50,pageNumber:1,search:"",clientId:null},this.clients=[],this.loading=!1,this.searchClient=new se.B,this.clientGroups=[],this.discountTypes=[],this.setDates=(j,b,h)=>{if(j?.from||j?.to){const F=j.to||j.from;this.pagination[b]=this.datePipe.transform(j.from||j.to,"yyyy-MM-ddT00:00:00"),this.pagination[h]=this.datePipe.transform(F,"yyyy-MM-ddT23:59:59.999")}else this.pagination[b]=null,this.pagination[h]=null},this.configRoute(),this.discountTypes=this.offerOrderService.discountTypes,this.discountTypes.forEach(j=>{j.name=this.getTranslationText("sales.salesOrder."+j.name)})}ngOnInitMore(){this.searchClient.pipe((0,je.B)(300),(0,Ie.F)(),(0,le.n)(t=>this.loadClient(t))).subscribe(),this.getClientGroups()}getClientGroups(){this.clientGroupsService.getDropDown().subscribe({next:t=>{this.clientGroups=t.data}})}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader("allLoader"),this.setDates(t.creationDates,"dateFrom","dateTo"),this.loadentities()}loadClient(t){return this.loading=!0,""==t||null==t?(this.loading=!1,(0,ye.of)([])):this.getClientDropdwon(t)}getClientDropdwon(t=""){return this.clientParam.search=t,this.clientParam.clientId=null,this.clientParam.pageNumber=1,this.clientService.GetClientSearch(this.clientParam).pipe((0,le.n)(i=>(this.clients=i.data,this.loading=!1,[])))}mapForm(t){let i={...t};return i.clientId>0&&(i.clientGroupId=null),i}mapRegisterForm(t){let i={...t};return i.clientId>0&&(i.clientGroupId=null),i.id=0,i}OnSearch(t){this.ngxLoader.startLoader(g.a7),this.loadentities()}configRoute(){}EditModel(t,i,n="md"){this.isEditForm=!0,this.baseService.getById(t).pipe((0,p.Q)(this.notifier)).subscribe(s=>{s.success?(this.clientParam.clientId=s.data.clientId,this.clientParam.search="",this.clientService.GetClientSearch(this.clientParam).subscribe(l=>{this.clients=l.data}),this.form=s.data):this.alertService.error("general.message."+s.message),this.modalService.open(i,{centered:!0,size:n})},s=>{this.alertService.error()})}mapExcel(){let t=[];return this.entities?.forEach(i=>{t.push({nameAr:i.nameAr,nameEn:i.nameEn,isActive:this.getTranslationText("general.table.active"),notes:i.notes})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.getTranslationText(this.title),[])}editEntity(){let t=this.mapForm(this.form);this.baseService.editPut(t.id,t).pipe((0,T.O)(),(0,N.c)(this.mainDelay),(0,x.Z)(),(0,p.Q)(this.notifier),(0,I.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(i=>{i.success?this.submitFunished():this.alertService.error("general.message."+i.message)},i=>{this.alertService.error("general.message."+i)})}scrollClient(){this.clientParam.pageNumber=this.clientParam.pageNumber+1,this.clientService.GetClientSearch(this.clientParam).subscribe(t=>{this.clients=[...this.clients,...t.data]})}goList(t){this.router.navigateByUrl("/sales/PriceListItems/"+t)}goRegister(){this.router.navigateByUrl("/sales/PriceListItems")}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(y.nX),e.rXU(u.c$),e.rXU(Ve),e.rXU(V.u),e.rXU(m.vh),e.rXU(C.eD),e.rXU(_.Bq),e.rXU(e.gRc),e.rXU(H.V),e.rXU(pe.X),e.rXU(Qe.t),e.rXU(P),e.rXU(y.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-priceList"]],features:[e.Vt3],decls:25,vars:20,consts:[["tableMaster",""],["operation",""],["deleteModal",""],["tooltipContent",""],["formEntity","ngForm"],["name","ngModel"],["clientGroupId","ngModel"],["discountType","ngModel"],["discount","ngModel"],["notes","ngModel"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],[3,"reset","search","exportXlsx","addNew","addPermission","totalItems","title"],["control",""],[1,"col-md-4","mb-2"],[1,"search-box"],["type","search","id","name","name","name",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],[1,"col-12","col-md-3","mb-2"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["translate","",2,"width",".5%"],["pSortableColumn","paymentTypeName","translate","",2,"width","10%"],[1,"ri-expand-up-down-line"],["pSortableColumn","clientGroupId","translate","",2,"width","12%"],["pSortableColumn","isActive","translate","",2,"width","6%"],["pSortableColumn","notes","translate","",2,"width","8%"],["translate","",2,"width","12%"],[1,"fs-5"],[3,"click"],["class","badge bg-success-subtle text-success p-2","translate","general.table.active",4,"ngIf"],["class","badge bg-danger-subtle text-danger p-2","translate","general.table.noActive",4,"ngIf"],["tooltipPosition","top",1,"mdi","mdi-cog-outline","text-muted","fs-16","align-middle","me-1",3,"ngbTooltip"],["class","btn btn-sm btn-soft-info edit-list mx-2",3,"click",4,"hasPermission"],["class","btn btn-sm btn-soft-danger remove-list",3,"click",4,"hasPermission"],["translate","general.table.active",1,"badge","bg-success-subtle","text-success","p-2"],["translate","general.table.noActive",1,"badge","bg-danger-subtle","text-danger","p-2"],[1,"ri-history-fill","text-warning"],[1,"ri-history-fill","text-danger"],[1,"ri-user-location-fill","text-primary"],[1,"btn","btn-sm","btn-soft-info","edit-list","mx-2",3,"click"],[1,"ri-pencil-fill","align-bottom","mx-1"],[1,"btn","btn-sm","btn-soft-danger","remove-list",3,"click"],[1,"ri-delete-bin-5-fill","align-bottom"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["class","fw-bold fs-4","translate","",4,"ngIf"],["translate",""],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"hasProgressBar","fgsType","loaderId"],[3,"submit"],[1,"col-12"],["for","name","translate","",1,"fw-bold","form-label"],["InputTirmFilter","","name","name","type","text","id","name","required","",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["class","text-danger text-center  ","translate","",4,"ngIf"],[1,"col-12","my-1"],["translate","",1,"fw-bold","form-label","w-100"],["name","clientGroupId","id","clientGroupId","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","ngModel"],["class","text-danger text-center","translate","",4,"ngIf"],[1,"col-12","col-md-6"],["clearable","false","clearOnBackspace","false","name","discountType","bindValue","id","bindLabel","name",2,"width","100%",3,"ngModelChange","items","ngModel"],["for","discount","translate","",1,"fw-bold","form-label"],["InputTirmFilter","","name","name","type","number","id","discount",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["for","nameAr","translate","",1,"fw-bold","form-label"],["bindLabel","displayName","bindValue","id","name","clientId",3,"scrollToEnd","ngModelChange","virtualScroll","items","typeahead","loading","multiple","ngModel"],["for","isActive","translate","",1,"fw-bold","form-label","d-block"],["id","isActive","name","isActive","inputId","isActive",3,"ngModelChange","ngModel"],["for","notes","translate","",1,"fw-bold","form-label"],["rows","1","InputTirmFilter","","name","notes","type","text","id","notes",1,"form-control","fs-6",3,"ngModelChange","ngModel"],[1,"text-center"],["type","submit","type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],["translate","",1,"fw-bold","fs-4"],["translate","",1,"text-danger","text-center"],[3,"deleteConfirm","dismiss"]],template:function(i,n){if(1&i){const s=e.RV6();e.j41(0,"div",10)(1,"div",11)(2,"div",12)(3,"base-filter",13),e.bIt("reset",function(){return e.eBV(s),e.Njj(n.onReset())})("search",function(){return e.eBV(s),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(s),e.Njj(n.onExportXlsx())})("addNew",function(){return e.eBV(s),e.Njj(n.goRegister())}),e.qex(4,14),e.j41(5,"div",15)(6,"div",16)(7,"input",17),e.nI1(8,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.name,a)||(n.pagination.name=a),e.Njj(a)}),e.k0s(),e.nrm(9,"i",18),e.k0s()(),e.j41(10,"div",19)(11,"input",20),e.nI1(12,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.searchForm.creationDates,a)||(n.searchForm.creationDates=a),e.Njj(a)}),e.k0s()(),e.bVm(),e.k0s(),e.j41(13,"div",21)(14,"div",22)(15,"p-table",23,0),e.bIt("onLazyLoad",function(a){return e.eBV(s),e.Njj(n.tableChange(a))})("selectionChange",function(a){return e.eBV(s),e.Njj(n.onSelectionChange(a))}),e.DNE(17,zo,16,0,"ng-template",24)(18,el,18,11,"ng-template",25),e.k0s()(),e.DNE(19,tl,2,0,"div",26)(20,nl,6,8,"div",27),e.k0s()()()(),e.DNE(21,ol,52,24,"ng-template",null,1,e.C5r)(23,ll,1,0,"ng-template",null,2,e.C5r)}2&i&&(e.R7$(3),e.Y8G("addPermission",e.lJ4(19,Ao))("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(8,15,"general.table.name")),e.R50("ngModel",n.pagination.name),e.R7$(4),e.FS9("placeholder",e.bMT(12,17,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(4),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[m.bT,d.qT,d.me,d.Q0,d.BC,d.cb,d.YS,d.vS,d.cV,_.s5,D.kL,A.b,te.w,Q.p,q.g,u.Mm,S.XI,z.Ei,S.Tg,ve.HW,C.Cv,E.vr,_.md,X.m,U.p,m.vh,u.D9],encapsulation:2})}}return r})(),cl=(()=>{class r extends Me.E{constructor(t,i,n){super(t,i,n)}static{this.\u0275fac=function(i){return new(i||r)(e.KVO(y.Ix),e.KVO(Ue),e.KVO(V.u))}}static{this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();const ml=()=>["assignTruckOrder.changeStatus"],pl=()=>["assignTruckOrder.print"],gl=()=>["assignTruckOrder.finish"];function _l(r,o){1&r&&e.nrm(0,"span",45)}function ul(r,o){if(1&r&&(e.j41(0,"a",46),e.nrm(1,"i",47),e.k0s()),2&r){const t=e.XpG().$implicit,i=e.XpG();e.Y8G("href",i.mapUrl(null==t?null:t.lng,null==t?null:t.lat),e.B4B)}}function hl(r,o){if(1&r&&(e.qex(0),e.j41(1,"div",48)(2,"div",49)(3,"div",50),e.EFF(4),e.k0s(),e.j41(5,"div",51)(6,"span",52),e.EFF(7),e.k0s(),e.j41(8,"span",53),e.EFF(9),e.k0s()()()(),e.bVm()),2&r){const t=o.$implicit,i=o.index;e.R7$(4),e.Lme(" ",i+1," - ",t.itemName," "),e.R7$(3),e.SpI("",t.unitName," "),e.R7$(2),e.SpI("",t.quantity," ")}}function fl(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",51)(1,"span",54),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,s=e.XpG(),l=e.sdS(28);return e.Njj(s.openChangeStatusModal(n,l))}),e.nrm(2,"i",55)(3,"span",56),e.k0s()()}}function bl(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",51)(1,"span",57),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,s=e.XpG();return e.Njj(s.PrintOrderReceived(n.id))}),e.nrm(2,"i",58)(3,"span",59),e.k0s()()}}function Cl(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",51)(1,"span",60),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,s=e.XpG(),l=e.sdS(30);return e.Njj(s.openFinishedModal(n.id,l,"md"))}),e.nrm(2,"i",61)(3,"span",62),e.k0s()()}}function Sl(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",21)(1,"div",22)(2,"div",23)(3,"bdi")(4,"span")(5,"span"),e.EFF(6),e.nI1(7,"translate"),e.k0s()()(),e.j41(8,"div",24)(9,"p",25),e.nrm(10,"i",26),e.EFF(11),e.k0s(),e.j41(12,"p",25),e.nrm(13,"i",27),e.EFF(14),e.k0s()(),e.j41(15,"div",28)(16,"p",25),e.nrm(17,"i",29),e.EFF(18),e.nI1(19,"date"),e.k0s(),e.j41(20,"p",30),e.nrm(21,"i",31),e.EFF(22),e.k0s()(),e.j41(23,"div",28)(24,"h5",32),e.nrm(25,"i",33),e.EFF(26),e.k0s(),e.j41(27,"p",30),e.nrm(28,"i",34),e.EFF(29),e.k0s()(),e.j41(30,"div",35),e.DNE(31,_l,1,0,"span",36)(32,ul,2,1,"a",37),e.j41(33,"div"),e.nrm(34,"i",38),e.j41(35,"span",39),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.copytext(n.mobile))}),e.EFF(36),e.nrm(37,"i",40),e.k0s()()(),e.nrm(38,"hr"),e.j41(39,"div",41),e.DNE(40,hl,10,4,"ng-container",42),e.k0s(),e.j41(41,"div",43),e.DNE(42,fl,4,0,"div",44)(43,bl,4,0,"div",44)(44,Cl,4,0,"div",44),e.k0s()()()()}if(2&r){const t=o.$implicit;e.R7$(4),e.ZvI("ribbon ",t.trunckStatusName," round-shape "),e.R7$(2),e.JRh(e.bMT(7,17,"sales.salesOrder."+t.trunckStatusName)),e.R7$(5),e.SpI(" ",t.shippingTruckName," "),e.R7$(3),e.SpI(" ",t.shippingTruckNumber," "),e.R7$(4),e.SpI(" ",e.i5U(19,19,t.deliveryDate,"yyyy-MM-dd HH:mm")," "),e.R7$(4),e.SpI(" #SHO#",t.id," "),e.R7$(4),e.SpI(" ",t.clientName," "),e.R7$(3),e.SpI(" #SO#",t.offerOrderMasterId," "),e.R7$(2),e.Y8G("ngIf",""==t.lng),e.R7$(),e.Y8G("ngIf",null==t?null:t.lng),e.R7$(4),e.SpI("",t.mobile," "),e.R7$(4),e.Y8G("ngForOf",t.details),e.R7$(2),e.Y8G("hasPermission",e.lJ4(22,ml)),e.R7$(),e.Y8G("hasPermission",e.lJ4(23,pl)),e.R7$(),e.Y8G("hasPermission",e.lJ4(24,gl))}}function vl(r,o){1&r&&(e.j41(0,"div",63),e.EFF(1," general.table.noData "),e.k0s())}function jl(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",64)(1,"div",65),e.nrm(2,"ngb-pagination-info",66),e.j41(3,"table-length",67),e.bIt("lengthChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",68)(5,"ngb-pagination",69),e.bIt("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.pagination.pageNumber,n)||(s.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function Il(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",70)(1,"div",71)(2,"h4",72),e.nrm(3,"span",73),e.k0s(),e.j41(4,"button",74),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(5,"div",75),e.nrm(6,"ngx-ui-loader",76),e.j41(7,"form",77,2),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.changeStatus())}),e.j41(9,"div",17)(10,"div",78)(11,"label",79),e.EFF(12,"sales.salesOrder.trunckStatus"),e.k0s(),e.j41(13,"ng-select",80),e.nI1(14,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.trunckStatus,n)||(s.form.trunckStatus=n),e.Njj(n)}),e.k0s()()(),e.j41(15,"div",32)(16,"button",81),e.nrm(17,"i",82)(18,"span",83),e.k0s()()()()()}if(2&r){const t=e.sdS(8),i=e.XpG();e.R7$(6),e.Y8G("hasProgressBar",!1)("fgsType",i.loaderOperationShap)("loaderId",i.operationLoader),e.R7$(7),e.FS9("placeholder",e.bMT(14,8,"orderManagement.order.changeTeamStatus")),e.Y8G("items",i.statusList)("multiple",!1),e.R50("ngModel",i.form.trunckStatus),e.R7$(3),e.Y8G("disabled",!t.valid)}}function yl(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",96)(1,"i",97),e.bIt("click",function(){const n=e.eBV(t),s=n.$implicit,l=n.index,a=e.XpG(2);return e.Njj(a.removeImage(s.id,l))}),e.k0s(),e.j41(2,"div",98),e.nrm(3,"img",99),e.k0s()()}if(2&r){const t=o.$implicit,i=e.XpG(2);e.R7$(3),e.Y8G("src",0==t.id?t.path:i.serverPath+t.path,e.B4B)}}function kl(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",71)(1,"h4",72),e.nrm(2,"span",84),e.k0s(),e.j41(3,"button",74),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(4,"div",75)(5,"form",null,2),e.nrm(7,"ngx-ui-loader",76),e.j41(8,"div",85)(9,"div",86)(10,"div",87)(11,"div",88)(12,"button",89),e.bIt("click",function(){e.eBV(t);const n=e.sdS(17);return e.Njj(n.click())}),e.EFF(13," orderManagement.order.assignedOrders.select "),e.k0s(),e.j41(14,"div",90),e.DNE(15,yl,4,1,"div",91),e.k0s()(),e.j41(16,"input",92,3),e.bIt("change",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.onFileChanged(n))}),e.k0s()(),e.j41(18,"div",93)(19,"button",94),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.finishOrder())}),e.k0s(),e.j41(20,"button",95),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()()}if(2&r){const t=e.XpG();e.R7$(7),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader),e.R7$(8),e.Y8G("ngForOf",t.images)}}let Tl=(()=>{class r extends Y.w{constructor(t,i,n,s,l,a,f,M,R,O,w){super(t,i,M,n,l,a,f),this.baseService=n,this.salesInvoicesService=s,this.authDaamService=R,this.excelService=O,this._formDataService=w,this.title="sales.assignTruckOrder.title",this.titleOperation="sales.assignTruckOrder.title",this.config={infinite:!0,slidesToShow:5,slidesToScroll:1,autoplay:!1,arrows:!1},this.trunks=[],this.isFlagTime=!0,this.searchForm={},this.statusList=[],this.pagination={pageNumber:1,pageSize:30},this.images=[],this.serverPath=J.c.mediaUrl,this.form={orderId:0,attachmens:[]},this.setDates=(k,v,j)=>{if(k?.from||k?.to){const h=k.to||k.from;this.pagination[v]=this.datePipe.transform(k.from||k.to,"yyyy-MM-ddT00:00:00"),this.pagination[j]=this.datePipe.transform(h,"yyyy-MM-ddT23:59:59.999")}else this.pagination[v]=null,this.pagination[j]=null}}loadentities(){this.ngxLoader.startLoader(g.a7),this.baseService.GetOrderAssignTrunk(this.pagination).pipe((0,p.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader(g.a7),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader(g.a7),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[]}ngOnInitMore(){this.loadentities(),this.checkStatus()}checkStatus(){let t=this.baseService.getTrunckStatus();t.forEach(i=>{i.name=this.getTranslationText("sales.salesOrder."+i.name)}),this.statusList=t}mapExcel(){let t=[];return this.entities.forEach(i=>{t.push({"Order Code":i.orderCode,"Created Date":i.createdDate,"City Name":i.cityName,"District Name":i.districtName?i.districtName:"--","Agent Name":i.agentName,Mobile:i.mobile,"Channel Name":i.channelName,"Assigned To":i.teamNames,Times:i.workTimes,"Visit Date":i.visitDate,Services:i.services})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader("allLoader"),this.setDates(t.dates,"visitDateFrom","visitDateTo"),this.setDates(t.creationDates,"creationTimeFrom","creationTimeTo"),this.loadentities()}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}openChangeStatusModal(t,i,n="md"){this.form={},this.form.trunckStatus=t.trunckStatus,this.form.id=t.id,this.modalService.open(i,{centered:!0,size:n})}changeStatus(){this.ngxLoader.startLoader(this.operationLoader),this.baseService.changeStatus({trunckStatus:this.form.trunckStatus,id:this.form.id}).pipe((0,p.Q)(this.notifier),(0,I.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(i=>{this.loadentities(),this.alertService.success(),this.modalService.dismissAll()},()=>{this.alertService.error()})}mapUrl(t,i){return null===t||null==i?"":`https://www.google.com/maps/dir//${i},${t}/@${i},${t},17z?hl=en-US`}SubmitFinishOrder(){this.ngxLoader.startLoader(this.operationLoader),this.salesInvoicesService.finishOrder(this.form.id).pipe((0,p.Q)(this.notifier),(0,I.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(t=>{this.loadentities(),this.alertService.success(),this.modalService.dismissAll()},()=>{this.alertService.error()})}PrintOrderReceived(t){this.ngxLoader.startLoader("searchLoader"),this.baseService.PrintOrderReceived(t).pipe((0,T.O)(),(0,x.Z)(),(0,p.Q)(this.notifier),(0,I.j)(()=>this.ngxLoader.stopLoader("searchLoader"))).subscribe(i=>{this.openUrl(i)},i=>{this.alertService.error("general.message."+i)})}openUrl(t){let i=new Blob([t],{type:t.type});var n=URL.createObjectURL(i);window.open(n,"_blank")}onFileChanged(t){if(t.target.files&&t.target.files[0]){let i=t.target.files.length;for(let n=0;n<i;n++){let s=new FileReader;this.form.attachmens.push({attachImage:t.target.files.item(n),type:"file"}),s.onload=l=>{this.images.push({id:0,path:l.target.result,completePath:l.target.result})},s.readAsDataURL(t.target.files[n])}}}removeImage(t,i){this.form.attachmens.splice(i,1),this.images.splice(i,1)}openFinishedModal(t,i,n="md"){this.form={},this.form.orderId=t,this.images=[],this.form.attachmens=[],this.modalService.open(i,{centered:!0,size:n})}finishOrder(){const t=new FormData;t.append("OrderId",this.form.orderId.toString()),this.form.attachmens.forEach(i=>{t.append("Attachmens",i.attachImage)}),this.ngxLoader.startLoader(g.Fq),this.salesInvoicesService.finishOrder(t).subscribe(i=>{this.ngxLoader.stopLoader(g.Fq),this.loadentities(),this.modalService.dismissAll()},i=>{console.log(i),this.ngxLoader.stopLoader(g.Fq)})}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(y.nX),e.rXU(u.c$),e.rXU(Se),e.rXU(we),e.rXU(V.u),e.rXU(m.vh),e.rXU(C.eD),e.rXU(_.Bq),e.rXU(ee.J),e.rXU(H.V),e.rXU(Ge.Q))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["assign-truck-order"]],features:[e.Vt3],decls:31,vars:26,consts:[["changeStatusModal",""],["finishOrderModal",""],["formEntity","ngForm"],["FileInput",""],[1,"card"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[1,"card-body","p-0"],[3,"reset","search","exportXlsx","showAdd","showExport","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","search","id","agentName","name","agentName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["InputTirmFilter","","type","tel","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"col-12","col-md-4","mb-2"],["type","text","mwlFlatpickr","","id","isDate","mode","range",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"row"],["class","col-12 col-md-4 my-2",4,"ngFor","ngForOf"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row text-center px-1 py-1 overflow-hidden",4,"ngIf"],[1,"col-12","col-md-4","my-2"],[1,"card","ribbon-box","border","shadow-none","mb-lg-0","material-shadow","card-item"],[1,"card-body","p-1"],[1,"d-flex","justify-content-between","mt-5"],[1,"text-muted"],[1,"ri-police-car-line","text-muted","me-1","align-bottom"],[1,"ri-truck-line","text-muted","me-1","align-bottom"],[1,"d-flex","justify-content-between"],[1,"ri-calendar-2-fill","text-muted","me-1","align-bottom"],[1,"text-muted","ms-2","text-muted","text-decoration-underline"],[1,"ri-order-play-fill","text-muted","me-1","align-bottom"],[1,"text-center"],[1,"ri-user-2-fill","text-muted","me-1","align-bottom"],[1,"ri-shopping-cart-fill","text-muted","me-1","align-bottom"],[1,"d-flex","gap-4","mb-1","justify-content-between"],["class","badge bg-danger-subtle text-danger mx-1","translate","orderManagement.order.noMap",4,"ngIf"],["target","_blank","class","badge bg-success-subtle text-success mx-1","translate","orderManagement.order.viewMap",3,"href",4,"ngIf"],[1,"ri-phone-fill","text-info","me-1","align-bottom"],[1,"cursor-pointer","badge","bg-info-subtle","text-info","fs-6",3,"click"],[1,"ri-clipboard-line"],[1,""],[4,"ngFor","ngForOf"],[1,"row","mt-3","justify-content-between"],["class","col-12 col-md-4",4,"hasPermission"],["translate","orderManagement.order.noMap",1,"badge","bg-danger-subtle","text-danger","mx-1"],["target","_blank","translate","orderManagement.order.viewMap",1,"badge","bg-success-subtle","text-success","mx-1",3,"href"],[1,"ri-map-pin-line"],[1,"card","p-0","m-0","card-item"],[1,"card-body","row","p-0"],[1,"col-12","col-md-8","fs-4"],[1,"col-12","col-md-4"],[1,"badge","bg-primary-subtle","text-primary","mx-2","fs-6"],[1,"badge","bg-danger-subtle","text-danger","fs-6"],[1,"btn","btn-sm","btn-soft-success",3,"click"],[1,"ri-swap-line","label-icon","align-bottom","rounded-pill","fs-16","me-2"],["translate","orderManagement.order.changeTeamStatus"],[1,"btn","btn-sm","btn-soft-info",3,"click"],[1,"ri-printer-fill","label-icon","align-bottom","rounded-pill","fs-16","me-2"],["translate","general.action.print"],[1,"btn","btn-sm","btn-soft-primary",3,"click"],[1,"ri-checkbox-circle-fill","align-bottom"],["translate","orderManagement.order.finishOrder"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","text-center","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["translate","orderManagement.order.changeTeamStatus",1,"fw-bold","fs-4"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"hasProgressBar","fgsType","loaderId"],[3,"ngSubmit"],[1,"mb-3"],["for","trunckStatus","translate","",1,"fw-bold","form-label"],["name","trunckStatus","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],["translate","orderManagement.order.finishOrder",1,"fw-bold","fs-4"],[1,"modal-content"],[1,"modal-body","p-1"],[1,"col-12","col-lg-12","d-flex"],[1,"w-75"],["translate","",1,"btn","btn-warning","px-5",3,"click"],[1,"my-3","d-flex"],["class","avatar-lg mx-2 position-relative",4,"ngFor","ngForOf"],["multiple","","value","","type","file","accept","image/png, image/gif, image/jpeg",1,"form-control","d-none",3,"change"],[1,"d-flex","gap-2","justify-content-center","my-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger",3,"click"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],[1,"avatar-lg","mx-2","position-relative"],[1,"position-absolute","bx","bx-x-circle","text-white",2,"background","red","top","1px","right","-4px","font-size","1rem","border-radius","50%",3,"click"],[1,"avatar-title","bg-light","rounded"],["id","product-img1","alt","",1,"avatar-md","h-auto",3,"src"]],template:function(i,n){if(1&i){const s=e.RV6();e.j41(0,"div",4),e.nrm(1,"ngx-ui-loader",5),e.j41(2,"div",6)(3,"base-filter",7),e.bIt("reset",function(){return e.eBV(s),e.Njj(n.onReset())})("search",function(){return e.eBV(s),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(s),e.Njj(n.onExportXlsx())}),e.qex(4,8),e.j41(5,"div",9)(6,"div",10)(7,"input",11),e.nI1(8,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.orderCode,a)||(n.pagination.orderCode=a),e.Njj(a)}),e.k0s(),e.nrm(9,"i",12),e.k0s()(),e.j41(10,"div",9)(11,"div",10)(12,"input",13),e.nI1(13,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.agentName,a)||(n.pagination.agentName=a),e.Njj(a)}),e.k0s(),e.nrm(14,"i",12),e.k0s()(),e.j41(15,"div",9)(16,"div",10)(17,"input",14),e.nI1(18,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.mobile,a)||(n.pagination.mobile=a),e.Njj(a)}),e.k0s(),e.nrm(19,"i",12),e.k0s()(),e.j41(20,"div",15)(21,"input",16),e.nI1(22,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.searchForm.creationDates,a)||(n.searchForm.creationDates=a),e.Njj(a)}),e.k0s()(),e.bVm(),e.k0s()()(),e.j41(23,"div",17),e.DNE(24,Sl,45,25,"div",18),e.k0s(),e.DNE(25,vl,2,0,"div",19)(26,jl,6,8,"div",20)(27,Il,19,10,"ng-template",null,0,e.C5r)(29,kl,21,4,"ng-template",null,1,e.C5r)}2&i&&(e.R7$(),e.Y8G("loaderId","searchLoader"),e.R7$(2),e.Y8G("showAdd",!1)("showExport",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(8,18,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.orderCode),e.R7$(5),e.FS9("placeholder",e.bMT(13,20,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.agentName),e.R7$(5),e.FS9("placeholder",e.bMT(18,22,"orderManagement.order.mobile")),e.R50("ngModel",n.pagination.mobile),e.R7$(4),e.FS9("placeholder",e.bMT(22,24,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(3),e.Y8G("ngForOf",n.entities),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[m.Sq,m.bT,d.qT,d.me,d.Q0,d.BC,d.cb,d.vS,d.cV,_.s5,D.kL,A.b,Q.p,q.g,u.Mm,C.Cv,E.vr,X.m,U.p,m.vh,u.D9],encapsulation:2})}}return r})();var xl=c(54384);function Ml(r,o){1&r&&(e.j41(0,"div",36),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function Rl(r,o){1&r&&(e.j41(0,"div",36),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function Ol(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",37),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.addAllItems())}),e.nrm(1,"i",32)(2,"span",38),e.k0s()}if(2&r){e.XpG();const t=e.sdS(7);e.Y8G("disabled",!t.valid)}}function Fl(r,o){1&r&&(e.j41(0,"tr",49)(1,"th",50),e.EFF(2,"#"),e.k0s(),e.j41(3,"th",51),e.EFF(4," sales.priceList.itemName "),e.k0s(),e.j41(5,"th",51),e.EFF(6," sales.priceList.unitName "),e.k0s(),e.j41(7,"th",52),e.EFF(8," sales.priceList.itemPrice "),e.k0s(),e.j41(9,"th",52),e.EFF(10," sales.priceList.listPrice "),e.k0s()())}function Nl(r,o){if(1&r){const t=e.RV6();e.j41(0,"tr",53)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td")(10,"input",54),e.nI1(11,"translate"),e.mxI("ngModelChange",function(n){const s=e.eBV(t).rowIndex,l=e.XpG(2);return e.DH7(l.form[s].price,n)||(l.form[s].price=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=o.$implicit,i=o.rowIndex,n=e.XpG(2);e.R7$(2),e.JRh(i+1),e.R7$(2),e.JRh(t.itemName),e.R7$(2),e.JRh(t.unitName),e.R7$(2),e.JRh(t.itemPrice),e.R7$(2),e.FS9("placeholder",e.bMT(11,6,"sales.priceList.price")),e.R50("ngModel",n.form[i].price)}}function wl(r,o){1&r&&(e.j41(0,"div",55),e.EFF(1," general.table.noData "),e.k0s())}function Gl(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",46)(1,"a",56),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.Save())}),e.nrm(2,"i",48),e.j41(3,"span"),e.EFF(4),e.nI1(5,"translate"),e.k0s()()()}2&r&&(e.R7$(4),e.JRh(e.bMT(5,1,"general.action.save")))}function Vl(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",8)(1,"div",9)(2,"div",10),e.nrm(3,"ngx-ui-loader",11),e.j41(4,"div",39)(5,"p-table",40,6),e.DNE(7,Fl,11,0,"ng-template",41)(8,Nl,12,8,"ng-template",42),e.k0s()(),e.DNE(9,wl,2,0,"div",43),e.j41(10,"div",44),e.DNE(11,Gl,6,3,"div",45),e.j41(12,"div",46)(13,"a",47),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.back())}),e.nrm(14,"i",48),e.j41(15,"span"),e.EFF(16),e.nI1(17,"translate"),e.k0s()()()()()()()}if(2&r){const t=e.XpG();e.R7$(3),e.Y8G("loaderId",t.searchLoader),e.R7$(2),e.Y8G("value",t.form)("rows",null==t.form?null:t.form.length),e.R7$(4),e.Y8G("ngIf",(null==t.form?null:t.form.length)<=0),e.R7$(2),e.Y8G("ngIf",(null==t.form?null:t.form.length)>0),e.R7$(5),e.JRh(e.bMT(17,6,"general.action.back"))}}let qe=(()=>{class r extends Y.w{constructor(t,i,n,s,l,a,f,M,R,O,w){super(t,i,f,l,n,s,a),this.baseService=l,this.service=M,this.clientGroupsService=R,this.offerOrderService=O,this.router=w,this.title="sales.priceList.priceListItems",this.submitted=!1,this.pagination={pageNumber:1,pageSize:1e3},this.form=[],this.formMaster={},this.listId=0,this.clientGroups=[],this.discountTypes=[]}ngOnInitMore(){this.listId=this.routerActive.snapshot.paramMap.get("id"),this.listId&&this.GetById(),this.loadentities(),this.getClientGroups(),this.discountTypes=this.offerOrderService.discountTypes,this.discountTypes.forEach(t=>{t.name=this.getTranslationText("sales.salesOrder."+t.name)})}GetById(){this.baseService.getById(this.listId).pipe((0,p.Q)(this.notifier)).subscribe(t=>{t.success?(this.isEditForm=!0,this.formMaster=t.data):this.alertService.error("general.message."+t.message)},t=>{this.alertService.error()})}getClientGroups(){this.clientGroupsService.getDropDown().subscribe({next:t=>{this.clientGroups=t.data}})}addAllItems(){this.ngxLoader.startLoader(g.a7),this.baseService.UpdatePriceListItemUnit(this.listId).pipe((0,p.Q)(this.notifier)).subscribe(t=>{this.LoadSuccess(),this.loadentities(),this.ngxLoader.stopLoader(g.a7)},t=>{this.ngxLoader.stopLoader(g.a7),this.alertService.error(t)})}Save(){let t=[];this.form.forEach(i=>{t.push({id:i.id,UnitId:i.unitId,itemId:i.itemId,priceListMasterId:i.priceListMasterId,price:i.price})}),this.ngxLoader.startLoader(this.searchLoader),this.baseService.EditPriceListItem(t).pipe((0,T.O)(),(0,N.c)(this.mainDelay),(0,x.Z)(),(0,p.Q)(this.notifier),(0,I.j)(()=>this.ngxLoader.stopLoader(this.searchLoader)),(0,be.W)(i=>(0,Ce.$)(i))).subscribe(i=>{i.success?this.submitFunished():this.alertService.error("general.message."+i.message)},i=>{this.alertService.error("general.message."+i)})}loadentities(){this.baseService.GetPriceListWithUnits(this.listId).pipe((0,p.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader(g.a7),this.form=t.data,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader(g.a7),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[]}back(){this.router.navigate(["/sales/Prices-List/"])}OnSubmit(){this.ngxLoader.startLoader(this.operationLoader),!0===this.isEditForm?this.editEntity():this.registerEntity()}submitFunished(){this.alertService.success(),this.ngxLoader.stop(g.a7),this.ngxLoader.stop(g.ZW),this.btnDisabled=!0}registerEntity(){this.ngxLoader.startLoader(this.operationLoader);let t=this.mapRegisterForm(this.formMaster);this.baseService.register(t).pipe((0,T.O)(),(0,N.c)(this.mainDelay),(0,x.Z)(),(0,p.Q)(this.notifier),(0,I.j)(()=>this.ngxLoader.stopLoader(this.operationLoader)),(0,be.W)(i=>(0,Ce.$)(i))).subscribe(i=>{i.success?(this.goList(i.data),this.submitFunished()):this.alertService.error("general.message."+i.message)},i=>{this.alertService.error("general.message."+i)})}editEntity(){this.ngxLoader.startLoader(this.operationLoader);let t=this.mapForm(this.formMaster);this.baseService.edit(t.id,t).pipe((0,T.O)(),(0,N.c)(this.mainDelay),(0,x.Z)(),(0,p.Q)(this.notifier),(0,I.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(i=>{i.success?this.submitFunished():this.alertService.error("general.message."+i.message)},i=>{this.alertService.error("general.message."+i)})}goList(t){this.router.navigateByUrl("/sales/PriceListItems/"+t)}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(y.nX),e.rXU(u.c$),e.rXU(V.u),e.rXU(m.vh),e.rXU(Ve),e.rXU(C.eD),e.rXU(_.Bq),e.rXU(xl.m),e.rXU(Qe.t),e.rXU(P),e.rXU(y.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-priceList-operation"]],features:[e.Vt3],decls:46,vars:19,consts:[["formEntity","ngForm"],["name","ngModel"],["clientGroupId","ngModel"],["discountType","ngModel"],["discount","ngModel"],["notes","ngModel"],["tableMaster",""],[3,"title","breadcrumbItems"],[1,"row"],[1,"card","grid"],[1,"card-body"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"submit"],[1,"col-12","col-md-3"],["for","name","translate","",1,"fw-bold","form-label"],["InputTirmFilter","","name","name","type","text","id","name","required","",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["class","text-danger text-center  ","translate","",4,"ngIf"],[1,"col-12","col-md-2"],["translate","",1,"fw-bold","form-label","w-100"],["name","clientGroupId","id","clientGroupId","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","ngModel"],["class","text-danger text-center","translate","",4,"ngIf"],["clearable","false","clearOnBackspace","false","name","discountType","bindValue","id","bindLabel","name",2,"width","100%",3,"ngModelChange","items","ngModel"],[1,"col-12","col-md-1"],["for","discount","translate","",1,"fw-bold","form-label"],["InputTirmFilter","","name","name","type","number","id","discount",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["for","isActive","translate","",1,"fw-bold","form-label","d-block"],["id","isActive","name","isActive","inputId","isActive",3,"ngModelChange","ngModel"],[1,"col-12","col-md-2","my-1"],["for","notes","translate","",1,"fw-bold","form-label"],["rows","1","InputTirmFilter","","name","notes","type","text","id","notes",1,"form-control","fs-6",3,"ngModelChange","ngModel"],[1,"text-center"],["type","submit","type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],["type","submit","class","btn btn-success btn-label waves-effect waves-light rounded-pill mx-2",3,"disabled","click",4,"ngIf"],["class","row",4,"ngIf"],["translate","",1,"text-danger","text-center"],["type","submit",1,"btn","btn-success","btn-label","waves-effect","waves-light","rounded-pill","mx-2",3,"click","disabled"],["translate","sales.priceList.UpdateItems"],[1,"table-responsive"],["dataKey","id",3,"value","rows"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],[1,"row","justify-content-center","py-2"],["class","text-center text-danger text-bold fs-6  col-2",4,"ngIf"],[1,"text-center","text-danger","text-bold","fs-6","col-2"],[1,"btn","btn-dark",3,"click"],[1,"ri-check-double-fill","align-bottom"],[1,""],["translate","",2,"width",".5%"],["translate","",2,"width","30%"],["translate","",2,"width","10%"],[1,"fs-5"],["type","number",1,"form-control","text-center",3,"ngModelChange","placeholder","ngModel"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],["href","javascript:void(0);",1,"btn","btn-success",3,"click"]],template:function(i,n){if(1&i){const s=e.RV6();e.nrm(0,"app-breadcrumbs",7),e.nI1(1,"translate"),e.j41(2,"div",8)(3,"div",9)(4,"div",10),e.nrm(5,"ngx-ui-loader",11),e.j41(6,"form",12,0),e.bIt("submit",function(){return e.eBV(s),e.Njj(n.OnSubmit())}),e.j41(8,"div",8)(9,"div",13)(10,"label",14),e.EFF(11,"sales.priceList.name"),e.k0s(),e.j41(12,"input",15,1),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.formMaster.name,a)||(n.formMaster.name=a),e.Njj(a)}),e.k0s(),e.DNE(14,Ml,2,0,"div",16),e.k0s(),e.j41(15,"div",17)(16,"label",18),e.EFF(17,"sales.priceList.clientGroupName"),e.k0s(),e.j41(18,"ng-select",19,2),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.formMaster.clientGroupId,a)||(n.formMaster.clientGroupId=a),e.Njj(a)}),e.k0s(),e.DNE(20,Rl,2,0,"div",20),e.k0s(),e.j41(21,"div",17)(22,"label",18),e.EFF(23,"sales.priceList.discountType"),e.k0s(),e.j41(24,"ng-select",21,3),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.formMaster.discountType,a)||(n.formMaster.discountType=a),e.Njj(a)}),e.k0s()(),e.j41(26,"div",22)(27,"label",23),e.EFF(28,"sales.priceList.discount"),e.k0s(),e.j41(29,"input",24,4),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.formMaster.discount,a)||(n.formMaster.discount=a),e.Njj(a)}),e.k0s()(),e.j41(31,"div",22)(32,"label",25),e.EFF(33,"stores.storesUnits.isActive"),e.k0s(),e.j41(34,"p-inputSwitch",26),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.formMaster.isActive,a)||(n.formMaster.isActive=a),e.Njj(a)}),e.k0s()(),e.j41(35,"div",27)(36,"label",28),e.EFF(37,"sales.clientCollection.notes"),e.k0s(),e.j41(38,"textarea",29,5),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.formMaster.notes,a)||(n.formMaster.notes=a),e.Njj(a)}),e.k0s()(),e.j41(40,"div",30)(41,"button",31),e.nrm(42,"i",32)(43,"span",33),e.k0s(),e.DNE(44,Ol,3,1,"button",34),e.k0s()()()()()(),e.DNE(45,Vl,18,8,"div",35)}if(2&i){const s=e.sdS(7),l=e.sdS(13),a=e.sdS(19);e.FS9("title",e.bMT(1,17,n.title)),e.Y8G("breadcrumbItems",n.breadCrumbItems),e.R7$(5),e.Y8G("loaderId",n.operationLoader),e.R7$(7),e.R50("ngModel",n.formMaster.name),e.R7$(2),e.Y8G("ngIf",l.invalid&&l.touched),e.R7$(4),e.Y8G("items",n.clientGroups)("multiple",!1),e.R50("ngModel",n.formMaster.clientGroupId),e.R7$(2),e.Y8G("ngIf",a.invalid&&a.touched),e.R7$(4),e.Y8G("items",n.discountTypes),e.R50("ngModel",n.formMaster.discountType),e.R7$(5),e.R50("ngModel",n.formMaster.discount),e.R7$(5),e.R50("ngModel",n.formMaster.isActive),e.R7$(4),e.R50("ngModel",n.formMaster.notes),e.R7$(3),e.Y8G("disabled",!s.valid),e.R7$(3),e.Y8G("ngIf",n.listId),e.R7$(),e.Y8G("ngIf",n.listId)}},dependencies:[m.bT,d.qT,d.me,d.Q0,d.BC,d.cb,d.YS,d.vS,d.cV,ke.m,u.Mm,S.XI,z.Ei,ve.HW,C.Cv,E.vr,X.m,u.D9],encapsulation:2})}}return r})(),Dl=(()=>{class r extends Me.E{constructor(t,i,n){super(t,i,n)}static{this.\u0275fac=function(i){return new(i||r)(e.KVO(y.Ix),e.KVO(Fe.u),e.KVO(V.u))}}static{this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})(),El=(()=>{class r extends Me.E{constructor(t,i,n){super(t,i,n)}static{this.\u0275fac=function(i){return new(i||r)(e.KVO(y.Ix),e.KVO(Ve),e.KVO(V.u))}}static{this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();const Ll=()=>["salesOrder.viewOrderCount"],$l=()=>["salesOrder.register"],Xl=()=>["salesOrderStore.assignTrunk"],Bl=()=>["salesOrder.sendApproval"],Pl=()=>["salesOrder.sendStore"],Yl=()=>["salesOrder.printPill"],Ul=()=>["salesOrder.edit"],Al=()=>["salesOrder.changeQuantity"],Ql=()=>["salesOrder.reopenOrder"],ql=()=>["salesOrder.printItem"],zl=()=>["salesOrder.cancel"],ze=r=>[r];function Hl(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",38),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.onSelectStatus(-1))}),e.j41(1,"div",39)(2,"div",49)(3,"div",41)(4,"div",50),e.nrm(5,"i",43),e.k0s()(),e.j41(6,"div",44)(7,"h5",45),e.EFF(8),e.k0s(),e.nrm(9,"p",51),e.k0s()()()()}if(2&r){const t=e.XpG(2);e.R7$(2),e.AVh("bg-primary-subtle",null==t.pagination.status),e.R7$(6),e.JRh(t.count.all)}}function Jl(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",38),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.onSelectStatus(0))}),e.j41(1,"div",39)(2,"div",40)(3,"div",41)(4,"div",52),e.nrm(5,"i",43),e.k0s()(),e.j41(6,"div",44)(7,"h5",45),e.EFF(8),e.k0s(),e.nrm(9,"p",53),e.k0s()()()()}if(2&r){const t=e.XpG(2);e.R7$(),e.AVh("bg-primary-subtle",0==t.pagination.status),e.R7$(7),e.JRh(t.count.draft)}}function Kl(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",38),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.onSelectStatus(5))}),e.j41(1,"div",39)(2,"div",40)(3,"div",41)(4,"div",52),e.nrm(5,"i",43),e.k0s()(),e.j41(6,"div",44)(7,"h5",45),e.EFF(8),e.k0s(),e.nrm(9,"p",54),e.k0s()()()()}if(2&r){const t=e.XpG(2);e.R7$(),e.AVh("bg-primary-subtle",5==t.pagination.status),e.R7$(7),e.JRh(t.count.changeQuantity)}}function Zl(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",38),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.onSelectStatus(20))}),e.j41(1,"div",39)(2,"div",40)(3,"div",41)(4,"div",55),e.nrm(5,"i",43),e.k0s()(),e.j41(6,"div",44)(7,"h5",45),e.EFF(8),e.k0s(),e.nrm(9,"p",56),e.k0s()()()()}if(2&r){const t=e.XpG(2);e.R7$(),e.AVh("bg-primary-subtle",20==t.pagination.status),e.R7$(7),e.JRh(t.count.underReview)}}function Wl(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",38),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.onSelectStatus(30))}),e.j41(1,"div",39)(2,"div",40)(3,"div",41)(4,"div",57),e.nrm(5,"i",43),e.k0s()(),e.j41(6,"div",44)(7,"h5",45),e.EFF(8),e.k0s(),e.nrm(9,"p",58),e.k0s()()()()}if(2&r){const t=e.XpG(2);e.R7$(),e.AVh("bg-primary-subtle",30==t.pagination.status),e.R7$(7),e.JRh(t.count.repareOrder)}}function ed(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",38),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.onSelectStatus(50))}),e.j41(1,"div",39)(2,"div",40)(3,"div",41)(4,"div",59),e.nrm(5,"i",43),e.k0s()(),e.j41(6,"div",44)(7,"h5",45),e.EFF(8),e.k0s(),e.nrm(9,"p",60),e.k0s()()()()}if(2&r){const t=e.XpG(2);e.R7$(),e.AVh("bg-primary-subtle",50==t.pagination.status),e.R7$(7),e.JRh(t.count.assign)}}function td(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",36),e.DNE(1,Hl,10,3,"div",37)(2,Jl,10,3,"div",37)(3,Kl,10,3,"div",37)(4,Zl,10,3,"div",37)(5,Wl,10,3,"div",37)(6,ed,10,3,"div",37),e.j41(7,"div",38),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onSelectStatus(60))}),e.j41(8,"div",39)(9,"div",40)(10,"div",41)(11,"div",42),e.nrm(12,"i",43),e.k0s()(),e.j41(13,"div",44)(14,"h5",45),e.EFF(15),e.k0s(),e.nrm(16,"p",46),e.k0s()()()(),e.j41(17,"div",38),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onSelectStatus(40))}),e.j41(18,"div",39)(19,"div",40)(20,"div",41)(21,"div",47),e.nrm(22,"i",43),e.k0s()(),e.j41(23,"div",44)(24,"h5",45),e.EFF(25),e.k0s(),e.nrm(26,"p",48),e.k0s()()()()()}if(2&r){const t=e.XpG();e.R7$(),e.Y8G("ngIf",12!=t.user.userType),e.R7$(),e.Y8G("ngIf",1==t.user.userType||9==t.user.userType),e.R7$(),e.Y8G("ngIf",1==t.user.userType||9==t.user.userType),e.R7$(),e.Y8G("ngIf",1==t.user.userType||12==t.user.userType),e.R7$(),e.Y8G("ngIf",1==t.user.userType),e.R7$(),e.Y8G("ngIf",1==t.user.userType),e.R7$(2),e.AVh("bg-primary-subtle",60==t.pagination.status),e.R7$(7),e.JRh(t.count.finished),e.R7$(3),e.AVh("bg-primary-subtle",40==t.pagination.status),e.R7$(7),e.JRh(t.count.cancel)}}function nd(r,o){1&r&&(e.j41(0,"th",77),e.EFF(1," sales.salesOrder.cancelReasonName "),e.k0s())}function id(r,o){if(1&r&&(e.j41(0,"tr",61),e.nrm(1,"th",62),e.j41(2,"th",63),e.EFF(3,"#"),e.k0s(),e.j41(4,"th",64),e.nrm(5,"i",65),e.EFF(6," orderManagement.order.orderCode "),e.k0s(),e.j41(7,"th",66),e.nrm(8,"i",65),e.EFF(9," orderManagement.order.creation "),e.k0s(),e.j41(10,"th",67),e.EFF(11," orderManagement.order.status "),e.k0s(),e.j41(12,"th",68),e.nrm(13,"i",65),e.EFF(14," orderManagement.order.agentName "),e.k0s(),e.j41(15,"th",69),e.EFF(16," sales.salesOrder.clientLocationName "),e.k0s(),e.j41(17,"th",70),e.EFF(18," sales.salesOrder.salsePerson "),e.k0s(),e.j41(19,"th",71),e.nrm(20,"i",65),e.EFF(21," sales.salesOrder.clientVisitDate "),e.k0s(),e.j41(22,"th",72),e.nrm(23,"i",65),e.EFF(24," sales.salesOrder.totalQuantity "),e.k0s(),e.j41(25,"th",73),e.nrm(26,"i",65),e.EFF(27," sales.salesOrder.totalDiscount "),e.k0s(),e.j41(28,"th",74),e.EFF(29," orderManagement.order.totalTax "),e.k0s(),e.j41(30,"th",75),e.nrm(31,"i",65),e.EFF(32," sales.salesOrder.netPrice "),e.k0s(),e.DNE(33,nd,2,0,"th",76),e.nrm(34,"th",70),e.k0s()),2&r){const t=e.XpG();e.R7$(33),e.Y8G("ngIf",40==t.pagination.status||5==t.pagination.status)}}function rd(r,o){1&r&&e.nrm(0,"span",94)}function sd(r,o){if(1&r&&(e.j41(0,"a",95),e.nrm(1,"i",96),e.k0s()),2&r){const t=e.XpG().$implicit,i=e.XpG();e.Y8G("href",i.mapUrl(null==t?null:t.lng,null==t?null:t.lat),e.B4B)}}function ad(r,o){if(1&r&&(e.j41(0,"td")(1,"span",97),e.EFF(2),e.k0s()()),2&r){const t=e.XpG().$implicit;e.R7$(2),e.SpI("",t.cancelReasonName," ")}}function od(r,o){if(1&r&&(e.j41(0,"td")(1,"span",97),e.EFF(2),e.k0s()()),2&r){const t=e.XpG().$implicit;e.R7$(2),e.SpI("",t.changeQuantityMessage," ")}}function ld(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",99),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2).$implicit,s=e.XpG(),l=e.sdS(61);return e.Njj(s.openShippingModal(n.id,l,"lg"))}),e.nrm(2,"i",100),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"sales.salesOrder.shipping"))}function dd(r,o){if(1&r&&(e.qex(0),e.DNE(1,ld,3,3,"button",98),e.bVm()),2&r){const t=e.XpG().$implicit;e.R7$(),e.Y8G("ngIf",30==t.offerOrderStatus)}}function cd(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",102),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2).$implicit,s=e.XpG(),l=e.sdS(55);return e.Njj(s.openStatusModal(n.id,l,20,"md"))}),e.nrm(2,"i",103),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"general.action.send"))}function md(r,o){if(1&r&&(e.qex(0),e.DNE(1,cd,3,3,"button",101),e.bVm()),2&r){const t=e.XpG().$implicit;e.R7$(),e.Y8G("ngIf",0==t.offerOrderStatus||5==t.offerOrderStatus)}}function pd(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",105),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2).$implicit,s=e.XpG(),l=e.sdS(55);return e.Njj(s.openStatusModal(n.id,l,30,"md"))}),e.nrm(2,"i",103),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"general.action.approve"))}function gd(r,o){if(1&r&&(e.qex(0),e.DNE(1,pd,3,3,"button",104),e.bVm()),2&r){const t=e.XpG().$implicit;e.R7$(),e.Y8G("ngIf",20==t.offerOrderStatus)}}function _d(r,o){1&r&&(e.j41(0,"button",107),e.nI1(1,"translate"),e.nrm(2,"i",108),e.k0s()),2&r&&e.FS9("pTooltip",e.bMT(1,1,"general.action.print"))}function ud(r,o){if(1&r&&(e.qex(0),e.DNE(1,_d,3,3,"button",106),e.bVm()),2&r){const t=e.XpG().$implicit;e.R7$(),e.Y8G("ngIf",60==t.offerOrderStatus)}}function hd(r,o){if(1&r){const t=e.RV6();e.j41(0,"li",82),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2).$implicit,s=e.XpG(),l=e.sdS(49);return e.Njj(s.openModal(n.id,l,"xl"))}),e.j41(1,"span",109),e.nrm(2,"i",110)(3,"span",111),e.k0s()()}}function fd(r,o){if(1&r&&(e.qex(0),e.DNE(1,hd,4,0,"li",93),e.bVm()),2&r){const t=e.XpG(2);e.R7$(),e.Y8G("ngIf",null==t.pagination.status)}}function bd(r,o){if(1&r){const t=e.RV6();e.j41(0,"li",82),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2).$implicit,s=e.XpG(),l=e.sdS(49);return e.Njj(s.openModal(n.id,l,"xl"))}),e.j41(1,"span",109),e.nrm(2,"i",110)(3,"span",111),e.k0s()()}}function Cd(r,o){if(1&r){const t=e.RV6();e.j41(0,"li",82),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2).$implicit,s=e.XpG(),l=e.sdS(51);return e.Njj(s.openModal(n.id,l,"xl"))}),e.j41(1,"span",109),e.nrm(2,"i",110)(3,"span",111),e.k0s()()}}function Sd(r,o){if(1&r&&(e.qex(0),e.DNE(1,bd,4,0,"li",93)(2,Cd,4,0,"li",93),e.bVm()),2&r){const t=e.XpG().$implicit;e.R7$(),e.Y8G("ngIf",0==t.offerOrderStatus),e.R7$(),e.Y8G("ngIf",5==t.offerOrderStatus)}}function vd(r,o){if(1&r){const t=e.RV6();e.j41(0,"li",82),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2).$implicit,s=e.XpG(),l=e.sdS(57);return e.Njj(s.openModal(n.id,l))}),e.j41(1,"span",109),e.nrm(2,"i",112)(3,"span",113),e.k0s()()}}function jd(r,o){if(1&r&&(e.qex(0),e.DNE(1,vd,4,0,"li",93),e.bVm()),2&r){const t=e.XpG().$implicit;e.R7$(),e.Y8G("ngIf",20==t.offerOrderStatus)}}function Id(r,o){if(1&r){const t=e.RV6();e.j41(0,"li",82),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2).$implicit,s=e.XpG();return e.Njj(s.PrintOrderReceived(n.id))}),e.j41(1,"span",109),e.nrm(2,"i",114)(3,"span",115),e.k0s()()}}function yd(r,o){if(1&r&&(e.qex(0),e.DNE(1,Id,4,0,"li",93),e.bVm()),2&r){const t=e.XpG().$implicit;e.R7$(),e.Y8G("ngIf",50==t.offerOrderStatus)}}function kd(r,o){if(1&r){const t=e.RV6();e.j41(0,"li",82),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2).$implicit,s=e.XpG(),l=e.sdS(59);return e.Njj(s.openModal(n.id,l))}),e.j41(1,"span",109),e.nrm(2,"i",116)(3,"span",117),e.k0s()()}}function Td(r,o){if(1&r&&(e.qex(0),e.DNE(1,kd,4,0,"li",93),e.bVm()),2&r){const t=e.XpG().$implicit;e.R7$(),e.Y8G("ngIf",t.offerOrderStatus>0)}}function xd(r,o){if(1&r){const t=e.RV6();e.j41(0,"li",82),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,s=e.XpG(),l=e.sdS(45);return e.Njj(s.openModal(n.id,l))}),e.j41(1,"span",109),e.nrm(2,"i",116)(3,"span",118),e.k0s()()}}function Md(r,o){if(1&r){const t=e.RV6();e.j41(0,"tr",78)(1,"td"),e.nrm(2,"button",79),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td")(6,"bdi",80),e.EFF(7),e.k0s()(),e.j41(8,"td"),e.EFF(9),e.nI1(10,"date"),e.k0s(),e.j41(11,"td")(12,"span"),e.nrm(13,"span",81),e.k0s()(),e.j41(14,"td",82),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(),l=e.sdS(53);return e.Njj(s.openModal(n.clientId,l,"md"))}),e.j41(15,"a",83),e.EFF(16),e.k0s()(),e.j41(17,"td"),e.DNE(18,rd,1,0,"span",84)(19,sd,2,1,"a",85),e.k0s(),e.j41(20,"td"),e.EFF(21),e.k0s(),e.j41(22,"td"),e.EFF(23),e.nI1(24,"date"),e.k0s(),e.j41(25,"td"),e.EFF(26),e.k0s(),e.j41(27,"td"),e.EFF(28),e.k0s(),e.j41(29,"td"),e.EFF(30),e.k0s(),e.j41(31,"td"),e.EFF(32),e.k0s(),e.DNE(33,ad,3,1,"td",86)(34,od,3,1,"td",86),e.j41(35,"td"),e.DNE(36,dd,2,1,"ng-container",87)(37,md,2,1,"ng-container",87)(38,gd,2,1,"ng-container",87)(39,ud,2,1,"ng-container",87),e.j41(40,"span",88)(41,"div",89)(42,"button",90),e.nrm(43,"i",91),e.k0s(),e.j41(44,"ul",92),e.DNE(45,fd,2,1,"ng-container",87)(46,Sd,3,2,"ng-container",87)(47,jd,2,1,"ng-container",87)(48,yd,2,1,"ng-container",87)(49,Td,2,1,"ng-container",87)(50,xd,4,0,"li",93),e.k0s()()()()()}if(2&r){const t=o.$implicit,i=o.rowIndex,n=o.expanded,s=e.XpG();e.R7$(2),e.Y8G("pRowToggler",t)("ngClass",n?" ri-arrow-down-s-line":"  ri-arrow-up-s-line"),e.R7$(2),e.JRh(i+1),e.R7$(3),e.SpI("#SO#",t.id,""),e.R7$(2),e.SpI(" ",e.i5U(10,30,t.creationTime,"yyyy-MM-dd HH:mm")," "),e.R7$(3),e.ZvI("badge ",s.getStatus(t),""),e.R7$(),e.FS9("translate","sales.salesOrder."+t.offerOrderStatusValue),e.R7$(3),e.SpI(" ",t.clientName," "),e.R7$(2),e.Y8G("ngIf",""==t.lng),e.R7$(),e.Y8G("ngIf",null==t?null:t.lng),e.R7$(2),e.JRh(t.salsePersonName),e.R7$(2),e.SpI(" ",e.i5U(24,33,t.acutalVisitDate,"yyyy-MM-dd HH:mm"),""),e.R7$(3),e.JRh(t.totalQuantity),e.R7$(2),e.JRh(t.totalDiscount),e.R7$(2),e.JRh(t.totalTax),e.R7$(2),e.JRh(t.netPrice),e.R7$(),e.Y8G("ngIf",40==s.pagination.status),e.R7$(),e.Y8G("ngIf",5==s.pagination.status),e.R7$(2),e.Y8G("hasPermission",e.lJ4(36,Xl)),e.R7$(),e.Y8G("hasPermission",e.lJ4(37,Bl)),e.R7$(),e.Y8G("hasPermission",e.lJ4(38,Pl)),e.R7$(),e.Y8G("hasPermission",e.lJ4(39,Yl)),e.R7$(6),e.Y8G("hasPermission",e.lJ4(40,Ul)),e.R7$(),e.Y8G("hasPermission",e.lJ4(41,Al)),e.R7$(),e.Y8G("hasPermission",e.lJ4(42,Ql)),e.R7$(),e.Y8G("hasPermission",e.lJ4(43,ql)),e.R7$(),e.Y8G("hasPermission",e.lJ4(44,zl)),e.R7$(),e.Y8G("ngIf",0==t.offerOrderStatus)}}function Rd(r,o){if(1&r&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td"),e.EFF(10),e.nI1(11,"translate"),e.k0s(),e.j41(12,"td"),e.EFF(13),e.k0s(),e.j41(14,"td"),e.EFF(15),e.k0s()()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t.itemName),e.R7$(2),e.JRh(t.unitName),e.R7$(2),e.JRh(t.clientQuantity),e.R7$(2),e.JRh(t.approvedQuantity),e.R7$(2),e.SpI("",e.bMT(11,7,"sales.salesOrder."+t.discountTypeValue)," "),e.R7$(3),e.JRh(t.discount),e.R7$(2),e.JRh(t.price)}}function Od(r,o){if(1&r&&(e.j41(0,"tr")(1,"td",119)(2,"div")(3,"table",120)(4,"thead")(5,"tr",121),e.nrm(6,"th",122)(7,"th",123)(8,"th",124)(9,"th",125)(10,"th",126)(11,"th",127)(12,"th",128),e.k0s()(),e.j41(13,"tbody"),e.DNE(14,Rd,16,9,"tr",129),e.k0s()()()()()),2&r){const t=o.$implicit;e.R7$(14),e.Y8G("ngForOf",t.offerOrderDetails)}}function Fd(r,o){1&r&&(e.j41(0,"div",130),e.EFF(1," general.table.noData "),e.k0s())}function Nd(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",131)(1,"div",132),e.nrm(2,"ngb-pagination-info",133),e.j41(3,"table-length",134),e.bIt("lengthChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",135)(5,"ngb-pagination",136),e.bIt("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.pagination.pageNumber,n)||(s.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function wd(r,o){if(1&r){const t=e.RV6();e.j41(0,"delete-modal",137),e.bIt("deleteConfirm",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.DeleteConfirm())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}}function Gd(r,o){if(1&r){const t=e.RV6();e.j41(0,"app-all-orders-details",138),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderDetails",t.operationId)}}function Vd(r,o){if(1&r){const t=e.RV6();e.j41(0,"sales-edit-order",139),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("isChangeQuantity",!0)("isDraft",!0)("orderSelected",t.operationId)}}function Dd(r,o){if(1&r){const t=e.RV6();e.j41(0,"sales-edit-order",139),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("isChangeQuantity",!0)("isDraft",!0)("orderSelected",t.operationId)}}function Ed(r,o){if(1&r){const t=e.RV6();e.j41(0,"client-summary",140),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("clientId",t.operationId)}}function Ld(r,o){if(1&r){const t=e.RV6();e.j41(0,"form",141,10),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.SubmitOrder())}),e.nrm(2,"ngx-ui-loader",142),e.j41(3,"div",143)(4,"div",144)(5,"button",145),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"div",146)(7,"div",147),e.nrm(8,"lord-icon",148),e.j41(9,"div",149),e.nrm(10,"h3",150)(11,"p",151),e.k0s()(),e.j41(12,"div",152),e.nrm(13,"button",153),e.j41(14,"button",154),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}function $d(r,o){1&r&&(e.j41(0,"div",161),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function Xd(r,o){if(1&r){const t=e.RV6();e.j41(0,"form",141,10),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.RequestChangeQuantity())}),e.nrm(2,"ngx-ui-loader",142),e.j41(3,"div",143)(4,"div",144)(5,"button",145),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"div",146)(7,"div",155)(8,"label",156),e.EFF(9,"sales.salesOrder.changeQuantityMessage"),e.k0s(),e.j41(10,"textarea",157,11),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.changeQuantityMessage,n)||(s.form.changeQuantityMessage=n),e.Njj(n)}),e.k0s(),e.DNE(12,$d,2,0,"div",158),e.k0s(),e.j41(13,"div",152),e.nrm(14,"button",159),e.j41(15,"button",160),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()}if(2&r){const t=e.sdS(1),i=e.sdS(11),n=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",n.loaderOperationShap)("loaderId",n.deleteLoader),e.R7$(8),e.R50("ngModel",n.form.changeQuantityMessage),e.R7$(2),e.Y8G("ngIf",i.invalid&&i.touched),e.R7$(2),e.Y8G("disabled",!t.valid)}}function Bd(r,o){if(1&r){const t=e.RV6();e.j41(0,"cancel-sales-model",162),e.bIt("success",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.reload())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderId",t.operationId)}}function Pd(r,o){if(1&r){const t=e.RV6();e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td")(4,"ng-select",191),e.mxI("ngModelChange",function(n){const s=e.eBV(t).$implicit;return e.DH7(s.unitId,n)||(s.unitId=n),e.Njj(n)}),e.k0s()(),e.j41(5,"td")(6,"input",192),e.bIt("ngModelChange",function(n){const s=e.eBV(t).$index,l=e.XpG(2);return e.Njj(l.quantitySelect(n,s))}),e.mxI("ngModelChange",function(n){const s=e.eBV(t).$implicit;return e.DH7(s.quantity,n)||(s.quantity=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=o.$implicit,i=o.$index;e.R7$(2),e.SpI(" ",t.itemName," "),e.R7$(2),e.Y8G("name","unitId"+e.eq3(6,ze,i))("items",t.units),e.R50("ngModel",t.unitId),e.R7$(2),e.Y8G("name","quantity"+e.eq3(8,ze,i)),e.R50("ngModel",t.quantity)}}function Yd(r,o){if(1&r){const t=e.RV6();e.j41(0,"tr",193),e.nrm(1,"td",194),e.j41(2,"td",195)(3,"table",196)(4,"tbody")(5,"tr"),e.nrm(6,"td",197),e.j41(7,"td",198),e.EFF(8),e.nI1(9,"translate"),e.k0s()(),e.j41(10,"tr"),e.nrm(11,"td",199),e.j41(12,"td",198)(13,"div",200)(14,"ng-select",201),e.bIt("change",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.getTotal())}),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG(2);return e.DH7(s.form.totalAddDiscountType,n)||(s.form.totalAddDiscountType=n),e.Njj(n)}),e.k0s(),e.j41(15,"input",202),e.bIt("change",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.getTotal())}),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG(2);return e.DH7(s.form.totalAddDiscount,n)||(s.form.totalAddDiscount=n),e.Njj(n)}),e.k0s()()()(),e.j41(16,"tr",203),e.nrm(17,"td",204),e.j41(18,"td",198),e.EFF(19),e.nI1(20,"translate"),e.k0s()(),e.j41(21,"tr",205),e.nrm(22,"th",206),e.j41(23,"th",198),e.EFF(24),e.nI1(25,"translate"),e.k0s()()()()()()}if(2&r){const t=e.XpG(2);e.R7$(8),e.Lme("",t.form.total," ",e.bMT(9,9,"orderManagement.order.currancy"),""),e.R7$(6),e.Y8G("items",t.discountTypes),e.R50("ngModel",t.form.totalAddDiscountType),e.R7$(),e.R50("ngModel",t.form.totalAddDiscount),e.R7$(4),e.Lme("",t.form.tax," ",e.bMT(20,11,"orderManagement.order.currancy"),""),e.R7$(5),e.Lme("",t.form.totalNet," ",e.bMT(25,13,"orderManagement.order.currancy"),"")}}function Ud(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",163)(1,"div",164)(2,"h4",165),e.nrm(3,"span",166),e.k0s(),e.j41(4,"button",167),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss("Cross click"))}),e.k0s()(),e.j41(5,"div",146),e.nrm(6,"ngx-ui-loader",142),e.j41(7,"form",168,10),e.bIt("submit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.updateTruck())}),e.j41(9,"div",13)(10,"div",169)(11,"label",170),e.EFF(12,"sales.salesOrder.acutalDeliveryDate"),e.k0s(),e.j41(13,"input",171),e.bIt("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.dateChangeModal(n))}),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.acutalVisitDate,n)||(s.form.acutalVisitDate=n),e.Njj(n)}),e.k0s()(),e.j41(14,"div",169),e.nrm(15,"label",172),e.j41(16,"ng-select",173),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.clientLocationId,n)||(s.form.clientLocationId=n),e.Njj(n)}),e.k0s()(),e.j41(17,"div",174)(18,"label",170),e.EFF(19,"sales.salesOrder.truncks"),e.k0s(),e.j41(20,"ng-select",175),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.shippingTruckId,n)||(s.form.shippingTruckId=n),e.Njj(n)}),e.k0s()()(),e.j41(21,"div",176)(22,"div",39)(23,"div",177)(24,"div",178),e.nrm(25,"h5",179),e.k0s()(),e.j41(26,"div",28)(27,"div",180)(28,"table",181)(29,"thead",182)(30,"tr"),e.nrm(31,"th",183)(32,"th",184)(33,"th",185),e.k0s()(),e.j41(34,"tbody"),e.Z7z(35,Pd,7,10,"tr",null,e.Vm6),e.DNE(37,Yd,26,15,"tr",186),e.k0s()()()()()(),e.j41(38,"div",187)(39,"button",188),e.nrm(40,"i",189)(41,"span",190),e.k0s()()()()()}if(2&r){const t=e.sdS(8),i=e.XpG();e.R7$(6),e.Y8G("hasProgressBar",!1)("fgsType",i.loaderOperationShap)("loaderId",i.operationLoader),e.R7$(7),e.R50("ngModel",i.form.acutalVisitDate),e.Y8G("altInput",!0)("enableTime",!0)("convertModelValue",!0)("dateFormat","d-m-Y H:i"),e.R7$(3),e.Y8G("disabled",!0)("items",i.locations),e.R50("ngModel",i.form.clientLocationId),e.R7$(4),e.Y8G("items",i.truncks),e.R50("ngModel",i.form.shippingTruckId),e.R7$(15),e.Dyx(i.form.details),e.R7$(2),e.Y8G("ngIf",!1),e.R7$(2),e.Y8G("disabled",!t.valid)}}let Ad=(()=>{class r extends Y.w{constructor(t,i,n,s,l,a,f,M,R,O,w,k,v,j,b){super(t,i,f,n,s,l,a),this.baseService=n,this.authDaamService=M,this.teamService=R,this.employeeService=O,this.regionService=w,this.cityService=k,this.excelService=v,this.router=j,this.orderReceivedService=b,this.title="sales.salesOrder.title",this.titleOperation="sales.salesOrder.titleOperation",this.keySelected="",this.searchForm={},this.isResolveList=!0,this.employeeGroups=[],this.activeindex="2",this.active=2,this.clientSelected=0,this.status=[],this.countLoad=2,this.isOrderEdit=!1,this.orderSelected={},this.users=[],this.statusCount={},this.salesPersons=[],this.regions=[],this.cities=[],this.count={},this.truncks=[],this.locations=[],this.discountTypes=[],this.user=JSON.parse(localStorage.getItem("user")),this.setDates=(h,G,F)=>{if(h?.from||h?.to){const W=h.to||h.from;this.pagination[G]=this.datePipe.transform(h.from||h.to,"yyyy-MM-ddT00:00:00"),this.pagination[F]=this.datePipe.transform(W,"yyyy-MM-ddT23:59:59.999")}else this.pagination[G]=null,this.pagination[F]=null},this.configRoute(),this.GetSalesPersons(),this.GetRegions(),this.GetCities(),this.GetOfferOrderCount()}GetOfferOrderCount(){this.baseService.GetOfferOrderCount().subscribe(t=>{this.count=t.data})}GetRegions(){this.regionService.getDropDown().subscribe(t=>{this.regions=t.data},t=>{console.log(t)})}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetSalesPersons(){this.employeeService.GetAllByType(9).subscribe(t=>{this.salesPersons=t.data},t=>{console.log(t)})}ngOnInitMore(){this.discountTypes=this.baseService.discountTypes,this.discountTypes.forEach(t=>{t.name=this.getTranslationText("sales.salesOrder."+t.name)})}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,p.Q)(this.notifier)).subscribe(i=>{i?this.alertService.success():this.alertService.error("general.message."+i)},i=>{this.alertService.error()})}mapRegisterForm(t){let i={...t};return i.employeeCode=0,i}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader("allLoader"),this.setDates(t.dates,"visitDateFrom","visitDateTo"),this.setDates(t.creationDates,"creationTimeFrom","creationTimeTo"),this.loadentities()}LoadSuccess(){this.ngxLoader.stopLoader("allLoader")}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems},this.loadentities()}configRoute(){this.routerActive.data.pipe((0,p.Q)(this.notifier)).subscribe(t=>{this.entities=t.data,this.pagination.totalItems=t.data?.totalItems},()=>{this.alertService.error()})}mapExcel(){let t=[];return this.entities.forEach(i=>{t.push({Code:i.id,CreatorName:i.creatorName,creationTime:i.creationTime,clientName:i.clientName,Status:this.getTranslationText("sales.salesOrder."+i.offerOrderStatusValue),salse_Person:i.salsePersonName,"Delivery.Date":i.acutalVisitDate,"T.Quantity":i.totalQuantity," T.Discount":i.totalDiscount,Tax:i.totalTax,Net:i.netPrice,Reason:i.cancelReasonName})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}getStatus(t){return 10==t.offerOrderStatus||5==t.offerOrderStatus?"bg-warning":20==t.offerOrderStatus?"bg-secondary ":30==t.offerOrderStatus?"bg-info":60==t.offerOrderStatus?"bg-success":40==t.offerOrderStatus?"bg-danger":50==t.offerOrderStatus?"bg-info":"bg-warning"}checkEdit(t){return!t.isCancel&&!t.isFinish}openModalClient(t,i,n="xl"){this.clientSelected=t.orderCode,this.orderSelected=t,this.isOrderEdit=!1,this.modalService.open(i,{centered:!0,size:n})}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}goNew(){this.router.navigateByUrl("/sales/new")}onSelectStatus(t){-1===t?(this.pagination.status=null,this.pagination.statusList=[]):30===t?(this.pagination.status=null,this.pagination.statusList=[30,32]):(this.pagination.status=t,this.pagination.statusList=[]),this.onSearch()}openStatusModal(t,i,n,s="md"){this.isEditForm=!1,this.form={},this.form={id:t,status:n},this.modalService.open(i,{centered:!0,size:s})}SubmitOrder(){this.ngxLoader.startLoader(g.Fq),this.baseService.changStatus({id:this.form.id,status:this.form.status}).pipe((0,T.O)(),(0,N.c)(this.mainDelay),(0,x.Z)(),(0,p.Q)(this.notifier),(0,I.j)(()=>this.ngxLoader.stopLoader(g.Fq))).subscribe({next:i=>{i.success?(this.modalService.dismissAll(),this.reload(),this.alertService.success()):this.alertService.error("general.message."+i.message)}})}cancelOrder(){this.ngxLoader.startLoader(g.Fq),console.log(this.operationId),this.baseService.changStatus({id:this.operationId,status:40}).pipe((0,T.O)(),(0,N.c)(this.mainDelay),(0,x.Z)(),(0,p.Q)(this.notifier),(0,I.j)(()=>this.ngxLoader.stopLoader(g.Fq))).subscribe({next:i=>{this.modalService.dismissAll(),this.reload(),this.alertService.success()}})}RequestChangeQuantity(){this.ngxLoader.startLoader(g.Fq),console.log(this.operationId),this.baseService.RequestChangeQuantity({id:this.operationId,changeQuantityMessage:this.form.changeQuantityMessage}).pipe((0,T.O)(),(0,N.c)(this.mainDelay),(0,x.Z)(),(0,p.Q)(this.notifier),(0,I.j)(()=>this.ngxLoader.stopLoader(g.Fq))).subscribe({next:i=>{this.modalService.dismissAll(),this.reload(),this.alertService.success()}})}reload(){this.modalService.dismissAll(),this.GetOfferOrderCount(),this.loadentities()}formatDate(t){if(!t)return"";const i=new Date(t);return i.getDate().toString().padStart(2,"0")+"-"+(i.getMonth()+1).toString().padStart(2,"0")+"-"+i.getFullYear()+" "+i.getHours().toString().padStart(2,"0")+":"+i.getMinutes().toString().padStart(2,"0")}openShippingModal(t,i,n="md"){this.baseService.GetTrucks({id:t,acutalVisitDate:null}).subscribe(l=>{l.success?(this.form=l.data.order,this.getTotal(),this.form.clientVisitDate=this.formatDate(this.form.clientVisitDate),this.form.acutalVisitDate=this.formatDate(this.form.acutalVisitDate),this.truncks=l.data.truncks,this.locations=l.data.locations,this.modalService.open(i,{centered:!0,size:n})):this.alertService.error("general.message."+l.message)},l=>{this.alertService.error("general.message."+l)})}getTotal(){let t=0,i=0,n=0;this.form.details.forEach(s=>{s.discount<0&&(s.discoun=0);let l=s.quantity*s.price,a=0;1===s.discountType?a=s.discount:2===s.discountType&&(a=l*s.discount/100),i=+a;let f=l-a;s.net=f,t=+f}),1===this.form.totalAddDiscountType?n=this.form.totalAddDiscount:2===this.form.totalAddDiscountType&&(n=t*this.form.totalAddDiscount/100),this.form.total=t,this.form.totalAddDiscount=this.form.totalAddDiscount,this.form.tax=15*this.form.total/100,this.form.totalNet=this.form.total-n+this.form.tax}updateTruck(){this.form.acutalVisitDate=new Date(this.convertToISO(this.form.acutalVisitDate));let t={shippingTruckId:this.form.shippingTruckId,clientLocationId:this.form.clientLocationId,offerOrderMasterId:this.form.id,Notes:this.form.notes,terms:this.form.terms,deliveryDate:this.datePipe.transform(this.form.acutalVisitDate,"yyyy-MM-ddTHH:mm:00.000"),details:this.form.details.map(i=>({id:0,itemId:i.itemId,itemName:i.itemName,quantity:i.quantity,unitId:i.unitId,price:i.price,discount:i.discount,discountType:i.discountType,clientQuantity:i.clientQuantity,approvedQuantity:i.approvedQuantity}))};this.ngxLoader.startLoader(this.operationLoader),this.orderReceivedService.register(t).pipe((0,T.O)(),(0,N.c)(this.mainDelay),(0,x.Z)(),(0,p.Q)(this.notifier),(0,I.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(i=>{i.success?this.reload():this.alertService.error("general.message."+i.message)},i=>{this.alertService.error("general.message."+i)})}convertToISO(t){if(t instanceof Date)return t.toISOString();if("string"==typeof t){const[i,n,s,l,a]=t.split(/[-\s:]/);return`${s}-${n}-${i}T${l}:${a}:00`}}dateChangeModal(t){t=new Date(t);let i={id:this.form.id,acutalVisitDate:this.datePipe.transform(t,"yyyy-MM-ddT00:00:00.000")};this.baseService.GetTrucks(i).subscribe(n=>{n.success?this.truncks=n.data.truncks:this.alertService.error("general.message."+n.message)},n=>{this.alertService.error("general.message."+n)})}quantitySelect(t,i){t&&(t<=0&&(t=1),this.form.details[i].quantity=parseInt(t),this.form.details[i].net=this.form.details[i].price*this.form.details[i].quantity,this.discountSelect(this.form.details[i].discount,i),this.getTotal())}discountSelect(t,i,n=1){if(t){(t=parseInt(t))<=0&&(this.form.details[i].discount=0),1==n&&(this.form.details[i].discount=t);let s=0;1==this.form.details[i].discountType?s=this.form.details[i].discount:(s=this.form.details[i].price*this.form.details[i].quantity*this.form.details[i].discount/100,s=+s.toFixed(2)),this.form.details[i].net=this.form.details[i].price*this.form.details[i].quantity-s,this.form.details[i].net=this.form.details[i].net.toFixed(2),this.getTotal()}}PrintOrderReceived(t){this.ngxLoader.startLoader("allLoader"),this.orderReceivedService.PrintOrderReceived(t).pipe((0,T.O)(),(0,x.Z)(),(0,p.Q)(this.notifier),(0,I.j)(()=>this.ngxLoader.stopLoader("allLoader"))).subscribe(i=>{this.openUrl(i)},i=>{this.alertService.error("general.message."+i)})}openUrl(t){let i=new Blob([t],{type:t.type});var n=URL.createObjectURL(i);window.open(n,"_blank")}mapUrl(t,i){return null===t||null==i?"":`https://www.google.com/maps/dir//${i},${t}/@${i},${t},17z?hl=en-US`}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(y.nX),e.rXU(u.c$),e.rXU(P),e.rXU(V.u),e.rXU(m.vh),e.rXU(C.eD),e.rXU(_.Bq),e.rXU(ee.J),e.rXU(ge.n),e.rXU(Z.O),e.rXU(re.S),e.rXU(K.h),e.rXU(H.V),e.rXU(y.Ix),e.rXU(Se))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-sales-order"]],features:[e.Vt3],decls:62,vars:53,consts:[["tableMaster",""],["deleteModal",""],["orderViewModel",""],["SalesEditModel",""],["SalesChangeModel",""],["ClientInfo",""],["StatusOrderModal",""],["SubmitChangeQuantityModal",""],["cancelModal",""],["SubmitOrderModal",""],["formEntity","ngForm"],["changeQuantityMessage","ngModel"],["class","row justify-content-center",4,"hasPermission"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"addNew","reset","search","exportXlsx","addPermission","showAdd","showExport","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","id","name","id",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],["InputTirmFilter","","type","search","id","clientName","name","clientName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["name","regionId","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],["name","cityId","bindValue","code","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,"row","justify-content-center"],["class","col-sm-12 col-custom-7 cursor-pointer ",3,"click",4,"ngIf"],[1,"col-sm-12","col-custom-7","cursor-pointer",3,"click"],[1,"card"],[1,"card-body","d-flex","gap-3","align-items-center"],[1,"avatar-sm"],[1,"avatar-title","border","bg-success","border-opacity-25","rounded-2","fs-17"],[1,"ri-shopping-cart-2-fill"],[1,"flex-grow-1"],[1,"fs-15"],["translate","sales.salesOrder.completeOrder",1,"mb-0","text-muted"],[1,"avatar-title","border","bg-danger","border-opacity-25","rounded-2","fs-17"],["translate","sales.salesOrder.cancelOrder",1,"mb-0","text-muted"],[1,"card-body","bg-primary-subtle","d-flex","gap-3","align-items-center"],[1,"avatar-title","border","border-opacity-25","rounded-2","fs-17"],["translate","general.table.all",1,"mb-0","text-muted"],[1,"avatar-title","border","bg-warning","border-opacity-25","rounded-2","fs-17"],["translate","sales.salesOrder.draft",1,"mb-0","text-muted"],["translate","sales.salesOrder.reopen",1,"mb-0","text-muted"],[1,"avatar-title","bg-secondary","border","border-opacity-25","rounded-2","fs-17"],["translate","sales.salesOrder.approveMangerSM",1,"mb-0","text-muted"],[1,"avatar-title","bg-info","border","border-opacity-25","rounded-2","fs-17"],["translate","sales.salesOrder.storeRepeare",1,"mb-0","text-muted"],[1,"avatar-title","border","bg-info","border-opacity-25","rounded-2","fs-17"],["translate","sales.salesOrder.orderShipping",1,"mb-0","text-muted"],[1,""],[2,"width",".2%"],["translate","",2,"width",".5%"],["pSortableColumn","id","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["pSortableColumn","creationTime","translate","",2,"width","10%"],["pSortableColumn","status","translate","",2,"width","6%"],["pSortableColumn","clientId","translate","",2,"width","10%"],["translate","",2,"width","3%"],["translate","",2,"width","8%"],["pSortableColumn","clientVisitDate","translate","",2,"width","10%"],["pSortableColumn","totalQuantity","translate","",2,"width","8%"],["pSortableColumn","totalDiscount","translate","",2,"width","8%"],["translate","",2,"width","6%"],["pSortableColumn","netPrice","translate","",2,"width","8%"],["style","width:10%","translate","",4,"ngIf"],["translate","",2,"width","10%"],[1,"fs-5"],["type","button","pRipple","",1,"border-0","p-button-text","p-button-rounded","p-button-plain",3,"pRowToggler","ngClass"],[1,"code-pointer"],[3,"translate"],[3,"click"],["href","javascript:void(0)",1,"link-primary","link-offset-2","text-decoration-underline","link-underline-opacity-25","link-underline-opacity-100-hover"],["class","badge bg-danger-subtle text-danger mx-1","translate","orderManagement.order.noMap",4,"ngIf"],["target","_blank","class","badge bg-success-subtle text-success mx-1","translate","orderManagement.order.viewMap",3,"href",4,"ngIf"],[4,"ngIf"],[4,"hasPermission"],[1,"d-inline-block"],[1,"dropdown-custom","d-inline-block"],["type","button",1,"btn","dropbtn","btn-soft-secondary","btn-sm","dropdown-custom","arrow-none"],[1,"ri-more-fill"],[1,"dropdown-menu","dropdown-menu-end","dropdown-content",2,"left","0"],[3,"click",4,"ngIf"],["translate","orderManagement.order.noMap",1,"badge","bg-danger-subtle","text-danger","mx-1"],["target","_blank","translate","orderManagement.order.viewMap",1,"badge","bg-success-subtle","text-success","mx-1",3,"href"],[1,"ri-map-pin-line"],[1,"badge","bg-danger-subtle","text-danger"],["class","btn btn-sm btn-primary edit-list mx-1","tooltipPosition","top",3,"pTooltip","click",4,"ngIf"],["tooltipPosition","top",1,"btn","btn-sm","btn-primary","edit-list","mx-1",3,"click","pTooltip"],[1,"ri-truck-line","align-bottom"],["class","btn btn-sm btn-warning edit-list mx-1","tooltipPosition","top",3,"pTooltip","click",4,"ngIf"],["tooltipPosition","top",1,"btn","btn-sm","btn-warning","edit-list","mx-1",3,"click","pTooltip"],[1,"ri-send-plane-fill","align-bottom"],["class","btn btn-sm btn-success edit-list mx-1","tooltipPosition","top",3,"pTooltip","click",4,"ngIf"],["tooltipPosition","top",1,"btn","btn-sm","btn-success","edit-list","mx-1",3,"click","pTooltip"],["class","btn btn-sm btn-success edit-list mx-1","tooltipPosition","top",3,"pTooltip",4,"ngIf"],["tooltipPosition","top",1,"btn","btn-sm","btn-success","edit-list","mx-1",3,"pTooltip"],[1,"ri-printer-cloud-fill","align-bottom"],[1,"dropdown-item"],[1,"text-success","ri-pencil-fill","align-bottom","me-2"],["translate","general.action.edit"],[1,"text-primary","ri-check-double-fill","align-bottom","me-2"],["translate","sales.salesOrder.backToSales"],[1,"text-primary","ri-printer-line","align-bottom","me-2"],["translate","sales.salesOrder.printItem"],[1,"text-danger","ri-close-fill","align-bottom","me-2"],["translate","general.action.cancel"],["translate","general.action.delete"],["colspan","17"],["dataKey","id"],[1,"bg-light"],["translate","sales.salesOrder.itemName",2,"width","10%"],["translate","sales.salesOrder.unit",2,"width","6%"],["translate","sales.salesOrder.clientQuantity",2,"width","8%"],["translate","sales.salesOrder.approvedQuantity",2,"width","8%"],["translate","sales.salesOrder.discountType",2,"width","5%"],["translate","sales.salesOrder.discount",2,"width","5%"],["translate","sales.salesOrder.price",2,"width","5%"],[4,"ngFor","ngForOf"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"deleteConfirm","dismiss"],[3,"dismiss","orderDetails"],[3,"dismiss","isChangeQuantity","isDraft","orderSelected"],[3,"dismiss","clientId"],[3,"ngSubmit"],[3,"hasProgressBar","fgsType","loaderId"],[1,"modal-content"],[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mt-2","text-center"],["src","https://cdn.lordicon.com/gdfrsvpt.json","stroke","bold","state","hover-oscillate","trigger","loop","colors","primary:#f7b84b,secondary:#f06548",2,"width","130px","height","130px"],[1,"pt-2","fs-15","mx-4","mx-sm-5"],["translate","orderManagement.order.AreYouSureMessage"],[1,"text-muted","mx-4","mb-0"],[1,"d-flex","gap-2","justify-content-center","mt-4","mb-2"],["type","submit","id","save","translate","general.action.send",1,"btn","w-sm","btn-danger","fs-4"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light","fs-4",3,"click"],[1,"mb-2"],["for","changeQuantityMessage","translate","",1,"required","text-bold","form-label"],["rows","5","InputTirmFilter","","name","changeQuantityMessage","type","text","id","changeQuantityMessage",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["class","text-danger text-center  ","translate","",4,"ngIf"],["t","","type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger",3,"disabled"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],["translate","",1,"text-danger","text-center"],[3,"success","dismiss","orderId"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["translate","sales.salesOrder.truckUpdate"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[3,"submit"],[1,"col-12","col-md-3"],["for","name","translate","",1,"required","fw-bold","form-label"],["name","acutalVisitDate","type","text","mwlFlatpickr","","altFormat","d-m-Y H:i","required","",1,"form-control","flatpickr-input",3,"ngModelChange","ngModel","altInput","enableTime","convertModelValue","dateFormat"],["for","name","translate","orderManagement.order.savedAddress",1,"required","fw-bold","form-label"],["name","clientLocationId","bindValue","id","bindLabel","name","required","",2,"width","100%",3,"ngModelChange","disabled","items","ngModel"],[1,"col-12","col-md-6"],["name","shippingTruckId","bindValue","id","bindLabel","name","required","",2,"width","100%",3,"ngModelChange","items","ngModel"],[1,"row","justify-content-center","my-0"],[1,"card-header","p-0"],[1,"d-flex","align-items-center"],["translate","sales.salesRequests.items",1,"card-title","flex-grow-1","mb-0"],[1,"table-responsive","table-card",2,"overflow","visible"],[1,"table","table-nowrap","align-middle","table-borderless","mb-0"],[1,"table-light","text-muted","p-1"],["translate","sales.salesRequests.itemName",2,"width","20%"],["translate","sales.salesRequests.unit",2,"width","25%"],["translate","sales.salesRequests.quantity",2,"width","25%"],["class","border-top border-top-dashed",4,"ngIf"],[1,"d-flex","justify-content-center","m-0"],["type","submit","type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],["clearable","false","clearOnBackspace","false","bindValue","id","bindLabel","name",2,"width","100%",3,"ngModelChange","name","items","ngModel"],["type","text","id","quantity",1,"form-control","fs-6",3,"ngModelChange","name","ngModel"],[1,"border-top","border-top-dashed"],["colspan","3"],["colspan","4",1,"fw-medium","p-0"],[1,"table","table-borderless","mb-0"],["translate","sales.salesOrder.total",1,"m-0","p-0"],[1,"text-end","m-0","p-0"],["translate","sales.salesOrder.extraDiscount",1,"m-0","p-0"],[1,"input-group","mx-4",2,"width","80%"],["clearable","false","clearOnBackspace","false","name","totalAddDiscountType","bindValue","id","bindLabel","name",3,"change","ngModelChange","items","ngModel"],["InputTirmFilter","","name","totalAddDiscount","type","text","id","totalAddDiscount",1,"form-control","fs-6",2,"width","30%",3,"change","ngModelChange","ngModel"],[1,"m-0","p-0"],["translate","sales.salesOrder.tax",1,"m-0","p-0"],[1,"border-top","border-top-dashed","m-0","p-0"],["scope","row","translate","sales.salesOrder.net",1,"m-0","p-0"]],template:function(i,n){if(1&i){const s=e.RV6();e.DNE(0,td,27,12,"div",12),e.j41(1,"div",13)(2,"div",14)(3,"div",15),e.nrm(4,"ngx-ui-loader",16),e.j41(5,"base-filter",17),e.bIt("addNew",function(){return e.eBV(s),e.Njj(n.goNew())})("reset",function(){return e.eBV(s),e.Njj(n.onReset())})("search",function(){return e.eBV(s),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(s),e.Njj(n.onExportXlsx())}),e.qex(6,18),e.j41(7,"div",19)(8,"div",20)(9,"input",21),e.nI1(10,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.id,a)||(n.pagination.id=a),e.Njj(a)}),e.k0s(),e.nrm(11,"i",22),e.k0s()(),e.j41(12,"div",19)(13,"input",23),e.nI1(14,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.searchForm.creationDates,a)||(n.searchForm.creationDates=a),e.Njj(a)}),e.k0s()(),e.j41(15,"div",19)(16,"div",20)(17,"input",24),e.nI1(18,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.clientName,a)||(n.pagination.clientName=a),e.Njj(a)}),e.k0s(),e.nrm(19,"i",22),e.k0s()(),e.j41(20,"div",19)(21,"div",20)(22,"ng-select",25),e.nI1(23,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.salesPersonId,a)||(n.pagination.salesPersonId=a),e.Njj(a)}),e.k0s()()(),e.j41(24,"div",19)(25,"input",23),e.nI1(26,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.searchForm.dates,a)||(n.searchForm.dates=a),e.Njj(a)}),e.k0s()(),e.j41(27,"div",19)(28,"div",20)(29,"ng-select",26),e.nI1(30,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.regionId,a)||(n.pagination.regionId=a),e.Njj(a)}),e.k0s()()(),e.j41(31,"div",19)(32,"div",20)(33,"ng-select",27),e.nI1(34,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.cityId,a)||(n.pagination.cityId=a),e.Njj(a)}),e.k0s()()(),e.bVm(),e.k0s(),e.j41(35,"div",28)(36,"div",29)(37,"p-table",30,0),e.bIt("onLazyLoad",function(a){return e.eBV(s),e.Njj(n.tableChange(a))})("selectionChange",function(a){return e.eBV(s),e.Njj(n.onSelectionChange(a))}),e.DNE(39,id,35,1,"ng-template",31)(40,Md,51,45,"ng-template",32)(41,Od,15,1,"ng-template",33),e.k0s()(),e.DNE(42,Fd,2,0,"div",34)(43,Nd,6,8,"div",35),e.k0s()()()(),e.DNE(44,wd,1,0,"ng-template",null,1,e.C5r)(46,Gd,1,1,"ng-template",null,2,e.C5r)(48,Vd,1,3,"ng-template",null,3,e.C5r)(50,Dd,1,3,"ng-template",null,4,e.C5r)(52,Ed,1,1,"ng-template",null,5,e.C5r)(54,Ld,15,3,"ng-template",null,6,e.C5r)(56,Xd,16,6,"ng-template",null,7,e.C5r)(58,Bd,1,1,"ng-template",null,8,e.C5r)(60,Ud,42,15,"ng-template",null,9,e.C5r)}2&i&&(e.Y8G("hasPermission",e.lJ4(51,Ll)),e.R7$(4),e.Y8G("loaderId","allLoader"),e.R7$(),e.Y8G("addPermission",e.lJ4(52,$l))("showAdd",!0)("showExport",!0)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(10,37,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.id),e.R7$(4),e.FS9("placeholder",e.bMT(14,39,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(4),e.FS9("placeholder",e.bMT(18,41,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.clientName),e.R7$(5),e.FS9("placeholder",e.bMT(23,43,"sales.salesOrder.salsePerson")),e.Y8G("items",n.salesPersons)("multiple",!1),e.R50("ngModel",n.pagination.salesPersonId),e.R7$(3),e.FS9("placeholder",e.bMT(26,45,"sales.salesOrder.clientVisitDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.dates),e.R7$(4),e.FS9("placeholder",e.bMT(30,47,"client.client.regionName")),e.Y8G("items",n.regions)("multiple",!1),e.R50("ngModel",n.pagination.regionId),e.R7$(4),e.FS9("placeholder",e.bMT(34,49,"client.client.cityName")),e.Y8G("items",n.cities)("multiple",!1),e.R50("ngModel",n.pagination.cityId),e.R7$(4),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(5),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[m.YU,m.Sq,m.bT,d.qT,d.me,d.Q0,d.BC,d.cb,d.YS,d.vS,d.cV,_.s5,D.kL,A.b,te.w,Q.p,q.g,ue,u.Mm,S.XI,z.Ei,S.Tg,S.FP,C.Cv,E.vr,X.m,U.p,ie.m,_e,fe,m.vh,u.D9],encapsulation:2})}}return r})();const Qd=()=>["salesOrder.register"],qd=()=>["salesOrderStore.assignTrunk"],zd=()=>["salesOrderStore.prepare"],He=r=>[r];function Hd(r,o){1&r&&(e.j41(0,"tr",49),e.nrm(1,"th",50),e.j41(2,"th",51),e.EFF(3,"#"),e.k0s(),e.j41(4,"th",52),e.nrm(5,"i",53),e.EFF(6," orderManagement.order.orderCode "),e.k0s(),e.j41(7,"th",54),e.nrm(8,"i",53),e.EFF(9," orderManagement.order.creation "),e.k0s(),e.j41(10,"th",55),e.EFF(11," orderManagement.order.status "),e.k0s(),e.j41(12,"th",56),e.nrm(13,"i",53),e.EFF(14," orderManagement.order.agentName "),e.k0s(),e.j41(15,"th",57),e.EFF(16," sales.salesOrder.clientLocationName "),e.k0s(),e.j41(17,"th",58),e.EFF(18," sales.salesOrder.salsePerson "),e.k0s(),e.j41(19,"th",59),e.nrm(20,"i",53),e.EFF(21," sales.salesOrder.clientVisitDate "),e.k0s(),e.j41(22,"th",60),e.nrm(23,"i",53),e.EFF(24," sales.salesOrder.totalQuantity "),e.k0s(),e.j41(25,"th",61),e.nrm(26,"i",53),e.EFF(27," sales.salesOrder.netPrice "),e.k0s(),e.nrm(28,"th",58),e.k0s())}function Jd(r,o){1&r&&e.nrm(0,"span",71)}function Kd(r,o){if(1&r&&(e.j41(0,"a",72),e.nrm(1,"i",73),e.k0s()),2&r){const t=e.XpG().$implicit,i=e.XpG();e.Y8G("href",i.mapUrl(null==t?null:t.lng,null==t?null:t.lat),e.B4B)}}function Zd(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",75),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2).$implicit,s=e.XpG(),l=e.sdS(91);return e.Njj(s.openShippingModal(n.id,l,"lg"))}),e.nrm(2,"i",76),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"sales.salesOrderStore.trunkAssign"))}function Wd(r,o){if(1&r&&(e.qex(0),e.DNE(1,Zd,3,3,"button",74),e.bVm()),2&r){const t=e.XpG().$implicit;e.R7$(),e.Y8G("ngIf",32==t.offerOrderStatus)}}function ec(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",78),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2).$implicit,s=e.XpG(),l=e.sdS(85);return e.Njj(s.openStatusModal(n.id,l,32,"md"))}),e.nrm(2,"i",79),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"sales.salesOrderStore.ready"))}function tc(r,o){if(1&r&&(e.qex(0),e.DNE(1,ec,3,3,"button",77),e.bVm()),2&r){const t=e.XpG().$implicit;e.R7$(),e.Y8G("ngIf",30==t.offerOrderStatus)}}function nc(r,o){if(1&r){const t=e.RV6();e.j41(0,"tr",62)(1,"td"),e.nrm(2,"button",63),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td")(6,"bdi",64),e.EFF(7),e.k0s()(),e.j41(8,"td"),e.EFF(9),e.nI1(10,"date"),e.k0s(),e.j41(11,"td")(12,"span"),e.nrm(13,"span",65),e.k0s()(),e.j41(14,"td",66),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(),l=e.sdS(83);return e.Njj(s.openModal(n.clientId,l,"md"))}),e.j41(15,"a",67),e.EFF(16),e.k0s()(),e.j41(17,"td"),e.DNE(18,Jd,1,0,"span",68)(19,Kd,2,1,"a",69),e.k0s(),e.j41(20,"td"),e.EFF(21),e.k0s(),e.j41(22,"td"),e.EFF(23),e.nI1(24,"date"),e.k0s(),e.j41(25,"td"),e.EFF(26),e.k0s(),e.j41(27,"td"),e.EFF(28),e.k0s(),e.j41(29,"td"),e.DNE(30,Wd,2,1,"ng-container",70)(31,tc,2,1,"ng-container",70),e.k0s()()}if(2&r){const t=o.$implicit,i=o.rowIndex,n=o.expanded,s=e.XpG();e.R7$(2),e.Y8G("pRowToggler",t)("ngClass",n?" ri-arrow-down-s-line":"  ri-arrow-up-s-line"),e.R7$(2),e.JRh(i+1),e.R7$(3),e.SpI("#SO#",t.id,""),e.R7$(2),e.SpI(" ",e.i5U(10,18,t.creationTime,"yyyy-MM-dd HH:mm")," "),e.R7$(3),e.ZvI("badge ",s.getStatus(t),""),e.R7$(),e.FS9("translate","sales.salesOrder."+t.offerOrderStatusValue),e.R7$(3),e.SpI(" ",t.clientName," "),e.R7$(2),e.Y8G("ngIf",""==t.lng),e.R7$(),e.Y8G("ngIf",null==t?null:t.lng),e.R7$(2),e.JRh(t.salsePersonName),e.R7$(2),e.SpI(" ",e.i5U(24,21,t.acutalVisitDate,"yyyy-MM-dd HH:mm"),""),e.R7$(3),e.JRh(t.totalQuantity),e.R7$(2),e.JRh(t.netPrice),e.R7$(2),e.Y8G("hasPermission",e.lJ4(24,qd)),e.R7$(),e.Y8G("hasPermission",e.lJ4(25,zd))}}function ic(r,o){if(1&r&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.k0s()()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t.itemName),e.R7$(2),e.JRh(t.unitName),e.R7$(2),e.JRh(t.approvedQuantity),e.R7$(2),e.JRh(t.price)}}function rc(r,o){if(1&r&&(e.j41(0,"tr")(1,"td",80)(2,"div")(3,"table",81)(4,"thead")(5,"tr",82),e.nrm(6,"th",83)(7,"th",84)(8,"th",85)(9,"th",86),e.k0s()(),e.j41(10,"tbody"),e.DNE(11,ic,9,4,"tr",87),e.k0s()()()()()),2&r){const t=o.$implicit;e.R7$(11),e.Y8G("ngForOf",t.offerOrderDetails)}}function sc(r,o){1&r&&(e.j41(0,"div",88),e.EFF(1," general.table.noData "),e.k0s())}function ac(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",89)(1,"div",90),e.nrm(2,"ngb-pagination-info",91),e.j41(3,"table-length",92),e.bIt("lengthChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",93)(5,"ngb-pagination",94),e.bIt("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.pagination.pageNumber,n)||(s.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function oc(r,o){if(1&r){const t=e.RV6();e.j41(0,"delete-modal",95),e.bIt("deleteConfirm",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.DeleteConfirm())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}}function lc(r,o){if(1&r){const t=e.RV6();e.j41(0,"app-all-orders-details",96),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderDetails",t.operationId)}}function dc(r,o){if(1&r){const t=e.RV6();e.j41(0,"sales-edit-order",97),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("isChangeQuantity",!0)("isDraft",!0)("orderSelected",t.operationId)}}function cc(r,o){if(1&r){const t=e.RV6();e.j41(0,"sales-edit-order",97),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("isChangeQuantity",!0)("isDraft",!0)("orderSelected",t.operationId)}}function mc(r,o){if(1&r){const t=e.RV6();e.j41(0,"client-summary",98),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("clientId",t.operationId)}}function pc(r,o){if(1&r){const t=e.RV6();e.j41(0,"form",99,10),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.SubmitOrder())}),e.nrm(2,"ngx-ui-loader",100),e.j41(3,"div",101)(4,"div",102)(5,"button",103),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"div",104)(7,"div",105),e.nrm(8,"lord-icon",106),e.j41(9,"div",107),e.nrm(10,"h3",108)(11,"p",109),e.k0s()(),e.j41(12,"div",110),e.nrm(13,"button",111),e.j41(14,"button",112),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}function gc(r,o){1&r&&(e.j41(0,"div",119),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function _c(r,o){if(1&r){const t=e.RV6();e.j41(0,"form",99,10),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.RequestChangeQuantity())}),e.nrm(2,"ngx-ui-loader",100),e.j41(3,"div",101)(4,"div",102)(5,"button",103),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"div",104)(7,"div",113)(8,"label",114),e.EFF(9,"sales.salesOrder.changeQuantityMessage"),e.k0s(),e.j41(10,"textarea",115,11),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.changeQuantityMessage,n)||(s.form.changeQuantityMessage=n),e.Njj(n)}),e.k0s(),e.DNE(12,gc,2,0,"div",116),e.k0s(),e.j41(13,"div",110),e.nrm(14,"button",117),e.j41(15,"button",118),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()}if(2&r){const t=e.sdS(1),i=e.sdS(11),n=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",n.loaderOperationShap)("loaderId",n.deleteLoader),e.R7$(8),e.R50("ngModel",n.form.changeQuantityMessage),e.R7$(2),e.Y8G("ngIf",i.invalid&&i.touched),e.R7$(2),e.Y8G("disabled",!t.valid)}}function uc(r,o){if(1&r){const t=e.RV6();e.j41(0,"cancel-sales-model",120),e.bIt("success",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.reload())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderId",t.operationId)}}function hc(r,o){if(1&r){const t=e.RV6();e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td")(4,"ng-select",149),e.mxI("ngModelChange",function(n){const s=e.eBV(t).$implicit;return e.DH7(s.unitId,n)||(s.unitId=n),e.Njj(n)}),e.k0s()(),e.j41(5,"td")(6,"input",150),e.bIt("ngModelChange",function(n){const s=e.eBV(t).$index,l=e.XpG(2);return e.Njj(l.quantitySelect(n,s))}),e.mxI("ngModelChange",function(n){const s=e.eBV(t).$implicit;return e.DH7(s.quantity,n)||(s.quantity=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=o.$implicit,i=o.$index;e.R7$(2),e.SpI(" ",t.itemName," "),e.R7$(2),e.Y8G("name","unitId"+e.eq3(6,He,i))("items",t.units),e.R50("ngModel",t.unitId),e.R7$(2),e.Y8G("name","quantity"+e.eq3(8,He,i)),e.R50("ngModel",t.quantity)}}function fc(r,o){if(1&r){const t=e.RV6();e.j41(0,"tr",151),e.nrm(1,"td",152),e.j41(2,"td",153)(3,"table",154)(4,"tbody")(5,"tr"),e.nrm(6,"td",155),e.j41(7,"td",156),e.EFF(8),e.nI1(9,"translate"),e.k0s()(),e.j41(10,"tr"),e.nrm(11,"td",157),e.j41(12,"td",156)(13,"div",158)(14,"ng-select",159),e.bIt("change",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.getTotal())}),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG(2);return e.DH7(s.form.totalAddDiscountType,n)||(s.form.totalAddDiscountType=n),e.Njj(n)}),e.k0s(),e.j41(15,"input",160),e.bIt("change",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.getTotal())}),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG(2);return e.DH7(s.form.totalAddDiscount,n)||(s.form.totalAddDiscount=n),e.Njj(n)}),e.k0s()()()(),e.j41(16,"tr",161),e.nrm(17,"td",162),e.j41(18,"td",156),e.EFF(19),e.nI1(20,"translate"),e.k0s()(),e.j41(21,"tr",163),e.nrm(22,"th",164),e.j41(23,"th",156),e.EFF(24),e.nI1(25,"translate"),e.k0s()()()()()()}if(2&r){const t=e.XpG(2);e.R7$(8),e.Lme("",t.form.total," ",e.bMT(9,9,"orderManagement.order.currancy"),""),e.R7$(6),e.Y8G("items",t.discountTypes),e.R50("ngModel",t.form.totalAddDiscountType),e.R7$(),e.R50("ngModel",t.form.totalAddDiscount),e.R7$(4),e.Lme("",t.form.tax," ",e.bMT(20,11,"orderManagement.order.currancy"),""),e.R7$(5),e.Lme("",t.form.totalNet," ",e.bMT(25,13,"orderManagement.order.currancy"),"")}}function bc(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",121)(1,"div",122)(2,"h4",123),e.nrm(3,"span",124),e.k0s(),e.j41(4,"button",125),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss("Cross click"))}),e.k0s()(),e.j41(5,"div",104),e.nrm(6,"ngx-ui-loader",100),e.j41(7,"form",126,10),e.bIt("submit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.updateTruck())}),e.j41(9,"div",26)(10,"div",127)(11,"label",128),e.EFF(12,"sales.salesOrder.acutalDeliveryDate"),e.k0s(),e.j41(13,"input",129),e.bIt("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.dateChangeModal(n))}),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.acutalVisitDate,n)||(s.form.acutalVisitDate=n),e.Njj(n)}),e.k0s()(),e.j41(14,"div",127),e.nrm(15,"label",130),e.j41(16,"ng-select",131),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.clientLocationId,n)||(s.form.clientLocationId=n),e.Njj(n)}),e.k0s()(),e.j41(17,"div",132)(18,"label",128),e.EFF(19,"sales.salesOrder.truncks"),e.k0s(),e.j41(20,"ng-select",133),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.shippingTruckId,n)||(s.form.shippingTruckId=n),e.Njj(n)}),e.k0s()()(),e.j41(21,"div",134)(22,"div",14)(23,"div",135)(24,"div",136),e.nrm(25,"h5",137),e.k0s()(),e.j41(26,"div",41)(27,"div",138)(28,"table",139)(29,"thead",140)(30,"tr"),e.nrm(31,"th",141)(32,"th",142)(33,"th",143),e.k0s()(),e.j41(34,"tbody"),e.Z7z(35,hc,7,10,"tr",null,e.Vm6),e.DNE(37,fc,26,15,"tr",144),e.k0s()()()()()(),e.j41(38,"div",145)(39,"button",146),e.nrm(40,"i",147)(41,"span",148),e.k0s()()()()()}if(2&r){const t=e.sdS(8),i=e.XpG();e.R7$(6),e.Y8G("hasProgressBar",!1)("fgsType",i.loaderOperationShap)("loaderId",i.operationLoader),e.R7$(7),e.R50("ngModel",i.form.acutalVisitDate),e.Y8G("altInput",!0)("enableTime",!0)("convertModelValue",!0)("dateFormat","d-m-Y H:i"),e.R7$(3),e.Y8G("disabled",!0)("items",i.locations),e.R50("ngModel",i.form.clientLocationId),e.R7$(4),e.Y8G("items",i.truncks),e.R50("ngModel",i.form.shippingTruckId),e.R7$(15),e.Dyx(i.form.details),e.R7$(2),e.Y8G("ngIf",!1),e.R7$(2),e.Y8G("disabled",!t.valid)}}const Sc=[{path:"sales-orders",component:ja,canActivate:[ne.g],data:{permission:["salesOrder.view"]}},{path:"sales-order-store",component:(()=>{class r extends Y.w{constructor(t,i,n,s,l,a,f,M,R,O,w,k,v,j,b){super(t,i,f,n,s,l,a),this.baseService=n,this.authDaamService=M,this.teamService=R,this.employeeService=O,this.regionService=w,this.cityService=k,this.excelService=v,this.router=j,this.orderReceivedService=b,this.title="sales.salesOrderStore.title",this.titleOperation="sales.salesOrderStore.titleOperation",this.keySelected="",this.searchForm={},this.isResolveList=!0,this.employeeGroups=[],this.activeindex="2",this.active=2,this.clientSelected=0,this.status=[],this.countLoad=2,this.isOrderEdit=!1,this.orderSelected={},this.users=[],this.statusCount={},this.salesPersons=[],this.regions=[],this.cities=[],this.count={},this.truncks=[],this.locations=[],this.discountTypes=[],this.pagination={pageNumber:1,pageSize:10,status:30},this.setDates=(h,G,F)=>{if(h?.from||h?.to){const W=h.to||h.from;this.pagination[G]=this.datePipe.transform(h.from||h.to,"yyyy-MM-ddT00:00:00"),this.pagination[F]=this.datePipe.transform(W,"yyyy-MM-ddT23:59:59.999")}else this.pagination[G]=null,this.pagination[F]=null},this.configRoute(),this.GetSalesPersons(),this.GetRegions(),this.GetCities(),this.GetOfferOrderCount()}GetOfferOrderCount(){this.baseService.GetOfferOrderStoreCount().subscribe(t=>{this.count=t.data})}GetRegions(){this.regionService.getDropDown().subscribe(t=>{this.regions=t.data},t=>{console.log(t)})}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetSalesPersons(){this.employeeService.GetAllByType(9).subscribe(t=>{this.salesPersons=t.data},t=>{console.log(t)})}ngOnInitMore(){this.discountTypes=this.baseService.discountTypes,this.discountTypes.forEach(t=>{t.name=this.getTranslationText("sales.salesOrder."+t.name)})}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,p.Q)(this.notifier)).subscribe(i=>{i?this.alertService.success():this.alertService.error("general.message."+i)},i=>{this.alertService.error()})}mapRegisterForm(t){let i={...t};return i.employeeCode=0,i}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader("allLoader"),this.setDates(t.dates,"visitDateFrom","visitDateTo"),this.setDates(t.creationDates,"creationTimeFrom","creationTimeTo"),this.loadentities()}LoadSuccess(){this.ngxLoader.stopLoader("allLoader")}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems},this.loadentities()}configRoute(){this.routerActive.data.pipe((0,p.Q)(this.notifier)).subscribe(t=>{this.entities=t.data,this.pagination.totalItems=t.data?.totalItems},()=>{this.alertService.error()})}mapExcel(){let t=[];return this.entities.forEach(i=>{t.push({Code:i.id,CreatorName:i.creatorName,creationTime:i.creationTime,clientName:i.clientName,Status:this.getTranslationText("sales.salesOrder."+i.offerOrderStatusValue),salse_Person:i.salsePersonName,"Delivery.Date":i.acutalVisitDate,"T.Quantity":i.totalQuantity," T.Discount":i.totalDiscount,Tax:i.totalTax,Net:i.netPrice,Reason:i.cancelReasonName})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}getStatus(t){return 10==t.offerOrderStatus||5==t.offerOrderStatus?"bg-warning":20==t.offerOrderStatus?"bg-secondary ":30==t.offerOrderStatus?"bg-info":60==t.offerOrderStatus?"bg-success":40==t.offerOrderStatus?"bg-danger":50==t.offerOrderStatus?"bg-info":"bg-warning"}checkEdit(t){return!t.isCancel&&!t.isFinish}openModalClient(t,i,n="xl"){this.clientSelected=t.orderCode,this.orderSelected=t,this.isOrderEdit=!1,this.modalService.open(i,{centered:!0,size:n})}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}goNew(){this.router.navigateByUrl("/sales/new")}onSelectStatus(t){this.pagination.status=-1==t?null:t,this.onSearch()}openStatusModal(t,i,n,s="md"){this.isEditForm=!1,this.form={},this.form={id:t,status:n},this.modalService.open(i,{centered:!0,size:s})}SubmitOrder(){this.ngxLoader.startLoader(g.Fq),this.baseService.changStatus({id:this.form.id,status:this.form.status}).pipe((0,T.O)(),(0,N.c)(this.mainDelay),(0,x.Z)(),(0,p.Q)(this.notifier),(0,I.j)(()=>this.ngxLoader.stopLoader(g.Fq))).subscribe({next:i=>{this.modalService.dismissAll(),this.reload(),this.alertService.success()}})}cancelOrder(){this.ngxLoader.startLoader(g.Fq),console.log(this.operationId),this.baseService.changStatus({id:this.operationId,status:40}).pipe((0,T.O)(),(0,N.c)(this.mainDelay),(0,x.Z)(),(0,p.Q)(this.notifier),(0,I.j)(()=>this.ngxLoader.stopLoader(g.Fq))).subscribe({next:i=>{this.modalService.dismissAll(),this.reload(),this.alertService.success()}})}RequestChangeQuantity(){this.ngxLoader.startLoader(g.Fq),console.log(this.operationId),this.baseService.RequestChangeQuantity({id:this.operationId,changeQuantityMessage:this.form.changeQuantityMessage}).pipe((0,T.O)(),(0,N.c)(this.mainDelay),(0,x.Z)(),(0,p.Q)(this.notifier),(0,I.j)(()=>this.ngxLoader.stopLoader(g.Fq))).subscribe({next:i=>{this.modalService.dismissAll(),this.reload(),this.alertService.success()}})}reload(){this.modalService.dismissAll(),this.GetOfferOrderCount(),this.loadentities()}formatDate(t){if(!t)return"";const i=new Date(t);return i.getDate().toString().padStart(2,"0")+"-"+(i.getMonth()+1).toString().padStart(2,"0")+"-"+i.getFullYear()+" "+i.getHours().toString().padStart(2,"0")+":"+i.getMinutes().toString().padStart(2,"0")}openShippingModal(t,i,n="md"){this.baseService.GetTrucks({id:t,acutalVisitDate:null}).subscribe(l=>{l.success?(this.form=l.data.order,this.getTotal(),this.form.clientVisitDate=this.formatDate(this.form.clientVisitDate),this.form.acutalVisitDate=this.formatDate(this.form.acutalVisitDate),this.truncks=l.data.truncks,this.locations=l.data.locations,this.modalService.open(i,{centered:!0,size:n})):this.alertService.error("general.message."+l.message)},l=>{this.alertService.error("general.message."+l)})}getTotal(){let t=0,i=0,n=0;this.form.details.forEach(s=>{s.discount<0&&(s.discoun=0);let l=s.quantity*s.price,a=0;1===s.discountType?a=s.discount:2===s.discountType&&(a=l*s.discount/100),i=+a;let f=l-a;s.net=f,t=+f}),1===this.form.totalAddDiscountType?n=this.form.totalAddDiscount:2===this.form.totalAddDiscountType&&(n=t*this.form.totalAddDiscount/100),this.form.total=t,this.form.totalAddDiscount=this.form.totalAddDiscount,this.form.tax=15*this.form.total/100,this.form.totalNet=this.form.total-n+this.form.tax}updateTruck(){this.form.acutalVisitDate=new Date(this.convertToISO(this.form.acutalVisitDate));let t={shippingTruckId:this.form.shippingTruckId,clientLocationId:this.form.clientLocationId,offerOrderMasterId:this.form.id,Notes:this.form.notes,terms:this.form.terms,deliveryDate:this.datePipe.transform(this.form.acutalVisitDate,"yyyy-MM-ddTHH:mm:00.000"),details:this.form.details.map(i=>({id:0,itemId:i.itemId,itemName:i.itemName,quantity:i.quantity,unitId:i.unitId,price:i.price,discount:i.discount,discountType:i.discountType,clientQuantity:i.clientQuantity,approvedQuantity:i.approvedQuantity}))};this.ngxLoader.startLoader(this.operationLoader),this.orderReceivedService.register(t).pipe((0,T.O)(),(0,N.c)(this.mainDelay),(0,x.Z)(),(0,p.Q)(this.notifier),(0,I.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(i=>{i.success?this.reload():this.alertService.error("general.message."+i.message)},i=>{this.alertService.error("general.message."+i)})}convertToISO(t){if(t instanceof Date)return t.toISOString();if("string"==typeof t){const[i,n,s,l,a]=t.split(/[-\s:]/);return`${s}-${n}-${i}T${l}:${a}:00`}}dateChangeModal(t){t=new Date(t);let i={id:this.form.id,acutalVisitDate:this.datePipe.transform(t,"yyyy-MM-ddT00:00:00.000")};this.baseService.GetTrucks(i).subscribe(n=>{n.success?this.truncks=n.data.truncks:this.alertService.error("general.message."+n.message)},n=>{this.alertService.error("general.message."+n)})}quantitySelect(t,i){t&&(t<=0&&(t=1),this.form.details[i].quantity=parseInt(t),this.form.details[i].net=this.form.details[i].price*this.form.details[i].quantity,this.discountSelect(this.form.details[i].discount,i),this.getTotal())}discountSelect(t,i,n=1){if(t){(t=parseInt(t))<=0&&(this.form.details[i].discount=0),1==n&&(this.form.details[i].discount=t);let s=0;1==this.form.details[i].discountType?s=this.form.details[i].discount:(s=this.form.details[i].price*this.form.details[i].quantity*this.form.details[i].discount/100,s=+s.toFixed(2)),this.form.details[i].net=this.form.details[i].price*this.form.details[i].quantity-s,this.form.details[i].net=this.form.details[i].net.toFixed(2),this.getTotal()}}PrintOrderReceived(t){this.ngxLoader.startLoader("allLoader"),this.orderReceivedService.PrintOrderReceived(t).pipe((0,T.O)(),(0,x.Z)(),(0,p.Q)(this.notifier),(0,I.j)(()=>this.ngxLoader.stopLoader("allLoader"))).subscribe(i=>{this.openUrl(i)},i=>{this.alertService.error("general.message."+i)})}openUrl(t){let i=new Blob([t],{type:t.type});var n=URL.createObjectURL(i);window.open(n,"_blank")}mapUrl(t,i){return null===t||null==i?"":`https://www.google.com/maps/dir//${i},${t}/@${i},${t},17z?hl=en-US`}loadentities(){this.baseService.GetOrderStore(this.pagination).pipe((0,p.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader(g.a7),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader(g.a7),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[]}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(y.nX),e.rXU(u.c$),e.rXU(P),e.rXU(V.u),e.rXU(m.vh),e.rXU(C.eD),e.rXU(_.Bq),e.rXU(ee.J),e.rXU(ge.n),e.rXU(Z.O),e.rXU(re.S),e.rXU(K.h),e.rXU(H.V),e.rXU(y.Ix),e.rXU(Se))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-sales-order-store"]],features:[e.Vt3],decls:92,vars:60,consts:[["tableMaster",""],["deleteModal",""],["orderViewModel",""],["SalesEditModel",""],["SalesChangeModel",""],["ClientInfo",""],["StatusOrderModal",""],["SubmitChangeQuantityModal",""],["cancelModal",""],["SubmitOrderModal",""],["formEntity","ngForm"],["changeQuantityMessage","ngModel"],[1,"row","justify-content-center"],[1,"col-sm-12","col-md-3","cursor-pointer",3,"click"],[1,"card"],[1,"card-body","d-flex","gap-3","align-items-center"],[1,"avatar-sm"],[1,"avatar-title","bg-warning","border","border-opacity-25","rounded-2","fs-17"],[1,"ri-shopping-cart-2-fill"],[1,"flex-grow-1"],[1,"fs-15"],["translate","sales.salesOrderStore.deliveries",1,"mb-0","text-muted"],[1,"avatar-title","border","bg-success","border-opacity-25","rounded-2","fs-17"],["translate","sales.salesOrderStore.ready",1,"mb-0","text-muted"],[1,"avatar-title","border","bg-danger","border-opacity-25","rounded-2","fs-17"],["translate","sales.salesOrderStore.return",1,"mb-0","text-muted"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"addNew","reset","search","exportXlsx","addPermission","showAdd","showExport","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","id","name","id",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],["InputTirmFilter","","type","search","id","clientName","name","clientName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["name","regionId","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],["name","cityId","bindValue","code","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],[2,"width",".2%"],["translate","",2,"width",".5%"],["pSortableColumn","id","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["pSortableColumn","creationTime","translate","",2,"width","10%"],["pSortableColumn","status","translate","",2,"width","6%"],["pSortableColumn","clientId","translate","",2,"width","10%"],["translate","",2,"width","3%"],["translate","",2,"width","8%"],["pSortableColumn","clientVisitDate","translate","",2,"width","10%"],["pSortableColumn","totalQuantity","translate","",2,"width","8%"],["pSortableColumn","netPrice","translate","",2,"width","8%"],[1,"fs-5"],["type","button","pRipple","",1,"border-0","p-button-text","p-button-rounded","p-button-plain",3,"pRowToggler","ngClass"],[1,"code-pointer"],[3,"translate"],[3,"click"],["href","javascript:void(0)",1,"link-primary","link-offset-2","text-decoration-underline","link-underline-opacity-25","link-underline-opacity-100-hover"],["class","badge bg-danger-subtle text-danger mx-1","translate","orderManagement.order.noMap",4,"ngIf"],["target","_blank","class","badge bg-success-subtle text-success mx-1","translate","orderManagement.order.viewMap",3,"href",4,"ngIf"],[4,"hasPermission"],["translate","orderManagement.order.noMap",1,"badge","bg-danger-subtle","text-danger","mx-1"],["target","_blank","translate","orderManagement.order.viewMap",1,"badge","bg-success-subtle","text-success","mx-1",3,"href"],[1,"ri-map-pin-line"],["class","btn btn-sm btn-primary edit-list mx-1","tooltipPosition","top",3,"pTooltip","click",4,"ngIf"],["tooltipPosition","top",1,"btn","btn-sm","btn-primary","edit-list","mx-1",3,"click","pTooltip"],[1,"ri-truck-line","align-bottom"],["class","btn btn-sm btn-warning edit-list mx-1","tooltipPosition","top",3,"pTooltip","click",4,"ngIf"],["tooltipPosition","top",1,"btn","btn-sm","btn-warning","edit-list","mx-1",3,"click","pTooltip"],[1,"ri-send-plane-fill","align-bottom"],["colspan","17"],["dataKey","id"],[1,"bg-light"],["translate","sales.salesOrder.itemName",2,"width","10%"],["translate","sales.salesOrder.unit",2,"width","6%"],["translate","sales.salesOrder.approvedQuantity",2,"width","8%"],["translate","sales.salesOrder.price",2,"width","5%"],[4,"ngFor","ngForOf"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"deleteConfirm","dismiss"],[3,"dismiss","orderDetails"],[3,"dismiss","isChangeQuantity","isDraft","orderSelected"],[3,"dismiss","clientId"],[3,"ngSubmit"],[3,"hasProgressBar","fgsType","loaderId"],[1,"modal-content"],[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mt-2","text-center"],["src","https://cdn.lordicon.com/gdfrsvpt.json","stroke","bold","state","hover-oscillate","trigger","loop","colors","primary:#f7b84b,secondary:#f06548",2,"width","130px","height","130px"],[1,"pt-2","fs-15","mx-4","mx-sm-5"],["translate","orderManagement.order.AreYouSureMessage"],[1,"text-muted","mx-4","mb-0"],[1,"d-flex","gap-2","justify-content-center","mt-4","mb-2"],["type","submit","id","save","translate","general.action.send",1,"btn","w-sm","btn-danger","fs-4"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light","fs-4",3,"click"],[1,"mb-2"],["for","changeQuantityMessage","translate","",1,"required","text-bold","form-label"],["rows","5","InputTirmFilter","","name","changeQuantityMessage","type","text","id","changeQuantityMessage",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["class","text-danger text-center  ","translate","",4,"ngIf"],["t","","type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger",3,"disabled"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],["translate","",1,"text-danger","text-center"],[3,"success","dismiss","orderId"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["translate","sales.salesOrder.truckUpdate"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[3,"submit"],[1,"col-12","col-md-3"],["for","name","translate","",1,"required","fw-bold","form-label"],["name","acutalVisitDate","type","text","mwlFlatpickr","","altFormat","d-m-Y H:i","required","",1,"form-control","flatpickr-input",3,"ngModelChange","ngModel","altInput","enableTime","convertModelValue","dateFormat"],["for","name","translate","orderManagement.order.savedAddress",1,"required","fw-bold","form-label"],["name","clientLocationId","bindValue","id","bindLabel","name","required","",2,"width","100%",3,"ngModelChange","disabled","items","ngModel"],[1,"col-12","col-md-6"],["name","shippingTruckId","bindValue","id","bindLabel","name","required","",2,"width","100%",3,"ngModelChange","items","ngModel"],[1,"row","justify-content-center","my-0"],[1,"card-header","p-0"],[1,"d-flex","align-items-center"],["translate","sales.salesRequests.items",1,"card-title","flex-grow-1","mb-0"],[1,"table-responsive","table-card",2,"overflow","visible"],[1,"table","table-nowrap","align-middle","table-borderless","mb-0"],[1,"table-light","text-muted","p-1"],["translate","sales.salesRequests.itemName",2,"width","20%"],["translate","sales.salesRequests.unit",2,"width","25%"],["translate","sales.salesRequests.quantity",2,"width","25%"],["class","border-top border-top-dashed",4,"ngIf"],[1,"d-flex","justify-content-center","m-0"],["type","submit","type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],["clearable","false","clearOnBackspace","false","bindValue","id","bindLabel","name",2,"width","100%",3,"ngModelChange","name","items","ngModel"],["type","text","id","quantity",1,"form-control","fs-6",3,"ngModelChange","name","ngModel"],[1,"border-top","border-top-dashed"],["colspan","3"],["colspan","4",1,"fw-medium","p-0"],[1,"table","table-borderless","mb-0"],["translate","sales.salesOrder.total",1,"m-0","p-0"],[1,"text-end","m-0","p-0"],["translate","sales.salesOrder.extraDiscount",1,"m-0","p-0"],[1,"input-group","mx-4",2,"width","80%"],["clearable","false","clearOnBackspace","false","name","totalAddDiscountType","bindValue","id","bindLabel","name",3,"change","ngModelChange","items","ngModel"],["InputTirmFilter","","name","totalAddDiscount","type","text","id","totalAddDiscount",1,"form-control","fs-6",2,"width","30%",3,"change","ngModelChange","ngModel"],[1,"m-0","p-0"],["translate","sales.salesOrder.tax",1,"m-0","p-0"],[1,"border-top","border-top-dashed","m-0","p-0"],["scope","row","translate","sales.salesOrder.net",1,"m-0","p-0"]],template:function(i,n){if(1&i){const s=e.RV6();e.j41(0,"div",12)(1,"div",13),e.bIt("click",function(){return e.eBV(s),e.Njj(n.onSelectStatus(30))}),e.j41(2,"div",14)(3,"div",15)(4,"div",16)(5,"div",17),e.nrm(6,"i",18),e.k0s()(),e.j41(7,"div",19)(8,"h5",20),e.EFF(9),e.k0s(),e.nrm(10,"p",21),e.k0s()()()(),e.j41(11,"div",13),e.bIt("click",function(){return e.eBV(s),e.Njj(n.onSelectStatus(32))}),e.j41(12,"div",14)(13,"div",15)(14,"div",16)(15,"div",22),e.nrm(16,"i",18),e.k0s()(),e.j41(17,"div",19)(18,"h5",20),e.EFF(19),e.k0s(),e.nrm(20,"p",23),e.k0s()()()(),e.j41(21,"div",13),e.bIt("click",function(){return e.eBV(s),e.Njj(n.onSelectStatus(100))}),e.j41(22,"div",14)(23,"div",15)(24,"div",16)(25,"div",24),e.nrm(26,"i",18),e.k0s()(),e.j41(27,"div",19)(28,"h5",20),e.EFF(29),e.k0s(),e.nrm(30,"p",25),e.k0s()()()()(),e.j41(31,"div",26)(32,"div",27)(33,"div",28),e.nrm(34,"ngx-ui-loader",29),e.j41(35,"base-filter",30),e.bIt("addNew",function(){return e.eBV(s),e.Njj(n.goNew())})("reset",function(){return e.eBV(s),e.Njj(n.onReset())})("search",function(){return e.eBV(s),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(s),e.Njj(n.onExportXlsx())}),e.qex(36,31),e.j41(37,"div",32)(38,"div",33)(39,"input",34),e.nI1(40,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.id,a)||(n.pagination.id=a),e.Njj(a)}),e.k0s(),e.nrm(41,"i",35),e.k0s()(),e.j41(42,"div",32)(43,"input",36),e.nI1(44,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.searchForm.creationDates,a)||(n.searchForm.creationDates=a),e.Njj(a)}),e.k0s()(),e.j41(45,"div",32)(46,"div",33)(47,"input",37),e.nI1(48,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.clientName,a)||(n.pagination.clientName=a),e.Njj(a)}),e.k0s(),e.nrm(49,"i",35),e.k0s()(),e.j41(50,"div",32)(51,"div",33)(52,"ng-select",38),e.nI1(53,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.salesPersonId,a)||(n.pagination.salesPersonId=a),e.Njj(a)}),e.k0s()()(),e.j41(54,"div",32)(55,"input",36),e.nI1(56,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.searchForm.dates,a)||(n.searchForm.dates=a),e.Njj(a)}),e.k0s()(),e.j41(57,"div",32)(58,"div",33)(59,"ng-select",39),e.nI1(60,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.regionId,a)||(n.pagination.regionId=a),e.Njj(a)}),e.k0s()()(),e.j41(61,"div",32)(62,"div",33)(63,"ng-select",40),e.nI1(64,"translate"),e.mxI("ngModelChange",function(a){return e.eBV(s),e.DH7(n.pagination.cityId,a)||(n.pagination.cityId=a),e.Njj(a)}),e.k0s()()(),e.bVm(),e.k0s(),e.j41(65,"div",41)(66,"div",42)(67,"p-table",43,0),e.bIt("onLazyLoad",function(a){return e.eBV(s),e.Njj(n.tableChange(a))})("selectionChange",function(a){return e.eBV(s),e.Njj(n.onSelectionChange(a))}),e.DNE(69,Hd,29,0,"ng-template",44)(70,nc,32,26,"ng-template",45)(71,rc,12,1,"ng-template",46),e.k0s()(),e.DNE(72,sc,2,0,"div",47)(73,ac,6,8,"div",48),e.k0s()()()(),e.DNE(74,oc,1,0,"ng-template",null,1,e.C5r)(76,lc,1,1,"ng-template",null,2,e.C5r)(78,dc,1,3,"ng-template",null,3,e.C5r)(80,cc,1,3,"ng-template",null,4,e.C5r)(82,mc,1,1,"ng-template",null,5,e.C5r)(84,pc,15,3,"ng-template",null,6,e.C5r)(86,_c,16,6,"ng-template",null,7,e.C5r)(88,uc,1,1,"ng-template",null,8,e.C5r)(90,bc,42,15,"ng-template",null,9,e.C5r)}2&i&&(e.R7$(2),e.AVh("bg-primary-subtle",30==n.pagination.status),e.R7$(7),e.JRh(n.count.storeDeliveryOrder),e.R7$(3),e.AVh("bg-primary-subtle",32==n.pagination.status),e.R7$(7),e.JRh(n.count.repareOrder),e.R7$(3),e.AVh("bg-primary-subtle",100==n.pagination.status),e.R7$(7),e.JRh(n.count.return),e.R7$(5),e.Y8G("loaderId","allLoader"),e.R7$(),e.Y8G("addPermission",e.lJ4(59,Qd))("showAdd",!1)("showExport",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(40,45,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.id),e.R7$(4),e.FS9("placeholder",e.bMT(44,47,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(4),e.FS9("placeholder",e.bMT(48,49,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.clientName),e.R7$(5),e.FS9("placeholder",e.bMT(53,51,"sales.salesOrder.salsePerson")),e.Y8G("items",n.salesPersons)("multiple",!1),e.R50("ngModel",n.pagination.salesPersonId),e.R7$(3),e.FS9("placeholder",e.bMT(56,53,"sales.salesOrder.clientVisitDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.dates),e.R7$(4),e.FS9("placeholder",e.bMT(60,55,"client.client.regionName")),e.Y8G("items",n.regions)("multiple",!1),e.R50("ngModel",n.pagination.regionId),e.R7$(4),e.FS9("placeholder",e.bMT(64,57,"client.client.cityName")),e.Y8G("items",n.cities)("multiple",!1),e.R50("ngModel",n.pagination.cityId),e.R7$(4),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(5),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[m.YU,m.Sq,m.bT,d.qT,d.me,d.Q0,d.BC,d.cb,d.YS,d.vS,d.cV,_.s5,D.kL,A.b,te.w,Q.p,q.g,ue,u.Mm,S.XI,z.Ei,S.Tg,S.FP,C.Cv,E.vr,X.m,U.p,ie.m,_e,fe,m.vh,u.D9]})}}return r})(),canActivate:[ne.g],data:{permission:["salesOrderStore.view"]}},{path:"sales-order",component:Ad,canActivate:[ne.g],data:{permission:["salesOrder.view"]}},{path:"setting",component:hn,canActivate:[ne.g],data:{permission:["salesSetting.view"]}},{path:"new",component:At},{path:"sales-invoices",component:Ka,resolve:{data:Za},canActivate:[ne.g],data:{permission:["salesInvoices.view"]}},{path:"Client-Collections",component:Co,resolve:{data:cl},canActivate:[ne.g],data:{permission:["clientCollection.view"]}},{path:"Requests-Limit",component:Xo,resolve:{data:Dl},canActivate:[ne.g],data:{permission:["requestPersonSales.view"]}},{path:"Prices-List",component:dl,resolve:{data:El},canActivate:[ne.g],data:{permission:["priceList.view"]}},{path:"PriceListItems",component:qe,canActivate:[ne.g],data:{permission:["priceList.view"]}},{path:"PriceListItems/:id",component:qe,canActivate:[ne.g],data:{permission:["priceList.view"]}},{path:"assign-truck-orders",component:Tl,canActivate:[ne.g],data:{permission:["assignTruckOrder.view"]}}];let vc=(()=>{class r{static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275mod=e.$C({type:r})}static{this.\u0275inj=e.G2t({imports:[y.iI.forChild(Sc),y.iI]})}}return r})();var jc=c(71144),Ic=c(81141),yc=c(41198);let kc=(()=>{class r{constructor(){(0,B.eV)($().loadAnimation)}static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275mod=e.$C({type:r})}static{this.\u0275inj=e.G2t({imports:[m.MD,d.YN,_.zH,_.Pv,_.c9,D.ND,oe.r,vc,de.G,u.h,S.bG,Ke.q4,ve.H_,_.c9,C.th,E.MQ,_.n8,jc.j,_._f,ie.S,Pe.U,Ic.tm,yc.TV,d.X1]})}}return r})()}}]);