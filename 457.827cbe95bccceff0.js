"use strict";(self.webpackChunkvelzon=self.webpackChunkvelzon||[]).push([[457],{58457:(Pi,pe,d)=>{d.r(pe),d.d(pe,{SalesModule:()=>Yi});var p=d(60177),c=d(89417),m=d(69005),A=d(91022),Se=d(70255),je=d(63789),Te=d(98982),ke=d.n(Te),Ie=d(53978),h=d(8147),b=d(45286),ye=d(65430),ge=d(41631),f=d(1530),Y=d(72510),v=d(51188),e=d(54438),q=d(21413),u=d(56977),g=d(36158),Fe=d(84412),ae=d(67569),Z=d(45312),oe=d(21626);let D=(()=>{class r extends ae.d{constructor(t){super(t,Z.c.apiUrl+"OfferOrder/"),this.checkValidationSource=new Fe.t(!0),this.checkValidation=this.checkValidationSource.asObservable()}getLookups(){return this.http.get(this.baseUrl+"Lookups")}changStatus(t){return this.http.put(this.baseUrl+"ChangeStatus/",t)}UpdateQuantity(t){return this.http.put(this.baseUrl+"UpdateQuantity",t)}updateTruck(t){return this.http.put(this.baseUrl+"updateTruck",t)}GetTrucks(t){return this.http.post(this.baseUrl+"GetTrucks/",t)}static{this.\u0275fac=function(i){return new(i||r)(e.KVO(oe.Qq))}}static{this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var x=d(3888),G=d(29935),ee=d(38542),xe=d(70152),Re=d(23294),he=d(25558),Me=d(7673),ue=d(75922);function Oe(r,o){if(1&r&&(e.j41(0,"div",5),e.nrm(1,"i",6),e.j41(2,"div"),e.nrm(3,"strong",7),e.EFF(4),e.k0s(),e.j41(5,"div"),e.nrm(6,"strong",8),e.EFF(7),e.k0s(),e.j41(8,"div"),e.nrm(9,"strong",9),e.EFF(10),e.k0s(),e.j41(11,"div"),e.nrm(12,"strong",10),e.EFF(13),e.k0s(),e.j41(14,"div"),e.nrm(15,"strong",11),e.EFF(16),e.k0s(),e.j41(17,"div"),e.nrm(18,"strong",12),e.EFF(19),e.k0s()()),2&r){const t=e.XpG();e.R7$(4),e.SpI(" : ",t.clientInfo.name,""),e.R7$(3),e.SpI(" : ",t.clientInfo.vatNumber,""),e.R7$(3),e.SpI(" : ",t.clientInfo.mobile,""),e.R7$(3),e.SpI(" : ",t.clientInfo.creditLimit,""),e.R7$(3),e.SpI(" : ",t.clientInfo.nationalAddress,""),e.R7$(3),e.SpI(" : ",t.clientInfo.clientGroupName,"")}}let Ne=(()=>{class r{constructor(t,i,n){this.clientService=t,this.offerOrder=i,this.route=n,this.form={},this.keySelected="",this.notifier=new q.B,this.mainDelay=100,this.loaderSearchShap=g.cX,this.loaderOperationShap=g.$$,this.operationLoader=g.ZW,this.isEditForm=!1,this.showEdit=!1,this.clients=[],this.paymentTypes=[],this.isClientFound=!0,this.errorMessage="",this.setFormByOrderCode=new e.bkB,this.calacTotal=new e.bkB,this.isOrderEdit=!0,this.loading=!1,this.searchClient=new q.B,this.clientParam={pageSize:10,pageNumber:1,search:""}}ngOnInit(){this.form.clientId&&(this.getClientSearchDropdwon(this.form.clientId),this.getClientInfo(this.form.clientId)),this.searchClient.pipe((0,xe.B)(300),(0,Re.F)(),(0,he.n)(t=>this.loadClient(t))).subscribe()}loadClient(t){return this.loading=!0,""==t||null==t?(this.loading=!1,(0,Me.of)([])):this.getClientDropdwon(t)}getClientDropdwon(t){return this.clientParam.search=t,this.clientParam.pageNumber=1,this.clientService.GetClientSearch(this.clientParam).pipe((0,he.n)(i=>(this.clients=i.data,this.loading=!1,[])))}getClientSearchDropdwon(t){this.clientParam.search=t,this.clientParam.pageNumber=1,this.clientService.GetClientSearch(this.clientParam).subscribe(i=>{this.clients=i.data})}scrollClient(){this.clientParam.pageNumber=this.clientParam.pageNumber+1,this.clientService.GetClientSearch(this.clientParam).subscribe(t=>{this.clients=[...this.clients,...t.data]})}getClientInfo(t){null!=t&&this.clientService.GetClientInfo(t).subscribe(i=>{this.offerOrder.checkValidationSource.next(!0),this.clientInfo=i.data})}ngOnDestroy(){}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(ue.X),e.rXU(D),e.rXU(v.nX))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-client-info-salse"]],inputs:{form:"form",clients:"clients",isOrderEdit:"isOrderEdit"},outputs:{setFormByOrderCode:"setFormByOrderCode",calacTotal:"calacTotal"},decls:6,vars:8,consts:[[1,"row","mt-4"],[1,"col-12","mb-3"],["for","mobile","translate","",1,"fw-bold","form-label"],["bindLabel","displayName","bindValue","id","required","",3,"scrollToEnd","ngModelChange","virtualScroll","items","typeahead","loading","multiple","ngModel","disabled"],["class","mt-5 alert alert-primary alert-dismissible material-shadow alert-label-icon rounded-label fade show","role","alert",4,"ngIf"],["role","alert",1,"mt-5","alert","alert-primary","alert-dismissible","material-shadow","alert-label-icon","rounded-label","fade","show"],[1,"ri-user-smile-line","label-icon"],["translate","sales.salesOrder.clientName"],["translate","sales.salesOrder.vatNumber"],["translate","sales.salesOrder.mobile"],["translate","sales.salesOrder.creditLimit"],["translate","sales.salesOrder.nationalAddress"],["translate","sales.salesOrder.clientGroupName"]],template:function(i,n){1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"label",2),e.EFF(3,"orderManagement.order.clientSearch"),e.k0s(),e.j41(4,"ng-select",3),e.bIt("scrollToEnd",function(){return n.scrollClient()}),e.mxI("ngModelChange",function(a){return e.DH7(n.form.clientId,a)||(n.form.clientId=a),a}),e.bIt("ngModelChange",function(a){return n.getClientInfo(a)}),e.k0s(),e.DNE(5,Oe,20,6,"div",4),e.k0s()()),2&i&&(e.R7$(4),e.Y8G("virtualScroll",!0)("items",n.clients)("typeahead",n.searchClient)("loading",n.loading)("multiple",!1),e.R50("ngModel",n.form.clientId),e.Y8G("disabled",!n.isOrderEdit),e.R7$(),e.Y8G("ngIf",n.clientInfo))},dependencies:[p.bT,c.BC,c.YS,c.vS,h.Mm,Y.vr],encapsulation:2})}}return r})();var R=d(37021),M=d(35335),O=d(45236),k=d(70980),de=d(99437),ce=d(18810),we=d(25947),Ee=d(33121),P=d(12260),X=d(15084);function Ge(r,o){if(1&r){const t=e.RV6();e.qex(0),e.j41(1,"div",17)(2,"div",18)(3,"input",19),e.bIt("change",function(){const n=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.locationChange(n))}),e.k0s(),e.j41(4,"label",20)(5,"span",21),e.EFF(6),e.k0s(),e.j41(7,"span",22),e.EFF(8),e.k0s()()(),e.j41(9,"div",23)(10,"div")(11,"a",24),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(),a=e.sdS(9);return e.Njj(s.openEditModal(n,a))}),e.nrm(12,"i",25)(13,"span",26),e.k0s()(),e.j41(14,"div")(15,"a",27),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(),a=e.sdS(11);return e.Njj(s.confirm(n.id,a))}),e.nrm(16,"i",28)(17,"span",29),e.k0s()()()(),e.bVm()}if(2&r){const t=o.$implicit;e.R7$(3),e.Mz_("id","S",t.id,""),e.Y8G("checked",t.isSelected),e.R7$(),e.Mz_("for","S",t.id,""),e.R7$(2),e.Lme(" ",t.cityName,"- ",t.name,""),e.R7$(2),e.SpI(" ",t.address,"")}}function De(r,o){1&r&&(e.j41(0,"span",58),e.EFF(1,"general.action.register "),e.k0s())}function Ve(r,o){1&r&&(e.j41(0,"span",58),e.EFF(1,"general.action.edit "),e.k0s())}function Le(r,o){1&r&&(e.j41(0,"div",59),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function $e(r,o){1&r&&(e.j41(0,"div",59),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function Xe(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",30)(1,"div",31)(2,"h4",32),e.DNE(3,De,2,0,"span",33)(4,Ve,2,0,"span",33),e.k0s(),e.j41(5,"button",34),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss("Cross click"))}),e.k0s()(),e.j41(6,"div",35),e.nrm(7,"ngx-ui-loader",36),e.j41(8,"form",37,2),e.bIt("submit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.OnSubmit())}),e.j41(10,"div",38),e.nrm(11,"label",39),e.j41(12,"ng-select",40,3),e.nI1(14,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.formEdit.cityCode,n)||(s.formEdit.cityCode=n),e.Njj(n)}),e.k0s()(),e.j41(15,"div",38),e.nrm(16,"label",41),e.j41(17,"input",42,4),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.formEdit.name,n)||(s.formEdit.name=n),e.Njj(n)}),e.k0s(),e.DNE(19,Le,2,0,"div",43),e.k0s(),e.j41(20,"div",38),e.nrm(21,"label",44),e.j41(22,"textarea",45,5),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.formEdit.address,n)||(s.formEdit.address=n),e.Njj(n)}),e.k0s(),e.DNE(24,$e,2,0,"div",43),e.k0s(),e.j41(25,"div",38),e.nrm(26,"label",46),e.j41(27,"input",47,6),e.bIt("change",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.onUrlChange(n))}),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.formEdit.mapURL,n)||(s.formEdit.mapURL=n),e.Njj(n)}),e.k0s()(),e.j41(29,"div",48)(30,"div",49),e.nrm(31,"label",50),e.j41(32,"input",51,7),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.formEdit.lat,n)||(s.formEdit.lat=n),e.Njj(n)}),e.k0s()(),e.j41(34,"div",49),e.nrm(35,"label",52),e.j41(36,"input",53,8),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.formEdit.lng,n)||(s.formEdit.lng=n),e.Njj(n)}),e.k0s()()(),e.j41(38,"div",54)(39,"button",55),e.nrm(40,"i",56)(41,"span",57),e.k0s()()()()()}if(2&r){const t=e.sdS(9),i=e.sdS(18),n=e.sdS(23),s=e.XpG();e.R7$(3),e.Y8G("ngIf",!s.isEditForm),e.R7$(),e.Y8G("ngIf",s.isEditForm),e.R7$(3),e.Y8G("hasProgressBar",!1)("fgsType",s.loaderOperationShap)("loaderId","locationOperation"),e.R7$(5),e.FS9("placeholder",e.bMT(14,17,"orderManagement.order.cityName")),e.R50("ngModel",s.formEdit.cityCode),e.Y8G("items",s.cities)("multiple",!1),e.R7$(5),e.R50("ngModel",s.formEdit.name),e.R7$(2),e.Y8G("ngIf",i.invalid&&i.touched),e.R7$(3),e.R50("ngModel",s.formEdit.address),e.R7$(2),e.Y8G("ngIf",n.invalid&&n.touched),e.R7$(3),e.R50("ngModel",s.formEdit.mapURL),e.R7$(5),e.R50("ngModel",s.formEdit.lat),e.R7$(4),e.R50("ngModel",s.formEdit.lng),e.R7$(3),e.Y8G("disabled",!t.valid)}}function Be(r,o){if(1&r){const t=e.RV6();e.j41(0,"delete-modal",60),e.bIt("deleteConfirm",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.DeleteConfirm())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}}let Ae=(()=>{class r{constructor(t,i,n,s,a,l,C,j){this.modalService=t,this.baseService=i,this.alertService=n,this.ngxLoader=s,this.whatsupService=a,this.whatsAppMessagesService=l,this.cityService=C,this.offerOrder=j,this.submitted=!1,this.form={},this.mainDelay=20,this.notifier=new q.B,this.operationLoader=g.ZW,this.isEditForm=!1,this.loaderOperationShap=g.$$,this.isLoad=!1,this.formEdit={},this.cities=[],this.idSelected=0,this.isOrderEdit=!0,this.modalRefs={}}ngOnInit(){this.form.clientId&&this.checkLocation(),this.form.clientLocationId&&this.checkSelected(this.form.clientLocationId),this.GetCities()}confirm(t,i){this.idSelected=t,this.modalService.open(i,{centered:!0})}openModal(t){this.ngxLoader.stopLoader(this.operationLoader),this.submitted=!1,this.modalRefs=this.modalService.open(t,{size:"md",centered:!0})}openEditModal(t,i){this.submitted=!1,this.formEdit=t,this.isEditForm=!0,this.modalRefs=this.modalService.open(i,{size:"md",centered:!0})}changeActiveTab(t){this.nav.select(t)}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}registerEntity(t=!1){this.ngxLoader.startLoader("locationOperation");let i=this.mapRegisterForm(this.formEdit);i.isSend=t,this.baseService.AddLocation(i).pipe((0,R.O)(),(0,M.c)(this.mainDelay),(0,O.Z)(),(0,u.Q)(this.notifier),(0,k.j)(()=>this.ngxLoader.stopLoader("locationOperation")),(0,de.W)(n=>(0,ce.$)(n))).subscribe(n=>{n.success?(this.alertService.success(),this.modalRefs.dismiss(),this.refresh()):this.alertService.error("general.message."+n.message)},n=>{this.alertService.error("general.message."+n)})}editEntity(t=!1){this.ngxLoader.startLoader("locationOperation");let i=this.mapForm(this.formEdit);i.isSend=t,this.baseService.EditLocation(i).pipe((0,R.O)(),(0,M.c)(this.mainDelay),(0,O.Z)(),(0,u.Q)(this.notifier),(0,k.j)(()=>this.ngxLoader.stopLoader("locationOperation"))).subscribe(n=>{n.success?(this.alertService.success(),this.modalRefs.dismiss(),this.refresh()):this.alertService.error("general.message."+n.message)},n=>{this.alertService.error("general.message."+n)})}mapForm(t){let i={...t};return i.agentCode=this.form.clientId,i.cityCode=i.cityCode,i.agentName="",i.mobile="",i.mapURL=i.mapURL,i.lat=i.lat?i.lat.toString():"",i.lng=i.lng?i.lng.toString():"",i}mapRegisterForm(t){let i={...t};return i.id=0,i.cityCode=i.cityCode,i.agentName="",i.mobile="",i.agentCode=this.form.clientId,i.mapURL=i.mapURL,i.lat=i.lat,i.lng=i.lng,i}submitFunished(){this.alertService.success(),this.modalService?.dismissAll()}OnSubmit(t=!1){this.ngxLoader.startLoader(this.operationLoader),!0===this.isEditForm?this.editEntity(t):this.registerEntity(t)}getFromClient(){this.form.agent.mobile||this.alertService.error("orderManagement.order.mustEnterNumber"),this.isLoad=!0,this.whatsupService.GetLocationFromClient(this.form.agent.mobile).pipe((0,u.Q)(this.notifier),(0,k.j)(()=>this.isLoad=!1)).subscribe(t=>{t.success?this.alertService.success("orderManagement.order.successSendLocation"):this.alertService.error("orderManagement.order.failSendLocation")},()=>{this.alertService.error("orderManagement.order.failSendLocation")})}DeleteConfirm(){this.baseService.DeleteLocation(this.idSelected).pipe((0,R.O)(),(0,M.c)(this.mainDelay),(0,O.Z)(),(0,u.Q)(this.notifier),(0,k.j)(()=>this.ngxLoader.stopLoader("deleteLoader"))).subscribe(t=>{if(t.success){const i=this.form.locations.findIndex(n=>n.id===this.idSelected);-1!==i&&this.form.locations.splice(i,1),this.alertService.success(),this.modalService.dismissAll()}else this.alertService.error("general.message."+t)},()=>{this.alertService.error()})}refresh(){this.baseService.clientNumber.next(!0)}locationChange(t){this.form.clientLocationId=t.id;let i=this.form.locations.find(n=>n.id==t.id);i.isSelected=!i.isSelected}checkSelected(t){this.offerOrder.checkValidationSource.next(!0),this.form.locations.find(n=>n.id==t).isSelected=!0}checkLocation(){this.offerOrder.checkValidationSource.next(!0),this.baseService.GetClientLocations(this.form.clientId).subscribe(t=>{this.form.locations=t.data})}ngOnDestroy(){this.notifier.next(),this.notifier.complete()}onUrlChange(t){let s=new URL(t.target.value).searchParams.get("q");if(s){let[a,l]=s.split(",").map(Number);this.formEdit.lat=a,this.formEdit.lng=l}}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(m.Bq),e.rXU(ue.X),e.rXU(x.u),e.rXU(f.eD),e.rXU(we.A),e.rXU(Ee.Q),e.rXU(P.h),e.rXU(D))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["client-location-salse"]],viewQuery:function(i,n){if(1&i&&e.GBs(m.X9,5),2&i){let s;e.mGM(s=e.lsd())&&(n.nav=s.first)}},inputs:{form:"form",isOrderEdit:"isOrderEdit"},features:[e.Jv_([m.X9])],decls:12,vars:2,consts:[["content",""],["deleteModal",""],["formEntity","ngForm"],["cityCode","ngModel"],["name","ngModel"],["address","ngModel"],["mapURL","ngModel"],["lat","ngModel"],["lng","ngModel"],[1,"mt-4"],[1,"d-flex","align-items-center","mb-2"],[1,"flex-grow-1"],["translate","orderManagement.order.savedAddress",1,"fs-15","mb-0"],[1,"flex-shrink-0"],["type","button","translate","orderManagement.order.sendToClient",1,"btn","btn-sm","btn-success","mb-1",3,"click","disabled"],[1,"row","gy-3"],[4,"ngFor","ngForOf"],[1,"col-lg-4","col-sm-6"],[1,"form-check","card-radio"],["name","location","type","radio",1,"form-check-input",3,"change","id","checked"],[1,"form-check-label",3,"for"],[1,"mb-4","fw-bold","d-block","text-muted","text-uppercase"],[1,"text-muted","fw-normal","text-wrap","mb-1","d-block"],[1,"d-flex","flex-wrap","p-2","py-1","bg-light","rounded-bottom","border","mt-n1"],["href","javascript:void(0);","data-bs-toggle","modal","data-bs-target","#addAddressModal",1,"d-block","text-body","p-1","px-2",3,"click"],[1,"ri-pencil-fill","text-muted","align-bottom","me-1"],["translate","general.action.edit"],["href","javascript:void(0);","data-bs-toggle","modal","data-bs-target","#removeItemModal",1,"d-block","text-body","p-1","px-2",3,"click"],[1,"ri-delete-bin-fill","text-muted","align-bottom","me-1"],["translate","general.action.delete"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["class","fw-bold fs-4","translate","",4,"ngIf"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"hasProgressBar","fgsType","loaderId"],[3,"submit"],[1,"mb-1"],["for","name","translate","orderManagement.order.cityName",1,"required","fw-bold","form-label"],["name","cityCode","id","cityCode","bindValue","code","bindLabel","name",3,"ngModelChange","ngModel","placeholder","items","multiple"],["for","name","translate","orderManagement.order.name",1,"required","fw-bold","form-label"],["InputTirmFilter","","name","name","type","text","id","name","required","",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["class","text-danger text-center  ","translate","",4,"ngIf"],["for","address","translate","orderManagement.order.address",1,"fw-bold","form-label"],["rows","2","InputTirmFilter","","name","address","type","text","id","address",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["for","mapURL","translate","orderManagement.order.mapURL",1,"fw-bold","form-label"],["InputTirmFilter","","name","mapURL","type","text","id","mapURL",1,"form-control","fs-6",3,"change","ngModelChange","ngModel"],[1,"row","my-2"],[1,"col-12","col-md-6"],["for","lat","translate","orderManagement.order.lat",1,"fw-bold","form-label"],["disabled","","InputTirmFilter","","name","lat","type","text","id","lat",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["for","lng","translate","orderManagement.order.lng",1,"fw-bold","form-label"],["disabled","","InputTirmFilter","","name","lng","type","text","id","lng",1,"form-control","fs-6",3,"ngModelChange","ngModel"],[1,"text-center"],["type","submit","type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],["translate","",1,"fw-bold","fs-4"],["translate","",1,"text-danger","text-center"],[3,"deleteConfirm","dismiss"]],template:function(i,n){if(1&i){const s=e.RV6();e.j41(0,"div",9)(1,"div",10)(2,"div",11),e.nrm(3,"h5",12),e.k0s(),e.j41(4,"div",13)(5,"button",14),e.bIt("click",function(){e.eBV(s);const l=e.sdS(9);return e.Njj(n.openModal(l))}),e.k0s()()(),e.j41(6,"div",15),e.DNE(7,Ge,18,8,"ng-container",16),e.k0s()(),e.DNE(8,Xe,42,19,"ng-template",null,0,e.C5r)(10,Be,1,0,"ng-template",null,1,e.C5r)}2&i&&(e.R7$(5),e.Y8G("disabled",n.isLoad),e.R7$(2),e.Y8G("ngForOf",n.form.locations))},dependencies:[p.Sq,p.bT,c.qT,c.me,c.BC,c.cb,c.YS,c.vS,c.cV,h.Mm,G.m,Y.vr,f.Cv,X.w,h.D9],encapsulation:2})}}return r})();var me=d(33826);let Ye=(()=>{class r{constructor(t,i,n,s,a,l,C,j){this.routerActive=t,this.translateService=i,this.baseService=n,this.alertService=s,this.datePipe=a,this.modalService=l,this.ngxLoader=C,this.router=j,this.editOrders="orderManagement.order.editOrders",this.addOrders="orderManagement.order.addOrders",this.titleOperation="orderManagement.order.titleOperation",this.form={},this.keySelected="",this.assignUsers=[],this.times=[],this.active=0,this.shifts=[],this.searchForm="",this.jobTypes=[],this.weekDays=[],this.breadCrumbItems=[],this.todayDate="",this.idForm=0,this.totalPaid=0,this.priceModel=0,this.priceModelIndex=0,this.subtotal=0,this.total=0,this.isResolveList=!0,this.extraDiscountCalc=!1,this.employeeGroups=[],this.notifier=new q.B,this.mainDelay=100,this.loaderSearchShap=g.cX,this.loaderOperationShap=g.$$,this.operationLoader=g.ZW,this.isEditForm=!1,this.showEdit=!1,this.channels=[],this.districts=[],this.cities=[],this.orderTypes=[],this.serviceCategories=[],this.services=[],this.paymentTypes=[],this.fileName="",this.base64String=null,this.orderCode=[],this.newOrder=new e.bkB,this.editOrderActiveTab=new e.bkB;const T=new Date;this.todayDate=`${T.getFullYear()}-${(T.getMonth()+1).toString().padStart(2,"0")}-${T.getDate().toString().padStart(2,"0")}`,console.log(this.todayDate)}nextDate(){let t=this.todayDate.split("-");this.todayDate=`${t[0]}-${t[1]}-${+t[2]+1}`,console.log(this.todayDate)}OpenChangInput(t,i){this.showEdit=!0,console.log(i),this.priceModel=i.price,this.priceModelIndex=t}ChangInput(){this.form.tbOrderServices[`${this.priceModelIndex}`].price=this.priceModel,this.showEdit=!1}previousDate(){let t=this.todayDate.split("-");this.todayDate=`${t[0]}-${t[1]}-${+t[2]-1}`,console.log(this.todayDate)}ngOnDestroy(){this.notifier.next(),this.notifier.complete()}ngOnInit(){this.configRoute(),this.breadCrumbItems=[{label:"layout.sidebar.orders"},{label:"orderManagement.order.title",active:!0,url:"order/list"},{label:this.isEditForm?"general.action.edit":"general.action.register",active:!0}],this.GetOrderLookUp()}onFileSelected(t){const i=t.target;if(i.files&&i.files.length>0){const n=i.files[0];this.fileName=n.name,console.log(n);const s=new FileReader;s.onload=()=>{this.base64String=s.result,console.log("Base64 String:",this.base64String)},s.onerror=a=>{console.error("Error reading file:",a)},s.readAsDataURL(n)}}addService(){let t=this.form.formServices,i=this.services.filter(s=>s.serviceCode==t.serviceCode)[0];this.form.tbOrderServices.push({service:i.name,serviceCode:i.code,price:t.price,notes:t.notes});let n=0;this.form.tbOrderServices.forEach(s=>{n+=+s.price}),this.subtotal=n,console.log(this.subtotal),this.checkTotal(),this.resetServiceForm()}addPayment(){let t=this.form.formPayment,i=this.paymentTypes.filter(s=>s.id==t.paymentTypeCode)[0];this.form.orderPayments.push({paymentType:i.name,paymentTypeCode:t.paymentTypeCode,value:t.value,fileName:this.fileName});let n=0;this.form.orderPayments.forEach(s=>{n+=+s.value}),this.totalPaid=n,this.resetPaymentForm()}checkTotal(){this.total=this.subtotal-+this.form.DiscountAmount}deleteService(t){this.form.tbOrderServices.splice(t,1)}deletePayment(t){this.form.orderPayments.splice(t,1)}resetServiceForm(){let t=this.form.formServices;t.serviceCode=void 0,t.price=null,t.notes=null}resetPaymentForm(){let t=this.form.formPayment;t.paymentTypeCode=null,t.value=null,t.attachRecietPath=null,t.fileName=null}configRoute(){this.routerActive.data.pipe((0,u.Q)(this.notifier)).subscribe(t=>{let i=t.data.data;i&&(this.isEditForm=!0,this.form=i,"Proposed"==i.leadsTypes?this.form.leadsTypes=1:"Inquiry"==i.leadsTypes&&(this.form.leadsTypes=2))},()=>{this.alertService.error()})}GetOrderLookUp(){this.baseService.GetOrderLookUp().subscribe(t=>{this.channels=t.data.channels,this.cities=t.data.cityNames,this.orderTypes=t.data.orderStatus,this.serviceCategories=t.data.serviceCategories,this.paymentTypes=t.data.paymentTypes},t=>{console.log(t)})}getDistricts(t){this.ngxLoader.startLoader(g.ZW),this.baseService.districtsByCity(t).subscribe(i=>{this.districts=i.data,this.ngxLoader.stopLoader(g.ZW)},i=>{console.log(i)})}getServicesByCategory(t){console.log(t),this.ngxLoader.startLoader(g.ZW),this.baseService.getServicesByCategory(t).subscribe(i=>{this.ngxLoader.stopLoader(g.ZW),this.services=i.data},i=>{console.log(i)})}OnSubmit(){this.ngxLoader.startLoader(this.operationLoader),!0===this.isEditForm?this.editEntity():this.registerEntity()}mapRegisterForm(t){let i={...t};return i.id=0,i}registerEntity(){this.ngxLoader.startLoader(g.ZW);let t=this.mapRegisterForm(this.form);this.baseService.registerNewOrder(t).pipe((0,R.O)(),(0,M.c)(this.mainDelay),(0,O.Z)(),(0,u.Q)(this.notifier),(0,k.j)(()=>this.ngxLoader.stopLoader(g.ZW)),(0,de.W)(i=>(0,ce.$)(i))).subscribe(i=>{i.success?(this.alertService.success(),this.router.navigateByUrl("/order/list")):this.alertService.error("general.message."+i.message)},i=>{this.alertService.error("general.message."+i)})}editEntity(){this.baseService.editPut(this.form.id,this.form).pipe((0,R.O)(),(0,M.c)(this.mainDelay),(0,O.Z)(),(0,u.Q)(this.notifier),(0,k.j)(()=>this.ngxLoader.stopLoader(g.ZW))).subscribe(t=>{t.success?this.alertService.success():this.alertService.error("general.message."+t.message)},t=>{this.alertService.error("general.message."+t)})}getTranslationText(t){let i="";return this.translateService.get(t).pipe((0,u.Q)(this.notifier)).subscribe(n=>{i=n}),i}onTimeSelected(t){this.form.orderTeams=t}newOrderAgain(){this.newOrder.next(!0)}editOrder(t){this.baseService.orderEditSubject.next(t),this.editOrderActiveTab.next(!0)}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(v.nX),e.rXU(h.c$),e.rXU(me.Q),e.rXU(x.u),e.rXU(p.vh),e.rXU(m.Bq),e.rXU(f.eD),e.rXU(v.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-finish-order-salse"]],inputs:{form:"form",orderCode:"orderCode"},outputs:{newOrder:"newOrder",editOrderActiveTab:"editOrderActiveTab"},decls:12,vars:1,consts:[[1,"text-center","py-5"],[1,"mb-4"],["src","https://cdn.lordicon.com/lupuorrc.json","trigger","loop","colors","primary:#0ab39c,secondary:#405189",2,"width","120px","height","120px"],["translate","orderManagement.order.orderSaveSuccess"],[1,"fw-semibold",3,"click"],["translate","orderManagement.order.orderCode"],["routerLink","/ecommerce/order-details",1,"text-decoration-underline"],[1,"d-flex","align-items-start","gap-3","mt-4"],["type","button","data-nexttab","pills-finish-tab",1,"btn","btn-primary","btn-label","right","ms-auto","nexttab",3,"click"],[1,"ri-chat-new-line","label-icon","align-middle","fs-16","ms-2"],["translate","orderManagement.order.newOrderAgain"]],template:function(i,n){1&i&&(e.j41(0,"div",0)(1,"div",1),e.nrm(2,"lord-icon",2),e.k0s(),e.nrm(3,"h5",3),e.j41(4,"h3",4),e.bIt("click",function(){return n.editOrder(n.orderCode)}),e.nrm(5,"span",5),e.j41(6,"a",6),e.EFF(7),e.k0s()()(),e.j41(8,"div",7)(9,"button",8),e.bIt("click",function(){return n.newOrderAgain()}),e.nrm(10,"i",9)(11,"span",10),e.k0s()()),2&i&&(e.R7$(7),e.SpI("#SO#",n.orderCode,""))},dependencies:[h.Mm,v.Wk],encapsulation:2})}}return r})();var Pe=d(34618),ze=d(96402),Qe=d(84205);const B=r=>[r];function Je(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",7)(1,"div",9),e.nrm(2,"div",10)(3,"div",11)(4,"div",12)(5,"div",13)(6,"div",14)(7,"div",15),e.k0s(),e.j41(8,"div",16)(9,"div",17)(10,"ng-select",18),e.bIt("change",function(n){const s=e.eBV(t).$index,a=e.XpG();return e.Njj(a.itemSelected(n,s))}),e.mxI("ngModelChange",function(n){const s=e.eBV(t).$index,a=e.XpG();return e.DH7(a.items[s].itemId,n)||(a.items[s].itemId=n),e.Njj(n)}),e.k0s()(),e.j41(11,"div",19)(12,"ng-select",18),e.bIt("change",function(n){const s=e.eBV(t).$index,a=e.XpG();return e.Njj(a.unitSelect(n,s))}),e.mxI("ngModelChange",function(n){const s=e.eBV(t).$index,a=e.XpG();return e.DH7(a.items[s].unitId,n)||(a.items[s].unitId=n),e.Njj(n)}),e.k0s()(),e.j41(13,"div",20)(14,"input",21),e.mxI("ngModelChange",function(n){const s=e.eBV(t).$index,a=e.XpG();return e.DH7(a.items[s].quantity,n)||(a.items[s].quantity=n),e.Njj(n)}),e.bIt("ngModelChange",function(n){const s=e.eBV(t).$index,a=e.XpG();return e.Njj(a.quantitySelect(n,s))}),e.k0s()(),e.j41(15,"div",20)(16,"div",22)(17,"span"),e.EFF(18),e.k0s()()(),e.j41(19,"div",19)(20,"ng-select",23),e.bIt("ngModelChange",function(n){const s=e.eBV(t).$index,a=e.XpG();return e.Njj(a.discountSelect(n,s,2))}),e.mxI("ngModelChange",function(n){const s=e.eBV(t).$index,a=e.XpG();return e.DH7(a.items[s].discountType,n)||(a.items[s].discountType=n),e.Njj(n)}),e.k0s()(),e.j41(21,"div",19)(22,"input",24),e.bIt("ngModelChange",function(n){const s=e.eBV(t).$index,a=e.XpG();return e.Njj(a.discountSelect(n,s))}),e.mxI("ngModelChange",function(n){const s=e.eBV(t).$index,a=e.XpG();return e.DH7(a.items[s].discount,n)||(a.items[s].discount=n),e.Njj(n)}),e.k0s()()(),e.j41(23,"div",25)(24,"div",26)(25,"div",27)(26,"div",28)(27,"div",22)(28,"span",29),e.bIt("click",function(){const n=e.eBV(t).$index,s=e.XpG();return e.Njj(s.deleteRow(n))}),e.nrm(29,"i",30),e.k0s()()()(),e.j41(30,"div",31)(31,"div",32),e.nrm(32,"div",33),e.j41(33,"h5",34)(34,"span",35),e.EFF(35),e.k0s(),e.j41(36,"span"),e.EFF(37),e.nI1(38,"translate"),e.k0s()()()()()()()}if(2&r){const t=o.$index,i=e.XpG();e.R7$(10),e.Y8G("name","itemId"+t)("items",i.products),e.R50("ngModel",i.items[t].itemId),e.R7$(2),e.Y8G("name","unitId"+e.eq3(18,B,t))("items",i.items[t].units),e.R50("ngModel",i.items[t].unitId),e.R7$(2),e.Y8G("name","quantity"+e.eq3(20,B,t)),e.R50("ngModel",i.items[t].quantity),e.R7$(4),e.SpI(" ",i.items[t].price||0," "),e.R7$(2),e.Y8G("name","discountType"+e.eq3(22,B,t))("items",i.discountTypes),e.R50("ngModel",i.items[t].discountType),e.R7$(2),e.Y8G("name","discount"+e.eq3(24,B,t)),e.R50("ngModel",i.items[t].discount),e.R7$(13),e.JRh(i.items[t].net||0),e.R7$(2),e.JRh(e.bMT(38,16,"orderManagement.order.currancy"))}}function He(r,o){if(1&r){const t=e.RV6();e.j41(0,"tr")(1,"td",45),e.EFF(2),e.k0s(),e.j41(3,"td")(4,"ng-select",46),e.bIt("change",function(n){const s=e.eBV(t).index,a=e.XpG(2);return e.Njj(a.itemSelected(n,s))}),e.mxI("ngModelChange",function(n){const s=e.eBV(t).index,a=e.XpG(2);return e.DH7(a.items[s].itemId,n)||(a.items[s].itemId=n),e.Njj(n)}),e.k0s()(),e.j41(5,"td")(6,"ng-select",47),e.bIt("change",function(n){const s=e.eBV(t).index,a=e.XpG(2);return e.Njj(a.unitSelect(n,s))}),e.mxI("ngModelChange",function(n){const s=e.eBV(t).index,a=e.XpG(2);return e.DH7(a.items[s].unitId,n)||(a.items[s].unitId=n),e.Njj(n)}),e.k0s()(),e.j41(7,"td")(8,"input",21),e.mxI("ngModelChange",function(n){const s=e.eBV(t).index,a=e.XpG(2);return e.DH7(a.items[s].quantity,n)||(a.items[s].quantity=n),e.Njj(n)}),e.bIt("ngModelChange",function(n){const s=e.eBV(t).index,a=e.XpG(2);return e.Njj(a.quantitySelect(n,s))}),e.k0s()(),e.j41(9,"td")(10,"div",22)(11,"span"),e.EFF(12),e.k0s()()(),e.j41(13,"td")(14,"ng-select",48),e.bIt("ngModelChange",function(n){const s=e.eBV(t).index,a=e.XpG(2);return e.Njj(a.discountSelect(n,s,2))}),e.mxI("ngModelChange",function(n){const s=e.eBV(t).index,a=e.XpG(2);return e.DH7(a.items[s].discountType,n)||(a.items[s].discountType=n),e.Njj(n)}),e.k0s()(),e.j41(15,"td")(16,"input",24),e.bIt("ngModelChange",function(n){const s=e.eBV(t).index,a=e.XpG(2);return e.Njj(a.discountSelect(n,s))}),e.mxI("ngModelChange",function(n){const s=e.eBV(t).index,a=e.XpG(2);return e.DH7(a.items[s].discount,n)||(a.items[s].discount=n),e.Njj(n)}),e.k0s()(),e.j41(17,"td")(18,"div",22)(19,"span"),e.EFF(20),e.k0s()()(),e.j41(21,"td")(22,"div",22)(23,"span",29),e.bIt("click",function(){const n=e.eBV(t).index,s=e.XpG(2);return e.Njj(s.deleteRow(n))}),e.nrm(24,"i",30),e.k0s()()()()}if(2&r){const t=o.index,i=e.XpG(2);e.R7$(2),e.SpI(" ","#"+(t+1)," "),e.R7$(2),e.Y8G("name","itemId"+t)("items",i.products),e.R50("ngModel",i.items[t].itemId),e.R7$(2),e.Y8G("name","unitId"+e.eq3(16,B,t))("items",i.items[t].units),e.R50("ngModel",i.items[t].unitId),e.R7$(2),e.Y8G("name","quantity"+e.eq3(18,B,t)),e.R50("ngModel",i.items[t].quantity),e.R7$(4),e.SpI(" ",i.items[t].price||0," "),e.R7$(2),e.Y8G("name","discountType"+e.eq3(20,B,t))("items",i.discountTypes),e.R50("ngModel",i.items[t].discountType),e.R7$(2),e.Y8G("name","discount"+e.eq3(22,B,t)),e.R50("ngModel",i.items[t].discount),e.R7$(4),e.SpI(" ",i.items[t].net||0," ")}}function qe(r,o){if(1&r&&(e.j41(0,"div",36)(1,"table",37)(2,"thead")(3,"tr")(4,"th",38),e.EFF(5,"#"),e.k0s(),e.j41(6,"th",39),e.EFF(7,"sales.salesRequests.itemName"),e.k0s(),e.j41(8,"th",40),e.EFF(9,"sales.salesRequests.unit"),e.k0s(),e.j41(10,"th",41),e.EFF(11,"sales.salesRequests.quantity"),e.k0s(),e.j41(12,"th",41),e.EFF(13,"sales.salesRequests.priceUnit"),e.k0s(),e.j41(14,"th",42),e.EFF(15,"sales.salesRequests.discountType"),e.k0s(),e.j41(16,"th",41),e.EFF(17,"sales.salesRequests.discount"),e.k0s(),e.j41(18,"th",41),e.EFF(19,"sales.salesRequests.net"),e.k0s(),e.nrm(20,"th",43),e.k0s()(),e.j41(21,"tbody"),e.DNE(22,He,25,24,"tr",44),e.k0s()()()),2&r){const t=e.XpG();e.R7$(22),e.Y8G("ngForOf",t.form.items)}}let Ze=(()=>{class r{handleClick(t){this.confirmForm()}constructor(t,i,n,s,a,l,C,j,T){this.routerActive=t,this.translateService=i,this.baseService=n,this.alertService=s,this.ngxLoader=a,this.storeUnitsService=l,this.serviceService=C,this.clientGroupsService=j,this.offerOrder=T,this.form={},this.selectedServices=[],this.notifier=new q.B,this.mainDelay=100,this.lang=this.translateService.currentLang,this.loaderSearchShap=g.cX,this.loaderOperationShap=g.$$,this.operationLoader=g.ZW,this.isEditForm=!1,this.showEdit=!1,this.serviceCategories=[],this.statusEnum=[{nameAr:"\u0645\u0639\u0644\u0642",nameEn:"Pending",id:1},{nameAr:"\u0641\u064a \u062a\u064e\u0642\u064e\u062f\u0645",nameEn:"inProgress",id:1},{nameAr:"\u0645\u0646\u062a\u0647\u064a",nameEn:"finished",id:1}],this.clientGroups=[],this.clients=[],this.clientLocation=[],this.items=[],this.itemGroups=[],this.products=[],this.units=[],this.services=[],this.currentLang=this.translateService.currentLang,this.subtotal=0,this.total=0,this.serverImage=Z.c.mediaUrl,this.filteredServices=[],this.seviceCount=0,this.serviceSelected=[],this.CalcTotal=new e.bkB,this.isOrderEdit=!0,this.discountTypes=[{id:1,name:"Cost"},{id:2,name:"Precentage"}],this.getUnits(),this.getProducts(),this.discountTypes.forEach(S=>{S.name=this.getTranslationText("sales.salesOrder."+S.name)})}addRow(){this.form.items.push({itemGroup:null,itemName:"",itemId:0,unit:null,quantity:1,priceUnit:null,discount:0,discountType:1,net:0}),this.offerOrder.checkValidationSource.next(!0)}deleteRow(t){this.items.splice(t,1),this.checkTotal(),this.offerOrder.checkValidationSource.next(!0)}confirmForm(){this.form.items=this.items}calculate(t){let i=0,n=0;i=this.products.filter(s=>s.id===this.items[t].itemId)[0].price,this.items[t].priceUnit=i,n=i*this.items[t].quantity,this.items[t].net=n,this.confirmForm()}ngOnDestroy(){this.notifier.next(),this.notifier.complete()}getUnits(){this.storeUnitsService.getDropDown().subscribe(t=>{this.units=t.data,console.log(t)})}getProducts(){this.serviceService.getItemDropDown().subscribe(t=>{this.products=t.data,console.log(t)})}getClientGroups(){this.clientGroupsService.getDropDown().subscribe(t=>{this.products=t.data,console.log(t)})}ngOnInit(){}updatePrice(t){const i=this.form.orderServices.find(n=>n.serviceCode===t.code);i.quantity=t.quantity,i.price=t.price}checkTotal(){this.CalcTotal.next(!0)}deleteService(t){this.form.orderServices.splice(t,1)}deletePayment(t){this.form.orderPayments.splice(t,1)}resetServiceForm(){let t=this.form.formServices;t.serviceCode=void 0,t.price=null,t.notes=null}resetPaymentForm(){let t=this.form.formPayment;t.paymentTypeCode=null,t.value=null,t.attachRecietPath=null,t.fileName=null}configRoute(){this.routerActive.data.pipe((0,u.Q)(this.notifier)).subscribe(t=>{let i=t.data.data;i&&(this.isEditForm=!0,this.form=i,"Proposed"==i.leadsTypes?this.form.leadsTypes=1:"Inquiry"==i.leadsTypes&&(this.form.leadsTypes=2))},()=>{this.alertService.error()})}getServicesByCategory(){let t=this.form.serviceCategoryCode;return t.length<=0?(this.services=[],this.filteredServices=[],0):(this.ngxLoader.startLoader("order"),this.baseService.getServicesByCategory(t).subscribe(i=>{this.ngxLoader.stopLoader("order"),this.services=i.data,this.filteredServices=this.services,this.checkSelected()},i=>{this.ngxLoader.stopLoader("order"),console.log(i)}),1)}checkSelected(){this.form.orderServices.forEach(t=>{let i=this.filteredServices.find(n=>n.code===t.serviceCode);i&&(i.isSelected=!0)})}getTranslationText(t){let i="";return this.translateService.get(t).pipe((0,u.Q)(this.notifier)).subscribe(n=>{i=n}),i}onTimeSelected(t){this.form.orderTeams=t,console.log(t)}chooseCategory(t){if(!this.isOrderEdit)return;let i=this.serviceCategories.find(n=>n.id===t.id);if(i.isSelected=!i.isSelected,i.isSelected)this.form.serviceCategoryCode.push(t.id);else{let n=this.serviceCategories.findIndex(s=>s.id===t.id);-1!==n&&this.form.serviceCategoryCode.splice(n,1)}this.getServicesByCategory()}btnMinus(t,i){i.stopPropagation();const n=this.filteredServices.find(s=>s.code===t);n&&n.quantity>1?n.quantity-=1:n.quantity=1,this.updatePrice(n),this.checkTotal()}searchChange(t){const i=t.target.value.toLowerCase();this.filteredServices=""===i?[...this.services]:this.services.filter(n=>n.name.toLowerCase().includes(i))}itemSelected(t,i){t&&(this.items[i].unitId=t.units.length>0?t.units[0].id:null,this.items[i].units=t.units,this.items[i].price=t.price,this.items[i].itemName=t.name,this.quantitySelect(this.items[i].quantity,i),this.checkTotal(),this.offerOrder.checkValidationSource.next(!0))}unitSelect(t,i){}quantitySelect(t,i){t&&(t<=0&&(t=1),this.items[i].quantity=parseInt(t),this.items[i].net=this.items[i].price*this.items[i].quantity,this.discountSelect(this.items[i].discount,i))}discountSelect(t,i,n=1){if(t){(t=parseInt(t))<=0&&(this.items[i].discount=0),1==n&&(this.items[i].discount=t);let s=0;1==this.items[i].discountType?s=this.items[i].discount:(s=this.items[i].price*this.items[i].quantity*this.items[i].discount/100,s=+s.toFixed(2)),this.items[i].net=this.items[i].price*this.items[i].quantity-s,this.items[i].net=this.items[i].net.toFixed(2),this.checkTotal()}}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(v.nX),e.rXU(h.c$),e.rXU(me.Q),e.rXU(x.u),e.rXU(f.eD),e.rXU(Pe.S),e.rXU(ze.N),e.rXU(Qe.t),e.rXU(D))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-order-services-sale"]],hostBindings:function(i,n){1&i&&e.bIt("click",function(a){return n.handleClick(a)},!1,e.EBC)},inputs:{form:"form",serviceCategories:"serviceCategories",isOrderEdit:"isOrderEdit"},outputs:{CalcTotal:"CalcTotal"},decls:12,vars:4,consts:[[1,"service-container"],[1,"mt-2"],[1,"mt-3"],[1,"my-2","d-flex","justify-content-start","align-items-center"],[1,"mb-0","me-3"],[1,"cursor-pointer","p-2","mb-0","badge","bg-success-subtle","text-success",3,"click"],[1,"ri-add-fill"],[1,"card","card-item","p-1",2,"overflow","visible"],["class"," ","style","overflow-y: visible;overflow-x: hidden;",4,"ngIf"],[1,"card-header","row","my-3","p-0"],["translate","sales.salesRequests.itemName",1,"col-12","col-md-4","text-center"],["translate","sales.salesRequests.unit",1,"col-12","col-md-2","text-center"],["translate","sales.salesRequests.quantity",1,"col-12","col-md-1","text-center"],["translate","sales.salesRequests.priceUnit",1,"col-12","col-md-1","text-center"],["translate","sales.salesRequests.discountType",1,"col-12","col-md-2","text-center"],["translate","sales.salesRequests.discount",1,"col-12","col-md-2","text-center"],[1,"card-body","row","p-1"],[1,"col-12","col-md-4"],["bindValue","id","bindLabel","name",2,"width","100%",3,"change","ngModelChange","name","items","ngModel"],[1,"col-12","col-md-2"],[1,"col-12","col-md-1"],["InputTirmFilter","","type","text","id","quantity",1,"form-control","fs-6",3,"ngModelChange","name","ngModel"],[1,"h-100","d-flex","align-items-center"],["bindValue","id","bindLabel","name",2,"width","100%",3,"ngModelChange","name","items","ngModel"],["InputTirmFilter","","type","text","id","discount",1,"form-control","fs-6",3,"ngModelChange","name","ngModel"],[1,"card-footer","p-2"],[1,"row","align-items-center","gy-3"],[1,"col-sm"],[1,"d-flex","flex-wrap","my-n1"],[1,"cursor-pointer","mb-0","p-2","badge","bg-danger-subtle","text-danger",3,"click"],[1,"ri-delete-bin-2-fill"],[1,"col-sm-auto"],[1,"d-flex","align-items-center","gap-2","text-muted"],["translate","sales.salesRequests.net"],[1,"mb-0","text-danger","fs-6"],[1,"product-line-price"],[1,"",2,"overflow-y","visible","overflow-x","hidden"],[1,"table"],["translate","",2,"width",".5%"],["translate","",2,"width","10%"],["translate","",2,"width","4%"],["translate","",2,"width","5%"],["translate","",2,"width","8%"],[2,"width","2%"],[4,"ngFor","ngForOf"],[2,"width",".1rem"],["bindValue","id","bindLabel","name",2,"width","12rem",3,"change","ngModelChange","name","items","ngModel"],["bindValue","id","bindLabel","name",2,"width","5rem",3,"change","ngModelChange","name","items","ngModel"],["bindValue","id","bindLabel","name",2,"width","5rem",3,"ngModelChange","name","items","ngModel"]],template:function(i,n){1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h4",4),e.EFF(5),e.nI1(6,"translate"),e.k0s(),e.j41(7,"span",5),e.bIt("click",function(){return n.addRow()}),e.nrm(8,"i",6),e.k0s()(),e.Z7z(9,Je,39,26,"div",7,e.Vm6),e.DNE(11,qe,23,1,"div",8),e.k0s()()()),2&i&&(e.R7$(5),e.JRh(e.bMT(6,2,"sales.salesRequests.items")),e.R7$(4),e.Dyx(n.form.items),e.R7$(2),e.Y8G("ngIf",!1))},dependencies:[p.Sq,p.bT,c.me,c.BC,c.vS,h.Mm,G.m,Y.vr,h.D9],encapsulation:2})}}return r})();const We=(r,o)=>({"border-right: solid #E5E5E6 2px":r,"border-left: solid #E5E5E6 2px":o}),Ke=r=>({"border-bottom:1px solid #E5E5E6;":r});function et(r,o){if(1&r){const t=e.RV6();e.j41(0,"app-client-info-salse",55),e.bIt("calacTotal",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.checkTotal())})("setFormByOrderCode",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.setFormByOrderCode(n))}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("isOrderEdit",t.isOrderEdit)("isInner",t.isInner)("form",t.form)}}function tt(r,o){if(1&r&&e.nrm(0,"client-location-salse",56),2&r){const t=e.XpG();e.Y8G("isOrderEdit",t.isOrderEdit)("form",t.form)}}function nt(r,o){if(1&r){const t=e.RV6();e.j41(0,"app-order-services-sale",57),e.bIt("CalcTotal",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.checkTotal())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("isOrderEdit",t.isOrderEdit)("serviceCategories",t.serviceCategories)("form",t.form)}}function it(r,o){if(1&r){const t=e.RV6();e.j41(0,"app-finish-order-salse",58),e.bIt("editOrderActiveTab",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.editOrder())})("newOrder",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.newOrder())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderCode",t.orderCode)("form",t.form)}}function rt(r,o){if(1&r){const t=e.RV6();e.qex(0),e.j41(1,"tr",61)(2,"td",62)(3,"div",63)(4,"div",64)(5,"span",65),e.EFF(6),e.k0s(),e.j41(7,"span")(8,"small",66),e.EFF(9),e.k0s(),e.j41(10,"small",67),e.EFF(11),e.nI1(12,"translate"),e.k0s()()(),e.j41(13,"div",68)(14,"div",69)(15,"button",70),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.decrement(n))}),e.EFF(16,"\u2013 "),e.k0s(),e.j41(17,"input",71),e.bIt("change",function(n){const s=e.eBV(t).$implicit,a=e.XpG(2);return e.Njj(a.quantityChange(n,s))}),e.k0s(),e.j41(18,"button",72),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.increment(n))}),e.EFF(19,"+ "),e.k0s()()(),e.j41(20,"div",73),e.EFF(21),e.nI1(22,"translate"),e.j41(23,"i",74),e.bIt("click",function(){const n=e.eBV(t).index,s=e.XpG(2);return s.removeService(n),e.Njj(s.checkTotal())}),e.k0s()()()()(),e.bVm()}if(2&r){const t=o.$implicit,i=o.index,n=e.XpG(2);e.R7$(),e.Y8G("ngStyle",e.eq3(14,Ke,i===n.form.items.length-1)),e.R7$(5),e.JRh(i+1),e.R7$(3),e.SpI(" ",t.itemName," "),e.R7$(2),e.Lme(" ",t.price," ",e.bMT(12,10,"orderManagement.order.currancy")," "),e.R7$(6),e.Mz_("id","cart-",t.code,""),e.FS9("value",t.quantity),e.R7$(4),e.Lme(" ",t.price*t.quantity-t.discount," ",e.bMT(22,12,"orderManagement.order.currancy")," ")}}function st(r,o){if(1&r&&(e.qex(0),e.j41(1,"h5",59),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.DNE(4,rt,24,16,"ng-container",60),e.bVm()),2&r){const t=e.XpG();e.R7$(2),e.SpI(" ",e.bMT(3,2,"orderManagement.order.clientServices")," "),e.R7$(2),e.Y8G("ngForOf",t.form.items)}}function at(r,o){1&r&&(e.j41(0,"tr")(1,"td",75),e.EFF(2),e.nI1(3,"translate"),e.k0s()()),2&r&&(e.R7$(2),e.SpI(" ",e.bMT(3,1,"orderManagement.order.noServices")," "))}function ot(r,o){1&r&&(e.j41(0,"tr")(1,"td",76),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.j41(4,"td",52),e.EFF(5," 0 "),e.k0s()()),2&r&&(e.R7$(2),e.SpI(" ",e.bMT(3,1,"orderManagement.order.ServicePrice")," "))}let lt=(()=>{class r{constructor(t,i,n,s){this.translateService=t,this.baseService=i,this.alertService=n,this.ngxLoader=s,this.editOrders="orderManagement.order.editOrders",this.addOrders="orderManagement.order.addOrders",this.titleOperation="orderManagement.order.titleOperation",this.keySelected="",this.active=1,this.language=this.translateService.currentLang,this.searchForm="",this.breadCrumbItems=[],this.disabledStatus=!0,this.form={id:null,cityCode:0,clientLocationId:0,clientId:0,isUrgent:!1,notes:"",items:[],discountAmount:0,discountAmountAdd:0,total:0,agent:{},orderPayments:[],orderLocations:{},discountType:1,discountTypeAdd:1,isPrecentage:!1,isPrecentageAdd:!1,totalAddDiscountType:0,totalAddDiscount:0},this.orderCode=0,this.mobile=0,this.cityCode=0,this.agentName="",this.pendingCode=0,this.isInner=!1,this.isOrderEdit=!0,this.idForm=0,this.totalPaid=0,this.priceModel=0,this.priceModelIndex=0,this.subtotal=0,this.paidTotal=0,this.VATTotal=0,this.beforeVatTotal=0,this.total=0,this.isResolveList=!0,this.extraDiscountCalc=!1,this.employeeGroups=[],this.notifier=new q.B,this.mainDelay=100,this.loaderSearchShap=g.cX,this.loaderOperationShap=g.$$,this.operationLoader=g.ZW,this.isEditForm=!1,this.showEdit=!1,this.orderTypes=[],this.serviceCategories=[],this.services=[],this.paymentTypes=[],this.isFinished=!1,this.isUpdate=!1,this.isReopen=!1}OpenChangInput(t,i){this.showEdit=!0,this.priceModel=i.price,this.priceModelIndex=t}ChangInput(){this.form.orderServices[`${this.priceModelIndex}`].price=this.priceModel,this.showEdit=!1}ngOnDestroy(){this.notifier.next(),this.notifier.complete()}ngOnInit(){localStorage.getItem("isReopen")&&(this.isReopen=!0),this.resetForm(),this.breadCrumbItems=[{label:"layout.sidebar.orders"},{label:"orderManagement.order.title",active:!0,url:"order/list"},{label:this.isEditForm?"general.action.edit":"general.action.register",active:!0}],this.GetOrderLookUp(),this.checkTotal(),this.baseService.checkValidation.subscribe(i=>{this.checkdisableForm()})}GetOrderLookUp(){}getTranslationText(t){let i="";return this.translateService.get(t).pipe((0,u.Q)(this.notifier)).subscribe(n=>{i=n}),i}checkTotal(){this.subtotal=this.form.items.reduce((i,n)=>i+(n.price*n.quantity-n.discount||0),0),this.form.discountAmount<0&&(this.form.discountAmount=0),this.form.discountAmountAdd<0&&(this.form.discountAmountAdd=0);let t=0;this.form.isPrecentage?(this.form.discountAmount=this.form.discountAmount>100?100:this.form.discountAmount,t=this.subtotal-this.subtotal*(+this.form.discountAmount||0)*.01):t=this.subtotal-(+this.form.discountAmount||0),this.form.isPrecentageAdd?(this.form.discountAmountAdd=this.form.discountAmountAdd>100?100:this.form.discountAmountAdd,t-=this.subtotal*(+this.form.discountAmount||0)*.01):t-=+this.form.discountAmountAdd||0,this.beforeVatTotal=t,this.VATTotal=0==t?0:t+.15*t,this.paidTotal=this.form.orderPayments.reduce((i,n)=>i+(n.value||0),0),this.form.total=this.total=this.VATTotal}setFormByOrderCode(t){this.form=t,this.checkTotal(),this.form.isFree&&(this.form.isPrecentage=!0,this.form.discountAmount=100)}onTimeSelected(t){this.form.visitDate=t.dataVisit,this.form.orderTeams=t.selectedTimes}onNavChange(t){}changeTab(){}finishedOrder(t){this.isFinished=!0,this.orderCode=t,this.active=6,this.resetForm()}finishedUpdateOrder(t){this.isFinished=!0,this.orderCode=t,this.active=6}newOrder(){this.resetForm(),this.orderCode=0,this.active=1,this.total=0,this.subtotal=0}editOrder(){this.active=1}resetForm(){this.form={id:null,cityCode:0,clientLocationId:0,clientId:0,isUrgent:!1,notes:"",items:[],discountAmount:0,discountAmountAdd:0,total:0,agent:{},orderPayments:[],orderLocations:{},discountType:1,discountTypeAdd:1,isPrecentage:!1,isPrecentageAdd:!1,totalAddDiscountType:0,totalAddDiscount:0}}removeService(t){this.form.orderServices.splice(t,1)}updatePrice(t,i){this.form.orderServices[i].price=t.price*t.quantity}decrement(t){let i=this.form.orderServices.find(n=>n.serviceCode==t.serviceCode);i.quantity<=1||(i&&(i.quantity=i.quantity-1),this.checkTotal())}increment(t){let i=this.form.orderServices.find(n=>n.serviceCode==t.serviceCode);i&&(i.quantity=i.quantity+1),this.checkTotal()}quantityChange(t,i){parseInt(t.target.value)<=0&&(this.form.orderServices.find(a=>a.serviceCode==i.serviceCode).quantity=1),this.checkTotal(),this.form.orderServices=[...this.form.orderServices]}checkPrecentageChange(t){this.form.isPrecentage=t.target.checked,this.checkTotal()}checkPrecentageAddChange(t){this.form.isPrecentageAdd=t.target.checked,this.checkTotal()}onIsFreeChange(t){t?(this.form.isPrecentage=!0,this.form.discountAmount=100):(this.form.isPrecentage=!1,this.form.discountAmount=0),this.checkTotal()}orderFinished(){let t={id:0,clientId:this.form.clientId,notes:this.form.notes,clientLocationId:this.form.clientLocationId,totalAddDiscount:this.form.discountAmount,totalAddDiscountType:this.form.isPrecentage?2:1,offerOrderDetails:this.form.items.map(i=>({discount:i.discount,discountType:i.discountType,itemId:i.itemId,clientQuantity:i.quantity,id:0,price:i.price,unitId:i.unitId}))};this.ngxLoader.startLoader("order"),this.baseService.register(t).subscribe(i=>{i.success?(this.ngxLoader.stopLoader("order"),this.finishedOrder(i.data.id),this.alertService.success(),localStorage.removeItem("orderCode"),this.checkdisableForm()):(this.alertService.error(),this.ngxLoader.stopLoader("order"))},()=>{this.alertService.error(),this.ngxLoader.stopLoader("order")})}checkdisableForm(){let t=!1;null==this.form.clientId||0==this.form.clientId||null==this.form.clientId||null==this.form.clientLocationId||0==this.form.clientLocationId||null==this.form.clientLocationId||this.form.items.length<=0?t=!0:this.form.items.length>0?(this.form.items.forEach(i=>{0!=i.itemId||(t=!0)}),t=!!t):t=!1,this.disabledStatus=t}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(h.c$),e.rXU(D),e.rXU(x.u),e.rXU(f.eD))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["sales-operation"]],inputs:{form:"form",orderCode:"orderCode",mobile:"mobile",cityCode:"cityCode",agentName:"agentName",pendingCode:"pendingCode",isInner:"isInner",isOrderEdit:"isOrderEdit",isReopen:"isReopen"},decls:137,vars:94,consts:[["formEntity","ngForm"],["customNav","ngbNav"],["discountAmount","ngModel"],["notes","ngModel"],[1,"row"],[1,"col-xl-12"],[1,"checkout-tab"],[1,"col-12","col-lg-8","col-md-12",3,"ngStyle"],[1,"card","card-summary","card-order-operation","m-0","ribbon-box","material-shadow",2,"border-radius","20px"],[1,"card-body",2,"padding","2rem"],[1,"ribbon-three","ribbon-three-warning"],["fgsColor","rgba(255,255,255,0)",3,"loaderId"],[1,"step-arrow-nav","mt-n3","mx-n3","mb-3"],["ngbNav","","role","tablist",1,"nav","nav-pills","custom-nav","nav-justified",3,"navChange","activeId"],[3,"ngbNavItem"],["ngbNavLink","","data-bs-toggle","tab","role","tab",1,"nav-link","fs-15","p-3"],[1,"ri-user-3-fill","fs-16","p-2","bg-primary-subtle","text-primary","rounded-circle","align-middle","mx-2"],[1,"d-block","mt-2"],["ngbNavContent",""],[1,"ri-user-location-fill","fs-16","p-2","bg-primary-subtle","text-primary","rounded-circle","align-middle","mx-2"],[1,"ri-shopping-cart-fill","fs-16","p-2","bg-primary-subtle","text-primary","rounded-circle","align-middle","mx-2"],[1,"ri-check-double-fill","fs-16","p-2","bg-primary-subtle","text-primary","rounded-circle","align-middle","mx-2"],[1,"tab-content"],[3,"ngbNavOutlet"],[1,"card-footer","text-center",2,"padding","1rem"],["type","button","data-nexttab","pills-finish-tab",1,"btn","btn-primary","right","ms-auto","nexttab",3,"click","disabled"],[1,"mx-1","ri-checkbox-circle-fill","label-icon","align-middle","fs-16","ms-2"],["translate","orderManagement.order.orderSaved"],[1,"col-12","col-lg-4","col-md-12","mt-3","mt-lg-0","mt-md-3","summary"],[1,"card","card-summary","card-summary-pos","card-order-operation","m-0","ribbon-box","material-shadow"],[1,"card-body","card-order-operation",2,"padding","2rem"],[1,"table-responsive","table-card","mt-3","overflow-hidden"],[1,"table","table-borderless","align-middle","mb-0"],[4,"ngIf"],["lass","py-0",2,"border-top","hsl(226, 36%, 80%) solid 1px!important"],["colspan","3"],[1,"d-flex","justify-content-between","align-items-center","mb-2"],[1,"w-75","fw-semibold"],[1,"w-25","fw-semibold","text-end"],[1,"col-6","input-group"],["type","button",1,"btn","btn-danger"],["tooltipPosition","top",1,"input-group-text","d-inline",3,"pTooltip"],["type","checkbox","aria-label","Checkbox for following text input",1,"form-check-input",3,"change","checked"],[1,"p-1"],["min","0","InputTirmFilter","","name","discountAmount","type","text","id","discountAmount","required","",1,"form-control","text-right",3,"change","ngModelChange","ngModel"],[1,"d-flex","justify-content-between","align-items-center"],[1,"fw-semibold"],[1,"fw-semibold","text-end"],[1,"table-active","py-0"],[1,"py-0",2,"border-top","hsl(226, 36%, 80%) solid 1px!important"],["colspan","2",1,"fw-semibold"],[1,"table-active","text-danger","py-0"],["colspan","2",1,"text-end"],["colspan","3",1,"py-0"],["InputTirmFilter","","name","notes","type","text","id","notes","required","",1,"form-control","fs-6",3,"ngModelChange","placeholder","ngModel"],[3,"calacTotal","setFormByOrderCode","isOrderEdit","isInner","form"],[3,"isOrderEdit","form"],[3,"CalcTotal","isOrderEdit","serviceCategories","form"],[3,"editOrderActiveTab","newOrder","orderCode","form"],[1,"text-start","text-muted","fw-semibold","mt-3"],[4,"ngFor","ngForOf"],[3,"ngStyle"],["colspan","3",1,"p-1","m-1"],[1,"row","justify-content-between","align-items-center"],[1,"col-12","col-md-4","h6","d-flex","justify-content-start","align-items-center"],[1,"badge","bg-success-subtle","text-success","me-2"],[1,"d-block","mb-1"],[1,"d-block","mt-1"],[1,"col-12","col-md-4","text-mute","text-center"],[1,"input-step","my-2"],["type","button",1,"minus",3,"click"],["disabled","","type","number","min","1","max","100",1,"product-quantity",3,"change","id","value"],["type","button",1,"plus",3,"click"],[1,"col-12","col-md-4","text-mute","text-right"],[1,"ri-close-fill","text-danger","cursor-pointer",3,"click"],["colspan","3",1,"text-center","text-danger"],[1,"text-start","text-muted","fw-semibold"]],template:function(i,n){if(1&i){const s=e.RV6();e.j41(0,"div",4)(1,"div",5)(2,"div")(3,"div",6)(4,"div",4)(5,"div",7)(6,"div",8)(7,"div",9)(8,"span",10)(9,"span"),e.EFF(10),e.nI1(11,"translate"),e.k0s()(),e.nrm(12,"ngx-ui-loader",11),e.j41(13,"div",12)(14,"form",null,0)(16,"ul",13,1),e.bIt("navChange",function(l){return e.eBV(s),e.Njj(n.onNavChange(l))}),e.j41(18,"li",14)(19,"a",15),e.nrm(20,"i",16),e.j41(21,"span",17),e.EFF(22),e.nI1(23,"translate"),e.k0s()(),e.DNE(24,et,1,3,"ng-template",18),e.k0s(),e.j41(25,"li",14)(26,"a",15),e.nrm(27,"i",19),e.j41(28,"span",17),e.EFF(29),e.nI1(30,"translate"),e.k0s()(),e.DNE(31,tt,1,2,"ng-template",18),e.k0s(),e.j41(32,"li",14)(33,"a",15),e.nrm(34,"i",20),e.j41(35,"span",17),e.EFF(36),e.nI1(37,"translate"),e.k0s()(),e.DNE(38,nt,1,3,"ng-template",18),e.k0s(),e.j41(39,"li",14)(40,"a",15),e.nrm(41,"i",21),e.j41(42,"span",17),e.EFF(43),e.nI1(44,"translate"),e.k0s()(),e.DNE(45,it,1,2,"ng-template",18),e.k0s()(),e.j41(46,"div",22),e.nrm(47,"div",23),e.k0s()()()(),e.j41(48,"div",24)(49,"button",25),e.bIt("click",function(){return e.eBV(s),e.Njj(n.orderFinished())}),e.nrm(50,"i",26)(51,"span",27),e.k0s()()()(),e.j41(52,"div",28)(53,"div",29)(54,"div",30)(55,"span",10)(56,"span"),e.EFF(57),e.nI1(58,"translate"),e.k0s()(),e.j41(59,"div",31)(60,"table",32)(61,"tbody"),e.DNE(62,st,5,4,"ng-container",33)(63,at,4,3,"tr",33)(64,ot,6,3,"tr",33),e.j41(65,"tr",34)(66,"td",35)(67,"div",36)(68,"div",37),e.EFF(69),e.nI1(70,"translate"),e.k0s(),e.j41(71,"div",38),e.EFF(72),e.nI1(73,"translate"),e.k0s()(),e.j41(74,"div",39)(75,"button",40),e.EFF(76),e.nI1(77,"translate"),e.k0s(),e.j41(78,"div",41),e.nI1(79,"translate"),e.j41(80,"input",42),e.bIt("change",function(l){return e.eBV(s),e.Njj(n.checkPrecentageChange(l))}),e.k0s(),e.j41(81,"span",43),e.EFF(82,"%"),e.k0s()(),e.j41(83,"input",44,2),e.bIt("change",function(){return e.eBV(s),e.Njj(n.checkTotal())}),e.mxI("ngModelChange",function(l){return e.eBV(s),e.DH7(n.form.discountAmount,l)||(n.form.discountAmount=l),e.Njj(l)}),e.k0s()()()(),e.j41(85,"tr",34)(86,"td",35)(87,"div",45)(88,"div",46),e.EFF(89),e.nI1(90,"translate"),e.k0s(),e.j41(91,"div",47),e.EFF(92),e.nI1(93,"translate"),e.k0s()(),e.j41(94,"div",45)(95,"div",46),e.EFF(96),e.nI1(97,"translate"),e.k0s(),e.j41(98,"div",47),e.EFF(99),e.nI1(100,"translate"),e.k0s()(),e.j41(101,"div",45)(102,"div",46),e.EFF(103),e.nI1(104,"translate"),e.k0s(),e.j41(105,"div",47),e.EFF(106),e.nI1(107,"translate"),e.k0s()()()(),e.j41(108,"tr",48)(109,"td",35)(110,"div",36)(111,"div",46),e.EFF(112),e.nI1(113,"translate"),e.k0s(),e.j41(114,"div",47),e.EFF(115),e.nI1(116,"translate"),e.k0s()()()(),e.j41(117,"tr",49)(118,"td",50),e.EFF(119),e.nI1(120,"translate"),e.k0s(),e.j41(121,"td",47),e.EFF(122),e.nI1(123,"translate"),e.k0s()(),e.j41(124,"tr",51)(125,"td"),e.EFF(126),e.nI1(127,"translate"),e.k0s(),e.j41(128,"td",52)(129,"span",46),e.EFF(130),e.nI1(131,"translate"),e.k0s()()(),e.j41(132,"tr",48)(133,"td",53)(134,"textarea",54,3),e.nI1(136,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(s),e.DH7(n.form.notes,l)||(n.form.notes=l),e.Njj(l)}),e.k0s()()()()()()()()()()()()()()}if(2&i){const s=e.sdS(17);e.R7$(5),e.Y8G("ngStyle",e.l_i(91,We,"en"==n.language,"en"==n.language)),e.R7$(5),e.JRh(e.bMT(11,45,"orderManagement.order.addOrders")),e.R7$(2),e.Y8G("loaderId","order"),e.R7$(4),e.Y8G("activeId",n.active),e.R7$(2),e.Y8G("ngbNavItem",1),e.R7$(4),e.SpI(" ",e.bMT(23,47,"orderManagement.order.clientInfo")," "),e.R7$(3),e.Y8G("ngbNavItem",2),e.R7$(4),e.SpI(" ",e.bMT(30,49,"orderManagement.order.locations")," "),e.R7$(3),e.Y8G("ngbNavItem",3),e.R7$(4),e.SpI(" ",e.bMT(37,51,"orderManagement.order.items")," "),e.R7$(3),e.Y8G("ngbNavItem",6),e.R7$(4),e.SpI(" ",e.bMT(44,53,"orderManagement.order.finish")," "),e.R7$(4),e.Y8G("ngbNavOutlet",s),e.R7$(2),e.Y8G("disabled",n.disabledStatus),e.R7$(8),e.JRh(e.bMT(58,55,"orderManagement.order.orderSummary")),e.R7$(5),e.Y8G("ngIf",n.form.items.length>0),e.R7$(),e.Y8G("ngIf",0==n.form.items.length),e.R7$(),e.Y8G("ngIf",0==n.form.items.length),e.R7$(5),e.JRh(e.bMT(70,57,"orderManagement.order.SubTotal")),e.R7$(3),e.Lme("",n.subtotal," ",e.bMT(73,59,"orderManagement.order.currancy"),""),e.R7$(4),e.SpI(" ",e.bMT(77,61,"orderManagement.order.Discount")," "),e.R7$(2),e.FS9("pTooltip",e.bMT(79,63,"orderManagement.order.discount")),e.R7$(2),e.Y8G("checked",n.form.isPrecentage),e.R7$(3),e.R50("ngModel",n.form.discountAmount),e.R7$(6),e.JRh(e.bMT(90,65,"orderManagement.order.PriceAfterDisaccount")),e.R7$(3),e.Lme(" ",n.beforeVatTotal.toFixed(2)," ",e.bMT(93,67,"orderManagement.order.currancy")," "),e.R7$(4),e.JRh(e.bMT(97,69,"orderManagement.order.PriceBeforeVat")),e.R7$(3),e.Lme(" ",n.beforeVatTotal.toFixed(2)," ",e.bMT(100,71,"orderManagement.order.currancy")," "),e.R7$(4),e.SpI("",e.bMT(104,73,"orderManagement.order.tax")," (15%)"),e.R7$(3),e.Lme("",(n.VATTotal-n.beforeVatTotal).toFixed(2)," ",e.bMT(107,75,"orderManagement.order.currancy")," "),e.R7$(6),e.JRh(e.bMT(113,77,"orderManagement.order.VAT")),e.R7$(3),e.Lme("",n.VATTotal.toFixed(2)," ",e.bMT(116,79,"orderManagement.order.currancy"),""),e.R7$(4),e.SpI("",e.bMT(120,81,"orderManagement.order.paidTotal"),": "),e.R7$(3),e.Lme("",n.paidTotal," ",e.bMT(123,83,"orderManagement.order.currancy"),""),e.R7$(4),e.SpI("",e.bMT(127,85,"orderManagement.order.reminder")," :"),e.R7$(4),e.Lme(" ",(n.total-n.paidTotal).toFixed(2)," ",e.bMT(131,87,"orderManagement.order.currancy")," "),e.R7$(4),e.FS9("placeholder",e.bMT(136,89,"orderManagement.order.notes")),e.R50("ngModel",n.form.notes)}},dependencies:[p.Sq,p.bT,p.B3,m.Um,m.X9,m.sy,m.Gx,m.Ri,m.WA,m.m_,c.qT,c.me,c.BC,c.cb,c.YS,c.vS,c.cV,h.Mm,G.m,f.Cv,ee.m,Ne,Ae,Ye,Ze,h.D9],encapsulation:2})}}return r})(),_e=(()=>{class r{constructor(){this.breadCrumbItems=[],this.addOrders="orderManagement.order.addOrders"}ngOnInit(){}static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["order-register"]],decls:1,vars:0,template:function(i,n){1&i&&e.nrm(0,"sales-operation")},dependencies:[lt],encapsulation:2})}}return r})();var te=d(56701),fe=d(26364),U=d(75622);let dt=(()=>{class r extends ae.d{constructor(t){super(t,Z.c.apiUrl+"ShippingTruck/")}static{this.\u0275fac=function(i){return new(i||r)(e.KVO(oe.Qq))}}static{this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var W=d(91426),ct=d(53928),z=d(40724),Q=d(88148),J=d(91580),H=d(5779);function mt(r,o){1&r&&(e.j41(0,"tr",25)(1,"th",26),e.EFF(2,"#"),e.k0s(),e.j41(3,"th",27),e.nrm(4,"i",28),e.EFF(5," sales.shippingTruck.name "),e.k0s(),e.j41(6,"th",29),e.nrm(7,"i",28),e.EFF(8," sales.shippingTruck.truckNumber "),e.k0s(),e.j41(9,"th",30),e.nrm(10,"i",28),e.EFF(11," sales.shippingTruck.truckDriverName "),e.k0s(),e.j41(12,"th",31),e.EFF(13," sales.shippingTruck.cityName "),e.k0s(),e.j41(14,"th",32),e.nrm(15,"i",28),e.EFF(16," general.table.isActive "),e.k0s(),e.nrm(17,"th",31),e.k0s())}function pt(r,o){if(1&r&&(e.qex(0),e.j41(1,"span",42),e.EFF(2),e.k0s(),e.bVm()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t.cityName)}}function gt(r,o){1&r&&e.nrm(0,"span",43)}function ht(r,o){1&r&&e.nrm(0,"span",44)}function ut(r,o){if(1&r&&(e.nrm(0,"i",45),e.EFF(1),e.nI1(2,"date"),e.nrm(3,"br")(4,"i",46),e.EFF(5),e.nI1(6,"date"),e.nrm(7,"br")(8,"i",47),e.EFF(9)),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",e.i5U(2,3,t.createdDate,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",e.i5U(6,6,t.updatedDate,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",t.creatorName," ")}}function _t(r,o){if(1&r){const t=e.RV6();e.j41(0,"tr",33)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td"),e.DNE(10,pt,3,1,"ng-container",34),e.k0s(),e.j41(11,"td"),e.DNE(12,gt,1,0,"span",35)(13,ht,1,0,"span",36),e.k0s(),e.j41(14,"td"),e.DNE(15,ut,10,9,"ng-template",null,3,e.C5r),e.nrm(17,"i",37),e.j41(18,"button",38),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(),a=e.sdS(20);return e.Njj(s.EditModel(n.id,a))}),e.nrm(19,"i",39),e.k0s(),e.j41(20,"button",40),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(),a=e.sdS(22);return e.Njj(s.openModal(n.id,a))}),e.nrm(21,"i",41),e.k0s()()()}if(2&r){const t=o.$implicit,i=o.rowIndex,n=e.sdS(16);e.R7$(2),e.JRh(i+1),e.R7$(2),e.JRh(t.name),e.R7$(2),e.JRh(t.truckNumber),e.R7$(2),e.JRh(t.truckDriverName),e.R7$(2),e.Y8G("ngForOf",t.cities),e.R7$(2),e.Y8G("ngIf",t.isActive),e.R7$(),e.Y8G("ngIf",!t.isActive),e.R7$(4),e.Y8G("ngbTooltip",n)}}function ft(r,o){1&r&&(e.j41(0,"div",48),e.EFF(1," general.table.noData "),e.k0s())}function bt(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",49)(1,"div",50),e.nrm(2,"ngb-pagination-info",51),e.j41(3,"table-length",52),e.bIt("lengthChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",53)(5,"ngb-pagination",54),e.bIt("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.pagination.pageNumber,n)||(s.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function vt(r,o){1&r&&(e.j41(0,"span",80),e.EFF(1,"general.action.register "),e.k0s())}function Ct(r,o){1&r&&(e.j41(0,"span",80),e.EFF(1,"general.action.edit "),e.k0s())}function St(r,o){1&r&&(e.j41(0,"div",81),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function jt(r,o){1&r&&(e.j41(0,"div",81),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function Tt(r,o){1&r&&(e.j41(0,"div",81),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function kt(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",55)(1,"div",56)(2,"h4",57),e.DNE(3,vt,2,0,"span",58)(4,Ct,2,0,"span",58),e.j41(5,"span",59),e.EFF(6),e.k0s()(),e.j41(7,"button",60),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss("Cross click"))}),e.k0s()(),e.j41(8,"div",61),e.nrm(9,"ngx-ui-loader",18),e.j41(10,"form",62,4),e.bIt("submit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.OnSubmit())}),e.j41(12,"div",63)(13,"label",64),e.EFF(14,"sales.shippingTruck.name"),e.k0s(),e.j41(15,"input",65,5),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.name,n)||(s.form.name=n),e.Njj(n)}),e.k0s(),e.DNE(17,St,2,0,"div",66),e.k0s(),e.j41(18,"div",63)(19,"label",67),e.EFF(20,"sales.shippingTruck.truckNumber"),e.k0s(),e.j41(21,"input",68,6),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.truckNumber,n)||(s.form.truckNumber=n),e.Njj(n)}),e.k0s(),e.DNE(23,jt,2,0,"div",66),e.k0s(),e.j41(24,"div",63)(25,"label",69),e.EFF(26,"sales.shippingTruck.driver"),e.k0s(),e.j41(27,"ng-select",70,7),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.truckDriverId,n)||(s.form.truckDriverId=n),e.Njj(n)}),e.k0s(),e.DNE(29,Tt,2,0,"div",66),e.k0s(),e.j41(30,"div",71)(31,"label",69),e.EFF(32,"sales.shippingTruck.cities"),e.k0s(),e.j41(33,"ng-select",72),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.cities,n)||(s.form.cities=n),e.Njj(n)}),e.k0s()(),e.j41(34,"div",73)(35,"label",74),e.EFF(36,"general.table.isActive"),e.k0s(),e.j41(37,"p-inputSwitch",75),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.isActive,n)||(s.form.isActive=n),e.Njj(n)}),e.k0s()(),e.j41(38,"div",76)(39,"button",77),e.nrm(40,"i",78)(41,"span",79),e.k0s()()()()()}if(2&r){const t=e.sdS(11),i=e.sdS(16),n=e.sdS(22),s=e.sdS(28),a=e.XpG();e.R7$(3),e.Y8G("ngIf",!a.isEditForm),e.R7$(),e.Y8G("ngIf",a.isEditForm),e.R7$(2),e.JRh(a.titleOperation),e.R7$(3),e.Y8G("hasProgressBar",!1)("fgsType",a.loaderOperationShap)("loaderId",a.operationLoader),e.R7$(6),e.R50("ngModel",a.form.name),e.R7$(2),e.Y8G("ngIf",i.invalid&&i.touched),e.R7$(4),e.R50("ngModel",a.form.truckNumber),e.R7$(2),e.Y8G("ngIf",n.invalid&&n.touched),e.R7$(4),e.Y8G("items",a.employees)("multiple",!1),e.R50("ngModel",a.form.truckDriverId),e.R7$(2),e.Y8G("ngIf",s.invalid&&s.touched),e.R7$(4),e.Y8G("items",a.cities)("multiple",!0),e.R50("ngModel",a.form.cities),e.R7$(4),e.R50("ngModel",a.form.isActive),e.R7$(2),e.Y8G("disabled",!t.valid)}}function It(r,o){if(1&r){const t=e.RV6();e.j41(0,"delete-modal",82),e.bIt("deleteConfirm",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.DeleteConfirmSoft())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}}let yt=(()=>{class r extends U.w{constructor(t,i,n,s,a,l,C,j,T,S,I){super(t,i,C,n,s,a,l),this.baseService=n,this.excelService=T,this.employeeService=S,this.cityService=I,this.title="sales.shippingTruck.title",this.titleOperation="sales.shippingTruck.titleOperation",this.keySelected="",this.assignUsers=[],this.times=[],this.employees=[],this.searchForm={},this.cities=[],this.configRoute(),this.getEmployees(),this.getCities()}OnSearch(t){this.ngxLoader.startLoader(g.a7),this.loadentities()}onSearch(){this.ngxLoader.startLoader(g.a7),this.loadentities()}configRoute(){this.routerActive.data.pipe((0,u.Q)(this.notifier)).subscribe(t=>{this.entities=t.data.data,this.pagination.totalItems=t.data.totalItems},()=>{this.alertService.error()})}getEmployees(){this.employeeService.getDropDown().pipe((0,u.Q)(this.notifier)).subscribe(t=>{this.employees=t.data},()=>{this.alertService.error()})}getCities(){this.cityService.getDropDown().pipe((0,u.Q)(this.notifier)).subscribe(t=>{this.cities=t.data},()=>{this.alertService.error()})}mapExcel(){let t=[];return this.entities?.forEach(i=>{t.push({workTime:i.workTime,isActive:this.getTranslationText("general.table.active")})}),t}mapRegisterForm(t){let i={...t};return i.id=0,i.cities=i.cities.map(n=>({cityId:n,shippingTruckId:0})),i}mapForm(t){let i={...t};return i.cities=i.cities.map(n=>({cityId:n,shippingTruckId:i.id})),i}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,"Service Type",[])}editEntity(){let t=this.mapForm(this.form);this.baseService.editPut(t.id,t).pipe((0,R.O)(),(0,M.c)(this.mainDelay),(0,O.Z)(),(0,u.Q)(this.notifier),(0,k.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(i=>{i.success?this.submitFunished():this.alertService.error("general.message."+i.message)},i=>{this.alertService.error("general.message."+i)})}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(v.nX),e.rXU(h.c$),e.rXU(dt),e.rXU(x.u),e.rXU(p.vh),e.rXU(f.eD),e.rXU(m.Bq),e.rXU(e.gRc),e.rXU(W.V),e.rXU(ct.O),e.rXU(P.h))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-shipping-trucks"]],features:[e.Vt3],decls:23,vars:16,consts:[["tableMaster",""],["operation",""],["deleteModal",""],["tooltipContent",""],["formEntity","ngForm"],["name","ngModel"],["truckNumber","ngModel"],["truckDriverId","ngModel"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],[3,"reset","search","addNew","showExport","totalItems","title"],["control",""],[1,"col-md-3","mb-2"],[1,"search-box"],["InputTirmFilter","","type","search","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],[1,"card-body"],[3,"hasProgressBar","fgsType","loaderId"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["translate","",2,"width",".5%"],["pSortableColumn","name","translate","",2,"width","10%"],[1,"ri-expand-up-down-line"],["pSortableColumn","truckNumber","translate","",2,"width","10%"],["pSortableColumn","truckDriverId","translate","",2,"width","10%"],["translate","",2,"width","10%"],["pSortableColumn","isActive","translate","",2,"width","8%"],[1,"fs-5"],[4,"ngFor","ngForOf"],["class","badge bg-success-subtle text-success p-2","translate","general.table.active",4,"ngIf"],["class","badge bg-danger-subtle text-danger p-2","translate","general.table.noActive",4,"ngIf"],["tooltipPosition","top",1,"mdi","mdi-cog-outline","text-muted","fs-16","align-middle","me-1",3,"ngbTooltip"],[1,"btn","btn-sm","btn-soft-info","edit-list","mx-2",3,"click"],[1,"ri-pencil-fill","align-bottom","mx-1"],[1,"btn","btn-sm","btn-soft-danger","remove-list",3,"click"],[1,"ri-delete-bin-5-fill","align-bottom"],[1,"badge","badge-pill","bg-primary","mx-1"],["translate","general.table.active",1,"badge","bg-success-subtle","text-success","p-2"],["translate","general.table.noActive",1,"badge","bg-danger-subtle","text-danger","p-2"],[1,"ri-history-fill","text-warning"],[1,"ri-history-fill","text-danger"],[1,"ri-user-location-fill","text-primary"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["class","fw-bold fs-4","translate","",4,"ngIf"],["translate",""],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"submit"],[1,"mb-3"],["for","name","translate","",1,"fw-bold","form-label"],["InputTirmFilter","","name","name","type","text","id","name",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["class","text-danger text-center  ","translate","",4,"ngIf"],["for","truckNumber","translate","",1,"fw-bold","form-label"],["InputTirmFilter","","name","truckNumber","type","text","id","truckNumber",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["translate","",1,"required","fw-bold","form-label","w-100"],["name","truckDriverId","bindValue","code","bindLabel","name","required","",3,"ngModelChange","items","multiple","ngModel"],[1,"col-12","mb-1"],["name","cities","bindValue","code","bindLabel","name",3,"ngModelChange","items","multiple","ngModel"],[1,"form-check"],["for","isActive","translate","",1,"fw-bold","form-label","w-100"],["name","isActive","inputId","isActive",3,"ngModelChange","ngModel"],[1,"text-center"],["type","submit","type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],["translate","",1,"fw-bold","fs-4"],["translate","",1,"text-danger","text-center"],[3,"deleteConfirm","dismiss"]],template:function(i,n){if(1&i){const s=e.RV6();e.j41(0,"div",8)(1,"div",9)(2,"div",10)(3,"base-filter",11),e.bIt("reset",function(){return e.eBV(s),e.Njj(n.onReset())})("search",function(){return e.eBV(s),e.Njj(n.onSearch())})("addNew",function(){e.eBV(s);const l=e.sdS(20);return e.Njj(n.openModalTitle(l,"md"))}),e.qex(4,12),e.j41(5,"div",13)(6,"div",14)(7,"input",15),e.nI1(8,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(s),e.DH7(n.pagination.filterValue,l)||(n.pagination.filterValue=l),e.Njj(l)}),e.k0s(),e.nrm(9,"i",16),e.k0s()(),e.bVm(),e.k0s(),e.j41(10,"div",17),e.nrm(11,"ngx-ui-loader",18),e.j41(12,"div",19)(13,"p-table",20,0),e.bIt("onLazyLoad",function(l){return e.eBV(s),e.Njj(n.tableChange(l))})("selectionChange",function(l){return e.eBV(s),e.Njj(n.onSelectionChange(l))}),e.DNE(15,mt,18,0,"ng-template",21)(16,_t,22,8,"ng-template",22),e.k0s()(),e.DNE(17,ft,2,0,"div",23)(18,bt,6,8,"div",24),e.k0s()()()(),e.DNE(19,kt,42,19,"ng-template",null,1,e.C5r)(21,It,1,0,"ng-template",null,2,e.C5r)}2&i&&(e.R7$(3),e.Y8G("showExport",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(8,14,"task.tasklist.subject")),e.R50("ngModel",n.pagination.filterValue),e.R7$(4),e.Y8G("hasProgressBar",!1)("fgsType",n.loaderSearchShap)("loaderId",n.searchLoader),e.R7$(2),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[p.Sq,p.bT,c.qT,c.me,c.BC,c.cb,c.YS,c.vS,c.cV,m.s5,z.b,X.w,Q.p,J.g,h.Mm,b.XI,H.Ei,b.Tg,ge.HW,f.Cv,Y.vr,m.md,G.m,p.vh,h.D9],encapsulation:2})}}return r})();function Ft(r,o){1&r&&e.nrm(0,"app-shipping-trucks")}let xt=(()=>{class r{constructor(){this.title="sales.salesSetting.title"}ngOnInit(){this.breadCrumbItems=[]}static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-sales-setting"]],decls:15,vars:7,consts:[["Arrow","ngbNav"],[3,"title","breadcrumbItems"],[1,"col-12"],[1,"card"],[1,"card-body"],["ngbNav","",1,"nav","nav-pills","arrow-navtabs","nav-success","bg-light","mb-3",3,"activeId"],[3,"ngbNavItem"],["ngbNavLink",""],[1,"d-block","d-sm-none"],[1,"mdi","mdi-home-variant"],["translate","sales.shippingTruck.title",1,"d-sm-block"],["ngbNavContent",""],[1,"tab-content","text-muted"],[3,"ngbNavOutlet"]],template:function(i,n){if(1&i&&(e.nrm(0,"app-breadcrumbs",1),e.nI1(1,"translate"),e.j41(2,"div",2)(3,"div",3)(4,"div",4)(5,"ul",5,0)(7,"li",6)(8,"a",7)(9,"span",8),e.nrm(10,"i",9),e.k0s(),e.nrm(11,"span",10),e.k0s(),e.DNE(12,Ft,1,0,"ng-template",11),e.k0s()(),e.j41(13,"div",12),e.nrm(14,"div",13),e.k0s()()()()),2&i){const s=e.sdS(6);e.FS9("title",e.bMT(1,5,n.title)),e.Y8G("breadcrumbItems",n.breadCrumbItems),e.R7$(5),e.Y8G("activeId",1),e.R7$(2),e.Y8G("ngbNavItem",1),e.R7$(7),e.Y8G("ngbNavOutlet",s)}},dependencies:[m.Um,m.X9,m.sy,m.Gx,m.Ri,m.WA,m.m_,fe.m,h.Mm,yt,h.D9],encapsulation:2})}}return r})();var K=d(62984),ne=d(70053),ie=d(79284),re=d(16229),se=d(12822),le=d(50204),Rt=d(14221);function Mt(r,o){1&r&&(e.j41(0,"tr",27),e.nrm(1,"th",28),e.j41(2,"th",29),e.EFF(3,"#"),e.k0s(),e.j41(4,"th",30),e.nrm(5,"i",31),e.EFF(6," orderManagement.order.orderCode "),e.k0s(),e.j41(7,"th",32),e.nrm(8,"i",31),e.EFF(9," orderManagement.order.creation "),e.k0s(),e.j41(10,"th",33),e.EFF(11," orderManagement.order.status "),e.k0s(),e.j41(12,"th",34),e.nrm(13,"i",31),e.EFF(14," orderManagement.order.agentName "),e.k0s(),e.j41(15,"th",35),e.EFF(16," orderManagement.order.assignTo "),e.k0s(),e.j41(17,"th",36),e.nrm(18,"i",31),e.EFF(19," sales.salesOrder.clientVisitDate "),e.k0s(),e.j41(20,"th",37),e.nrm(21,"i",31),e.EFF(22," sales.salesOrder.totalQuantity "),e.k0s(),e.j41(23,"th",38),e.nrm(24,"i",31),e.EFF(25," sales.salesOrder.totalDiscount "),e.k0s(),e.j41(26,"th",39),e.nrm(27,"i",31),e.EFF(28," sales.salesOrder.netPrice "),e.k0s(),e.nrm(29,"th",40),e.k0s())}function Ot(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",50),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,s=e.XpG(),a=e.sdS(42);return e.Njj(s.openEditOrderModal(n.orderCode,a,"xxl"))}),e.nrm(1,"i",51)(2,"span",52),e.k0s()}}function Nt(r,o){if(1&r){const t=e.RV6();e.j41(0,"tr",41)(1,"td"),e.nrm(2,"button",42),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td",43),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(),a=e.sdS(40);return e.Njj(s.openModalClient(n,a,"lg"))}),e.j41(6,"bdi",44),e.EFF(7),e.k0s()(),e.j41(8,"td")(9,"span",45),e.EFF(10),e.k0s(),e.EFF(11),e.nI1(12,"date"),e.k0s(),e.j41(13,"td")(14,"span"),e.nrm(15,"span",46),e.k0s()(),e.j41(16,"td",43),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(),a=e.sdS(38);return e.Njj(s.openModalClient(n,a))}),e.j41(17,"span",47),e.EFF(18),e.k0s()(),e.j41(19,"td"),e.EFF(20),e.k0s(),e.j41(21,"td"),e.EFF(22),e.nI1(23,"date"),e.k0s(),e.j41(24,"td"),e.EFF(25),e.k0s(),e.j41(26,"td"),e.EFF(27),e.k0s(),e.j41(28,"td"),e.EFF(29),e.k0s(),e.j41(30,"td")(31,"i",48),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(),a=e.sdS(44);return e.Njj(s.OpenOrderTimeLineModel(n,a,"lg"))}),e.k0s(),e.DNE(32,Ot,3,0,"button",49),e.k0s()()}if(2&r){const t=o.$implicit,i=o.rowIndex,n=o.expanded,s=e.XpG();e.R7$(2),e.Y8G("pRowToggler",t)("ngClass",n?" ri-arrow-down-s-line":"  ri-arrow-up-s-line"),e.R7$(2),e.JRh(i+1),e.R7$(3),e.SpI("#SO#",t.id,""),e.R7$(3),e.SpI("",t.creatorName," "),e.R7$(),e.SpI(" ",e.i5U(12,17,t.creationTime,"yyyy-MM-dd")," "),e.R7$(3),e.ZvI("badge ",s.getStatus(t),""),e.R7$(),e.FS9("translate","sales.salesOrder."+t.offerOrderStatusValue),e.R7$(3),e.SpI("",t.clientName," "),e.R7$(2),e.JRh(t.shippingTruckName),e.R7$(2),e.SpI(" ",e.i5U(23,20,t.clientVisitDate,"yyyy-MM-dd"),""),e.R7$(3),e.JRh(t.totalQuantity),e.R7$(2),e.JRh(t.totalDiscount),e.R7$(2),e.JRh(t.netPrice),e.R7$(3),e.Y8G("ngIf",s.checkEdit(t))}}function wt(r,o){if(1&r&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td"),e.EFF(10),e.nI1(11,"translate"),e.k0s(),e.j41(12,"td"),e.EFF(13),e.k0s(),e.j41(14,"td"),e.EFF(15),e.k0s()()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t.itemName),e.R7$(2),e.JRh(t.unitName),e.R7$(2),e.JRh(t.clientQuantity),e.R7$(2),e.JRh(t.approvedQuantity),e.R7$(2),e.SpI("",e.bMT(11,7,"sales.salesOrder."+t.discountTypeValue)," "),e.R7$(3),e.JRh(t.discount),e.R7$(2),e.JRh(t.price)}}function Et(r,o){if(1&r&&(e.j41(0,"tr")(1,"td",53)(2,"div")(3,"table",54)(4,"thead")(5,"tr",55),e.nrm(6,"th",56)(7,"th",57)(8,"th",58)(9,"th",59)(10,"th",60)(11,"th",61)(12,"th",62),e.k0s()(),e.j41(13,"tbody"),e.DNE(14,wt,16,9,"tr",63),e.k0s()()()()()),2&r){const t=o.$implicit;e.R7$(14),e.Y8G("ngForOf",t.offerOrderDetails)}}function Gt(r,o){1&r&&(e.j41(0,"div",64),e.EFF(1," general.table.noData "),e.k0s())}function Dt(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",65)(1,"div",66),e.nrm(2,"ngb-pagination-info",67),e.j41(3,"table-length",68),e.bIt("lengthChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",69)(5,"ngb-pagination",70),e.bIt("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.pagination.pageNumber,n)||(s.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function Vt(r,o){if(1&r){const t=e.RV6();e.j41(0,"delete-modal",71),e.bIt("deleteConfirm",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.DeleteConfirm())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}}function Lt(r,o){1&r&&e.nrm(0,"client-profile-main",72)}function $t(r,o){if(1&r){const t=e.RV6();e.j41(0,"app-all-orders-details",73),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderDetails",t.orderSelected)}}function Xt(r,o){if(1&r&&e.nrm(0,"order-operation",74),2&r){const t=e.XpG();e.Y8G("isOrderEdit",t.isOrderEdit)("isInner",!0)("orderCode",t.clientSelected)}}function Bt(r,o){if(1&r){const t=e.RV6();e.j41(0,"order-timeline",75),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderSelected",t.orderSelected)}}let Ut=(()=>{class r extends U.w{constructor(t,i,n,s,a,l,C,j,T,S,I,N,w,E,V){super(t,i,C,n,s,a,l),this.baseService=n,this.authDaamService=j,this.teamService=T,this.workTimeService=S,this.excelService=I,this.cityService=N,this.districtService=w,this.channelService=E,this.router=V,this.title="orderManagement.order.title",this.titleOperation="orderManagement.order.titleOperation",this.keySelected="",this.assignUsers=[],this.times=[],this.employees=[],this.searchForm={},this.isResolveList=!0,this.employeeTypes=[{id:1,name:"employeeTeam"},{id:2,name:"managment"},{id:3,name:"customerService"}],this.employeeGroups=[],this.activeindex="2",this.active=2,this.formPassword={},this.roles=[],this.teams=[],this.workTimes=[],this.userTypes=[],this.actives=[{id:!0,name:"active"},{id:!1,name:"noActive"}],this.clientSelected=0,this.cities=[],this.districts=[],this.channels=[],this.status=[],this.countLoad=2,this.isOrderEdit=!1,this.orderSelected={},this.users=[],this.setDates=(_,y,F)=>{if(_?.from||_?.to){const $=_.to||_.from;this.pagination[y]=this.datePipe.transform(_.from||_.to,"yyyy-MM-ddT00:00:00"),this.pagination[F]=this.datePipe.transform($,"yyyy-MM-ddT23:59:59.999")}else this.pagination[y]=null,this.pagination[F]=null},this.configRoute(),this.GetOrderLookUp(),this.GetCities(),this.GetChannels(),this.GetTeams(),this.GetTimes(),this.status=[{name:"None",nameAr:"\u0644\u0627 \u0634\u0626",id:0},{name:"Is Review",nameAr:"\u062a\u0645\u062a \u0627\u0644\u0645\u0631\u0627\u062c\u0639\u0629",id:1},{name:"Is Confirmed",nameAr:"\u062a\u0645 \u0627\u0644\u062a\u0623\u0643\u064a\u062f",id:2},{name:"Is Free",nameAr:"\u0645\u062c\u0627\u0646\u064a",id:3},{name:"Is Reopen",nameAr:"\u062a\u0645\u062a \u0625\u0639\u0627\u062f\u0629 \u0641\u062a\u062d\u0647",id:4},{name:"Is Finish",nameAr:"\u0627\u0646\u062a\u0647\u0649",id:5},{name:"Is Cancel",nameAr:"\u062a\u0645 \u0627\u0644\u0625\u0644\u063a\u0627\u0621",id:6},{name:"Is Assign",nameAr:"\u062a\u0645 \u062a\u0639\u064a\u064a\u0646\u0647",id:7},{name:"Is Urgent",nameAr:"\u0639\u0627\u062c\u0644",id:8},{name:"New",nameAr:"\u062c\u062f\u064a\u062f",id:9}]}GetOrderLookUp(){this.baseService.getLookups().subscribe(t=>{this.status=t.data.offerOrderStatuses},t=>{console.log(t)})}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetDistricts(t){this.districtService.getByCityId(t).subscribe(i=>{this.districts=i.data},i=>{console.log(i)})}GetChannels(){this.channelService.getDropDown().subscribe(t=>{this.channels=t.data},t=>{console.log(t)})}GetTeams(){this.teamService.getDropDown().subscribe(t=>{this.teams=t.data},t=>{console.log(t)})}GetTimes(){this.workTimeService.getDropDown().subscribe(t=>{this.workTimes=t.data},t=>{console.log(t)})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,u.Q)(this.notifier)).subscribe(i=>{i?this.alertService.success():this.alertService.error("general.message."+i)},i=>{this.alertService.error()})}mapRegisterForm(t){let i={...t};return i.employeeCode=0,i}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader("allLoader"),this.setDates(t.dates,"visitDateFrom","visitDateTo"),this.setDates(t.creationDates,"creationTimeFrom","creationTimeTo"),this.loadentities()}LoadSuccess(){this.ngxLoader.stopLoader("allLoader")}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems},this.loadentities()}configRoute(){this.routerActive.data.pipe((0,u.Q)(this.notifier)).subscribe(t=>{this.entities=t.data,this.pagination.totalItems=t.data?.totalItems},()=>{this.alertService.error()})}mapExcel(){let t=[];return this.entities.forEach(i=>{t.push({"Order Code":i.orderCode,"Created Date":i.createdDate,"City Name":i.cityName,"District Name":i.districtName?i.districtName:"--",Status:this.translateService.instant(this.getTrnslate(i)),"Agent Name":i.agentName,Mobile:i.mobile,"Channel Name":i.channelName,"Assigned To":i.teamNames,Times:i.workTimes,"Visit Date":i.visitDate,Services:i.services})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}goRegister(){this.router.navigateByUrl("/managment/order/new")}goEdit(t){this.router.navigateByUrl("/managment/order/new")}getStatus(t){return 10==t.offerOrderStatus||20==t.offerOrderStatus?"bg-warning-subtle text-warning":30==t.offerOrderStatus?"bg-success-subtle text-success":40==t.offerOrderStatus?"bg-danger-subtle text-danger":50==t.offerOrderStatus?"bg-danger-success text-success":"bg-warning-subtle text-warning"}checkEdit(t){return!t.isCancel&&!t.isFinish}getTrnslate(t){return t.isCancel?"orderManagement.order.cancel":t.isFinish?"orderManagement.order.finish":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen?"orderManagement.order.reopen":t.isAssign?"orderManagement.order.assign":t.isConfirmed?"orderManagement.order.confirmed":t.isFree?"orderManagement.order.free":"orderManagement.order.new"}openModalClient(t,i,n="xl"){this.clientSelected=t.orderCode,this.orderSelected=t,this.isOrderEdit=!1,this.modalService.open(i,{centered:!0,size:n})}oncityChange(t){this.GetDistricts(t.code)}getTimes(t){return t?.split(",")}getServices(t){return t.split("#")}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}openEditOrderModal(t,i,n="md"){this.form={},this.isOrderEdit=!0,this.clientSelected=t,this.modalService.open(i,{centered:!0,size:n})}OpenOrderTimeLineModel(t,i,n="md"){this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(v.nX),e.rXU(h.c$),e.rXU(D),e.rXU(x.u),e.rXU(p.vh),e.rXU(f.eD),e.rXU(m.Bq),e.rXU(K.J),e.rXU(ne.n),e.rXU(ie.G),e.rXU(W.V),e.rXU(P.h),e.rXU(re.m),e.rXU(se.l),e.rXU(v.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-all-sales-order"]],features:[e.Vt3],decls:45,vars:37,consts:[["tableMaster",""],["deleteModal",""],["clientProfile",""],["orderViewModel",""],["orderModel",""],["OrderTimeLineModel",""],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"reset","search","exportXlsx","addNew","showAdd","showExport","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","id","name","id",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","search","id","clientName","name","clientName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],[2,"width",".2%"],["translate","",2,"width",".5%"],["pSortableColumn","id","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["pSortableColumn","creationTime","translate","",2,"width","12%"],["pSortableColumn","status","translate","",2,"width","6%"],["pSortableColumn","clientId","translate","",2,"width","10%"],["translate","",2,"width","8%"],["pSortableColumn","clientVisitDate","translate","",2,"width","10%"],["pSortableColumn","totalQuantity","translate","",2,"width","8%"],["pSortableColumn","totalDiscount","translate","",2,"width","8%"],["pSortableColumn","netPrice","translate","",2,"width","8%"],["translate","",2,"width","10%"],[1,"fs-5"],["type","button","pRipple","",1,"border-0","p-button-text","p-button-rounded","p-button-plain",3,"pRowToggler","ngClass"],[3,"click"],[1,"code-pointer"],[1,"badge","bg-success-subtle","text-success"],[3,"translate"],[1,"badge","bg-primary-subtle","text-primary","my-1"],[1,"ri-history-fill","d-inline","text-primary","fs-16","align-middle","me-1",3,"click"],["type","button","class","btn px-4 w-auto btn-sm btn-primary btn-label  waves-effect waves-light rounded-pill",3,"click",4,"ngIf"],["type","button",1,"btn","px-4","w-auto","btn-sm","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"click"],[1,"ri-edit-2-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.edit"],["colspan","17"],["dataKey","id"],[1,"bg-light"],["translate","sales.salesOrder.itemName",2,"width","10%"],["translate","sales.salesOrder.unit",2,"width","6%"],["translate","sales.salesOrder.clientQuantity",2,"width","8%"],["translate","sales.salesOrder.approvedQuantity",2,"width","8%"],["translate","sales.salesOrder.discountType",2,"width","5%"],["translate","sales.salesOrder.discount",2,"width","5%"],["translate","sales.salesOrder.price",2,"width","5%"],[4,"ngFor","ngForOf"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"deleteConfirm","dismiss"],["","clientSelected"],[3,"dismiss","orderDetails"],[3,"isOrderEdit","isInner","orderCode"],[3,"dismiss","orderSelected"]],template:function(i,n){if(1&i){const s=e.RV6();e.j41(0,"div",6)(1,"div",7)(2,"div",8),e.nrm(3,"ngx-ui-loader",9),e.j41(4,"base-filter",10),e.bIt("reset",function(){return e.eBV(s),e.Njj(n.onReset())})("search",function(){return e.eBV(s),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(s),e.Njj(n.onExportXlsx())})("addNew",function(){return e.eBV(s),e.Njj(n.goRegister())}),e.qex(5,11),e.j41(6,"div",12)(7,"div",13)(8,"input",14),e.nI1(9,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(s),e.DH7(n.pagination.id,l)||(n.pagination.id=l),e.Njj(l)}),e.k0s(),e.nrm(10,"i",15),e.k0s()(),e.j41(11,"div",12)(12,"div",13)(13,"input",16),e.nI1(14,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(s),e.DH7(n.pagination.clientName,l)||(n.pagination.clientName=l),e.Njj(l)}),e.k0s(),e.nrm(15,"i",15),e.k0s()(),e.j41(16,"div",12)(17,"div",13)(18,"ng-select",17),e.nI1(19,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(s),e.DH7(n.pagination.status,l)||(n.pagination.status=l),e.Njj(l)}),e.k0s()()(),e.j41(20,"div",12)(21,"input",18),e.nI1(22,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(s),e.DH7(n.searchForm.dates,l)||(n.searchForm.dates=l),e.Njj(l)}),e.k0s()(),e.j41(23,"div",12)(24,"input",18),e.nI1(25,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(s),e.DH7(n.searchForm.creationDates,l)||(n.searchForm.creationDates=l),e.Njj(l)}),e.k0s()(),e.bVm(),e.k0s(),e.j41(26,"div",19)(27,"div",20)(28,"p-table",21,0),e.bIt("onLazyLoad",function(l){return e.eBV(s),e.Njj(n.tableChange(l))})("selectionChange",function(l){return e.eBV(s),e.Njj(n.onSelectionChange(l))}),e.DNE(30,Mt,30,0,"ng-template",22)(31,Nt,33,23,"ng-template",23)(32,Et,15,1,"ng-template",24),e.k0s()(),e.DNE(33,Gt,2,0,"div",25)(34,Dt,6,8,"div",26),e.k0s()()()(),e.DNE(35,Vt,1,0,"ng-template",null,1,e.C5r)(37,Lt,1,0,"ng-template",null,2,e.C5r)(39,$t,1,1,"ng-template",null,3,e.C5r)(41,Xt,1,3,"ng-template",null,4,e.C5r)(43,Bt,1,1,"ng-template",null,5,e.C5r)}2&i&&(e.R7$(3),e.Y8G("loaderId","allLoader"),e.R7$(),e.Y8G("showAdd",!1)("showExport",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(9,27,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.id),e.R7$(5),e.FS9("placeholder",e.bMT(14,29,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.clientName),e.R7$(5),e.FS9("placeholder",e.bMT(19,31,"orderManagement.order.status")),e.Y8G("items",n.status)("multiple",!1),e.R50("ngModel",n.pagination.status),e.R7$(3),e.FS9("placeholder",e.bMT(22,33,"orderManagement.order.visitDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.dates),e.R7$(3),e.FS9("placeholder",e.bMT(25,35,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(4),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(5),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[p.YU,p.Sq,p.bT,c.me,c.Q0,c.BC,c.vS,m.s5,A.kL,z.b,le.L,X.w,Q.p,J.g,Rt.t,h.Mm,b.XI,H.Ei,b.Tg,b.FP,f.Cv,Y.vr,G.m,p.vh,h.D9],encapsulation:2})}}return r})();function At(r,o){1&r&&(e.j41(0,"tr",29),e.nrm(1,"th",30),e.j41(2,"th",31),e.EFF(3,"#"),e.k0s(),e.j41(4,"th",32),e.nrm(5,"i",33),e.EFF(6," orderManagement.order.orderCode "),e.k0s(),e.j41(7,"th",34),e.nrm(8,"i",33),e.EFF(9," orderManagement.order.creation "),e.k0s(),e.j41(10,"th",35),e.EFF(11," orderManagement.order.status "),e.k0s(),e.j41(12,"th",36),e.nrm(13,"i",33),e.EFF(14," orderManagement.order.agentName "),e.k0s(),e.j41(15,"th",37),e.nrm(16,"i",33),e.EFF(17," sales.salesOrder.clientVisitDate "),e.k0s(),e.j41(18,"th",38),e.nrm(19,"i",33),e.EFF(20," sales.salesOrder.totalQuantity "),e.k0s(),e.j41(21,"th",39),e.nrm(22,"i",33),e.EFF(23," sales.salesOrder.totalDiscount "),e.k0s(),e.j41(24,"th",40),e.EFF(25," orderManagement.order.totalTax "),e.k0s(),e.j41(26,"th",41),e.nrm(27,"i",33),e.EFF(28," sales.salesOrder.netPrice "),e.k0s(),e.nrm(29,"th",42),e.k0s())}function Yt(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",57),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,s=e.XpG(),a=e.sdS(42);return e.Njj(s.openEditOrderModal(n.id,a,"xxl"))}),e.nrm(2,"i",58),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"general.action.edit"))}function Pt(r,o){if(1&r){const t=e.RV6();e.j41(0,"tr",43)(1,"td"),e.nrm(2,"button",44),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td",45),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(),a=e.sdS(40);return e.Njj(s.openModalClient(n,a,"lg"))}),e.j41(6,"bdi",46),e.EFF(7),e.k0s()(),e.j41(8,"td")(9,"span",47),e.EFF(10),e.k0s(),e.EFF(11),e.nI1(12,"date"),e.k0s(),e.j41(13,"td")(14,"span"),e.nrm(15,"span",48),e.k0s()(),e.j41(16,"td",45),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(),a=e.sdS(38);return e.Njj(s.openModalClient(n,a))}),e.j41(17,"span",49),e.EFF(18),e.k0s()(),e.j41(19,"td"),e.EFF(20),e.nI1(21,"date"),e.k0s(),e.j41(22,"td"),e.EFF(23),e.k0s(),e.j41(24,"td"),e.EFF(25),e.k0s(),e.j41(26,"td"),e.EFF(27),e.k0s(),e.j41(28,"td"),e.EFF(29),e.k0s(),e.j41(30,"td")(31,"div",50)(32,"i",51),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(),a=e.sdS(44);return e.Njj(s.OpenOrderTimeLineModel(n,a,"lg"))}),e.k0s(),e.DNE(33,Yt,3,3,"button",52),e.j41(34,"button",53),e.nI1(35,"translate"),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(),a=e.sdS(32);return e.Njj(s.openModal(n.id,a))}),e.nrm(36,"i",54),e.k0s(),e.j41(37,"button",55),e.nI1(38,"translate"),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(),a=e.sdS(34);return e.Njj(s.openModal(n.id,a))}),e.nrm(39,"i",56),e.k0s()()()()}if(2&r){const t=o.$implicit,i=o.rowIndex,n=o.expanded,s=e.XpG();e.R7$(2),e.Y8G("pRowToggler",t)("ngClass",n?" ri-arrow-down-s-line":"  ri-arrow-up-s-line"),e.R7$(2),e.JRh(i+1),e.R7$(3),e.SpI("#SO#",t.id,""),e.R7$(3),e.SpI("",t.creatorName," "),e.R7$(),e.SpI(" ",e.i5U(12,19,t.creationTime,"yyyy-MM-dd")," "),e.R7$(3),e.ZvI("badge ",s.getStatus(t),""),e.R7$(),e.FS9("translate","sales.salesOrder."+t.offerOrderStatusValue),e.R7$(3),e.SpI("",t.clientName," "),e.R7$(2),e.SpI(" ",e.i5U(21,22,t.clientVisitDate,"yyyy-MM-dd"),""),e.R7$(3),e.JRh(t.totalQuantity),e.R7$(2),e.JRh(t.totalDiscount),e.R7$(2),e.JRh(t.totalTax),e.R7$(2),e.JRh(t.netPrice),e.R7$(4),e.Y8G("ngIf",s.checkEdit(t)),e.R7$(),e.FS9("pTooltip",e.bMT(35,25,"general.action.proceed")),e.R7$(3),e.FS9("pTooltip",e.bMT(38,27,"general.action.cancel"))}}function zt(r,o){1&r&&(e.j41(0,"tr"),e.nrm(1,"th",63)(2,"th",64)(3,"th",65)(4,"th",66)(5,"th",67)(6,"th",68)(7,"th",69)(8,"th",70),e.k0s())}function Qt(r,o){if(1&r&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&r){const t=e.XpG().$implicit;e.R7$(),e.JRh(t.approvedQuantity)}}function Jt(r,o){if(1&r){const t=e.RV6();e.j41(0,"input",75),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG().$implicit;return e.DH7(s.approvedQuantity,n)||(s.approvedQuantity=n),e.Njj(n)}),e.k0s()}if(2&r){const t=e.XpG().$implicit;e.R50("ngModel",t.approvedQuantity)}}function Ht(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",53),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,s=e.XpG(2);return e.Njj(s.saveQuantity(n.id,n))}),e.nrm(2,"i",54),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"general.action.save"))}function qt(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",57),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit;return e.Njj(n.isEdit=!n.isEdit)}),e.nrm(2,"i",58),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"general.action.edit"))}function Zt(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",55),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit;return e.Njj(n.isEdit=!1)}),e.nrm(2,"i",56),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"general.action.cancel"))}function Wt(r,o){if(1&r&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.DNE(8,Qt,2,1,"span",71)(9,Jt,1,1,"input",72),e.k0s(),e.j41(10,"td"),e.EFF(11),e.nI1(12,"translate"),e.k0s(),e.j41(13,"td"),e.EFF(14),e.k0s(),e.j41(15,"td"),e.EFF(16),e.k0s(),e.j41(17,"td"),e.DNE(18,Ht,3,3,"button",73)(19,qt,3,3,"button",52)(20,Zt,3,3,"button",74),e.k0s()()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t.itemName),e.R7$(2),e.JRh(t.unitName),e.R7$(2),e.JRh(t.clientQuantity),e.R7$(2),e.Y8G("ngIf",!t.isEdit),e.R7$(),e.Y8G("ngIf",t.isEdit),e.R7$(2),e.JRh(e.bMT(12,11,"sales.salesOrder."+t.discountTypeValue)),e.R7$(3),e.SpI(" ",t.discount," "),e.R7$(2),e.JRh(t.price),e.R7$(2),e.Y8G("ngIf",t.isEdit),e.R7$(),e.Y8G("ngIf",!t.isEdit),e.R7$(),e.Y8G("ngIf",t.isEdit)}}function Kt(r,o){1&r&&(e.j41(0,"tr"),e.nrm(1,"td",76),e.k0s())}function en(r,o){if(1&r&&(e.j41(0,"tr")(1,"td",59)(2,"div",60)(3,"p-table",61),e.DNE(4,zt,9,0,"ng-template",24)(5,Wt,21,13,"ng-template",25)(6,Kt,2,0,"ng-template",62),e.k0s()()()()),2&r){const t=o.$implicit;e.R7$(3),e.Y8G("value",t.offerOrderDetails)}}function tn(r,o){1&r&&(e.j41(0,"div",77),e.EFF(1," general.table.noData "),e.k0s())}function nn(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",78)(1,"div",79),e.nrm(2,"ngb-pagination-info",80),e.j41(3,"table-length",81),e.bIt("lengthChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",82)(5,"ngb-pagination",83),e.bIt("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.pagination.pageNumber,n)||(s.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function rn(r,o){if(1&r){const t=e.RV6();e.j41(0,"form",84,8),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.SubmitOrder())}),e.nrm(2,"ngx-ui-loader",85),e.j41(3,"div",86)(4,"div",87)(5,"button",88),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"div",89)(7,"div",90),e.nrm(8,"lord-icon",91),e.j41(9,"div",92),e.nrm(10,"h3",93)(11,"p",94),e.k0s()(),e.j41(12,"div",95),e.nrm(13,"button",96),e.j41(14,"button",97),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}function sn(r,o){if(1&r){const t=e.RV6();e.j41(0,"form",84,8),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.cancelOrder())}),e.nrm(2,"ngx-ui-loader",85),e.j41(3,"div",86)(4,"div",87)(5,"button",88),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"div",89)(7,"div",90),e.nrm(8,"lord-icon",91),e.j41(9,"div",92),e.nrm(10,"h3",93)(11,"p",94),e.k0s()(),e.j41(12,"div",95),e.nrm(13,"button",96),e.j41(14,"button",97),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}function an(r,o){if(1&r){const t=e.RV6();e.j41(0,"delete-modal",98),e.bIt("deleteConfirm",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.DeleteConfirm())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}}function on(r,o){}function ln(r,o){if(1&r){const t=e.RV6();e.j41(0,"app-all-orders-details",99),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderDetails",t.orderSelected)}}function dn(r,o){if(1&r&&e.nrm(0,"order-operation",100),2&r){const t=e.XpG();e.Y8G("isOrderEdit",t.isOrderEdit)("isInner",!0)("orderCode",t.clientSelected)}}function cn(r,o){if(1&r){const t=e.RV6();e.j41(0,"order-timeline",101),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderSelected",t.orderSelected)}}let mn=(()=>{class r extends U.w{constructor(t,i,n,s,a,l,C,j,T,S,I,N,w,E,V){super(t,i,C,n,s,a,l),this.baseService=n,this.authDaamService=j,this.teamService=T,this.workTimeService=S,this.excelService=I,this.cityService=N,this.districtService=w,this.channelService=E,this.router=V,this.title="sales.salesOrder.newOrders",this.titleOperation="sales.salesOrder.newOrders",this.keySelected="",this.assignUsers=[],this.times=[],this.employees=[],this.searchForm={},this.isResolveList=!0,this.employeeTypes=[{id:1,name:"employeeTeam"},{id:2,name:"managment"},{id:3,name:"customerService"}],this.employeeGroups=[],this.activeindex="2",this.active=2,this.formPassword={},this.roles=[],this.teams=[],this.workTimes=[],this.userTypes=[],this.actives=[{id:!0,name:"active"},{id:!1,name:"noActive"}],this.clientSelected=0,this.cities=[],this.districts=[],this.channels=[],this.status=[],this.countLoad=2,this.isOrderEdit=!1,this.orderSelected={},this.users=[],this.setDates=(_,y,F)=>{if(_?.from||_?.to){const $=_.to||_.from;this.pagination[y]=this.datePipe.transform(_.from||_.to,"yyyy-MM-ddT00:00:00"),this.pagination[F]=this.datePipe.transform($,"yyyy-MM-ddT23:59:59.999")}else this.pagination[y]=null,this.pagination[F]=null},this.loadentities(),this.GetCities(),this.GetChannels(),this.GetTeams(),this.GetTimes(),this.status=[{name:"None",nameAr:"\u0644\u0627 \u0634\u0626",id:0},{name:"Is Review",nameAr:"\u062a\u0645\u062a \u0627\u0644\u0645\u0631\u0627\u062c\u0639\u0629",id:1},{name:"Is Confirmed",nameAr:"\u062a\u0645 \u0627\u0644\u062a\u0623\u0643\u064a\u062f",id:2},{name:"Is Free",nameAr:"\u0645\u062c\u0627\u0646\u064a",id:3},{name:"Is Reopen",nameAr:"\u062a\u0645\u062a \u0625\u0639\u0627\u062f\u0629 \u0641\u062a\u062d\u0647",id:4},{name:"Is Finish",nameAr:"\u0627\u0646\u062a\u0647\u0649",id:5},{name:"Is Cancel",nameAr:"\u062a\u0645 \u0627\u0644\u0625\u0644\u063a\u0627\u0621",id:6},{name:"Is Assign",nameAr:"\u062a\u0645 \u062a\u0639\u064a\u064a\u0646\u0647",id:7},{name:"Is Urgent",nameAr:"\u0639\u0627\u062c\u0644",id:8},{name:"New",nameAr:"\u062c\u062f\u064a\u062f",id:9}]}loadentities(){this.countLoad=this.countLoad+1,(!this.isResolveList||1!==this.countLoad)&&(this.pagination.status=10,this.baseService.get(this.pagination).pipe((0,u.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader(g.a7),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader(g.a7),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}SubmitOrder(){this.ngxLoader.startLoader(g.Fq),console.log(this.operationId),this.baseService.changStatus({id:this.operationId,status:30}).pipe((0,R.O)(),(0,M.c)(this.mainDelay),(0,O.Z)(),(0,u.Q)(this.notifier),(0,k.j)(()=>this.ngxLoader.stopLoader(g.Fq))).subscribe({next:i=>{this.modalService.dismissAll(),this.loadentities(),this.alertService.success()}})}cancelOrder(){this.ngxLoader.startLoader(g.Fq),console.log(this.operationId),this.baseService.changStatus({id:this.operationId,status:40}).pipe((0,R.O)(),(0,M.c)(this.mainDelay),(0,O.Z)(),(0,u.Q)(this.notifier),(0,k.j)(()=>this.ngxLoader.stopLoader(g.Fq))).subscribe({next:i=>{this.modalService.dismissAll(),this.loadentities(),this.alertService.success()}})}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetDistricts(t){this.districtService.getByCityId(t).subscribe(i=>{this.districts=i.data},i=>{console.log(i)})}GetChannels(){this.channelService.getDropDown().subscribe(t=>{this.channels=t.data},t=>{console.log(t)})}GetTeams(){this.teamService.getDropDown().subscribe(t=>{this.teams=t.data},t=>{console.log(t)})}GetTimes(){this.workTimeService.getDropDown().subscribe(t=>{this.workTimes=t.data},t=>{console.log(t)})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,u.Q)(this.notifier)).subscribe(i=>{i?this.alertService.success():this.alertService.error("general.message."+i)},i=>{this.alertService.error()})}mapRegisterForm(t){let i={...t};return i.employeeCode=0,i}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader("allLoader"),this.setDates(t.dates,"visitDateFrom","visitDateTo"),this.setDates(t.creationDates,"creationTimeFrom","creationTimeTo"),this.loadentities()}LoadSuccess(){this.ngxLoader.stopLoader("allLoader")}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems}}mapExcel(){let t=[];return this.entities.forEach(i=>{t.push({"Order Code":i.orderCode,"Created Date":i.createdDate,"City Name":i.cityName,"District Name":i.districtName?i.districtName:"--",Status:this.translateService.instant(this.getTrnslate(i)),"Agent Name":i.agentName,Mobile:i.mobile,"Channel Name":i.channelName,"Assigned To":i.teamNames,Times:i.workTimes,"Visit Date":i.visitDate,Services:i.services})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}goRegister(){this.router.navigateByUrl("/managment/order/new")}goEdit(t){this.router.navigateByUrl("/managment/order/new")}getStatus(t){return 10==t.offerOrderStatus||20==t.offerOrderStatus?"bg-warning-subtle text-warning":30==t.offerOrderStatus?"bg-success-subtle text-success":40==t.offerOrderStatus?"bg-danger-subtle text-danger":50==t.offerOrderStatus?"bg-danger-success text-success":"bg-warning-subtle text-warning"}checkEdit(t){return!t.isCancel&&!t.isFinish}getTrnslate(t){return t.isCancel?"orderManagement.order.cancel":t.isFinish?"orderManagement.order.finish":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen?"orderManagement.order.reopen":t.isAssign?"orderManagement.order.assign":t.isConfirmed?"orderManagement.order.confirmed":t.isFree?"orderManagement.order.free":"orderManagement.order.new"}openModalClient(t,i,n="xl"){this.clientSelected=t.orderCode,this.orderSelected=t,this.isOrderEdit=!1,this.modalService.open(i,{centered:!0,size:n})}oncityChange(t){this.GetDistricts(t.code)}getTimes(t){return t?.split(",")}getServices(t){return t.split("#")}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}openEditOrderModal(t,i,n="md"){this.form={},this.isOrderEdit=!0,this.clientSelected=t,this.modalService.open(i,{centered:!0,size:n})}OpenOrderTimeLineModel(t,i,n="md"){this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}saveQuantity(t,i){this.baseService.UpdateQuantity({id:t,quantity:i.approvedQuantity}).pipe((0,u.Q)(this.notifier)).subscribe(s=>{s.success?(this.alertService.success(),this.loadentities()):this.alertService.error("general.message."+s)},s=>{this.alertService.error()}),console.log("Saved Quantity:",i.approvedQuantity)}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(v.nX),e.rXU(h.c$),e.rXU(D),e.rXU(x.u),e.rXU(p.vh),e.rXU(f.eD),e.rXU(m.Bq),e.rXU(K.J),e.rXU(ne.n),e.rXU(ie.G),e.rXU(W.V),e.rXU(P.h),e.rXU(re.m),e.rXU(se.l),e.rXU(v.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-new-order"]],features:[e.Vt3],decls:45,vars:31,consts:[["tableMaster",""],["SubmitOrderModal",""],["cancelOrderModal",""],["deleteModal",""],["clientProfile",""],["orderViewModel",""],["orderModel",""],["OrderTimeLineModel",""],["formEntity","ngForm"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"reset","search","exportXlsx","addNew","showAdd","showExport","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","id","name","id",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","search","id","clientName","name","clientName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],[2,"width",".2%"],["translate","",2,"width",".5%"],["pSortableColumn","id","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["pSortableColumn","creationTime","translate","",2,"width","12%"],["pSortableColumn","status","translate","",2,"width","6%"],["pSortableColumn","clientId","translate","",2,"width","10%"],["pSortableColumn","clientVisitDate","translate","",2,"width","8%"],["pSortableColumn","totalQuantity","translate","",2,"width","8%"],["pSortableColumn","totalDiscount","translate","",2,"width","7%"],["translate","",2,"width","6%"],["pSortableColumn","netPrice","translate","",2,"width","6%"],["translate","",2,"width","10%"],[1,"fs-5"],["type","button","pRipple","",1,"border-0","p-button-text","p-button-rounded","p-button-plain",3,"pRowToggler","ngClass"],[3,"click"],[1,"code-pointer"],[1,"badge","bg-success-subtle","text-success"],[3,"translate"],[1,"badge","bg-primary-subtle","text-primary","my-1"],[1,"d-inline"],[1,"ri-history-fill","d-inline","text-primary","fs-16","align-middle","me-1",3,"click"],["class","btn btn-sm btn-primary edit-list mx-1","tooltipPosition","top",3,"pTooltip","click",4,"ngIf"],["tooltipPosition","top",1,"btn","btn-sm","btn-success","edit-list","mx-1",3,"click","pTooltip"],[1,"ri-check-double-fill","align-bottom"],["tooltipPosition","top",1,"btn","btn-sm","btn-danger","edit-list","mx-1",3,"click","pTooltip"],[1,"ri-close-fill","align-bottom"],["tooltipPosition","top",1,"btn","btn-sm","btn-primary","edit-list","mx-1",3,"click","pTooltip"],[1,"ri-edit-2-line","align-bottom"],["colspan","17"],[1,"table-detail"],["dataKey","id",3,"value"],["pTemplate","emptymessage"],["translate","sales.salesOrder.itemName",2,"width","10%"],["translate","sales.salesOrder.unit",2,"width","6%"],["translate","sales.salesOrder.clientQuantity",2,"width","8%"],["translate","sales.salesOrder.approvedQuantity",2,"width","8%"],["translate","sales.salesOrder.discountType",2,"width","5%"],["translate","sales.salesOrder.discount",2,"width","5%"],["translate","sales.salesOrder.price",2,"width","5%"],[2,"width","5%"],[4,"ngIf"],["type","number","class","form-control fs-6",3,"ngModel","ngModelChange",4,"ngIf"],["class","btn btn-sm btn-success edit-list mx-1","tooltipPosition","top",3,"pTooltip","click",4,"ngIf"],["class","btn btn-sm btn-danger edit-list mx-1","tooltipPosition","top",3,"pTooltip","click",4,"ngIf"],["type","number",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["colspan","8"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"ngSubmit"],[3,"hasProgressBar","fgsType","loaderId"],[1,"modal-content"],[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mt-2","text-center"],["src","https://cdn.lordicon.com/gdfrsvpt.json","stroke","bold","state","hover-oscillate","trigger","loop","colors","primary:#f7b84b,secondary:#f06548",2,"width","130px","height","130px"],[1,"pt-2","fs-15","mx-4","mx-sm-5"],["translate","orderManagement.order.AreYouSureMessage"],[1,"text-muted","mx-4","mb-0"],[1,"d-flex","gap-2","justify-content-center","mt-4","mb-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],[3,"deleteConfirm","dismiss"],[3,"dismiss","orderDetails"],[3,"isOrderEdit","isInner","orderCode"],[3,"dismiss","orderSelected"]],template:function(i,n){if(1&i){const s=e.RV6();e.j41(0,"div",9)(1,"div",10)(2,"div",11),e.nrm(3,"ngx-ui-loader",12),e.j41(4,"base-filter",13),e.bIt("reset",function(){return e.eBV(s),e.Njj(n.onReset())})("search",function(){return e.eBV(s),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(s),e.Njj(n.onExportXlsx())})("addNew",function(){return e.eBV(s),e.Njj(n.goRegister())}),e.qex(5,14),e.j41(6,"div",15)(7,"div",16)(8,"input",17),e.nI1(9,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(s),e.DH7(n.pagination.id,l)||(n.pagination.id=l),e.Njj(l)}),e.k0s(),e.nrm(10,"i",18),e.k0s()(),e.j41(11,"div",15)(12,"div",16)(13,"input",19),e.nI1(14,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(s),e.DH7(n.pagination.clientName,l)||(n.pagination.clientName=l),e.Njj(l)}),e.k0s(),e.nrm(15,"i",18),e.k0s()(),e.j41(16,"div",15)(17,"input",20),e.nI1(18,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(s),e.DH7(n.searchForm.dates,l)||(n.searchForm.dates=l),e.Njj(l)}),e.k0s()(),e.j41(19,"div",15)(20,"input",20),e.nI1(21,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(s),e.DH7(n.searchForm.creationDates,l)||(n.searchForm.creationDates=l),e.Njj(l)}),e.k0s()(),e.bVm(),e.k0s(),e.j41(22,"div",21)(23,"div",22)(24,"p-table",23,0),e.bIt("onLazyLoad",function(l){return e.eBV(s),e.Njj(n.tableChange(l))})("selectionChange",function(l){return e.eBV(s),e.Njj(n.onSelectionChange(l))}),e.DNE(26,At,30,0,"ng-template",24)(27,Pt,40,29,"ng-template",25)(28,en,7,1,"ng-template",26),e.k0s()(),e.DNE(29,tn,2,0,"div",27)(30,nn,6,8,"div",28),e.k0s()()()(),e.DNE(31,rn,15,3,"ng-template",null,1,e.C5r)(33,sn,15,3,"ng-template",null,2,e.C5r)(35,an,1,0,"ng-template",null,3,e.C5r)(37,on,0,0,"ng-template",null,4,e.C5r)(39,ln,1,1,"ng-template",null,5,e.C5r)(41,dn,1,3,"ng-template",null,6,e.C5r)(43,cn,1,1,"ng-template",null,7,e.C5r)}2&i&&(e.R7$(3),e.Y8G("loaderId","newLoader"),e.R7$(),e.Y8G("showAdd",!1)("showExport",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(9,23,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.id),e.R7$(5),e.FS9("placeholder",e.bMT(14,25,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.clientName),e.R7$(4),e.FS9("placeholder",e.bMT(18,27,"orderManagement.order.visitDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.dates),e.R7$(3),e.FS9("placeholder",e.bMT(21,29,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(4),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(5),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[p.YU,p.bT,c.qT,c.me,c.Q0,c.BC,c.cb,c.vS,c.cV,m.s5,A.kL,z.b,le.L,X.w,Q.p,J.g,h.Mm,b.XI,H.Ei,b.Tg,b.FP,f.Cv,G.m,ee.m,p.vh,h.D9],encapsulation:2})}}return r})();const pn=r=>({"card-active":r});function gn(r,o){1&r&&(e.j41(0,"tr",27),e.nrm(1,"th",28),e.j41(2,"th",29),e.EFF(3,"#"),e.k0s(),e.j41(4,"th",30),e.nrm(5,"i",31),e.EFF(6," orderManagement.order.orderCode "),e.k0s(),e.j41(7,"th",32),e.nrm(8,"i",31),e.EFF(9," orderManagement.order.creation "),e.k0s(),e.j41(10,"th",33),e.nrm(11,"i",31),e.EFF(12," orderManagement.order.agentName "),e.k0s(),e.j41(13,"th",34),e.nrm(14,"i",31),e.EFF(15," sales.salesOrder.clientVisitDate "),e.k0s(),e.j41(16,"th",35),e.nrm(17,"i",31),e.EFF(18," sales.salesOrder.shippingTruckName "),e.k0s(),e.j41(19,"th",36),e.nrm(20,"i",31),e.EFF(21," sales.salesOrder.totalQuantity "),e.k0s(),e.j41(22,"th",37),e.nrm(23,"i",31),e.EFF(24," sales.salesOrder.totalDiscount "),e.k0s(),e.j41(25,"th",38),e.EFF(26," orderManagement.order.totalTax "),e.k0s(),e.j41(27,"th",39),e.nrm(28,"i",31),e.EFF(29," sales.salesOrder.netPrice "),e.k0s(),e.nrm(30,"th",40),e.k0s())}function hn(r,o){if(1&r){const t=e.RV6();e.j41(0,"tr",41)(1,"td"),e.nrm(2,"button",42),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td")(6,"bdi",43),e.EFF(7),e.k0s()(),e.j41(8,"td")(9,"span",44),e.EFF(10),e.k0s(),e.EFF(11),e.nI1(12,"date"),e.k0s(),e.j41(13,"td")(14,"span",45),e.EFF(15),e.k0s()(),e.j41(16,"td"),e.EFF(17),e.nI1(18,"date"),e.k0s(),e.j41(19,"td"),e.EFF(20),e.k0s(),e.j41(21,"td"),e.EFF(22),e.k0s(),e.j41(23,"td"),e.EFF(24),e.k0s(),e.j41(25,"td"),e.EFF(26),e.k0s(),e.j41(27,"td"),e.EFF(28),e.k0s(),e.j41(29,"td")(30,"div",46)(31,"i",47),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(),a=e.sdS(38);return e.Njj(s.OpenOrderTimeLineModel(n,a,"lg"))}),e.k0s(),e.j41(32,"button",48),e.nI1(33,"translate"),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(),a=e.sdS(40);return e.Njj(s.openModal(n.id,a))}),e.nrm(34,"i",49),e.k0s(),e.j41(35,"button",50),e.nI1(36,"translate"),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(),a=e.sdS(34);return e.Njj(s.openShippingModal(n.id,a,"lg"))}),e.nrm(37,"i",51),e.k0s(),e.j41(38,"button",52),e.nI1(39,"translate"),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(),a=e.sdS(32);return e.Njj(s.openModal(n.id,a))}),e.nrm(40,"i",53),e.k0s()()()()}if(2&r){const t=o.$implicit,i=o.rowIndex,n=o.expanded;e.R7$(2),e.Y8G("pRowToggler",t)("ngClass",n?" ri-arrow-down-s-line":"  ri-arrow-up-s-line"),e.R7$(2),e.JRh(i+1),e.R7$(3),e.SpI("#SO#",t.id,""),e.R7$(3),e.SpI("",t.creatorName," "),e.R7$(),e.SpI(" ",e.i5U(12,16,t.creationTime,"yyyy-MM-dd")," "),e.R7$(4),e.SpI("",t.clientName," "),e.R7$(2),e.SpI(" ",e.i5U(18,19,t.acutalVisitDate,"yyyy-MM-dd"),""),e.R7$(3),e.JRh(t.shippingTruckName),e.R7$(2),e.JRh(t.totalQuantity),e.R7$(2),e.JRh(t.totalDiscount),e.R7$(2),e.JRh(t.totalTax),e.R7$(2),e.JRh(t.netPrice),e.R7$(4),e.FS9("pTooltip",e.bMT(33,22,"general.action.proceed")),e.R7$(3),e.FS9("pTooltip",e.bMT(36,24,"sales.salesOrder.shipping")),e.R7$(3),e.FS9("pTooltip",e.bMT(39,26,"general.action.cancel"))}}function un(r,o){1&r&&(e.j41(0,"tr"),e.nrm(1,"th",58)(2,"th",59)(3,"th",60)(4,"th",61)(5,"th",62)(6,"th",63)(7,"th",64),e.k0s())}function _n(r,o){if(1&r&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td")(8,"span"),e.EFF(9),e.k0s()(),e.j41(10,"td"),e.EFF(11),e.nI1(12,"translate"),e.k0s(),e.j41(13,"td"),e.EFF(14),e.k0s(),e.j41(15,"td"),e.EFF(16),e.k0s()()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t.itemName),e.R7$(2),e.JRh(t.unitName),e.R7$(2),e.JRh(t.clientQuantity),e.R7$(3),e.JRh(t.approvedQuantity),e.R7$(2),e.JRh(e.bMT(12,7,"sales.salesOrder."+t.discountTypeValue)),e.R7$(3),e.SpI(" ",t.discount," "),e.R7$(2),e.JRh(t.price)}}function fn(r,o){1&r&&(e.j41(0,"tr"),e.nrm(1,"td",65),e.k0s())}function bn(r,o){if(1&r&&(e.j41(0,"tr")(1,"td",54)(2,"div",55)(3,"p-table",56),e.DNE(4,un,8,0,"ng-template",22)(5,_n,17,9,"ng-template",23)(6,fn,2,0,"ng-template",57),e.k0s()()()()),2&r){const t=o.$implicit;e.R7$(3),e.Y8G("value",t.offerOrderDetails)}}function vn(r,o){1&r&&(e.j41(0,"div",66),e.EFF(1," general.table.noData "),e.k0s())}function Cn(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",67)(1,"div",68),e.nrm(2,"ngb-pagination-info",69),e.j41(3,"table-length",70),e.bIt("lengthChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",71)(5,"ngb-pagination",72),e.bIt("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.pagination.pageNumber,n)||(s.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function Sn(r,o){if(1&r){const t=e.RV6();e.j41(0,"form",73,6),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.cancelOrder())}),e.nrm(2,"ngx-ui-loader",74),e.j41(3,"div",75)(4,"div",76)(5,"button",77),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"div",78)(7,"div",79),e.nrm(8,"lord-icon",80),e.j41(9,"div",81),e.nrm(10,"h3",82)(11,"p",83),e.k0s()(),e.j41(12,"div",84),e.nrm(13,"button",85),e.j41(14,"button",86),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}function jn(r,o){if(1&r){const t=e.RV6();e.qex(0),e.j41(1,"div",102)(2,"div",103),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.selectTruck(n.id))}),e.j41(3,"div",19)(4,"p"),e.nrm(5,"i",51),e.k0s(),e.j41(6,"p"),e.EFF(7),e.k0s(),e.j41(8,"p"),e.EFF(9),e.k0s(),e.j41(10,"p")(11,"span",104)(12,"span"),e.EFF(13,"#SO#"),e.k0s(),e.j41(14,"span"),e.EFF(15),e.k0s()()()()()(),e.bVm()}if(2&r){const t=o.$implicit;e.R7$(2),e.Y8G("ngClass",e.eq3(4,pn,t.isSelected)),e.R7$(5),e.JRh(t.name),e.R7$(2),e.JRh(t.truckNumber),e.R7$(6),e.JRh(t.orderCount)}}function Tn(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",87)(1,"div",88)(2,"h4",89),e.nrm(3,"span",90),e.k0s(),e.j41(4,"button",91),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss("Cross click"))}),e.k0s()(),e.j41(5,"div",78),e.nrm(6,"ngx-ui-loader",74),e.j41(7,"form",92,6),e.bIt("submit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.updateTruck())}),e.j41(9,"div",7)(10,"div",93)(11,"label",94),e.EFF(12,"sales.salesOrder.acutalVisitDate"),e.k0s(),e.j41(13,"input",95),e.bIt("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.dateChangeModal(n))}),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.acutalVisitDate,n)||(s.form.acutalVisitDate=n),e.Njj(n)}),e.k0s()(),e.j41(14,"div",96),e.DNE(15,jn,16,6,"ng-container",97),e.k0s()(),e.j41(16,"div",98)(17,"button",99),e.nrm(18,"i",100)(19,"span",101),e.k0s()()()()()}if(2&r){const t=e.sdS(8),i=e.XpG();e.R7$(6),e.Y8G("hasProgressBar",!1)("fgsType",i.loaderOperationShap)("loaderId",i.operationLoader),e.R7$(7),e.R50("ngModel",i.form.acutalVisitDate),e.Y8G("altInput",!0)("convertModelValue",!0),e.R7$(2),e.Y8G("ngForOf",i.truncks),e.R7$(2),e.Y8G("disabled",!t.valid)}}function kn(r,o){if(1&r){const t=e.RV6();e.j41(0,"delete-modal",105),e.bIt("deleteConfirm",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.DeleteConfirm())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}}function In(r,o){if(1&r){const t=e.RV6();e.j41(0,"order-timeline",106),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderSelected",t.orderSelected)}}function yn(r,o){if(1&r){const t=e.RV6();e.j41(0,"form",73,6),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.SubmitOrder())}),e.nrm(2,"ngx-ui-loader",74),e.j41(3,"div",75)(4,"div",76)(5,"button",77),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"div",78)(7,"div",79),e.nrm(8,"lord-icon",80),e.j41(9,"div",81),e.nrm(10,"h3",82)(11,"p",83),e.k0s()(),e.j41(12,"div",84),e.nrm(13,"button",85),e.j41(14,"button",86),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}let Fn=(()=>{class r extends U.w{constructor(t,i,n,s,a,l,C,j,T,S,I,N,w,E,V){super(t,i,C,n,s,a,l),this.baseService=n,this.authDaamService=j,this.teamService=T,this.workTimeService=S,this.excelService=I,this.cityService=N,this.districtService=w,this.channelService=E,this.router=V,this.title="sales.salesOrder.sureOrder",this.titleOperation="sales.salesOrder.sureOrder",this.keySelected="",this.assignUsers=[],this.times=[],this.employees=[],this.searchForm={},this.isResolveList=!0,this.employeeTypes=[{id:1,name:"employeeTeam"},{id:2,name:"managment"},{id:3,name:"customerService"}],this.employeeGroups=[],this.activeindex="2",this.active=2,this.formPassword={},this.roles=[],this.teams=[],this.workTimes=[],this.userTypes=[],this.actives=[{id:!0,name:"active"},{id:!1,name:"noActive"}],this.clientSelected=0,this.cities=[],this.districts=[],this.channels=[],this.status=[],this.countLoad=2,this.isOrderEdit=!1,this.orderSelected={},this.users=[],this.truncks=[],this.setDates=(_,y,F)=>{if(_?.from||_?.to){const $=_.to||_.from;this.pagination[y]=this.datePipe.transform(_.from||_.to,"yyyy-MM-ddT00:00:00"),this.pagination[F]=this.datePipe.transform($,"yyyy-MM-ddT23:59:59.999")}else this.pagination[y]=null,this.pagination[F]=null},this.loadentities()}loadentities(){this.countLoad=this.countLoad+1,(!this.isResolveList||1!==this.countLoad)&&(this.pagination.status=30,this.baseService.get(this.pagination).pipe((0,u.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader(g.a7),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader(g.a7),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}SubmitOrder(){this.ngxLoader.startLoader(g.Fq),console.log(this.operationId),this.baseService.changStatus({id:this.operationId,status:60}).pipe((0,R.O)(),(0,M.c)(this.mainDelay),(0,O.Z)(),(0,u.Q)(this.notifier),(0,k.j)(()=>this.ngxLoader.stopLoader(g.Fq))).subscribe({next:i=>{this.modalService.dismissAll(),this.loadentities(),this.alertService.success()}})}cancelOrder(){this.ngxLoader.startLoader(g.Fq),console.log(this.operationId),this.baseService.changStatus({id:this.operationId,status:40}).pipe((0,R.O)(),(0,M.c)(this.mainDelay),(0,O.Z)(),(0,u.Q)(this.notifier),(0,k.j)(()=>this.ngxLoader.stopLoader(g.Fq))).subscribe({next:i=>{this.modalService.dismissAll(),this.loadentities(),this.alertService.success()}})}GetTruncks(t){this.truncks=[{id:12,name:"\u0634\u0627\u062d\u0646\u0647 1",number:"233-33",orderCount:"3",isSelected:!1},{id:13,name:"\u0634\u0627\u062d\u0646\u0647 2",number:"233-33",orderCount:"8",isSelected:!0},{id:14,name:"\u0634\u0627\u062d\u0646\u0647 3",number:"233-98",orderCount:"10",isSelected:!1}]}GetDistricts(t){this.districtService.getByCityId(t).subscribe(i=>{this.districts=i.data},i=>{console.log(i)})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,u.Q)(this.notifier)).subscribe(i=>{i?this.alertService.success():this.alertService.error("general.message."+i)},i=>{this.alertService.error()})}mapRegisterForm(t){let i={...t};return i.employeeCode=0,i}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader("allLoader"),this.setDates(t.dates,"visitDateFrom","visitDateTo"),this.setDates(t.creationDates,"creationTimeFrom","creationTimeTo"),this.loadentities()}LoadSuccess(){this.ngxLoader.stopLoader("allLoader")}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems}}configRoute(){this.routerActive.data.pipe((0,u.Q)(this.notifier)).subscribe(t=>{this.entities=t.data,this.pagination.totalItems=t.data?.totalItems},()=>{this.alertService.error()})}mapExcel(){let t=[];return this.entities.forEach(i=>{t.push({"Order Code":i.orderCode,"Created Date":i.createdDate,"City Name":i.cityName,"District Name":i.districtName?i.districtName:"--","Agent Name":i.agentName,Mobile:i.mobile,"Channel Name":i.channelName,"Assigned To":i.teamNames,Times:i.workTimes,"Visit Date":i.visitDate,Services:i.services})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}goRegister(){this.router.navigateByUrl("/managment/order/new")}goEdit(t){this.router.navigateByUrl("/managment/order/new")}getStatus(t){return 10==t.offerOrderStatus||20==t.offerOrderStatus?"bg-warning-subtle text-warning":30==t.offerOrderStatus?"bg-success-subtle text-success":40==t.offerOrderStatus?"bg-danger-subtle text-danger":50==t.offerOrderStatus?"bg-danger-success text-success":"bg-warning-subtle text-warning"}checkEdit(t){return!t.isCancel&&!t.isFinish}openModalClient(t,i,n="xl"){this.clientSelected=t.orderCode,this.orderSelected=t,this.isOrderEdit=!1,this.modalService.open(i,{centered:!0,size:n})}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}openEditOrderModal(t,i,n="md"){this.form={},this.isOrderEdit=!0,this.clientSelected=t,this.modalService.open(i,{centered:!0,size:n})}OpenOrderTimeLineModel(t,i,n="md"){this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}selectTruck(t){this.truncks=this.truncks.map(i=>({...i,isSelected:i.id===t}))}getSelectedTruckId(){const t=this.truncks.find(i=>i.isSelected);return t?t.id:null}updateTruck(){let t=this.getSelectedTruckId();if(null==t)return void this.alertService.error("plzSelectTrunck");let i={shippingTruckId:t,id:this.form.id,acutalVisitDate:this.datePipe.transform(this.form.acutalVisitDate,"yyyy-MM-ddT00:00:00.000")};this.ngxLoader.startLoader(this.operationLoader),this.baseService.updateTruck(i).pipe((0,R.O)(),(0,M.c)(this.mainDelay),(0,O.Z)(),(0,u.Q)(this.notifier),(0,k.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(n=>{n.success?this.submitFunished():this.alertService.error("general.message."+n.message)},n=>{this.alertService.error("general.message."+n)})}openShippingModal(t,i,n="md"){this.baseService.GetTrucks({id:t,acutalVisitDate:null}).subscribe(a=>{a.success?(this.form=a.data.order,this.truncks=a.data.truncks,this.modalService.open(i,{centered:!0,size:n})):this.alertService.error("general.message."+a.message)},a=>{this.alertService.error("general.message."+a)})}dateChangeModal(t){t=new Date(t);let i={id:this.form.id,acutalVisitDate:this.datePipe.transform(t,"yyyy-MM-ddT00:00:00.000")};this.baseService.GetTrucks(i).subscribe(n=>{n.success?this.truncks=n.data.truncks:this.alertService.error("general.message."+n.message)},n=>{this.alertService.error("general.message."+n)})}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(v.nX),e.rXU(h.c$),e.rXU(D),e.rXU(x.u),e.rXU(p.vh),e.rXU(f.eD),e.rXU(m.Bq),e.rXU(K.J),e.rXU(ne.n),e.rXU(ie.G),e.rXU(W.V),e.rXU(P.h),e.rXU(re.m),e.rXU(se.l),e.rXU(v.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-sure-order"]],features:[e.Vt3],decls:41,vars:31,consts:[["tableMaster",""],["cancelOrderModal",""],["SubmitOrderModal",""],["deleteModal",""],["OrderTimeLineModel",""],["StatusOrderModal",""],["formEntity","ngForm"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"reset","search","exportXlsx","addNew","showAdd","showExport","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","id","name","id",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","search","id","clientName","name","clientName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],[2,"width",".2%"],["translate","",2,"width",".5%"],["pSortableColumn","id","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["pSortableColumn","creationTime","translate","",2,"width","12%"],["pSortableColumn","clientId","translate","",2,"width","10%"],["pSortableColumn","clientVisitDate","translate","",2,"width","8%"],["pSortableColumn","shippingTruckName","translate","",2,"width","8%"],["pSortableColumn","totalQuantity","translate","",2,"width","8%"],["pSortableColumn","totalDiscount","translate","",2,"width","7%"],["translate","",2,"width","6%"],["pSortableColumn","netPrice","translate","",2,"width","6%"],["translate","",2,"width","10%"],[1,"fs-5"],["type","button","pRipple","",1,"border-0","p-button-text","p-button-rounded","p-button-plain",3,"pRowToggler","ngClass"],[1,"code-pointer"],[1,"badge","bg-success-subtle","text-success"],[1,"badge","bg-primary-subtle","text-primary","my-1"],[1,"d-inline"],[1,"ri-history-fill","d-inline","text-primary","fs-16","align-middle","me-1",3,"click"],["tooltipPosition","top",1,"btn","btn-sm","btn-success","edit-list","mx-1",3,"click","pTooltip"],[1,"ri-check-double-fill","align-bottom"],["tooltipPosition","top",1,"btn","btn-sm","btn-primary","edit-list","mx-1",3,"click","pTooltip"],[1,"ri-truck-line","align-bottom"],["tooltipPosition","top",1,"btn","btn-sm","btn-danger","edit-list","mx-1",3,"click","pTooltip"],[1,"ri-close-fill","align-bottom"],["colspan","17"],[1,"table-detail"],["dataKey","id",3,"value"],["pTemplate","emptymessage"],["translate","sales.salesOrder.itemName",2,"width","10%"],["translate","sales.salesOrder.unit",2,"width","6%"],["translate","sales.salesOrder.clientQuantity",2,"width","8%"],["translate","sales.salesOrder.approvedQuantity",2,"width","8%"],["translate","sales.salesOrder.discountType",2,"width","5%"],["translate","sales.salesOrder.discount",2,"width","5%"],["translate","sales.salesOrder.price",2,"width","5%"],["colspan","8"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"ngSubmit"],[3,"hasProgressBar","fgsType","loaderId"],[1,"modal-content"],[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mt-2","text-center"],["src","https://cdn.lordicon.com/gdfrsvpt.json","stroke","bold","state","hover-oscillate","trigger","loop","colors","primary:#f7b84b,secondary:#f06548",2,"width","130px","height","130px"],[1,"pt-2","fs-15","mx-4","mx-sm-5"],["translate","orderManagement.order.AreYouSureMessage"],[1,"text-muted","mx-4","mb-0"],[1,"d-flex","gap-2","justify-content-center","mt-4","mb-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["translate","sales.salesOrder.truckUpdate"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[3,"submit"],[1,"col-12","col-md-4"],["for","name","translate","",1,"fw-bold","form-label"],["name","acutalVisitDate","type","text","mwlFlatpickr","",1,"form-control","flatpickr-input",3,"ngModelChange","ngModel","altInput","convertModelValue"],[1,"row","truck-card","mt-5","justify-content-center"],[4,"ngFor","ngForOf"],[1,"text-center"],["type","submit","type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],[1,"col-12","col-md-3"],[1,"card","cursor-pointer",3,"click","ngClass"],[1,"badge","bg-success-subtle","text-success","my-1"],[3,"deleteConfirm","dismiss"],[3,"dismiss","orderSelected"]],template:function(i,n){if(1&i){const s=e.RV6();e.j41(0,"div",7)(1,"div",8)(2,"div",9),e.nrm(3,"ngx-ui-loader",10),e.j41(4,"base-filter",11),e.bIt("reset",function(){return e.eBV(s),e.Njj(n.onReset())})("search",function(){return e.eBV(s),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(s),e.Njj(n.onExportXlsx())})("addNew",function(){return e.eBV(s),e.Njj(n.goRegister())}),e.qex(5,12),e.j41(6,"div",13)(7,"div",14)(8,"input",15),e.nI1(9,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(s),e.DH7(n.pagination.id,l)||(n.pagination.id=l),e.Njj(l)}),e.k0s(),e.nrm(10,"i",16),e.k0s()(),e.j41(11,"div",13)(12,"div",14)(13,"input",17),e.nI1(14,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(s),e.DH7(n.pagination.clientName,l)||(n.pagination.clientName=l),e.Njj(l)}),e.k0s(),e.nrm(15,"i",16),e.k0s()(),e.j41(16,"div",13)(17,"input",18),e.nI1(18,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(s),e.DH7(n.searchForm.dates,l)||(n.searchForm.dates=l),e.Njj(l)}),e.k0s()(),e.j41(19,"div",13)(20,"input",18),e.nI1(21,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(s),e.DH7(n.searchForm.creationDates,l)||(n.searchForm.creationDates=l),e.Njj(l)}),e.k0s()(),e.bVm(),e.k0s(),e.j41(22,"div",19)(23,"div",20)(24,"p-table",21,0),e.bIt("onLazyLoad",function(l){return e.eBV(s),e.Njj(n.tableChange(l))})("selectionChange",function(l){return e.eBV(s),e.Njj(n.onSelectionChange(l))}),e.DNE(26,gn,31,0,"ng-template",22)(27,hn,41,28,"ng-template",23)(28,bn,7,1,"ng-template",24),e.k0s()(),e.DNE(29,vn,2,0,"div",25)(30,Cn,6,8,"div",26),e.k0s()()()(),e.DNE(31,Sn,15,3,"ng-template",null,1,e.C5r)(33,Tn,20,8,"ng-template",null,2,e.C5r)(35,kn,1,0,"ng-template",null,3,e.C5r)(37,In,1,1,"ng-template",null,4,e.C5r)(39,yn,15,3,"ng-template",null,5,e.C5r)}2&i&&(e.R7$(3),e.Y8G("loaderId","sureLoader"),e.R7$(),e.Y8G("showAdd",!1)("showExport",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(9,23,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.id),e.R7$(5),e.FS9("placeholder",e.bMT(14,25,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.clientName),e.R7$(4),e.FS9("placeholder",e.bMT(18,27,"orderManagement.order.visitDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.dates),e.R7$(3),e.FS9("placeholder",e.bMT(21,29,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(4),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(5),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[p.YU,p.Sq,p.bT,c.qT,c.me,c.Q0,c.BC,c.cb,c.vS,c.cV,m.s5,A.kL,z.b,X.w,Q.p,J.g,h.Mm,b.XI,H.Ei,b.Tg,b.FP,f.Cv,G.m,ee.m,p.vh,h.D9],encapsulation:2})}}return r})();function xn(r,o){1&r&&(e.j41(0,"tr",28),e.nrm(1,"th",29),e.j41(2,"th",30),e.EFF(3,"#"),e.k0s(),e.j41(4,"th",31),e.nrm(5,"i",32),e.EFF(6," orderManagement.order.orderCode "),e.k0s(),e.j41(7,"th",33),e.nrm(8,"i",32),e.EFF(9," orderManagement.order.creation "),e.k0s(),e.j41(10,"th",34),e.EFF(11," orderManagement.order.status "),e.k0s(),e.j41(12,"th",35),e.nrm(13,"i",32),e.EFF(14," orderManagement.order.agentName "),e.k0s(),e.j41(15,"th",36),e.EFF(16," sales.salesOrder.shippingTruckName "),e.k0s(),e.j41(17,"th",37),e.nrm(18,"i",32),e.EFF(19," sales.salesOrder.clientVisitDate "),e.k0s(),e.j41(20,"th",38),e.nrm(21,"i",32),e.EFF(22," sales.salesOrder.totalQuantity "),e.k0s(),e.j41(23,"th",39),e.nrm(24,"i",32),e.EFF(25," sales.salesOrder.totalDiscount "),e.k0s(),e.j41(26,"th",40),e.nrm(27,"i",32),e.EFF(28," sales.salesOrder.netPrice "),e.k0s()())}function Rn(r,o){if(1&r){const t=e.RV6();e.j41(0,"tr",41)(1,"td"),e.nrm(2,"button",42),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td",43),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(),a=e.sdS(38);return e.Njj(s.openModalClient(n,a,"lg"))}),e.j41(6,"bdi",44),e.EFF(7),e.k0s()(),e.j41(8,"td")(9,"span",45),e.EFF(10),e.k0s(),e.EFF(11),e.nI1(12,"date"),e.k0s(),e.j41(13,"td")(14,"span"),e.nrm(15,"span",46),e.k0s()(),e.j41(16,"td",43),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(),a=e.sdS(36);return e.Njj(s.openModalClient(n,a))}),e.j41(17,"span",47),e.EFF(18),e.k0s()(),e.j41(19,"td"),e.EFF(20),e.k0s(),e.j41(21,"td"),e.EFF(22),e.nI1(23,"date"),e.k0s(),e.j41(24,"td"),e.EFF(25),e.k0s(),e.j41(26,"td"),e.EFF(27),e.k0s(),e.j41(28,"td"),e.EFF(29),e.k0s()()}if(2&r){const t=o.$implicit,i=o.rowIndex,n=o.expanded,s=e.XpG();e.R7$(2),e.Y8G("pRowToggler",t)("ngClass",n?" ri-arrow-down-s-line":"  ri-arrow-up-s-line"),e.R7$(2),e.JRh(i+1),e.R7$(3),e.SpI("#SO#",t.id,""),e.R7$(3),e.SpI("",t.creatorName," "),e.R7$(),e.SpI(" ",e.i5U(12,16,t.creationTime,"yyyy-MM-dd")," "),e.R7$(3),e.ZvI("badge ",s.getStatus(t),""),e.R7$(),e.FS9("translate","sales.salesOrder."+t.offerOrderStatusValue),e.R7$(3),e.SpI("",t.clientName," "),e.R7$(2),e.JRh(t.shippingTruckName),e.R7$(2),e.SpI(" ",e.i5U(23,19,t.clientVisitDate,"yyyy-MM-dd"),""),e.R7$(3),e.JRh(t.totalQuantity),e.R7$(2),e.JRh(t.totalDiscount),e.R7$(2),e.JRh(t.netPrice)}}function Mn(r,o){1&r&&(e.j41(0,"tr"),e.nrm(1,"th",51)(2,"th",52)(3,"th",53)(4,"th",54)(5,"th",55)(6,"th",56)(7,"th",57),e.k0s())}function On(r,o){if(1&r&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td"),e.EFF(10),e.nI1(11,"translate"),e.k0s(),e.j41(12,"td"),e.EFF(13),e.k0s(),e.j41(14,"td"),e.EFF(15),e.k0s()()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t.itemName),e.R7$(2),e.JRh(t.unitName),e.R7$(2),e.JRh(t.clientQuantity),e.R7$(2),e.JRh(t.approvedQuantity),e.R7$(2),e.JRh(e.bMT(11,7,"sales.salesOrder."+t.discountTypeValue)),e.R7$(3),e.JRh(t.discount),e.R7$(2),e.JRh(t.price)}}function Nn(r,o){1&r&&(e.j41(0,"tr"),e.nrm(1,"td",58),e.k0s())}function wn(r,o){if(1&r&&(e.j41(0,"tr")(1,"td",48)(2,"div")(3,"p-table",49),e.DNE(4,Mn,8,0,"ng-template",23)(5,On,16,9,"ng-template",24)(6,Nn,2,0,"ng-template",50),e.k0s()()()()),2&r){const t=o.$implicit;e.R7$(3),e.Y8G("value",t.offerOrderDetails)}}function En(r,o){1&r&&(e.j41(0,"div",59),e.EFF(1," general.table.noData "),e.k0s())}function Gn(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",60)(1,"div",61),e.nrm(2,"ngb-pagination-info",62),e.j41(3,"table-length",63),e.bIt("lengthChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",64)(5,"ngb-pagination",65),e.bIt("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.pagination.pageNumber,n)||(s.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function Dn(r,o){if(1&r){const t=e.RV6();e.j41(0,"form",66,7),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.SubmitOrder())}),e.nrm(2,"ngx-ui-loader",67),e.j41(3,"div",68)(4,"div",69)(5,"button",70),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"div",71)(7,"div",72),e.nrm(8,"lord-icon",73),e.j41(9,"div",74),e.nrm(10,"h3",75)(11,"p",76),e.k0s()(),e.j41(12,"div",77),e.nrm(13,"button",78),e.j41(14,"button",79),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}function Vn(r,o){if(1&r){const t=e.RV6();e.j41(0,"delete-modal",80),e.bIt("deleteConfirm",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.DeleteConfirm())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}}function Ln(r,o){}function $n(r,o){if(1&r){const t=e.RV6();e.j41(0,"app-all-orders-details",81),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderDetails",t.orderSelected)}}function Xn(r,o){if(1&r&&e.nrm(0,"order-operation",82),2&r){const t=e.XpG();e.Y8G("isOrderEdit",t.isOrderEdit)("isInner",!0)("orderCode",t.clientSelected)}}function Bn(r,o){if(1&r){const t=e.RV6();e.j41(0,"order-timeline",83),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderSelected",t.orderSelected)}}let Un=(()=>{class r extends U.w{constructor(t,i,n,s,a,l,C,j,T,S,I,N,w,E,V){super(t,i,C,n,s,a,l),this.baseService=n,this.authDaamService=j,this.teamService=T,this.workTimeService=S,this.excelService=I,this.cityService=N,this.districtService=w,this.channelService=E,this.router=V,this.title="sales.salesOrder.completeOrder",this.titleOperation="sales.salesOrder.completeOrder",this.keySelected="",this.assignUsers=[],this.times=[],this.employees=[],this.searchForm={},this.isResolveList=!0,this.employeeTypes=[{id:1,name:"employeeTeam"},{id:2,name:"managment"},{id:3,name:"customerService"}],this.employeeGroups=[],this.activeindex="2",this.active=2,this.formPassword={},this.roles=[],this.teams=[],this.workTimes=[],this.userTypes=[],this.actives=[{id:!0,name:"active"},{id:!1,name:"noActive"}],this.clientSelected=0,this.cities=[],this.districts=[],this.channels=[],this.status=[],this.countLoad=2,this.isOrderEdit=!1,this.orderSelected={},this.users=[],this.setDates=(_,y,F)=>{if(_?.from||_?.to){const $=_.to||_.from;this.pagination[y]=this.datePipe.transform(_.from||_.to,"yyyy-MM-ddT00:00:00"),this.pagination[F]=this.datePipe.transform($,"yyyy-MM-ddT23:59:59.999")}else this.pagination[y]=null,this.pagination[F]=null},this.loadentities(),this.GetCities(),this.GetChannels(),this.GetTeams(),this.GetTimes(),this.status=[{name:"None",nameAr:"\u0644\u0627 \u0634\u0626",id:0},{name:"Is Review",nameAr:"\u062a\u0645\u062a \u0627\u0644\u0645\u0631\u0627\u062c\u0639\u0629",id:1},{name:"Is Confirmed",nameAr:"\u062a\u0645 \u0627\u0644\u062a\u0623\u0643\u064a\u062f",id:2},{name:"Is Free",nameAr:"\u0645\u062c\u0627\u0646\u064a",id:3},{name:"Is Reopen",nameAr:"\u062a\u0645\u062a \u0625\u0639\u0627\u062f\u0629 \u0641\u062a\u062d\u0647",id:4},{name:"Is Finish",nameAr:"\u0627\u0646\u062a\u0647\u0649",id:5},{name:"Is Cancel",nameAr:"\u062a\u0645 \u0627\u0644\u0625\u0644\u063a\u0627\u0621",id:6},{name:"Is Assign",nameAr:"\u062a\u0645 \u062a\u0639\u064a\u064a\u0646\u0647",id:7},{name:"Is Urgent",nameAr:"\u0639\u0627\u062c\u0644",id:8},{name:"New",nameAr:"\u062c\u062f\u064a\u062f",id:9}]}loadentities(){this.countLoad=this.countLoad+1,(!this.isResolveList||1!==this.countLoad)&&(this.pagination.status=60,this.baseService.get(this.pagination).pipe((0,u.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader(g.a7),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader(g.a7),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}SubmitOrder(){}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetDistricts(t){this.districtService.getByCityId(t).subscribe(i=>{this.districts=i.data},i=>{console.log(i)})}GetChannels(){this.channelService.getDropDown().subscribe(t=>{this.channels=t.data},t=>{console.log(t)})}GetTeams(){this.teamService.getDropDown().subscribe(t=>{this.teams=t.data},t=>{console.log(t)})}GetTimes(){this.workTimeService.getDropDown().subscribe(t=>{this.workTimes=t.data},t=>{console.log(t)})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,u.Q)(this.notifier)).subscribe(i=>{i?this.alertService.success():this.alertService.error("general.message."+i)},i=>{this.alertService.error()})}mapRegisterForm(t){let i={...t};return i.employeeCode=0,i}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader("allLoader"),this.setDates(t.dates,"visitDateFrom","visitDateTo"),this.setDates(t.creationDates,"creationTimeFrom","creationTimeTo"),this.loadentities()}LoadSuccess(){this.ngxLoader.stopLoader("allLoader")}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems}}configRoute(){this.routerActive.data.pipe((0,u.Q)(this.notifier)).subscribe(t=>{this.entities=t.data,this.pagination.totalItems=t.data?.totalItems},()=>{this.alertService.error()})}mapExcel(){let t=[];return this.entities.forEach(i=>{t.push({"Order Code":i.orderCode,"Created Date":i.createdDate,"City Name":i.cityName,"District Name":i.districtName?i.districtName:"--",Status:this.translateService.instant(this.getTrnslate(i)),"Agent Name":i.agentName,Mobile:i.mobile,"Channel Name":i.channelName,"Assigned To":i.teamNames,Times:i.workTimes,"Visit Date":i.visitDate,Services:i.services})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}goRegister(){this.router.navigateByUrl("/managment/order/new")}goEdit(t){this.router.navigateByUrl("/managment/order/new")}getStatus(t){return 10==t.offerOrderStatus||20==t.offerOrderStatus?"bg-warning-subtle text-warning":30==t.offerOrderStatus?"bg-success-subtle text-success":40==t.offerOrderStatus?"bg-danger-subtle text-danger":50==t.offerOrderStatus?"bg-danger-success text-success":"bg-warning-subtle text-warning"}checkEdit(t){return!t.isCancel&&!t.isFinish}getTrnslate(t){return t.isCancel?"orderManagement.order.cancel":t.isFinish?"orderManagement.order.finish":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen?"orderManagement.order.reopen":t.isAssign?"orderManagement.order.assign":t.isConfirmed?"orderManagement.order.confirmed":t.isFree?"orderManagement.order.free":"orderManagement.order.new"}openModalClient(t,i,n="xl"){this.clientSelected=t.orderCode,this.orderSelected=t,this.isOrderEdit=!1,this.modalService.open(i,{centered:!0,size:n})}oncityChange(t){this.GetDistricts(t.code)}getTimes(t){return t?.split(",")}getServices(t){return t.split("#")}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}openEditOrderModal(t,i,n="md"){this.form={},this.isOrderEdit=!0,this.clientSelected=t,this.modalService.open(i,{centered:!0,size:n})}OpenOrderTimeLineModel(t,i,n="md"){this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(v.nX),e.rXU(h.c$),e.rXU(D),e.rXU(x.u),e.rXU(p.vh),e.rXU(f.eD),e.rXU(m.Bq),e.rXU(K.J),e.rXU(ne.n),e.rXU(ie.G),e.rXU(W.V),e.rXU(P.h),e.rXU(re.m),e.rXU(se.l),e.rXU(v.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-complete-order"]],features:[e.Vt3],decls:43,vars:31,consts:[["tableMaster",""],["SubmitOrderModal",""],["deleteModal",""],["clientProfile",""],["orderViewModel",""],["orderModel",""],["OrderTimeLineModel",""],["formEntity","ngForm"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"reset","search","exportXlsx","addNew","showAdd","showExport","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","id","name","id",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","search","id","clientName","name","clientName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],[2,"width",".2%"],["translate","",2,"width",".5%"],["pSortableColumn","id","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["pSortableColumn","creationTime","translate","",2,"width","12%"],["pSortableColumn","status","translate","",2,"width","6%"],["pSortableColumn","clientId","translate","",2,"width","10%"],["translate","",2,"width","8%"],["pSortableColumn","clientVisitDate","translate","",2,"width","10%"],["pSortableColumn","totalQuantity","translate","",2,"width","8%"],["pSortableColumn","totalDiscount","translate","",2,"width","8%"],["pSortableColumn","netPrice","translate","",2,"width","8%"],[1,"fs-5"],["type","button","pRipple","",1,"border-0","p-button-text","p-button-rounded","p-button-plain",3,"pRowToggler","ngClass"],[3,"click"],[1,"code-pointer"],[1,"badge","bg-success-subtle","text-success"],[3,"translate"],[1,"badge","bg-primary-subtle","text-primary","my-1"],["colspan","17"],["dataKey","id",3,"value"],["pTemplate","emptymessage"],["translate","sales.salesOrder.itemName",2,"width","10%"],["translate","sales.salesOrder.unit",2,"width","6%"],["translate","sales.salesOrder.clientQuantity",2,"width","8%"],["translate","sales.salesOrder.approvedQuantity",2,"width","8%"],["translate","sales.salesOrder.discountType",2,"width","5%"],["translate","sales.salesOrder.discount",2,"width","5%"],["translate","sales.salesOrder.price",2,"width","5%"],["colspan","8"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"ngSubmit"],[3,"hasProgressBar","fgsType","loaderId"],[1,"modal-content"],[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mt-2","text-center"],["src","https://cdn.lordicon.com/gdfrsvpt.json","stroke","bold","state","hover-oscillate","trigger","loop","colors","primary:#f7b84b,secondary:#f06548",2,"width","130px","height","130px"],[1,"pt-2","fs-15","mx-4","mx-sm-5"],["translate","orderManagement.order.AreYouSureMessage"],[1,"text-muted","mx-4","mb-0"],[1,"d-flex","gap-2","justify-content-center","mt-4","mb-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],[3,"deleteConfirm","dismiss"],[3,"dismiss","orderDetails"],[3,"isOrderEdit","isInner","orderCode"],[3,"dismiss","orderSelected"]],template:function(i,n){if(1&i){const s=e.RV6();e.j41(0,"div",8)(1,"div",9)(2,"div",10),e.nrm(3,"ngx-ui-loader",11),e.j41(4,"base-filter",12),e.bIt("reset",function(){return e.eBV(s),e.Njj(n.onReset())})("search",function(){return e.eBV(s),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(s),e.Njj(n.onExportXlsx())})("addNew",function(){return e.eBV(s),e.Njj(n.goRegister())}),e.qex(5,13),e.j41(6,"div",14)(7,"div",15)(8,"input",16),e.nI1(9,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(s),e.DH7(n.pagination.id,l)||(n.pagination.id=l),e.Njj(l)}),e.k0s(),e.nrm(10,"i",17),e.k0s()(),e.j41(11,"div",14)(12,"div",15)(13,"input",18),e.nI1(14,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(s),e.DH7(n.pagination.clientName,l)||(n.pagination.clientName=l),e.Njj(l)}),e.k0s(),e.nrm(15,"i",17),e.k0s()(),e.j41(16,"div",14)(17,"input",19),e.nI1(18,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(s),e.DH7(n.searchForm.dates,l)||(n.searchForm.dates=l),e.Njj(l)}),e.k0s()(),e.j41(19,"div",14)(20,"input",19),e.nI1(21,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(s),e.DH7(n.searchForm.creationDates,l)||(n.searchForm.creationDates=l),e.Njj(l)}),e.k0s()(),e.bVm(),e.k0s(),e.j41(22,"div",20)(23,"div",21)(24,"p-table",22,0),e.bIt("onLazyLoad",function(l){return e.eBV(s),e.Njj(n.tableChange(l))})("selectionChange",function(l){return e.eBV(s),e.Njj(n.onSelectionChange(l))}),e.DNE(26,xn,29,0,"ng-template",23)(27,Rn,30,22,"ng-template",24)(28,wn,7,1,"ng-template",25),e.k0s()(),e.DNE(29,En,2,0,"div",26)(30,Gn,6,8,"div",27),e.k0s()()()(),e.DNE(31,Dn,15,3,"ng-template",null,1,e.C5r)(33,Vn,1,0,"ng-template",null,2,e.C5r)(35,Ln,0,0,"ng-template",null,3,e.C5r)(37,$n,1,1,"ng-template",null,4,e.C5r)(39,Xn,1,3,"ng-template",null,5,e.C5r)(41,Bn,1,1,"ng-template",null,6,e.C5r)}2&i&&(e.R7$(3),e.Y8G("loaderId","CompleteLoader"),e.R7$(),e.Y8G("showAdd",!1)("showExport",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(9,23,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.id),e.R7$(5),e.FS9("placeholder",e.bMT(14,25,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.clientName),e.R7$(4),e.FS9("placeholder",e.bMT(18,27,"orderManagement.order.visitDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.dates),e.R7$(3),e.FS9("placeholder",e.bMT(21,29,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(4),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(5),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[p.YU,p.bT,c.qT,c.me,c.Q0,c.BC,c.cb,c.vS,c.cV,m.s5,A.kL,z.b,le.L,X.w,Q.p,J.g,h.Mm,b.XI,H.Ei,b.Tg,b.FP,f.Cv,G.m,p.vh,h.D9],encapsulation:2})}}return r})();function An(r,o){1&r&&(e.j41(0,"tr",28),e.nrm(1,"th",29),e.j41(2,"th",30),e.EFF(3,"#"),e.k0s(),e.j41(4,"th",31),e.nrm(5,"i",32),e.EFF(6," orderManagement.order.orderCode "),e.k0s(),e.j41(7,"th",33),e.nrm(8,"i",32),e.EFF(9," orderManagement.order.creation "),e.k0s(),e.j41(10,"th",34),e.EFF(11," orderManagement.order.status "),e.k0s(),e.j41(12,"th",35),e.nrm(13,"i",32),e.EFF(14," orderManagement.order.agentName "),e.k0s(),e.j41(15,"th",36),e.EFF(16," orderManagement.order.assignTo "),e.k0s(),e.j41(17,"th",37),e.nrm(18,"i",32),e.EFF(19," sales.salesOrder.clientVisitDate "),e.k0s(),e.j41(20,"th",38),e.nrm(21,"i",32),e.EFF(22," sales.salesOrder.totalQuantity "),e.k0s(),e.j41(23,"th",39),e.nrm(24,"i",32),e.EFF(25," sales.salesOrder.totalDiscount "),e.k0s(),e.j41(26,"th",40),e.nrm(27,"i",32),e.EFF(28," sales.salesOrder.netPrice "),e.k0s()())}function Yn(r,o){if(1&r){const t=e.RV6();e.j41(0,"tr",41)(1,"td"),e.nrm(2,"button",42),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td",43),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(),a=e.sdS(38);return e.Njj(s.openModalClient(n,a,"lg"))}),e.j41(6,"bdi",44),e.EFF(7),e.k0s()(),e.j41(8,"td")(9,"span",45),e.EFF(10),e.k0s(),e.EFF(11),e.nI1(12,"date"),e.k0s(),e.j41(13,"td")(14,"span"),e.nrm(15,"span",46),e.k0s()(),e.j41(16,"td",43),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(),a=e.sdS(36);return e.Njj(s.openModalClient(n,a))}),e.j41(17,"span",47),e.EFF(18),e.k0s()(),e.nrm(19,"td"),e.j41(20,"td"),e.EFF(21),e.nI1(22,"date"),e.k0s(),e.j41(23,"td"),e.EFF(24),e.k0s(),e.j41(25,"td"),e.EFF(26),e.k0s(),e.j41(27,"td"),e.EFF(28),e.k0s()()}if(2&r){const t=o.$implicit,i=o.rowIndex,n=o.expanded,s=e.XpG();e.R7$(2),e.Y8G("pRowToggler",t)("ngClass",n?" ri-arrow-down-s-line":"  ri-arrow-up-s-line"),e.R7$(2),e.JRh(i+1),e.R7$(3),e.SpI("#SO#",t.id,""),e.R7$(3),e.SpI("",t.creatorName," "),e.R7$(),e.SpI(" ",e.i5U(12,15,t.creationTime,"yyyy-MM-dd")," "),e.R7$(3),e.ZvI("badge ",s.getStatus(t),""),e.R7$(),e.FS9("translate","sales.salesOrder."+t.offerOrderStatusValue),e.R7$(3),e.SpI("",t.clientName," "),e.R7$(3),e.SpI(" ",e.i5U(22,18,t.clientVisitDate,"yyyy-MM-dd"),""),e.R7$(3),e.JRh(t.totalQuantity),e.R7$(2),e.JRh(t.totalDiscount),e.R7$(2),e.JRh(t.netPrice)}}function Pn(r,o){1&r&&(e.j41(0,"tr"),e.nrm(1,"th",51)(2,"th",52)(3,"th",53)(4,"th",54)(5,"th",55)(6,"th",56)(7,"th",57),e.k0s())}function zn(r,o){if(1&r&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td"),e.EFF(10),e.nI1(11,"translate"),e.k0s(),e.j41(12,"td"),e.EFF(13),e.k0s(),e.j41(14,"td"),e.EFF(15),e.k0s()()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t.itemName),e.R7$(2),e.JRh(t.unitName),e.R7$(2),e.JRh(t.clientQuantity),e.R7$(2),e.JRh(t.approvedQuantity),e.R7$(2),e.JRh(e.bMT(11,7,"sales.salesOrder."+t.discountTypeValue)),e.R7$(3),e.JRh(t.discount),e.R7$(2),e.JRh(t.price)}}function Qn(r,o){1&r&&(e.j41(0,"tr"),e.nrm(1,"td",58),e.k0s())}function Jn(r,o){if(1&r&&(e.j41(0,"tr")(1,"td",48)(2,"div")(3,"p-table",49),e.DNE(4,Pn,8,0,"ng-template",23)(5,zn,16,9,"ng-template",24)(6,Qn,2,0,"ng-template",50),e.k0s()()()()),2&r){const t=o.$implicit;e.R7$(3),e.Y8G("value",t.offerOrderDetails)}}function Hn(r,o){1&r&&(e.j41(0,"div",59),e.EFF(1," general.table.noData "),e.k0s())}function qn(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",60)(1,"div",61),e.nrm(2,"ngb-pagination-info",62),e.j41(3,"table-length",63),e.bIt("lengthChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",64)(5,"ngb-pagination",65),e.bIt("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.pagination.pageNumber,n)||(s.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function Zn(r,o){if(1&r){const t=e.RV6();e.j41(0,"form",66,7),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.SubmitOrder())}),e.nrm(2,"ngx-ui-loader",67),e.j41(3,"div",68)(4,"div",69)(5,"button",70),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"div",71)(7,"div",72),e.nrm(8,"lord-icon",73),e.j41(9,"div",74),e.nrm(10,"h3",75)(11,"p",76),e.k0s()(),e.j41(12,"div",77),e.nrm(13,"button",78),e.j41(14,"button",79),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}function Wn(r,o){if(1&r){const t=e.RV6();e.j41(0,"delete-modal",80),e.bIt("deleteConfirm",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.DeleteConfirm())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}}function Kn(r,o){}function ei(r,o){if(1&r){const t=e.RV6();e.j41(0,"app-all-orders-details",81),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderDetails",t.orderSelected)}}function ti(r,o){if(1&r&&e.nrm(0,"order-operation",82),2&r){const t=e.XpG();e.Y8G("isOrderEdit",t.isOrderEdit)("isInner",!0)("orderCode",t.clientSelected)}}function ni(r,o){if(1&r){const t=e.RV6();e.j41(0,"order-timeline",83),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderSelected",t.orderSelected)}}let ii=(()=>{class r extends U.w{constructor(t,i,n,s,a,l,C,j,T,S,I,N,w,E,V){super(t,i,C,n,s,a,l),this.baseService=n,this.authDaamService=j,this.teamService=T,this.workTimeService=S,this.excelService=I,this.cityService=N,this.districtService=w,this.channelService=E,this.router=V,this.title="sales.salesOrder.cancelOrder",this.titleOperation="sales.salesOrder.cancelOrder",this.keySelected="",this.assignUsers=[],this.times=[],this.employees=[],this.searchForm={},this.isResolveList=!0,this.employeeTypes=[{id:1,name:"employeeTeam"},{id:2,name:"managment"},{id:3,name:"customerService"}],this.employeeGroups=[],this.activeindex="2",this.active=2,this.formPassword={},this.roles=[],this.teams=[],this.workTimes=[],this.userTypes=[],this.actives=[{id:!0,name:"active"},{id:!1,name:"noActive"}],this.clientSelected=0,this.cities=[],this.districts=[],this.channels=[],this.status=[],this.countLoad=2,this.isOrderEdit=!1,this.orderSelected={},this.users=[],this.setDates=(_,y,F)=>{if(_?.from||_?.to){const $=_.to||_.from;this.pagination[y]=this.datePipe.transform(_.from||_.to,"yyyy-MM-ddT00:00:00"),this.pagination[F]=this.datePipe.transform($,"yyyy-MM-ddT23:59:59.999")}else this.pagination[y]=null,this.pagination[F]=null},this.loadentities(),this.GetCities(),this.GetChannels(),this.GetTeams(),this.GetTimes(),this.status=[{name:"None",nameAr:"\u0644\u0627 \u0634\u0626",id:0},{name:"Is Review",nameAr:"\u062a\u0645\u062a \u0627\u0644\u0645\u0631\u0627\u062c\u0639\u0629",id:1},{name:"Is Confirmed",nameAr:"\u062a\u0645 \u0627\u0644\u062a\u0623\u0643\u064a\u062f",id:2},{name:"Is Free",nameAr:"\u0645\u062c\u0627\u0646\u064a",id:3},{name:"Is Reopen",nameAr:"\u062a\u0645\u062a \u0625\u0639\u0627\u062f\u0629 \u0641\u062a\u062d\u0647",id:4},{name:"Is Finish",nameAr:"\u0627\u0646\u062a\u0647\u0649",id:5},{name:"Is Cancel",nameAr:"\u062a\u0645 \u0627\u0644\u0625\u0644\u063a\u0627\u0621",id:6},{name:"Is Assign",nameAr:"\u062a\u0645 \u062a\u0639\u064a\u064a\u0646\u0647",id:7},{name:"Is Urgent",nameAr:"\u0639\u0627\u062c\u0644",id:8},{name:"New",nameAr:"\u062c\u062f\u064a\u062f",id:9}]}loadentities(){this.countLoad=this.countLoad+1,(!this.isResolveList||1!==this.countLoad)&&(this.pagination.status=40,this.baseService.get(this.pagination).pipe((0,u.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader(g.a7),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader(g.a7),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}SubmitOrder(){}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetDistricts(t){this.districtService.getByCityId(t).subscribe(i=>{this.districts=i.data},i=>{console.log(i)})}GetChannels(){this.channelService.getDropDown().subscribe(t=>{this.channels=t.data},t=>{console.log(t)})}GetTeams(){this.teamService.getDropDown().subscribe(t=>{this.teams=t.data},t=>{console.log(t)})}GetTimes(){this.workTimeService.getDropDown().subscribe(t=>{this.workTimes=t.data},t=>{console.log(t)})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,u.Q)(this.notifier)).subscribe(i=>{i?this.alertService.success():this.alertService.error("general.message."+i)},i=>{this.alertService.error()})}mapRegisterForm(t){let i={...t};return i.employeeCode=0,i}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader("allLoader"),this.setDates(t.dates,"visitDateFrom","visitDateTo"),this.setDates(t.creationDates,"creationTimeFrom","creationTimeTo"),this.loadentities()}LoadSuccess(){this.ngxLoader.stopLoader("allLoader")}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems}}configRoute(){this.routerActive.data.pipe((0,u.Q)(this.notifier)).subscribe(t=>{this.entities=t.data,this.pagination.totalItems=t.data?.totalItems},()=>{this.alertService.error()})}mapExcel(){let t=[];return this.entities.forEach(i=>{t.push({"Order Code":i.orderCode,"Created Date":i.createdDate,"City Name":i.cityName,"District Name":i.districtName?i.districtName:"--",Status:this.translateService.instant(this.getTrnslate(i)),"Agent Name":i.agentName,Mobile:i.mobile,"Channel Name":i.channelName,"Assigned To":i.teamNames,Times:i.workTimes,"Visit Date":i.visitDate,Services:i.services})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}goRegister(){this.router.navigateByUrl("/managment/order/new")}goEdit(t){this.router.navigateByUrl("/managment/order/new")}getStatus(t){return 10==t.offerOrderStatus||20==t.offerOrderStatus?"bg-warning-subtle text-warning":30==t.offerOrderStatus?"bg-success-subtle text-success":40==t.offerOrderStatus?"bg-danger-subtle text-danger":50==t.offerOrderStatus?"bg-danger-success text-success":"bg-warning-subtle text-warning"}checkEdit(t){return!t.isCancel&&!t.isFinish}getTrnslate(t){return t.isCancel?"orderManagement.order.cancel":t.isFinish?"orderManagement.order.finish":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen?"orderManagement.order.reopen":t.isAssign?"orderManagement.order.assign":t.isConfirmed?"orderManagement.order.confirmed":t.isFree?"orderManagement.order.free":"orderManagement.order.new"}openModalClient(t,i,n="xl"){this.clientSelected=t.orderCode,this.orderSelected=t,this.isOrderEdit=!1,this.modalService.open(i,{centered:!0,size:n})}oncityChange(t){this.GetDistricts(t.code)}getTimes(t){return t?.split(",")}getServices(t){return t.split("#")}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}openEditOrderModal(t,i,n="md"){this.form={},this.isOrderEdit=!0,this.clientSelected=t,this.modalService.open(i,{centered:!0,size:n})}OpenOrderTimeLineModel(t,i,n="md"){this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(v.nX),e.rXU(h.c$),e.rXU(D),e.rXU(x.u),e.rXU(p.vh),e.rXU(f.eD),e.rXU(m.Bq),e.rXU(K.J),e.rXU(ne.n),e.rXU(ie.G),e.rXU(W.V),e.rXU(P.h),e.rXU(re.m),e.rXU(se.l),e.rXU(v.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-cancel-order"]],features:[e.Vt3],decls:43,vars:31,consts:[["tableMaster",""],["SubmitOrderModal",""],["deleteModal",""],["clientProfile",""],["orderViewModel",""],["orderModel",""],["OrderTimeLineModel",""],["formEntity","ngForm"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"reset","search","exportXlsx","addNew","showAdd","showExport","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","id","name","id",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","search","id","clientName","name","clientName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],[2,"width",".2%"],["translate","",2,"width",".5%"],["pSortableColumn","id","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["pSortableColumn","creationTime","translate","",2,"width","12%"],["pSortableColumn","status","translate","",2,"width","6%"],["pSortableColumn","clientId","translate","",2,"width","10%"],["translate","",2,"width","8%"],["pSortableColumn","clientVisitDate","translate","",2,"width","10%"],["pSortableColumn","totalQuantity","translate","",2,"width","8%"],["pSortableColumn","totalDiscount","translate","",2,"width","8%"],["pSortableColumn","netPrice","translate","",2,"width","8%"],[1,"fs-5"],["type","button","pRipple","",1,"border-0","p-button-text","p-button-rounded","p-button-plain",3,"pRowToggler","ngClass"],[3,"click"],[1,"code-pointer"],[1,"badge","bg-success-subtle","text-success"],[3,"translate"],[1,"badge","bg-primary-subtle","text-primary","my-1"],["colspan","17"],["dataKey","id",3,"value"],["pTemplate","emptymessage"],["translate","sales.salesOrder.itemName",2,"width","10%"],["translate","sales.salesOrder.unit",2,"width","6%"],["translate","sales.salesOrder.clientQuantity",2,"width","8%"],["translate","sales.salesOrder.approvedQuantity",2,"width","8%"],["translate","sales.salesOrder.discountType",2,"width","5%"],["translate","sales.salesOrder.discount",2,"width","5%"],["translate","sales.salesOrder.price",2,"width","5%"],["colspan","8"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"ngSubmit"],[3,"hasProgressBar","fgsType","loaderId"],[1,"modal-content"],[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mt-2","text-center"],["src","https://cdn.lordicon.com/gdfrsvpt.json","stroke","bold","state","hover-oscillate","trigger","loop","colors","primary:#f7b84b,secondary:#f06548",2,"width","130px","height","130px"],[1,"pt-2","fs-15","mx-4","mx-sm-5"],["translate","orderManagement.order.AreYouSureMessage"],[1,"text-muted","mx-4","mb-0"],[1,"d-flex","gap-2","justify-content-center","mt-4","mb-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],[3,"deleteConfirm","dismiss"],[3,"dismiss","orderDetails"],[3,"isOrderEdit","isInner","orderCode"],[3,"dismiss","orderSelected"]],template:function(i,n){if(1&i){const s=e.RV6();e.j41(0,"div",8)(1,"div",9)(2,"div",10),e.nrm(3,"ngx-ui-loader",11),e.j41(4,"base-filter",12),e.bIt("reset",function(){return e.eBV(s),e.Njj(n.onReset())})("search",function(){return e.eBV(s),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(s),e.Njj(n.onExportXlsx())})("addNew",function(){return e.eBV(s),e.Njj(n.goRegister())}),e.qex(5,13),e.j41(6,"div",14)(7,"div",15)(8,"input",16),e.nI1(9,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(s),e.DH7(n.pagination.id,l)||(n.pagination.id=l),e.Njj(l)}),e.k0s(),e.nrm(10,"i",17),e.k0s()(),e.j41(11,"div",14)(12,"div",15)(13,"input",18),e.nI1(14,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(s),e.DH7(n.pagination.clientName,l)||(n.pagination.clientName=l),e.Njj(l)}),e.k0s(),e.nrm(15,"i",17),e.k0s()(),e.j41(16,"div",14)(17,"input",19),e.nI1(18,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(s),e.DH7(n.searchForm.dates,l)||(n.searchForm.dates=l),e.Njj(l)}),e.k0s()(),e.j41(19,"div",14)(20,"input",19),e.nI1(21,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(s),e.DH7(n.searchForm.creationDates,l)||(n.searchForm.creationDates=l),e.Njj(l)}),e.k0s()(),e.bVm(),e.k0s(),e.j41(22,"div",20)(23,"div",21)(24,"p-table",22,0),e.bIt("onLazyLoad",function(l){return e.eBV(s),e.Njj(n.tableChange(l))})("selectionChange",function(l){return e.eBV(s),e.Njj(n.onSelectionChange(l))}),e.DNE(26,An,29,0,"ng-template",23)(27,Yn,29,21,"ng-template",24)(28,Jn,7,1,"ng-template",25),e.k0s()(),e.DNE(29,Hn,2,0,"div",26)(30,qn,6,8,"div",27),e.k0s()()()(),e.DNE(31,Zn,15,3,"ng-template",null,1,e.C5r)(33,Wn,1,0,"ng-template",null,2,e.C5r)(35,Kn,0,0,"ng-template",null,3,e.C5r)(37,ei,1,1,"ng-template",null,4,e.C5r)(39,ti,1,3,"ng-template",null,5,e.C5r)(41,ni,1,1,"ng-template",null,6,e.C5r)}2&i&&(e.R7$(3),e.Y8G("loaderId","cancelLoader"),e.R7$(),e.Y8G("showAdd",!1)("showExport",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(9,23,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.id),e.R7$(5),e.FS9("placeholder",e.bMT(14,25,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.clientName),e.R7$(4),e.FS9("placeholder",e.bMT(18,27,"orderManagement.order.visitDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.dates),e.R7$(3),e.FS9("placeholder",e.bMT(21,29,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(4),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(5),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[p.YU,p.bT,c.qT,c.me,c.Q0,c.BC,c.cb,c.vS,c.cV,m.s5,A.kL,z.b,le.L,X.w,Q.p,J.g,h.Mm,b.XI,H.Ei,b.Tg,b.FP,f.Cv,G.m,p.vh,h.D9],encapsulation:2})}}return r})();function ri(r,o){1&r&&e.nrm(0,"app-all-sales-order")}function si(r,o){1&r&&e.nrm(0,"app-new-order")}function ai(r,o){1&r&&e.nrm(0,"app-sure-order")}function oi(r,o){1&r&&e.nrm(0,"app-complete-order")}function li(r,o){1&r&&e.nrm(0,"app-cancel-order")}let di=(()=>{class r extends U.w{constructor(t,i,n,s,a,l,C,j){super(t,i,C,n,s,a,l),this.baseService=n,this.authDaamService=j,this.title="orderManagement.order.title",this.titleOperation="orderManagement.order.titleOperation",this.active=2,this.activeindex="2"}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(v.nX),e.rXU(h.c$),e.rXU(me.Q),e.rXU(x.u),e.rXU(p.vh),e.rXU(f.eD),e.rXU(m.Bq),e.rXU(K.J))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-order-layout"]],features:[e.Vt3],decls:25,vars:7,consts:[["nav","ngbNav"],[1,"row"],[1,"col-lg-12"],["ngbNav","",1,"nav","nav-tabs-custom","card-header-tabs","border-bottom-0","justify-content-center",3,"activeIdChange","navChange","activeId"],[3,"ngbNavItem"],["ngbNavLink",""],["translate","sales.salesOrder.allOrders"],["ngbNavContent",""],["translate","sales.salesOrder.newOrders"],["translate","sales.salesOrder.sureOrder"],["translate","sales.salesOrder.completeOrder"],["translate","sales.salesOrder.cancelOrder"],[1,"mt-2",3,"ngbNavOutlet"]],template:function(i,n){if(1&i){const s=e.RV6();e.j41(0,"div",1)(1,"div",2)(2,"ul",3,0),e.mxI("activeIdChange",function(l){return e.eBV(s),e.DH7(n.active,l)||(n.active=l),e.Njj(l)}),e.bIt("navChange",function(l){return e.eBV(s),e.Njj(n.onNavChange(l))}),e.j41(4,"li",4)(5,"a",5),e.nrm(6,"span",6),e.k0s(),e.DNE(7,ri,1,0,"ng-template",7),e.k0s(),e.j41(8,"li",4)(9,"a",5),e.nrm(10,"span",8),e.k0s(),e.DNE(11,si,1,0,"ng-template",7),e.k0s(),e.j41(12,"li",4)(13,"a",5),e.nrm(14,"span",9),e.k0s(),e.DNE(15,ai,1,0,"ng-template",7),e.k0s(),e.j41(16,"li",4)(17,"a",5),e.nrm(18,"span",10),e.k0s(),e.DNE(19,oi,1,0,"ng-template",7),e.k0s(),e.j41(20,"li",4)(21,"a",5),e.nrm(22,"span",11),e.k0s(),e.DNE(23,li,1,0,"ng-template",7),e.k0s()(),e.nrm(24,"div",12),e.k0s()()}if(2&i){const s=e.sdS(3);e.R7$(2),e.R50("activeId",n.active),e.R7$(2),e.Y8G("ngbNavItem",1),e.R7$(4),e.Y8G("ngbNavItem",2),e.R7$(4),e.Y8G("ngbNavItem",3),e.R7$(4),e.Y8G("ngbNavItem",4),e.R7$(4),e.Y8G("ngbNavItem",5),e.R7$(4),e.Y8G("ngbNavOutlet",s)}},dependencies:[m.Um,m.X9,m.sy,m.Gx,m.Ri,m.WA,m.m_,h.Mm,Ut,mn,Fn,Un,ii],encapsulation:2})}}return r})(),be=(()=>{class r extends ae.d{constructor(t){super(t,Z.c.apiUrl+"InvoiceMaster/")}register(t){return this.http.post(this.baseUrl+"AddPaymentToInvoice",t)}edit(t){return this.http.post(this.baseUrl+"EditPayment",t)}softDelete(t){return this.http.delete(this.baseUrl+`SoftDelete/${t}`)}static{this.\u0275fac=function(i){return new(i||r)(e.KVO(oe.Qq))}}static{this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})(),ci=(()=>{class r extends ae.d{constructor(t){super(t,Z.c.apiUrl+"PaymentType/")}getLookups(){return this.http.get(this.baseUrl+"Lookups")}changStatus(t){return this.http.put(this.baseUrl+"ChangeStatus/",t)}static{this.\u0275fac=function(i){return new(i||r)(e.KVO(oe.Qq))}}static{this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var mi=d(99902),ve=d(3200);const Ce=(r,o,t)=>({"bg-success-subtle text-success":r,"bg-warning-subtle text-warning":o,"bg-danger-subtle text-danger":t});function pi(r,o){1&r&&(e.j41(0,"tr",28),e.nrm(1,"th",29),e.j41(2,"th",30),e.EFF(3,"#"),e.k0s(),e.j41(4,"th",31),e.nrm(5,"i",32),e.EFF(6," orderManagement.order.invoiceCode "),e.k0s(),e.j41(7,"th",33),e.nrm(8,"i",32),e.EFF(9," orderManagement.order.orderCode "),e.k0s(),e.j41(10,"th",34),e.nrm(11,"i",32),e.EFF(12," orderManagement.order.creation "),e.k0s(),e.j41(13,"th",35),e.nrm(14,"i",32),e.EFF(15," sales.salesInvoices.total "),e.k0s(),e.j41(16,"th",36),e.nrm(17,"i",32),e.EFF(18," sales.salesOrder.totalDiscount "),e.k0s(),e.j41(19,"th",37),e.nrm(20,"i",32),e.EFF(21," sales.salesInvoices.tax "),e.k0s(),e.j41(22,"th",38),e.nrm(23,"i",32),e.EFF(24," sales.salesOrder.netPrice "),e.k0s(),e.j41(25,"th",39),e.EFF(26," sales.salesOrder.totalPayment "),e.k0s(),e.j41(27,"th",40),e.nrm(28,"i",32),e.EFF(29," sales.salesOrder.isSync "),e.k0s(),e.j41(30,"th",41),e.nrm(31,"i",32),e.EFF(32," sales.salesInvoices.notes "),e.k0s(),e.nrm(33,"th",42),e.k0s())}function gi(r,o){if(1&r&&(e.j41(0,"span",61),e.EFF(1),e.k0s()),2&r){const t=e.XpG().$implicit;e.R7$(),e.JRh(t.creatorName)}}function hi(r,o){1&r&&e.nrm(0,"span",62)}function ui(r,o){1&r&&e.nrm(0,"span",63)}function _i(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",64),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,s=e.XpG(),a=e.sdS(34);return e.Njj(s.openInvoiceModal(n,a,"md",!1))}),e.nrm(1,"i",65)(2,"span",66),e.k0s()}}function fi(r,o){if(1&r&&(e.j41(0,"tr",43)(1,"td"),e.nrm(2,"button",44),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td")(6,"bdi",45),e.EFF(7),e.k0s()(),e.j41(8,"td")(9,"bdi",45),e.EFF(10),e.k0s(),e.nrm(11,"i",46),e.k0s(),e.j41(12,"td"),e.DNE(13,gi,2,1,"span",47),e.EFF(14),e.nI1(15,"date"),e.k0s(),e.j41(16,"td"),e.EFF(17),e.k0s(),e.j41(18,"td"),e.EFF(19),e.k0s(),e.j41(20,"td"),e.EFF(21),e.k0s(),e.j41(22,"td")(23,"span",48),e.EFF(24),e.k0s()(),e.j41(25,"td")(26,"span",48),e.EFF(27),e.k0s()(),e.j41(28,"td"),e.DNE(29,hi,1,0,"span",49)(30,ui,1,0,"span",50),e.k0s(),e.j41(31,"td"),e.EFF(32),e.k0s(),e.j41(33,"td")(34,"div",51),e.DNE(35,_i,3,0,"button",52),e.j41(36,"span",51)(37,"div",53)(38,"button",54),e.nrm(39,"i",55),e.k0s(),e.j41(40,"ul",56)(41,"li")(42,"span",57),e.nrm(43,"i",58)(44,"span",59),e.k0s()(),e.j41(45,"li")(46,"span",57),e.nrm(47,"i",58)(48,"span",60),e.k0s()()()()()()()()),2&r){const t=o.$implicit,i=o.rowIndex,n=o.expanded;e.R7$(2),e.Y8G("pRowToggler",t)("ngClass",n?" ri-arrow-down-s-line":"  ri-arrow-up-s-line"),e.R7$(2),e.JRh(i+1),e.R7$(3),e.SpI("#SI#",t.id,""),e.R7$(3),e.SpI("#SO#",t.offerOrderId," "),e.R7$(3),e.Y8G("ngIf",t.creatorName),e.R7$(),e.SpI(" ",e.i5U(15,18,t.creationTime,"yyyy-MM-dd")," "),e.R7$(3),e.JRh(t.total),e.R7$(2),e.JRh(t.totalDiscount),e.R7$(2),e.JRh(t.tax),e.R7$(2),e.Y8G("ngClass",e.sMw(21,Ce,t.net==t.totalPayment,t.net<t.totalPayment,t.net>t.totalPayment)),e.R7$(),e.JRh(t.net),e.R7$(2),e.Y8G("ngClass",e.sMw(25,Ce,t.net==t.totalPayment,t.net<t.totalPayment,t.net>t.totalPayment)),e.R7$(),e.JRh(t.totalPayment),e.R7$(2),e.Y8G("ngIf",t.isSync),e.R7$(),e.Y8G("ngIf",!t.isSync),e.R7$(2),e.JRh(t.notes),e.R7$(3),e.Y8G("ngIf",t.totalPayment<t.net)}}function bi(r,o){1&r&&(e.j41(0,"tr")(1,"th",71),e.EFF(2,"#"),e.k0s(),e.nrm(3,"th",72)(4,"th",73)(5,"th",74)(6,"th",75)(7,"th",76),e.k0s())}function vi(r,o){if(1&r){const t=e.RV6();e.j41(0,"p-image",85),e.bIt("onImageError",function(n){e.eBV(t);const s=e.XpG(4);return e.Njj(s.setDefaultImage(n,"assets/images/custom/no-img.jpg"))}),e.k0s()}if(2&r){const t=e.XpG(2).$implicit;e.Y8G("src","assets/images/PDF.png")("preview",!1)("alt",t.name)}}function Ci(r,o){if(1&r&&(e.j41(0,"a",84),e.DNE(1,vi,1,3,"p-image",78),e.k0s()),2&r){const t=e.XpG().$implicit,i=e.XpG(2);e.FS9("href",i.serverPath+i.checkUrl(t.path),e.B4B),e.R7$(),e.Y8G("ngIf","pdf"===i.checkExtension(i.serverPath+i.checkUrl(t.path)))}}function Si(r,o){if(1&r){const t=e.RV6();e.j41(0,"p-image",85),e.bIt("onImageError",function(n){e.eBV(t);const s=e.XpG(3);return e.Njj(s.setDefaultImage(n,"assets/images/custom/no-img.jpg"))}),e.k0s()}if(2&r){const t=e.XpG().$implicit,i=e.XpG(2);e.Y8G("src",i.serverPath+i.checkUrl(t.path))("preview",!0)("alt",t.name)}}function ji(r,o){if(1&r){const t=e.RV6();e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.DNE(8,Ci,2,2,"a",77)(9,Si,1,3,"p-image",78),e.k0s(),e.j41(10,"td"),e.EFF(11),e.k0s(),e.j41(12,"td")(13,"div",79)(14,"button",80),e.nI1(15,"translate"),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(2),a=e.sdS(34);return e.Njj(s.openInvoiceModal(n,a,"md",!0))}),e.nrm(16,"i",81),e.k0s(),e.j41(17,"button",82),e.nI1(18,"translate"),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(2),a=e.sdS(36);return e.Njj(s.openModal(n.id,a))}),e.nrm(19,"i",83),e.k0s()()()()}if(2&r){const t=o.$implicit,i=o.rowIndex,n=e.XpG(2);e.R7$(2),e.JRh(i+1),e.R7$(2),e.JRh(t.cost),e.R7$(2),e.JRh(t.paymentTypeName),e.R7$(2),e.Y8G("ngIf","pdf"===n.checkExtension(n.serverPath+n.checkUrl(t.path))),e.R7$(),e.Y8G("ngIf","pdf"!==n.checkExtension(n.serverPath+n.checkUrl(t.path))),e.R7$(2),e.JRh(t.notes),e.R7$(3),e.FS9("pTooltip",e.bMT(15,8,"general.action.edit")),e.R7$(3),e.FS9("pTooltip",e.bMT(18,10,"general.action.delete"))}}function Ti(r,o){1&r&&(e.j41(0,"tr"),e.nrm(1,"td",86),e.k0s())}function ki(r,o){if(1&r&&(e.j41(0,"tr")(1,"td",67)(2,"div",68)(3,"p-table",69),e.DNE(4,bi,8,0,"ng-template",23)(5,ji,20,12,"ng-template",24)(6,Ti,2,0,"ng-template",70),e.k0s()()()()),2&r){const t=o.$implicit;e.R7$(3),e.Y8G("value",t.payments)}}function Ii(r,o){1&r&&(e.j41(0,"div",87),e.EFF(1," general.table.noData "),e.k0s())}function yi(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",88)(1,"div",89),e.nrm(2,"ngb-pagination-info",90),e.j41(3,"table-length",91),e.bIt("lengthChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",92)(5,"ngb-pagination",93),e.bIt("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.pagination.pageNumber,n)||(s.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function Fi(r,o){1&r&&(e.j41(0,"span",120),e.EFF(1,"general.action.register "),e.k0s())}function xi(r,o){1&r&&(e.j41(0,"span",120),e.EFF(1,"general.action.edit "),e.k0s())}function Ri(r,o){1&r&&(e.j41(0,"div",121),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function Mi(r,o){1&r&&(e.j41(0,"div",121),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function Oi(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",124)(1,"i",125),e.bIt("click",function(){e.eBV(t);const n=e.XpG().index,s=e.XpG(2);return e.Njj(s.removeFile(n))}),e.k0s(),e.j41(2,"p-image",126),e.bIt("error",function(n){e.eBV(t);const s=e.XpG(3);return e.Njj(s.setDefaultImage(n,"assets/images/custom/no-img.jpg"))}),e.k0s()()}2&r&&(e.R7$(2),e.Y8G("src","assets/images/PDF.png")("preview",!1)("alt","pdf"))}function Ni(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",124)(1,"i",125),e.bIt("click",function(){e.eBV(t);const n=e.XpG().index,s=e.XpG(2);return e.Njj(s.removeFile(n))}),e.k0s(),e.j41(2,"p-image",126),e.bIt("error",function(n){e.eBV(t);const s=e.XpG(3);return e.Njj(s.setDefaultImage(n,"assets/images/custom/no-img.jpg"))}),e.k0s()()}if(2&r){const t=e.XpG().$implicit,i=e.XpG(2);e.R7$(2),e.Y8G("src",t.isNew?t.attachment:i.serverPath+t.attachment)("preview",!0)("alt","image")}}function wi(r,o){if(1&r&&(e.j41(0,"div",122),e.DNE(1,Oi,3,3,"div",123)(2,Ni,3,3,"div",123),e.k0s()),2&r){const t=o.index,i=e.XpG(2);e.R7$(),e.Y8G("ngIf","application/pdf"===i.filesNames[t]),e.R7$(),e.Y8G("ngIf","application/pdf"!==i.filesNames[t])}}function Ei(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",94)(1,"div",95)(2,"h4",96),e.DNE(3,Fi,2,0,"span",97)(4,xi,2,0,"span",97),e.j41(5,"span",98),e.EFF(6),e.k0s()(),e.j41(7,"button",99),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss("Cross click"))}),e.k0s()(),e.j41(8,"div",100),e.nrm(9,"ngx-ui-loader",101),e.j41(10,"form",102,3),e.bIt("submit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.OnSubmit())}),e.j41(12,"div",103)(13,"label",104),e.EFF(14,"sales.salesInvoices.paymentTypeName"),e.k0s(),e.j41(15,"ng-select",105,4),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.paymentTypeId,n)||(s.form.paymentTypeId=n),e.Njj(n)}),e.k0s(),e.DNE(17,Ri,2,0,"div",106),e.k0s(),e.j41(18,"div",103)(19,"label",107),e.EFF(20,"sales.salesInvoices.cost"),e.k0s(),e.j41(21,"input",108,5),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.cost,n)||(s.form.cost=n),e.Njj(n)}),e.k0s(),e.DNE(23,Mi,2,0,"div",109),e.k0s(),e.j41(24,"div",103)(25,"label",110),e.EFF(26,"general.table.notes"),e.k0s(),e.j41(27,"textarea",111),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.form.notes,n)||(s.form.notes=n),e.Njj(n)}),e.EFF(28,"                    "),e.k0s()(),e.j41(29,"div",8)(30,"div",112)(31,"label",104),e.EFF(32," orderManagement.order.attachment"),e.k0s(),e.j41(33,"input",113,6),e.bIt("change",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.onFileSelected(n))}),e.k0s()(),e.j41(35,"div",114),e.DNE(36,wi,3,2,"div",115),e.k0s()(),e.j41(37,"div",116)(38,"button",117),e.nrm(39,"i",118)(40,"span",119),e.k0s()()()()()}if(2&r){const t=e.sdS(11),i=e.sdS(16),n=e.sdS(22),s=e.XpG();e.R7$(3),e.Y8G("ngIf",!s.isEditForm),e.R7$(),e.Y8G("ngIf",s.isEditForm),e.R7$(2),e.JRh(s.titleOperation),e.R7$(3),e.Y8G("hasProgressBar",!1)("fgsType",s.loaderOperationShap)("loaderId",s.operationLoader),e.R7$(6),e.Y8G("items",s.paymentMethods)("multiple",!1),e.R50("ngModel",s.form.paymentTypeId),e.R7$(2),e.Y8G("ngIf",i.invalid&&i.touched),e.R7$(4),e.R50("ngModel",s.form.cost),e.R7$(2),e.Y8G("ngIf",n.invalid&&n.touched),e.R7$(4),e.R50("ngModel",s.form.notes),e.R7$(9),e.Y8G("ngForOf",s.filesToShow),e.R7$(2),e.Y8G("disabled",!t.valid)}}function Gi(r,o){if(1&r){const t=e.RV6();e.j41(0,"delete-modal",127),e.bIt("deleteConfirm",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.DeleteConfirmSoft())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}}let Di=(()=>{class r extends U.w{constructor(t,i,n,s,a,l,C,j,T){super(t,i,C,n,s,a,l),this.baseService=n,this.paymentTypesService=j,this.formData=T,this.title="sales.salesInvoices.title",this.titleOperation="sales.salesInvoices.payment",this.paymentMethods=[],this.searchForm={},this.form={file:""},this.filesToSend=[],this.filesToShow=[],this.filesNames=[],this.isResolveList=!0,this.serverPath=Z.c.mediaUrl,this.countLoad=0,this.isOrderEdit=!1,this.setDates=(S,I,N)=>{if(S?.from||S?.to){const E=S.to||S.from;this.pagination[I]=this.datePipe.transform(S.from||S.to,"yyyy-MM-ddT00:00:00"),this.pagination[N]=this.datePipe.transform(E,"yyyy-MM-ddT23:59:59.999")}else this.pagination[I]=null,this.pagination[N]=null},this.configRoute(),this.getPaymentTypes()}configRoute(){this.routerActive.data.pipe((0,u.Q)(this.notifier)).subscribe(t=>{this.entities=t.data.data,this.pagination.totalItems=t.data.totalItems},()=>{this.alertService.error()})}getPaymentTypes(){this.paymentTypesService.getDropDown().subscribe({next:t=>{this.paymentMethods=t.data}})}onSearch(){let t={...this.searchForm};this.ngxLoader.startLoader("allLoader"),this.setDates(t.dates,"visitDateFrom","visitDateTo"),this.setDates(t.creationDates,"creationTimeFrom","creationTimeTo"),this.loadentities()}LoadSuccess(){this.ngxLoader.stopLoader("allLoader")}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems}}openInvoiceModal(t,i,n="md",s){if(this.isEditForm=s,this.form={},this.clearFiles(),this.operationId=t.id,s){this.form=t,console.log(this.form);let a="";t.path&&(a=t.path.split(".")[1]),this.filesToSend.push({id:0,isNew:!1,attachment:t.path}),this.filesToShow.push({id:0,isNew:!1,attachment:t.path}),this.filesNames.push("pdf"===a?"application/pdf":a),this.modalService.open(i,{centered:!0,size:n})}else this.form.invoiceMasterId=t.id,this.modalService.open(i,{centered:!0,size:n})}onFileSelected(t){this.clearFiles();const i=t.target;if(t.target.files&&t.target.files[0]){let n=t.target.files.length;for(let s=0;s<n;s++){let a=new FileReader;this.filesToSend.push({id:0,isNew:!0,attachment:t.target.files.item(s)}),this.filesNames.push(t.target.files[s].type),a.onload=l=>{this.filesToShow.push({id:0,isNew:!0,attachment:l.target.result}),console.log(this.filesToShow)},a.readAsDataURL(t.target?.files[s])}i.value=""}}setDefaultImage(t,i){const n=t.target;console.log(n,"targettargettargettarget"),n.src=i}checkExtension(t){const n=t.split("/").pop().split(".").pop();return console.log(),n}checkUrl(t){return null==t||""==t?"":t.startsWith("/upload")?t.replace("/upload","upload"):t}removeFile(t){this.filesToShow.splice(t,1),this.filesNames.splice(t,1),this.filesToSend.splice(t,1)}clearFiles(){this.filesNames=[],this.filesToShow=[],this.filesToSend=[]}registerEntity(){let t=this.mapRegisterForm(this.form);t.file=this.filesToSend&&this.filesToSend.length>0?this.filesToSend[0].attachment:null,this.baseService.register(this.formData.formatFormData(t)).pipe((0,R.O)(),(0,M.c)(this.mainDelay),(0,O.Z)(),(0,u.Q)(this.notifier),(0,k.j)(()=>this.ngxLoader.stopLoader(g.ZW)),(0,de.W)(i=>(0,ce.$)(i))).subscribe(i=>{i.success?(this.modalService.dismissAll(),this.submitFunished()):this.alertService.error("general.message."+i.message)},i=>{this.alertService.error("general.message."+i)})}editEntity(){let t=this.mapForm(this.form);t.file=this.filesToSend&&this.filesToSend.length>0?this.filesToSend[0].attachment:null,this.baseService.edit(this.formData.formatFormData(t)).pipe((0,R.O)(),(0,M.c)(this.mainDelay),(0,O.Z)(),(0,u.Q)(this.notifier),(0,k.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(i=>{i.success?this.submitFunished():this.alertService.error("general.message."+i.message)},i=>{this.alertService.error("general.message."+i)})}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(v.nX),e.rXU(h.c$),e.rXU(be),e.rXU(x.u),e.rXU(p.vh),e.rXU(f.eD),e.rXU(m.Bq),e.rXU(ci),e.rXU(mi.Q))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-sales-invoices"]],features:[e.Vt3],decls:37,vars:35,consts:[["tableMaster",""],["addPaymentModal",""],["deleteModal",""],["formEntity","ngForm"],["paymentTypeId","ngModel"],["cost","ngModel"],["fileInput",""],[3,"title","breadcrumbItems"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"reset","search","showAdd","showExport","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","id","name","id",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","search","id","clientName","name","clientName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["type","text","mwlFlatpickr","","id","isDate","mode","range","altFormat","d/m/Y",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],[2,"width",".1%"],["translate","",2,"width",".3%"],["pSortableColumn","id","translate","",2,"width","3%"],[1,"ri-expand-up-down-line"],["pSortableColumn","id","translate","",2,"width","4%"],["pSortableColumn","creationTime","translate","",2,"width","5%"],["pSortableColumn","total","translate","",2,"width","5%"],["pSortableColumn","totalDiscount","translate","",2,"width","5%"],["pSortableColumn","tax","translate","",2,"width","4%"],["pSortableColumn","net","translate","",2,"width","4%"],["translate","",2,"width","5%"],["pSortableColumn","isSync","translate","",2,"width","5%"],["pSortableColumn","notes","translate","",2,"width","5%"],[2,"width","12%"],[1,"fs-5"],["type","button","pRipple","",1,"border-0","p-button-text","p-button-rounded","p-button-plain",3,"pRowToggler","ngClass"],[1,"code-pointer"],[1,"ri-share-circle-fill","label-icon","align-middle","rounded-pill","fs-16","me-2"],["class","badge bg-success-subtle text-success",4,"ngIf"],[1,"badge","fs-5","badge-border",3,"ngClass"],["class","badge bg-success","translate","sales.salesOrder.syncSend",4,"ngIf"],["class","badge bg-warning","translate","sales.salesOrder.syncNotSend",4,"ngIf"],[1,"d-inline-block"],["type","button","class","mx-1 d-inline-block btn px-4 w-auto btn-sm btn-success btn-label  waves-effect waves-light rounded-pill",3,"click",4,"ngIf"],[1,"dropdown-custom","d-inline-block"],["type","button",1,"btn","dropbtn","btn-soft-secondary","btn-sm","dropdown-custom","arrow-none"],[1,"ri-more-fill"],[1,"dropdown-menu","dropdown-menu-end","dropdown-content",2,"left","0"],[1,"dropdown-item"],[1,"ri-printer-line","align-bottom","me-2","text-muted"],["translate","sales.salesOrder.isSync"],["translate","orderManagement.order.printPill"],[1,"badge","bg-success-subtle","text-success"],["translate","sales.salesOrder.syncSend",1,"badge","bg-success"],["translate","sales.salesOrder.syncNotSend",1,"badge","bg-warning"],["type","button",1,"mx-1","d-inline-block","btn","px-4","w-auto","btn-sm","btn-success","btn-label","waves-effect","waves-light","rounded-pill",3,"click"],[1,"ri-add-fill","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","sales.salesInvoices.addPayment",1,"ms-3"],["colspan","17"],[1,"table-detail"],["dataKey","id",3,"value"],["pTemplate","emptymessage"],[2,"width","5%"],["translate","sales.salesInvoices.cost",2,"width","10%"],["translate","sales.salesInvoices.paymentTypeName",2,"width","10%"],["translate","sales.salesInvoices.attachment",2,"width","10%"],["translate","sales.salesInvoices.notes",2,"width","10%"],[2,"width","10%"],["target","_blank",3,"href",4,"ngIf"],["width","30","height","30",3,"src","preview","alt","onImageError",4,"ngIf"],[1,"d-inline"],["tooltipPosition","top",1,"btn","btn-sm","btn-primary","edit-list","mx-1",3,"click","pTooltip"],[1,"ri-edit-2-line","align-bottom"],["tooltipPosition","top",1,"btn","btn-sm","btn-danger","edit-list","mx-1",3,"click","pTooltip"],[1,"ri-delete-bin-2-fill","align-bottom"],["target","_blank",3,"href"],["width","30","height","30",3,"onImageError","src","preview","alt"],["colspan","4"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["class","fw-bold fs-4","translate","",4,"ngIf"],["translate",""],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"hasProgressBar","fgsType","loaderId"],[3,"submit"],[1,"mb-3"],["translate","",1,"required","fw-bold","form-label","w-100"],["name","paymentTypeId","bindValue","code","bindLabel","name","required","",3,"ngModelChange","items","multiple","ngModel"],["class","text-danger text-center","translate","",4,"ngIf"],["for","cost","translate","",1,"required","fw-bold","form-label"],["InputTirmFilter","","name","cost","type","text","id","employeeName","required","",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["class","text-danger text-center  ","translate","",4,"ngIf"],["for","notes","translate","",1,"fw-bold","form-label"],["rows","3","name","notes","type","text","id","notes",1,"form-control","fs-6",3,"ngModelChange","ngModel"],[1,"col-12","mb-2"],["accept","image/*, application/pdf","type","file","placeholder","dfd",1,"form-control","fs-6",3,"change"],[1,"my-3","row","row-cols-5"],["class","col",4,"ngFor","ngForOf"],[1,"text-center"],["type","submit","type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],["translate","",1,"fw-bold","fs-4"],["translate","",1,"text-danger","text-center"],[1,"col"],["class","position-relative",4,"ngIf"],[1,"position-relative"],[1,"ri-close-fill","position-absolute",2,"border-radius","50%","background-color","red","inset-inline-start","-14px","top","-8px","color","white",3,"click"],["width","50","height","50",3,"error","src","preview","alt"],[3,"deleteConfirm","dismiss"]],template:function(i,n){if(1&i){const s=e.RV6();e.nrm(0,"app-breadcrumbs",7),e.nI1(1,"translate"),e.j41(2,"div",8)(3,"div",9)(4,"div",10),e.nrm(5,"ngx-ui-loader",11),e.j41(6,"base-filter",12),e.bIt("reset",function(){return e.eBV(s),e.Njj(n.onReset())})("search",function(){return e.eBV(s),e.Njj(n.onSearch())}),e.qex(7,13),e.j41(8,"div",14)(9,"div",15)(10,"input",16),e.nI1(11,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(s),e.DH7(n.pagination.id,l)||(n.pagination.id=l),e.Njj(l)}),e.k0s(),e.nrm(12,"i",17),e.k0s()(),e.j41(13,"div",14)(14,"div",15)(15,"input",18),e.nI1(16,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(s),e.DH7(n.pagination.clientName,l)||(n.pagination.clientName=l),e.Njj(l)}),e.k0s(),e.nrm(17,"i",17),e.k0s()(),e.j41(18,"div",14)(19,"input",19),e.nI1(20,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(s),e.DH7(n.searchForm.dates,l)||(n.searchForm.dates=l),e.Njj(l)}),e.k0s()(),e.j41(21,"div",14)(22,"input",19),e.nI1(23,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(s),e.DH7(n.searchForm.creationDates,l)||(n.searchForm.creationDates=l),e.Njj(l)}),e.k0s()(),e.bVm(),e.k0s(),e.j41(24,"div",20)(25,"div",21)(26,"p-table",22,0),e.bIt("onLazyLoad",function(l){return e.eBV(s),e.Njj(n.tableChange(l))})("selectionChange",function(l){return e.eBV(s),e.Njj(n.onSelectionChange(l))}),e.DNE(28,pi,34,0,"ng-template",23)(29,fi,49,29,"ng-template",24)(30,ki,7,1,"ng-template",25),e.k0s()(),e.DNE(31,Ii,2,0,"div",26)(32,yi,6,8,"div",27),e.k0s()()()(),e.DNE(33,Ei,41,15,"ng-template",null,1,e.C5r)(35,Gi,1,0,"ng-template",null,2,e.C5r)}2&i&&(e.FS9("title",e.bMT(1,25,n.title)),e.Y8G("breadcrumbItems",n.breadCrumbItems),e.R7$(5),e.Y8G("loaderId","newLoader"),e.R7$(),e.Y8G("showAdd",!1)("showExport",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(11,27,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.id),e.R7$(5),e.FS9("placeholder",e.bMT(16,29,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.clientName),e.R7$(4),e.FS9("placeholder",e.bMT(20,31,"orderManagement.order.visitDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.dates),e.R7$(3),e.FS9("placeholder",e.bMT(23,33,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(4),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(5),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[p.YU,p.Sq,p.bT,c.qT,c.me,c.Q0,c.BC,c.cb,c.YS,c.vS,c.cV,m.s5,A.kL,fe.m,z.b,X.w,Q.p,J.g,h.Mm,b.XI,H.Ei,b.Tg,b.FP,f.Cv,Y.vr,G.m,ee.m,ve._,p.vh,h.D9],encapsulation:2})}}return r})();var Vi=d(56131);const $i=[{path:"sales-orders",component:di,canActivate:[te.g],data:{permission:[]}},{path:"setting",component:xt,canActivate:[te.g],data:{permission:[]}},{path:"new",component:_e,canActivate:[te.g],data:{permission:["order.register"]}},{path:"sales-invoices",component:Di,resolve:{data:(()=>{class r extends Vi.E{constructor(t,i,n){super(t,i,n)}static{this.\u0275fac=function(i){return new(i||r)(e.KVO(v.Ix),e.KVO(be),e.KVO(x.u))}}static{this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})()},canActivate:[te.g],data:{permission:["order.register"]}},{path:"new/:id",component:_e,canActivate:[te.g],data:{permission:["order.edit"]}}];let Xi=(()=>{class r{static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275mod=e.$C({type:r})}static{this.\u0275inj=e.G2t({imports:[v.iI.forChild($i),v.iI]})}}return r})();var Bi=d(71144),Ui=d(72837),Ai=d(81141);let Yi=(()=>{class r{constructor(){(0,je.eV)(ke().loadAnimation)}static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275mod=e.$C({type:r})}static{this.\u0275inj=e.G2t({imports:[p.MD,c.YN,c.X1,m.zH,m.Pv,m.c9,A.ND,Se.r,Xi,Ie.G,h.h,b.bG,ye.q4,ge.H_,m.c9,f.th,Y.MQ,m.n8,Bi.j,m._f,ee.S,ve.U,Ui.wn,Ai.tm]})}}return r})()}}]);